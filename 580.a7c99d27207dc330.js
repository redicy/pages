"use strict";(self.webpackChunkseller=self.webpackChunkseller||[]).push([[580],{6580:(w,_,f)=>{f.r(_),f.d(_,{OzonModule:()=>fr});var v=f(177),E=f(2115),C=f(467),b=f(4412),O=f(6977),k=f(5964),g=f(9437),y=f(983),p=f(2180),i=f(4153),u=f(6229),e=f(4438),a=f(6557),l=f(5779),m=f(4238),h=f(345),F=f(1141),I=f(612),T=f(491),P=f(9417),X=f(6296),J=f(3227),Q=f(5901),M=f(544),K=f(935),z=f(9998),A=f(5716),N=f(563),L=f(1880);const $=(o,c,t)=>({"p-togglebutton p-button p-component":!0,"p-button-icon-only":o,"p-highlight":c,"p-disabled":t}),W=(o,c)=>({"p-button-icon":!0,"p-button-icon-left":o,"p-button-icon-right":c}),se=o=>({$implicit:o});function le(o,c){if(1&o&&e.nrm(0,"span",4),2&o){const t=e.XpG(2);e.HbH(t.checked?t.onIcon:t.offIcon),e.Y8G("ngClass",e.l_i(4,W,"left"===t.iconPos,"right"===t.iconPos)),e.BMQ("data-pc-section","icon")}}function Re(o,c){if(1&o&&e.DNE(0,le,1,7,"span",3),2&o){const t=e.XpG();e.Y8G("ngIf",t.onIcon||t.offIcon)}}function Ie(o,c){1&o&&e.eu8(0)}function Te(o,c){if(1&o&&e.DNE(0,Ie,1,0,"ng-container",5),2&o){const t=e.XpG();e.Y8G("ngTemplateOutlet",t.iconTemplate)("ngTemplateOutletContext",e.eq3(2,se,t.checked))}}function De(o,c){if(1&o&&(e.j41(0,"span",6),e.EFF(1),e.k0s()),2&o){const t=e.XpG();e.BMQ("data-pc-section","label"),e.R7$(),e.JRh(t.checked?t.hasOnLabel?t.onLabel:"":t.hasOffLabel?t.offLabel:"")}}const je={provide:P.kq,useExisting:(0,e.Rfq)(()=>fe),multi:!0};let fe=(()=>{class o{cd;onLabel;offLabel;onIcon;offIcon;ariaLabel;ariaLabelledBy;disabled;style;styleClass;inputId;tabindex=0;iconPos="left";autofocus;onChange=new e.bkB;templates;iconTemplate;checked=!1;onModelChange=()=>{};onModelTouched=()=>{};constructor(t){this.cd=t}ngAfterContentInit(){this.templates.forEach(t=>{t.getType(),this.iconTemplate=t.template})}toggle(t){if(this.disabled)return t.preventDefault(),void t.stopPropagation();this.checked=!this.checked,this.onModelChange(this.checked),this.onModelTouched(),this.onChange.emit({originalEvent:t,checked:this.checked}),this.cd.markForCheck()}onKeyDown(t){switch(t.code){case"Enter":case"Space":this.toggle(t),t.preventDefault()}}onBlur(){this.onModelTouched()}writeValue(t){this.checked=t,this.cd.markForCheck()}registerOnChange(t){this.onModelChange=t}registerOnTouched(t){this.onModelTouched=t}setDisabledState(t){this.disabled=t,this.cd.markForCheck()}get hasOnLabel(){return this.onLabel&&this.onLabel.length>0}get hasOffLabel(){return this.offLabel&&this.offLabel.length>0}static \u0275fac=function(r){return new(r||o)(e.rXU(e.gRc))};static \u0275cmp=e.VBU({type:o,selectors:[["p-toggleButton"]],contentQueries:function(r,n,s){if(1&r&&e.wni(s,l.Ei,4),2&r){let d;e.mGM(d=e.lsd())&&(n.templates=d)}},hostAttrs:[1,"p-element"],inputs:{onLabel:"onLabel",offLabel:"offLabel",onIcon:"onIcon",offIcon:"offIcon",ariaLabel:"ariaLabel",ariaLabelledBy:"ariaLabelledBy",disabled:[2,"disabled","disabled",e.L39],style:"style",styleClass:"styleClass",inputId:"inputId",tabindex:[2,"tabindex","tabindex",e.Udg],iconPos:"iconPos",autofocus:[2,"autofocus","autofocus",e.L39]},outputs:{onChange:"onChange"},features:[e.Jv_([je]),e.GFd],decls:4,vars:17,consts:[["role","switch","pRipple","","pAutoFocus","",3,"click","keydown","ngClass","ngStyle","autofocus"],[3,"class","ngClass"],["class","p-button-label",4,"ngIf"],[3,"class","ngClass",4,"ngIf"],[3,"ngClass"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"p-button-label"]],template:function(r,n){1&r&&(e.j41(0,"div",0),e.bIt("click",function(d){return n.toggle(d)})("keydown",function(d){return n.onKeyDown(d)}),e.DNE(1,Re,1,1,"span",1)(2,Te,1,4,"ng-container")(3,De,2,2,"span",2),e.k0s()),2&r&&(e.HbH(n.styleClass),e.Y8G("ngClass",e.sMw(13,$,n.onIcon&&n.offIcon&&!n.hasOnLabel&&!n.hasOffLabel,n.checked,n.disabled))("ngStyle",n.style)("autofocus",n.autofocus),e.BMQ("tabindex",n.disabled?null:n.tabindex)("aria-checked",n.checked)("aria-labelledby",n.ariaLabelledBy)("aria-label",n.ariaLabel)("data-pc-name","togglebutton")("data-pc-section","root"),e.R7$(),e.vxM(n.iconTemplate?2:1),e.R7$(2),e.Y8G("ngIf",n.onLabel||n.offLabel))},dependencies:[v.YU,v.bT,v.T3,v.B3,N.n,L.q],styles:['@layer primeng{.p-button[_ngcontent-%COMP%]{margin:0;display:inline-flex;cursor:pointer;-webkit-user-select:none;user-select:none;align-items:center;vertical-align:bottom;text-align:center;overflow:hidden;position:relative}.p-button-label[_ngcontent-%COMP%]{flex:1 1 auto}.p-button-icon-right[_ngcontent-%COMP%]{order:1}.p-button[_ngcontent-%COMP%]:disabled{cursor:default;pointer-events:none}.p-button-icon-only[_ngcontent-%COMP%]{justify-content:center}.p-button-icon-only[_ngcontent-%COMP%]:after{content:"p";visibility:hidden;clip:rect(0 0 0 0);width:0}.p-button-vertical[_ngcontent-%COMP%]{flex-direction:column}.p-button-icon-bottom[_ngcontent-%COMP%]{order:2}.p-button-group[_ngcontent-%COMP%]   .p-button[_ngcontent-%COMP%]{margin:0}.p-button-group[_ngcontent-%COMP%]   .p-button[_ngcontent-%COMP%]:focus, .p-button-group[_ngcontent-%COMP%]   p-button[_ngcontent-%COMP%]:focus   .p-button[_ngcontent-%COMP%], .p-buttonset[_ngcontent-%COMP%]   .p-button[_ngcontent-%COMP%]:focus, .p-buttonset[_ngcontent-%COMP%]   p-button[_ngcontent-%COMP%]:focus   .p-button[_ngcontent-%COMP%]{position:relative;z-index:1}.p-button-group[_ngcontent-%COMP%]   .p-button[_ngcontent-%COMP%]:not(:last-child), .p-button-group[_ngcontent-%COMP%]   .p-button[_ngcontent-%COMP%]:not(:last-child):hover, .p-button-group[_ngcontent-%COMP%]   p-button[_ngcontent-%COMP%]:not(:last-child)   .p-button[_ngcontent-%COMP%], .p-button-group[_ngcontent-%COMP%]   p-button[_ngcontent-%COMP%]:not(:last-child)   .p-button[_ngcontent-%COMP%]:hover, .p-buttonset[_ngcontent-%COMP%]   .p-button[_ngcontent-%COMP%]:not(:last-child), .p-buttonset[_ngcontent-%COMP%]   .p-button[_ngcontent-%COMP%]:not(:last-child):hover, .p-buttonset[_ngcontent-%COMP%]   p-button[_ngcontent-%COMP%]:not(:last-child)   .p-button[_ngcontent-%COMP%], .p-buttonset[_ngcontent-%COMP%]   p-button[_ngcontent-%COMP%]:not(:last-child)   .p-button[_ngcontent-%COMP%]:hover{border-right:0 none}.p-button-group[_ngcontent-%COMP%]   .p-button[_ngcontent-%COMP%]:not(:first-of-type):not(:last-of-type), .p-button-group[_ngcontent-%COMP%]   p-button[_ngcontent-%COMP%]:not(:first-of-type):not(:last-of-type)   .p-button[_ngcontent-%COMP%], .p-buttonset[_ngcontent-%COMP%]   .p-button[_ngcontent-%COMP%]:not(:first-of-type):not(:last-of-type), .p-buttonset[_ngcontent-%COMP%]   p-button[_ngcontent-%COMP%]:not(:first-of-type):not(:last-of-type)   .p-button[_ngcontent-%COMP%]{border-radius:0}.p-button-group[_ngcontent-%COMP%]   .p-button[_ngcontent-%COMP%]:first-of-type:not(:only-of-type), .p-button-group[_ngcontent-%COMP%]   p-button[_ngcontent-%COMP%]:first-of-type:not(:only-of-type)   .p-button[_ngcontent-%COMP%], .p-buttonset[_ngcontent-%COMP%]   .p-button[_ngcontent-%COMP%]:first-of-type:not(:only-of-type), .p-buttonset[_ngcontent-%COMP%]   p-button[_ngcontent-%COMP%]:first-of-type:not(:only-of-type)   .p-button[_ngcontent-%COMP%]{border-top-right-radius:0;border-bottom-right-radius:0}.p-button-group[_ngcontent-%COMP%]   .p-button[_ngcontent-%COMP%]:last-of-type:not(:only-of-type), .p-button-group[_ngcontent-%COMP%]   p-button[_ngcontent-%COMP%]:last-of-type:not(:only-of-type)   .p-button[_ngcontent-%COMP%], .p-buttonset[_ngcontent-%COMP%]   .p-button[_ngcontent-%COMP%]:last-of-type:not(:only-of-type), .p-buttonset[_ngcontent-%COMP%]   p-button[_ngcontent-%COMP%]:last-of-type:not(:only-of-type)   .p-button[_ngcontent-%COMP%]{border-top-left-radius:0;border-bottom-left-radius:0}p-button[iconpos=right][_ngcontent-%COMP%]   spinnericon[_ngcontent-%COMP%]{order:1}}'],changeDetection:0})}return o})(),we=(()=>{class o{static \u0275fac=function(r){return new(r||o)};static \u0275mod=e.$C({type:o});static \u0275inj=e.G2t({imports:[v.MD,N.Z,l.Gg,L.u,l.Gg]})}return o})();var ce=f(8542);const xe=()=>[30,50,100],Pe=()=>({}),Me=o=>[o],ze=o=>({ids:o}),Be=o=>["/","ozon","product",o],pe=()=>({"min-width":"50rem"});function Ge(o,c){if(1&o){const t=e.RV6();e.j41(0,"div",6)(1,"p-calendar",7),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.dateRange,n)||(s.dateRange=n),e.Njj(n)}),e.k0s(),e.j41(2,"p-button",8),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.findOrders(n.filterModel))}),e.k0s()()}if(2&o){const t=e.XpG();e.R7$(),e.R50("ngModel",t.dateRange),e.Y8G("readonlyInput",!0)("selectOtherMonths",!0)("showClear",!0)}}function Le(o,c){if(1&o){const t=e.RV6();e.j41(0,"p-button",9),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.importOrders())}),e.k0s()}if(2&o){const t=e.XpG();e.Y8G("icon",t.isLoading?"pi pi-download":"")}}function Ae(o,c){if(1&o&&(e.j41(0,"span"),e.EFF(1),e.nI1(2,"number"),e.k0s()),2&o){const t=e.XpG(2);e.R7$(),e.SpI("~",e.i5U(2,1,t.summary.expectedPayout,"1.2-2"),"\u20bd")}}function $e(o,c){1&o&&(e.j41(0,"span"),e.EFF(1,"-"),e.k0s())}function Ne(o,c){if(1&o&&(e.qex(0),e.nrm(1,"img",34),e.bVm()),2&o){const t=e.XpG().$implicit;e.R7$(),e.FS9("src",t.value.primaryImage,e.B4B)}}function Xe(o,c){1&o&&(e.qex(0),e.nrm(1,"p-skeleton",35),e.bVm())}function Ve(o,c){if(1&o&&(e.j41(0,"div",33),e.DNE(1,Ne,2,1,"ng-container",17)(2,Xe,2,0,"ng-container",17),e.j41(3,"div"),e.EFF(4),e.k0s()()),2&o){const t=c.$implicit;e.R7$(),e.Y8G("ngIf",t.value),e.R7$(),e.Y8G("ngIf",!t.value),e.R7$(2),e.JRh(t.key)}}function Ye(o,c){if(1&o&&(e.qex(0),e.EFF(1),e.bVm()),2&o){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",t.value," ")}}function He(o,c){1&o&&(e.qex(0),e.nrm(1,"p-skeleton",36),e.bVm())}function We(o,c){if(1&o&&(e.j41(0,"div",33),e.DNE(1,Ye,2,1,"ng-container",17)(2,He,2,0,"ng-container",17),e.k0s()),2&o){const t=c.$implicit;e.R7$(),e.Y8G("ngIf",t.value),e.R7$(),e.Y8G("ngIf",!t.value)}}function Ue(o,c){if(1&o&&(e.qex(0),e.EFF(1),e.bVm()),2&o){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",t.value," ")}}function Je(o,c){1&o&&(e.qex(0),e.nrm(1,"p-skeleton",36),e.bVm())}function qe(o,c){if(1&o&&(e.j41(0,"div",33),e.DNE(1,Ue,2,1,"ng-container",17)(2,Je,2,0,"ng-container",17),e.k0s()),2&o){const t=c.$implicit;e.R7$(),e.Y8G("ngIf",t.value),e.R7$(),e.Y8G("ngIf",!t.value)}}function Qe(o,c){if(1&o){const t=e.RV6();e.j41(0,"tr"),e.nrm(1,"th",24),e.j41(2,"th",25),e.EFF(3," \u0421\u043e\u0441\u0442\u0430\u0432 \u0437\u0430\u043a\u0430\u0437\u0430 "),e.nrm(4,"p-sortIcon",26),e.k0s(),e.j41(5,"th",24),e.EFF(6,"\u0421\u0443\u043c\u043c\u0430"),e.k0s(),e.j41(7,"th",24),e.EFF(8,"\u0421\u0442\u0430\u0442\u0443\u0441"),e.k0s(),e.j41(9,"th",24),e.EFF(10,"\u0421\u043a\u043b\u0430\u0434"),e.k0s(),e.j41(11,"th",24),e.EFF(12,"\u041a\u043b\u0430\u0441\u0442\u0435\u0440"),e.k0s(),e.j41(13,"th",24),e.EFF(14,"\u041b\u043e\u043a\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f"),e.k0s(),e.nrm(15,"th"),e.k0s(),e.j41(16,"tr"),e.nrm(17,"th"),e.j41(18,"th")(19,"p-multiSelect",27),e.nI1(20,"keyvalue"),e.bIt("onClear",function(){e.eBV(t);const n=e.XpG(3);return e.Njj(n.updateSelectedProductPackageIDs())})("onPanelHide",function(){e.eBV(t);const n=e.XpG(3);return e.Njj(n.updateSelectedProductPackageIDs())}),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG(3);return e.DH7(s.selectedProductPackageIDs,n)||(s.selectedProductPackageIDs=n),e.Njj(n)}),e.DNE(21,Ve,5,3,"ng-template",28),e.k0s()(),e.nrm(22,"th"),e.j41(23,"th")(24,"p-multiSelect",29),e.nI1(25,"keyvalue"),e.bIt("onClear",function(){e.eBV(t);const n=e.XpG(3);return e.Njj(n.updateSelectedStatuses())})("onPanelHide",function(){e.eBV(t);const n=e.XpG(3);return e.Njj(n.updateSelectedStatuses())}),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG(3);return e.DH7(s.selectedStatuses,n)||(s.selectedStatuses=n),e.Njj(n)}),e.k0s()(),e.j41(26,"th")(27,"p-multiSelect",30),e.nI1(28,"keyvalue"),e.bIt("onClear",function(){e.eBV(t);const n=e.XpG(3);return e.Njj(n.updateSelectedWarehouseIDs())})("onPanelHide",function(){e.eBV(t);const n=e.XpG(3);return e.Njj(n.updateSelectedWarehouseIDs())}),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG(3);return e.DH7(s.selectedWarehouseIDs,n)||(s.selectedWarehouseIDs=n),e.Njj(n)}),e.DNE(29,We,3,2,"ng-template",28),e.k0s()(),e.j41(30,"th")(31,"p-multiSelect",31),e.nI1(32,"keyvalue"),e.bIt("onClear",function(){e.eBV(t);const n=e.XpG(3);return e.Njj(n.updateSelectedWarehouseClusterIDs())})("onPanelHide",function(){e.eBV(t);const n=e.XpG(3);return e.Njj(n.updateSelectedWarehouseClusterIDs())}),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG(3);return e.DH7(s.selectedWarehouseClusterIDs,n)||(s.selectedWarehouseClusterIDs=n),e.Njj(n)}),e.DNE(33,qe,3,2,"ng-template",28),e.k0s()(),e.j41(34,"th")(35,"p-toggleButton",32),e.bIt("onChange",function(){e.eBV(t);const n=e.XpG(3);return e.Njj(n.updateLocalizationFilter())}),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG(3);return e.DH7(s.nonLocalOnly,n)||(s.nonLocalOnly=n),e.Njj(n)}),e.k0s()(),e.nrm(36,"th"),e.k0s()}if(2&o){const t=e.XpG(3);e.R7$(19),e.R50("ngModel",t.selectedProductPackageIDs),e.Y8G("options",e.bMT(20,17,t.products))("resetFilterOnHide",!0)("showClear",!0),e.R7$(5),e.R50("ngModel",t.selectedStatuses),e.Y8G("options",e.bMT(25,19,t.orderStatuses))("resetFilterOnHide",!0)("showClear",!0),e.R7$(3),e.R50("ngModel",t.selectedWarehouseIDs),e.Y8G("options",e.bMT(28,21,t.warehouses))("resetFilterOnHide",!0)("showClear",!0),e.R7$(4),e.R50("ngModel",t.selectedWarehouseClusterIDs),e.Y8G("options",e.bMT(32,23,t.warehouseClusters))("resetFilterOnHide",!0)("showClear",!0),e.R7$(4),e.R50("ngModel",t.nonLocalOnly)}}function Ke(o,c){if(1&o&&(e.j41(0,"div"),e.nrm(1,"img",49),e.k0s()),2&o){const t=e.XpG().$implicit;e.R7$(),e.Y8G("src",t.primaryImage,e.B4B)}}function Ze(o,c){if(1&o&&(e.qex(0),e.EFF(1),e.bVm()),2&o){const t=e.XpG().$implicit;e.R7$(),e.SpI(" - ",t.price*t.quantity,"\u20bd ")}}function et(o,c){if(1&o&&(e.j41(0,"div",45),e.DNE(1,Ke,2,1,"div",17),e.j41(2,"a",46),e.nrm(3,"i",47),e.k0s(),e.j41(4,"a",48),e.EFF(5),e.k0s(),e.EFF(6),e.j41(7,"b"),e.EFF(8),e.DNE(9,Ze,2,1,"ng-container",17),e.k0s()()),2&o){const t=c.$implicit;e.Y8G("title",t.name),e.R7$(),e.Y8G("ngIf",t.primaryImage),e.R7$(),e.FS9("href",t.link,e.B4B),e.R7$(2),e.Y8G("routerLink",e.eq3(12,Be,e.eq3(10,ze,e.eq3(8,Me,t.productPackageID)))),e.R7$(),e.JRh(t.productPackageID),e.R7$(),e.SpI(" x ",t.price,"\u20bd x "),e.R7$(2),e.SpI("",t.quantity,"\u0448\u0442 "),e.R7$(),e.Y8G("ngIf",1!=t.quantity)}}function tt(o,c){if(1&o&&(e.qex(0),e.j41(1,"p-tag",52),e.EFF(2),e.k0s(),e.EFF(3," - "),e.j41(4,"p-tag",53),e.EFF(5),e.k0s(),e.bVm()),2&o){const t=e.XpG().$implicit;e.R7$(),e.Y8G("icon",t.clusterFrom?"":"pi pi-question-circle"),e.R7$(),e.SpI("",t.clusterFrom," "),e.R7$(2),e.Y8G("icon",t.clusterTo?"":"pi pi-question-circle"),e.R7$(),e.SpI("",t.clusterTo," ")}}function nt(o,c){if(1&o&&(e.j41(0,"p-tag",54),e.EFF(1),e.k0s()),2&o){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",t.clusterFrom," ")}}function ot(o,c){if(1&o&&(e.j41(0,"div"),e.nrm(1,"p-tag",50),e.EFF(2," x"),e.j41(3,"b"),e.EFF(4),e.k0s(),e.EFF(5),e.DNE(6,tt,6,4,"ng-container",17)(7,nt,2,1,"p-tag",51),e.k0s()),2&o){const t=c.$implicit,r=e.XpG(4);e.R7$(),e.Y8G("icon","pi "+r.orderStatusIcons.get(t.status))("pTooltip",r.orderStatuses.get(t.status))("severity",r.orderStatusSeverities.get(t.status)),e.R7$(3),e.JRh(t.count),e.R7$(),e.SpI(" ",t.warehouseName," "),e.R7$(),e.Y8G("ngIf",t.clusterFrom!=t.clusterTo),e.R7$(),e.Y8G("ngIf",t.clusterFrom==t.clusterTo)}}function it(o,c){if(1&o&&(e.j41(0,"tr")(1,"td",37),e.nrm(2,"i"),e.k0s(),e.j41(3,"td")(4,"div",38)(5,"span",39),e.EFF(6,"\u0422\u043e\u0432\u0430\u0440"),e.k0s(),e.j41(7,"div",40),e.EFF(8),e.nI1(9,"date"),e.k0s(),e.DNE(10,et,10,14,"div",41),e.k0s()(),e.j41(11,"td")(12,"div")(13,"span",42),e.EFF(14,"\u0421\u0443\u043c\u043c\u0430"),e.k0s(),e.j41(15,"div"),e.EFF(16),e.nI1(17,"number"),e.k0s()()(),e.j41(18,"td",43)(19,"div")(20,"span",42),e.EFF(21,"\u041d\u0430\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435"),e.k0s(),e.DNE(22,ot,8,7,"div",44),e.k0s()()()),2&o){const t=c.$implicit,r=e.XpG(3);e.R7$(),e.Y8G("pRowToggler",t),e.R7$(),e.ZvI("pi ",r.getOrderTypeIcon(t.type),""),e.R7$(6),e.JRh(e.i5U(9,8,t.date,"y-MM-dd HH:mm")),e.R7$(2),e.Y8G("ngForOf",t.products),e.R7$(6),e.SpI(" ",e.i5U(17,11,t.sum,"1.2-2"),"\u20bd "),e.R7$(6),e.Y8G("ngForOf",t.directions)}}function rt(o,c){1&o&&(e.j41(0,"tr")(1,"th"),e.EFF(2,"\u0410\u0440\u0442\u0438\u043a\u0443\u043b"),e.k0s(),e.j41(3,"th"),e.EFF(4,"\u0421\u0442\u0430\u0442\u0443\u0441"),e.k0s(),e.j41(5,"th"),e.EFF(6,"\u0426\u0435\u043d\u0430"),e.k0s(),e.j41(7,"th"),e.EFF(8,"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e"),e.k0s(),e.j41(9,"th"),e.EFF(10,"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435"),e.k0s()())}function ut(o,c){if(1&o&&(e.j41(0,"tr")(1,"td")(2,"div")(3,"span",39),e.EFF(4,"\u0410\u0440\u0442\u0438\u043a\u0443\u043b"),e.k0s(),e.j41(5,"div"),e.EFF(6),e.k0s()()(),e.j41(7,"td")(8,"div")(9,"span",39),e.EFF(10,"\u0426\u0435\u043d\u0430"),e.k0s(),e.j41(11,"div"),e.nrm(12,"p-tag",59),e.k0s()()(),e.j41(13,"td")(14,"div")(15,"span",39),e.EFF(16,"\u0426\u0435\u043d\u0430"),e.k0s(),e.j41(17,"div"),e.EFF(18),e.nI1(19,"number"),e.k0s()()(),e.j41(20,"td")(21,"div")(22,"span",39),e.EFF(23,"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e"),e.k0s(),e.j41(24,"div"),e.EFF(25),e.k0s()()(),e.j41(26,"td")(27,"div")(28,"span",39),e.EFF(29,"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435"),e.k0s(),e.j41(30,"div"),e.EFF(31),e.k0s()()()()),2&o){let t,r;const n=c.$implicit,s=e.XpG(6);e.R7$(6),e.SpI(" ",n.product.productPackageID," "),e.R7$(6),e.Y8G("severity",null!==(t=s.orderStatusSeverities.get(n.extendedStatus))&&void 0!==t?t:"danger")("value",null!==(r=s.orderStatuses.get(n.extendedStatus))&&void 0!==r?r:"?"),e.R7$(6),e.SpI(" ",e.i5U(19,6,n.price,"1.2-2"),"\u20bd "),e.R7$(7),e.SpI(" ",n.quantity," "),e.R7$(6),e.SpI(" ",n.product.name," ")}}function at(o,c){1&o&&(e.j41(0,"tr")(1,"th"),e.EFF(2,"ID"),e.k0s(),e.j41(3,"th"),e.EFF(4,"\u0414\u0430\u0442\u0430"),e.k0s(),e.j41(5,"th"),e.EFF(6,"\u0421\u0443\u043c\u043c\u0430"),e.k0s(),e.j41(7,"th"),e.EFF(8,"\u041a\u043e\u043c\u0438\u0441\u0441\u0438\u044f"),e.k0s(),e.j41(9,"th"),e.EFF(10,"\u0422\u0438\u043f \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0438"),e.k0s(),e.j41(11,"th"),e.EFF(12,"\u0422\u0438\u043f \u043d\u0430\u0447\u0438\u0441\u043b\u0435\u043d\u0438\u044f"),e.k0s()())}function st(o,c){if(1&o&&(e.j41(0,"tr")(1,"td")(2,"div")(3,"span",39),e.EFF(4,"ID"),e.k0s(),e.j41(5,"div")(6,"a",57),e.nI1(7,"date"),e.EFF(8),e.k0s()()()(),e.j41(9,"td")(10,"div")(11,"span",39),e.EFF(12,"\u0414\u0430\u0442\u0430"),e.k0s(),e.j41(13,"div"),e.EFF(14),e.nI1(15,"date"),e.k0s()()(),e.j41(16,"td")(17,"div")(18,"span",39),e.EFF(19,"\u0421\u0443\u043c\u043c\u0430"),e.k0s(),e.j41(20,"div"),e.EFF(21),e.nI1(22,"number"),e.k0s()()(),e.j41(23,"td")(24,"div")(25,"span",39),e.EFF(26,"\u041a\u043e\u043c\u0438\u0441\u0441\u0438\u044f"),e.k0s(),e.j41(27,"div"),e.EFF(28),e.nI1(29,"number"),e.k0s()()(),e.j41(30,"td")(31,"div")(32,"span",39),e.EFF(33,"\u0422\u0438\u043f \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0438"),e.k0s(),e.j41(34,"div"),e.EFF(35),e.k0s()()(),e.j41(36,"td")(37,"div")(38,"span",39),e.EFF(39,"\u0422\u0438\u043f \u043d\u0430\u0447\u0438\u0441\u043b\u0435\u043d\u0438\u044f"),e.k0s(),e.j41(40,"div"),e.EFF(41),e.k0s()()()()),2&o){const t=c.$implicit,r=e.XpG(7);e.R7$(6),e.FCK("href","https://seller.ozon.ru/app/finances/financial-statement/",t.iD,"?date=",e.i5U(7,9,t.date,"y-MM-dd HH:mm"),"",e.B4B),e.R7$(2),e.JRh(t.iD),e.R7$(6),e.SpI(" ",e.i5U(15,12,t.date,"y-MM-dd HH:mm")," "),e.R7$(7),e.SpI(" ",e.i5U(22,15,t.amount,"1.2-2"),"\u20bd "),e.R7$(7),e.SpI(" ",e.i5U(29,18,t.saleCommission,"1.2-2"),"\u20bd "),e.R7$(7),e.SpI(" ",r.getOperationTypeText(t.operationType)," "),e.R7$(6),e.SpI(" ",r.getTransactionTypeText(t.accrualType)," ")}}function lt(o,c){if(1&o&&(e.qex(0),e.j41(1,"tr")(2,"td",55)(3,"h5")(4,"a",57),e.EFF(5),e.k0s()()()(),e.j41(6,"tr")(7,"td",55)(8,"p-table",58),e.DNE(9,at,13,0,"ng-template",20)(10,st,42,21,"ng-template",21),e.k0s()()(),e.bVm()),2&o){const t=e.XpG().$implicit;e.R7$(4),e.Mz_("href","https://seller.ozon.ru/app/finances/transactions-order?page=1&pageSize=50&search=",t.postingNumber,"",e.B4B),e.R7$(),e.SpI("\u041e\u043f\u0435\u0440\u0430\u0446\u0438\u0438 \u043f\u043e \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044e \u2116",t.postingNumber,""),e.R7$(3),e.Y8G("breakpoint","960px")("tableStyle",e.lJ4(6,pe))("value",t.operations)}}function ct(o,c){if(1&o&&(e.qex(0),e.j41(1,"tr")(2,"td",56)(3,"a",57),e.EFF(4),e.k0s()()(),e.j41(5,"tr")(6,"td",55)(7,"p-table",58),e.DNE(8,rt,11,0,"ng-template",20)(9,ut,32,9,"ng-template",21),e.k0s()()(),e.DNE(10,lt,11,7,"ng-container",17),e.bVm()),2&o){const t=c.$implicit;e.R7$(3),e.Mz_("href","https://seller.ozon.ru/app/postings/fbo/",t.postingNumber,"",e.B4B),e.R7$(),e.SpI("\u041e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u2116",t.postingNumber,""),e.R7$(3),e.Y8G("breakpoint","960px")("tableStyle",e.lJ4(7,pe))("value",t.orderItems),e.R7$(3),e.Y8G("ngIf",null==t.operations?null:t.operations.length)}}function pt(o,c){if(1&o&&(e.qex(0),e.j41(1,"tr")(2,"td",55)(3,"h5"),e.EFF(4,"\u0421\u043e\u0441\u0442\u0430\u0432 \u0437\u0430\u043a\u0430\u0437\u0430"),e.k0s()()(),e.DNE(5,ct,11,8,"ng-container",44),e.bVm()),2&o){const t=e.XpG().$implicit;e.R7$(5),e.Y8G("ngForOf",t.postings)}}function dt(o,c){1&o&&(e.j41(0,"tr")(1,"th"),e.EFF(2,"ID"),e.k0s(),e.j41(3,"th"),e.EFF(4,"\u0414\u0430\u0442\u0430"),e.k0s(),e.j41(5,"th"),e.EFF(6,"\u0421\u0443\u043c\u043c\u0430"),e.k0s(),e.j41(7,"th"),e.EFF(8,"\u041a\u043e\u043c\u0438\u0441\u0441\u0438\u044f"),e.k0s(),e.j41(9,"th"),e.EFF(10,"\u0422\u0438\u043f \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0438"),e.k0s(),e.j41(11,"th"),e.EFF(12,"\u0422\u0438\u043f \u043d\u0430\u0447\u0438\u0441\u043b\u0435\u043d\u0438\u044f"),e.k0s()())}function _t(o,c){if(1&o&&(e.j41(0,"tr")(1,"td")(2,"div")(3,"span",39),e.EFF(4,"ID"),e.k0s(),e.j41(5,"div")(6,"a",57),e.nI1(7,"date"),e.EFF(8),e.k0s()()()(),e.j41(9,"td")(10,"div")(11,"span",39),e.EFF(12,"\u0414\u0430\u0442\u0430"),e.k0s(),e.j41(13,"div"),e.EFF(14),e.nI1(15,"date"),e.k0s()()(),e.j41(16,"td")(17,"div")(18,"span",39),e.EFF(19,"\u0421\u0443\u043c\u043c\u0430"),e.k0s(),e.j41(20,"div"),e.EFF(21),e.nI1(22,"number"),e.k0s()()(),e.j41(23,"td")(24,"div")(25,"span",39),e.EFF(26,"\u041a\u043e\u043c\u0438\u0441\u0441\u0438\u044f"),e.k0s(),e.j41(27,"div"),e.EFF(28),e.nI1(29,"number"),e.k0s()()(),e.j41(30,"td")(31,"div")(32,"span",39),e.EFF(33,"\u0422\u0438\u043f \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0438"),e.k0s(),e.j41(34,"div"),e.EFF(35),e.k0s()()(),e.j41(36,"td")(37,"div")(38,"span",39),e.EFF(39,"\u0422\u0438\u043f \u043d\u0430\u0447\u0438\u0441\u043b\u0435\u043d\u0438\u044f"),e.k0s(),e.j41(40,"div"),e.EFF(41),e.k0s()()()()),2&o){const t=c.$implicit,r=e.XpG(5);e.R7$(6),e.FCK("href","https://seller.ozon.ru/app/finances/financial-statement/",t.iD,"?date=",e.i5U(7,9,t.date,"y-MM-dd HH:mm"),"",e.B4B),e.R7$(2),e.JRh(t.iD),e.R7$(6),e.SpI(" ",e.i5U(15,12,t.date,"y-MM-dd HH:mm")," "),e.R7$(7),e.SpI(" ",e.i5U(22,15,t.amount,"1.2-2"),"\u20bd "),e.R7$(7),e.SpI(" ",e.i5U(29,18,t.saleCommission,"1.2-2"),"\u20bd "),e.R7$(7),e.SpI(" ",r.getOperationTypeText(t.operationType)," "),e.R7$(6),e.SpI(" ",r.getTransactionTypeText(t.accrualType)," ")}}function ft(o,c){if(1&o&&(e.qex(0),e.j41(1,"tr")(2,"td",55)(3,"h5")(4,"a",57),e.EFF(5),e.k0s()()()(),e.j41(6,"tr")(7,"td",55)(8,"p-table",60),e.DNE(9,dt,13,0,"ng-template",20)(10,_t,42,21,"ng-template",21),e.k0s()()(),e.bVm()),2&o){const t=e.XpG().$implicit;e.R7$(4),e.Mz_("href","https://seller.ozon.ru/app/finances/transactions-order?page=1&pageSize=50&search=",t.ozonOrderNumber,"",e.B4B),e.R7$(),e.SpI("\u041e\u043f\u0435\u0440\u0430\u0446\u0438\u0438 \u043f\u043e \u0437\u0430\u043a\u0430\u0437\u0443 \u2116",t.ozonOrderNumber,""),e.R7$(3),e.Y8G("breakpoint","960px")("tableStyle",e.lJ4(6,pe))("value",t.orderOperations)}}function mt(o,c){if(1&o&&e.DNE(0,pt,6,1,"ng-container",17)(1,ft,11,7,"ng-container",17),2&o){const t=c.$implicit;e.Y8G("ngIf",null==t.postings?null:t.postings.length),e.R7$(),e.Y8G("ngIf",null==t.orderOperations?null:t.orderOperations.length)}}function ht(o,c){if(1&o&&(e.qex(0),e.j41(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.EFF(8),e.k0s(),e.j41(9,"td"),e.EFF(10),e.k0s(),e.j41(11,"td"),e.EFF(12),e.nI1(13,"number"),e.k0s(),e.bVm()),2&o){const t=e.XpG(5);e.R7$(2),e.JRh(t.summary.totalOrderCount),e.R7$(2),e.JRh(t.summary.totalProductCount),e.R7$(2),e.JRh(t.summary.cancelledProductCount),e.R7$(2),e.JRh(t.summary.returnedProductCount),e.R7$(2),e.JRh(t.summary.nonLocalProductCount),e.R7$(2),e.SpI("",e.i5U(13,6,t.summary.totalSum,"1.2-2"),"\u20bd")}}function gt(o,c){1&o&&(e.j41(0,"td",55),e.nrm(1,"p-skeleton",63),e.k0s())}function vt(o,c){if(1&o&&(e.j41(0,"tr")(1,"th",55)(2,"table",61)(3,"tr"),e.nrm(4,"th"),e.j41(5,"th"),e.EFF(6,"\u0417\u0430\u043a\u0430\u0437\u043e\u0432"),e.k0s(),e.j41(7,"th"),e.EFF(8,"\u0422\u043e\u0432\u0430\u0440\u043e\u0432"),e.k0s(),e.j41(9,"th"),e.EFF(10,"\u041e\u0442\u043c\u0435\u043d"),e.k0s(),e.j41(11,"th"),e.EFF(12,"\u0412\u043e\u0437\u0432\u0440\u0430\u0442\u043e\u0432"),e.k0s(),e.j41(13,"th"),e.EFF(14,"\u041d\u0435\u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0445"),e.k0s(),e.j41(15,"th"),e.EFF(16,"\u0421\u0443\u043c\u043c\u0430"),e.k0s()(),e.j41(17,"tr")(18,"th"),e.EFF(19,"\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430"),e.k0s(),e.j41(20,"td"),e.EFF(21),e.k0s(),e.j41(22,"td"),e.EFF(23),e.k0s(),e.j41(24,"td"),e.EFF(25),e.k0s(),e.j41(26,"td"),e.EFF(27),e.k0s(),e.j41(28,"td"),e.EFF(29),e.k0s(),e.j41(30,"td"),e.EFF(31),e.nI1(32,"number"),e.k0s()(),e.j41(33,"tr")(34,"th"),e.EFF(35,"\u0412\u0441\u0435\u0433\u043e"),e.k0s(),e.DNE(36,ht,14,9,"ng-container",17)(37,gt,2,0,"td",62),e.k0s()()()()),2&o){const t=e.XpG(4);e.R7$(21),e.JRh(t.pageSummary.orderCount),e.R7$(2),e.JRh(t.pageSummary.productCount),e.R7$(2),e.JRh(t.pageSummary.canceledProductCount),e.R7$(2),e.JRh(t.pageSummary.returnedProductCount),e.R7$(2),e.JRh(t.pageSummary.nonLocalProductCount),e.R7$(2),e.SpI("",e.i5U(32,8,t.pageSummary.orderSum,"1.2-2"),"\u20bd"),e.R7$(5),e.Y8G("ngIf",t.summary),e.R7$(),e.Y8G("ngIf",t.summary)}}function bt(o,c){if(1&o&&e.DNE(0,vt,38,11,"tr",17),2&o){const t=e.XpG(3);e.Y8G("ngIf",t.pageSummary)}}function yt(o,c){if(1&o){const t=e.RV6();e.j41(0,"p-table",19),e.bIt("onFilter",function(n){e.eBV(t);const s=e.XpG(2);return e.Njj(s.onFilter(n))})("onLazyLoad",function(n){e.eBV(t);const s=e.XpG(2);return e.Njj(s.onDataLazyLoad(n))})("onSort",function(n){e.eBV(t);const s=e.XpG(2);return e.Njj(s.onFilter(n))}),e.DNE(1,Qe,37,25,"ng-template",20)(2,it,23,14,"ng-template",21)(3,mt,2,2,"ng-template",22)(4,bt,1,1,"ng-template",23),e.k0s()}if(2&o){const t=e.XpG(2);e.Y8G("lazy",!0)("loading",t.loading)("loading",t.loading)("paginator",!0)("rowsPerPageOptions",e.lJ4(11,xe))("rows",t.filterModel.count)("showCurrentPageReport",!1)("sortOrder",-1)("tableStyle",e.lJ4(12,Pe))("totalRecords",t.summary.totalFilteredOrderCount)("value",t.data)}}function Ct(o,c){if(1&o&&(e.j41(0,"div",10)(1,"div",11)(2,"div",12)(3,"div",13)(4,"div",14)(5,"div",15),e.EFF(6,"\u0417\u0430\u043a\u0430\u0437\u044b"),e.k0s(),e.j41(7,"div")(8,"div",16)(9,"span"),e.EFF(10,"\u0417\u0430\u043a\u0430\u0437\u043e\u0432"),e.k0s(),e.j41(11,"span"),e.EFF(12),e.k0s()()(),e.j41(13,"div",16)(14,"span"),e.EFF(15,"\u0422\u043e\u0432\u0430\u0440\u043e\u0432"),e.k0s(),e.j41(16,"span"),e.EFF(17),e.k0s()(),e.j41(18,"div")(19,"div",16)(20,"span"),e.EFF(21,"\u041a \u0432\u044b\u043f\u043b\u0430\u0442\u0435"),e.k0s(),e.DNE(22,Ae,3,4,"span",17)(23,$e,2,0,"span",17),e.k0s()(),e.j41(24,"div")(25,"div",16)(26,"span"),e.EFF(27,"\u0421\u0443\u043c\u043c\u0430 \u043f\u0440\u043e\u0434\u0430\u0436"),e.k0s(),e.j41(28,"span"),e.EFF(29),e.nI1(30,"number"),e.k0s()()()()()(),e.j41(31,"div",12)(32,"div",13)(33,"div",14)(34,"div",15),e.EFF(35,"\u0412\u043e\u0437\u0432\u0440\u0430\u0442\u044b"),e.k0s(),e.j41(36,"div",16)(37,"span"),e.EFF(38,"\u0422\u043e\u0432\u0430\u0440\u043e\u0432 \u043e\u0442\u043c\u0435\u043d\u0435\u043d\u043e"),e.k0s(),e.j41(39,"span"),e.EFF(40),e.k0s()(),e.j41(41,"div",16)(42,"span"),e.EFF(43,"\u0422\u043e\u0432\u0430\u0440\u043e\u0432 \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0435\u043d\u043e"),e.k0s(),e.j41(44,"span"),e.EFF(45),e.k0s()(),e.j41(46,"div",16)(47,"span"),e.EFF(48,"\u0421\u0443\u043c\u043c\u0430"),e.k0s(),e.j41(49,"span"),e.EFF(50),e.nI1(51,"number"),e.k0s()(),e.j41(52,"div",16)(53,"span"),e.EFF(54,"% \u0432\u043e\u0437\u0432\u0440\u0430\u0442\u043e\u0432"),e.k0s(),e.j41(55,"span"),e.EFF(56),e.nI1(57,"number"),e.k0s()()()()(),e.j41(58,"div",12)(59,"div",13)(60,"div",14)(61,"div",15),e.EFF(62,"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043d\u044b\u0435 \u0437\u0430\u043a\u0430\u0437\u044b"),e.k0s(),e.j41(63,"div")(64,"div",16)(65,"span"),e.EFF(66,"\u0417\u0430\u043a\u0430\u0437\u043e\u0432"),e.k0s(),e.j41(67,"span"),e.EFF(68),e.k0s()()(),e.j41(69,"div",16)(70,"span"),e.EFF(71,"\u0422\u043e\u0432\u0430\u0440\u043e\u0432"),e.k0s(),e.j41(72,"span"),e.EFF(73),e.k0s()(),e.j41(74,"div")(75,"div",16)(76,"span"),e.EFF(77,"\u041a \u0432\u044b\u043f\u043b\u0430\u0442\u0435"),e.k0s(),e.j41(78,"span"),e.EFF(79),e.nI1(80,"number"),e.k0s()()(),e.j41(81,"div")(82,"div",16)(83,"span"),e.EFF(84,"\u0421\u0443\u043c\u043c\u0430 \u043f\u0440\u043e\u0434\u0430\u0436"),e.k0s(),e.j41(85,"span"),e.EFF(86),e.nI1(87,"number"),e.k0s()()()()()()(),e.DNE(88,yt,5,13,"p-table",18),e.k0s()),2&o){const t=e.XpG();e.R7$(12),e.JRh(t.summary.totalOrderCount),e.R7$(5),e.JRh(t.summary.totalProductCount),e.R7$(5),e.Y8G("ngIf",t.summary.expectedPayout),e.R7$(),e.Y8G("ngIf",!t.summary.expectedPayout),e.R7$(6),e.SpI("",e.i5U(30,14,t.summary.totalSalesSum,"1.2-2"),"\u20bd"),e.R7$(11),e.JRh(t.summary.cancelledProductCount),e.R7$(5),e.JRh(t.summary.returnedProductCount),e.R7$(5),e.SpI("",e.i5U(51,17,t.summary.returnSum,"1.2-2"),"\u20bd"),e.R7$(6),e.SpI("",e.i5U(57,20,100*t.summary.returnProductCountPercentage,"1.1-1"),"%"),e.R7$(12),e.JRh(t.summary.finalizedOrderCount),e.R7$(5),e.JRh(t.summary.finalizedProductCount),e.R7$(6),e.SpI("",e.i5U(80,23,t.summary.finalizedSum,"1.2-2"),"\u20bd"),e.R7$(7),e.SpI("",e.i5U(87,26,t.summary.finalizedSalesSum,"1.2-2"),"\u20bd"),e.R7$(2),e.Y8G("ngIf",t.data)}}var Z=function(o){return o[o.Returned=-1]="Returned",o}(Z||{});let Et=(()=>{class o extends p.x{static{this.FilterID="OzonSalesOrderListComponent"}constructor(t,r,n,s,d,S,x,j){super(j),this.ozonSalesOrderClient=t,this.ozonPostingCommandClient=r,this.ozonOperationCommandClient=n,this.messageService=s,this.warehouseClient=d,this.ozonProductClient=S,this.dbService=x,this.dateRangeTypes=u.c,this.loading=!1,this.products=new Map,this.warehouses=new Map,this.warehouseClusters=new Map,this.isLoading=!1,this.findOrdersSubject=new b.t(null),this.knownProducts=new Map,this.knownWarehouses=new Map,this.knownWarehouseClusters=new Map,this.filterModel={dateRangeType:u.c.ThisDay,offset:0,gatherSummary:!0,count:50},this.dateRangeOptions=[{name:"\u0421\u0435\u0433\u043e\u0434\u043d\u044f",value:u.c.ThisDay},{name:"\u0412\u0447\u0435\u0440\u0430",value:u.c.PreviousDay},{name:"\u0421\u0443\u0442\u043a\u0438",value:u.c.Day},{name:"\u042d\u0442\u0430 \u043d\u0435\u0434\u0435\u043b\u044f",value:u.c.ThisWeek},{name:"\u041f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0430\u044f \u043d\u0435\u0434\u0435\u043b\u044f",value:u.c.PreviousWeek},{name:"\u041f\u043e\u0441\u043b\u0435\u0434\u043d\u044f\u044f \u043d\u0435\u0434\u0435\u043b\u044f",value:u.c.Week},{name:"\u042d\u0442\u043e\u0442 \u043c\u0435\u0441\u044f\u0446",value:u.c.ThisMonth},{name:"\u041f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0438\u0439 \u043c\u0435\u0441\u044f\u0446",value:u.c.PreviousMonth},{name:"\u041f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0439 \u043c\u0435\u0441\u044f\u0446",value:u.c.Month},{name:"\u0417\u0430 \u043f\u0435\u0440\u0438\u043e\u0434",value:u.c.Custom}],this.orderStatuses=new Map([[Z.Returned,"\u0412\u043e\u0437\u0432\u0440\u0430\u0442"],[i.D.PostingStatus.AwaitingPackaging,"\u041e\u0436\u0438\u0434\u0430\u0435\u0442 \u0443\u043f\u0430\u043a\u043e\u0432\u043a\u0438"],[i.D.PostingStatus.AwaitingDeliver,"\u041e\u0436\u0438\u0434\u0430\u0435\u0442 \u0434\u043e\u0441\u0442\u0430\u0432\u043a\u0438"],[i.D.PostingStatus.Delivering,"\u0414\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0435\u0442\u0441\u044f"],[i.D.PostingStatus.Delivered,"\u0414\u043e\u0441\u0442\u0430\u0432\u043b\u0435\u043d"],[i.D.PostingStatus.Cancelled,"\u041e\u0442\u043c\u0435\u043d\u0451\u043d"],[i.D.PostingStatus.AwaitingRegistration,"\u041e\u0436\u0438\u0434\u0430\u0435\u0442 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438"],[i.D.PostingStatus.AcceptanceInProgress,"\u0418\u0434\u0451\u0442 \u043f\u0440\u0438\u0451\u043c\u043a\u0430"],[i.D.PostingStatus.AwaitingApprove,"\u041e\u0436\u0438\u0434\u0430\u0435\u0442 \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u044f"],[i.D.PostingStatus.Arbitration,"\u0410\u0440\u0431\u0438\u0442\u0440\u0430\u0436"],[i.D.PostingStatus.ClientArbitration,"\u041a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u0438\u0439 \u0430\u0440\u0431\u0438\u0442\u0440\u0430\u0436 \u0434\u043e\u0441\u0442\u0430\u0432\u043a\u0438"],[i.D.PostingStatus.DriverPickup,"\u0423 \u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044f"],[i.D.PostingStatus.NotAccepted,"\u041d\u0435 \u043f\u0440\u0438\u043d\u044f\u0442\u043e"],[i.D.PostingStatus.SentBySeller,"\u041e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u043e \u043f\u043e\u0441\u0442\u0430\u0432\u0449\u0438\u043a\u043e\u043c"]]),this.orderStatusSeverities=new Map([[Z.Returned,"danger"],[i.D.PostingStatus.AwaitingDeliver,"warning"],[i.D.PostingStatus.Cancelled,"contrast"],[i.D.PostingStatus.AwaitingPackaging,"warning"],[i.D.PostingStatus.Delivering,"info"],[i.D.PostingStatus.Delivered,"success"]]),this.orderStatusIcons=new Map([[Z.Returned,"pi-ban"],[i.D.PostingStatus.AwaitingDeliver,"pi-car"],[i.D.PostingStatus.Cancelled,"pi-replay"],[i.D.PostingStatus.AwaitingPackaging,"pi-box"],[i.D.PostingStatus.Delivering,"pi-car"],[i.D.PostingStatus.Delivered,"pi-dollar"],[i.D.PostingStatus.Delivered,"pi-dollar"]]),this.localizationFilter=null,this.nonLocalOnly=!1}static getPageSummary(t){let r=0,n=0,s=0,d=0,S=0;const x=t.length;for(const j of t)r+=j.sum,j.orderItems.forEach(D=>{D.extendedStatus==i.D.PostingStatus.Cancelled?s+=D.quantity:D.extendedStatus==Z.Returned?(d+=D.quantity,S+=D.clusterTo!==D.clusterFrom?D.quantity:0):(n+=D.quantity,S+=D.clusterTo!==D.clusterFrom?D.quantity:0)});return{canceledProductCount:s,orderCount:x,orderSum:r,productCount:n,returnedProductCount:d,nonLocalProductCount:S}}mapOrder(t){const r=new Map,n=new Set,s=new Set,d=new Map,S=new Map,x=[],j={cancelledProductCount:0,directions:[],hasNonCancelledOrderItems:!1,hasNonFinalizedOrderItems:!1,hasNonLocalOrderItems:!1,nonLocalProductCount:0,orderItems:t.orderItems,orderOperations:x,orderWarehouses:[],postings:[],productCount:0,productIDs:[],products:[],returnSum:0,returnedProductCount:0,salesSum:0,statuses:[],sum:0},D=new Map;for(const R of t.operations)if(j.sum+=R.amount,R.postingNumber==t.ozonOrderNumber)x.push(R);else{if((R.operationType==i.D.OperationType.ReturnAgentOperationRFBS||R.operationType==i.D.OperationType.OperationReturnGoodsFBSofRMS||R.operationType==i.D.OperationType.MarketplaceSellerReexposureDeliveryReturnOperation||R.operationType==i.D.OperationType.ClientReturnAgentOperation||R.operationType==i.D.OperationType.OperationItemReturn||R.operationType==i.D.OperationType.MarketplaceServiceItemReturnFlowLogistic||R.operationType==i.D.OperationType.MarketplaceReturnStorageServiceAtThePickupPointFbsItem)&&n.add(R.postingNumber),r.has(R.postingNumber))r.get(R.postingNumber).operations.push(R);else{const ee={postingNumber:R.postingNumber,orderItems:[],operations:[R]};j.postings.push(ee),r.set(R.postingNumber,ee)}d.set(R.postingNumber,(d.get(R.postingNumber)??0)+R.amount)}const G=new Set;for(const R of t.orderItems){const ee=d.get(R.postingNumber)??0,U=n.has(R.postingNumber)?Z.Returned:R.status;R.clusterFromID&&R.clusterFrom&&this.knownWarehouseClusters.set(R.clusterFromID,R.clusterFrom),R.ozonWarehouseID&&R.ozonWarehouse&&this.knownWarehouses.set(R.ozonWarehouseID,R.ozonWarehouse.name),R.clusterToID&&R.clusterTo&&this.knownWarehouseClusters.set(R.clusterToID,R.clusterTo),R.clusterFrom!==R.clusterTo&&R.status!=i.D.PostingStatus.Cancelled&&(j.nonLocalProductCount+=R.quantity,j.hasNonLocalOrderItems=!0),G.add(U);const Y=`${R.clusterFrom}#${R.clusterTo}#${R.ozonWarehouseID}#${U}`;if(D.has(Y))D.get(Y).count+=R.quantity;else{let q=R.ozonWarehouse?.name??"-";s.has(q)||(j.orderWarehouses.push(q),s.add(q));const Se={clusterFrom:R.clusterFrom,clusterTo:R.clusterTo,count:R.quantity,status:U,warehouseName:q};j.directions.push(Se),D.set(Y,Se)}if(r.has(R.postingNumber))r.get(R.postingNumber).orderItems.push(R);else{const q={postingNumber:R.postingNumber,orderItems:[R],operations:[]};r.set(R.postingNumber,q),j.postings.push(q)}if(S.has(R.product.productPackageID))S.get(R.product.productPackageID).quantity+=R.quantity;else{const q={link:"https://www.ozon.ru/product/"+R.product.sku,name:R.product.name,price:R.price,primaryImage:R.product.primaryImage,productPackageID:R.product.productPackageID,quantity:R.quantity};S.set(R.product.productPackageID,q),j.productIDs.push(R.product.productPackageID.toString()),j.products.push(q)}U==Z.Returned?(j.returnedProductCount+=R.quantity,j.returnSum+=ee):U==i.D.PostingStatus.Cancelled?j.cancelledProductCount+=R.quantity:(j.productCount+=R.quantity,j.hasNonCancelledOrderItems=!0,j.salesSum+=R.quantity*R.price,U!=i.D.PostingStatus.Delivered&&(j.hasNonFinalizedOrderItems=!0)),Object.assign(R,{extendedStatus:U})}return G.forEach(R=>{j.statuses.push(R)}),Object.assign(t,j)}ngOnInit(){this.titleService.setTitle("\u0417\u0430\u043a\u0430\u0437\u044b Ozon"),this.findOrdersSubject.pipe((0,O.Q)(this.destroyed)).pipe((0,k.p)(t=>!!t)).subscribe(t=>{this.localizationFilter=null;const r=Object.assign({},t,{offset:0,productPackageIDs:[],warehouseIDs:[],warehouseClusterIDs:[],statuses:[],nonLocalOnly:!1,dateRangeType:this.dateRangeType});this.dbService.update("filters",{id:o.FilterID,data:r}).pipe((0,g.W)(n=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0444\u0438\u043b\u044c\u0442\u0440\u0430",severity:"error",detail:n}),y.w))).subscribe(()=>{this.findOrders(t)})}),this.dbService.getByID("filters",o.FilterID).subscribe(t=>{t&&t.data&&(this.filterModel=t.data,this.dateRangeType=t.data.dateRangeType),this.changeReportDate()})}changeReportDate(){this.findOrdersSubject.next(this.filterModel)}getSummary(t){return{cancelledProductCount:t.cancelledProductCount,expectedPayout:t.finalizedSum*t.totalSalesSum/t.finalizedSalesSum,finalizedOrderCount:t.finalizedOrderCount,finalizedProductCount:t.finalizedProductCount,finalizedSalesSum:t.finalizedSalesSum,finalizedSum:t.finalizedSum,nonLocalProductCount:t.nonLocalProductCount,returnProductCountPercentage:t.finalizedProductCount&&t.returnedProductCount?t.returnedProductCount/t.finalizedProductCount:0,returnSum:t.returnSum,returnedProductCount:t.returnedProductCount,totalFilteredOrderCount:t.totalFilteredOrderCount,totalOrderCount:t.totalOrderCount,totalProductCount:t.totalProductCount,totalSalesSum:t.totalSalesSum,totalSum:t.amount}}getOrderTypeIcon(t){switch(t){case i.D.OzonSalesOrderType.Fbo:return"ozon-fbo";case i.D.OzonSalesOrderType.Fbs:return"ozon-fbs";default:return"pi-question"}}importOrders(){var t=this;return(0,C.A)(function*(){const[r,n]=u.q.getDateRange(t.dateRangeType,t.dateRange);n?.setDate(n.getDate()+1);const s=(0,g.W)(d=>(t.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0438\u043c\u043f\u043e\u0440\u0442\u0430 \u0442\u043e\u0432\u0430\u0440\u043e\u0432",severity:"error",detail:d}),t.loading=!1,y.w));t.ozonPostingCommandClient.importOzonFboPostings(r,n).pipe(s).subscribe(()=>{t.ozonOperationCommandClient.importOzonOperations(r,n).pipe(s).subscribe(()=>{t.findOrdersSubject.next(t.filterModel)})})})()}findOrders(t){const[r,n]=u.q.getDateRange(this.dateRangeType,this.dateRange);n?.setDate(n.getDate()+1),t.gatherSummary=!t.offset,t.dateFrom=r,t.dateTo=n;const s=new i.D.FindOzonSalesOrdersModel(t);this.loading=!0,this.pageSummary=void 0,this.ozonSalesOrderClient.findSalesOzonOrders(s).pipe((0,g.W)(d=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0437\u0430\u043a\u0430\u0437\u043e\u0432",severity:"error",detail:d}),this.loading=!1,y.w))).subscribe(d=>{this.loading=!1;let S=0;this.data=d?.items.map(x=>{const j=this.mapOrder(x);return j.orderItems.forEach(G=>{G.extendedStatus==i.D.PostingStatus.Cancelled||G.extendedStatus==Z.Returned||(S+=G.quantity),this.knownProducts.set(G.product.productPackageID,G.product)}),j}),this.filterModel.gatherSummary&&(this.updateProducts(d.iDs),this.updateWarehouses(d.warehouseIDs),this.updateWarehouseClusters(d.warehouseClusterIDs),this.summary=this.getSummary(d)),this.pageSummary=o.getPageSummary(this.data)})}getTransactionTypeText(t){return i.D.TransactionType[t]}getOperationTypeText(t){return i.D.OperationType[t]}onFilter(t){console.log(t)}updateSelectedProductPackageIDs(){const t=this.selectedProductPackageIDs?.map(r=>+r).sort((r,n)=>r-n)??[];(t.length!=this.filterModel.productPackageIDs?.length||!t.every((r,n)=>r==this.filterModel.productPackageIDs[n]))&&(this.filterModel.productPackageIDs=t,this.findOrdersSubject.next(this.filterModel))}updateLocalizationFilter(){this.filterModel.nonLocalOnly!=this.nonLocalOnly&&(this.filterModel.nonLocalOnly=this.nonLocalOnly,this.findOrdersSubject.next(this.filterModel))}updateSelectedWarehouseIDs(){const t=this.selectedWarehouseIDs?.length??0,r=this.filterModel.warehouseIDs?.length??0,n=this.selectedWarehouseIDs?.map(s=>+s).sort((s,d)=>s-d)??[];(t!=r||!n.every((s,d)=>s==this.filterModel.warehouseIDs[d]))&&(this.filterModel.warehouseIDs=n,this.findOrdersSubject.next(this.filterModel))}updateSelectedWarehouseClusterIDs(){const t=this.selectedWarehouseClusterIDs?.length??0,r=this.filterModel.warehouseClusterIDs?.length??0,n=this.selectedWarehouseClusterIDs?.map(s=>+s).sort((s,d)=>s-d)??[];(t!=r||!n.every((s,d)=>s==this.filterModel.warehouseClusterIDs[d]))&&(this.filterModel.warehouseClusterIDs=n,this.findOrdersSubject.next(this.filterModel))}updateSelectedStatuses(){const t=this.selectedStatuses?.length??0,r=this.filterModel.statuses?.length??0,n=this.selectedStatuses?.map(s=>+s).sort((s,d)=>s-d)??[];(t!=r||!n?.every((s,d)=>s==this.filterModel.statuses[d]))&&(this.filterModel.statuses=n,this.findOrdersSubject.next(this.filterModel))}onDataLazyLoad(t){(this.filterModel.offset!=t.first||this.filterModel.count!=t.rows)&&(this.filterModel.offset=t.first,this.filterModel.count=t.rows,this.findOrdersSubject.next(this.filterModel))}updateWarehouses(t){if(this.warehouses.clear(),t&&t.length){const r=[];for(const n of t)this.knownWarehouses.has(n)?this.warehouses.set(n,this.knownWarehouses.get(n)):(this.warehouses.set(n,void 0),r.push(n));r.length&&this.warehouseClient.getOzonWarehouses(new i.D.FindOzonWarehousesModel({includeAliases:!1,iDs:r})).pipe((0,g.W)(n=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u0441\u043a\u043b\u0430\u0434\u0430\u0445",severity:"error",detail:n}),y.w))).subscribe(n=>{for(const s of n)this.knownWarehouses.set(s.iD,s.name),this.warehouses.has(s.iD)&&this.warehouses.set(s.iD,s.name)})}}updateWarehouseClusters(t){if(this.warehouseClusters.clear(),t&&t.length){const r=[];for(const n of t)this.knownWarehouseClusters.has(n)?this.warehouseClusters.set(n,this.knownWarehouseClusters.get(n)):(this.warehouseClusters.set(n,void 0),r.push(n));r.length&&this.warehouseClient.getOzonWarehouseClusters(new i.D.FindOzonWarehouseClustersModel({includeAliases:!1,includeWarehouses:!1,iDs:r})).pipe((0,g.W)(n=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u0430\u0445",severity:"error",detail:n}),y.w))).subscribe(n=>{for(const s of n)this.knownWarehouseClusters.set(s.iD,s.name),this.warehouseClusters.has(s.iD)&&this.warehouseClusters.set(s.iD,s.name)})}}updateProducts(t){if(this.products.clear(),t&&t.length){const r=[];for(const n of t)this.knownProducts.has(n)?this.products.set(n,this.knownProducts.get(n)):(this.products.set(n,void 0),r.push(n));r.length&&this.ozonProductClient.findOzonProducts(new i.D.FindOzonProductsModel({iDs:r,count:-1,offset:0,includeStocks:!1})).pipe((0,g.W)(n=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u0442\u043e\u0432\u0430\u0440\u0430\u0445",severity:"error",detail:n}),y.w))).subscribe(n=>{for(const s of n.items)this.knownProducts.set(s.productPackageID,s),this.products.has(s.productPackageID)&&this.products.set(s.productPackageID,s)})}}static{this.\u0275fac=function(r){return new(r||o)(e.rXU(i.D.OzonSalesOrderClient),e.rXU(a.X.PostingClient),e.rXU(a.X.OperationClient),e.rXU(l.bg),e.rXU(i.D.WarehouseClient),e.rXU(i.D.OzonProductClient),e.rXU(m.MX),e.rXU(h.hE))}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["app-ozon-sales-order-list"]],features:[e.Vt3],decls:8,vars:7,consts:[["header","\u0417\u0430\u043a\u0430\u0437\u044b Ozon"],[1,"justify-content-center"],["icon","pi pi-search","optionLabel","name","optionValue","value",3,"onOptionClick","ngModelChange","ngModel","allowEmpty","disabled","options"],["class","justify-content-center mb-1",4,"ngIf"],["label","\u0418\u043c\u043f\u043e\u0440\u0442 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0439","styleClass","m-3",3,"icon","click",4,"ngIf"],["class","card",4,"ngIf"],[1,"justify-content-center","mb-1"],["placeholder","\u041f\u0435\u0440\u0438\u043e\u0434","selectionMode","range",3,"ngModelChange","ngModel","readonlyInput","selectOtherMonths","showClear"],["icon","pi pi-search","label","\u041d\u0430\u0439\u0442\u0438 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f",3,"click"],["label","\u0418\u043c\u043f\u043e\u0440\u0442 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0439","styleClass","m-3",3,"click","icon"],[1,"card"],[1,"grid"],[1,"col-12","md:col-4"],[1,"card","text-right"],[1,"text-900","font-medium","text-xl","mb-3"],[1,"text-500","text-center"],[1,"flex","justify-content-between"],[4,"ngIf"],["dataKey","iD","responsiveLayout","stack","sortField","date",3,"lazy","loading","paginator","rowsPerPageOptions","rows","showCurrentPageReport","sortOrder","tableStyle","totalRecords","value","onFilter","onLazyLoad","onSort",4,"ngIf"],["dataKey","iD","responsiveLayout","stack","sortField","date",3,"onFilter","onLazyLoad","onSort","lazy","loading","paginator","rowsPerPageOptions","rows","showCurrentPageReport","sortOrder","tableStyle","totalRecords","value"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["pTemplate","footer"],["width","1%"],["pSortableColumn","date","width","1%"],["field","date"],["appendTo","body","filterBy","key","maxSelectedLabels","3","optionLabel","key","optionValue","key","placeholder","\u041b\u044e\u0431\u043e\u0439 \u0430\u0440\u0442\u0438\u043a\u0443\u043b",3,"onClear","onPanelHide","ngModelChange","ngModel","options","resetFilterOnHide","showClear"],["pTemplate","item"],["appendTo","body","optionLabel","value","optionValue","key","placeholder","\u041b\u044e\u0431\u043e\u0439",3,"onClear","onPanelHide","ngModelChange","ngModel","options","resetFilterOnHide","showClear"],["appendTo","body","filterBy","value","maxSelectedLabels","3","optionLabel","value","optionValue","key","placeholder","\u041b\u044e\u0431\u043e\u0439 \u0441\u043a\u043b\u0430\u0434",3,"onClear","onPanelHide","ngModelChange","ngModel","options","resetFilterOnHide","showClear"],["appendTo","body","filterBy","value","maxSelectedLabels","3","optionLabel","value","optionValue","key","placeholder","\u041b\u044e\u0431\u043e\u0439 \u043a\u043b\u0430\u0441\u0442\u0435\u0440",3,"onClear","onPanelHide","ngModelChange","ngModel","options","resetFilterOnHide","showClear"],["inputId","localFilter","offLabel","\u041b\u044e\u0431\u044b\u0435","onLabel","\u041d\u0435\u043b\u043e\u043a\u0430\u043b\u044c\u043d\u044b\u0435",1,"p-button-sm",3,"onChange","ngModelChange","ngModel"],[1,"flex","align-items-center","gap-2"],[2,"width","3rem",3,"src"],["height","3rem","width","3rem"],["height","3rem","width","6rem"],[3,"pRowToggler"],[1,"white-space-nowrap"],[1,"p-column-title","font-bold"],[1,"mb-2"],[3,"title",4,"ngFor","ngForOf"],[1,"p-column-title"],["colspan","5"],[4,"ngFor","ngForOf"],[3,"title"],["target","_blank",1,"mr-1",3,"href"],[1,"pi","ozon-fbo","vertical-align-middle"],["target","_blank",3,"routerLink"],["width","50",3,"src"],[3,"icon","pTooltip","severity"],["severity","success",4,"ngIf"],["severity","info",3,"icon"],["severity","danger",3,"icon"],["severity","success"],["colspan","8"],["colspan","8",1,"text-left","justify-content-start"],["rel","noreferrer","target","_blank",3,"href"],["responsiveLayout","stack",3,"breakpoint","tableStyle","value"],[3,"severity","value"],["dataKey","iD","responsiveLayout","stack",3,"breakpoint","tableStyle","value"],[1,"text-right","p-1"],["colspan","8",4,"ngIf"],["height","2rem"]],template:function(r,n){1&r&&(e.nrm(0,"p-toast")(1,"p-scrollTop"),e.j41(2,"p-card",0)(3,"div",1)(4,"p-selectButton",2),e.bIt("onOptionClick",function(){return n.changeReportDate()}),e.mxI("ngModelChange",function(d){return e.DH7(n.dateRangeType,d)||(n.dateRangeType=d),d}),e.k0s()(),e.DNE(5,Ge,3,4,"div",3)(6,Le,1,1,"p-button",4),e.k0s(),e.DNE(7,Ct,89,29,"div",5)),2&r&&(e.R7$(4),e.R50("ngModel",n.dateRangeType),e.Y8G("allowEmpty",!1)("disabled",n.loading)("options",n.dateRangeOptions),e.R7$(),e.Y8G("ngIf",n.dateRangeType==n.dateRangeTypes.Custom),e.R7$(),e.Y8G("ngIf",void 0!==n.dateRangeType),e.R7$(),e.Y8G("ngIf",n.summary))},dependencies:[l.Ei,F.$n,I.Vv,T.Z,v.Sq,v.bT,P.BC,P.vS,X.KF,E.Wk,J.l,Q.JC,M.XI,M.Tg,M.FP,M.yc,K.v,z.y8,A.E,fe,ce.m,v.QX,v.vh,v.lG],styles:["@media (min-width: 961px){.p-column-title[_ngcontent-%COMP%]{display:none}}@media (max-width: 960px){.p-column-title[_ngcontent-%COMP%]{display:block}.p-datatable-tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:block}}"]})}}return o})();var Ot=f(9974),kt=f(5343),me=f(4360),Ft=f(8750);function he(o){return(0,Ot.N)((c,t)=>{let r=!1,n=null,s=null;const d=()=>{if(s?.unsubscribe(),s=null,r){r=!1;const S=n;n=null,t.next(S)}};c.subscribe((0,me._)(t,S=>{s?.unsubscribe(),r=!0,n=S,s=(0,me._)(t,d,kt.l),(0,Ft.Tg)(o(S)).subscribe(s)},()=>{d(),t.complete()},void 0,()=>{n=s=null}))})}var St=f(8839),Rt=f(1584);function ge(o=0,c=St.E){return o<0&&(o=0),(0,Rt.O)(o,o,c)}var It=f(1874),de=f(2637),te=f(5430),ne=f(2242),ve=f(4799),oe=f(6781),ie=f(1802),be=f(672),Tt=a.X.UpdateOzonProductModelItem;const Dt=()=>["name"],jt=()=>[25,50,100],wt=()=>({"min-width":"75rem"}),xt=()=>({"p-inputtext":!1}),Pt=()=>({width:"50vw"});function Mt(o,c){if(1&o){const t=e.RV6();e.j41(0,"button",19),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.clearIDFilter())}),e.k0s()}}function zt(o,c){if(1&o){const t=e.RV6();e.j41(0,"button",19),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.clearNameFilter())}),e.k0s()}}function Bt(o,c){if(1&o){const t=e.RV6();e.j41(0,"tr"),e.nrm(1,"th"),e.j41(2,"th",9),e.EFF(3," ID "),e.nrm(4,"p-sortIcon",10),e.k0s(),e.j41(5,"th",11),e.EFF(6," \u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435 "),e.nrm(7,"p-sortIcon",12),e.k0s(),e.j41(8,"th"),e.EFF(9,"\u0418\u043d\u0434\u0435\u043a\u0441\u044b \u0446\u0435\u043d"),e.k0s(),e.j41(10,"th"),e.EFF(11,"\u0413\u0435\u043e"),e.k0s(),e.j41(12,"th"),e.EFF(13,"\u041a\u043e\u043c\u0438\u0441\u0441\u0438\u0438"),e.k0s(),e.nrm(14,"th"),e.k0s(),e.j41(15,"tr"),e.nrm(16,"th"),e.j41(17,"th")(18,"div",13)(19,"p-inputNumber",14),e.nI1(20,"async"),e.bIt("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.idFilterSubject.next(n))}),e.k0s(),e.DNE(21,Mt,1,0,"button",15),e.nI1(22,"async"),e.k0s()(),e.j41(23,"th")(24,"div",13)(25,"input",16),e.nI1(26,"async"),e.bIt("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.nameFilterSubject.next(n))}),e.k0s(),e.DNE(27,zt,1,0,"button",15),e.nI1(28,"async"),e.k0s()(),e.nrm(29,"th")(30,"th"),e.j41(31,"th")(32,"div",17)(33,"p-triStateCheckbox",18),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.priceIndexFilter,n)||(s.priceIndexFilter=n),e.Njj(n)}),e.k0s()()(),e.nrm(34,"th"),e.k0s()}if(2&o){const t=e.XpG();e.R7$(19),e.Y8G("ngClass",e.lJ4(16,xt))("ngModel",e.bMT(20,8,t.idFilterSubject))("useGrouping",!1),e.R7$(2),e.Y8G("ngIf",e.bMT(22,10,t.idFilterSubject)),e.R7$(4),e.Y8G("ngModel",e.bMT(26,12,t.nameFilterSubject)),e.R7$(2),e.Y8G("ngIf",e.bMT(28,14,t.nameFilterSubject)),e.R7$(6),e.R50("ngModel",t.priceIndexFilter),e.Y8G("label",null==t.priceIndexFilter?"\u0411\u0435\u0437 \u0444\u0438\u043b\u044c\u0442\u0440\u0430":t.priceIndexFilter?"\u0421 \u0438\u043d\u0434\u0435\u043a\u0441\u0430\u043c\u0438 \u0446\u0435\u043d":"\u0421 \u043f\u043b\u043e\u0445\u0438\u043c\u0438 \u0438\u043d\u0434\u0435\u043a\u0441\u0430\u043c\u0438 \u0446\u0435\u043d")}}function Gt(o,c){if(1&o&&(e.j41(0,"div",32)(1,"p-tag",33),e.EFF(2),e.k0s()()),2&o){const t=e.XpG().$implicit,r=e.XpG();e.R7$(),e.Y8G("severity",r.getPriceIndexSeverity(t.externalCompetitorPriceIndexValue)),e.R7$(),e.SpI(" \u0412\u043d\u0435\u0448\u043d\u0438\u0439: ",t.externalCompetitorPriceIndexValue," ")}}function Lt(o,c){if(1&o&&(e.j41(0,"div",17)(1,"p-tag",34),e.EFF(2),e.k0s()()),2&o){const t=e.XpG().$implicit,r=e.XpG();e.R7$(),e.Y8G("severity",r.getPriceIndexSeverity(t.externalPriceIndexValue)),e.R7$(),e.SpI("\u0412\u043d\u0435\u0448\u043d\u0438\u0439 \u0441\u0432\u043e\u0439: ",t.externalPriceIndexValue," ")}}function At(o,c){if(1&o&&(e.j41(0,"div",17)(1,"p-tag",34),e.EFF(2),e.k0s()()),2&o){const t=e.XpG().$implicit,r=e.XpG();e.R7$(),e.Y8G("severity",r.getPriceIndexSeverity(t.ozonCompetitorPriceIndexValue)),e.R7$(),e.SpI(" \u041e\u0437\u043e\u043d: ",t.ozonCompetitorPriceIndexValue," ")}}function $t(o,c){1&o&&(e.j41(0,"tr")(1,"th"),e.EFF(2,"\u0421\u0445\u0435\u043c\u0430"),e.k0s(),e.j41(3,"th"),e.EFF(4,"\u041a\u043e\u043c\u0438\u0441\u0441\u0438\u044f, \u0432\u0430\u043b\u044e\u0442\u0430"),e.k0s(),e.j41(5,"th"),e.EFF(6,"\u041a\u043e\u043c\u0438\u0441\u0441\u0438\u044f, %"),e.k0s(),e.j41(7,"th"),e.EFF(8,"\u0414\u043e\u0441\u0442\u0430\u0432\u043a\u0430, \u0432\u0430\u043b\u044e\u0442\u0430"),e.k0s(),e.j41(9,"th"),e.EFF(10,"\u0412\u043e\u0437\u0432\u0440\u0430\u0442, \u0432\u0430\u043b\u044e\u0442\u0430"),e.k0s()())}function Nt(o,c){if(1&o&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.EFF(8),e.k0s(),e.j41(9,"td"),e.EFF(10),e.k0s()()),2&o){const t=c.$implicit;e.R7$(2),e.JRh(t.schema),e.R7$(2),e.JRh(t.commissionCost),e.R7$(2),e.JRh(t.commissionPercent),e.R7$(2),e.JRh(t.deliveryCost),e.R7$(2),e.JRh(t.returnCost)}}function Xt(o,c){if(1&o&&e.nrm(0,"button",35),2&o){const t=e.XpG(),n=t.$implicit;e.Y8G("icon",t.expanded?"pi pi-chevron-down":"pi pi-chevron-right")("pRowToggler",n)}}function Vt(o,c){if(1&o){const t=e.RV6();e.j41(0,"tr")(1,"td")(2,"a",20),e.nrm(3,"i",21),e.k0s(),e.j41(4,"a",20),e.nrm(5,"i",22),e.k0s()(),e.j41(6,"td"),e.EFF(7),e.k0s(),e.j41(8,"td"),e.EFF(9),e.k0s(),e.j41(10,"td"),e.DNE(11,Gt,3,2,"div",23)(12,Lt,3,2,"div",24)(13,At,3,2,"div",24),e.k0s(),e.j41(14,"td")(15,"p-checkbox",25),e.mxI("ngModelChange",function(n){const s=e.eBV(t).$implicit;return e.DH7(s.enableGeoTargeting,n)||(s.enableGeoTargeting=n),e.Njj(n)}),e.bIt("ngModelChange",function(){const n=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.updateGeoTargetingFlag(n))}),e.k0s()(),e.j41(16,"td",26)(17,"p-accordion")(18,"p-accordionTab",27)(19,"p-table",28),e.DNE(20,$t,11,0,"ng-template",3)(21,Nt,11,5,"ng-template",4),e.k0s()()()(),e.j41(22,"td")(23,"p-button",29),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG();return e.Njj(s.showBarcodeGenerator(n))}),e.k0s(),e.j41(24,"p-button",30),e.bIt("click",function(n){const s=e.eBV(t).$implicit,d=e.XpG();return e.Njj(d.confirmProductRemoval(n,s))}),e.k0s(),e.DNE(25,Xt,1,2,"button",31),e.k0s()()}if(2&o){const t=c.$implicit;e.R7$(2),e.Mz_("href","https://www.ozon.ru/product/",t.sku,"",e.B4B),e.R7$(2),e.Mz_("href","https://seller.ozon.ru/app/prices/control?search=",t.sku,"",e.B4B),e.R7$(3),e.JRh(t.productPackageID),e.R7$(2),e.JRh(t.name),e.R7$(2),e.Y8G("ngIf",t.externalCompetitorPriceIndexValue),e.R7$(),e.Y8G("ngIf",t.externalPriceIndexValue),e.R7$(),e.Y8G("ngIf",t.ozonCompetitorPriceIndexValue),e.R7$(2),e.R50("ngModel",t.enableGeoTargeting),e.Y8G("binary",!0),e.R7$(4),e.Y8G("value",t.commissions),e.R7$(6),e.Y8G("ngIf",null==t.stocks?null:t.stocks.length)}}function Yt(o,c){1&o&&(e.j41(0,"tr")(1,"th",39),e.EFF(2,"\u0421\u043a\u043b\u0430\u0434 "),e.nrm(3,"p-sortIcon",40),e.k0s(),e.j41(4,"th",41),e.EFF(5,"\u041a\u043b\u0430\u0441\u0442\u0435\u0440 "),e.nrm(6,"p-sortIcon",42),e.k0s(),e.j41(7,"th",43),e.EFF(8,"\u041d\u0430\u043b\u0438\u0447\u0438\u0435 "),e.nrm(9,"p-sortIcon",44),e.k0s(),e.j41(10,"th",45),e.EFF(11,"\u0420\u0435\u0437\u0435\u0440\u0432 "),e.nrm(12,"p-sortIcon",46),e.k0s(),e.j41(13,"th",47),e.EFF(14,"\u041d\u0430\u043b\u0438\u0447\u0438\u0435 (\u0443\u0446\u0435\u043d\u043a\u0430) "),e.nrm(15,"p-sortIcon",48),e.k0s(),e.j41(16,"th",49),e.EFF(17,"\u0420\u0435\u0437\u0435\u0440\u0432 (\u0443\u0446\u0435\u043d\u043a\u0430) "),e.nrm(18,"p-sortIcon",50),e.k0s()())}function Ht(o,c){if(1&o&&(e.qex(0),e.j41(1,"p-tag",52),e.EFF(2),e.k0s(),e.bVm()),2&o){const t=e.XpG().$implicit;e.R7$(2),e.JRh(t.cutPricePresent)}}function Wt(o,c){if(1&o&&(e.qex(0),e.EFF(1),e.bVm()),2&o){const t=e.XpG().$implicit;e.R7$(),e.JRh(t.cutPricePresent)}}function Ut(o,c){if(1&o&&(e.qex(0),e.j41(1,"p-tag",52),e.EFF(2),e.k0s(),e.bVm()),2&o){const t=e.XpG().$implicit;e.R7$(2),e.JRh(t.cutPriceReserved)}}function Jt(o,c){if(1&o&&(e.qex(0),e.EFF(1),e.bVm()),2&o){const t=e.XpG().$implicit;e.R7$(),e.JRh(t.cutPriceReserved)}}function qt(o,c){if(1&o&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td",51),e.EFF(6),e.k0s(),e.j41(7,"td",51),e.EFF(8),e.k0s(),e.j41(9,"td",51),e.DNE(10,Ht,3,1,"ng-container",36)(11,Wt,2,1,"ng-container",36),e.k0s(),e.j41(12,"td",51),e.DNE(13,Ut,3,1,"ng-container",36)(14,Jt,2,1,"ng-container",36),e.k0s()()),2&o){const t=c.$implicit;e.R7$(2),e.JRh(t.warehouse.name),e.R7$(2),e.JRh(null==t.warehouse.warehouseCluster?null:t.warehouse.warehouseCluster.name),e.R7$(2),e.JRh(t.present),e.R7$(2),e.JRh(t.reserved),e.R7$(2),e.Y8G("ngIf",t.cutPricePresent),e.R7$(),e.Y8G("ngIf",!t.cutPricePresent),e.R7$(2),e.Y8G("ngIf",t.cutPriceReserved),e.R7$(),e.Y8G("ngIf",!t.cutPriceReserved)}}function Qt(o,c){if(1&o&&(e.j41(0,"tr")(1,"td",53),e.EFF(2,"\u0412\u0441\u0435\u0433\u043e:"),e.k0s(),e.j41(3,"td",51),e.EFF(4),e.k0s(),e.j41(5,"td",51),e.EFF(6),e.k0s(),e.j41(7,"td",51),e.EFF(8),e.k0s(),e.j41(9,"td",51),e.EFF(10),e.k0s()()),2&o){const t=e.XpG(2).$implicit;e.R7$(4),e.JRh(t.totalPresent),e.R7$(2),e.JRh(t.totalReserved),e.R7$(2),e.JRh(t.totalCutDownPresent),e.R7$(2),e.JRh(t.totalCutDownReserved)}}function Kt(o,c){if(1&o&&(e.j41(0,"tr")(1,"td",37)(2,"div")(3,"p-table",28),e.DNE(4,Yt,19,0,"ng-template",3)(5,qt,15,8,"ng-template",4)(6,Qt,11,4,"ng-template",38),e.k0s()()()()),2&o){const t=e.XpG().$implicit;e.R7$(3),e.Y8G("value",t.stocks)}}function Zt(o,c){if(1&o&&e.DNE(0,Kt,7,1,"tr",36),2&o){const t=c.$implicit;e.Y8G("ngIf",null==t.stocks?null:t.stocks.length)}}function en(o,c){if(1&o){const t=e.RV6();e.qex(0),e.j41(1,"div",62)(2,"div",63)(3,"label",64),e.EFF(4,"\u0422\u0435\u043a\u0441\u0442"),e.k0s(),e.j41(5,"input",65),e.mxI("ngModelChange",function(n){const s=e.eBV(t).$implicit;return e.DH7(s.text,n)||(s.text=n),e.Njj(n)}),e.k0s()()(),e.j41(6,"div",63)(7,"label",66),e.EFF(8,"\u0420\u0430\u0437\u043c\u0435\u0440 \u0448\u0440\u0438\u0444\u0442\u0430"),e.k0s(),e.j41(9,"p-inputNumber",67),e.mxI("ngModelChange",function(n){const s=e.eBV(t).$implicit;return e.DH7(s.fontSize,n)||(s.fontSize=n),e.Njj(n)}),e.k0s()(),e.j41(10,"div",63)(11,"label",68),e.EFF(12,"\u0416\u0438\u0440\u043d\u044b\u0439"),e.k0s(),e.j41(13,"p-checkbox",69),e.mxI("ngModelChange",function(n){const s=e.eBV(t).$implicit;return e.DH7(s.bold,n)||(s.bold=n),e.Njj(n)}),e.k0s()(),e.bVm()}if(2&o){const t=c.$implicit;e.R7$(5),e.R50("ngModel",t.text),e.R7$(4),e.R50("ngModel",t.fontSize),e.Y8G("showButtons",!0),e.R7$(4),e.R50("ngModel",t.bold),e.Y8G("binary",!0)}}function tn(o,c){if(1&o&&(e.qSk(),e.qex(0),e.nrm(1,"rect",70),e.bVm()),2&o){const t=c.$implicit;e.R7$(),e.BMQ("width",3*t.width)("x",3*t.offset+89)}}function nn(o,c){if(1&o&&(e.qSk(),e.qex(0),e.nrm(1,"text",71),e.bVm()),2&o){const t=c.$implicit,r=c.index,n=e.XpG(3);e.R7$(),e.Y8G("innerHTML",t.text,e.npT),e.BMQ("font-size",t.fontSize)("font-weight",t.bold?"bold":"normal")("y",160+40*r/n.barcodeTexts.length)}}function on(o,c){if(1&o){const t=e.RV6();e.j41(0,"div",56),e.DNE(1,en,14,5,"ng-container",57),e.j41(2,"div")(3,"p-button",58),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.addBarcodeText())}),e.k0s()()(),e.j41(4,"div"),e.qSk(),e.j41(5,"svg",59),e.nrm(6,"rect",60),e.DNE(7,tn,2,2,"ng-container",57)(8,nn,2,4,"ng-container",57),e.k0s(),e.joV(),e.j41(9,"a",61),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.downloadBarcode())}),e.EFF(10,"\u0421\u043a\u0430\u0447\u0430\u0442\u044c"),e.k0s()()}if(2&o){const t=e.XpG(2);e.R7$(),e.Y8G("ngForOf",t.barcodeTexts),e.R7$(6),e.Y8G("ngForOf",t.barcodeData),e.R7$(),e.Y8G("ngForOf",t.barcodeTexts),e.R7$(),e.Y8G("download",t.selectedProductForBarcode.productPackageID+".png")}}function rn(o,c){if(1&o){const t=e.RV6();e.j41(0,"p-dialog",54),e.bIt("onShow",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onShowBarcodeDialog())}),e.DNE(1,on,11,4,"ng-template",55),e.k0s()}if(2&o){const t=e.XpG();e.Aen(e.lJ4(6,Pt)),e.Y8G("draggable",!1)("modal",!0)("resizable",!1)("visible",!!t.selectedProductForBarcode)}}let un=(()=>{class o extends p.x{addBarcodeText(){this.barcodeTexts=[...this.barcodeTexts,{fontSize:10,text:"",bold:!1}]}constructor(t,r,n,s,d,S){super(S),this.ozonProductClient=t,this.messageService=r,this.ozonProductCommandHandler=n,this.route=s,this.confirmationService=d,this.barcodeHeight=10,this.priceIndexFilter=null,this.filterModel={count:50,includeStocks:!0,offset:0},this.findModelSubject=new b.t(null),this.idFilterSubject=new b.t(null),this.nameFilterSubject=new b.t(null)}ngOnInit(){this.titleService.setTitle("Ozon Products");const t=this.route.snapshot.paramMap.get("ids");t&&(this.ids=t.split(",").map(r=>+r)),this.px2mmFactor=this.calcPx2MmFactor(),this.idFilterSubject.pipe((0,k.p)(r=>!r||r>=100)).pipe(he(()=>ge(500))).subscribe(()=>this.updateFilter()),this.nameFilterSubject.pipe((0,k.p)(r=>!r||r.length>2)).pipe(he(()=>ge(500))).subscribe(()=>this.updateFilter()),this.findModelSubject.pipe((0,O.Q)(this.destroyed)).pipe((0,k.p)(r=>!!r&&r.count>0)).subscribe(r=>{this.findProducts(new i.D.FindOzonProductsModel(r))})}findProducts(t){this.loading=!0,this.ozonProductClient.findOzonProducts(t).pipe((0,O.Q)(this.destroyed)).pipe((0,g.W)(r=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430",severity:"error",detail:r}),this.loading=!1,y.w))).subscribe(r=>{this.loading=!1,r.items?.forEach(n=>{let s=0,d=0,S=0,x=0;n.stocks.forEach(B=>{s+=B.present,d+=B.reserved,x+=B.discountedPresent,S+=B.discountedReserved});const j=[n.externalCompetitorPriceIndexValue,n.externalPriceIndexValue,n.ozonCompetitorPriceIndexValue].filter(B=>B>0),D=Math.max(...j);Object.assign(n,{totalPresent:s,totalReserved:d,totalCutDownPresent:x,totalCutDownReserved:S,hasPriceIndex:D>0,hasBadPriceIndex:D>1.01})}),this.data=r.items,this.totalRecords=r.totalCount})}confirmProductRemoval(t,r){this.confirmationService.confirm({target:t.target,message:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0442\u043e\u0432\u0430\u0440?",header:"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u0435 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f",icon:"pi pi-exclamation-triangle",acceptIcon:"none",rejectIcon:"none",rejectButtonStyleClass:"p-button-text",accept:()=>{this.ozonProductCommandHandler.removeOzonProduct(r.productPackageID).pipe((0,g.W)(n=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u0442\u043e\u0432\u0430\u0440\u0430",severity:"error",detail:n}),y.w))).subscribe(()=>{const n=this.data.indexOf(r);this.data.splice(n,1),this.messageService.add({summary:"\u0422\u043e\u0432\u0430\u0440 \u0443\u0434\u0430\u043b\u0451\u043d",severity:"success"})})}})}onDataLazyLoad(t){if(this.filterModel.offset=t.first,t.sortField){switch(t.sortField){case"name":this.filterModel.orderField=i.D.FindOzonProductsModelSortField.ProductName;break;case"productPackageID":this.filterModel.orderField=i.D.FindOzonProductsModelSortField.ProductPackageID}this.filterModel.orderAscending=t.sortOrder>0}this.updateFilter()}onShowBarcodeDialog(){this.barcodeTexts=[]}calcPx2MmFactor(){const t=document.createElement("div");t.style.position="absolute",t.style.width="100mm",document.body.appendChild(t);const r=t.getBoundingClientRect();return document.body.removeChild(t),r.width/100}showBarcodeGenerator(t){if(t.barcodes?.length>0){this.selectedProductForBarcode=t;const r=this.selectedProductForBarcode.barcodes[0],n={};It(n,r,{format:"code128",height:this.barcodeHeight*this.px2mmFactor,text:r,background:"rgba(255, 255, 255, 1)",font:"monospace",fontOptions:"bold",marginTop:0,fontSize:16,lineColor:"black",margin:2*this.px2mmFactor,textMargin:0,flat:!0});const s=[];let d;for(let S=0;S<n.encodings[0].data.length;S++)"1"==n.encodings[0].data[S]?d?d.width++:d={width:1,offset:S}:d?.width>0&&(s.push(d),d=null);d&&s.push(d),this.barcodeData=s}}downloadBarcode(){var t=this;return(0,C.A)(function*(){yield new Promise(()=>{try{const s=document.getElementById("barcodeImage").outerHTML,d=btoa(encodeURIComponent(s).replace(/%([0-9A-F]{2})/g,(x,j)=>String.fromCharCode(parseInt(j,16)))),S=document.createElement("a");S.href="data:image/svg+xml;base64,"+d,S.download=t.selectedProductForBarcode.productPackageID+".svg",S.click()}catch(n){t.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430",severity:"error",detail:n})}})})()}importProducts(){var t=this;return(0,C.A)(function*(){yield t.ozonProductCommandHandler.importOzonProducts().pipe((0,g.W)(r=>(t.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0438\u043c\u043f\u043e\u0440\u0442\u0430 \u0442\u043e\u0432\u0430\u0440\u043e\u0432",severity:"error",detail:r}),y.w))).subscribe(()=>{t.messageService.add({summary:"\u0423\u0441\u043f\u0435\u0445",severity:"success",detail:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0430"}),t.filterModel.offset=0,t.updateFilter()})})()}updateStocks(){var t=this;return(0,C.A)(function*(){t.ozonProductCommandHandler.importOzonProductStocks().pipe((0,g.W)(r=>(t.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430",severity:"error",detail:r}),y.w))).subscribe(()=>{t.messageService.add({summary:"\u0423\u0441\u043f\u0435\u0445",severity:"success",detail:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0441\u043a\u043b\u0430\u0434\u043e\u0432 \u041e\u0437\u043e\u043d \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0430"}),t.filterModel.offset=0,t.updateFilter()})})()}getPriceIndexSeverity(t){let r;return r=t<=1.01?"success":t<=1.05?"warning":"danger",r}updateFilter(){this.filterModel.iDs=this.ids,this.filterModel.hasBadPriceIndex=!1===this.priceIndexFilter,this.filterModel.hasAnyPriceIndex=this.priceIndexFilter,this.filterModel.productName=this.nameFilterSubject.value,this.filterModel.productPackageID=this.idFilterSubject.value,this.findModelSubject.next(this.filterModel)}clearIDFilter(){this.idFilterSubject.next(null)}clearNameFilter(){this.nameFilterSubject.next(null)}updateGeoTargetingFlag(t){this.ozonProductCommandHandler.updateOzonProducts([new Tt({productPackageID:t.productPackageID,enableGeoTargeting:t.enableGeoTargeting})]).pipe((0,g.W)(r=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0442\u043e\u0432\u0430\u0440\u0430",severity:"error",detail:r}),y.w))).subscribe(()=>{this.messageService.add({summary:"\u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0442\u043e\u0432\u0430\u0440\u0430",severity:"success",detail:`\u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0442\u043e\u0432\u0430\u0440\u0430 ${t.productPackageID} \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u043e`})})}static{this.\u0275fac=function(r){return new(r||o)(e.rXU(i.D.OzonProductClient),e.rXU(l.bg),e.rXU(a.X.OzonProductClient),e.rXU(E.nX),e.rXU(l.td),e.rXU(h.hE))}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["app-ozon-product-list"]],features:[e.Vt3],decls:11,vars:13,consts:[["label","\u0418\u043c\u043f\u043e\u0440\u0442 \u0442\u043e\u0432\u0430\u0440\u043e\u0432","pButton","","pRipple","","type","button",1,"mb-2",3,"click"],["label","\u0418\u043c\u043f\u043e\u0440\u0442 \u043e\u0441\u0442\u0430\u0442\u043a\u043e\u0432","pButton","","pRipple","","type","button",1,"ml-1","mb-2",3,"click"],["dataKey","productPackageID",3,"onLazyLoad","globalFilterFields","lazy","loading","paginator","rowsPerPageOptions","rows","tableStyle","totalRecords","value"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["header","\u0413\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u044f \u0431\u0430\u0440\u043a\u043e\u0434\u0430",3,"draggable","modal","resizable","style","visible","onShow",4,"ngIf"],[1,"hidden"],["id","barcode",2,"display","none"],["pSortableColumn","productPackageID","width","20%"],["field","productPackageID"],["pSortableColumn","name"],["field","name"],[1,"flex","flex-nowrap"],["pInputText","",3,"ngModelChange","ngClass","ngModel","useGrouping"],["icon","pi pi-trash","pButton","",3,"click",4,"ngIf"],["pInputText","","type","text",3,"ngModelChange","ngModel"],[1,"flex","white-space-nowrap"],["inputId","priceIndexFilter",3,"ngModelChange","ngModel","label"],["icon","pi pi-trash","pButton","",3,"click"],["target","_blank",3,"href"],[1,"pi","ozon-fbo"],[1,"pi","ozon-seller"],["class","flex-nowrap",4,"ngIf"],["class","flex white-space-nowrap",4,"ngIf"],[3,"ngModelChange","ngModel","binary"],["width","1%"],["header","\u041a\u043e\u043c\u0438\u0441\u0441\u0438\u0438"],[3,"value"],["icon","pi pi-chart-bar",3,"click"],["icon","pi pi-trash","pRipple","","styleClass","p-button-danger","type","button",3,"click"],["class","p-button-text p-button-rounded p-button-plain","pButton","","pRipple","","type","button",3,"icon","pRowToggler",4,"ngIf"],[1,"flex-nowrap"],[1,"flex","white-space-nowrap",3,"severity"],[3,"severity"],["pButton","","pRipple","","type","button",1,"p-button-text","p-button-rounded","p-button-plain",3,"icon","pRowToggler"],[4,"ngIf"],["colspan","6"],["pTemplate","footer"],["pSortableColumn","warehouse.name"],["field","warehouse.name"],["pSortableColumn","warehouse.warehouseCluster.name"],["field","warehouse.warehouseCluster.name"],["pSortableColumn","present","width","10%"],["field","present"],["pSortableColumn","reserved","width","10%"],["field","reserved"],["pSortableColumn","cutPricePresent","width","10%"],["field","cutPricePresent"],["pSortableColumn","cutPriceReserved","width","10%"],["field","cutPriceReserved"],[1,"text-right"],["severity","danger"],["colspan","2",1,"text-right"],["header","\u0413\u0435\u043d\u0435\u0440\u0430\u0446\u0438\u044f \u0431\u0430\u0440\u043a\u043e\u0434\u0430",3,"onShow","draggable","modal","resizable","visible"],["pTemplate","content"],[1,"card"],[4,"ngFor","ngForOf"],["icon","pi pi-plus","label","\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0442\u0435\u043a\u0441\u0442",3,"click"],["id","barcodeImage","xmlns","http://www.w3.org/2000/svg"],["fill","white","height","600em","width","350em"],[1,"p-ripple","p-element","p-button","p-component",3,"click","download"],[1,"flex"],[1,"flex-auto"],["for","text",1,"block","font-bold"],["inputId","text","pInputText","",3,"ngModelChange","ngModel"],["for","fontSize",1,"mb-2","block","font-bold"],["inputId","fontSize",3,"ngModelChange","ngModel","showButtons"],["for","fontWeight",1,"mb-2","block","font-bold"],["inputId","binary",3,"ngModelChange","ngModel","binary"],["fill","black","height","60","y","50"],["fill","black","text-anchor","middle","x","50%",3,"innerHTML"]],template:function(r,n){1&r&&(e.nrm(0,"p-toast")(1,"p-confirmDialog"),e.j41(2,"button",0),e.bIt("click",function(){return n.importProducts()}),e.k0s(),e.j41(3,"button",1),e.bIt("click",function(){return n.updateStocks()}),e.k0s(),e.j41(4,"p-table",2),e.bIt("onLazyLoad",function(d){return n.onDataLazyLoad(d)}),e.DNE(5,Bt,35,17,"ng-template",3)(6,Vt,26,13,"ng-template",4)(7,Zt,1,1,"ng-template",5),e.k0s(),e.DNE(8,rn,2,7,"p-dialog",6),e.j41(9,"div",7),e.qSk(),e.nrm(10,"svg",8),e.k0s()),2&r&&(e.R7$(4),e.Y8G("globalFilterFields",e.lJ4(10,Dt))("lazy",!0)("loading",n.loading)("paginator",!0)("rowsPerPageOptions",e.lJ4(11,jt))("rows",n.filterModel.count)("tableStyle",e.lJ4(12,wt))("totalRecords",n.totalRecords)("value",n.data),e.R7$(4),e.Y8G("ngIf",n.selectedProductForBarcode))},dependencies:[de.nD,de.gV,l.Ei,F._f,F.$n,te.Sc,ne.S,v.YU,v.Sq,v.bT,ve.T,oe.l,P.me,P.BC,P.vS,ie.YI,M.XI,M.Tg,M.FP,M.yc,K.v,z.y8,be.kk,v.Jj]})}}return o})();var an=f(6354);const sn=["table"],ln=()=>({"min-width":"75rem"}),cn=()=>[10,25,50],pn=()=>({width:"50vw"}),dn=()=>["code_128","ean","upc","upc_e","ean_8"];function _n(o,c){1&o&&(e.j41(0,"tr")(1,"th"),e.EFF(2,"\u0414\u0430\u0442\u0430"),e.k0s(),e.j41(3,"th"),e.EFF(4,"\u0421\u0442\u0430\u0442\u0443\u0441"),e.k0s(),e.j41(5,"th"),e.EFF(6,"\u0421\u043a\u043b\u0430\u0434 \u043e\u0442\u0433\u0440\u0443\u0437\u043a\u0438"),e.k0s(),e.j41(7,"th"),e.EFF(8,"\u0421\u043a\u043b\u0430\u0434\u044b \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f"),e.k0s(),e.j41(9,"th"),e.EFF(10,"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u043e\u0437\u0438\u0446\u0438\u0439"),e.k0s(),e.j41(11,"th"),e.EFF(12,"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0442\u043e\u0432\u0430\u0440\u043e\u0432"),e.k0s(),e.nrm(13,"th"),e.k0s())}function fn(o,c){if(1&o&&(e.j41(0,"tr")(1,"td")(2,"a",8),e.EFF(3),e.nI1(4,"date"),e.k0s()(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.EFF(8),e.k0s(),e.j41(9,"td"),e.EFF(10),e.k0s(),e.j41(11,"td"),e.EFF(12),e.k0s(),e.j41(13,"td"),e.EFF(14),e.k0s(),e.j41(15,"td"),e.nrm(16,"button",9),e.k0s()()),2&o){const t=c.$implicit,r=c.expanded;e.R7$(2),e.FS9("href",t.link,e.B4B),e.R7$(),e.JRh(e.i5U(4,9,t.date,"y-MM-dd")),e.R7$(3),e.JRh(t.statusName),e.R7$(2),e.JRh(null==t.ozonWarehouse?null:t.ozonWarehouse.name),e.R7$(2),e.JRh(t.warehouses),e.R7$(2),e.JRh(t.totalItemCount),e.R7$(2),e.JRh(t.totalQuantity),e.R7$(2),e.Y8G("pRowToggler",t)("icon",r?"pi pi-chevron-down":"pi pi-chevron-right")}}function mn(o,c){1&o&&(e.j41(0,"tr")(1,"th",13),e.EFF(2,"\u0410\u0440\u0442\u0438\u043a\u0443\u043b "),e.nrm(3,"p-sortIcon",14),e.k0s(),e.j41(4,"th",15),e.EFF(5,"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435 "),e.nrm(6,"p-sortIcon",16),e.k0s(),e.j41(7,"th",17),e.EFF(8,"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e "),e.nrm(9,"p-sortIcon",18),e.k0s()())}function hn(o,c){if(1&o&&(e.j41(0,"tr",19)(1,"td",10)(2,"b"),e.EFF(3),e.k0s()()()),2&o){const t=c.$implicit;e.R7$(3),e.JRh(null==t.ozonWarehouse?null:t.ozonWarehouse.name)}}function gn(o,c){if(1&o&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s()()),2&o){const t=c.$implicit;e.R7$(2),e.JRh(t.productPackageID),e.R7$(2),e.JRh(t.productPackage.name),e.R7$(2),e.JRh(t.quantity)}}function vn(o,c){if(1&o&&(e.j41(0,"tr")(1,"td",10)(2,"p-table",11),e.DNE(3,mn,10,0,"ng-template",4)(4,hn,4,1,"ng-template",12)(5,gn,7,3,"ng-template",5),e.k0s()()()),2&o){const t=c.$implicit;e.R7$(2),e.Y8G("value",t.orderItems)}}function bn(o,c){if(1&o){const t=e.RV6();e.j41(0,"ngx-barcode-scanner",22),e.bIt("valueChange",function(n){e.eBV(t);const s=e.XpG(2);return e.Njj(s.onValueChanged(n))}),e.k0s(),e.EFF(1)}if(2&o){const t=e.XpG(2);e.Y8G("codes",e.lJ4(3,dn))("errorThreshold",.1),e.R7$(),e.SpI(" ",t.barcode," ")}}function yn(o,c){if(1&o){const t=e.RV6();e.j41(0,"p-dialog",20),e.mxI("valueChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.barcode,n)||(s.barcode=n),e.Njj(n)})("visibleChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.showScanBarcodeDialog,n)||(s.showScanBarcodeDialog=n),e.Njj(n)}),e.DNE(1,bn,2,4,"ng-template",21),e.k0s()}if(2&o){const t=e.XpG();e.Aen(e.lJ4(7,pn)),e.R50("value",t.barcode),e.Y8G("modal",!0),e.R50("visible",t.showScanBarcodeDialog),e.Y8G("draggable",!1)("resizable",!1)}}let Cn=(()=>{class o extends p.x{constructor(t,r,n,s){super(s),this.supplyOrderClient=t,this.supplyOrderCommandHandler=r,this.messageService=n,this.findSupplyOrdersSubject=new b.t(null),this.rows=50}closeCellEdit(){}editComplete(t){if("ozonCrossDockWarehouseID"==t.field){const r=t.data;this.supplyOrderCommandHandler.updateOzonSupplyOrderCrossDockWarehouse(r.iD,r.ozonCrossDockWarehouse?.iD).pipe((0,g.W)(n=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430",severity:"error",detail:n}),y.w))).subscribe()}}ngOnInit(){this.titleService.setTitle("\u041f\u043e\u0441\u0442\u0430\u0432\u043a\u0438 Ozon"),this.findSupplyOrdersSubject.pipe((0,k.p)(t=>!!t)).pipe((0,O.Q)(this.destroyed)).pipe((0,an.T)(t=>{this.findSupplyOrders(t)}))}onValueChanged(t){}scanBarcode(){this.showScanBarcodeDialog=!0}findSupplyOrders(t){this.supplyOrderClient.findOzonSupplyOrders(t).pipe((0,O.Q)(this.destroyed)).pipe((0,g.W)(r=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430",severity:"error",detail:r}),y.w))).subscribe(r=>{this.data=r.items,this.data.forEach(n=>{const s=n.orderItems.reduce((x,j)=>(j.ozonWarehouse?.name&&x.add(j.ozonWarehouse.name),x),new Set),d=n;d.statusName=this.getOrderStatusName(n.status),d.warehouses=[...s].join(", "),d.link=`${n.state==i.D.SupplyOrderState.DataFilling?"https://seller.ozon.ru/app/supply/orders/draft":"https://seller.ozon.ru/app/supply/orders"}/${d.iD}`}),this.totalRecords=r.totalCount})}getOrderStatusName(t){let r;const n=Object.values(i.D.SupplyOrderState);switch(null==t?i.D.SupplyOrderState.Unknown:n[t]){case i.D.SupplyOrderState.AcceptanceAtStorageWarehouse:r="\u041f\u0440\u0438\u0451\u043c\u043a\u0430 \u043d\u0430 \u0441\u043a\u043b\u0430\u0434\u0435 \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f";break;case i.D.SupplyOrderState.Cancelled:r="\u041e\u0442\u043c\u0435\u043d\u0435\u043d\u0430";break;case i.D.SupplyOrderState.DataFilling:r="\u0417\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435";break;case i.D.SupplyOrderState.AcceptedAtSupplyWarehouse:r="\u041f\u0440\u0438\u043d\u044f\u0442\u0430 \u043d\u0430 \u0441\u043a\u043b\u0430\u0434\u0435 \u043e\u0442\u0433\u0440\u0443\u0437\u043a\u0438";break;case i.D.SupplyOrderState.Completed:r="\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0430";break;case i.D.SupplyOrderState.InTransit:r="\u0412 \u043f\u0443\u0442\u0438";break;case i.D.SupplyOrderState.ReadyToSupply:r="\u0413\u043e\u0442\u043e\u0432\u0430 \u043a \u043e\u0442\u0433\u0440\u0443\u0437\u043a\u0435";break;case i.D.SupplyOrderState.RejectedAtSupplyWarehouse:r="\u041e\u0442\u043a\u0430\u0437\u0430\u043d\u043e \u0432 \u043f\u0440\u0438\u0451\u043c\u043a\u0435";break;case i.D.SupplyOrderState.ReportRejected:r="\u0421\u043f\u043e\u0440";break;case i.D.SupplyOrderState.ReportsConfirmationAwaiting:r="\u0421\u043e\u0433\u043b\u0430\u0441\u043e\u0432\u0430\u043d\u0438\u0435 \u0430\u043a\u0442\u043e\u0432";break;case i.D.SupplyOrderState.Unknown:r="\u0421\u0442\u0430\u0442\u0443\u0441 \u043d\u0435 \u0437\u0430\u0434\u0430\u043d";break;default:throw Error(`Unsupported status ${t}`)}return r}onDataLazyLoad(t){const r=new i.D.FindOzonSupplyOrdersModel({offset:t.first,count:t.rows});this.findSupplyOrdersSubject.next(r),this.findSupplyOrders(r)}importSupplyOrders(){var t=this;return(0,C.A)(function*(){t.supplyOrderCommandHandler.updateOzonSupplyOrders().pipe((0,g.W)(r=>(t.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0438\u043c\u043f\u043e\u0440\u0442\u0430 \u0437\u0430\u044f\u0432\u043e\u043a \u043d\u0430 \u043f\u043e\u0441\u0442\u0430\u0432\u043a\u0443",severity:"error",detail:r}),y.w))).subscribe(()=>{t.messageService.add({summary:"\u0423\u0441\u043f\u0435\u0445",severity:"success",detail:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0437\u0430\u044f\u0432\u043e\u043a \u043d\u0430 \u043f\u043e\u0441\u0442\u0430\u0432\u043a\u0443 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0430"}),t.onDataLazyLoad({first:0,rows:t.rows})})})()}static{this.\u0275fac=function(r){return new(r||o)(e.rXU(i.D.OzonSupplyOrderClient),e.rXU(a.X.OzonSupplyOrderClient),e.rXU(l.bg),e.rXU(h.hE))}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["app-ozon-supply-order-list"]],viewQuery:function(r,n){if(1&r&&e.GBs(sn,5),2&r){let s;e.mGM(s=e.lsd())&&(n.table=s.first)}},features:[e.Vt3],decls:9,vars:11,consts:[["table",""],["label","\u0421\u043a\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u0442\u044c",3,"click"],["pButton","","pRipple","","type","button","label","\u0418\u043c\u043f\u043e\u0440\u0442 \u0437\u0430\u044f\u0432\u043e\u043a \u043d\u0430 \u043f\u043e\u0441\u0442\u0430\u0432\u043a\u0443",1,"ml-1",3,"click"],["dataKey","iD","editMode","cell",3,"onLazyLoad","onEditComplete","value","lazy","tableStyle","paginator","rows","rowsPerPageOptions","totalRecords","loading"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["header","\u0421\u043a\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043a\u043e\u0434\u0430",3,"value","modal","style","visible","draggable","resizable","valueChange","visibleChange",4,"ngIf"],["target","_blank",3,"href"],["type","button","pButton","","pRipple","",1,"p-button-text","p-button-rounded","p-button-plain",3,"pRowToggler","icon"],["colspan","7"],["rowGroupMode","subheader","groupRowsBy","ozonWarehouse?.name",3,"value"],["pTemplate","groupheader"],["pSortableColumn","productPackageID"],["field","productPackageID"],["pSortableColumn","productPackage.name"],["field","productPackage.name"],["pSortableColumn","quantity"],["field","quantity"],["pRowGroupHeader",""],["header","\u0421\u043a\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043a\u043e\u0434\u0430",3,"valueChange","visibleChange","value","modal","visible","draggable","resizable"],["pTemplate","content"],["width","300",3,"valueChange","codes","errorThreshold"]],template:function(r,n){if(1&r){const s=e.RV6();e.nrm(0,"p-toast"),e.j41(1,"p-button",1),e.bIt("click",function(){return e.eBV(s),e.Njj(n.scanBarcode())}),e.k0s(),e.j41(2,"button",2),e.bIt("click",function(){return e.eBV(s),e.Njj(n.importSupplyOrders())}),e.k0s(),e.j41(3,"p-table",3,0),e.bIt("onLazyLoad",function(S){return e.eBV(s),e.Njj(n.onDataLazyLoad(S))})("onEditComplete",function(S){return e.eBV(s),e.Njj(n.editComplete(S))}),e.DNE(5,_n,14,0,"ng-template",4)(6,fn,17,12,"ng-template",5)(7,vn,6,1,"ng-template",6),e.k0s(),e.DNE(8,yn,2,8,"p-dialog",7)}2&r&&(e.R7$(3),e.Y8G("value",n.data)("lazy",!0)("tableStyle",e.lJ4(9,ln))("paginator",!0)("rows",n.rows)("rowsPerPageOptions",e.lJ4(10,cn))("totalRecords",n.totalRecords)("loading",n.loading),e.R7$(5),e.Y8G("ngIf",n.showScanBarcodeDialog))},dependencies:[l.Ei,F._f,F.$n,v.bT,oe.l,M.XI,M.Tg,M.$I,M.FP,M.yc,z.y8,v.vh]})}}return o})();var re=f(5558),ye=f(2102);const En=()=>[50,250,1e3],On=()=>({"max-width":"300px"}),kn=()=>({"min-width":"50rem"});function Fn(o,c){if(1&o&&(e.j41(0,"div"),e.EFF(1),e.nI1(2,"number"),e.k0s(),e.j41(3,"div"),e.EFF(4),e.nI1(5,"number"),e.k0s(),e.j41(6,"div"),e.EFF(7),e.nI1(8,"number"),e.k0s(),e.j41(9,"div"),e.EFF(10),e.nI1(11,"number"),e.k0s()),2&o){const t=e.XpG().ngIf;e.R7$(),e.SpI("\u0421\u0443\u043c\u043c\u0430: ",e.i5U(2,4,t.sum,"1.2-2"),""),e.R7$(3),e.SpI("\u041d\u0430\u0447\u0438\u0441\u043b\u0435\u043d\u043e: ",e.i5U(5,7,t.accrual,"1.2-2"),""),e.R7$(3),e.SpI("\u041a\u043e\u043c\u0438\u0441\u0441\u0438\u044f: ",e.i5U(8,10,t.commission,"1.2-2"),""),e.R7$(3),e.SpI("\u041d\u0430\u0447\u0438\u0441\u043b\u0435\u043d\u043e \u0437\u0430 \u0432\u044b\u0447\u0435\u0442\u043e\u043c \u043a\u043e\u043c\u0438\u0441\u0441\u0438\u0438: ",e.i5U(11,13,t.accrual+t.commission,"1.2-2"),"")}}function Sn(o,c){if(1&o){const t=e.RV6();e.j41(0,"tr")(1,"th"),e.EFF(2,"ID"),e.k0s(),e.j41(3,"th"),e.EFF(4,"\u0414\u0430\u0442\u0430"),e.k0s(),e.j41(5,"th",11),e.EFF(6,"\u0421\u0443\u043c\u043c\u0430 "),e.nrm(7,"p-sortIcon",12),e.k0s(),e.j41(8,"th"),e.EFF(9,"\u0421\u0435\u0440\u0432\u0438\u0441\u044b"),e.k0s(),e.nrm(10,"th"),e.k0s(),e.j41(11,"tr"),e.nrm(12,"th")(13,"th")(14,"th"),e.j41(15,"th")(16,"p-multiSelect",13),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG(2);return e.DH7(s.selectedServiceTypes,n)||(s.selectedServiceTypes=n),e.Njj(n)}),e.bIt("onChange",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.filterData())}),e.k0s()(),e.nrm(17,"th"),e.k0s()}if(2&o){const t=e.XpG(2);e.R7$(16),e.Aen(e.lJ4(4,On)),e.R50("ngModel",t.selectedServiceTypes),e.Y8G("options",t.serviceTypes)}}function Rn(o,c){if(1&o&&(e.j41(0,"div")(1,"div",17)(2,"div"),e.EFF(3),e.k0s(),e.j41(4,"div"),e.EFF(5),e.nI1(6,"number"),e.k0s()()()),2&o){const t=c.$implicit,r=e.XpG(3);e.R7$(3),e.JRh(r.getOperationServiceType(t.type)),e.R7$(2),e.JRh(e.i5U(6,2,t.price,"1.2-2"))}}function In(o,c){if(1&o&&(e.j41(0,"tr",14)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.nI1(5,"date"),e.k0s(),e.j41(6,"td")(7,"span",15),e.EFF(8,"\u0421\u0443\u043c\u043c\u0430"),e.k0s(),e.j41(9,"div"),e.EFF(10),e.nI1(11,"number"),e.k0s()(),e.j41(12,"td"),e.DNE(13,Rn,7,5,"div",16),e.k0s(),e.j41(14,"td"),e.EFF(15),e.k0s()()),2&o){const t=c.$implicit,r=e.XpG(2);e.Y8G("pRowToggler",t),e.R7$(2),e.SpI(" ",t.iD," "),e.R7$(2),e.SpI(" ",e.i5U(5,6,t.date,"y-MM-dd HH:mm")," "),e.R7$(6),e.SpI(" ",e.i5U(11,9,t.amount,"1.2-2"),"\u20bd "),e.R7$(3),e.Y8G("ngForOf",t.services),e.R7$(2),e.JRh(r.getOperationType(t.operationType))}}function Tn(o,c){1&o&&(e.j41(0,"tr")(1,"th"),e.EFF(2,"\u0422\u0438\u043f"),e.k0s(),e.j41(3,"th"),e.EFF(4,"\u0421\u0443\u043c\u043c\u0430"),e.k0s()())}function Dn(o,c){if(1&o&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s()()),2&o){const t=c.$implicit,r=e.XpG(3);e.R7$(2),e.Lme("",r.getOperationServiceType(t.type),"",t.type,""),e.R7$(2),e.JRh(t.price)}}function jn(o,c){if(1&o&&(e.j41(0,"tr")(1,"td",18)(2,"h5"),e.EFF(3,"\u0421\u0435\u0440\u0432\u0438\u0441\u044b \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0438"),e.k0s()()(),e.j41(4,"tr")(5,"td",18)(6,"p-table",19),e.DNE(7,Tn,5,0,"ng-template",8)(8,Dn,5,3,"ng-template",9),e.k0s()()()),2&o){const t=c.$implicit;e.R7$(6),e.Y8G("value",t.services)("breakpoint","960px")("tableStyle",e.lJ4(3,kn))}}function wn(o,c){if(1&o){const t=e.RV6();e.j41(0,"div",5)(1,"p-table",6),e.bIt("onPage",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.pageChange(n))}),e.DNE(2,Fn,12,16,"ng-template",7)(3,Sn,18,5,"ng-template",8)(4,In,16,12,"ng-template",9)(5,jn,9,4,"ng-template",10),e.k0s()()}if(2&o){const t=c.ngIf,r=e.XpG();e.R7$(),e.Y8G("value",t.items)("loading",r.loading)("totalRecords",t.totalCount)("paginator",!0)("showCurrentPageReport",!1)("rows",r.rows)("rowsPerPageOptions",e.lJ4(7,En))}}let xn=(()=>{class o extends p.x{constructor(t,r,n,s,d){super(d),this.operationClient=t,this.messageService=r,this.operationCommandHandler=n,this.timeService=s,this.rows=50,this.isLoading=!1,this.serviceTypes=[],this.selectedServiceTypes=[],this.operationServiceTypes=Object.values(i.D.OperationServiceType),this.operationTypes=Object.values(i.D.OperationType),this.filteredData=new b.t(null),this.dataSubject=new b.t(null),this.filterSubject=new b.t(null),this.serviceTypes=Object.keys(i.D.OperationServiceType).map(S=>({type:S,text:i.D.OperationServiceType[S]})).sort((S,x)=>S.text>x.text?1:x.text>S.text?-1:0)}ngOnInit(){this.titleService.setTitle("\u0422\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u0438 Ozon"),this.filterSubject.pipe((0,O.Q)(this.destroyed)).pipe((0,k.p)(t=>!!t)).pipe((0,re.n)(t=>this.operationClient.findOzonOperations(t).pipe((0,g.W)(r=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430",severity:"error",detail:r}),y.w))))).subscribe(t=>{this.dataSubject.next(t)}),this.dataSubject.pipe((0,O.Q)(this.destroyed)).pipe((0,k.p)(t=>!!t)).pipe((0,g.W)(t=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430",severity:"error",detail:t}),y.w))).subscribe(()=>{this.filterData()})}filterData(){const t=this.dataSubject.value,r=[];let n=0,s=0,d=0;if(t)for(const x of t.items){let j=!0;const D=Object.assign({},x);if(this.selectedServiceTypes.length){const G=D.services.filter(B=>this.selectedServiceTypes.find(R=>R==B.type));G.length?D.services=G:j=!1}j&&(r.push(D),s+=D.accrualsForSale,d+=D.saleCommission,n+=D.services.reduce((G,B)=>G+B.price,0)??0)}this.filteredData.next({totalCount:r.length,items:r,sum:n,commission:d,accrual:s})}importTransactions(){var t=this;return(0,C.A)(function*(){const[r,n]=[t.timeService.asUtc(t.dateRange?.[0]),t.timeService.asUtc(t.dateRange?.[1])];t.operationCommandHandler.importOzonOperations(r,n).pipe((0,g.W)(s=>(t.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430",severity:"error",detail:s}),y.w))).subscribe(()=>{t.messageService.add({summary:"\u0423\u0441\u043f\u0435\u0445",severity:"success",detail:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u0439 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0430"}),t.findTransactionsClick()})})()}findTransactionsClick(){const t=new i.D.FindOzonOperationsModel({dateFrom:this.timeService.asUtc(this.dateRange?.[0]),dateTo:this.timeService.asUtc(this.dateRange?.[1]),offset:0,count:this.rows});this.filterSubject.next(t)}getOperationServiceType(t){return this.operationServiceTypes[t]}getOperationType(t){return this.operationTypes[t]}static{this.\u0275fac=function(r){return new(r||o)(e.rXU(i.D.OperationClient),e.rXU(l.bg),e.rXU(a.X.OperationClient),e.rXU(ye.v),e.rXU(h.hE))}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["app-ozon-transaction-list"]],features:[e.Vt3],decls:7,vars:7,consts:[["header","\u0422\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u0438 Ozon"],["styleClass","m-1","selectionMode","range","placeholder","\u041f\u0435\u0440\u0438\u043e\u0434",3,"ngModelChange","ngModel","showClear","readonlyInput"],["styleClass","m-1","icon","pi pi-search","label","\u041d\u0430\u0439\u0442\u0438 \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u0438",3,"click"],["styleClass","m-1","label","\u0418\u043c\u043f\u043e\u0440\u0442 \u0442\u0440\u0430\u043d\u0437\u0430\u043a\u0446\u0438\u0439",3,"click","icon"],["class","card",4,"ngIf"],[1,"card"],["responsiveLayout","stack","dataKey","iD",3,"onPage","value","loading","totalRecords","paginator","showCurrentPageReport","rows","rowsPerPageOptions"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["pSortableColumn","sum"],["field","amount"],["appendTo","body","optionValue","type","optionLabel","text","placeholder","\u0412\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0435",3,"ngModelChange","onChange","ngModel","options"],[3,"pRowToggler"],[1,"p-column-title"],[4,"ngFor","ngForOf"],[1,"flex","justify-content-between"],["colspan","5"],["responsiveLayout","stack",3,"value","breakpoint","tableStyle"]],template:function(r,n){1&r&&(e.nrm(0,"p-toast"),e.j41(1,"p-card",0)(2,"p-calendar",1),e.mxI("ngModelChange",function(d){return e.DH7(n.dateRange,d)||(n.dateRange=d),d}),e.k0s(),e.j41(3,"p-button",2),e.bIt("click",function(){return n.findTransactionsClick()}),e.k0s(),e.j41(4,"p-button",3),e.bIt("click",function(){return n.importTransactions()}),e.k0s()(),e.DNE(5,wn,6,8,"div",4),e.nI1(6,"async")),2&r&&(e.R7$(2),e.R50("ngModel",n.dateRange),e.Y8G("showClear",!0)("readonlyInput",!0),e.R7$(2),e.Y8G("icon",n.isLoading?"pi pi-download":""),e.R7$(),e.Y8G("ngIf",e.bMT(6,5,n.filteredData)))},dependencies:[l.Ei,F.$n,I.Vv,T.Z,v.Sq,v.bT,P.BC,P.vS,X.KF,M.XI,M.Tg,M.FP,M.yc,z.y8,v.Jj,v.QX,v.vh]})}}return o})();const Pn=()=>[8,15,30,50],Mn=()=>({}),_e=()=>({"min-width":"50rem"});function zn(o,c){1&o&&(e.j41(0,"div",22)(1,"span",23),e.EFF(2,"\u0410\u0440\u0442\u0438\u043a\u0443\u043b\u044b"),e.k0s()())}function Bn(o,c){if(1&o){const t=e.RV6();e.j41(0,"p-multiSelect",24),e.bIt("onChange",function(n){const s=e.eBV(t).filterCallback;return e.Njj(s(n.value))}),e.k0s()}if(2&o){const t=c.$implicit,r=e.XpG(4);e.Y8G("ngModel",t)("filter",!1)("options",r.productPackageIDs)}}function Gn(o,c){1&o&&(e.j41(0,"tr")(1,"th"),e.EFF(2," \u0422\u043e\u0432\u0430\u0440 "),e.j41(3,"p-columnFilter",15),e.DNE(4,zn,3,0,"ng-template",12)(5,Bn,1,3,"ng-template",16),e.k0s()(),e.j41(6,"th",17),e.EFF(7,"\u0421\u0443\u043c\u043c\u0430 "),e.nrm(8,"p-sortIcon",18),e.k0s(),e.j41(9,"th",19),e.EFF(10,"\u0414\u0430\u0442\u0430 "),e.nrm(11,"p-sortIcon",20),e.k0s(),e.j41(12,"th"),e.EFF(13," \u2116 \u0437\u0430\u043a\u0430\u0437\u0430 "),e.nrm(14,"p-columnFilter",21),e.k0s()()),2&o&&(e.R7$(3),e.Y8G("showMatchModes",!1)("showOperator",!1)("showAddButton",!1),e.R7$(11),e.Y8G("showMatchModes",!1)("showOperator",!1))}function Ln(o,c){if(1&o&&(e.j41(0,"div")(1,"div"),e.EFF(2),e.k0s(),e.EFF(3),e.k0s()),2&o){const t=c.$implicit;e.R7$(2),e.JRh(t.product.name),e.R7$(),e.Lme(" ",t.product.productPackageID," x ",t.quantity," ")}}function An(o,c){if(1&o&&(e.j41(0,"tr",25)(1,"td"),e.DNE(2,Ln,4,3,"div",26),e.k0s(),e.j41(3,"td")(4,"div"),e.EFF(5),e.nI1(6,"number"),e.k0s()(),e.j41(7,"td")(8,"div"),e.EFF(9),e.nI1(10,"date"),e.k0s()(),e.j41(11,"td")(12,"div"),e.EFF(13),e.k0s()()()),2&o){const t=c.$implicit;e.Y8G("pRowToggler",t),e.R7$(2),e.Y8G("ngForOf",t.orderItems),e.R7$(3),e.SpI(" ",e.i5U(6,5,t.sum,"1.2-2"),"\u20bd "),e.R7$(4),e.SpI(" ",e.i5U(10,8,t.date,"y-MM-dd HH:mm")," "),e.R7$(4),e.SpI(" ",t.ozonOrderNumber," ")}}function $n(o,c){1&o&&(e.j41(0,"tr")(1,"th"),e.EFF(2,"\u0410\u0440\u0442\u0438\u043a\u0443\u043b"),e.k0s(),e.j41(3,"th"),e.EFF(4,"\u0426\u0435\u043d\u0430"),e.k0s(),e.j41(5,"th"),e.EFF(6,"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e"),e.k0s(),e.j41(7,"th"),e.EFF(8,"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435"),e.k0s()())}function Nn(o,c){if(1&o&&(e.j41(0,"tr")(1,"td")(2,"div")(3,"span",30),e.EFF(4,"\u0410\u0440\u0442\u0438\u043a\u0443\u043b"),e.k0s(),e.j41(5,"div"),e.EFF(6),e.k0s()()(),e.j41(7,"td")(8,"div")(9,"span",30),e.EFF(10,"\u0426\u0435\u043d\u0430"),e.k0s(),e.j41(11,"div"),e.EFF(12),e.nI1(13,"number"),e.k0s()()(),e.j41(14,"td")(15,"div")(16,"span",30),e.EFF(17,"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e"),e.k0s(),e.j41(18,"div"),e.EFF(19),e.k0s()()(),e.j41(20,"td")(21,"div")(22,"span",30),e.EFF(23,"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435"),e.k0s(),e.j41(24,"div"),e.EFF(25),e.k0s()()()()),2&o){const t=c.$implicit;e.R7$(6),e.SpI(" ",t.product.productPackageID," "),e.R7$(6),e.SpI(" ",e.i5U(13,4,t.price,"1.2-2"),"\u20bd "),e.R7$(7),e.SpI(" ",t.quantity," "),e.R7$(6),e.SpI(" ",t.product.name," ")}}function Xn(o,c){1&o&&(e.j41(0,"tr")(1,"th"),e.EFF(2,"ID"),e.k0s(),e.j41(3,"th"),e.EFF(4,"\u0414\u0430\u0442\u0430"),e.k0s(),e.j41(5,"th"),e.EFF(6,"\u0421\u0443\u043c\u043c\u0430"),e.k0s(),e.j41(7,"th"),e.EFF(8,"\u041a\u043e\u043c\u0438\u0441\u0441\u0438\u044f"),e.k0s(),e.j41(9,"th"),e.EFF(10,"\u0422\u0438\u043f \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0438"),e.k0s(),e.j41(11,"th"),e.EFF(12,"\u0422\u0438\u043f \u043d\u0430\u0447\u0438\u0441\u043b\u0435\u043d\u0438\u044f"),e.k0s()())}function Vn(o,c){if(1&o&&(e.j41(0,"tr")(1,"td")(2,"div")(3,"span",30),e.EFF(4,"ID"),e.k0s(),e.j41(5,"div"),e.EFF(6),e.k0s()()(),e.j41(7,"td")(8,"div")(9,"span",30),e.EFF(10,"\u0414\u0430\u0442\u0430"),e.k0s(),e.j41(11,"div"),e.EFF(12),e.nI1(13,"date"),e.k0s()()(),e.j41(14,"td")(15,"div")(16,"span",30),e.EFF(17,"\u0421\u0443\u043c\u043c\u0430"),e.k0s(),e.j41(18,"div"),e.EFF(19),e.nI1(20,"number"),e.k0s()()(),e.j41(21,"td")(22,"div")(23,"span",30),e.EFF(24,"\u041a\u043e\u043c\u0438\u0441\u0441\u0438\u044f"),e.k0s(),e.j41(25,"div"),e.EFF(26),e.nI1(27,"number"),e.k0s()()(),e.j41(28,"td")(29,"div")(30,"span",30),e.EFF(31,"\u0422\u0438\u043f \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0438"),e.k0s(),e.j41(32,"div"),e.EFF(33),e.k0s()()(),e.j41(34,"td")(35,"div")(36,"span",30),e.EFF(37,"\u0422\u0438\u043f \u043d\u0430\u0447\u0438\u0441\u043b\u0435\u043d\u0438\u044f"),e.k0s(),e.j41(38,"div"),e.EFF(39),e.k0s()()()()),2&o){const t=c.$implicit,r=e.XpG(7);e.R7$(6),e.SpI(" ",t.iD," "),e.R7$(6),e.SpI(" ",e.i5U(13,6,t.date,"y-MM-dd HH:mm")," "),e.R7$(7),e.SpI(" ",e.i5U(20,9,t.amount,"1.2-2"),"\u20bd "),e.R7$(7),e.SpI(" ",e.i5U(27,12,t.saleCommission,"1.2-2"),"\u20bd "),e.R7$(7),e.SpI(" ",r.getOperationTypeText(t.operationType)," "),e.R7$(6),e.SpI(" ",r.getTransactionTypeText(t.accrualType)," ")}}function Yn(o,c){if(1&o&&(e.qex(0),e.j41(1,"tr")(2,"td",28)(3,"h5"),e.EFF(4,"\u041e\u043f\u0435\u0440\u0430\u0446\u0438\u0438 \u043f\u043e \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044e"),e.k0s()()(),e.j41(5,"tr")(6,"td",28)(7,"p-table",29),e.DNE(8,Xn,13,0,"ng-template",12)(9,Vn,40,15,"ng-template",13),e.k0s()()(),e.bVm()),2&o){const t=e.XpG().$implicit;e.R7$(7),e.Y8G("value",t.operations)("breakpoint","960px")("tableStyle",e.lJ4(3,_e))}}function Hn(o,c){if(1&o&&(e.qex(0),e.j41(1,"tr")(2,"td",28)(3,"p-table",29),e.DNE(4,$n,9,0,"ng-template",12)(5,Nn,26,7,"ng-template",13),e.k0s()()(),e.DNE(6,Yn,10,4,"ng-container",27),e.bVm()),2&o){const t=c.$implicit;e.R7$(3),e.Y8G("value",t.orderItems)("breakpoint","960px")("tableStyle",e.lJ4(4,_e)),e.R7$(3),e.Y8G("ngIf",null==t.operations?null:t.operations.length)}}function Wn(o,c){if(1&o&&(e.qex(0),e.j41(1,"tr")(2,"td",28)(3,"h5"),e.EFF(4,"\u0421\u043e\u0441\u0442\u0430\u0432 \u0437\u0430\u043a\u0430\u0437\u0430"),e.k0s()()(),e.DNE(5,Hn,7,5,"ng-container",26),e.bVm()),2&o){const t=e.XpG().$implicit;e.R7$(5),e.Y8G("ngForOf",t.orderItems)}}function Un(o,c){1&o&&(e.j41(0,"tr")(1,"th"),e.EFF(2,"ID"),e.k0s(),e.j41(3,"th"),e.EFF(4,"\u0414\u0430\u0442\u0430"),e.k0s(),e.j41(5,"th"),e.EFF(6,"\u0421\u0443\u043c\u043c\u0430"),e.k0s(),e.j41(7,"th"),e.EFF(8,"\u041a\u043e\u043c\u0438\u0441\u0441\u0438\u044f"),e.k0s(),e.j41(9,"th"),e.EFF(10,"\u0422\u0438\u043f \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0438"),e.k0s(),e.j41(11,"th"),e.EFF(12,"\u0422\u0438\u043f \u043d\u0430\u0447\u0438\u0441\u043b\u0435\u043d\u0438\u044f"),e.k0s()())}function Jn(o,c){if(1&o&&(e.j41(0,"tr")(1,"td")(2,"div")(3,"span",30),e.EFF(4,"ID"),e.k0s(),e.j41(5,"div"),e.EFF(6),e.k0s()()(),e.j41(7,"td")(8,"div")(9,"span",30),e.EFF(10,"\u0414\u0430\u0442\u0430"),e.k0s(),e.j41(11,"div"),e.EFF(12),e.nI1(13,"date"),e.k0s()()(),e.j41(14,"td")(15,"div")(16,"span",30),e.EFF(17,"\u0421\u0443\u043c\u043c\u0430"),e.k0s(),e.j41(18,"div"),e.EFF(19),e.nI1(20,"number"),e.k0s()()(),e.j41(21,"td")(22,"div")(23,"span",30),e.EFF(24,"\u041a\u043e\u043c\u0438\u0441\u0441\u0438\u044f"),e.k0s(),e.j41(25,"div"),e.EFF(26),e.nI1(27,"number"),e.k0s()()(),e.j41(28,"td")(29,"div")(30,"span",30),e.EFF(31,"\u0422\u0438\u043f \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0438"),e.k0s(),e.j41(32,"div"),e.EFF(33),e.k0s()()(),e.j41(34,"td")(35,"div")(36,"span",30),e.EFF(37,"\u0422\u0438\u043f \u043d\u0430\u0447\u0438\u0441\u043b\u0435\u043d\u0438\u044f"),e.k0s(),e.j41(38,"div"),e.EFF(39),e.k0s()()()()),2&o){const t=c.$implicit,r=e.XpG(5);e.R7$(6),e.SpI(" ",t.iD," "),e.R7$(6),e.SpI(" ",e.i5U(13,6,t.date,"y-MM-dd HH:mm")," "),e.R7$(7),e.SpI(" ",e.i5U(20,9,t.amount,"1.2-2"),"\u20bd "),e.R7$(7),e.SpI(" ",e.i5U(27,12,t.saleCommission,"1.2-2"),"\u20bd "),e.R7$(7),e.SpI(" ",r.getOperationTypeText(t.operationType)," "),e.R7$(6),e.SpI(" ",r.getTransactionTypeText(t.accrualType)," ")}}function qn(o,c){if(1&o&&(e.qex(0),e.j41(1,"tr")(2,"td",28)(3,"h5"),e.EFF(4,"\u041e\u043f\u0435\u0440\u0430\u0446\u0438\u0438 \u043f\u043e \u0437\u0430\u043a\u0430\u0437\u0443"),e.k0s()()(),e.j41(5,"tr")(6,"td",28)(7,"p-table",31),e.DNE(8,Un,13,0,"ng-template",12)(9,Jn,40,15,"ng-template",13),e.k0s()()(),e.bVm()),2&o){const t=e.XpG().$implicit;e.R7$(7),e.Y8G("value",t.operations)("breakpoint","960px")("tableStyle",e.lJ4(3,_e))}}function Qn(o,c){if(1&o&&e.DNE(0,Wn,6,1,"ng-container",27)(1,qn,10,4,"ng-container",27),2&o){const t=c.$implicit;e.Y8G("ngIf",null==t.orderItems?null:t.orderItems.length),e.R7$(),e.Y8G("ngIf",null==t.operations?null:t.operations.length)}}function Kn(o,c){if(1&o&&(e.j41(0,"p-table",11),e.DNE(1,Gn,15,5,"ng-template",12)(2,An,14,11,"ng-template",13)(3,Qn,2,2,"ng-template",14),e.k0s()),2&o){const t=e.XpG(2);e.Y8G("value",t.data)("loading",t.loading)("paginator",!0)("showCurrentPageReport",!1)("rows",8)("rowsPerPageOptions",e.lJ4(7,Pn))("tableStyle",e.lJ4(8,Mn))}}function Zn(o,c){if(1&o&&(e.j41(0,"div",3)(1,"div",4)(2,"div",5)(3,"div",6)(4,"div",7)(5,"div")(6,"div",8)(7,"span"),e.EFF(8,"\u0421\u0443\u043c\u043c\u0430 \u043f\u0440\u043e\u0434\u0430\u0436"),e.k0s(),e.j41(9,"span"),e.EFF(10),e.nI1(11,"number"),e.k0s()()()(),e.j41(12,"div",7)(13,"div")(14,"div",8)(15,"span"),e.EFF(16,"\u041a\u043e\u043c\u0438\u0441\u0441\u0438\u044f"),e.k0s(),e.j41(17,"span"),e.EFF(18),e.nI1(19,"number"),e.nI1(20,"number"),e.k0s()()()(),e.j41(21,"div",7)(22,"div")(23,"div",8)(24,"span"),e.EFF(25,"\u0412\u043e\u0437\u0432\u0440\u0430\u0442\u044b"),e.k0s(),e.j41(26,"span"),e.EFF(27),e.nI1(28,"number"),e.nI1(29,"number"),e.k0s()()()(),e.j41(30,"div",7)(31,"div")(32,"div",8)(33,"span"),e.EFF(34,"\u0421\u0435\u0440\u0432\u0438\u0441\u044b"),e.k0s(),e.j41(35,"span"),e.EFF(36),e.nI1(37,"number"),e.nI1(38,"number"),e.k0s()()()(),e.j41(39,"div",7)(40,"div")(41,"div",8)(42,"span"),e.EFF(43,"\u0421\u0435\u0440\u0432\u0438\u0441\u044b \u0437\u0430\u043a\u0430\u0437\u043e\u0432"),e.k0s(),e.j41(44,"span"),e.EFF(45),e.nI1(46,"number"),e.nI1(47,"number"),e.k0s()()()()()(),e.j41(48,"div",5)(49,"div",6)(50,"div",7)(51,"div",9),e.EFF(52,"\u0417\u0430\u043a\u0430\u0437\u044b"),e.k0s(),e.j41(53,"div")(54,"div",8)(55,"span"),e.EFF(56,"\u0417\u0430\u043a\u0430\u0437\u043e\u0432"),e.k0s(),e.j41(57,"span"),e.EFF(58),e.k0s()()(),e.j41(59,"div",8)(60,"span"),e.EFF(61,"\u0422\u043e\u0432\u0430\u0440\u043e\u0432"),e.k0s(),e.j41(62,"span"),e.EFF(63),e.k0s()(),e.j41(64,"div",8)(65,"span"),e.EFF(66,"\u041e\u0442\u043c\u0435\u043d"),e.k0s(),e.j41(67,"span"),e.EFF(68),e.k0s()(),e.j41(69,"div",8)(70,"span"),e.EFF(71,"\u0421\u0443\u043c\u043c\u0430 \u043e\u0442\u043c\u0435\u043d"),e.k0s(),e.j41(72,"span"),e.EFF(73),e.k0s()(),e.j41(74,"div",8)(75,"span"),e.EFF(76,"\u0412\u043e\u0437\u0432\u0440\u0430\u0442\u043e\u0432"),e.k0s(),e.j41(77,"span"),e.EFF(78),e.k0s()(),e.j41(79,"div",8)(80,"span"),e.EFF(81,"\u0421\u0443\u043c\u043c\u0430 \u0432\u043e\u0437\u0432\u0440\u0430\u0442\u043e\u0432"),e.k0s(),e.j41(82,"span"),e.EFF(83),e.k0s()()()()()(),e.DNE(84,Kn,4,9,"p-table",10),e.k0s()),2&o){const t=e.XpG();e.R7$(10),e.SpI("",e.i5U(11,16,t.summary.totalSum,"1.2-2"),"\u20bd"),e.R7$(8),e.Lme("",e.i5U(19,19,t.summary.commission,"1.2-2"),"\u20bd (",e.i5U(20,22,t.summary.totalSum+t.summary.commission,"1.2-2"),"\u20bd)"),e.R7$(9),e.Lme(" ",e.i5U(28,25,t.summary.returnedSum,"1.2-2"),"\u20bd (",e.i5U(29,28,t.summary.returnedProductCount+t.summary.totalSum+t.summary.commission-t.summary.returnedSum,"1.2-2"),"\u20bd) "),e.R7$(9),e.Lme("",e.i5U(37,31,t.summary.serviceTotalSum,"1.2-2"),"\u20bd (",e.i5U(38,34,t.summary.totalSum+t.summary.commission+t.summary.serviceTotalSum,"1.2-2"),"\u20bd)"),e.R7$(9),e.Lme("",e.i5U(46,37,t.summary.orderServiceTotalSum,"1.2-2"),"\u20bd (",e.i5U(47,40,t.summary.totalSum+t.summary.commission+t.summary.serviceTotalSum+t.summary.orderServiceTotalSum,"1.2-2"),"\u20bd)"),e.R7$(13),e.JRh(t.summary.totalOrderCount),e.R7$(5),e.JRh(t.summary.totalProductCount),e.R7$(5),e.JRh(t.summary.cancelledProductCount),e.R7$(5),e.JRh(t.summary.cancelledSum),e.R7$(5),e.JRh(t.summary.returnedProductCount),e.R7$(5),e.JRh(t.summary.returnedSum),e.R7$(),e.Y8G("ngIf",t.data)}}let eo=(()=>{class o extends p.x{constructor(t,r,n,s){super(s),this.ozonSalesOrderClient=t,this.messageService=r,this.timeService=n,this.data=[],this.excludedDates=[],this.productPackageIDs=[],this.loading=!1}ngOnInit(){this.titleService.setTitle("\u0421\u0432\u0435\u0440\u043a\u0430 \u0441 Ozon")}getDateRange(){const t=this.timeService.asUtc(this.date),r=new Date(t),n=new Date(t);return n.setMonth(n.getMonth()+1),[r,n]}prepareReport(){this.loading=!0;const[t,r]=this.getDateRange(),n=new Date(t);n.setMonth(n.getMonth()-1),this.ozonSalesOrderClient.findSalesOzonOrders(new i.D.FindOzonSalesOrdersModel({dateFrom:n,dateTo:r,offset:0,count:100})).pipe((0,O.Q)(this.destroyed)).pipe((0,g.W)(s=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430",severity:"error",detail:s}),this.loading=!1,y.w))).subscribe(s=>{this.data=s.items.filter(j=>j.operations.reduce((D,G)=>D||=G.operationType==i.D.OperationType.OperationAgentDeliveredToCustomer&&(!t||G.date>=t)&&(!r||G.date<r),!1));const d={totalOrderCount:0,totalSum:0,totalProductCount:0,sumWithCommission:0,commission:0,orderServiceTotalSum:0,orderServiceTotalCount:0,serviceTotalSum:0,cancelledProductCount:0,returnedProductCount:0,cancelledSum:0,returnedSum:0,services:{},orderServices:{}},S={},x=[];for(const j of s.items){const D=j.operations.filter(B=>(!t||B.date>=t)&&(!r||B.date<r)),G=!!D.length;for(const B of D)if(B.postingNumber==j.ozonOrderNumber)for(const R of B.services)d.orderServices[R.type]=R.price+d.services[R.type],d.orderServiceTotalSum+=R.price,d.orderServiceTotalCount++,x.push(R.price);if(G){for(const B of j.orderItems){const R=[];S[B.product.productPackageID]||(S[B.product.productPackageID]={prices:{},operations:[]});const ee=S[B.product.productPackageID];ee.prices[B.price]||(ee.prices[B.price]={quantity:0,sum:0,commission:0});const U=ee.prices[B.price];U.quantity+=B.quantity,U.sum+=B.quantity*B.price;for(const Y of D)if(Y.postingNumber==B.postingNumber)switch(R.push(Y),Y.operationType){case i.D.OperationType.OperationAgentDeliveredToCustomer:d.totalProductCount+=B.quantity,U.commission+=Y.saleCommission,d.commission+=Y.saleCommission,d.totalSum+=B.price*B.quantity;for(const H of Y.services)d.services[H.type]=H.price+(d.services[H.type]??0),d.serviceTotalSum+=H.price;break;case i.D.OperationType.ClientReturnAgentOperation:U.commission+=Y.saleCommission,d.commission+=Y.saleCommission,d.returnedProductCount+=B.quantity,d.returnedSum+=Y.amount,d.totalSum-=B.price*B.quantity;for(const H of Y.services)d.services[H.type]=H.price+(d.services[H.type]??0),d.serviceTotalSum+=H.price;break;case i.D.OperationType.OperationItemReturn:d.commission+=Y.saleCommission,d.cancelledProductCount+=B.quantity;for(const H of Y.services)d.services[H.type]=H.price+(d.services[H.type]??0),d.serviceTotalSum+=H.price;break;default:console.log("x",Y)}}d.totalOrderCount++}}this.summary=d,this.loading=!1})}static{this.\u0275fac=function(r){return new(r||o)(e.rXU(i.D.OzonSalesOrderClient),e.rXU(l.bg),e.rXU(ye.v),e.rXU(h.hE))}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["app-sales-reconciliation-report"]],features:[e.Vt3],decls:4,vars:4,consts:[["header","\u0421\u0432\u0435\u0440\u043a\u0430 Ozon"],["selectionMode","single","view","month","dateFormat","yy-mm","placeholder","\u041f\u0435\u0440\u0438\u043e\u0434",3,"ngModelChange","onSelect","ngModel","disabledDates","readonlyInput"],["class","card",4,"ngIf"],[1,"card"],[1,"grid"],[1,"col-12","md:col-6"],[1,"card","text-right"],[1,"text-900","font-medium","text-xl","mb-3"],[1,"flex","justify-content-between"],[1,"text-500","text-center"],["responsiveLayout","stack","dataKey","iD",3,"value","loading","paginator","showCurrentPageReport","rows","rowsPerPageOptions","tableStyle",4,"ngIf"],["responsiveLayout","stack","dataKey","iD",3,"value","loading","paginator","showCurrentPageReport","rows","rowsPerPageOptions","tableStyle"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["field","product","matchMode","intersects","display","menu",3,"showMatchModes","showOperator","showAddButton"],["pTemplate","filter"],["pSortableColumn","sum"],["field","sum"],["pSortableColumn","date"],["field","date"],["field","ozonOrderNumber","matchMode","contains","display","menu",3,"showMatchModes","showOperator"],[1,"px-3","pt-3","pb-0"],[1,"font-bold"],["placeholder","\u0412\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0435",3,"onChange","ngModel","filter","options"],[3,"pRowToggler"],[4,"ngFor","ngForOf"],[4,"ngIf"],["colspan","4"],["responsiveLayout","stack",3,"value","breakpoint","tableStyle"],[1,"p-column-title","font-bold"],["dataKey","iD","responsiveLayout","stack",3,"value","breakpoint","tableStyle"]],template:function(r,n){1&r&&(e.nrm(0,"p-toast"),e.j41(1,"p-card",0)(2,"p-calendar",1),e.mxI("ngModelChange",function(d){return e.DH7(n.date,d)||(n.date=d),d}),e.bIt("onSelect",function(){return n.prepareReport()}),e.k0s()(),e.DNE(3,Zn,85,43,"div",2)),2&r&&(e.R7$(2),e.R50("ngModel",n.date),e.Y8G("disabledDates",n.excludedDates)("readonlyInput",!0),e.R7$(),e.Y8G("ngIf",n.summary))},dependencies:[l.Ei,I.Vv,T.Z,v.Sq,v.bT,P.BC,P.vS,X.KF,M.XI,M.Tg,M.FP,M.yc,M.rl,z.y8,v.QX,v.vh]})}}return o})();var ue=f(8805),Ce=f(1512),Ee=f(2816),to=f(4420);const no=["inputtext"],oo=["container"],io=(o,c,t,r)=>({"p-chips p-component p-input-wrapper":!0,"p-disabled":o,"p-focus":c,"p-inputwrapper-filled":t,"p-inputwrapper-focus":r}),ro=o=>({"p-inputtext p-chips-multiple-container":!0,"p-variant-filled":o}),uo=o=>({"p-chips-clearable":o}),ao=o=>({"p-chips-token":!0,"p-focus":o}),so=o=>({$implicit:o});function lo(o,c){1&o&&e.eu8(0)}function co(o,c){if(1&o&&(e.j41(0,"span",12),e.EFF(1),e.k0s()),2&o){const t=e.XpG().$implicit,r=e.XpG();e.BMQ("data-pc-section","label"),e.R7$(),e.JRh(r.field?r.resolveFieldData(t,r.field):t)}}function po(o,c){if(1&o){const t=e.RV6();e.j41(0,"TimesCircleIcon",15),e.bIt("click",function(n){e.eBV(t);const s=e.XpG(2).index,d=e.XpG();return e.Njj(d.removeItem(n,s))}),e.k0s()}2&o&&(e.Y8G("styleClass","p-chips-token-icon"),e.BMQ("data-pc-section","removeTokenIcon")("aria-hidden",!0))}function _o(o,c){}function fo(o,c){1&o&&e.DNE(0,_o,0,0,"ng-template")}function mo(o,c){if(1&o){const t=e.RV6();e.j41(0,"span",16),e.bIt("click",function(n){e.eBV(t);const s=e.XpG(2).index,d=e.XpG();return e.Njj(d.removeItem(n,s))}),e.DNE(1,fo,1,0,null,17),e.k0s()}if(2&o){const t=e.XpG(3);e.BMQ("data-pc-section","removeTokenIcon")("aria-hidden",!0),e.R7$(),e.Y8G("ngTemplateOutlet",t.removeTokenIconTemplate)}}function ho(o,c){if(1&o&&(e.qex(0),e.DNE(1,po,1,3,"TimesCircleIcon",13)(2,mo,2,3,"span",14),e.bVm()),2&o){const t=e.XpG(2);e.R7$(),e.Y8G("ngIf",!t.removeTokenIconTemplate),e.R7$(),e.Y8G("ngIf",t.removeTokenIconTemplate)}}function go(o,c){if(1&o){const t=e.RV6();e.j41(0,"li",9,2),e.bIt("click",function(n){const s=e.eBV(t).$implicit,d=e.XpG();return e.Njj(d.onItemClick(n,s))})("contextmenu",function(n){const s=e.eBV(t).$implicit,d=e.XpG();return e.Njj(d.onItemContextMenu(n,s))}),e.DNE(2,lo,1,0,"ng-container",10)(3,co,2,2,"span",11)(4,ho,3,2,"ng-container",8),e.k0s()}if(2&o){const t=c.$implicit,r=c.index,n=e.XpG();e.Y8G("ngClass",e.eq3(12,ao,n.focusedIndex===r)),e.BMQ("id",n.id+"_chips_item_"+r)("ariaLabel",t)("aria-selected",!0)("aria-setsize",n.value.length)("aria-posinset",r+1)("data-p-focused",n.focusedIndex===r)("data-pc-section","token"),e.R7$(2),e.Y8G("ngTemplateOutlet",n.itemTemplate)("ngTemplateOutletContext",e.eq3(14,so,t)),e.R7$(),e.Y8G("ngIf",!n.itemTemplate),e.R7$(),e.Y8G("ngIf",!n.disabled)}}function vo(o,c){if(1&o){const t=e.RV6();e.j41(0,"TimesIcon",15),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.clear())}),e.k0s()}2&o&&e.Y8G("styleClass","p-chips-clear-icon")}function bo(o,c){}function yo(o,c){1&o&&e.DNE(0,bo,0,0,"ng-template")}function Co(o,c){if(1&o){const t=e.RV6();e.j41(0,"span",19),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.clear())}),e.DNE(1,yo,1,0,null,17),e.k0s()}if(2&o){const t=e.XpG(2);e.R7$(),e.Y8G("ngTemplateOutlet",t.clearIconTemplate)}}function Eo(o,c){if(1&o&&(e.j41(0,"li"),e.DNE(1,vo,1,1,"TimesIcon",13)(2,Co,2,1,"span",18),e.k0s()),2&o){const t=e.XpG();e.R7$(),e.Y8G("ngIf",!t.clearIconTemplate),e.R7$(),e.Y8G("ngIf",t.clearIconTemplate)}}const Oo={provide:P.kq,useExisting:(0,e.Rfq)(()=>Oe),multi:!0};let Oe=(()=>{class o{document;el;cd;config;style;styleClass;disabled;field;placeholder;max;maxLength;ariaLabel;ariaLabelledBy;tabindex;inputId;allowDuplicate=!0;caseSensitiveDuplication=!0;inputStyle;inputStyleClass;addOnTab;addOnBlur;separator;showClear=!1;autofocus;variant="outlined";onAdd=new e.bkB;onRemove=new e.bkB;onFocus=new e.bkB;onBlur=new e.bkB;onChipClick=new e.bkB;onChipContextMenu=new e.bkB;onClear=new e.bkB;inputViewChild;containerViewChild;templates;itemTemplate;removeTokenIconTemplate;clearIconTemplate;value;onModelChange=()=>{};onModelTouched=()=>{};valueChanged;id=(0,to._Y)();focused;focusedIndex;filled;get focusedOptionId(){return null!==this.focusedIndex?`${this.id}_chips_item_${this.focusedIndex}`:null}get isMaxedOut(){return this.max&&this.value&&this.max===this.value.length}constructor(t,r,n,s){this.document=t,this.el=r,this.cd=n,this.config=s}ngAfterContentInit(){this.templates.forEach(t=>{switch(t.getType()){case"item":default:this.itemTemplate=t.template;break;case"removetokenicon":this.removeTokenIconTemplate=t.template;break;case"clearicon":this.clearIconTemplate=t.template}}),this.updateFilledState()}onWrapperClick(){this.inputViewChild?.nativeElement.focus()}onContainerFocus(){this.focused=!0}onContainerBlur(){this.focusedIndex=-1,this.focused=!1}onContainerKeyDown(t){switch(t.code){case"ArrowLeft":this.onArrowLeftKeyOn();break;case"ArrowRight":this.onArrowRightKeyOn();break;case"Backspace":this.onBackspaceKeyOn(t);break;case"Space":null!==this.focusedIndex&&this.value&&this.value.length>0&&this.onItemClick(t,this.value[this.focusedIndex])}}onArrowLeftKeyOn(){0===this.inputViewChild.nativeElement.value.length&&this.value&&this.value.length>0&&(this.focusedIndex=null===this.focusedIndex?this.value.length-1:this.focusedIndex-1,this.focusedIndex<0&&(this.focusedIndex=0))}onArrowRightKeyOn(){0===this.inputViewChild.nativeElement.value.length&&this.value&&this.value.length>0&&(this.focusedIndex===this.value.length-1?(this.focusedIndex=null,this.inputViewChild?.nativeElement.focus()):this.focusedIndex++)}onBackspaceKeyOn(t){null!==this.focusedIndex&&this.removeItem(t,this.focusedIndex)}onInput(){this.updateFilledState(),this.focusedIndex=null}onPaste(t){this.disabled||(this.separator&&((t.clipboardData||this.document.defaultView.clipboardData).getData("Text").split(this.separator).forEach(n=>{this.addItem(t,n,!0)}),this.inputViewChild.nativeElement.value=""),this.updateFilledState())}updateFilledState(){this.filled=!(!this.value||0===this.value.length)||this.inputViewChild&&this.inputViewChild.nativeElement&&""!=this.inputViewChild.nativeElement.value}onItemClick(t,r){this.onChipClick.emit({originalEvent:t,value:r})}onItemContextMenu(t,r){this.onChipContextMenu.emit({originalEvent:t,value:r})}writeValue(t){this.value=t,this.updateMaxedOut(),this.updateFilledState(),this.cd.markForCheck()}registerOnChange(t){this.onModelChange=t}registerOnTouched(t){this.onModelTouched=t}setDisabledState(t){this.disabled=t,this.cd.markForCheck()}resolveFieldData(t,r){if(t&&r){if(-1==r.indexOf("."))return t[r];{let d=r.split("."),S=t;for(var n=0,s=d.length;n<s;++n)S=S[d[n]];return S}}return null}onInputFocus(t){this.focused=!0,this.focusedIndex=null,this.onFocus.emit(t)}onInputBlur(t){this.focused=!1,this.focusedIndex=null,this.addOnBlur&&this.inputViewChild.nativeElement.value&&this.addItem(t,this.inputViewChild.nativeElement.value,!1),this.onModelTouched(),this.onBlur.emit(t)}removeItem(t,r){if(this.disabled)return;let n=this.value[r];this.value=this.value.filter((s,d)=>d!=r),this.focusedIndex=null,this.inputViewChild.nativeElement.focus(),this.onModelChange(this.value),this.onRemove.emit({originalEvent:t,value:n}),this.updateFilledState(),this.updateMaxedOut()}addItem(t,r,n){if(this.value=this.value||[],r&&r.trim().length){const s=this.caseSensitiveDuplication?this.value.includes(r):this.value.some(d=>d.toLowerCase()===r.toLowerCase());(this.allowDuplicate||!s)&&!this.isMaxedOut&&(this.value=[...this.value,r],this.onModelChange(this.value),this.onAdd.emit({originalEvent:t,value:r}))}this.updateFilledState(),this.updateMaxedOut(),this.inputViewChild.nativeElement.value="",n&&t.preventDefault()}clear(){this.value=null,this.updateFilledState(),this.onModelChange(this.value),this.updateMaxedOut(),this.onClear.emit()}onKeyDown(t){const r=t.target.value;switch(t.code){case"Backspace":0===r.length&&this.value&&this.value.length>0&&this.removeItem(t,null!==this.focusedIndex?this.focusedIndex:this.value.length-1);break;case"Enter":case"NumpadEnter":r&&r.trim().length&&!this.isMaxedOut&&this.addItem(t,r,!0);break;case"Tab":this.addOnTab&&r&&r.trim().length&&!this.isMaxedOut&&(this.addItem(t,r,!0),t.preventDefault());break;case"ArrowLeft":0===r.length&&this.value&&this.value.length>0&&this.containerViewChild?.nativeElement.focus();break;case"ArrowRight":t.stopPropagation();break;default:this.separator&&(this.separator===t.key||t.key.match(this.separator))&&this.addItem(t,r,!0)}}updateMaxedOut(){this.inputViewChild&&this.inputViewChild.nativeElement&&(this.isMaxedOut?(this.inputViewChild.nativeElement.blur(),this.inputViewChild.nativeElement.disabled=!0):(this.disabled&&this.inputViewChild.nativeElement.blur(),this.inputViewChild.nativeElement.disabled=this.disabled||!1))}static \u0275fac=function(r){return new(r||o)(e.rXU(v.qQ),e.rXU(e.aKT),e.rXU(e.gRc),e.rXU(l.r1))};static \u0275cmp=e.VBU({type:o,selectors:[["p-chips"]],contentQueries:function(r,n,s){if(1&r&&e.wni(s,l.Ei,4),2&r){let d;e.mGM(d=e.lsd())&&(n.templates=d)}},viewQuery:function(r,n){if(1&r&&(e.GBs(no,5),e.GBs(oo,5)),2&r){let s;e.mGM(s=e.lsd())&&(n.inputViewChild=s.first),e.mGM(s=e.lsd())&&(n.containerViewChild=s.first)}},hostAttrs:[1,"p-element","p-inputwrapper"],hostVars:6,hostBindings:function(r,n){2&r&&e.AVh("p-inputwrapper-filled",n.filled)("p-inputwrapper-focus",n.focused)("p-chips-clearable",n.showClear)},inputs:{style:"style",styleClass:"styleClass",disabled:[2,"disabled","disabled",e.L39],field:"field",placeholder:"placeholder",max:[2,"max","max",e.Udg],maxLength:"maxLength",ariaLabel:"ariaLabel",ariaLabelledBy:"ariaLabelledBy",tabindex:[2,"tabindex","tabindex",e.Udg],inputId:"inputId",allowDuplicate:[2,"allowDuplicate","allowDuplicate",e.L39],caseSensitiveDuplication:[2,"caseSensitiveDuplication","caseSensitiveDuplication",e.L39],inputStyle:"inputStyle",inputStyleClass:"inputStyleClass",addOnTab:[2,"addOnTab","addOnTab",e.L39],addOnBlur:[2,"addOnBlur","addOnBlur",e.L39],separator:"separator",showClear:[2,"showClear","showClear",e.L39],autofocus:[2,"autofocus","autofocus",e.L39],variant:"variant"},outputs:{onAdd:"onAdd",onRemove:"onRemove",onFocus:"onFocus",onBlur:"onBlur",onChipClick:"onChipClick",onChipContextMenu:"onChipContextMenu",onClear:"onClear"},features:[e.Jv_([Oo]),e.GFd],decls:8,vars:34,consts:[["container",""],["inputtext",""],["token",""],[3,"ngClass","ngStyle"],["tabindex","-1","role","listbox",3,"click","focus","blur","keydown","ngClass"],["role","option",3,"ngClass","click","contextmenu",4,"ngFor","ngForOf"],["role","option",1,"p-chips-input-token",3,"ngClass"],["type","text","pAutoFocus","",3,"keydown","input","paste","focus","blur","disabled","ngStyle","autofocus"],[4,"ngIf"],["role","option",3,"click","contextmenu","ngClass"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["class","p-chips-token-label",4,"ngIf"],[1,"p-chips-token-label"],[3,"styleClass","click",4,"ngIf"],["class","p-chips-token-icon",3,"click",4,"ngIf"],[3,"click","styleClass"],[1,"p-chips-token-icon",3,"click"],[4,"ngTemplateOutlet"],["class","p-chips-clear-icon",3,"click",4,"ngIf"],[1,"p-chips-clear-icon",3,"click"]],template:function(r,n){if(1&r){const s=e.RV6();e.j41(0,"div",3)(1,"ul",4,0),e.bIt("click",function(){return e.eBV(s),e.Njj(n.onWrapperClick())})("focus",function(){return e.eBV(s),e.Njj(n.onContainerFocus())})("blur",function(){return e.eBV(s),e.Njj(n.onContainerBlur())})("keydown",function(S){return e.eBV(s),e.Njj(n.onContainerKeyDown(S))}),e.DNE(3,go,5,16,"li",5),e.j41(4,"li",6)(5,"input",7,1),e.bIt("keydown",function(S){return e.eBV(s),e.Njj(n.onKeyDown(S))})("input",function(){return e.eBV(s),e.Njj(n.onInput())})("paste",function(S){return e.eBV(s),e.Njj(n.onPaste(S))})("focus",function(S){return e.eBV(s),e.Njj(n.onInputFocus(S))})("blur",function(S){return e.eBV(s),e.Njj(n.onInputBlur(S))}),e.k0s()(),e.DNE(7,Eo,3,2,"li",8),e.k0s()()}2&r&&(e.HbH(n.styleClass),e.Y8G("ngClass",e.ziG(25,io,n.disabled,n.focused,n.value&&n.value.length||(null==n.inputViewChild?null:n.inputViewChild.nativeElement.value)&&(null==n.inputViewChild?null:n.inputViewChild.nativeElement.value.length),n.focused))("ngStyle",n.style),e.BMQ("data-pc-name","chips")("data-pc-section","root"),e.R7$(),e.Y8G("ngClass",e.eq3(30,ro,"filled"===n.variant||"filled"===n.config.inputStyle())),e.BMQ("aria-labelledby",n.ariaLabelledBy)("aria-label",n.ariaLabel)("aria-activedescendant",n.focused?n.focusedOptionId:void 0)("aria-orientation","horizontal")("data-pc-section","container"),e.R7$(2),e.Y8G("ngForOf",n.value),e.R7$(),e.Y8G("ngClass",e.eq3(32,uo,n.showClear&&!n.disabled)),e.BMQ("data-pc-section","inputToken"),e.R7$(),e.HbH(n.inputStyleClass),e.Y8G("disabled",n.disabled||n.isMaxedOut)("ngStyle",n.inputStyle)("autofocus",n.autofocus),e.BMQ("id",n.inputId)("maxlength",n.maxLength)("placeholder",n.value&&n.value.length?null:n.placeholder)("tabindex",n.tabindex),e.R7$(2),e.Y8G("ngIf",null!=n.value&&n.filled&&!n.disabled&&n.showClear))},dependencies:()=>[v.YU,v.Sq,v.bT,v.T3,v.B3,L.q,Ee.I,Ce.A],styles:["@layer primeng{.p-chips{display:inline-flex}.p-chips-multiple-container{margin:0;padding:0;list-style-type:none;cursor:text;overflow:hidden;display:flex;align-items:center;flex-wrap:wrap}.p-chips-token{cursor:default;display:inline-flex;align-items:center;flex:0 0 auto;max-width:100%}.p-chips-token-label{min-width:0%;overflow:auto}.p-chips-token-label::-webkit-scrollbar{display:none}.p-chips-input-token{flex:1 1 auto;display:inline-flex}.p-chips-token-icon{cursor:pointer}.p-chips-input-token input{border:0 none;outline:0 none;background-color:transparent;margin:0;padding:0;box-shadow:none;border-radius:0;width:100%}.p-fluid .p-chips{display:flex}.p-chips-clear-icon{position:absolute;top:50%;margin-top:-.5rem;cursor:pointer}.p-chips-clearable .p-inputtext{position:relative}}\n"],encapsulation:2,changeDetection:0})}return o})(),ko=(()=>{class o{static \u0275fac=function(r){return new(r||o)};static \u0275mod=e.$C({type:o});static \u0275inj=e.G2t({imports:[v.MD,ne.u,l.Gg,L.u,Ee.I,Ce.A,ne.u,l.Gg]})}return o})();const Fo=()=>({"min-width":"50rem"}),So=()=>[50,100,250];function Ro(o,c){1&o&&(e.j41(0,"div",10)(1,"span",11),e.EFF(2,"\u041a\u043b\u0430\u0441\u0442\u0435\u0440\u044b"),e.k0s()())}function Io(o,c){if(1&o){const t=e.RV6();e.j41(0,"p-multiSelect",12),e.bIt("onChange",function(n){const s=e.eBV(t).filterCallback;return e.Njj(s(n.value))}),e.k0s()}if(2&o){const t=c.$implicit,r=e.XpG(3);e.Y8G("ngModel",t)("filter",!1)("options",r.warehouseClusters)}}function To(o,c){1&o&&(e.j41(0,"tr")(1,"th"),e.nrm(2,"p-columnFilter",5),e.EFF(3," \u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435 "),e.k0s(),e.j41(4,"th"),e.EFF(5,"\u0410\u0434\u0440\u0435\u0441"),e.k0s(),e.j41(6,"th"),e.EFF(7,"\u041e\u0441\u043e\u0431\u044b\u0439"),e.k0s(),e.j41(8,"th",6),e.EFF(9," \u041a\u043b\u0430\u0441\u0442\u0435\u0440"),e.nrm(10,"p-sortIcon",7),e.j41(11,"p-columnFilter",8),e.DNE(12,Ro,3,0,"ng-template",3)(13,Io,1,3,"ng-template",9),e.k0s()(),e.j41(14,"th"),e.EFF(15,"\u041f\u0441\u0435\u0432\u0434\u043e\u043d\u0438\u043c\u044b"),e.k0s(),e.nrm(16,"th"),e.k0s()),2&o&&(e.R7$(2),e.Y8G("showMatchModes",!1)("showOperator",!1)("showAddButton",!1),e.R7$(9),e.Y8G("showMatchModes",!1)("showOperator",!1)("showAddButton",!1))}function Do(o,c){if(1&o){const t=e.RV6();e.j41(0,"p-checkbox",20),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG().$implicit;return e.DH7(s.standalone,n)||(s.standalone=n),e.Njj(n)}),e.k0s()}if(2&o){const t=e.XpG().$implicit;e.R50("ngModel",t.standalone),e.Y8G("binary",!0)}}function jo(o,c){if(1&o){const t=e.RV6();e.j41(0,"p-checkbox",21),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG().$implicit;return e.DH7(s.standalone,n)||(s.standalone=n),e.Njj(n)}),e.k0s()}if(2&o){const t=e.XpG().$implicit;e.R50("ngModel",t.standalone),e.Y8G("readonly",!0)("binary",!0)}}function wo(o,c){if(1&o){const t=e.RV6();e.j41(0,"p-chips",22),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG().$implicit;return e.DH7(s.aliases,n)||(s.aliases=n),e.Njj(n)}),e.k0s()}if(2&o){const t=e.XpG().$implicit;e.R50("ngModel",t.aliases)}}function xo(o,c){if(1&o&&(e.j41(0,"div"),e.EFF(1),e.k0s()),2&o){const t=c.$implicit;e.R7$(),e.JRh(t)}}function Po(o,c){if(1&o&&e.DNE(0,xo,2,1,"div",23),2&o){const t=e.XpG().$implicit;e.Y8G("ngForOf",t.aliases)}}function Mo(o,c){if(1&o){const t=e.RV6();e.j41(0,"button",24),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,s=e.XpG(2);return e.Njj(s.onRowEditInit(n))}),e.k0s()}}function zo(o,c){if(1&o){const t=e.RV6();e.j41(0,"button",25),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,s=e.XpG(2);return e.Njj(s.onRowEditSave(n))}),e.k0s()}}function Bo(o,c){if(1&o){const t=e.RV6();e.j41(0,"button",26),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,s=e.XpG(2);return e.Njj(s.onRowEditCancel(n))}),e.k0s()}}function Go(o,c){if(1&o&&(e.j41(0,"tr",13)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td")(6,"p-cellEditor"),e.DNE(7,Do,1,2,"ng-template",14)(8,jo,1,3,"ng-template",15),e.k0s()(),e.j41(9,"td"),e.EFF(10),e.k0s(),e.j41(11,"td")(12,"p-cellEditor"),e.DNE(13,wo,1,1,"ng-template",14)(14,Po,1,1,"ng-template",15),e.k0s()(),e.j41(15,"td")(16,"div",16),e.DNE(17,Mo,1,0,"button",17)(18,zo,1,0,"button",18)(19,Bo,1,0,"button",19),e.k0s()()()),2&o){const t=c.$implicit,r=c.editing;e.Y8G("pEditableRow",t),e.R7$(2),e.JRh(t.name),e.R7$(2),e.JRh(t.address),e.R7$(6),e.JRh(null==t.warehouseCluster?null:t.warehouseCluster.name),e.R7$(7),e.Y8G("ngIf",!r),e.R7$(),e.Y8G("ngIf",r),e.R7$(),e.Y8G("ngIf",r)}}function Lo(o,c){if(1&o){const t=e.RV6();e.j41(0,"p-table",2),e.bIt("onEditComplete",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.editComplete(n))}),e.DNE(1,To,17,6,"ng-template",3)(2,Go,20,7,"ng-template",4),e.k0s()}if(2&o){const t=e.XpG();e.Y8G("value",t.data)("tableStyle",e.lJ4(6,Fo))("paginator",!0)("rows",100)("rowsPerPageOptions",e.lJ4(7,So))("totalRecords",t.totalRecords)}}let Ao=(()=>{class o extends p.x{constructor(t,r,n){super(n),this.ozonWarehouseService=t,this.messageService=r,this.clonedData={},this.warehouseClusters=[]}ngOnInit(){this.titleService.setTitle("\u0421\u043a\u043b\u0430\u0434\u044b Ozon"),this.getOzonWarehouses()}getOzonWarehouses(){this.ozonWarehouseService.getWarehouses(!0,!0).pipe((0,g.W)(t=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430",severity:"error",detail:t}),y.w))).subscribe(t=>{this.data=t,this.warehouseClusters=[...t.reduce((r,n)=>(r.add(n.warehouseCluster?.name),r),new Set)].sort()})}onRowEditInit(t){this.clonedData[t.iD]=new i.D.OzonWarehouse(t)}onRowEditCancel(t){const r=this.data.findIndex(n=>n.iD==t.iD);this.data[r]=this.clonedData[t.iD],delete this.clonedData[t.iD]}onRowEditSave(t){this.ozonWarehouseService.updateWarehouse(t).pipe((0,g.W)(r=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430",severity:"error",detail:r}),y.w))).subscribe()}importWarehouses(){var t=this;return(0,C.A)(function*(){t.ozonWarehouseService.importOzonWarehouses().pipe((0,g.W)(r=>(t.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430",severity:"error",detail:r}),y.w))).subscribe(()=>{t.messageService.add({summary:"\u0423\u0441\u043f\u0435\u0445",severity:"success",detail:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0441\u043a\u043b\u0430\u0434\u043e\u0432 \u041e\u0437\u043e\u043d \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0430"}),t.getOzonWarehouses()})})()}static{this.\u0275fac=function(r){return new(r||o)(e.rXU(ue.t),e.rXU(l.bg),e.rXU(h.hE))}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["app-ozon-warehouse-list"]],features:[e.Vt3],decls:5,vars:1,consts:[["pButton","","pRipple","","type","button","label","\u0418\u043c\u043f\u043e\u0440\u0442 \u0441\u043a\u043b\u0430\u0434\u043e\u0432",3,"click"],["dataKey","iD","editMode","row",3,"value","tableStyle","paginator","rows","rowsPerPageOptions","totalRecords","onEditComplete",4,"ngIf"],["dataKey","iD","editMode","row",3,"onEditComplete","value","tableStyle","paginator","rows","rowsPerPageOptions","totalRecords"],["pTemplate","header"],["pTemplate","body"],["type","text","field","name","matchMode","contains",3,"showMatchModes","showOperator","showAddButton"],["pSortableColumn","warehouseCluster"],["field","warehouseCluster.name"],["field","warehouseCluster.name","matchMode","in","display","menu",3,"showMatchModes","showOperator","showAddButton"],["pTemplate","filter"],[1,"px-3","pt-3","pb-0"],[1,"font-bold"],["placeholder","\u0412\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0435",3,"onChange","ngModel","filter","options"],[3,"pEditableRow"],["pTemplate","input"],["pTemplate","output"],[1,"flex","align-items-center","justify-content-center","gap-2"],["pButton","","pRipple","","type","button","pInitEditableRow","","icon","pi pi-pencil","class","p-button-rounded p-button-text",3,"click",4,"ngIf"],["pButton","","pRipple","","type","button","pSaveEditableRow","","icon","pi pi-check","class","p-button-rounded p-button-text p-button-success mr-2",3,"click",4,"ngIf"],["pButton","","pRipple","","type","button","pCancelEditableRow","","icon","pi pi-times","class","p-button-rounded p-button-text p-button-danger",3,"click",4,"ngIf"],["inputId","binary",3,"ngModelChange","ngModel","binary"],["inputId","binary",3,"ngModelChange","ngModel","readonly","binary"],["separator","",3,"ngModelChange","ngModel"],[4,"ngFor","ngForOf"],["pButton","","pRipple","","type","button","pInitEditableRow","","icon","pi pi-pencil",1,"p-button-rounded","p-button-text",3,"click"],["pButton","","pRipple","","type","button","pSaveEditableRow","","icon","pi pi-check",1,"p-button-rounded","p-button-text","p-button-success","mr-2",3,"click"],["pButton","","pRipple","","type","button","pCancelEditableRow","","icon","pi pi-times",1,"p-button-rounded","p-button-text","p-button-danger",3,"click"]],template:function(r,n){1&r&&(e.nrm(0,"p-toast"),e.j41(1,"h1"),e.EFF(2,"\u0421\u043a\u043b\u0430\u0434\u044b Ozon"),e.k0s(),e.j41(3,"button",0),e.bIt("click",function(){return n.importWarehouses()}),e.k0s(),e.DNE(4,Lo,3,8,"p-table",1)),2&r&&(e.R7$(4),e.Y8G("ngIf",n.data))},dependencies:[l.Ei,F._f,te.Sc,Oe,v.Sq,v.bT,P.BC,P.vS,X.KF,M.XI,M.Tg,M.c5,M.yc,M.Xk,M.Hd,M.E7,M.Tf,M.rl,z.y8]})}}return o})();var $o=f(152),ae=f(2288);const No=()=>["name"],Xo=()=>({"min-width":"75rem"}),Vo=o=>({"bg-orange-100":o});function Yo(o,c){if(1&o&&(e.j41(0,"div",17)(1,"div"),e.EFF(2),e.k0s()()),2&o){const t=c.$implicit;e.R7$(2),e.JRh(t.name)}}function Ho(o,c){if(1&o&&(e.j41(0,"div",17)(1,"div"),e.EFF(2),e.k0s()()),2&o){const t=c.$implicit;e.R7$(2),e.JRh(t.name)}}function Wo(o,c){1&o&&(e.j41(0,"tr",23)(1,"th"),e.EFF(2,"ID"),e.k0s(),e.j41(3,"th"),e.EFF(4,"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435"),e.k0s(),e.j41(5,"th"),e.EFF(6," \u041d\u0430\u043b\u0438\u0447\u0438\u0435 / \u0420\u0435\u0437\u0435\u0440\u0432 / \u0412 \u043f\u0443\u0442\u0438 "),e.k0s(),e.j41(7,"th"),e.EFF(8,"\u041a \u043f\u043e\u0441\u0442\u0430\u0432\u043a\u0435, \u0448\u0442"),e.k0s(),e.j41(9,"th"),e.EFF(10,"\u041f\u0440\u043e\u0434\u0430\u0436 \u0437\u0430 \u043f\u0435\u0440\u0438\u043e\u0434 / \u0432 \u0434\u0435\u043d\u044c "),e.k0s(),e.j41(11,"th"),e.EFF(12,"\u0417\u0430\u043f\u0430\u0441 \u0432 \u0434\u043d\u044f\u0445"),e.k0s()())}function Uo(o,c){if(1&o&&(e.j41(0,"tr")(1,"td",24)(2,"div",17)(3,"span",25),e.EFF(4),e.k0s(),e.nrm(5,"button",26),e.k0s()()()),2&o){const t=c.$implicit,r=c.expanded;e.R7$(4),e.JRh(t.cluster),e.R7$(),e.Y8G("pRowToggler",t)("icon",r?"pi pi-chevron-down":"pi pi-chevron-right")}}function Jo(o,c){if(1&o&&(e.qex(0),e.EFF(1),e.bVm()),2&o){const t=e.XpG().$implicit;e.R7$(),e.Lme(" ",t.shipmentAmountFrom," - ",t.shipmentAmountTo," ")}}function qo(o,c){1&o&&(e.qex(0),e.EFF(1,"-"),e.bVm())}function Qo(o,c){if(1&o&&(e.qex(0),e.j41(1,"div"),e.EFF(2),e.k0s(),e.j41(3,"div"),e.EFF(4),e.nI1(5,"number"),e.k0s(),e.bVm()),2&o){const t=e.XpG().$implicit;e.R7$(2),e.JRh(t.salesCount),e.R7$(2),e.SpI(" ",e.i5U(5,2,t.salesPerDay,"1.0-1")," ")}}function Ko(o,c){1&o&&(e.qex(0),e.EFF(1,"-"),e.bVm())}function Zo(o,c){1&o&&(e.qex(0),e.EFF(1,"\u221e"),e.bVm())}function ei(o,c){if(1&o&&(e.qex(0),e.EFF(1),e.nI1(2,"number"),e.bVm()),2&o){const t=e.XpG().$implicit;e.R7$(),e.SpI(" ",e.i5U(2,1,t.stockInDays,"1.0-1")," ")}}function ti(o,c){if(1&o&&(e.j41(0,"tr",27)(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td")(4,"div",28)(5,"span",29),e.EFF(6),e.k0s()()(),e.j41(7,"td")(8,"div",30)(9,"div",31)(10,"div",32),e.EFF(11),e.k0s()(),e.j41(12,"div",31)(13,"div",32),e.EFF(14),e.k0s()(),e.j41(15,"div",31)(16,"div",32),e.EFF(17),e.k0s()()()(),e.j41(18,"td"),e.DNE(19,Jo,2,2,"ng-container",16)(20,qo,2,0,"ng-container",16),e.k0s(),e.j41(21,"td"),e.DNE(22,Qo,6,5,"ng-container",16)(23,Ko,2,0,"ng-container",16),e.k0s(),e.j41(24,"td"),e.DNE(25,Zo,2,0,"ng-container",16)(26,ei,3,4,"ng-container",16),e.k0s()()),2&o){const t=c.$implicit;e.Y8G("ngClass",e.eq3(13,Vo,t.StockDays<=t.ShipmentDays)),e.R7$(2),e.JRh(t.iD),e.R7$(3),e.FS9("pTooltip",t.name),e.R7$(),e.SpI(" ",t.name," "),e.R7$(5),e.JRh(t.availableQuantity),e.R7$(3),e.JRh(t.reservedQuantity),e.R7$(3),e.SpI(" ",t.inTransitQuantity," "),e.R7$(2),e.Y8G("ngIf",t.shipmentAmountFrom&&t.shipmentAmountTo),e.R7$(),e.Y8G("ngIf",!t.shipmentAmountFrom||!t.shipmentAmountTo),e.R7$(2),e.Y8G("ngIf",t.salesCount),e.R7$(),e.Y8G("ngIf",!t.salesCount),e.R7$(2),e.Y8G("ngIf",null==t.stockInDays),e.R7$(),e.Y8G("ngIf",null!=t.stockInDays)}}function ni(o,c){if(1&o){const t=e.RV6();e.qex(0),e.j41(1,"p-table",18),e.DNE(2,Wo,13,0,"ng-template",19)(3,Uo,6,3,"ng-template",20)(4,ti,27,15,"ng-template",21),e.k0s(),e.j41(5,"p-button",22),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.downloadBlob())}),e.EFF(6,"\u0421\u043a\u0430\u0447\u0430\u0442\u044c xlsx"),e.k0s(),e.bVm()}if(2&o){const t=e.XpG();e.R7$(),e.Y8G("globalFilterFields",e.lJ4(7,No))("loading",t.loading)("scrollable",!0)("paginator",!1)("sortOrder",1)("tableStyle",e.lJ4(8,Xo))("value",t.items)}}let oi=(()=>{class o extends p.x{constructor(t,r,n,s,d,S){super(d),this.route=t,this.reportClient=r,this.messageService=n,this.warehouseService=s,this.dbService=S,this.loading=!1,this.filter=new i.D.OzonClusterSalesReportModel({daysToAnalyze:null,notificationPeriodInDays:null,respectMinimalStock:!1,respectSupplyPreparationPeriod:!1,respectActiveSupplyOrders:!1,minShipmentAmount:0,minStockDaysAmount:void 0}),this.filterSubject=new b.t(null),this.clusters=[],this.dropOffWarehouses=[],this.selectedDropOffWarehouseIDs=[]}ngOnInit(){this.titleService.setTitle("\u0414\u0435\u0444\u0438\u0446\u0438\u0442 \u0442\u043e\u0432\u0430\u0440\u043e\u0432 Ozon"),this.warehouseService.getWarehouseClusters().pipe((0,g.W)(d=>(this.loading=!1,this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u043e\u0432",severity:"error",detail:d}),y.w))).subscribe(d=>{this.clusters=d.filter(S=>S.sellingCluster).sort((S,x)=>S.name.localeCompare(x.name))}),this.warehouseService.getWarehouses(!1,!1).pipe((0,g.W)(d=>(this.loading=!1,this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0441\u043a\u043b\u0430\u0434\u043e\u0432",severity:"error",detail:d}),y.w))).subscribe(d=>{this.dropOffWarehouses=d.filter(S=>S.type==i.D.OzonWarehouseType.CrossDock||S.type==i.D.OzonWarehouseType.DistributionCenter||S.type==i.D.OzonWarehouseType.SortingCenter).sort((S,x)=>S.name.localeCompare(x.name))}),this.filterSubject.pipe((0,O.Q)(this.destroyed),(0,k.p)(d=>!!d),(0,$o.B)(1e3)).pipe((0,k.p)(d=>d.daysToAnalyze>0)).subscribe(d=>{this.loading=!0;const S={...d};delete S.date,this.dbService.update("filters",{id:o.name,data:S}).pipe((0,g.W)(x=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0444\u0438\u043b\u044c\u0442\u0440\u0430",severity:"error",detail:x}),y.w))).subscribe(),this.reportClient.getOzonClusterSalesReport(new i.D.OzonClusterSalesReportModel(d)).pipe((0,g.W)(x=>(this.loading=!1,this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430",severity:"error",detail:x}),y.w))).subscribe(x=>{this.data=x,this.items=this.data.sort((j,D)=>{let G=j.cluster.localeCompare(D.cluster);return G||(G=Math.sign(j.iD-D.iD)),G}).map(j=>{const D=j;return D.salesPerDay=d.daysToAnalyze?D.salesCount/d.daysToAnalyze:null,D}),this.loading=!1})});const t=+this.route.snapshot.paramMap.get("salesAnalysisInDays"),r=+this.route.snapshot.paramMap.get("notificationPeriodInDays");this.route.snapshot.paramMap.get("date"),this.filter.daysToAnalyze=t>0?t:7,this.filter.notificationPeriodInDays=r>0?r:7,this.dbService.getByID("filters",o.name).subscribe(d=>{d&&(d.data&&(this.filter=Object.assign(d.data,{clusterIDs:[],dropOffWarehouseIDs:[1,189]})),this.filterSubject.next(this.filter))}),this.filter.daysToAnalyze>0&&this.filter.notificationPeriodInDays>0&&this.filterSubject.next(this.filter)}onFilterChanged(){this.filterSubject.next(this.filter)}updateSelectedClusters(){const n=this.compareArrays(this.selectedClusterIDs,this.filter.clusterIDs);null!=n&&(this.filter.clusterIDs=n,this.filterSubject.next(this.filter))}updateSelectedDropOffWarehouses(){const n=this.compareArrays(this.selectedDropOffWarehouseIDs,this.filter.dropOffWarehouseIDs);null!=n&&(this.filter.dropOffWarehouseIDs=n,this.filterSubject.next(this.filter))}compareArrays(t,r){const n=t?.length??0,s=r?.length??0,d=t?.sort((x,j)=>x-j)??[];return n==s&&d?.every((x,j)=>x==r[j])?void 0:d}generatePivotTable(t){const r={},n=new Set,s=new Set;t.forEach(D=>{n.add(D.cluster),s.add(D.iD),r[D.iD]||(r[D.iD]={name:D.name,clusters:{}}),r[D.iD].clusters[D.cluster]=D.shipmentAmountFrom});const d=Array.from(n).sort(),S=Array.from(s).sort((D,G)=>D-G),x=[],j=["ID","Name",...d];return x.push(j),S.forEach(D=>{const G=[{v:D,t:"n"},r[D].name];d.forEach(B=>{const R=r[D]?.clusters[B];G.push(R?{v:R,t:"n"}:0)}),x.push(G)}),{data:x,clusters:d,productIDs:S}}exportToExcelBlob(t){const{data:r}=this.generatePivotTable(t),n=ae.Wp.book_new(),s=ae.Wp.aoa_to_sheet(r);s["!cols"]=[{wch:10},{wch:30},...Array(r[0].length-1).fill({wch:30})],ae.Wp.book_append_sheet(n,s,"\u0414\u0435\u0444\u0438\u0446\u0438\u0442");const d=ae.M9(n,{bookType:"xlsx",type:"array",bookSST:!1});return new Blob([d],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})}downloadBlob(){const t=this.exportToExcelBlob(this.items),r=window.URL.createObjectURL(t),n=document.createElement("a");n.href=r,n.download=`\u0434\u0435\u0444\u0438\u0446\u0438\u0442-${Date.now()/1e3}.xlsx`,document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(r)}static{this.\u0275fac=function(r){return new(r||o)(e.rXU(E.nX),e.rXU(i.D.ReportClient),e.rXU(l.bg),e.rXU(ue.t),e.rXU(h.hE),e.rXU(m.MX))}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["app-stock-starvation-report"]],features:[e.Vt3],decls:32,vars:24,consts:[[1,"card","pb-3"],[1,"flex","gap-3","mb-3"],[1,"p-float-label"],["inputId","salesAnalysisInDays",3,"onInput","ngModelChange","ngModel","min","required"],["htmlFor","number-input"],["inputId","maxStockDaysAmount",3,"onInput","ngModelChange","ngModel","min","required"],["htmlFor","maxStockDaysAmount"],["inputId","minShipmentAmount",3,"onInput","ngModelChange","ngModel","min","required"],["htmlFor","minShipmentAmount"],["appendTo","body","filterBy","name","maxSelectedLabels","3","optionLabel","name","optionValue","iD","placeholder","\u0421\u043a\u043b\u0430\u0434\u044b \u043e\u0442\u0433\u0440\u0443\u0437\u043a\u0438",3,"onClear","onPanelHide","ngModelChange","ngModel","options","resetFilterOnHide","showClear"],["pTemplate","item"],["appendTo","body","filterBy","name","maxSelectedLabels","3","optionLabel","name","optionValue","iD","placeholder","\u0412\u0441\u0435 \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u044b",3,"onClear","onPanelHide","ngModelChange","ngModel","options","resetFilterOnHide","showClear"],[1,"flex","gap-3"],["input","respectMinimalStock","label","\u0423\u0447\u0438\u0442\u044b\u0432\u0430\u0442\u044c \u043c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439 \u043e\u0441\u0442\u0430\u0442\u043e\u043a",3,"onChange","ngModelChange","ngModel","binary"],["input","respectActiveSupplyOrders","label","\u0423\u0447\u0438\u0442\u044b\u0432\u0430\u0442\u044c \u043f\u043e\u0441\u0442\u0430\u0432\u043a\u0438 \u0432 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0435",3,"onChange","ngModelChange","ngModel","binary"],["input","respectSupplyPreparationPeriod","label","\u0423\u0447\u0438\u0442\u044b\u0432\u0430\u0442\u044c \u043f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0443 \u043a \u043f\u043e\u0441\u0442\u0430\u0432\u043a\u0435",3,"onChange","ngModelChange","ngModel","binary"],[4,"ngIf"],[1,"flex","align-items-center","gap-2"],["scrollHeight","400px","groupRowsBy","cluster","rowGroupMode","subheader","dataKey","cluster","sortField","stockDays",3,"globalFilterFields","loading","scrollable","paginator","sortOrder","tableStyle","value"],["pTemplate","header"],["pTemplate","groupheader"],["pTemplate","rowexpansion"],[3,"click"],[1,"white-space-nowrap","m-0","p-0"],["colspan","6"],[1,"flex","align-items-center"],["pButton","","text","","rounded","","plain","",1,"flex","align-items-center","justify-content-center",3,"pRowToggler","icon"],[3,"ngClass"],[1,"flex"],["tooltipPosition","top",1,"truncate-text","w-24rem",3,"pTooltip"],[1,"flex","justify-content-between","align-items-center","gap-2"],[1,"text-center","w-4rem"],[1,"text-lg"]],template:function(r,n){1&r&&(e.nrm(0,"p-toast"),e.j41(1,"h1"),e.EFF(2," \u041e\u0442\u0447\u0451\u0442 \u043e \u0437\u0430\u043a\u0430\u043d\u0447\u0438\u0432\u0430\u044e\u0449\u0438\u0445\u0441\u044f \u043e\u0441\u0442\u0430\u0442\u043a\u0430\u0445\n"),e.k0s(),e.j41(3,"div",0)(4,"div",1)(5,"span",2)(6,"p-inputNumber",3),e.bIt("onInput",function(){return n.onFilterChanged()}),e.mxI("ngModelChange",function(d){return e.DH7(n.filter.daysToAnalyze,d)||(n.filter.daysToAnalyze=d),d}),e.k0s(),e.j41(7,"label",4),e.EFF(8,"\u041f\u0435\u0440\u0438\u043e\u0434 \u0430\u043d\u0430\u043b\u0438\u0437\u0430 \u043f\u0440\u043e\u0434\u0430\u0436, \u0434\u043d\u0435\u0439"),e.k0s()(),e.j41(9,"span",2)(10,"p-inputNumber",5),e.bIt("onInput",function(){return n.onFilterChanged()}),e.mxI("ngModelChange",function(d){return e.DH7(n.filter.maxStockDaysAmount,d)||(n.filter.maxStockDaysAmount=d),d}),e.k0s(),e.j41(11,"label",6),e.EFF(12,"\u0417\u0430\u043f\u0430\u0441 \u043e\u0441\u0442\u0430\u0442\u043a\u043e\u0432, \u0434\u043d\u0435\u0439"),e.k0s()(),e.j41(13,"span",2)(14,"p-inputNumber",7),e.bIt("onInput",function(){return n.onFilterChanged()}),e.mxI("ngModelChange",function(d){return e.DH7(n.filter.minShipmentAmount,d)||(n.filter.minShipmentAmount=d),d}),e.k0s(),e.j41(15,"label",8),e.EFF(16,"\u041c\u0438\u043d\u0438\u043c\u0443\u043c \u043a \u043f\u043e\u0441\u0442\u0430\u0432\u043a\u0435, \u0448\u0442"),e.k0s()(),e.j41(17,"span",2)(18,"p-multiSelect",9),e.bIt("onClear",function(){return n.updateSelectedDropOffWarehouses()})("onPanelHide",function(){return n.updateSelectedDropOffWarehouses()}),e.mxI("ngModelChange",function(d){return e.DH7(n.selectedDropOffWarehouseIDs,d)||(n.selectedDropOffWarehouseIDs=d),d}),e.DNE(19,Yo,3,1,"ng-template",10),e.k0s(),e.j41(20,"label",8),e.EFF(21,"\u0421\u043a\u043b\u0430\u0434\u044b \u043e\u0442\u0433\u0440\u0443\u0437\u043a\u0438"),e.k0s()(),e.j41(22,"span",2)(23,"p-multiSelect",11),e.bIt("onClear",function(){return n.updateSelectedClusters()})("onPanelHide",function(){return n.updateSelectedClusters()}),e.mxI("ngModelChange",function(d){return e.DH7(n.selectedClusterIDs,d)||(n.selectedClusterIDs=d),d}),e.DNE(24,Ho,3,1,"ng-template",10),e.k0s(),e.j41(25,"label",8),e.EFF(26,"\u041a\u043b\u0430\u0441\u0442\u0435\u0440\u044b \u043f\u043e\u0441\u0442\u0430\u0432\u043a\u0438"),e.k0s()()(),e.j41(27,"div",12)(28,"p-checkbox",13),e.bIt("onChange",function(){return n.onFilterChanged()}),e.mxI("ngModelChange",function(d){return e.DH7(n.filter.respectMinimalStock,d)||(n.filter.respectMinimalStock=d),d}),e.k0s(),e.j41(29,"p-checkbox",14),e.bIt("onChange",function(){return n.onFilterChanged()}),e.mxI("ngModelChange",function(d){return e.DH7(n.filter.respectActiveSupplyOrders,d)||(n.filter.respectActiveSupplyOrders=d),d}),e.k0s(),e.j41(30,"p-checkbox",15),e.bIt("onChange",function(){return n.onFilterChanged()}),e.mxI("ngModelChange",function(d){return e.DH7(n.filter.respectSupplyPreparationPeriod,d)||(n.filter.respectSupplyPreparationPeriod=d),d}),e.k0s()()(),e.DNE(31,ni,7,9,"ng-container",16)),2&r&&(e.R7$(6),e.R50("ngModel",n.filter.daysToAnalyze),e.Y8G("min",1)("required",!0),e.R7$(4),e.R50("ngModel",n.filter.maxStockDaysAmount),e.Y8G("min",1)("required",!0),e.R7$(4),e.R50("ngModel",n.filter.minShipmentAmount),e.Y8G("min",0)("required",!0),e.R7$(4),e.R50("ngModel",n.selectedDropOffWarehouseIDs),e.Y8G("options",n.dropOffWarehouses)("resetFilterOnHide",!0)("showClear",!0),e.R7$(5),e.R50("ngModel",n.selectedClusterIDs),e.Y8G("options",n.clusters)("resetFilterOnHide",!0)("showClear",!0),e.R7$(5),e.R50("ngModel",n.filter.respectMinimalStock),e.Y8G("binary",!0),e.R7$(),e.R50("ngModel",n.filter.respectActiveSupplyOrders),e.Y8G("binary",!0),e.R7$(),e.R50("ngModel",n.filter.respectSupplyPreparationPeriod),e.Y8G("binary",!0),e.R7$(),e.Y8G("ngIf",n.items))},dependencies:[l.Ei,F._f,F.$n,te.Sc,v.YU,v.bT,P.BC,P.YS,P.vS,ie.YI,X.KF,M.XI,M.FP,z.y8,ce.m,v.QX],styles:[".truncate-text[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}"]})}}return o})();const ii=()=>[10,50,100,250],ri=()=>({"min-width":"50rem"}),ui=o=>({"bg-orange-100":o});function ai(o,c){if(1&o){const t=e.RV6();e.j41(0,"h1"),e.EFF(1,"\u0410\u043a\u0446\u0438\u0438 Ozon"),e.k0s(),e.j41(2,"div",5)(3,"button",6),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.togglePromotionExpansion())}),e.k0s(),e.j41(4,"button",7),e.bIt("click",function(){e.eBV(t);const n=e.XpG(2);return e.Njj(n.importOzonPromotions())}),e.k0s()(),e.j41(5,"div",5)(6,"p-checkbox",8),e.bIt("onChange",function(n){e.eBV(t);const s=e.XpG(2);return e.Njj(s.toggleDeletedFilter(n))}),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG(2);return e.DH7(s.filterModel.excludeDeleted,n)||(s.filterModel.excludeDeleted=n),e.Njj(n)}),e.k0s(),e.j41(7,"label",9),e.EFF(8,"\u0418\u0441\u043a\u043b\u044e\u0447\u0438\u0442\u044c \u0430\u0440\u0445\u0438\u0432\u043d\u044b\u0435"),e.k0s()()}if(2&o){const t=e.XpG(2);e.R7$(3),e.Y8G("label",t.expandedAll?"\u0421\u0432\u0435\u0440\u043d\u0443\u0442\u044c \u0430\u043a\u0446\u0438\u0438":"\u0420\u0430\u0437\u0432\u0435\u0440\u043d\u0443\u0442\u044c \u0430\u043a\u0446\u0438\u0438"),e.R7$(3),e.R50("ngModel",t.filterModel.excludeDeleted),e.Y8G("binary",!0)}}function si(o,c){if(1&o&&e.nrm(0,"button",20),2&o){const t=e.XpG(),n=t.$implicit;e.Y8G("icon",t.expanded?"pi pi-chevron-down":"pi pi-chevron-right")("pRowToggler",n)}}function li(o,c){if(1&o&&(e.qex(0,18),e.EFF(1),e.bVm()),2&o){const t=e.XpG(2).$implicit;e.R7$(),e.SpI(" (\u0417\u0430\u043a\u0430\u0437 \u043e\u0442 ",t.orderAmount,"\u20bd) ")}}function ci(o,c){if(1&o&&(e.j41(0,"div",18),e.EFF(1),e.DNE(2,li,2,1,"ng-container",19),e.k0s()),2&o){const t=e.XpG().$implicit;e.R7$(),e.SpI(" \u0421\u043a\u0438\u0434\u043a\u0430: ","CURRENCY"===t.discountType?t.discountValue+"\u20bd":"PERCENT"===t.discountType?t.discountValue+"%":t.discountType+" - "+t.discountValue," "),e.R7$(),e.Y8G("ngIf",t.orderAmount)}}function pi(o,c){1&o&&(e.j41(0,"div",18),e.nrm(1,"i",21),e.EFF(2," \u041f\u0440\u043e\u043c\u043e\u043a\u043e\u0434 "),e.k0s())}function di(o,c){if(1&o&&(e.j41(0,"div",18),e.EFF(1," \u041d\u043e\u0432\u044b\u0445 \u0442\u043e\u0432\u0430\u0440\u043e\u0432: "),e.j41(2,"p-tag",22),e.EFF(3),e.k0s()()),2&o){const t=e.XpG().$implicit;e.R7$(2),e.Y8G("severity",t._activeProductCount?"danger":"success"),e.R7$(),e.SpI(" ",t._unconfirmedProductCount," ")}}function _i(o,c){if(1&o&&(e.j41(0,"tr")(1,"td",10)(2,"div",11),e.DNE(3,si,1,2,"button",12),e.k0s()(),e.j41(4,"td")(5,"div",13)(6,"div",14)(7,"div",15)(8,"div")(9,"div",16)(10,"a",17),e.EFF(11),e.k0s()(),e.j41(12,"div",18),e.EFF(13),e.k0s(),e.DNE(14,ci,3,2,"div",19)(15,pi,3,0,"div",19)(16,di,4,2,"div",19),e.k0s()()()()()()),2&o){const t=c.$implicit;e.R7$(3),e.Y8G("ngIf",t.products.length),e.R7$(7),e.Mz_("href","https://seller.ozon.ru/app/highlights/",t.iD,"",e.B4B),e.R7$(),e.SpI(" ",t.name," "),e.R7$(2),e.SpI(" \u0422\u0438\u043f: ",t.actionType," "),e.R7$(),e.Y8G("ngIf",t.discountValue),e.R7$(),e.Y8G("ngIf",t.isVoucherAction),e.R7$(),e.Y8G("ngIf",t.products.length)}}function fi(o,c){if(1&o){const t=e.RV6();e.j41(0,"tr")(1,"th",27)(2,"div"),e.nrm(3,"p-sortIcon",28),e.k0s(),e.j41(4,"div",29)(5,"p-checkbox",30),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,s=e.XpG(2);return e.Njj(s.toggleCheckedProducts(n))}),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG().$implicit;return e.DH7(s.allChecked,n)||(s.allChecked=n),e.Njj(n)}),e.k0s()()(),e.j41(6,"th",31),e.EFF(7,"\u0410\u0440\u0442\u0438\u043a\u0443\u043b "),e.nrm(8,"p-sortIcon",32),e.k0s(),e.j41(9,"th"),e.EFF(10,"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435"),e.k0s(),e.j41(11,"th")(12,"div"),e.EFF(13,"\u0426\u0435\u043d\u0430 \u043f\u0440\u043e\u0434\u0430\u0436\u0438"),e.k0s(),e.j41(14,"div",33),e.EFF(15,"\u041f\u043e\u043b\u043d\u0430\u044f \u0446\u0435\u043d\u0430"),e.k0s(),e.j41(16,"div",33),e.EFF(17,"\u041c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u0430\u044f \u0446\u0435\u043d\u0430"),e.k0s()(),e.j41(18,"th"),e.EFF(19," \u0426\u0435\u043d\u0430 \u043f\u043e \u0430\u043a\u0446\u0438\u0438 "),e.nrm(20,"br"),e.j41(21,"span",33),e.EFF(22,"\u041c\u0430\u043a\u0441. \u0446\u0435\u043d\u0430 \u043f\u043e \u0430\u043a\u0446\u0438\u0438"),e.k0s()(),e.j41(23,"th"),e.EFF(24,"\u041c\u0438\u043d. \u0441\u0442\u043e\u043a"),e.k0s(),e.j41(25,"th"),e.EFF(26,"\u0421\u0442\u043e\u043a"),e.k0s()()}if(2&o){const t=e.XpG().$implicit;e.R7$(5),e.R50("ngModel",t.allChecked),e.Y8G("binary",!0)}}function mi(o,c){1&o&&(e.qex(0),e.j41(1,"tr"),e.nrm(2,"td",10),e.j41(3,"td",35),e.nrm(4,"p-skeleton",36),e.k0s(),e.nrm(5,"td",23),e.k0s(),e.bVm())}function hi(o,c){if(1&o){const t=e.RV6();e.j41(0,"input",42),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG(2).$implicit;return e.DH7(s.actionPrice,n)||(s.actionPrice=n),e.Njj(n)}),e.k0s(),e.j41(1,"div",33),e.EFF(2),e.k0s()}if(2&o){const t=e.XpG(2).$implicit;e.R50("ngModel",t.actionPrice),e.R7$(2),e.JRh(t.maxActionPrice)}}function gi(o,c){if(1&o&&(e.qex(0),e.j41(1,"p-tag",22)(2,"span",43),e.EFF(3),e.k0s()(),e.bVm()),2&o){const t=e.XpG(3).$implicit,r=e.XpG(3);e.R7$(),e.Y8G("severity",r.getPriceSeverity(t)),e.R7$(2),e.JRh(t.actionPrice)}}function vi(o,c){1&o&&(e.qex(0),e.EFF(1,"-"),e.bVm())}function bi(o,c){if(1&o&&(e.DNE(0,gi,4,2,"ng-container",34)(1,vi,2,0,"ng-container",34),e.j41(2,"div",33),e.EFF(3),e.k0s()),2&o){const t=e.XpG(2).$implicit;e.Y8G("ngIf",!!t.actionPrice),e.R7$(),e.Y8G("ngIf",!t.actionPrice),e.R7$(2),e.JRh(t.maxActionPrice)}}function yi(o,c){if(1&o){const t=e.RV6();e.qex(0),e.j41(1,"tr",37)(2,"td",10)(3,"div",38)(4,"p-checkbox",30),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,s=e.XpG().$implicit,d=e.XpG(2);return e.Njj(d.changeCandidateState(s,n))}),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG().$implicit;return e.DH7(s._active,n)||(s._active=n),e.Njj(n)}),e.k0s()()(),e.j41(5,"td")(6,"a",17),e.EFF(7),e.k0s()(),e.j41(8,"td"),e.EFF(9),e.k0s(),e.j41(10,"td")(11,"div"),e.EFF(12),e.k0s(),e.j41(13,"div",33),e.EFF(14),e.k0s(),e.j41(15,"div",33),e.EFF(16),e.k0s()(),e.j41(17,"td",39)(18,"p-cellEditor"),e.DNE(19,hi,3,2,"ng-template",40)(20,bi,4,3,"ng-template",41),e.k0s()(),e.j41(21,"td"),e.EFF(22),e.k0s(),e.j41(23,"td"),e.EFF(24),e.k0s()(),e.bVm()}if(2&o){const t=e.XpG().$implicit;e.R7$(),e.Y8G("ngClass",e.eq3(13,ui,!t.isCandidate&&!t.confirmed)),e.R7$(3),e.R50("ngModel",t._active),e.Y8G("binary",!0),e.R7$(2),e.Mz_("href","https://seller.ozon.ru/app/prices/manager/",t.ozonProduct.ozonProductID,"/prices",e.B4B),e.R7$(),e.SpI(" ",t.ozonProduct.productPackageID," "),e.R7$(2),e.JRh(t.ozonProduct.name),e.R7$(3),e.JRh(t.ozonProduct.marketingPrice||"-"),e.R7$(2),e.JRh(t.ozonProduct.price||"-"),e.R7$(2),e.JRh(t.ozonProduct.minPrice||"-"),e.R7$(),e.Y8G("pEditableColumn",t.actionPrice),e.R7$(5),e.JRh(t.stock),e.R7$(2),e.JRh(t.minStock)}}function Ci(o,c){if(1&o&&e.DNE(0,mi,6,0,"ng-container",34)(1,yi,25,15,"ng-container",34),2&o){const t=c.$implicit;e.Y8G("ngIf",!t.ozonProduct),e.R7$(),e.Y8G("ngIf",t.ozonProduct)}}function Ei(o,c){if(1&o){const t=e.RV6();e.j41(0,"button",44),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,s=e.XpG(2);return e.Njj(s.updatePromotionProducts(n))}),e.k0s()}}function Oi(o,c){if(1&o&&(e.j41(0,"tr")(1,"td",23)(2,"p-table",24),e.DNE(3,fi,27,2,"ng-template",25)(4,Ci,2,2,"ng-template",3)(5,Ei,1,0,"ng-template",26),e.k0s()()()),2&o){const t=c.$implicit;e.R7$(2),e.Y8G("sortOrder",-1)("value",t.products)}}function ki(o,c){if(1&o){const t=e.RV6();e.j41(0,"p-table",1),e.bIt("onPage",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.pageChange(n))}),e.DNE(1,ai,9,3,"ng-template",2)(2,_i,17,8,"ng-template",3)(3,Oi,6,2,"ng-template",4),e.k0s()}if(2&o){const t=e.XpG();e.Y8G("expandedRowKeys",t.expandedRowKeys)("loading",t.loading)("paginator",!0)("rowsPerPageOptions",e.lJ4(8,ii))("rows",t.filterModel.count)("tableStyle",e.lJ4(9,ri))("totalRecords",t.totalRecords)("value",t.data)}}let Fi=(()=>{class o extends p.x{static{this.FilterID="OzonPromotionListComponent"}constructor(t,r,n,s,d,S){super(S),this.promotionReader=t,this.promotionWriter=r,this.messageService=n,this.ozonProductClient=s,this.dbService=d,this.loading=!1,this.expandedAll=!1,this.expandedRowKeys={},this.findModelSubject=new b.t(null),this.cachedProducts=new Map}ngOnInit(){this.titleService.setTitle("\u0410\u043a\u0446\u0438\u0438 Ozon"),this.findModelSubject.pipe((0,k.p)(t=>!!t)).pipe((0,O.Q)(this.destroyed)).pipe((0,re.n)(t=>{const r=Object.assign({},t);return this.dbService.update("filters",{id:o.FilterID,data:r}).pipe((0,g.W)(s=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043a",severity:"error",detail:s}),y.w))).subscribe(),this.findOzonPromotions(t)})).subscribe(t=>{const r=t.items.reduce((n,s)=>(this.preparePromotion(s),s.products.forEach(d=>{this.cachedProducts.has(d.iD)||n.add(d.iD)}),n),new Set);this.data=t.items,r.size?this.loadOzonProducts(r):this.data.forEach(n=>this.setOzonProducts(n)),this.totalRecords=t.totalCount}),this.dbService.getByID("filters",o.FilterID).subscribe(t=>{const r={count:50,offset:0,excludeCandidates:!1,includeProduct:!0,excludeDeleted:!0};t?.data&&Object.assign(r,t.data),this.filterModel=new i.D.FindOzonPromotionsModel(r),this.findModelSubject.next(this.filterModel)})}pageChange(t){(this.filterModel.count!=t.rows||this.filterModel.offset!=t.first)&&(this.filterModel.offset=t.first,this.findModelSubject.next(this.filterModel))}preparePromotion(t){Object.defineProperty(t,"_activeProductCount",{get:()=>t.products.filter(n=>!n.isCandidate).length});let r=0;return t.products.forEach(n=>{Object.defineProperty(n,"_active",{get:()=>!n.isCandidate,set:s=>n.isCandidate=!s}),r+=+(!n.confirmed&&!n.isCandidate)}),Object.assign(t,{_totalProductCount:t.products.length,_unconfirmedProductCount:r}),t}toggleDeletedFilter(){this.findModelSubject.next(this.filterModel)}changeCandidateState(t,r){if(!r.isCandidate&&!r.actionPrice){const n=r.ozonProduct;r.actionPrice=n.marketingPrice||n.price||n.minPrice}this.sortProducts(t),this.resetGroupCheckedState(t)}sortProducts(t){t.products.sort((r,n)=>{const d=n.ozonProduct,S=this.getMinimalPrice(r.ozonProduct),x=this.getMinimalPrice(d);return+r.isCandidate-+n.isCandidate||+r.confirmed-+n.confirmed||+(null!=r.maxActionPrice&&null!=S&&S<r.maxActionPrice)-+(null!=n.maxActionPrice&&null!=x&&x<n.maxActionPrice)||+(null==S)-+(null==x)||+(+S<r.maxActionPrice)-+(+x<n.maxActionPrice)})}getMinimalPrice(t){return t?.minPrice||t?.marketingPrice}getPriceSeverity(t){const r=this.getMinimalPrice(t.ozonProduct);return t.maxActionPrice<r?"danger":"success"}setOzonProducts(t){t.products.forEach(r=>{r.ozonProduct=this.cachedProducts.get(r.iD)}),this.sortProducts(t)}resetGroupCheckedState(t){const r=t;r.allChecked=!1,r.normalChecked=!1}toggleCheckedProducts(t){const r=t.allChecked;t.products.forEach(n=>{n.isCandidate=!r})}loadOzonProducts(t){this.ozonProductClient.findOzonProducts(new i.D.FindOzonProductsModel({productIDs:[...t],includeStocks:!1,offset:0,count:1e5})).subscribe(r=>{r.items.forEach(n=>{n.ozonProductID&&this.cachedProducts.set(n.ozonProductID,n)}),this.data.forEach(n=>this.setOzonProducts(n))})}updatePromotionProducts(t){const r=t.products.filter(n=>!n.isCandidate);this.promotionWriter.updateOzonPromotionProducts(t.iD,r).pipe((0,g.W)(n=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430",severity:"error",detail:n}),y.w))).subscribe(n=>{let s=!1;if(n.additionErrors)for(const S of Object.keys(n.additionErrors)){s=!0;const x=this.cachedProducts.get(+S);this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430",severity:"error",detail:`\u041e\u0448\u0438\u0431\u043a\u0430 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0442\u043e\u0432\u0430\u0440\u0430 #${x.name} \u0432 \u0430\u043a\u0446\u0438\u044e: ${n.additionErrors[S]}`})}if(n.deletionErrors)for(const S of Object.keys(n.deletionErrors)){s=!0;const x=this.cachedProducts.get(+S);this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430",severity:"error",detail:`\u041e\u0448\u0438\u0431\u043a\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u0442\u043e\u0432\u0430\u0440\u0430 #${x.name} \u0438\u0437 \u0430\u043a\u0446\u0438\u0438: ${n.additionErrors[S]}`})}s||this.messageService.add({summary:"\u0423\u0441\u043f\u0435\u0445",severity:"success",detail:"\u0421\u043f\u0438\u0441\u043e\u043a \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u043e\u0432 \u0430\u043a\u0446\u0438\u0438 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0438\u0437\u043c\u0435\u043d\u0451\u043d"});const d=this.data.findIndex(S=>S.iD==t.iD);this.data[d]=this.preparePromotion(t)})}togglePromotionExpansion(){this.expandedAll=!this.expandedAll,this.data.forEach(t=>{t.products.length&&(this.expandedRowKeys[t.iD]=this.expandedAll)})}findOzonPromotions(t){return this.promotionReader.findOzonPromotions(t).pipe((0,g.W)(r=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430",severity:"error",detail:r}),y.w)))}importOzonPromotions(){var t=this;return(0,C.A)(function*(){t.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430",severity:"error",detail:"\u041d\u0435 \u0440\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d\u043e"})})()}static{this.\u0275fac=function(r){return new(r||o)(e.rXU(i.D.OzonPromotionClient),e.rXU(a.X.OzonPromotionClient),e.rXU(l.bg),e.rXU(i.D.OzonProductClient),e.rXU(m.MX),e.rXU(h.hE))}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["app-ozon-promotion-list"]],features:[e.Vt3],decls:2,vars:1,consts:[["dataKey","iD",3,"expandedRowKeys","loading","paginator","rowsPerPageOptions","rows","tableStyle","totalRecords","value","onPage",4,"ngIf"],["dataKey","iD",3,"onPage","expandedRowKeys","loading","paginator","rowsPerPageOptions","rows","tableStyle","totalRecords","value"],["pTemplate","caption"],["pTemplate","body"],["pTemplate","rowexpansion"],[1,"flex","gap-3","p-2"],["pButton","","pRipple","","type","button",3,"click","label"],["label","\u0418\u043c\u043f\u043e\u0440\u0442 \u0430\u043a\u0446\u0438\u0439","pButton","","pRipple","","type","button",3,"click"],["inputId","deletedPromotionFilter",3,"onChange","ngModelChange","ngModel","binary"],["for","deletedPromotionFilter"],[2,"width","1%"],[1,"flex","align-items-center","justify-content-center","gap-2"],["class","p-button-text p-button-rounded p-button-plain","pButton","","pRipple","","type","button",3,"icon","pRowToggler",4,"ngIf"],[1,"flex","flex-column","sm:flex-row","sm:align-items-center"],[1,"flex","flex-column","md:flex-row","justify-content-between","md:align-items-center","flex-1"],[1,"flex","flex-row","md:flex-column","justify-content-between","align-items-start","gap-2"],[1,"text-lg","font-medium","font-bold","text-900","mt-2"],["target","_blank",3,"href"],[1,"text-lg","font-medium","text-900","mt-2"],["class","text-lg font-medium text-900 mt-2",4,"ngIf"],["pButton","","pRipple","","type","button",1,"p-button-text","p-button-rounded","p-button-plain",3,"icon","pRowToggler"],[1,"pi","pi-barcode","text-blue-500"],[3,"severity"],["colspan","2"],["sortField","_active",3,"sortOrder","value"],["pTemplate","header"],["pTemplate","footer"],["pSortableColumn","_active"],["field","_active"],[1,"p-2"],[3,"click","ngModelChange","ngModel","binary"],["pSortableColumn","ozonProduct.productPackageID"],["field","ozonProduct.productPackageID"],[1,"text-500"],[4,"ngIf"],["colspan","4"],["height","4rem","width","100%"],[3,"ngClass"],[1,"gap-2","p-2"],["pEditableColumnField","product.actionPrice",1,"text-center",3,"pEditableColumn"],["pTemplate","input"],["pTemplate","output"],["pInputText","","type","number",3,"ngModelChange","ngModel"],[1,"text-white-500"],["label","\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c","pButton","","pRipple","","type","button",3,"click"]],template:function(r,n){1&r&&(e.DNE(0,ki,4,10,"p-table",0),e.nrm(1,"p-toast")),2&r&&e.Y8G("ngIf",n.data&&n.filterModel)},dependencies:[l.Ei,F._f,te.Sc,ne.S,v.YU,v.bT,P.me,P.Q0,P.BC,P.vS,M.XI,M.Tg,M.FP,M.hp,M.c5,M.yc,K.v,z.y8,A.E]})}}return o})();var Si=f(1413),Ri=f(8141),ke=f(8537),Fe=f(8833);const Ii=["productAutocomplete"],Ti=()=>[10,25,50],Di=()=>({"min-width":"75rem"}),ji=()=>({width:"50vw"});function wi(o,c){if(1&o){const t=e.RV6();e.j41(0,"div",8)(1,"div",9)(2,"p-checkbox",10),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.showActiveTasksOnly,n)||(s.showActiveTasksOnly=n),e.Njj(n)}),e.bIt("onChange",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onFilterChanged())}),e.k0s(),e.j41(3,"label",11),e.EFF(4," \u0422\u043e\u043b\u044c\u043a\u043e \u043d\u0435\u0437\u0430\u0432\u0435\u0440\u0448\u0451\u043d\u043d\u044b\u0435 "),e.k0s()(),e.j41(5,"div",9)(6,"p-checkbox",12),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.includeDisabledTasks,n)||(s.includeDisabledTasks=n),e.Njj(n)}),e.bIt("onChange",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onFilterChanged())}),e.k0s(),e.j41(7,"label",13),e.EFF(8," \u041e\u0442\u043a\u043b\u044e\u0447\u0435\u043d\u043d\u044b\u0435 "),e.k0s()()(),e.j41(9,"div",8)(10,"p-button",14),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.changeTaskStatus(!1))}),e.EFF(11,"\u041e\u0442\u043a\u043b\u044e\u0447\u0438\u0442\u044c"),e.k0s(),e.j41(12,"p-button",14),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.changeTaskStatus(!0))}),e.EFF(13,"\u0412\u043a\u043b\u044e\u0447\u0438\u0442\u044c"),e.k0s()()}if(2&o){const t=e.XpG();e.R7$(2),e.R50("ngModel",t.showActiveTasksOnly),e.Y8G("binary",!0),e.R7$(4),e.R50("ngModel",t.includeDisabledTasks),e.Y8G("binary",!0),e.R7$(4),e.Y8G("disabled",!t.selectedTasks.length),e.R7$(2),e.Y8G("disabled",!t.selectedTasks.length)}}function xi(o,c){if(1&o){const t=e.RV6();e.j41(0,"tr")(1,"th")(2,"p-checkbox",15),e.bIt("onChange",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.toggleSelection())}),e.k0s()(),e.j41(3,"th"),e.EFF(4,"\u0421\u043a\u043b\u0430\u0434 \u043e\u0442\u0433\u0440\u0443\u0437\u043a\u0438"),e.k0s(),e.j41(5,"th"),e.EFF(6,"\u0421\u043a\u043b\u0430\u0434 \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f"),e.k0s(),e.j41(7,"th"),e.EFF(8,"\u0420\u0435\u0437\u0435\u0440\u0432, \u0447"),e.k0s(),e.j41(9,"th"),e.EFF(10,"\u041e\u043a\u043d\u043e"),e.k0s(),e.j41(11,"th"),e.EFF(12,"\u0421\u0442\u0430\u0442\u0443\u0441"),e.k0s(),e.j41(13,"th"),e.EFF(14,"\u0417\u0430\u043f\u0443\u0441\u043a\u043e\u0432"),e.k0s(),e.nrm(15,"th"),e.k0s()}}function Pi(o,c){if(1&o&&(e.j41(0,"div"),e.EFF(1),e.k0s()),2&o){const t=c.$implicit;e.R7$(),e.JRh(t.dropOffWarehouseName)}}function Mi(o,c){if(1&o&&(e.qex(0),e.EFF(1),e.nI1(2,"date"),e.bVm()),2&o){const t=e.XpG(2).$implicit;e.R7$(),e.SpI(" ",e.i5U(2,1,t.minDate,"y-MM-dd")," ")}}function zi(o,c){1&o&&(e.qex(0),e.EFF(1,"-"),e.bVm())}function Bi(o,c){if(1&o&&(e.qex(0),e.EFF(1),e.nI1(2,"date"),e.bVm()),2&o){const t=e.XpG(2).$implicit;e.R7$(),e.SpI(" ",e.i5U(2,1,t.maxDate,"y-MM-dd")," ")}}function Gi(o,c){1&o&&(e.qex(0),e.EFF(1,"-"),e.bVm())}function Li(o,c){if(1&o&&(e.qex(0),e.DNE(1,Mi,3,4,"ng-container",18)(2,zi,2,0,"ng-container",18),e.EFF(3," \u2013 "),e.DNE(4,Bi,3,4,"ng-container",18)(5,Gi,2,0,"ng-container",18),e.bVm()),2&o){const t=e.XpG().$implicit;e.R7$(),e.Y8G("ngIf",t.minDate),e.R7$(),e.Y8G("ngIf",!t.minDate),e.R7$(2),e.Y8G("ngIf",t.maxDate),e.R7$(),e.Y8G("ngIf",!t.maxDate)}}function Ai(o,c){1&o&&(e.qex(0),e.EFF(1,"-"),e.bVm())}function $i(o,c){if(1&o){const t=e.RV6();e.j41(0,"button",22),e.bIt("click",function(){e.eBV(t);const n=e.XpG().$implicit,s=e.XpG();return e.Njj(s.editTask(n))}),e.k0s()}}function Ni(o,c){if(1&o){const t=e.RV6();e.j41(0,"tr")(1,"td")(2,"p-checkbox",16),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.selectedTasks,n)||(s.selectedTasks=n),e.Njj(n)}),e.k0s()(),e.j41(3,"td"),e.DNE(4,Pi,2,1,"div",17),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.EFF(8),e.k0s(),e.j41(9,"td"),e.DNE(10,Li,6,4,"ng-container",18)(11,Ai,2,0,"ng-container",18),e.k0s(),e.j41(12,"td"),e.nrm(13,"p-button",19),e.k0s(),e.j41(14,"td"),e.EFF(15),e.k0s(),e.j41(16,"td"),e.DNE(17,$i,1,0,"button",20),e.nrm(18,"button",21),e.k0s()()}if(2&o){const t=c.expanded,r=c.$implicit,n=e.XpG();e.R7$(2),e.R50("ngModel",n.selectedTasks),e.Y8G("value",r.iD),e.R7$(2),e.Y8G("ngForOf",r.items),e.R7$(2),e.JRh(r.targetWarehouseName),e.R7$(2),e.JRh(null==r.timeReserveInHours?"-":r.timeReserveInHours),e.R7$(2),e.Y8G("ngIf",r.minDate||r.maxDate),e.R7$(),e.Y8G("ngIf",!r.minDate&&!r.maxDate),e.R7$(2),e.Y8G("text",!0)("severity",r.status.severity)("icon",r.status.icon)("title",r.status.text),e.R7$(2),e.JRh(r.runCount),e.R7$(2),e.Y8G("ngIf",!r.finished),e.R7$(),e.Y8G("icon",t?"pi pi-chevron-down":"pi pi-chevron-right")("pRowToggler",r)}}function Xi(o,c){1&o&&(e.j41(0,"tr")(1,"th"),e.EFF(2,"\u0410\u0440\u0442\u0438\u043a\u0443\u043b"),e.k0s(),e.j41(3,"th"),e.EFF(4,"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435"),e.k0s(),e.j41(5,"th"),e.EFF(6,"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e"),e.k0s()())}function Vi(o,c){1&o&&(e.qex(0),e.j41(1,"td",25),e.nrm(2,"p-skeleton",26),e.k0s(),e.bVm())}function Yi(o,c){if(1&o&&(e.qex(0),e.j41(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.bVm()),2&o){const t=c.ngIf,r=e.XpG().$implicit;e.R7$(2),e.JRh(t.productPackageID),e.R7$(2),e.JRh(t.name),e.R7$(2),e.JRh(r.quantity)}}function Hi(o,c){if(1&o&&(e.j41(0,"tr"),e.DNE(1,Vi,3,0,"ng-container",18)(2,Yi,7,3,"ng-container",18),e.k0s()),2&o){const t=c.$implicit,r=e.XpG(2);e.R7$(),e.Y8G("ngIf",!(null!=r.products&&r.products.has(t.iD))),e.R7$(),e.Y8G("ngIf",null==r.products?null:r.products.get(t.iD))}}function Wi(o,c){if(1&o&&(e.j41(0,"tr")(1,"td",23)(2,"p-table",24),e.DNE(3,Xi,7,0,"ng-template",4)(4,Hi,3,2,"ng-template",5),e.k0s()()()),2&o){const t=c.$implicit;e.R7$(2),e.Y8G("value",t.products)}}function Ui(o,c){1&o&&(e.j41(0,"div",53),e.EFF(1,"(\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0441\u043a\u043b\u0430\u0434\u044b \u043e\u0442\u0433\u0440\u0443\u0437\u043a\u0438)"),e.k0s())}function Ji(o,c){if(1&o&&(e.j41(0,"div",54),e.EFF(1),e.k0s()),2&o){const t=c.$implicit;e.R7$(),e.JRh(t.name)}}function qi(o,c){if(1&o&&e.DNE(0,Ui,2,0,"div",51)(1,Ji,2,1,"div",52),2&o){const t=c.$implicit;e.Y8G("ngIf",!(null!=t&&t.length)),e.R7$(),e.Y8G("ngForOf",t)}}function Qi(o,c){if(1&o&&(e.j41(0,"div",55)(1,"div"),e.EFF(2),e.k0s()()),2&o){const t=c.$implicit;e.R7$(2),e.Lme("",t.productPackageID,": ",t.name,"")}}function Ki(o,c){1&o&&e.EFF(0,"\u0410\u0440\u0442\u0438\u043a\u0443\u043b \u0442\u043e\u0432\u0430\u0440\u0430")}function Zi(o,c){if(1&o){const t=e.RV6();e.j41(0,"p-inputNumber",56),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG(2);return e.DH7(s.newItemProduct.quantity,n)||(s.newItemProduct.quantity=n),e.Njj(n)}),e.k0s()}if(2&o){const t=e.XpG(2);e.R50("ngModel",t.newItemProduct.quantity)}}function er(o,c){1&o&&(e.j41(0,"div",57),e.EFF(1,"\u0422\u043e\u0432\u0430\u0440\u044b"),e.k0s())}function tr(o,c){1&o&&(e.j41(0,"tr")(1,"th"),e.EFF(2,"\u0410\u0440\u0442\u0438\u043a\u0443\u043b"),e.k0s(),e.j41(3,"th"),e.EFF(4,"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435"),e.k0s(),e.j41(5,"th"),e.EFF(6,"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e"),e.k0s(),e.nrm(7,"th"),e.k0s())}function nr(o,c){if(1&o){const t=e.RV6();e.j41(0,"p-inputNumber",62),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG().$implicit;return e.DH7(s.quantity,n)||(s.quantity=n),e.Njj(n)}),e.k0s()}if(2&o){const t=e.XpG().$implicit;e.R50("ngModel",t.quantity),e.Y8G("useGrouping",!1)}}function or(o,c){if(1&o&&e.EFF(0),2&o){const t=e.XpG().$implicit;e.SpI(" ",t.quantity," ")}}function ir(o,c){if(1&o){const t=e.RV6();e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td",58)(6,"p-cellEditor"),e.DNE(7,nr,1,2,"ng-template",59)(8,or,1,1,"ng-template",60),e.k0s()(),e.j41(9,"td")(10,"button",61),e.bIt("click",function(){const n=e.eBV(t).$implicit,s=e.XpG(3);return e.Njj(s.removeNewItemProduct(n))}),e.k0s()()()}if(2&o){const t=c.$implicit;e.R7$(2),e.JRh(t.iD),e.R7$(2),e.JRh(t.name),e.R7$(),e.Y8G("pEditableColumn",t.count)}}function rr(o,c){if(1&o&&(e.j41(0,"p-table",24),e.DNE(1,er,2,0,"ng-template",3)(2,tr,8,0,"ng-template",4)(3,ir,11,3,"ng-template",5),e.k0s()),2&o){const t=e.XpG(2);e.Y8G("value",t.newItem.products)}}function ur(o,c){if(1&o){const t=e.RV6();e.j41(0,"p-dialog",27),e.mxI("visibleChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.showEditDialog,n)||(s.showEditDialog=n),e.Njj(n)}),e.j41(1,"div",28)(2,"div",29)(3,"label",30),e.EFF(4,"\u0421\u043a\u043b\u0430\u0434\u044b \u043e\u0442\u0433\u0440\u0443\u0437\u043a\u0438"),e.k0s(),e.j41(5,"p-multiSelect",31),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.newItem.dropOffWarehouses,n)||(s.newItem.dropOffWarehouses=n),e.Njj(n)}),e.DNE(6,qi,2,2,"ng-template",32),e.k0s()(),e.j41(7,"div",29)(8,"label",33),e.EFF(9,"\u0421\u043a\u043b\u0430\u0434 \u043f\u043e\u0441\u0442\u0430\u0432\u043a\u0438"),e.k0s(),e.j41(10,"p-dropdown",34),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.newItem.targetWarehouseID,n)||(s.newItem.targetWarehouseID=n),e.Njj(n)}),e.k0s()(),e.j41(11,"div",29)(12,"label",35),e.EFF(13,"\u0410\u043a\u0442\u0438\u0432\u043d\u0430"),e.k0s(),e.j41(14,"p-checkbox",36),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.newItem.enabled,n)||(s.newItem.enabled=n),e.Njj(n)}),e.k0s()(),e.j41(15,"div",29)(16,"label",37),e.EFF(17,"\u0420\u0435\u0437\u0435\u0440\u0432 \u0432\u0440\u0435\u043c\u0435\u043d\u0438, \u0447"),e.k0s(),e.j41(18,"p-inputNumber",38),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.newItem.timeReserveInHours,n)||(s.newItem.timeReserveInHours=n),e.Njj(n)}),e.k0s()(),e.j41(19,"div",29)(20,"label",39),e.EFF(21,"\u041c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u0430\u044f \u0434\u0430\u0442\u0430"),e.k0s(),e.j41(22,"p-calendar",40),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.newItem.minDate,n)||(s.newItem.minDate=n),e.Njj(n)}),e.k0s()(),e.j41(23,"div",29)(24,"label",41),e.EFF(25,"\u041c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u0430\u044f \u0434\u0430\u0442\u0430"),e.k0s(),e.j41(26,"p-calendar",42),e.mxI("ngModelChange",function(n){e.eBV(t);const s=e.XpG();return e.DH7(s.newItem.maxDate,n)||(s.newItem.maxDate=n),e.Njj(n)}),e.k0s()(),e.j41(27,"div")(28,"label",43),e.EFF(29,"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0442\u043e\u0432\u0430\u0440"),e.k0s(),e.j41(30,"p-autoComplete",44,0),e.nI1(32,"async"),e.bIt("completeMethod",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.findProductsByName(n))})("onSelect",function(n){e.eBV(t);const s=e.XpG();return e.Njj(s.selectProduct(n))}),e.DNE(33,Qi,3,2,"ng-template",45)(34,Ki,1,0,"ng-template",46),e.k0s(),e.DNE(35,Zi,1,1,"p-inputNumber",47),e.j41(36,"div")(37,"button",48),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.addNewItemProduct())}),e.EFF(38,"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0442\u043e\u0432\u0430\u0440"),e.k0s()()(),e.j41(39,"div",49),e.DNE(40,rr,4,1,"p-table",50),e.k0s(),e.j41(41,"button",48),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.addSupplyRegistrationTask(n.newItem))}),e.EFF(42),e.k0s()()()}if(2&o){const t=e.XpG();e.Aen(e.lJ4(37,ji)),e.R50("visible",t.showEditDialog),e.Y8G("draggable",!0)("modal",!0)("resizable",!0),e.R7$(),e.Y8G("disabled",t.addingTask),e.R7$(4),e.R50("ngModel",t.newItem.dropOffWarehouses),e.Y8G("options",t.dropOffWarehouses),e.R7$(5),e.R50("ngModel",t.newItem.targetWarehouseID),e.Y8G("autoDisplayFirst",!1)("filter",!0)("options",t.targetWarehouses)("showClear",!0),e.R7$(4),e.R50("ngModel",t.newItem.enabled),e.Y8G("binary",!0),e.R7$(4),e.R50("ngModel",t.newItem.timeReserveInHours),e.Y8G("min",24)("required",!0)("showButtons",!0)("step",12)("useGrouping",!1),e.R7$(4),e.R50("ngModel",t.newItem.minDate),e.Y8G("readonlyInput",!0)("showClear",!0),e.R7$(4),e.R50("ngModel",t.newItem.maxDate),e.Y8G("readonlyInput",!0)("showClear",!0),e.R7$(4),e.Y8G("minLength",3)("suggestions",e.bMT(32,35,t.newItemProducts)),e.R7$(5),e.Y8G("ngIf",t.newItemProduct),e.R7$(2),e.Y8G("disabled",!t.isValidNewItemProduct),e.R7$(3),e.Y8G("ngIf",t.newItem.products.length),e.R7$(),e.Y8G("disabled",!t.isValidNewItem||t.addingTask),e.R7$(),e.SpI(" ",t.editItem?"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"," ")}}var V=function(o){return o[o.Unknown=0]="Unknown",o[o.Finished=1]="Finished",o[o.Disabled=2]="Disabled",o[o.InProcess=3]="InProcess",o[o.DraftCreated=4]="DraftCreated",o[o.CreatingSupply=5]="CreatingSupply",o[o.CreatingDraft=6]="CreatingDraft",o[o.RetryLimitExceeded=7]="RetryLimitExceeded",o}(V||{});let ar=(()=>{class o extends p.x{static{this.FilterID="OzonSupplyRegistrationTaskListComponent"}constructor(t,r,n,s,d,S,x){super(x),this.supplyOrderClient=t,this.supplyOrderCommandHandler=r,this.ozonProductClient=n,this.messageService=s,this.warehouseService=d,this.dbService=S,this.findModelSubject=new b.t(null),this.findProductPackageSubject=new b.t(null),this.newItemProducts=new b.t([]),this.tasksStatuses=new Map([[V.Unknown,{text:"\u041d\u0435 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043e",icon:"pi pi-question-circle",severity:"warning"}],[V.Finished,{text:"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0430",icon:"pi pi-check-circle",severity:"success"}],[V.Disabled,{text:"\u041e\u0442\u043a\u043b\u044e\u0447\u0435\u043d\u0430",icon:"pi pi-ban",severity:"danger"}],[V.RetryLimitExceeded,{text:"\u041c\u0430\u043a\u0441\u0438\u043c\u0443\u043c \u043f\u043e\u043f\u044b\u0442\u043e\u043a",icon:"pi pi-exclamation-circle",severity:"danger"}],[V.CreatingSupply,{text:"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043e\u0442\u0433\u0440\u0443\u0437\u043a\u0438",icon:"pi pi-plus-circle",severity:"info"}],[V.DraftCreated,{text:"\u0421\u043e\u0437\u0434\u0430\u043d \u0447\u0435\u0440\u043d\u043e\u0432\u0438\u043a",icon:"pi pi-file",severity:"info"}],[V.CreatingDraft,{text:"\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0447\u0435\u0440\u043d\u043e\u0432\u0438\u043a\u0430",icon:"pi pi-file-edit",severity:"info"}],[V.InProcess,{text:"\u0412 \u0440\u0430\u0431\u043e\u0442\u0435",icon:"pi pi-spinner",severity:"info"}]]),this.newItem=void 0,this.editItem=void 0,this.newItemProduct=void 0,this.productSearchSubject=new Si.B,this.showActiveTasksOnly=!0,this.includeDisabledTasks=!1,this.selectedTasks=[]}get isValidNewItem(){return this.newItem&&this.newItem.targetWarehouseID&&this.newItem.dropOffWarehouses.length>0&&this.newItem.products.length>0}get isValidNewItemProduct(){return this.newItemProduct&&!!this.newItemProduct.iD&&!!this.newItemProduct.quantity}ngOnInit(){this.titleService.setTitle("\u041f\u043e\u0441\u0442\u0430\u0432\u043a\u0438 Ozon"),this.productSearchSubject.pipe((0,O.Q)(this.destroyed)).pipe((0,re.n)(t=>this.ozonProductClient.findOzonProducts(new i.D.FindOzonProductsModel({count:100,offset:0,productName:t,includeStocks:!1})).pipe((0,g.W)(r=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u043e\u0438\u0441\u043a\u0430 \u0442\u043e\u0432\u0430\u0440\u043e\u0432",severity:"error",detail:r}),y.w))))).subscribe(t=>{const r=new Set(this.newItem.products.map(s=>s.iD)),n=t.items.filter(s=>!r.has(s.productPackageID));this.newItemProducts.next(n)}),this.warehouseService.getWarehouses(!1,!1).pipe((0,g.W)(t=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0441\u043a\u043b\u0430\u0434\u043e\u0432",severity:"error",detail:t}),y.w))).subscribe(t=>{this.dropOffWarehouses=t.filter(r=>r.type===i.D.OzonWarehouseType.CrossDock||r.type===i.D.OzonWarehouseType.DistributionCenter||r.type===i.D.OzonWarehouseType.SortingCenter).sort((r,n)=>r.name.localeCompare(n.name)),this.targetWarehouses=t.filter(r=>r.type===i.D.OzonWarehouseType.Fulfillment).sort((r,n)=>r.name.localeCompare(n.name))}),this.findProductPackageSubject.pipe((0,k.p)(t=>!!t&&t.productName?.length>=3)).pipe((0,O.Q)(this.destroyed)).pipe((0,Ri.M)(()=>{this.loadingProducts=!0})),this.findModelSubject.pipe((0,k.p)(t=>!!t)).pipe((0,O.Q)(this.destroyed)).pipe((0,re.n)(t=>{console.log(t),t.includeFinished=!this.showActiveTasksOnly||void 0,t.includeOutdated=!this.showActiveTasksOnly||void 0,t.includeDisabled=this.includeDisabledTasks;const r=Object.assign({},t),n={id:o.FilterID,data:r};return this.loading=!0,this.dbService.update("filters",n).pipe((0,g.W)(s=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043a",severity:"error",detail:s}),y.w))).subscribe(),this.supplyOrderClient.findOzonSupplyRegistrationTasks(t)})).pipe((0,g.W)(t=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0434\u0430\u043d\u043d\u044b\u0445",severity:"error",detail:t}),this.loading=!1,y.w))).subscribe(t=>{this.loading=!1;const r=new Set;t.items.forEach(n=>{const s=n;n.products.forEach(d=>r.add(d.iD)),s.status=this.getTaskStatusData(n)}),this.data=t,this.selectedTasks=[],r.size?this.ozonProductClient.findOzonProducts(new i.D.FindOzonProductsModel({iDs:[...r],offset:0,count:void 0,includeStocks:!1})).subscribe(n=>{this.products=n.items.reduce((s,d)=>(s.set(d.productPackageID,d),s),new Map)}):this.products=new Map}),this.dbService.getByID("filters",o.FilterID).subscribe(t=>{const r={count:t?.data.count||50,offset:0};t?.data&&Object.assign(r,t.data),this.filterModel=new i.D.FindOzonSupplyRegistrationTasksModel(r),this.findModelSubject.next(this.filterModel)})}pageChange(t){(this.filterModel.count!=t.rows||this.filterModel.offset!=t.first)&&(this.filterModel.offset=t.first,this.filterModel.count=t.rows,this.findModelSubject.next(this.filterModel))}removeNewItemProduct(t){const r=this.newItem.products.indexOf(t);r>=0&&this.newItem.products.splice(r,1)}addSupplyRegistrationTask(t){this.addingTask=!0;const r={dropOffWarehouseIDs:t.dropOffWarehouses,enabled:t.enabled,iD:this.editItem?this.editItem.iD:void 0,maxDate:t.maxDate,minDate:t.minDate,products:t.products.reduce((n,s)=>(n[s.iD.toString()]=s.quantity,n),{}),targetWarehouseID:t.targetWarehouseID,timeReserveInHours:t.timeReserveInHours??void 0};this.supplyOrderCommandHandler.addOzonSupplyRegistrationTask(new a.X.UpdateOzonSupplyRegistrationTask(r)).pipe((0,g.W)(n=>(this.messageService.add({summary:this.editItem?"\u041e\u0448\u0438\u0431\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u0447\u0438":"\u041e\u0448\u0438\u0431\u043a\u0430 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0437\u0430\u0434\u0430\u0447\u0438",severity:"error",detail:n}),this.addingTask=!1,y.w))).subscribe(n=>{this.messageService.add({summary:this.editItem?"\u0417\u0430\u0434\u0430\u0447\u0430 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0430":"\u0417\u0430\u0434\u0430\u0447\u0430 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0430",severity:"success"});const s={enabled:this.newItem.enabled,minDate:this.newItem.minDate,maxDate:this.newItem.maxDate,finished:!!this.editItem?.finished,targetWarehouseID:this.newItem.targetWarehouseID,iD:n,timeReserveInHours:this.newItem.timeReserveInHours,runCount:this.editItem?.runCount||0,targetWarehouseName:this.targetWarehouses.find(d=>d.iD==this.newItem.targetWarehouseID).name,items:this.newItem.dropOffWarehouses.map(d=>this.dropOffWarehouses.find(S=>S.iD==d)).map(d=>new i.D.OzonSupplyRegistrationTaskItem({dropOffWarehouseName:d.name,taskID:void 0,draftID:0,dropOffWarehouseID:d.iD,hasCreateDraftOperationID:!1,hasCreateSupplyOperationID:!1})),products:this.newItem.products.map(d=>new i.D.OzonSupplyRegistrationTaskProduct(d))};s.status=this.getTaskStatusData(s),this.editItem?Object.assign(this.editItem,s):this.data.items.unshift(new i.D.OzonSupplyRegistrationTask(s)),this.newItem=void 0,this.editItem=void 0,this.addingTask=!1})}editTask(t){this.editItem=t,this.newItem={enabled:t.enabled,dropOffWarehouses:t.items.map(r=>r.dropOffWarehouseID),timeReserveInHours:t.timeReserveInHours,maxDate:t.maxDate,minDate:t.minDate,targetWarehouseID:t.targetWarehouseID,products:t.products},this.showEditDialog=!0}selectProduct(t){const r=t.value;r?this.newItemProduct={iD:r.productPackageID,name:r.name,quantity:1}:(this.newItemProduct.quantity=void 0,this.newItemProduct.iD=void 0)}openAddNewItemDialog(){this.newItem={dropOffWarehouses:[],enabled:!0,maxDate:void 0,minDate:void 0,products:[],targetWarehouseID:void 0,timeReserveInHours:0},this.showEditDialog=!0}findProductsByName(t){t.query.trim().length>2&&this.productSearchSubject.next(t.query)}addNewItemProduct(){this.isValidNewItemProduct&&(this.newItem.products.push(this.newItemProduct),this.productAutocomplete.clear(),this.newItemProduct={id:void 0,name:void 0,quantity:void 0})}getTaskStatusData(t){let r=V.InProcess;if(t.finished)r=V.Finished;else if(t.enabled){for(const s of t.items)if(r=s.hasCreateSupplyOperationID?V.CreatingSupply:s.draftID?V.DraftCreated:s.hasCreateDraftOperationID?V.CreatingDraft:V.InProcess,r!=V.InProcess)break}else r=V.Disabled;return this.tasksStatuses.get(r)}onFilterChanged(){this.findModelSubject.next(this.filterModel)}toggleSelection(){this.selectedTasks=this.selectedTasks.length==this.data.items.length?[]:this.data.items.map(t=>t.iD)}changeTaskStatus(t){this.supplyOrderCommandHandler.changeOzonSupplyRegistrationTasksState(new a.X.ChangeOzonSupplyRegistrationTasksStateModel({taskIDs:this.selectedTasks,enabled:t})).pipe((0,g.W)(r=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0441\u0442\u0430\u0442\u0443\u0441\u043e\u0432 \u0437\u0430\u0434\u0430\u0447",severity:"error",detail:r}),y.w))).subscribe(()=>{this.messageService.add({summary:this.editItem?"\u0417\u0430\u0434\u0430\u0447\u0430 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0430":"\u0417\u0430\u0434\u0430\u0447\u0430 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0430",severity:"success"}),this.findModelSubject.next(this.filterModel)})}static{this.\u0275fac=function(r){return new(r||o)(e.rXU(i.D.OzonSupplyOrderClient),e.rXU(a.X.OzonSupplyOrderClient),e.rXU(i.D.OzonProductClient),e.rXU(l.bg),e.rXU(ue.t),e.rXU(m.MX),e.rXU(h.hE))}}static{this.\u0275cmp=e.VBU({type:o,selectors:[["app-ozon-supply-registration-task-list"]],viewQuery:function(r,n){if(1&r&&e.GBs(Ii,5),2&r){let s;e.mGM(s=e.lsd())&&(n.productAutocomplete=s.first)}},features:[e.Vt3],decls:9,vars:11,consts:[["productAutocomplete",""],["pButton","",3,"click"],["dataKey","iD","editMode","cell",3,"onPage","lazy","loading","paginator","rowsPerPageOptions","rows","tableStyle","totalRecords","value"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["header","\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447\u0438 \u043d\u0430 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044e \u043f\u043e\u0441\u0442\u0430\u0432\u043a\u0438",3,"visible","draggable","modal","resizable","style","visibleChange",4,"ngIf"],[1,"card","flex","justify-center","gap-4"],[1,"flex","items-center"],["inputId","showActiveTasksOnly",3,"ngModelChange","onChange","ngModel","binary"],["for","showActiveTasksOnly",1,"ml-2"],["inputId","includeDisabledTasks",3,"ngModelChange","onChange","ngModel","binary"],["for","includeDisabledTasks",1,"ml-2"],[3,"click","disabled"],[3,"onChange"],[3,"ngModelChange","ngModel","value"],[4,"ngFor","ngForOf"],[4,"ngIf"],[3,"text","severity","icon","title"],["class","p-button-text p-button-rounded p-button-plain","icon","pi pi-pencil","pButton","",3,"click",4,"ngIf"],["pButton","","pRipple","","type","button",1,"p-button-text","p-button-rounded","p-button-plain",3,"icon","pRowToggler"],["icon","pi pi-pencil","pButton","",1,"p-button-text","p-button-rounded","p-button-plain",3,"click"],["colspan","7"],[3,"value"],["colspan","3"],["height","3rem"],["header","\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0437\u0430\u0434\u0430\u0447\u0438 \u043d\u0430 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044e \u043f\u043e\u0441\u0442\u0430\u0432\u043a\u0438",3,"visibleChange","visible","draggable","modal","resizable"],[1,"card",3,"disabled"],[1,"flex-auto","mb-3"],["for","dropOffWarehouse",1,"mb-2","block","font-bold"],["appendTo","body","inputId","dropOffWarehouse","optionLabel","name","optionValue","iD",3,"ngModelChange","ngModel","options"],["pTemplate","selectedItems"],["for","targetWarehouse",1,"mb-2","block","font-bold"],["appendTo","body","filterBy","name","inputId","targetWarehouse","optionLabel","name","optionValue","iD","placeholder","\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0441\u043a\u043b\u0430\u0434 \u043f\u043e\u0441\u0442\u0430\u0432\u043a\u0438",3,"ngModelChange","ngModel","autoDisplayFirst","filter","options","showClear"],["for","enabled",1,"mb-2","block","font-bold"],["inputId","enabled",3,"ngModelChange","ngModel","binary"],["for","timeReserveInHours",1,"mb-2","block","font-bold"],["inputId","timeReserveInHours",3,"ngModelChange","ngModel","min","required","showButtons","step","useGrouping"],["for","minDate",1,"mb-2","block","font-bold"],["appendTo","body","dateFormat","dd.mm.yy","inputId","minDate",3,"ngModelChange","ngModel","readonlyInput","showClear"],["for","maxDate",1,"mb-2","block","font-bold"],["appendTo","body","dateFormat","dd.mm.yy","inputId","maxDate",3,"ngModelChange","ngModel","readonlyInput","showClear"],["for","newProduct",1,"mb-2","block","font-bold"],["field","name","inputId","newProduct","placeholder","\u041f\u043e\u0438\u0441\u043a \u0442\u043e\u0432\u0430\u0440\u0430","styleClass","mb-3",3,"completeMethod","onSelect","minLength","suggestions"],["pTemplate","item"],["pTemplate","selectedItem"],["inputId","newItemProductQuantity",3,"ngModel","ngModelChange",4,"ngIf"],["pButton","",3,"click","disabled"],[1,"m-3"],[3,"value",4,"ngIf"],["class","text-500 m-2",4,"ngIf"],["class","m-2",4,"ngFor","ngForOf"],[1,"text-500","m-2"],[1,"m-2"],[1,"flex","align-items-center","gap-2"],["inputId","newItemProductQuantity",3,"ngModelChange","ngModel"],[1,"flex","align-items-center","justify-content-between"],["pEditableColumnField","count",3,"pEditableColumn"],["pTemplate","input"],["pTemplate","output"],["pButton","",1,"pi","pi-trash",3,"click"],[3,"ngModelChange","ngModel","useGrouping"]],template:function(r,n){1&r&&(e.nrm(0,"p-toast"),e.j41(1,"button",1),e.bIt("click",function(){return n.openAddNewItemDialog()}),e.EFF(2,"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"),e.k0s(),e.j41(3,"p-table",2),e.bIt("onPage",function(d){return n.pageChange(d)}),e.DNE(4,wi,14,6,"ng-template",3)(5,xi,16,0,"ng-template",4)(6,Ni,19,15,"ng-template",5)(7,Wi,5,1,"ng-template",6),e.k0s(),e.DNE(8,ur,43,38,"p-dialog",7)),2&r&&(e.R7$(3),e.Y8G("lazy",!0)("loading",n.loading)("paginator",!0)("rowsPerPageOptions",e.lJ4(9,Ti))("rows",null==n.filterModel?null:n.filterModel.count)("tableStyle",e.lJ4(10,Di))("totalRecords",null==n.data?null:n.data.totalCount)("value",null==n.data?null:n.data.items),e.R7$(5),e.Y8G("ngIf",n.newItem))},dependencies:[l.Ei,ke.j9,F._f,F.$n,I.Vv,te.Sc,v.Sq,v.bT,oe.l,Fe.ms,P.BC,P.YS,P.vS,ie.YI,X.KF,M.XI,M.FP,M.hp,M.c5,z.y8,A.E,v.Jj,v.vh]})}}return o})();var sr=f(6398);let lr=(()=>{class o{static{this.\u0275fac=function(r){return new(r||o)}}static{this.\u0275mod=e.$C({type:o})}static{this.\u0275inj=e.G2t({imports:[E.iI.forChild([{path:"warehouse/list",component:Ao},{path:"returns",component:sr.O},{path:"salesOrders",component:Et},{path:"action",component:Fi},{path:"product",component:un},{path:"transaction",component:xn},{path:"supplyOrder",component:Cn},{path:"supplyRegistrationTask",component:ar},{path:"reconciliation",component:eo},{path:"stock-starvation-report",component:oi}]),E.iI]})}}return o})(),cr=(()=>{class o{static{this.\u0275fac=function(r){return new(r||o)}}static{this.\u0275mod=e.$C({type:o})}static{this.\u0275inj=e.G2t({})}}return o})(),pr=(()=>{class o{static \u0275fac=function(r){return new(r||o)};static \u0275mod=e.$C({type:o});static \u0275inj=e.G2t({imports:[v.MD]})}return o})();var dr=f(9615),_r=f(9820);let fr=(()=>{class o{static{this.\u0275fac=function(r){return new(r||o)}}static{this.\u0275mod=e.$C({type:o})}static{this.\u0275inj=e.G2t({providers:[i.D.WarehouseClient,i.D.ReportClient,i.D.OzonSalesOrderClient,i.D.OperationClient,i.D.OzonProductClient,i.D.OzonSupplyOrderClient,a.X.PostingClient,a.X.OperationClient,a.X.OzonProductClient,a.X.OzonSupplyOrderClient,a.X.WarehouseClient,a.X.OzonPromotionClient,i.D.ProductClient,i.D.OzonPromotionClient,ue.t,l.bg,l.td],imports:[de.h6,ke.$$,F.tm,I.rO,T.D,_r.F,te.q4,ko,cr,v.MD,ve.F,oe.P,Fe.kr,dr.e,P.YN,ie.O3,pr,ne.u,X.iV,lr,J.F,Q.xs,M.bG,K.$,z.MB,A.k,be.AG,we,ce.S]})}}return o})()},1874:(w,_,f)=>{var E=I(f(3209)),b=I(f(3931)),k=I(f(9246)),y=I(f(8084)),i=I(f(2042)),e=I(f(1951)),l=I(f(650)),m=f(1498),F=I(f(5482));function I(z){return z&&z.__esModule?z:{default:z}}var T=function(){},P=function(A,N,L){var $=new T;if(typeof A>"u")throw Error("No element to render on was provided.");return $._renderProperties=(0,i.default)(A),$._encodings=[],$._options=F.default,$._errorHandler=new l.default($),typeof N<"u"&&((L=L||{}).format||(L.format=M()),$.options(L)[L.format](N,L).render()),$};for(var X in P.getModule=function(z){return E.default[z]},E.default)E.default.hasOwnProperty(X)&&J(E.default,X);function J(z,A){T.prototype[A]=T.prototype[A.toUpperCase()]=T.prototype[A.toLowerCase()]=function(N,L){var $=this;return $._errorHandler.wrapBarcodeCall(function(){L.text=typeof L.text>"u"?void 0:""+L.text;var W=(0,b.default)($._options,L);W=(0,e.default)(W);var le=Q(N,z[A],W);return $._encodings.push(le),$})}}function Q(z,A,N){var L=new A(z=""+z,N);if(!L.valid())throw new m.InvalidInputException(L.constructor.name,z);var $=L.encode();$=(0,k.default)($);for(var W=0;W<$.length;W++)$[W].options=(0,b.default)(N,$[W].options);return $}function M(){return E.default.CODE128?"CODE128":Object.keys(E.default)[0]}function K(z,A,N){A=(0,k.default)(A);for(var L=0;L<A.length;L++)A[L].options=(0,b.default)(N,A[L].options),(0,y.default)(A[L].options);(0,y.default)(N),new(0,z.renderer)(z.element,A,N).render(),z.afterRender&&z.afterRender()}T.prototype.options=function(z){return this._options=(0,b.default)(this._options,z),this},T.prototype.blank=function(z){var A=new Array(z+1).join("0");return this._encodings.push({data:A}),this},T.prototype.init=function(){var z;if(this._renderProperties)for(var A in Array.isArray(this._renderProperties)||(this._renderProperties=[this._renderProperties]),this._renderProperties){var N=(0,b.default)(this._options,(z=this._renderProperties[A]).options);"auto"==N.format&&(N.format=M()),this._errorHandler.wrapBarcodeCall(function(){var W=Q(N.value,E.default[N.format.toUpperCase()],N);K(z,W,N)})}},T.prototype.render=function(){if(!this._renderProperties)throw new m.NoElementException;if(Array.isArray(this._renderProperties))for(var z=0;z<this._renderProperties.length;z++)K(this._renderProperties[z],this._encodings,this._options);else K(this._renderProperties,this._encodings,this._options);return this},T.prototype._defaults=F.default,typeof window<"u"&&(window.JsBarcode=P),typeof jQuery<"u"&&(jQuery.fn.JsBarcode=function(z,A){var N=[];return jQuery(this).each(function(){N.push(this)}),P(N,z,A)}),w.exports=P},2933:(w,_)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.default=function E(C,b){(function f(E,C){if(!(E instanceof C))throw new TypeError("Cannot call a class as a function")})(this,E),this.data=C,this.text=b.text||C,this.options=b}},3166:(w,_,f)=>{Object.defineProperty(_,"__esModule",{value:!0});var v=function(){function i(u,e){for(var a=0;a<e.length;a++){var l=e[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(u,l.key,l)}}return function(u,e,a){return e&&i(u.prototype,e),a&&i(u,a),u}}(),C=function O(i){return i&&i.__esModule?i:{default:i}}(f(2933)),b=f(9973),p=function(i){function u(e,a){!function k(i,u){if(!(i instanceof u))throw new TypeError("Cannot call a class as a function")}(this,u);var l=function g(i,u){if(!i)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!u||"object"!=typeof u&&"function"!=typeof u?i:u}(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,e.substring(1),a));return l.bytes=e.split("").map(function(m){return m.charCodeAt(0)}),l}return function y(i,u){if("function"!=typeof u&&null!==u)throw new TypeError("Super expression must either be null or a function, not "+typeof u);i.prototype=Object.create(u&&u.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),u&&(Object.setPrototypeOf?Object.setPrototypeOf(i,u):i.__proto__=u)}(u,i),v(u,[{key:"valid",value:function(){return/^[\x00-\x7F\xC8-\xD3]+$/.test(this.data)}},{key:"encode",value:function(){var a=this.bytes,l=a.shift()-105,m=b.SET_BY_CODE[l];if(void 0===m)throw new RangeError("The encoding does not start with a start character.");!0===this.shouldEncodeAsEan128()&&a.unshift(b.FNC1);var h=u.next(a,1,m);return{text:this.text===this.data?this.text.replace(/[^\x20-\x7E]/g,""):this.text,data:u.getBar(l)+h.result+u.getBar((h.checksum+l)%b.MODULO)+u.getBar(b.STOP)}}},{key:"shouldEncodeAsEan128",value:function(){var a=this.options.ean128||!1;return"string"==typeof a&&(a="true"===a.toLowerCase()),a}}],[{key:"getBar",value:function(a){return b.BARS[a]?b.BARS[a].toString():""}},{key:"correctIndex",value:function(a,l){if(l===b.SET_A){var m=a.shift();return m<32?m+64:m-32}return l===b.SET_B?a.shift()-32:10*(a.shift()-48)+a.shift()-48}},{key:"next",value:function(a,l,m){if(!a.length)return{result:"",checksum:0};var h=void 0,F=void 0;if(a[0]>=200){F=a.shift()-105;var I=b.SWAP[F];void 0!==I?h=u.next(a,l+1,I):((m===b.SET_A||m===b.SET_B)&&F===b.SHIFT&&(a[0]=m===b.SET_A?a[0]>95?a[0]-96:a[0]:a[0]<32?a[0]+96:a[0]),h=u.next(a,l+1,m))}else F=u.correctIndex(a,m),h=u.next(a,l+1,m);return{result:u.getBar(F)+h.result,checksum:F*l+h.checksum}}}]),u}(C.default);_.default=p},4675:(w,_,f)=>{Object.defineProperty(_,"__esModule",{value:!0});var v=function(){function i(u,e){for(var a=0;a<e.length;a++){var l=e[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(u,l.key,l)}}return function(u,e,a){return e&&i(u.prototype,e),a&&i(u,a),u}}(),C=function O(i){return i&&i.__esModule?i:{default:i}}(f(3166)),b=f(9973),p=function(i){function u(e,a){return function k(i,u){if(!(i instanceof u))throw new TypeError("Cannot call a class as a function")}(this,u),function g(i,u){if(!i)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!u||"object"!=typeof u&&"function"!=typeof u?i:u}(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,b.A_START_CHAR+e,a))}return function y(i,u){if("function"!=typeof u&&null!==u)throw new TypeError("Super expression must either be null or a function, not "+typeof u);i.prototype=Object.create(u&&u.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),u&&(Object.setPrototypeOf?Object.setPrototypeOf(i,u):i.__proto__=u)}(u,i),v(u,[{key:"valid",value:function(){return new RegExp("^"+b.A_CHARS+"+$").test(this.data)}}]),u}(C.default);_.default=p},4502:(w,_,f)=>{Object.defineProperty(_,"__esModule",{value:!0});var v=function(){function i(u,e){for(var a=0;a<e.length;a++){var l=e[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(u,l.key,l)}}return function(u,e,a){return e&&i(u.prototype,e),a&&i(u,a),u}}(),C=function O(i){return i&&i.__esModule?i:{default:i}}(f(3166)),b=f(9973),p=function(i){function u(e,a){return function k(i,u){if(!(i instanceof u))throw new TypeError("Cannot call a class as a function")}(this,u),function g(i,u){if(!i)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!u||"object"!=typeof u&&"function"!=typeof u?i:u}(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,b.B_START_CHAR+e,a))}return function y(i,u){if("function"!=typeof u&&null!==u)throw new TypeError("Super expression must either be null or a function, not "+typeof u);i.prototype=Object.create(u&&u.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),u&&(Object.setPrototypeOf?Object.setPrototypeOf(i,u):i.__proto__=u)}(u,i),v(u,[{key:"valid",value:function(){return new RegExp("^"+b.B_CHARS+"+$").test(this.data)}}]),u}(C.default);_.default=p},2693:(w,_,f)=>{Object.defineProperty(_,"__esModule",{value:!0});var v=function(){function i(u,e){for(var a=0;a<e.length;a++){var l=e[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(u,l.key,l)}}return function(u,e,a){return e&&i(u.prototype,e),a&&i(u,a),u}}(),C=function O(i){return i&&i.__esModule?i:{default:i}}(f(3166)),b=f(9973),p=function(i){function u(e,a){return function k(i,u){if(!(i instanceof u))throw new TypeError("Cannot call a class as a function")}(this,u),function g(i,u){if(!i)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!u||"object"!=typeof u&&"function"!=typeof u?i:u}(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,b.C_START_CHAR+e,a))}return function y(i,u){if("function"!=typeof u&&null!==u)throw new TypeError("Super expression must either be null or a function, not "+typeof u);i.prototype=Object.create(u&&u.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),u&&(Object.setPrototypeOf?Object.setPrototypeOf(i,u):i.__proto__=u)}(u,i),v(u,[{key:"valid",value:function(){return new RegExp("^"+b.C_CHARS+"+$").test(this.data)}}]),u}(C.default);_.default=p},714:(w,_,f)=>{Object.defineProperty(_,"__esModule",{value:!0});var E=O(f(3166)),b=O(f(5113));function O(i){return i&&i.__esModule?i:{default:i}}function g(i,u){if(!i)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!u||"object"!=typeof u&&"function"!=typeof u?i:u}var p=function(i){function u(e,a){if(function k(i,u){if(!(i instanceof u))throw new TypeError("Cannot call a class as a function")}(this,u),/^[\x00-\x7F\xC8-\xD3]+$/.test(e))var l=g(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,(0,b.default)(e),a));else l=g(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,e,a));return g(l)}return function y(i,u){if("function"!=typeof u&&null!==u)throw new TypeError("Super expression must either be null or a function, not "+typeof u);i.prototype=Object.create(u&&u.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),u&&(Object.setPrototypeOf?Object.setPrototypeOf(i,u):i.__proto__=u)}(u,i),u}(E.default);_.default=p},5113:(w,_,f)=>{Object.defineProperty(_,"__esModule",{value:!0});var v=f(9973),E=function(y){return y.match(new RegExp("^"+v.A_CHARS+"*"))[0].length},C=function(y){return y.match(new RegExp("^"+v.B_CHARS+"*"))[0].length},b=function(y){return y.match(new RegExp("^"+v.C_CHARS+"*"))[0]};function O(g,y){var p=y?v.A_CHARS:v.B_CHARS,i=g.match(new RegExp("^("+p+"+?)(([0-9]{2}){2,})([^0-9]|$)"));if(i)return i[1]+"\xcc"+k(g.substring(i[1].length));var u=g.match(new RegExp("^"+p+"+"))[0];return u.length===g.length?g:u+String.fromCharCode(y?205:206)+O(g.substring(u.length),!y)}function k(g){var y=b(g),p=y.length;if(p===g.length)return g;g=g.substring(p);var i=E(g)>=C(g);return y+String.fromCharCode(i?206:205)+O(g,i)}_.default=function(g){var y=void 0;if(b(g).length>=2)y=v.C_START_CHAR+k(g);else{var i=E(g)>C(g);y=(i?v.A_START_CHAR:v.B_START_CHAR)+O(g,i)}return y.replace(/[\xCD\xCE]([^])[\xCD\xCE]/,function(u,e){return"\xcb"+e})}},9973:(w,_)=>{var f;function v(X,J,Q){return J in X?Object.defineProperty(X,J,{value:Q,enumerable:!0,configurable:!0,writable:!0}):X[J]=Q,X}Object.defineProperty(_,"__esModule",{value:!0});var E=_.SET_A=0,C=_.SET_B=1,b=_.SET_C=2,k=(_.SHIFT=98,_.START_A=103),g=_.START_B=104,y=_.START_C=105;_.MODULO=103,_.STOP=106,_.FNC1=207,_.SET_BY_CODE=(v(f={},k,E),v(f,g,C),v(f,y,b),f),_.SWAP={101:E,100:C,99:b},_.A_START_CHAR="\xd0",_.B_START_CHAR="\xd1",_.C_START_CHAR="\xd2",_.A_CHARS="[\0-_\xc8-\xcf]",_.B_CHARS="[ -\x7f\xc8-\xcf]",_.C_CHARS="(\xcf*[0-9]{2}\xcf*)",_.BARS=[11011001100,11001101100,11001100110,10010011e3,10010001100,10001001100,10011001e3,10011000100,10001100100,11001001e3,11001000100,11000100100,10110011100,10011011100,10011001110,10111001100,10011101100,10011100110,11001110010,11001011100,11001001110,11011100100,11001110100,11101101110,11101001100,11100101100,11100100110,11101100100,11100110100,11100110010,11011011e3,11011000110,11000110110,10100011e3,10001011e3,10001000110,10110001e3,10001101e3,10001100010,11010001e3,11000101e3,11000100010,10110111e3,10110001110,10001101110,10111011e3,10111000110,10001110110,11101110110,11010001110,11000101110,11011101e3,11011100010,11011101110,11101011e3,11101000110,11100010110,11101101e3,11101100010,11100011010,11101111010,11001000010,11110001010,1010011e4,10100001100,1001011e4,10010000110,10000101100,10000100110,1011001e4,10110000100,1001101e4,10011000010,10000110100,10000110010,11000010010,1100101e4,11110111010,11000010100,10001111010,10100111100,10010111100,10010011110,10111100100,10011110100,10011110010,11110100100,11110010100,11110010010,11011011110,11011110110,11110110110,10101111e3,10100011110,10001011110,10111101e3,10111100010,11110101e3,11110100010,10111011110,10111101110,11101011110,11110101110,11010000100,1101001e4,11010011100,1100011101011]},9152:(w,_,f)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.CODE128C=_.CODE128B=_.CODE128A=_.CODE128=void 0;var E=p(f(714)),b=p(f(4675)),k=p(f(4502)),y=p(f(2693));function p(i){return i&&i.__esModule?i:{default:i}}_.CODE128=E.default,_.CODE128A=b.default,_.CODE128B=k.default,_.CODE128C=y.default},3803:(w,_,f)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.CODE39=void 0;var v=function(){function h(F,I){for(var T=0;T<I.length;T++){var P=I[T];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(F,P.key,P)}}return function(F,I,T){return I&&h(F.prototype,I),T&&h(F,T),F}}(),y=function(h){function F(I,T){return function O(h,F){if(!(h instanceof F))throw new TypeError("Cannot call a class as a function")}(this,F),I=I.toUpperCase(),T.mod43&&(I+=function a(h){return p[h]}(function m(h){for(var F=0,I=0;I<h.length;I++)F+=l(h[I]);return F%=43}(I))),function k(h,F){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!F||"object"!=typeof F&&"function"!=typeof F?h:F}(this,(F.__proto__||Object.getPrototypeOf(F)).call(this,I,T))}return function g(h,F){if("function"!=typeof F&&null!==F)throw new TypeError("Super expression must either be null or a function, not "+typeof F);h.prototype=Object.create(F&&F.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),F&&(Object.setPrototypeOf?Object.setPrototypeOf(h,F):h.__proto__=F)}(F,h),v(F,[{key:"encode",value:function(){for(var T=u("*"),P=0;P<this.data.length;P++)T+=u(this.data[P])+"0";return{data:T+=u("*"),text:this.text}}},{key:"valid",value:function(){return-1!==this.data.search(/^[0-9A-Z\-\.\ \$\/\+\%]+$/)}}]),F}(function b(h){return h&&h.__esModule?h:{default:h}}(f(2933)).default),p=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","-","."," ","$","/","+","%","*"],i=[20957,29783,23639,30485,20951,29813,23669,20855,29789,23645,29975,23831,30533,22295,30149,24005,21623,29981,23837,22301,30023,23879,30545,22343,30161,24017,21959,30065,23921,22385,29015,18263,29141,17879,29045,18293,17783,29021,18269,17477,17489,17681,20753,35770];function u(h){return function e(h){return i[h].toString(2)}(l(h))}function l(h){return p.indexOf(h)}_.CODE39=y},7331:(w,_,f)=>{Object.defineProperty(_,"__esModule",{value:!0});var v=function(){function e(a,l){for(var m=0;m<l.length;m++){var h=l[m];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(a,h.key,h)}}return function(a,l,m){return l&&e(a.prototype,l),m&&e(a,m),a}}(),E=f(2846),b=g(f(2143));function g(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function a(l,m){!function y(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}(this,a);var h=function p(e,a){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!=typeof a&&"function"!=typeof a?e:a}(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,l,m));return h.fontSize=!m.flat&&m.fontSize>10*m.width?10*m.width:m.fontSize,h.guardHeight=m.height+h.fontSize/2+m.textMargin,h}return function i(e,a){if("function"!=typeof a&&null!==a)throw new TypeError("Super expression must either be null or a function, not "+typeof a);e.prototype=Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(e,a):e.__proto__=a)}(a,e),v(a,[{key:"encode",value:function(){return this.options.flat?this.encodeFlat():this.encodeGuarded()}},{key:"leftText",value:function(m,h){return this.text.substr(m,h)}},{key:"leftEncode",value:function(m,h){return(0,b.default)(m,h)}},{key:"rightText",value:function(m,h){return this.text.substr(m,h)}},{key:"rightEncode",value:function(m,h){return(0,b.default)(m,h)}},{key:"encodeGuarded",value:function(){var m={fontSize:this.fontSize},h={height:this.guardHeight};return[{data:E.SIDE_BIN,options:h},{data:this.leftEncode(),text:this.leftText(),options:m},{data:E.MIDDLE_BIN,options:h},{data:this.rightEncode(),text:this.rightText(),options:m},{data:E.SIDE_BIN,options:h}]}},{key:"encodeFlat",value:function(){return{data:[E.SIDE_BIN,this.leftEncode(),E.MIDDLE_BIN,this.rightEncode(),E.SIDE_BIN].join(""),text:this.text}}}]),a}(g(f(2933)).default);_.default=u},7779:(w,_,f)=>{Object.defineProperty(_,"__esModule",{value:!0});var v=function(){function e(a,l){for(var m=0;m<l.length;m++){var h=l[m];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(a,h.key,h)}}return function(a,l,m){return l&&e(a.prototype,l),m&&e(a,m),a}}(),E=function e(a,l,m){null===a&&(a=Function.prototype);var h=Object.getOwnPropertyDescriptor(a,l);if(void 0===h){var F=Object.getPrototypeOf(a);return null===F?void 0:e(F,l,m)}if("value"in h)return h.value;var I=h.get;return void 0===I?void 0:I.call(m)},C=f(2846),O=function k(e){return e&&e.__esModule?e:{default:e}}(f(7331)),i=function(a){return(10-a.substr(0,12).split("").map(function(m){return+m}).reduce(function(m,h,F){return F%2?m+3*h:m+h},0)%10)%10},u=function(e){function a(l,m){(function g(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")})(this,a),-1!==l.search(/^[0-9]{12}$/)&&(l+=i(l));var h=function y(e,a){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!=typeof a&&"function"!=typeof a?e:a}(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,l,m));return h.lastChar=m.lastChar,h}return function p(e,a){if("function"!=typeof a&&null!==a)throw new TypeError("Super expression must either be null or a function, not "+typeof a);e.prototype=Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(e,a):e.__proto__=a)}(a,e),v(a,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{13}$/)&&+this.data[12]===i(this.data)}},{key:"leftText",value:function(){return E(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"leftText",this).call(this,1,6)}},{key:"leftEncode",value:function(){var m=this.data.substr(1,6),h=C.EAN13_STRUCTURE[this.data[0]];return E(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"leftEncode",this).call(this,m,h)}},{key:"rightText",value:function(){return E(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"rightText",this).call(this,7,6)}},{key:"rightEncode",value:function(){var m=this.data.substr(7,6);return E(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"rightEncode",this).call(this,m,"RRRRRR")}},{key:"encodeGuarded",value:function(){var m=E(a.prototype.__proto__||Object.getPrototypeOf(a.prototype),"encodeGuarded",this).call(this);return this.options.displayValue&&(m.unshift({data:"000000000000",text:this.text.substr(0,1),options:{textAlign:"left",fontSize:this.fontSize}}),this.options.lastChar&&(m.push({data:"00"}),m.push({data:"00000",text:this.options.lastChar,options:{fontSize:this.fontSize}}))),m}}]),a}(O.default);_.default=u},197:(w,_,f)=>{Object.defineProperty(_,"__esModule",{value:!0});var v=function(){function e(a,l){for(var m=0;m<l.length;m++){var h=l[m];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(a,h.key,h)}}return function(a,l,m){return l&&e(a.prototype,l),m&&e(a,m),a}}(),E=f(2846),b=g(f(2143));function g(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function a(l,m){return function y(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}(this,a),function p(e,a){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!=typeof a&&"function"!=typeof a?e:a}(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,l,m))}return function i(e,a){if("function"!=typeof a&&null!==a)throw new TypeError("Super expression must either be null or a function, not "+typeof a);e.prototype=Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(e,a):e.__proto__=a)}(a,e),v(a,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{2}$/)}},{key:"encode",value:function(){var m=E.EAN2_STRUCTURE[parseInt(this.data)%4];return{data:"1011"+(0,b.default)(this.data,m,"01"),text:this.text}}}]),a}(g(f(2933)).default);_.default=u},6400:(w,_,f)=>{Object.defineProperty(_,"__esModule",{value:!0});var v=function(){function a(l,m){for(var h=0;h<m.length;h++){var F=m[h];F.enumerable=F.enumerable||!1,F.configurable=!0,"value"in F&&(F.writable=!0),Object.defineProperty(l,F.key,F)}}return function(l,m,h){return m&&a(l.prototype,m),h&&a(l,h),l}}(),E=f(2846),b=g(f(2143));function g(a){return a&&a.__esModule?a:{default:a}}var e=function(a){function l(m,h){return function y(a,l){if(!(a instanceof l))throw new TypeError("Cannot call a class as a function")}(this,l),function p(a,l){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!l||"object"!=typeof l&&"function"!=typeof l?a:l}(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,m,h))}return function i(a,l){if("function"!=typeof l&&null!==l)throw new TypeError("Super expression must either be null or a function, not "+typeof l);a.prototype=Object.create(l&&l.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),l&&(Object.setPrototypeOf?Object.setPrototypeOf(a,l):a.__proto__=l)}(l,a),v(l,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{5}$/)}},{key:"encode",value:function(){var h=E.EAN5_STRUCTURE[function(l){return l.split("").map(function(h){return+h}).reduce(function(h,F,I){return I%2?h+9*F:h+3*F},0)%10}(this.data)];return{data:"1011"+(0,b.default)(this.data,h,"01"),text:this.text}}}]),l}(g(f(2933)).default);_.default=e},2587:(w,_,f)=>{Object.defineProperty(_,"__esModule",{value:!0});var v=function(){function u(e,a){for(var l=0;l<a.length;l++){var m=a[l];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(e,m.key,m)}}return function(e,a,l){return a&&u(e.prototype,a),l&&u(e,l),e}}(),E=function u(e,a,l){null===e&&(e=Function.prototype);var m=Object.getOwnPropertyDescriptor(e,a);if(void 0===m){var h=Object.getPrototypeOf(e);return null===h?void 0:u(h,a,l)}if("value"in m)return m.value;var F=m.get;return void 0===F?void 0:F.call(l)},b=function O(u){return u&&u.__esModule?u:{default:u}}(f(7331)),p=function(e){return(10-e.substr(0,7).split("").map(function(l){return+l}).reduce(function(l,m,h){return h%2?l+m:l+3*m},0)%10)%10},i=function(u){function e(a,l){return function k(u,e){if(!(u instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),-1!==a.search(/^[0-9]{7}$/)&&(a+=p(a)),function g(u,e){if(!u)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?u:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,a,l))}return function y(u,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);u.prototype=Object.create(e&&e.prototype,{constructor:{value:u,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(u,e):u.__proto__=e)}(e,u),v(e,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{8}$/)&&+this.data[7]===p(this.data)}},{key:"leftText",value:function(){return E(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"leftText",this).call(this,0,4)}},{key:"leftEncode",value:function(){var l=this.data.substr(0,4);return E(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"leftEncode",this).call(this,l,"LLLL")}},{key:"rightText",value:function(){return E(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"rightText",this).call(this,4,4)}},{key:"rightEncode",value:function(){var l=this.data.substr(4,4);return E(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"rightEncode",this).call(this,l,"RRRR")}}]),e}(b.default);_.default=i},1541:(w,_,f)=>{Object.defineProperty(_,"__esModule",{value:!0});var v=function(){function e(a,l){for(var m=0;m<l.length;m++){var h=l[m];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(a,h.key,h)}}return function(a,l,m){return l&&e(a.prototype,l),m&&e(a,m),a}}();_.checksum=u;var C=k(f(2143));function k(e){return e&&e.__esModule?e:{default:e}}var i=function(e){function a(l,m){(function g(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")})(this,a),-1!==l.search(/^[0-9]{11}$/)&&(l+=u(l));var h=function y(e,a){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!=typeof a&&"function"!=typeof a?e:a}(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,l,m));return h.displayValue=m.displayValue,h.fontSize=m.fontSize>10*m.width?10*m.width:m.fontSize,h.guardHeight=m.height+h.fontSize/2+m.textMargin,h}return function p(e,a){if("function"!=typeof a&&null!==a)throw new TypeError("Super expression must either be null or a function, not "+typeof a);e.prototype=Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(e,a):e.__proto__=a)}(a,e),v(a,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{12}$/)&&this.data[11]==u(this.data)}},{key:"encode",value:function(){return this.options.flat?this.flatEncoding():this.guardedEncoding()}},{key:"flatEncoding",value:function(){var m="";return m+="101",m+=(0,C.default)(this.data.substr(0,6),"LLLLLL"),m+="01010",m+=(0,C.default)(this.data.substr(6,6),"RRRRRR"),{data:m+="101",text:this.text}}},{key:"guardedEncoding",value:function(){var m=[];return this.displayValue&&m.push({data:"00000000",text:this.text.substr(0,1),options:{textAlign:"left",fontSize:this.fontSize}}),m.push({data:"101"+(0,C.default)(this.data[0],"L"),options:{height:this.guardHeight}}),m.push({data:(0,C.default)(this.data.substr(1,5),"LLLLL"),text:this.text.substr(1,5),options:{fontSize:this.fontSize}}),m.push({data:"01010",options:{height:this.guardHeight}}),m.push({data:(0,C.default)(this.data.substr(6,5),"RRRRR"),text:this.text.substr(6,5),options:{fontSize:this.fontSize}}),m.push({data:(0,C.default)(this.data[11],"R")+"101",options:{height:this.guardHeight}}),this.displayValue&&m.push({data:"00000000",text:this.text.substr(11,1),options:{textAlign:"right",fontSize:this.fontSize}}),m}}]),a}(k(f(2933)).default);function u(e){var l,a=0;for(l=1;l<11;l+=2)a+=parseInt(e[l]);for(l=0;l<11;l+=2)a+=3*parseInt(e[l]);return(10-a%10)%10}_.default=i},7638:(w,_,f)=>{Object.defineProperty(_,"__esModule",{value:!0});var v=function(){function m(h,F){for(var I=0;I<F.length;I++){var T=F[I];T.enumerable=T.enumerable||!1,T.configurable=!0,"value"in T&&(T.writable=!0),Object.defineProperty(h,T.key,T)}}return function(h,F,I){return F&&m(h.prototype,F),I&&m(h,I),h}}(),C=g(f(2143)),O=g(f(2933)),k=f(1541);function g(m){return m&&m.__esModule?m:{default:m}}function p(m,h){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!h||"object"!=typeof h&&"function"!=typeof h?m:h}var u=["XX00000XXX","XX10000XXX","XX20000XXX","XXX00000XX","XXXX00000X","XXXXX00005","XXXXX00006","XXXXX00007","XXXXX00008","XXXXX00009"],e=[["EEEOOO","OOOEEE"],["EEOEOO","OOEOEE"],["EEOOEO","OOEEOE"],["EEOOOE","OOEEEO"],["EOEEOO","OEOOEE"],["EOOEEO","OEEOOE"],["EOOOEE","OEEEOO"],["EOEOEO","OEOEOE"],["EOEOOE","OEOEEO"],["EOOEOE","OEEOEO"]],a=function(m){function h(F,I){!function y(m,h){if(!(m instanceof h))throw new TypeError("Cannot call a class as a function")}(this,h);var T=p(this,(h.__proto__||Object.getPrototypeOf(h)).call(this,F,I));if(T.isValid=!1,-1!==F.search(/^[0-9]{6}$/))T.middleDigits=F,T.upcA=l(F,"0"),T.text=I.text||""+T.upcA[0]+F+T.upcA[T.upcA.length-1],T.isValid=!0;else{if(-1===F.search(/^[01][0-9]{7}$/))return p(T);if(T.middleDigits=F.substring(1,F.length-1),T.upcA=l(T.middleDigits,F[0]),T.upcA[T.upcA.length-1]!==F[F.length-1])return p(T);T.isValid=!0}return T.displayValue=I.displayValue,T.fontSize=I.fontSize>10*I.width?10*I.width:I.fontSize,T.guardHeight=I.height+T.fontSize/2+I.textMargin,T}return function i(m,h){if("function"!=typeof h&&null!==h)throw new TypeError("Super expression must either be null or a function, not "+typeof h);m.prototype=Object.create(h&&h.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),h&&(Object.setPrototypeOf?Object.setPrototypeOf(m,h):m.__proto__=h)}(h,m),v(h,[{key:"valid",value:function(){return this.isValid}},{key:"encode",value:function(){return this.options.flat?this.flatEncoding():this.guardedEncoding()}},{key:"flatEncoding",value:function(){var I="";return I+="101",I+=this.encodeMiddleDigits(),{data:I+="010101",text:this.text}}},{key:"guardedEncoding",value:function(){var I=[];return this.displayValue&&I.push({data:"00000000",text:this.text[0],options:{textAlign:"left",fontSize:this.fontSize}}),I.push({data:"101",options:{height:this.guardHeight}}),I.push({data:this.encodeMiddleDigits(),text:this.text.substring(1,7),options:{fontSize:this.fontSize}}),I.push({data:"010101",options:{height:this.guardHeight}}),this.displayValue&&I.push({data:"00000000",text:this.text[7],options:{textAlign:"right",fontSize:this.fontSize}}),I}},{key:"encodeMiddleDigits",value:function(){var I=this.upcA[0],P=e[parseInt(this.upcA[this.upcA.length-1])][parseInt(I)];return(0,C.default)(this.middleDigits,P)}}]),h}(O.default);function l(m,h){for(var F=parseInt(m[m.length-1]),I=u[F],T="",P=0,X=0;X<I.length;X++){var J=I[X];T+="X"===J?m[P++]:J}return(T=""+h+T)+(0,k.checksum)(T)}_.default=a},2846:(w,_)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.SIDE_BIN="101",_.MIDDLE_BIN="01010",_.BINARIES={L:["0001101","0011001","0010011","0111101","0100011","0110001","0101111","0111011","0110111","0001011"],G:["0100111","0110011","0011011","0100001","0011101","0111001","0000101","0010001","0001001","0010111"],R:["1110010","1100110","1101100","1000010","1011100","1001110","1010000","1000100","1001000","1110100"],O:["0001101","0011001","0010011","0111101","0100011","0110001","0101111","0111011","0110111","0001011"],E:["0100111","0110011","0011011","0100001","0011101","0111001","0000101","0010001","0001001","0010111"]},_.EAN2_STRUCTURE=["LL","LG","GL","GG"],_.EAN5_STRUCTURE=["GGLLL","GLGLL","GLLGL","GLLLG","LGGLL","LLGGL","LLLGG","LGLGL","LGLLG","LLGLG"],_.EAN13_STRUCTURE=["LLLLLL","LLGLGG","LLGGLG","LLGGGL","LGLLGG","LGGLLG","LGGGLL","LGLGLG","LGLGGL","LGGLGL"]},2143:(w,_,f)=>{Object.defineProperty(_,"__esModule",{value:!0});var v=f(2846);_.default=function(b,O,k){var g=b.split("").map(function(p,i){return v.BINARIES[O[i]]}).map(function(p,i){return p?p[b[i]]:""});if(k){var y=b.length-1;g=g.map(function(p,i){return i<y?p+k:p})}return g.join("")}},9995:(w,_,f)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.UPCE=_.UPC=_.EAN2=_.EAN5=_.EAN8=_.EAN13=void 0;var E=a(f(7779)),b=a(f(2587)),k=a(f(6400)),y=a(f(197)),i=a(f(1541)),e=a(f(7638));function a(l){return l&&l.__esModule?l:{default:l}}_.EAN13=E.default,_.EAN8=b.default,_.EAN5=k.default,_.EAN2=y.default,_.UPC=i.default,_.UPCE=e.default},9257:(w,_,f)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.GenericBarcode=void 0;var v=function(){function p(i,u){for(var e=0;e<u.length;e++){var a=u[e];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(i,a.key,a)}}return function(i,u,e){return u&&p(i.prototype,u),e&&p(i,e),i}}(),y=function(p){function i(u,e){return function O(p,i){if(!(p instanceof i))throw new TypeError("Cannot call a class as a function")}(this,i),function k(p,i){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!i||"object"!=typeof i&&"function"!=typeof i?p:i}(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,u,e))}return function g(p,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function, not "+typeof i);p.prototype=Object.create(i&&i.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),i&&(Object.setPrototypeOf?Object.setPrototypeOf(p,i):p.__proto__=i)}(i,p),v(i,[{key:"encode",value:function(){return{data:"10101010101010101010101010101010101010101",text:this.text}}},{key:"valid",value:function(){return!0}}]),i}(function b(p){return p&&p.__esModule?p:{default:p}}(f(2933)).default);_.GenericBarcode=y},3534:(w,_,f)=>{Object.defineProperty(_,"__esModule",{value:!0});var v=function(){function i(u,e){for(var a=0;a<e.length;a++){var l=e[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(u,l.key,l)}}return function(u,e,a){return e&&i(u.prototype,e),a&&i(u,a),u}}(),E=f(2218),p=function(i){function u(){return function k(i,u){if(!(i instanceof u))throw new TypeError("Cannot call a class as a function")}(this,u),function g(i,u){if(!i)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!u||"object"!=typeof u&&"function"!=typeof u?i:u}(this,(u.__proto__||Object.getPrototypeOf(u)).apply(this,arguments))}return function y(i,u){if("function"!=typeof u&&null!==u)throw new TypeError("Super expression must either be null or a function, not "+typeof u);i.prototype=Object.create(u&&u.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),u&&(Object.setPrototypeOf?Object.setPrototypeOf(i,u):i.__proto__=u)}(u,i),v(u,[{key:"valid",value:function(){return-1!==this.data.search(/^([0-9]{2})+$/)}},{key:"encode",value:function(){var a=this,l=this.data.match(/.{2}/g).map(function(m){return a.encodePair(m)}).join("");return{data:E.START_BIN+l+E.END_BIN,text:this.text}}},{key:"encodePair",value:function(a){var l=E.BINARIES[a[1]];return E.BINARIES[a[0]].split("").map(function(m,h){return("1"===m?"111":"1")+("1"===l[h]?"000":"0")}).join("")}}]),u}(function O(i){return i&&i.__esModule?i:{default:i}}(f(2933)).default);_.default=p},6023:(w,_,f)=>{Object.defineProperty(_,"__esModule",{value:!0});var v=function(){function i(u,e){for(var a=0;a<e.length;a++){var l=e[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(u,l.key,l)}}return function(u,e,a){return e&&i(u.prototype,e),a&&i(u,a),u}}(),C=function b(i){return i&&i.__esModule?i:{default:i}}(f(3534)),y=function(u){var e=u.substr(0,13).split("").map(function(a){return parseInt(a,10)}).reduce(function(a,l,m){return a+l*(3-m%2*2)},0);return 10*Math.ceil(e/10)-e},p=function(i){function u(e,a){return function O(i,u){if(!(i instanceof u))throw new TypeError("Cannot call a class as a function")}(this,u),-1!==e.search(/^[0-9]{13}$/)&&(e+=y(e)),function k(i,u){if(!i)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!u||"object"!=typeof u&&"function"!=typeof u?i:u}(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,e,a))}return function g(i,u){if("function"!=typeof u&&null!==u)throw new TypeError("Super expression must either be null or a function, not "+typeof u);i.prototype=Object.create(u&&u.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),u&&(Object.setPrototypeOf?Object.setPrototypeOf(i,u):i.__proto__=u)}(u,i),v(u,[{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]{14}$/)&&+this.data[13]===y(this.data)}}]),u}(C.default);_.default=p},2218:(w,_)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.START_BIN="1010",_.END_BIN="11101",_.BINARIES=["00110","10001","01001","11000","00101","10100","01100","00011","10010","01010"]},9319:(w,_,f)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.ITF14=_.ITF=void 0;var E=O(f(3534)),b=O(f(6023));function O(k){return k&&k.__esModule?k:{default:k}}_.ITF=E.default,_.ITF14=b.default},8778:(w,_,f)=>{Object.defineProperty(_,"__esModule",{value:!0});var v=function(){function i(u,e){for(var a=0;a<e.length;a++){var l=e[a];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(u,l.key,l)}}return function(u,e,a){return e&&i(u.prototype,e),a&&i(u,a),u}}(),y=function(i){function u(e,a){return function O(i,u){if(!(i instanceof u))throw new TypeError("Cannot call a class as a function")}(this,u),function k(i,u){if(!i)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!u||"object"!=typeof u&&"function"!=typeof u?i:u}(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,e,a))}return function g(i,u){if("function"!=typeof u&&null!==u)throw new TypeError("Super expression must either be null or a function, not "+typeof u);i.prototype=Object.create(u&&u.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),u&&(Object.setPrototypeOf?Object.setPrototypeOf(i,u):i.__proto__=u)}(u,i),v(u,[{key:"encode",value:function(){for(var a="110",l=0;l<this.data.length;l++){var h=parseInt(this.data[l]).toString(2);h=p(h,4-h.length);for(var F=0;F<h.length;F++)a+="0"==h[F]?"100":"110"}return{data:a+="1001",text:this.text}}},{key:"valid",value:function(){return-1!==this.data.search(/^[0-9]+$/)}}]),u}(function b(i){return i&&i.__esModule?i:{default:i}}(f(2933)).default);function p(i,u){for(var e=0;e<u;e++)i="0"+i;return i}_.default=y},3167:(w,_,f)=>{Object.defineProperty(_,"__esModule",{value:!0});var E=function b(p){return p&&p.__esModule?p:{default:p}}(f(8778)),C=f(2821),y=function(p){function i(u,e){return function O(p,i){if(!(p instanceof i))throw new TypeError("Cannot call a class as a function")}(this,i),function k(p,i){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!i||"object"!=typeof i&&"function"!=typeof i?p:i}(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,u+(0,C.mod10)(u),e))}return function g(p,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function, not "+typeof i);p.prototype=Object.create(i&&i.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),i&&(Object.setPrototypeOf?Object.setPrototypeOf(p,i):p.__proto__=i)}(i,p),i}(E.default);_.default=y},1522:(w,_,f)=>{Object.defineProperty(_,"__esModule",{value:!0});var E=function b(p){return p&&p.__esModule?p:{default:p}}(f(8778)),C=f(2821),y=function(p){function i(u,e){return function O(p,i){if(!(p instanceof i))throw new TypeError("Cannot call a class as a function")}(this,i),u+=(0,C.mod10)(u),u+=(0,C.mod10)(u),function k(p,i){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!i||"object"!=typeof i&&"function"!=typeof i?p:i}(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,u,e))}return function g(p,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function, not "+typeof i);p.prototype=Object.create(i&&i.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),i&&(Object.setPrototypeOf?Object.setPrototypeOf(p,i):p.__proto__=i)}(i,p),i}(E.default);_.default=y},8552:(w,_,f)=>{Object.defineProperty(_,"__esModule",{value:!0});var E=function b(p){return p&&p.__esModule?p:{default:p}}(f(8778)),C=f(2821),y=function(p){function i(u,e){return function O(p,i){if(!(p instanceof i))throw new TypeError("Cannot call a class as a function")}(this,i),function k(p,i){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!i||"object"!=typeof i&&"function"!=typeof i?p:i}(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,u+(0,C.mod11)(u),e))}return function g(p,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function, not "+typeof i);p.prototype=Object.create(i&&i.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),i&&(Object.setPrototypeOf?Object.setPrototypeOf(p,i):p.__proto__=i)}(i,p),i}(E.default);_.default=y},677:(w,_,f)=>{Object.defineProperty(_,"__esModule",{value:!0});var E=function b(p){return p&&p.__esModule?p:{default:p}}(f(8778)),C=f(2821),y=function(p){function i(u,e){return function O(p,i){if(!(p instanceof i))throw new TypeError("Cannot call a class as a function")}(this,i),u+=(0,C.mod11)(u),u+=(0,C.mod10)(u),function k(p,i){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!i||"object"!=typeof i&&"function"!=typeof i?p:i}(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,u,e))}return function g(p,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function, not "+typeof i);p.prototype=Object.create(i&&i.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),i&&(Object.setPrototypeOf?Object.setPrototypeOf(p,i):p.__proto__=i)}(i,p),i}(E.default);_.default=y},2821:(w,_)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.mod10=function f(E){for(var C=0,b=0;b<E.length;b++){var O=parseInt(E[b]);C+=(b+E.length)%2==0?O:2*O%10+Math.floor(2*O/10)}return(10-C%10)%10},_.mod11=function v(E){for(var C=0,b=[2,3,4,5,6,7],O=0;O<E.length;O++){var k=parseInt(E[E.length-1-O]);C+=b[O%b.length]*k}return(11-C%11)%11}},3641:(w,_,f)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.MSI1110=_.MSI1010=_.MSI11=_.MSI10=_.MSI=void 0;var E=u(f(8778)),b=u(f(3167)),k=u(f(8552)),y=u(f(1522)),i=u(f(677));function u(e){return e&&e.__esModule?e:{default:e}}_.MSI=E.default,_.MSI10=b.default,_.MSI11=k.default,_.MSI1010=y.default,_.MSI1110=i.default},9468:(w,_,f)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.codabar=void 0;var v=function(){function p(i,u){for(var e=0;e<u.length;e++){var a=u[e];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(i,a.key,a)}}return function(i,u,e){return u&&p(i.prototype,u),e&&p(i,e),i}}(),y=function(p){function i(u,e){(function O(p,i){if(!(p instanceof i))throw new TypeError("Cannot call a class as a function")})(this,i),0===u.search(/^[0-9\-\$\:\.\+\/]+$/)&&(u="A"+u+"A");var a=function k(p,i){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!i||"object"!=typeof i&&"function"!=typeof i?p:i}(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,u.toUpperCase(),e));return a.text=a.options.text||a.text.replace(/[A-D]/g,""),a}return function g(p,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function, not "+typeof i);p.prototype=Object.create(i&&i.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),i&&(Object.setPrototypeOf?Object.setPrototypeOf(p,i):p.__proto__=i)}(i,p),v(i,[{key:"valid",value:function(){return-1!==this.data.search(/^[A-D][0-9\-\$\:\.\+\/]+[A-D]$/)}},{key:"encode",value:function(){for(var e=[],a=this.getEncodings(),l=0;l<this.data.length;l++)e.push(a[this.data.charAt(l)]),l!==this.data.length-1&&e.push("0");return{text:this.text,data:e.join("")}}},{key:"getEncodings",value:function(){return{0:"101010011",1:"101011001",2:"101001011",3:"110010101",4:"101101001",5:"110101001",6:"100101011",7:"100101101",8:"100110101",9:"110100101","-":"101001101",$:"101100101",":":"1101011011","/":"1101101011",".":"1101101101","+":"1011011011",A:"1011001001",B:"1001001011",C:"1010010011",D:"1010011001"}}}]),i}(function b(p){return p&&p.__esModule?p:{default:p}}(f(2933)).default);_.codabar=y},3209:(w,_,f)=>{Object.defineProperty(_,"__esModule",{value:!0});var v=f(3803),E=f(9152),C=f(9995),b=f(9319),O=f(3641),k=f(4322),g=f(9468),y=f(9257);_.default={CODE39:v.CODE39,CODE128:E.CODE128,CODE128A:E.CODE128A,CODE128B:E.CODE128B,CODE128C:E.CODE128C,EAN13:C.EAN13,EAN8:C.EAN8,EAN5:C.EAN5,EAN2:C.EAN2,UPC:C.UPC,UPCE:C.UPCE,ITF14:b.ITF14,ITF:b.ITF,MSI:O.MSI,MSI10:O.MSI10,MSI11:O.MSI11,MSI1010:O.MSI1010,MSI1110:O.MSI1110,pharmacode:k.pharmacode,codabar:g.codabar,GenericBarcode:y.GenericBarcode}},4322:(w,_,f)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.pharmacode=void 0;var v=function(){function p(i,u){for(var e=0;e<u.length;e++){var a=u[e];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(i,a.key,a)}}return function(i,u,e){return u&&p(i.prototype,u),e&&p(i,e),i}}(),y=function(p){function i(u,e){!function O(p,i){if(!(p instanceof i))throw new TypeError("Cannot call a class as a function")}(this,i);var a=function k(p,i){if(!p)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!i||"object"!=typeof i&&"function"!=typeof i?p:i}(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,u,e));return a.number=parseInt(u,10),a}return function g(p,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function, not "+typeof i);p.prototype=Object.create(i&&i.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),i&&(Object.setPrototypeOf?Object.setPrototypeOf(p,i):p.__proto__=i)}(i,p),v(i,[{key:"encode",value:function(){for(var e=this.number,a="";!isNaN(e)&&0!=e;)e%2==0?(a="11100"+a,e=(e-2)/2):(a="100"+a,e=(e-1)/2);return{data:a=a.slice(0,-2),text:this.text}}},{key:"valid",value:function(){return this.number>=3&&this.number<=131070}}]),i}(function b(p){return p&&p.__esModule?p:{default:p}}(f(2933)).default);_.pharmacode=y},650:(w,_)=>{Object.defineProperty(_,"__esModule",{value:!0});var f=function(){function C(b,O){for(var k=0;k<O.length;k++){var g=O[k];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(b,g.key,g)}}return function(b,O,k){return O&&C(b.prototype,O),k&&C(b,k),b}}(),E=function(){function C(b){(function v(C,b){if(!(C instanceof b))throw new TypeError("Cannot call a class as a function")})(this,C),this.api=b}return f(C,[{key:"handleCatch",value:function(O){if("InvalidInputException"!==O.name)throw O;if(this.api._options.valid===this.api._defaults.valid)throw O.message;this.api._options.valid(!1),this.api.render=function(){}}},{key:"wrapBarcodeCall",value:function(O){try{var k=O.apply(void 0,arguments);return this.api._options.valid(!0),k}catch(g){return this.handleCatch(g),this.api}}}]),C}();_.default=E},1498:(w,_)=>{function f(k,g){if(!(k instanceof g))throw new TypeError("Cannot call a class as a function")}function v(k,g){if(!k)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!g||"object"!=typeof g&&"function"!=typeof g?k:g}function E(k,g){if("function"!=typeof g&&null!==g)throw new TypeError("Super expression must either be null or a function, not "+typeof g);k.prototype=Object.create(g&&g.prototype,{constructor:{value:k,enumerable:!1,writable:!0,configurable:!0}}),g&&(Object.setPrototypeOf?Object.setPrototypeOf(k,g):k.__proto__=g)}Object.defineProperty(_,"__esModule",{value:!0});var C=function(){function g(y,p){f(this,g);var i=v(this,(g.__proto__||Object.getPrototypeOf(g)).call(this));return i.name="InvalidInputException",i.symbology=y,i.input=p,i.message='"'+i.input+'" is not a valid input for '+i.symbology,i}return E(g,Error),g}(),b=function(){function g(){f(this,g);var y=v(this,(g.__proto__||Object.getPrototypeOf(g)).call(this));return y.name="InvalidElementException",y.message="Not supported type to render on",y}return E(g,Error),g}(),O=function(){function g(){f(this,g);var y=v(this,(g.__proto__||Object.getPrototypeOf(g)).call(this));return y.name="NoElementException",y.message="No element to render on.",y}return E(g,Error),g}();_.InvalidInputException=C,_.InvalidElementException=b,_.NoElementException=O},8084:(w,_)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.default=function f(v){return v.marginTop=v.marginTop||v.margin,v.marginBottom=v.marginBottom||v.margin,v.marginRight=v.marginRight||v.margin,v.marginLeft=v.marginLeft||v.margin,v}},329:(w,_,f)=>{Object.defineProperty(_,"__esModule",{value:!0});var E=O(f(1951)),b=O(f(5482));function O(g){return g&&g.__esModule?g:{default:g}}_.default=function k(g){var y={};for(var p in b.default)b.default.hasOwnProperty(p)&&(g.hasAttribute("jsbarcode-"+p.toLowerCase())&&(y[p]=g.getAttribute("jsbarcode-"+p.toLowerCase())),g.hasAttribute("data-"+p.toLowerCase())&&(y[p]=g.getAttribute("data-"+p.toLowerCase())));return y.value=g.getAttribute("jsbarcode-value")||g.getAttribute("data-value"),(0,E.default)(y)}},2042:(w,_,f)=>{Object.defineProperty(_,"__esModule",{value:!0});var v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(u){return typeof u}:function(u){return u&&"function"==typeof Symbol&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u},C=g(f(329)),O=g(f(2368)),k=f(1498);function g(u){return u&&u.__esModule?u:{default:u}}_.default=function y(u){if("string"==typeof u)return function p(u){var e=document.querySelectorAll(u);if(0!==e.length){for(var a=[],l=0;l<e.length;l++)a.push(y(e[l]));return a}}(u);if(Array.isArray(u)){for(var e=[],a=0;a<u.length;a++)e.push(y(u[a]));return e}if(typeof HTMLCanvasElement<"u"&&u instanceof HTMLImageElement)return function i(u){var e=document.createElement("canvas");return{element:e,options:(0,C.default)(u),renderer:O.default.CanvasRenderer,afterRender:function(){u.setAttribute("src",e.toDataURL())}}}(u);if(u&&u.nodeName&&"svg"===u.nodeName.toLowerCase()||typeof SVGElement<"u"&&u instanceof SVGElement)return{element:u,options:(0,C.default)(u),renderer:O.default.SVGRenderer};if(typeof HTMLCanvasElement<"u"&&u instanceof HTMLCanvasElement)return{element:u,options:(0,C.default)(u),renderer:O.default.CanvasRenderer};if(u&&u.getContext)return{element:u,renderer:O.default.CanvasRenderer};if(u&&"object"===(typeof u>"u"?"undefined":v(u))&&!u.nodeName)return{element:u,renderer:O.default.ObjectRenderer};throw new k.InvalidElementException}},9246:(w,_)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.default=function f(v){var E=[];return function C(b){if(Array.isArray(b))for(var O=0;O<b.length;O++)C(b[O]);else b.text=b.text||"",b.data=b.data||"",E.push(b)}(v),E}},3931:(w,_)=>{Object.defineProperty(_,"__esModule",{value:!0});var f=Object.assign||function(v){for(var E=1;E<arguments.length;E++){var C=arguments[E];for(var b in C)Object.prototype.hasOwnProperty.call(C,b)&&(v[b]=C[b])}return v};_.default=function(v,E){return f({},v,E)}},1951:(w,_)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.default=function f(v){var E=["width","height","textMargin","fontSize","margin","marginTop","marginBottom","marginLeft","marginRight"];for(var C in E)E.hasOwnProperty(C)&&"string"==typeof v[C=E[C]]&&(v[C]=parseInt(v[C],10));return"string"==typeof v.displayValue&&(v.displayValue="false"!=v.displayValue),v}},5482:(w,_)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.default={width:2,height:100,format:"auto",displayValue:!0,fontOptions:"",font:"monospace",text:void 0,textAlign:"center",textPosition:"bottom",textMargin:2,fontSize:20,background:"#ffffff",lineColor:"#000000",margin:10,marginTop:void 0,marginBottom:void 0,marginLeft:void 0,marginRight:void 0,valid:function(){}}},8682:(w,_,f)=>{Object.defineProperty(_,"__esModule",{value:!0});var v=function(){function y(p,i){for(var u=0;u<i.length;u++){var e=i[u];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(p,e.key,e)}}return function(p,i,u){return i&&y(p.prototype,i),u&&y(p,u),p}}(),C=function O(y){return y&&y.__esModule?y:{default:y}}(f(3931)),b=f(2283),g=function(){function y(p,i,u){(function k(y,p){if(!(y instanceof p))throw new TypeError("Cannot call a class as a function")})(this,y),this.canvas=p,this.encodings=i,this.options=u}return v(y,[{key:"render",value:function(){if(!this.canvas.getContext)throw new Error("The browser does not support canvas.");this.prepareCanvas();for(var i=0;i<this.encodings.length;i++){var u=(0,C.default)(this.options,this.encodings[i].options);this.drawCanvasBarcode(u,this.encodings[i]),this.drawCanvasText(u,this.encodings[i]),this.moveCanvasDrawing(this.encodings[i])}this.restoreCanvas()}},{key:"prepareCanvas",value:function(){var i=this.canvas.getContext("2d");i.save(),(0,b.calculateEncodingAttributes)(this.encodings,this.options,i);var u=(0,b.getTotalWidthOfEncodings)(this.encodings),e=(0,b.getMaximumHeightOfEncodings)(this.encodings);this.canvas.width=u+this.options.marginLeft+this.options.marginRight,this.canvas.height=e,i.clearRect(0,0,this.canvas.width,this.canvas.height),this.options.background&&(i.fillStyle=this.options.background,i.fillRect(0,0,this.canvas.width,this.canvas.height)),i.translate(this.options.marginLeft,0)}},{key:"drawCanvasBarcode",value:function(i,u){var l,e=this.canvas.getContext("2d"),a=u.data;l="top"==i.textPosition?i.marginTop+i.fontSize+i.textMargin:i.marginTop,e.fillStyle=i.lineColor;for(var m=0;m<a.length;m++){var h=m*i.width+u.barcodePadding;"1"===a[m]?e.fillRect(h,l,i.width,i.height):a[m]&&e.fillRect(h,l,i.width,i.height*a[m])}}},{key:"drawCanvasText",value:function(i,u){var l,m,e=this.canvas.getContext("2d");i.displayValue&&(m="top"==i.textPosition?i.marginTop+i.fontSize-i.textMargin:i.height+i.textMargin+i.marginTop+i.fontSize,e.font=i.fontOptions+" "+i.fontSize+"px "+i.font,"left"==i.textAlign||u.barcodePadding>0?(l=0,e.textAlign="left"):"right"==i.textAlign?(l=u.width-1,e.textAlign="right"):(l=u.width/2,e.textAlign="center"),e.fillText(u.text,l,m))}},{key:"moveCanvasDrawing",value:function(i){this.canvas.getContext("2d").translate(i.width,0)}},{key:"restoreCanvas",value:function(){this.canvas.getContext("2d").restore()}}]),y}();_.default=g},2368:(w,_,f)=>{Object.defineProperty(_,"__esModule",{value:!0});var E=g(f(8682)),b=g(f(1538)),k=g(f(1045));function g(y){return y&&y.__esModule?y:{default:y}}_.default={CanvasRenderer:E.default,SVGRenderer:b.default,ObjectRenderer:k.default}},1045:(w,_)=>{Object.defineProperty(_,"__esModule",{value:!0});var f=function(){function C(b,O){for(var k=0;k<O.length;k++){var g=O[k];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(b,g.key,g)}}return function(b,O,k){return O&&C(b.prototype,O),k&&C(b,k),b}}(),E=function(){function C(b,O,k){(function v(C,b){if(!(C instanceof b))throw new TypeError("Cannot call a class as a function")})(this,C),this.object=b,this.encodings=O,this.options=k}return f(C,[{key:"render",value:function(){this.object.encodings=this.encodings}}]),C}();_.default=E},2283:(w,_,f)=>{Object.defineProperty(_,"__esModule",{value:!0}),_.getTotalWidthOfEncodings=_.calculateEncodingAttributes=_.getBarcodePadding=_.getEncodingHeight=_.getMaximumHeightOfEncodings=void 0;var E=function C(i){return i&&i.__esModule?i:{default:i}}(f(3931));function b(i,u){return u.height+(u.displayValue&&i.text.length>0?u.fontSize+u.textMargin:0)+u.marginTop+u.marginBottom}function O(i,u,e){if(e.displayValue&&u<i){if("center"==e.textAlign)return Math.floor((i-u)/2);if("left"==e.textAlign)return 0;if("right"==e.textAlign)return Math.floor(i-u)}return 0}function p(i,u,e){var a;if(e)a=e;else{if(!(typeof document<"u"))return 0;a=document.createElement("canvas").getContext("2d")}a.font=u.fontOptions+" "+u.fontSize+"px "+u.font;var l=a.measureText(i);return l?l.width:0}_.getMaximumHeightOfEncodings=function y(i){for(var u=0,e=0;e<i.length;e++)i[e].height>u&&(u=i[e].height);return u},_.getEncodingHeight=b,_.getBarcodePadding=O,_.calculateEncodingAttributes=function k(i,u,e){for(var a=0;a<i.length;a++){var h,l=i[a],m=(0,E.default)(u,l.options);h=m.displayValue?p(l.text,m,e):0;var F=l.data.length*m.width;l.width=Math.ceil(Math.max(h,F)),l.height=b(l,m),l.barcodePadding=O(h,F,m)}},_.getTotalWidthOfEncodings=function g(i){for(var u=0,e=0;e<i.length;e++)u+=i[e].width;return u}},1538:(w,_,f)=>{Object.defineProperty(_,"__esModule",{value:!0});var v=function(){function p(i,u){for(var e=0;e<u.length;e++){var a=u[e];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(i,a.key,a)}}return function(i,u,e){return u&&p(i.prototype,u),e&&p(i,e),i}}(),C=function O(p){return p&&p.__esModule?p:{default:p}}(f(3931)),b=f(2283),g="http://www.w3.org/2000/svg",y=function(){function p(i,u,e){(function k(p,i){if(!(p instanceof i))throw new TypeError("Cannot call a class as a function")})(this,p),this.svg=i,this.encodings=u,this.options=e,this.document=e.xmlDocument||document}return v(p,[{key:"render",value:function(){var u=this.options.marginLeft;this.prepareSVG();for(var e=0;e<this.encodings.length;e++){var a=this.encodings[e],l=(0,C.default)(this.options,a.options),m=this.createGroup(u,l.marginTop,this.svg);this.setGroupOptions(m,l),this.drawSvgBarcode(m,l,a),this.drawSVGText(m,l,a),u+=a.width}}},{key:"prepareSVG",value:function(){for(;this.svg.firstChild;)this.svg.removeChild(this.svg.firstChild);(0,b.calculateEncodingAttributes)(this.encodings,this.options);var u=(0,b.getTotalWidthOfEncodings)(this.encodings),e=(0,b.getMaximumHeightOfEncodings)(this.encodings),a=u+this.options.marginLeft+this.options.marginRight;this.setSvgAttributes(a,e),this.options.background&&this.drawRect(0,0,a,e,this.svg).setAttribute("style","fill:"+this.options.background+";")}},{key:"drawSvgBarcode",value:function(u,e,a){var m,l=a.data;m="top"==e.textPosition?e.fontSize+e.textMargin:0;for(var h=0,F=0,I=0;I<l.length;I++)F=I*e.width+a.barcodePadding,"1"===l[I]?h++:h>0&&(this.drawRect(F-e.width*h,m,e.width*h,e.height,u),h=0);h>0&&this.drawRect(F-e.width*(h-1),m,e.width*h,e.height,u)}},{key:"drawSVGText",value:function(u,e,a){var m,h,l=this.document.createElementNS(g,"text");e.displayValue&&(l.setAttribute("style","font:"+e.fontOptions+" "+e.fontSize+"px "+e.font),h="top"==e.textPosition?e.fontSize-e.textMargin:e.height+e.textMargin+e.fontSize,"left"==e.textAlign||a.barcodePadding>0?(m=0,l.setAttribute("text-anchor","start")):"right"==e.textAlign?(m=a.width-1,l.setAttribute("text-anchor","end")):(m=a.width/2,l.setAttribute("text-anchor","middle")),l.setAttribute("x",m),l.setAttribute("y",h),l.appendChild(this.document.createTextNode(a.text)),u.appendChild(l))}},{key:"setSvgAttributes",value:function(u,e){var a=this.svg;a.setAttribute("width",u+"px"),a.setAttribute("height",e+"px"),a.setAttribute("x","0px"),a.setAttribute("y","0px"),a.setAttribute("viewBox","0 0 "+u+" "+e),a.setAttribute("xmlns",g),a.setAttribute("version","1.1"),a.setAttribute("style","transform: translate(0,0)")}},{key:"createGroup",value:function(u,e,a){var l=this.document.createElementNS(g,"g");return l.setAttribute("transform","translate("+u+", "+e+")"),a.appendChild(l),l}},{key:"setGroupOptions",value:function(u,e){u.setAttribute("style","fill:"+e.lineColor+";")}},{key:"drawRect",value:function(u,e,a,l,m){var h=this.document.createElementNS(g,"rect");return h.setAttribute("x",u),h.setAttribute("y",e),h.setAttribute("width",a),h.setAttribute("height",l),m.appendChild(h),h}}]),p}();_.default=y}}]);