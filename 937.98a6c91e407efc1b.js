"use strict";(self.webpackChunkseller=self.webpackChunkseller||[]).push([[937],{1937:(Et,k,a)=>{a.r(k),a.d(k,{ProductListModule:()=>jt});var d=a(177),C=a(2115),r=a(9437),s=a(983),j=a(2180),m=a(4153),g=a(9764),t=a(4438),P=a(9058),h=a(5779),E=a(345),M=a(6781),f=a(9417),l=a(544),F=a(9998),b=a(1141),G=a(4602),R=a(6160),D=a(1802),x=a(2242),I=a(4799),T=a(1314);const y=()=>["name"],S=()=>[10,25,50],v=()=>({"min-width":"75rem"}),L=o=>({width:o}),N=()=>({width:"50vw"});function X(o,u){1&o&&(t.j41(0,"tr")(1,"th",11),t.EFF(2," \u041a\u043e\u0434 "),t.nrm(3,"p-sortIcon",12),t.k0s(),t.j41(4,"th",13),t.EFF(5," \u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435 "),t.nrm(6,"p-sortIcon",14),t.k0s(),t.j41(7,"th"),t.EFF(8,"\u0413\u0430\u0431\u0430\u0440\u0438\u0442\u044b"),t.k0s(),t.j41(9,"th"),t.EFF(10,"\u041c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439 \u043e\u0441\u0442\u0430\u0442\u043e\u043a \u043d\u0430 \u0441\u043a\u043b\u0430\u0434\u0435"),t.k0s(),t.j41(11,"th"),t.EFF(12,"\u041e\u0441\u0442\u0430\u0442\u043e\u043a \u043d\u0430 \u0441\u0432\u043e\u0451\u043c \u0441\u043a\u043b\u0430\u0434\u0435"),t.k0s(),t.nrm(13,"th")(14,"th"),t.k0s(),t.j41(15,"tr")(16,"th"),t.nrm(17,"p-columnFilter",15),t.k0s(),t.j41(18,"th"),t.nrm(19,"p-columnFilter",16),t.k0s(),t.nrm(20,"th")(21,"th")(22,"th")(23,"th")(24,"th"),t.k0s())}function B(o,u){if(1&o){const e=t.RV6();t.j41(0,"p-button",26),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,p=t.XpG();return p.showScanner=!0,t.Njj(p.selectedProduct=n)}),t.k0s()}}function V(o,u){if(1&o){const e=t.RV6();t.j41(0,"input",27),t.mxI("ngModelChange",function(n){t.eBV(e);const p=t.XpG().$implicit;return t.DH7(p.name,n)||(p.name=n),t.Njj(n)}),t.k0s()}if(2&o){const e=t.XpG().$implicit;t.R50("ngModel",e.name)}}function w(o,u){if(1&o&&t.EFF(0),2&o){const e=t.XpG().$implicit;t.SpI(" ",e.name," ")}}function $(o,u){if(1&o){const e=t.RV6();t.j41(0,"p-inputGroup")(1,"p-inputGroupAddon"),t.EFF(2,"\u0428"),t.k0s(),t.j41(3,"p-inputNumber",28),t.mxI("ngModelChange",function(n){t.eBV(e);const p=t.XpG().$implicit;return t.DH7(p.widthMM,n)||(p.widthMM=n),t.Njj(n)}),t.k0s(),t.j41(4,"p-inputGroupAddon"),t.EFF(5,"\u043c\u043c"),t.k0s()(),t.j41(6,"p-inputGroup")(7,"p-inputGroupAddon"),t.EFF(8,"\u0412"),t.k0s(),t.j41(9,"p-inputNumber",29),t.mxI("ngModelChange",function(n){t.eBV(e);const p=t.XpG().$implicit;return t.DH7(p.heightMM,n)||(p.heightMM=n),t.Njj(n)}),t.k0s(),t.j41(10,"p-inputGroupAddon"),t.EFF(11,"\u043c\u043c"),t.k0s()(),t.j41(12,"p-inputGroup")(13,"p-inputGroupAddon"),t.EFF(14,"\u0413"),t.k0s(),t.j41(15,"p-inputNumber",30),t.mxI("ngModelChange",function(n){t.eBV(e);const p=t.XpG().$implicit;return t.DH7(p.depthMM,n)||(p.depthMM=n),t.Njj(n)}),t.k0s(),t.j41(16,"p-inputGroupAddon"),t.EFF(17,"\u043c\u043c"),t.k0s()(),t.j41(18,"p-inputGroup")(19,"p-inputGroupAddon"),t.EFF(20,"\u0412\u0435\u0441"),t.k0s(),t.j41(21,"p-inputNumber",31),t.mxI("ngModelChange",function(n){t.eBV(e);const p=t.XpG().$implicit;return t.DH7(p.weightG,n)||(p.weightG=n),t.Njj(n)}),t.k0s(),t.j41(22,"p-inputGroupAddon"),t.EFF(23,"\u0433"),t.k0s()()}if(2&o){const e=t.XpG().$implicit;t.R7$(3),t.R50("ngModel",e.widthMM),t.R7$(6),t.R50("ngModel",e.heightMM),t.R7$(6),t.R50("ngModel",e.depthMM),t.R7$(6),t.R50("ngModel",e.weightG)}}function A(o,u){if(1&o&&(t.j41(0,"div",32),t.EFF(1),t.k0s(),t.j41(2,"div"),t.EFF(3),t.k0s()),2&o){let e,i;const n=t.XpG().$implicit;t.R7$(),t.E5c(" ",null!==(e=n.widthMM)&&void 0!==e?e:0," x ",null!==(e=n.heightMM)&&void 0!==e?e:0," x ",null!==(e=n.depthMM)&&void 0!==e?e:0," "),t.R7$(2),t.SpI("",null!==(i=n.weightG)&&void 0!==i?i:0,"\u0433")}}function H(o,u){if(1&o){const e=t.RV6();t.j41(0,"input",27),t.mxI("ngModelChange",function(n){t.eBV(e);const p=t.XpG().$implicit;return t.DH7(p.minimumWarehouseStock,n)||(p.minimumWarehouseStock=n),t.Njj(n)}),t.k0s()}if(2&o){const e=t.XpG().$implicit;t.R50("ngModel",e.minimumWarehouseStock)}}function Y(o,u){if(1&o&&t.EFF(0),2&o){let e;const i=t.XpG().$implicit;t.SpI(" ",null!==(e=i.minimumWarehouseStock)&&void 0!==e?e:0," ")}}function z(o,u){if(1&o){const e=t.RV6();t.j41(0,"input",27),t.mxI("ngModelChange",function(n){t.eBV(e);const p=t.XpG().$implicit;return t.DH7(p.stockAmount,n)||(p.stockAmount=n),t.Njj(n)}),t.k0s()}if(2&o){const e=t.XpG().$implicit;t.R50("ngModel",e.stockAmount)}}function W(o,u){if(1&o&&t.EFF(0),2&o){let e;const i=t.XpG().$implicit;t.SpI(" ",null!==(e=i.stockAmount)&&void 0!==e?e:0," ")}}function O(o,u){if(1&o){const e=t.RV6();t.j41(0,"p-button",33),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,p=t.XpG(),c=t.sdS(7);return t.Njj(p.onProductEditInit(c,n))}),t.k0s()}}function J(o,u){if(1&o){const e=t.RV6();t.j41(0,"p-button",34),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,p=t.XpG(),c=t.sdS(7);return t.Njj(p.onProductEditSave(c,n))}),t.k0s()}}function U(o,u){if(1&o){const e=t.RV6();t.j41(0,"p-button",35),t.bIt("click",function(){t.eBV(e);const n=t.XpG(2);return t.Njj(n.onProductEditCancel())}),t.k0s()}}function K(o,u){if(1&o){const e=t.RV6();t.j41(0,"p-button",36),t.bIt("click",function(n){t.eBV(e);const p=t.XpG().$implicit,c=t.XpG();return t.Njj(c.confirmProductRemoval(n,p))}),t.k0s()}}function Q(o,u){if(1&o&&t.nrm(0,"button",37),2&o){const e=t.XpG(),n=e.$implicit;t.Y8G("icon",e.expanded?"pi pi-chevron-down":"pi pi-chevron-right")("pRowToggler",n)}}function Z(o,u){if(1&o&&(t.j41(0,"tr",17)(1,"td"),t.EFF(2),t.DNE(3,B,1,0,"p-button",18),t.k0s(),t.j41(4,"td")(5,"p-cellEditor"),t.DNE(6,V,1,1,"ng-template",19)(7,w,1,1,"ng-template",20),t.k0s()(),t.j41(8,"td")(9,"p-cellEditor"),t.DNE(10,$,24,4,"ng-template",19)(11,A,4,4,"ng-template",20),t.k0s()(),t.j41(12,"td")(13,"p-cellEditor"),t.DNE(14,H,1,1,"ng-template",19)(15,Y,1,1,"ng-template",20),t.k0s()(),t.j41(16,"td")(17,"p-cellEditor"),t.DNE(18,z,1,1,"ng-template",19)(19,W,1,1,"ng-template",20),t.k0s()(),t.j41(20,"td"),t.DNE(21,O,1,0,"p-button",21)(22,J,1,0,"p-button",22)(23,U,1,0,"p-button",23)(24,K,1,0,"p-button",24),t.k0s(),t.j41(25,"td"),t.DNE(26,Q,1,2,"button",25),t.k0s()()),2&o){const e=u.editing,i=u.$implicit,n=t.XpG();t.Y8G("pEditableRow",i),t.R7$(2),t.SpI(" ",i.iD," "),t.R7$(),t.Y8G("ngIf",e),t.R7$(18),t.Y8G("ngIf",!e),t.R7$(),t.Y8G("ngIf",e),t.R7$(),t.Y8G("ngIf",e),t.R7$(),t.Y8G("ngIf",!n.editMode),t.R7$(2),t.Y8G("ngIf",i.iD)}}function q(o,u){1&o&&(t.j41(0,"tr")(1,"th"),t.EFF(2,"\u041a\u043e\u0434"),t.k0s(),t.j41(3,"th"),t.EFF(4," \u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435 "),t.k0s(),t.j41(5,"th"),t.EFF(6," \u0413\u0430\u0431\u0430\u0440\u0438\u0442\u044b (\u0431\u0440\u0443\u0442\u0442\u043e) "),t.k0s(),t.j41(7,"th"),t.EFF(8,"\u041c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439 \u0437\u0430\u043f\u0430\u0441, \u0448\u0442"),t.k0s(),t.j41(9,"th"),t.EFF(10,"\u041f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u043a\u0430 \u043f\u043e\u0441\u0442\u0430\u0432\u043a\u0438, \u0434\u043d\u0435\u0439"),t.k0s(),t.j41(11,"th"),t.EFF(12,"\u0422\u043e\u0432\u0430\u0440\u043e\u0432 \u0432 \u0444\u0430\u0441\u043e\u0432\u043a\u0435"),t.k0s(),t.nrm(13,"th"),t.k0s())}function tt(o,u){if(1&o){const e=t.RV6();t.j41(0,"input",27),t.mxI("ngModelChange",function(n){t.eBV(e);const p=t.XpG().$implicit;return t.DH7(p.name,n)||(p.name=n),t.Njj(n)}),t.k0s()}if(2&o){const e=t.XpG().$implicit;t.R50("ngModel",e.name)}}function et(o,u){if(1&o&&t.EFF(0),2&o){const e=t.XpG().$implicit;t.SpI(" ",e.name," ")}}function nt(o,u){if(1&o){const e=t.RV6();t.j41(0,"p-inputGroup")(1,"p-inputGroupAddon"),t.EFF(2,"\u0428"),t.k0s(),t.j41(3,"p-inputNumber",28),t.mxI("ngModelChange",function(n){t.eBV(e);const p=t.XpG().$implicit;return t.DH7(p.widthMM,n)||(p.widthMM=n),t.Njj(n)}),t.k0s(),t.j41(4,"p-inputGroupAddon"),t.EFF(5,"\u043c\u043c"),t.k0s()(),t.j41(6,"p-inputGroup")(7,"p-inputGroupAddon"),t.EFF(8,"\u0412"),t.k0s(),t.j41(9,"p-inputNumber",29),t.mxI("ngModelChange",function(n){t.eBV(e);const p=t.XpG().$implicit;return t.DH7(p.heightMM,n)||(p.heightMM=n),t.Njj(n)}),t.k0s(),t.j41(10,"p-inputGroupAddon"),t.EFF(11,"\u043c\u043c"),t.k0s()(),t.j41(12,"p-inputGroup")(13,"p-inputGroupAddon"),t.EFF(14,"\u0413"),t.k0s(),t.j41(15,"p-inputNumber",30),t.mxI("ngModelChange",function(n){t.eBV(e);const p=t.XpG().$implicit;return t.DH7(p.depthMM,n)||(p.depthMM=n),t.Njj(n)}),t.k0s(),t.j41(16,"p-inputGroupAddon"),t.EFF(17,"\u043c\u043c"),t.k0s()(),t.j41(18,"p-inputGroup")(19,"p-inputGroupAddon"),t.EFF(20,"\u0412\u0435\u0441"),t.k0s(),t.j41(21,"p-inputNumber",31),t.mxI("ngModelChange",function(n){t.eBV(e);const p=t.XpG().$implicit;return t.DH7(p.weightG,n)||(p.weightG=n),t.Njj(n)}),t.k0s(),t.j41(22,"p-inputGroupAddon"),t.EFF(23,"\u0433"),t.k0s()()}if(2&o){const e=t.XpG().$implicit;t.R7$(3),t.R50("ngModel",e.widthMM),t.R7$(6),t.R50("ngModel",e.heightMM),t.R7$(6),t.R50("ngModel",e.depthMM),t.R7$(6),t.R50("ngModel",e.weightG)}}function it(o,u){if(1&o&&(t.j41(0,"div",32),t.EFF(1),t.k0s(),t.j41(2,"div"),t.EFF(3),t.k0s()),2&o){let e,i;const n=t.XpG().$implicit;t.R7$(),t.E5c(" ",null!==(e=n.widthMM)&&void 0!==e?e:0," x ",null!==(e=n.heightMM)&&void 0!==e?e:0," x ",null!==(e=n.depthMM)&&void 0!==e?e:0," "),t.R7$(2),t.SpI("",null!==(i=n.weightG)&&void 0!==i?i:0,"\u0433")}}function ot(o,u){if(1&o){const e=t.RV6();t.j41(0,"input",27),t.mxI("ngModelChange",function(n){t.eBV(e);const p=t.XpG().$implicit;return t.DH7(p.minimumWarehouseStock,n)||(p.minimumWarehouseStock=n),t.Njj(n)}),t.k0s()}if(2&o){const e=t.XpG().$implicit;t.R50("ngModel",e.minimumWarehouseStock)}}function pt(o,u){if(1&o&&t.EFF(0),2&o){const e=t.XpG().$implicit;t.SpI(" ",e.minimumWarehouseStock," ")}}function ut(o,u){if(1&o){const e=t.RV6();t.j41(0,"input",27),t.mxI("ngModelChange",function(n){t.eBV(e);const p=t.XpG().$implicit;return t.DH7(p.supplyPreparationTimeInDays,n)||(p.supplyPreparationTimeInDays=n),t.Njj(n)}),t.k0s()}if(2&o){const e=t.XpG().$implicit;t.R50("ngModel",e.supplyPreparationTimeInDays)}}function at(o,u){if(1&o&&t.EFF(0),2&o){const e=t.XpG().$implicit;t.SpI(" ",e.supplyPreparationTimeInDays," ")}}function ct(o,u){if(1&o){const e=t.RV6();t.j41(0,"p-inputNumber",42),t.mxI("ngModelChange",function(n){t.eBV(e);const p=t.XpG().$implicit;return t.DH7(p.productCount,n)||(p.productCount=n),t.Njj(n)}),t.k0s()}if(2&o){const e=t.XpG().$implicit;t.R50("ngModel",e.productCount),t.Y8G("useGrouping",!1)}}function _t(o,u){if(1&o&&t.EFF(0),2&o){const e=t.XpG().$implicit;t.SpI(" ",e.productCount," ")}}function lt(o,u){if(1&o){const e=t.RV6();t.j41(0,"p-button",33),t.bIt("click",function(){t.eBV(e);const n=t.XpG(),p=n.$implicit,c=n.rowIndex;t.XpG();const _=t.sdS(1),Pt=t.XpG(2);return t.Njj(Pt.onPackageEditInit(_,p,c))}),t.k0s()}}function rt(o,u){if(1&o){const e=t.RV6();t.j41(0,"p-button",43),t.bIt("click",function(){t.eBV(e);const n=t.XpG().$implicit,p=t.XpG(3);return t.Njj(p.onPackageEditSave(n))}),t.k0s()}}function st(o,u){if(1&o){const e=t.RV6();t.j41(0,"p-button",35),t.bIt("click",function(){t.eBV(e);const n=t.XpG().rowIndex;t.XpG();const p=t.sdS(1),c=t.XpG(2);return t.Njj(c.onPackageEditCancel(p,n))}),t.k0s()}}function mt(o,u){if(1&o){const e=t.RV6();t.j41(0,"tr",17)(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td")(4,"p-cellEditor"),t.DNE(5,tt,1,1,"ng-template",19)(6,et,1,1,"ng-template",20),t.k0s()(),t.j41(7,"td")(8,"p-cellEditor"),t.DNE(9,nt,24,4,"ng-template",19)(10,it,4,4,"ng-template",20),t.k0s()(),t.j41(11,"td")(12,"p-cellEditor"),t.DNE(13,ot,1,1,"ng-template",19)(14,pt,1,1,"ng-template",20),t.k0s()(),t.j41(15,"td")(16,"p-cellEditor"),t.DNE(17,ut,1,1,"ng-template",19)(18,at,1,1,"ng-template",20),t.k0s()(),t.j41(19,"td")(20,"p-cellEditor"),t.DNE(21,ct,1,2,"ng-template",19)(22,_t,1,1,"ng-template",20),t.k0s()(),t.j41(23,"td"),t.DNE(24,lt,1,0,"p-button",21)(25,rt,1,0,"p-button",41)(26,st,1,0,"p-button",23),t.j41(27,"p-button",36),t.bIt("click",function(n){const p=t.eBV(e).$implicit,c=t.XpG(2).$implicit,_=t.XpG();return t.Njj(_.confirmProductPackageRemoval(n,p,c))}),t.k0s()()()}if(2&o){const e=u.$implicit,i=u.editing;t.Y8G("pEditableRow",e),t.R7$(2),t.JRh(e.iD),t.R7$(22),t.Y8G("ngIf",!i),t.R7$(),t.Y8G("ngIf",i),t.R7$(),t.Y8G("ngIf",i)}}function dt(o,u){if(1&o&&(t.j41(0,"p-table",40,1),t.DNE(2,q,14,0,"ng-template",6)(3,mt,28,5,"ng-template",7),t.k0s()),2&o){const e=t.XpG().$implicit;t.Y8G("value",e.packages)}}function gt(o,u){if(1&o){const e=t.RV6();t.j41(0,"tr")(1,"td",38)(2,"button",4),t.bIt("click",function(){const n=t.eBV(e).$implicit,p=t.XpG();return t.Njj(p.addPackage(p.packageTable,n))}),t.EFF(3,"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0444\u0430\u0441\u043e\u0432\u043a\u0443"),t.k0s(),t.DNE(4,dt,4,1,"p-table",39),t.k0s()()}if(2&o){const e=u.$implicit;t.R7$(4),t.Y8G("ngIf",null==e.packages?null:e.packages.length)}}function ht(o,u){if(1&o&&(t.j41(0,"td"),t.nrm(1,"p-skeleton",46),t.k0s()),2&o){const e=u.$implicit,i=u.even;t.R7$(),t.Y8G("ngStyle",t.eq3(1,L,i?"year"===e.field?"30%":"40%":"60%"))}}function ft(o,u){if(1&o&&(t.j41(0,"tr",44),t.DNE(1,ht,2,3,"td",45),t.k0s()),2&o){const e=u.columns;t.R7$(),t.Y8G("ngForOf",e)}}function kt(o,u){if(1&o){const e=t.RV6();t.j41(0,"p-dialog",47),t.bIt("onHide",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.closeScannerDialog())}),t.mxI("visibleChange",function(n){t.eBV(e);const p=t.XpG();return t.DH7(p.showScanner,n)||(p.showScanner=n),t.Njj(n)}),t.j41(1,"div")(2,"zxing-scanner",48),t.bIt("deviceChange",function(n){t.eBV(e);const p=t.XpG();return t.Njj(p.onDeviceChange(n))})("scanSuccess",function(n){t.eBV(e);const p=t.XpG();return t.Njj(p.onCodeResult(n))})("permissionResponse",function(n){t.eBV(e);const p=t.XpG();return t.Njj(p.onHasPermission(n))})("camerasFound",function(n){t.eBV(e);const p=t.XpG();return t.Njj(p.onCamerasFound(n))}),t.k0s()(),t.j41(3,"div"),t.EFF(4),t.k0s()()}if(2&o){let e;const i=t.XpG();t.Aen(t.lJ4(9,N)),t.R50("visible",i.showScanner),t.Y8G("modal",!0)("resizable",!1),t.R7$(2),t.Y8G("torch",!0)("device",i.deviceCurrent)("tryHarder",!0),t.R7$(2),t.SpI(" QR-\u043a\u043e\u0434: ",null!==(e=i.qrResultString)&&void 0!==e?e:"-"," ")}}const Ct=[{path:"",component:(()=>{class o extends j.x{constructor(e,i,n,p){super(p),this.productService=e,this.messageService=i,this.confirmationService=n,this.totalRecords=0,this.newProductName="",this.formatsEnabled=[g.BarcodeFormat.CODE_128,g.BarcodeFormat.DATA_MATRIX,g.BarcodeFormat.EAN_13,g.BarcodeFormat.QR_CODE],this.editMode=!1}onHasPermission(e){this.hasPermission=e}onDeviceChange(e){const i=e?.deviceId||"";this.deviceSelected!==i&&(this.deviceSelected=i,this.deviceCurrent=e||void 0)}ngOnInit(){this.titleService.setTitle("\u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0442\u043e\u0432\u0430\u0440\u0430\u043c\u0438")}findProducts(e){this.productService.findProducts(e).pipe((0,r.W)(i=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430",severity:"error",detail:i}),s.w))).subscribe(i=>{this.data=i.items,this.totalRecords=i.totalCount})}onDataLazyLoad(e){const i=new m.D.FindProductsModel({offset:e.first,count:e.rows});if(this.fillFilterModel(i,e.filters),e.sortField){switch(e.sortField){case"name":i.orderField=m.D.FindProductsModelSortField.Name;break;case"iD":i.orderField=m.D.FindProductsModelSortField.ID}i.orderAscending=e.sortOrder>0}this.findProducts(i)}fillFilterModel(e,i){e.name=i.name?.value;const n=+i.iD?.value;e.iD=n>0?n:null}onProductEditInit(e,i){const n=this.editingProduct;this.editMode=!0;const p=i;p._edit={},Object.assign(p._edit,i,{_edit:void 0}),this.editingProduct={...i},n&&n!=i&&(e.cancelRowEdit(n),this.onProductEditCancel(n))}onProductEditSave(e,i){const n=i;0===i.iD?this.productService.addProduct(i).pipe((0,r.W)(p=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0442\u043e\u0432\u0430\u0440\u0430",severity:"error",detail:p}),s.w))).subscribe(p=>{i.iD=p,this.messageService.add({summary:"\u0422\u043e\u0432\u0430\u0440 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d",severity:"success"})}):this.productService.updateProduct(i).pipe((0,r.W)(p=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0442\u043e\u0432\u0430\u0440\u0430",severity:"error",detail:p}),s.w))).subscribe(()=>{this.messageService.add({summary:"\u0422\u043e\u0432\u0430\u0440 \u043e\u0431\u043d\u043e\u0432\u043b\u0451\u043d",severity:"success"}),e.cancelRowEdit(n),n._edit=void 0,this.editMode=!1})}onProductEditCancel(e){e&&(e.iD||this.data.splice(this.data.findIndex(i=>i==e),1),e._edit=void 0)}onPackageEditInit(e,i,n){void 0!==this.editingPackageIndex&&this.editingPackageIndex!=n&&(e.cancelRowEdit(this.editingPackage),this.onPackageEditCancel(e,this.editingPackageIndex)),this.editingPackageIndex=n,this.editingPackage={...i}}onPackageEditSave(e){0===e.iD?this.productService.addProductPackage(e).pipe((0,r.W)(i=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0444\u0430\u0441\u043e\u0432\u043a\u0438 \u0442\u043e\u0432\u0430\u0440\u0430",severity:"error",detail:i}),s.w))).subscribe(i=>{e.iD=i.iD,this.messageService.add({summary:"\u0424\u0430\u0441\u043e\u0432\u043a\u0430 \u0442\u043e\u0432\u0430\u0440\u0430 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0430",severity:"success"})}):this.productService.updateProductPackage(e).pipe((0,r.W)(i=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0444\u0430\u0441\u043e\u0432\u043a\u0438 \u0442\u043e\u0432\u0430\u0440\u0430",severity:"error",detail:i}),s.w))).subscribe(()=>{this.messageService.add({summary:"\u0424\u0430\u0441\u043e\u0432\u043a\u0430 \u0442\u043e\u0432\u0430\u0440\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0430",severity:"success"})})}onPackageEditCancel(e,i){e.value[i]=this.editingPackage,this.editingPackageIndex=void 0}addPackage(e,i){i.packages??=[];const n=new m.D.ProductPackage({iD:0,productCount:1,name:i.name,productID:i.iD,supplyPreparationTimeInDays:0,minimumWarehouseStock:0,product:null});i.packages.push(n),e.initRowEdit(n)}addProduct(e){const i=new m.D.Product({iD:0,categoryID:1,name:this.newProductName,stockAmount:0,category:null,packages:[]});this.data.unshift(i),this.onProductEditInit(e,i),e.initRowEdit(i)}confirmProductRemoval(e,i){this.confirmationService.confirm({target:e.target,message:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0442\u043e\u0432\u0430\u0440?",header:"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u0435 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f",icon:"pi pi-exclamation-triangle text-red-500",rejectIcon:"none",rejectButtonStyleClass:"p-button-text",defaultFocus:"none",accept:()=>{this.removeProduct(i)}})}removeProduct(e){this.productService.removeProduct(e.iD).pipe((0,r.W)(i=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u0442\u043e\u0432\u0430\u0440\u0430",severity:"error",detail:i}),s.w))).subscribe(()=>{const i=this.data.indexOf(e);this.data.splice(i,1),this.messageService.add({summary:"\u0422\u043e\u0432\u0430\u0440 \u0443\u0434\u0430\u043b\u0451\u043d",severity:"success"})})}confirmProductPackageRemoval(e,i,n){this.confirmationService.confirm({target:e.target,message:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0444\u0430\u0441\u043e\u0432\u043a\u0443 \u0442\u043e\u0432\u0430\u0440\u0430??",header:"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u0435 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f",icon:"pi pi-exclamation-triangle",acceptIcon:"none",rejectIcon:"none",rejectButtonStyleClass:"p-button-text",accept:()=>{this.removeProductPackage(i,n)}})}removeProductPackage(e,i){this.productService.removeProductPackage(e.iD).pipe((0,r.W)(n=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u0444\u0430\u0441\u043e\u0432\u043a\u0438",severity:"error",detail:n}),s.w))).subscribe(()=>{const n=i.packages.indexOf(e);i.packages.splice(n,1),this.messageService.add({summary:"\u0424\u0430\u0441\u043e\u0432\u043a\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u0430",severity:"success"})})}onCamerasFound(e){this.availableDevices=e,this.hasDevices=!(!e||!e.length)}onCodeResult(e){this.qrResultString=e}closeScannerDialog(){this.showScanner=!1}static{this.\u0275fac=function(i){return new(i||o)(t.rXU(P.b),t.rXU(h.bg),t.rXU(h.td),t.rXU(E.hE))}}static{this.\u0275cmp=t.VBU({type:o,selectors:[["app-product-list"]],features:[t.Vt3],decls:13,vars:15,consts:[["productTable",""],["packageTable",""],[1,"flex"],["pInputText","","placeholder","\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435","type","text",3,"ngModelChange","ngModel"],["pButton","",3,"click"],["dataKey","iD","editMode","row","sortField","name",3,"onLazyLoad","globalFilterFields","lazy","loading","paginator","rowsPerPageOptions","rows","sortOrder","tableStyle","totalRecords","value"],["pTemplate","header"],["pTemplate","body"],["pTemplate","rowexpansion"],["pTemplate","loadingbody"],["header","\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0434\u0430\u0448\u0431\u043e\u0440\u0434\u0430",3,"visible","modal","resizable","style","onHide","visibleChange",4,"ngIf"],["pSortableColumn","iD"],["field","iD"],["pSortableColumn","name"],["field","name"],["field","iD","type","text"],["field","name","type","text"],[3,"pEditableRow"],["icon","pi pi-dollar",3,"click",4,"ngIf"],["pTemplate","input"],["pTemplate","output"],["icon","pi pi-pencil","pInitEditableRow","","pRipple","","type","button",3,"click",4,"ngIf"],["icon","pi pi-check","pRipple","","type","button",3,"click",4,"ngIf"],["icon","pi pi-times","pCancelEditableRow","","pRipple","","type","button",3,"click",4,"ngIf"],["icon","pi pi-trash","pRipple","","styleClass","p-button-danger","type","button",3,"click",4,"ngIf"],["class","p-button-text p-button-rounded p-button-plain","pButton","","pRipple","","type","button",3,"icon","pRowToggler",4,"ngIf"],["icon","pi pi-dollar",3,"click"],["pInputText","","type","text",3,"ngModelChange","ngModel"],["placeholder","\u0428\u0438\u0440\u0438\u043d\u0430",3,"ngModelChange","ngModel"],["placeholder","\u0412\u044b\u0441\u043e\u0442\u0430",3,"ngModelChange","ngModel"],["placeholder","\u0413\u043b\u0443\u0431\u0438\u043d\u0430",3,"ngModelChange","ngModel"],["placeholder","\u0412\u0435\u0441",3,"ngModelChange","ngModel"],[1,"flex","white-space-nowrap"],["icon","pi pi-pencil","pInitEditableRow","","pRipple","","type","button",3,"click"],["icon","pi pi-check","pRipple","","type","button",3,"click"],["icon","pi pi-times","pCancelEditableRow","","pRipple","","type","button",3,"click"],["icon","pi pi-trash","pRipple","","styleClass","p-button-danger","type","button",3,"click"],["pButton","","pRipple","","type","button",1,"p-button-text","p-button-rounded","p-button-plain",3,"icon","pRowToggler"],["colspan","6"],["dataKey","iD","editMode","row",3,"value",4,"ngIf"],["dataKey","iD","editMode","row",3,"value"],["icon","pi pi-check","pRipple","","pSaveEditableRow","","type","button",3,"click",4,"ngIf"],["type","text",3,"ngModelChange","ngModel","useGrouping"],["icon","pi pi-check","pRipple","","pSaveEditableRow","","type","button",3,"click"],[2,"height","46px"],[4,"ngFor","ngForOf"],[3,"ngStyle"],["header","\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u0434\u0430\u0448\u0431\u043e\u0440\u0434\u0430",3,"onHide","visibleChange","visible","modal","resizable"],[3,"deviceChange","scanSuccess","permissionResponse","camerasFound","torch","device","tryHarder"]],template:function(i,n){if(1&i){const p=t.RV6();t.nrm(0,"p-toast")(1,"p-confirmDialog"),t.j41(2,"div",2)(3,"input",3),t.mxI("ngModelChange",function(_){return t.eBV(p),t.DH7(n.newProductName,_)||(n.newProductName=_),t.Njj(_)}),t.k0s(),t.j41(4,"button",4),t.bIt("click",function(){t.eBV(p);const _=t.sdS(7);return t.Njj(n.addProduct(_))}),t.EFF(5,"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0442\u043e\u0432\u0430\u0440"),t.k0s()(),t.j41(6,"p-table",5,0),t.bIt("onLazyLoad",function(_){return t.eBV(p),t.Njj(n.onDataLazyLoad(_))}),t.DNE(8,X,25,0,"ng-template",6)(9,Z,27,8,"ng-template",7)(10,gt,5,1,"ng-template",8)(11,ft,2,1,"ng-template",9),t.k0s(),t.DNE(12,kt,5,10,"p-dialog",10)}2&i&&(t.R7$(3),t.R50("ngModel",n.newProductName),t.R7$(3),t.Y8G("globalFilterFields",t.lJ4(12,y))("lazy",!0)("loading",n.loading)("paginator",!0)("rowsPerPageOptions",t.lJ4(13,S))("rows",10)("sortOrder",1)("tableStyle",t.lJ4(14,v))("totalRecords",n.totalRecords)("value",n.data),t.R7$(6),t.Y8G("ngIf",n.showScanner))},dependencies:[M.l,h.Ei,f.me,f.BC,f.vS,d.Sq,d.bT,d.B3,l.XI,l.Tg,l.FP,l.c5,l.yc,l.Xk,l.Hd,l.E7,l.Tf,l.rl,F.y8,b._f,b.$n,G.S,R.M,D.YI,x.S,I.T,T.M]})}}return o})()}];let bt=(()=>{class o{static{this.\u0275fac=function(i){return new(i||o)}}static{this.\u0275mod=t.$C({type:o})}static{this.\u0275inj=t.G2t({imports:[C.iI.forChild(Ct),C.iI]})}}return o})(),jt=(()=>{class o{static{this.\u0275fac=function(i){return new(i||o)}}static{this.\u0275mod=t.$C({type:o})}static{this.\u0275inj=t.G2t({imports:[d.MD,bt]})}}return o})()}}]);