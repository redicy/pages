"use strict";(self.webpackChunkseller=self.webpackChunkseller||[]).push([[515],{6437:(n0,fi,Fe)=>{Fe.r(fi),Fe.d(fi,{PurchaseModule:()=>Qy});var Oe=Fe(177),Ye=Fe(2115),Or=Fe(2180),Fr=Fe(4412),Fn=Fe(5964),ui=Fe(3294),rn=Fe(152),nn=Fe(5558),Le=Fe(9437),Nt=Fe(983),At=Fe(4153),a=Fe(4438),it=Fe(6557),Qe=Fe(4238),Ze=Fe(5779),Ut=Fe(345),Ri=Fe(8537),Gr=Fe(1141),Fa=Fe(5430),nr=Fe(9417),Oi=Fe(2242),jr=Fe(544),hi=Fe(9998);const gf=["productPackageAutocomplete"],ff=()=>["/purchase/edit"],uf=()=>[10,25,50],hf=()=>({"min-width":"75rem"}),a0=e=>({id:e}),Cf=e=>["summary",e],If=e=>["edit",e];function Af(e,r){if(1&e&&(a.j41(0,"div"),a.EFF(1),a.k0s()),2&e){const t=r.$implicit;a.R7$(),a.Lme("",t.iD,": ",t.name,"")}}function pf(e,r){if(1&e&&(a.j41(0,"div"),a.EFF(1),a.k0s()),2&e){const t=r.$implicit;a.R7$(),a.Lme("",t.iD,": ",t.name,"")}}function df(e,r){if(1&e&&(a.j41(0,"div"),a.EFF(1),a.k0s()),2&e){const t=r.$implicit;a.R7$(),a.Lme("",t.iD,": ",t.name,"")}}function mf(e,r){if(1&e){const t=a.RV6();a.j41(0,"tr")(1,"th")(2,"button",8),a.bIt("click",function(){a.eBV(t);const i=a.XpG(2);return a.Njj(i.toggleCheckedBatches())}),a.k0s()(),a.j41(3,"th"),a.EFF(4," \u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435 "),a.k0s(),a.j41(5,"th"),a.EFF(6,"\u0414\u0430\u0442\u0430"),a.k0s(),a.j41(7,"th"),a.EFF(8,"\u0421\u0442\u0430\u0442\u0443\u0441"),a.k0s(),a.j41(9,"th"),a.EFF(10,"\u0422\u043e\u0432\u0430\u0440\u044b"),a.k0s(),a.nrm(11,"th"),a.k0s(),a.j41(12,"tr"),a.nrm(13,"th"),a.j41(14,"th")(15,"input",9),a.nI1(16,"async"),a.bIt("ngModelChange",function(i){a.eBV(t);const s=a.XpG(2);return a.Njj(s.batchNameFilterSubject.next(i))}),a.k0s()(),a.nrm(17,"th")(18,"th"),a.j41(19,"th")(20,"p-autoComplete",10,0),a.bIt("completeMethod",function(i){a.eBV(t);const s=a.XpG(2);return a.Njj(s.findBatchProductsByName(i))})("onSelect",function(i){a.eBV(t);const s=a.XpG(2);return a.Njj(s.addProductFilter(i))})("onUnselect",function(i){a.eBV(t);const s=a.XpG(2);return a.Njj(s.removeProductFilter(i))})("onBlur",function(){a.eBV(t);const i=a.XpG(2);return a.Njj(i.updateProductFilter())})("onClear",function(){a.eBV(t);const i=a.XpG(2);return a.Njj(i.clearProductFilter())}),a.DNE(22,Af,2,2,"ng-template",11)(23,pf,2,2,"ng-template",12)(24,df,2,2,"ng-template",13),a.k0s()(),a.nrm(25,"th"),a.k0s()}if(2&e){const t=a.XpG(2);a.R7$(2),a.Y8G("icon",null==t.allBatchesChecked?"pi pi-question":t.allBatchesChecked?"pi pi-check":"pi pi-minus")("rounded",!0)("text",!0),a.R7$(13),a.Y8G("ngModel",a.bMT(16,9,t.batchNameFilterSubject)),a.R7$(5),a.Y8G("group",!0)("minLength",3)("multiple",!0)("showClear",!0)("suggestions",t.batchProducts)}}function _f(e,r){if(1&e&&(a.j41(0,"li"),a.EFF(1),a.k0s()),2&e){const t=r.$implicit;a.R7$(),a.SpI(" ",t.value.name," ")}}function xf(e,r){if(1&e){const t=a.RV6();a.j41(0,"tr")(1,"td")(2,"p-checkbox",14),a.bIt("click",function(){a.eBV(t);const i=a.XpG(2);return a.Njj(i.changeBatchCheckedState())}),a.mxI("ngModelChange",function(i){a.eBV(t);const s=a.XpG(2);return a.DH7(s.checkedBatches,i)||(s.checkedBatches=i),a.Njj(i)}),a.k0s()(),a.j41(3,"td"),a.EFF(4),a.k0s(),a.j41(5,"td"),a.EFF(6),a.nI1(7,"date"),a.k0s(),a.j41(8,"td"),a.EFF(9),a.k0s(),a.j41(10,"td")(11,"ul"),a.DNE(12,_f,2,1,"li",15),a.nI1(13,"keyvalue"),a.k0s()(),a.j41(14,"td"),a.nrm(15,"p-button",16)(16,"p-button",17),a.k0s()()}if(2&e){const t=r.$implicit,n=a.XpG(2);a.R7$(2),a.R50("ngModel",n.checkedBatches),a.Y8G("value",t.iD),a.R7$(2),a.JRh(t.name),a.R7$(2),a.JRh(a.i5U(7,8,t.date,"y-MM-dd")),a.R7$(3),a.JRh(t.status),a.R7$(3),a.Y8G("ngForOf",a.bMT(13,11,t.products)),a.R7$(3),a.Y8G("routerLink",a.eq3(15,Cf,a.eq3(13,a0,t.iD))),a.R7$(),a.Y8G("routerLink",a.eq3(19,If,a.eq3(17,a0,t.iD)))}}function vf(e,r){if(1&e){const t=a.RV6();a.j41(0,"p-table",5),a.bIt("onPage",function(i){a.eBV(t);const s=a.XpG();return a.Njj(s.pageChange(i))}),a.DNE(1,mf,26,11,"ng-template",6)(2,xf,17,21,"ng-template",7),a.k0s()}if(2&e){const t=a.XpG();a.Y8G("lazy",!0)("loading",t.loading)("paginator",!0)("rowsPerPageOptions",a.lJ4(8,uf))("rows",t.filterModel.count)("tableStyle",a.lJ4(9,hf))("totalRecords",t.totalRecords)("value",t.data)}}let kf=(()=>{class e extends Or.x{static{this.FilterID="PurchaseListComponent"}constructor(t,n,i,s,o){super(o),this.productBatchService=t,this.purchaseBatchCommandHandlerClient=n,this.dbService=i,this.messageService=s,this.data=[],this.loading=!0,this.totalRecords=0,this.findModelSubject=new Fr.t(null),this.checkedBatches=[],this.allBatchesChecked=!1,this.filterModel={offset:0,count:10},this.batchProducts=[],this.batchNameFilterSubject=new Fr.t(null),this.productPackageIDs=[]}ngOnInit(){this.titleService.setTitle("\u0423\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0437\u0430\u043a\u0443\u043f\u043a\u0430\u043c\u0438"),this.batchNameFilterSubject.pipe((0,Fn.p)(t=>!!t&&t.length>=3)).pipe((0,ui.F)()).pipe((0,rn.B)(500)).subscribe(t=>{this.filterModel.name=t,this.findBatches()}),this.findModelSubject.pipe((0,Fn.p)(t=>!!t)).pipe((0,nn.n)(t=>{const i=Object.assign({},t,{offset:0,name:void 0,article:void 0,dateFrom:void 0,dateTo:void 0,productPackageIDs:[]});return this.dbService.update("filters",{id:e.FilterID,data:i}).pipe((0,Le.W)(o=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043a",severity:"error",detail:o}),Nt.w))).subscribe(),this.productBatchService.findPurchaseBatches(new At.D.FindPurchaseBatchesModel(t)).pipe((0,Le.W)(o=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0441\u043f\u0438\u0441\u043a\u0430 \u0437\u0430\u043a\u0443\u043f\u043e\u043a",severity:"error",detail:o}),this.loading=!1,Nt.w)))})).subscribe(t=>{this.checkedBatches=[],this.allBatchesChecked=!1,this.totalRecords=t.totalCount,this.data=t.items.map(n=>{const i=n;return i.products=n.items.reduce((s,o)=>o.salesItems.reduce((l,g)=>l.set(g.productPackageID,g.productPackage),s),new Map),i}),this.loading=!1}),this.dbService.getByID("filters",e.FilterID).subscribe(t=>{const n={count:50,offset:0,excludeCandidates:!1,includeProduct:!0,excludeDeleted:!0};t?.data&&Object.assign(n,t.data),this.filterModel=n,this.findModelSubject.next(this.filterModel)})}pageChange(t){(this.filterModel.count!=t.rows||this.filterModel.offset!=t.first)&&(this.filterModel.offset=t.first,this.filterModel.count=t.rows,this.findModelSubject.next(this.filterModel))}removeCheckedBatches(){this.checkedBatches.length&&this.purchaseBatchCommandHandlerClient.deletePurchaseBatches(this.checkedBatches).pipe((0,Le.W)(t=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u0437\u0430\u043a\u0443\u043f\u043e\u043a",severity:"error",detail:t}),this.loading=!1,Nt.w))).subscribe(()=>{this.checkedBatches=[],this.messageService.add({summary:"\u0417\u0430\u043a\u0443\u043f\u043a\u0438 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0443\u0434\u0430\u043b\u0435\u043d\u044b",severity:"success"}),this.loading=!1,this.findBatches()})}findBatches(t=void 0){void 0===t&&((t=this.filterModel).productPackageIDs=[...this.productPackageIDs]),this.findModelSubject.next(new At.D.FindPurchaseBatchesModel(t))}toggleCheckedBatches(){const t=!1===this.allBatchesChecked;this.allBatchesChecked=t,this.checkedBatches=t?this.data.map(n=>n.iD):[]}changeBatchCheckedState(){this.allBatchesChecked=!!this.checkedBatches.length&&(this.checkedBatches.length==this.data.length||null)}findBatchProductsByName(t){this.productBatchService.findPurchaseBatchProductPackages(new At.D.FindPurchaseBatchProductPackagesModel({name:t.query,count:10})).pipe((0,Le.W)(n=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0441\u043f\u0438\u0441\u043a\u0430 \u0442\u043e\u0432\u0430\u0440\u043e\u0432",severity:"error",detail:n}),Nt.w))).subscribe(n=>{this.batchProducts=n})}removeProductFilter(t){const n=t.value;if(n){const i=new Set(this.productPackageIDs);i.delete(n.iD),this.productPackageIDs=[...i]}}addProductFilter(t){const n=t.value;if(n){const i=new Set(this.productPackageIDs);i.add(n.iD),this.productPackageIDs=[...i]}}clearProductFilter(){this.productPackageIDs=[],this.findBatches()}updateProductFilter(){this.findBatches()}static{this.\u0275fac=function(n){return new(n||e)(a.rXU(At.D.PurchaseBatchClient),a.rXU(it.X.PurchaseBatchClient),a.rXU(Qe.MX),a.rXU(Ze.bg),a.rXU(Ut.hE))}}static{this.\u0275cmp=a.VBU({type:e,selectors:[["app-purchase-list"]],viewQuery:function(n,i){if(1&n&&a.GBs(gf,5),2&n){let s;a.mGM(s=a.lsd())&&(i.productPackageAutocomplete=s.first)}},features:[a.Vt3],decls:9,vars:4,consts:[["productPackageAutocomplete",""],[1,"flex","gap-2"],[3,"routerLink"],["severity","danger",3,"click","disabled"],["dataKey","iD",3,"lazy","loading","paginator","rowsPerPageOptions","rows","tableStyle","totalRecords","value","onPage",4,"ngIf"],["dataKey","iD",3,"onPage","lazy","loading","paginator","rowsPerPageOptions","rows","tableStyle","totalRecords","value"],["pTemplate","header"],["pTemplate","body"],["pButton","","size","small",3,"click","icon","rounded","text"],["pInputText","",3,"ngModelChange","ngModel"],["attachTo","body","optionGroupChildren","packages","placeholder","\u041f\u043e\u0438\u0441\u043a \u0442\u043e\u0432\u0430\u0440\u0430","styleClass","mb-3",3,"completeMethod","onSelect","onUnselect","onBlur","onClear","group","minLength","multiple","showClear","suggestions"],["pTemplate","group"],["pTemplate","selectedItem"],["pTemplate","item"],["name","batches","styleClass","ml-3",3,"click","ngModelChange","ngModel","value"],[4,"ngFor","ngForOf"],["icon","pi pi-dollar",3,"routerLink"],["icon","pi pi-pencil",3,"routerLink"]],template:function(n,i){1&n&&(a.nrm(0,"p-toast"),a.j41(1,"h1"),a.EFF(2,"\u0417\u0430\u043a\u0443\u043f\u043a\u0438"),a.k0s(),a.j41(3,"div",1)(4,"p-button",2),a.EFF(5,"\u041d\u043e\u0432\u0430\u044f"),a.k0s(),a.j41(6,"p-button",3),a.bIt("click",function(){return i.removeCheckedBatches()}),a.EFF(7,"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0435 "),a.k0s()(),a.DNE(8,vf,3,10,"p-table",4)),2&n&&(a.R7$(4),a.Y8G("routerLink",a.lJ4(3,ff)),a.R7$(2),a.Y8G("disabled",!(null!=i.checkedBatches&&i.checkedBatches.length)),a.R7$(2),a.Y8G("ngIf",i.data))},dependencies:[Ze.Ei,Ri.j9,Gr._f,Gr.$n,Fa.Sc,Oe.Sq,Oe.bT,nr.me,nr.BC,nr.vS,Oi.S,Ye.Wk,jr.XI,hi.y8,Oe.Jj,Oe.vh,Oe.lG]})}}return e})();var s0=Fe(1413),Da=Fe(6977),o0=Fe(8141);let Na=(()=>{class e{constructor(t,n,i,s){this.packageTypeClient=t,this.packageTypeCommandHandlerClient=n,this.messageService=i,this.purchaseClient=s,this.packageTypes=new Fr.t([]),this.packageTypeClient.getPackageTypes().pipe((0,Le.W)(o=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0441\u043f\u0438\u0441\u043a\u0430 \u0442\u0438\u043f\u043e\u0432 \u0443\u043f\u0430\u043a\u043e\u0432\u043a\u0438",severity:"error",detail:o}),Nt.w))).subscribe(o=>{this.packageTypes.next(o)})}getBatch(t){return this.purchaseClient.getPurchaseBatch(t)}getSalesPlanSelfCost(t,n,i){const s=this.getSalesItemCosts(t),o=+n.returnCost*+n.returnPercentage/100,l=n.amount?+n.marketingBudget/n.amount:0,g=n.amount?Math.ceil(100*+n.deliveryCost/+n.amount)/100:0;return i.price+s+o+g+l}getPackageTypes(){return this.packageTypes.value}getPackageType(t){return this.packageTypes.value.find(n=>n.iD==t)}getSalesItemCosts(t){let n=0;for(const i of t.salesItemPackages)n+=Math.ceil(i.pricePerUom*i.amount*100)/100;return n+=t.packagingPrice,n=Math.ceil(100*n)/100,n}getSalesPlanCommission(t){return Math.ceil(+t.commissionMultiplier*+t.price)/100+ +t.commissionAddition}calcPlans(){this.purchaseClient.calcSalesPlans().pipe((0,Le.W)(t=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0441\u043f\u0438\u0441\u043a\u0430 \u0442\u0438\u043f\u043e\u0432 \u0443\u043f\u0430\u043a\u043e\u0432\u043a\u0438",severity:"error",detail:t}),Nt.w))).subscribe(()=>{this.messageService.add({summary:"\u0423\u0441\u043f\u0435\u0445",severity:"success",detail:"\u041f\u0435\u0440\u0435\u0440\u0430\u0441\u0447\u0451\u0442 \u043f\u043b\u0430\u043d\u043e\u0432 \u043f\u0440\u043e\u0434\u0430\u0436 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0432\u0435\u0440\u0448\u0451\u043d"})})}getSalesPlansSummaries(t){return this.purchaseClient.getSalesPlansSummaries(t)}addPackageType(t){return this.packageTypeCommandHandlerClient.addPackageType(t)}updatePackageType(t){return this.packageTypeCommandHandlerClient.updatePackageType(t).pipe((0,o0.M)(()=>{this.packageTypes.next(this.packageTypes.value.map(n=>n.iD==t.iD?t:n))}))}removePackageType(t){return this.packageTypeCommandHandlerClient.removePackageType(t).pipe((0,o0.M)(()=>{this.packageTypes.next(this.packageTypes.value.filter(n=>n.iD!=t))}))}static{this.\u0275fac=function(n){return new(n||e)(a.KVO(At.D.PackageTypeClient),a.KVO(it.X.PackageTypeClient),a.KVO(Ze.bg),a.KVO(At.D.PurchaseBatchClient))}}static{this.\u0275prov=a.jDH({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var Bi=Fe(2637),ws=Fe(612),ys=Fe(6781),Pa=Fe(8833),Ra=Fe(1802),qe=Fe(1455),l0=Fe(8148),Oa=Fe(8807),Ba=Fe(1512),Mi=Fe(563),Ma=Fe(8542),pn=Fe(4420);const c0=["*"];function wf(e,r){1&e&&a.eu8(0)}function yf(e,r){if(1&e&&(a.qex(0),a.DNE(1,wf,1,0,"ng-container",3),a.bVm()),2&e){const t=a.XpG(2);a.R7$(),a.Y8G("ngTemplateOutlet",t.contentTemplate)}}function Tf(e,r){if(1&e&&(a.j41(0,"div",1),a.SdG(1),a.DNE(2,yf,2,1,"ng-container",2),a.k0s()),2&e){const t=a.XpG();a.Y8G("hidden",!t.selected),a.BMQ("id",t.tabView.getTabContentId(t.id))("aria-hidden",!t.selected)("aria-labelledby",t.tabView.getTabHeaderActionId(t.id))("data-pc-name","tabpanel"),a.R7$(2),a.Y8G("ngIf",t.contentTemplate&&(t.cache?t.loaded:t.selected))}}const Sf=["content"],bf=["navbar"],Ef=["prevBtn"],Ff=["nextBtn"],Df=["inkbar"],Nf=["elementToObserve"],Pf=e=>({"p-tabview p-component":!0,"p-tabview-scrollable":e}),Rf=(e,r)=>({"p-highlight":e,"p-disabled":r});function Of(e,r){1&e&&a.nrm(0,"ChevronLeftIcon"),2&e&&a.BMQ("aria-hidden",!0)}function Bf(e,r){}function Mf(e,r){1&e&&a.DNE(0,Bf,0,0,"ng-template")}function Lf(e,r){if(1&e){const t=a.RV6();a.j41(0,"button",15,4),a.bIt("click",function(){a.eBV(t);const i=a.XpG();return a.Njj(i.navBackward())}),a.DNE(2,Of,1,1,"ChevronLeftIcon",16)(3,Mf,1,0,null,17),a.k0s()}if(2&e){const t=a.XpG();a.BMQ("tabindex",t.tabindex)("aria-label",t.prevButtonAriaLabel),a.R7$(2),a.Y8G("ngIf",!t.previousIconTemplate),a.R7$(),a.Y8G("ngTemplateOutlet",t.previousIconTemplate)}}function Uf(e,r){if(1&e&&a.nrm(0,"span",26),2&e){const t=a.XpG(3).$implicit;a.Y8G("ngClass",t.leftIcon)}}function Gf(e,r){}function jf(e,r){1&e&&a.DNE(0,Gf,0,0,"ng-template")}function Vf(e,r){if(1&e&&(a.j41(0,"span",27),a.DNE(1,jf,1,0,null,17),a.k0s()),2&e){const t=a.XpG(3).$implicit;a.R7$(),a.Y8G("ngTemplateOutlet",t.leftIconTemplate)}}function $f(e,r){if(1&e&&a.nrm(0,"span",28),2&e){const t=a.XpG(3).$implicit;a.Y8G("ngClass",t.rightIcon)}}function Wf(e,r){}function Xf(e,r){1&e&&a.DNE(0,Wf,0,0,"ng-template")}function zf(e,r){if(1&e&&(a.j41(0,"span",29),a.DNE(1,Xf,1,0,null,17),a.k0s()),2&e){const t=a.XpG(3).$implicit;a.R7$(),a.Y8G("ngTemplateOutlet",t.rightIconTemplate)}}function Hf(e,r){if(1&e&&(a.qex(0),a.DNE(1,Uf,1,1,"span",21)(2,Vf,2,1,"span",22),a.j41(3,"span",23),a.EFF(4),a.k0s(),a.DNE(5,$f,1,1,"span",24)(6,zf,2,1,"span",25),a.bVm()),2&e){const t=a.XpG(2).$implicit;a.R7$(),a.Y8G("ngIf",t.leftIcon&&!t.leftIconTemplate),a.R7$(),a.Y8G("ngIf",t.leftIconTemplate),a.R7$(2),a.JRh(t.header),a.R7$(),a.Y8G("ngIf",t.rightIcon&&!t.rightIconTemplate),a.R7$(),a.Y8G("ngIf",t.rightIconTemplate)}}function Yf(e,r){1&e&&a.eu8(0)}function Jf(e,r){if(1&e){const t=a.RV6();a.j41(0,"TimesIcon",32),a.bIt("click",function(i){a.eBV(t);const s=a.XpG(3).$implicit,o=a.XpG();return a.Njj(o.close(i,s))}),a.k0s()}2&e&&a.Y8G("styleClass","p-tabview-close")}function Kf(e,r){1&e&&a.nrm(0,"span",33)}function Zf(e,r){}function Qf(e,r){1&e&&a.DNE(0,Zf,0,0,"ng-template")}function qf(e,r){if(1&e&&(a.qex(0),a.DNE(1,Jf,1,1,"TimesIcon",30)(2,Kf,1,0,"span",31)(3,Qf,1,0,null,17),a.bVm()),2&e){const t=a.XpG(2).$implicit;a.R7$(),a.Y8G("ngIf",!t.closeIconTemplate),a.R7$(),a.Y8G("ngIf",t.closeIconTemplate),a.R7$(),a.Y8G("ngTemplateOutlet",t.closeIconTemplate)}}function eu(e,r){if(1&e){const t=a.RV6();a.j41(0,"li",19)(1,"a",20),a.bIt("click",function(i){a.eBV(t);const s=a.XpG().$implicit,o=a.XpG();return a.Njj(o.open(i,s))})("keydown",function(i){a.eBV(t);const s=a.XpG().$implicit,o=a.XpG();return a.Njj(o.onTabKeyDown(i,s))}),a.DNE(2,Hf,7,5,"ng-container",16)(3,Yf,1,0,"ng-container",17)(4,qf,4,3,"ng-container",16),a.k0s()()}if(2&e){const t=a.XpG(),n=t.$implicit,i=t.index,s=a.XpG();a.HbH(n.headerStyleClass),a.Y8G("ngClass",a.l_i(19,Rf,n.selected,n.disabled))("ngStyle",n.headerStyle),a.BMQ("data-p-disabled",n.disabled),a.R7$(),a.Y8G("pTooltip",n.tooltip)("tooltipPosition",n.tooltipPosition)("positionStyle",n.tooltipPositionStyle)("tooltipStyleClass",n.tooltipStyleClass),a.BMQ("id",s.getTabHeaderActionId(n.id))("aria-controls",s.getTabContentId(n.id))("aria-selected",n.selected)("tabindex",n.disabled||!n.selected?"-1":s.tabindex)("aria-disabled",n.disabled)("data-pc-index",i)("data-pc-section","headeraction"),a.R7$(),a.Y8G("ngIf",!n.headerTemplate),a.R7$(),a.Y8G("ngTemplateOutlet",n.headerTemplate),a.R7$(),a.Y8G("ngIf",n.closable)}}function tu(e,r){1&e&&a.DNE(0,eu,5,22,"li",18),2&e&&a.Y8G("ngIf",!r.$implicit.closed)}function ru(e,r){1&e&&a.nrm(0,"ChevronRightIcon"),2&e&&a.BMQ("aria-hidden",!0)}function nu(e,r){}function iu(e,r){1&e&&a.DNE(0,nu,0,0,"ng-template")}function au(e,r){if(1&e){const t=a.RV6();a.j41(0,"button",34,5),a.bIt("click",function(){a.eBV(t);const i=a.XpG();return a.Njj(i.navForward())}),a.DNE(2,ru,1,1,"ChevronRightIcon",16)(3,iu,1,0,null,17),a.k0s()}if(2&e){const t=a.XpG();a.BMQ("tabindex",t.tabindex)("aria-label",t.nextButtonAriaLabel),a.R7$(2),a.Y8G("ngIf",!t.nextIconTemplate),a.R7$(),a.Y8G("ngTemplateOutlet",t.nextIconTemplate)}}let g0=(()=>{class e{el;viewContainer;cd;closable=!1;get headerStyle(){return this._headerStyle}set headerStyle(t){this._headerStyle=t,this.tabView.cd.markForCheck()}get headerStyleClass(){return this._headerStyleClass}set headerStyleClass(t){this._headerStyleClass=t,this.tabView.cd.markForCheck()}cache=!0;tooltip;tooltipPosition="top";tooltipPositionStyle="absolute";tooltipStyleClass;get selected(){return!!this._selected}set selected(t){this._selected=t,this.loaded||this.cd.detectChanges(),t&&(this.loaded=!0)}get disabled(){return!!this._disabled}set disabled(t){this._disabled=t,this.tabView.cd.markForCheck()}get header(){return this._header}set header(t){this._header=t,Promise.resolve().then(()=>{this.tabView.updateInkBar(),this.tabView.cd.markForCheck()})}get leftIcon(){return this._leftIcon}set leftIcon(t){this._leftIcon=t,this.tabView.cd.markForCheck()}get rightIcon(){return this._rightIcon}set rightIcon(t){this._rightIcon=t,this.tabView.cd.markForCheck()}templates;closed=!1;view=null;_headerStyle;_headerStyleClass;_selected;_disabled;_header;_leftIcon;_rightIcon=void 0;loaded=!1;id;contentTemplate;headerTemplate;leftIconTemplate;rightIconTemplate;closeIconTemplate;tabView;constructor(t,n,i,s){this.el=n,this.viewContainer=i,this.cd=s,this.tabView=t,this.id=(0,pn._Y)()}ngAfterContentInit(){this.templates.forEach(t=>{switch(t.getType()){case"header":this.headerTemplate=t.template;break;case"content":default:this.contentTemplate=t.template;break;case"righticon":this.rightIconTemplate=t.template;break;case"lefticon":this.leftIconTemplate=t.template;break;case"closeicon":this.closeIconTemplate=t.template}})}ngOnDestroy(){this.view=null}static \u0275fac=function(n){return new(n||e)(a.rXU((0,a.Rfq)(()=>f0)),a.rXU(a.aKT),a.rXU(a.c1b),a.rXU(a.gRc))};static \u0275cmp=a.VBU({type:e,selectors:[["p-tabPanel"]],contentQueries:function(n,i,s){if(1&n&&a.wni(s,Ze.Ei,4),2&n){let o;a.mGM(o=a.lsd())&&(i.templates=o)}},hostAttrs:[1,"p-element"],inputs:{closable:[2,"closable","closable",a.L39],headerStyle:"headerStyle",headerStyleClass:"headerStyleClass",cache:[2,"cache","cache",a.L39],tooltip:"tooltip",tooltipPosition:"tooltipPosition",tooltipPositionStyle:"tooltipPositionStyle",tooltipStyleClass:"tooltipStyleClass",selected:"selected",disabled:"disabled",header:"header",leftIcon:"leftIcon",rightIcon:"rightIcon"},features:[a.GFd],ngContentSelectors:c0,decls:1,vars:1,consts:[["class","p-tabview-panel","role","tabpanel",3,"hidden",4,"ngIf"],["role","tabpanel",1,"p-tabview-panel",3,"hidden"],[4,"ngIf"],[4,"ngTemplateOutlet"]],template:function(n,i){1&n&&(a.NAR(),a.DNE(0,Tf,3,6,"div",0)),2&n&&a.Y8G("ngIf",!i.closed)},dependencies:[Oe.bT,Oe.T3],encapsulation:2})}return e})(),f0=(()=>{class e{platformId;el;cd;renderer;style;styleClass;controlClose;scrollable;get activeIndex(){return this._activeIndex}set activeIndex(t){this._activeIndex=t,this.preventActiveIndexPropagation?this.preventActiveIndexPropagation=!1:this.tabs&&this.tabs.length&&null!=this._activeIndex&&this.tabs.length>this._activeIndex&&(this.findSelectedTab().selected=!1,this.tabs[this._activeIndex].selected=!0,this.tabChanged=!0,this.updateScrollBar(t))}selectOnFocus=!1;nextButtonAriaLabel;prevButtonAriaLabel;autoHideButtons=!0;tabindex=0;onChange=new a.bkB;onClose=new a.bkB;activeIndexChange=new a.bkB;content;navbar;prevBtn;nextBtn;inkbar;tabPanels;templates;initialized;tabs;_activeIndex;preventActiveIndexPropagation;tabChanged;backwardIsDisabled=!0;forwardIsDisabled=!1;tabChangesSubscription;nextIconTemplate;previousIconTemplate;resizeObserver;container;list;buttonVisible;elementToObserve;constructor(t,n,i,s){this.platformId=t,this.el=n,this.cd=i,this.renderer=s}ngAfterContentInit(){this.initTabs(),this.tabChangesSubscription=this.tabPanels.changes.subscribe(t=>{this.initTabs(),this.refreshButtonState(),this.callResizeObserver()}),this.templates.forEach(t=>{switch(t.getType()){case"previousicon":this.previousIconTemplate=t.template;break;case"nexticon":this.nextIconTemplate=t.template}})}callResizeObserver(){(0,Oe.UE)(this.platformId)&&this.autoHideButtons&&this.bindResizeObserver()}ngAfterViewInit(){this.callResizeObserver()}bindResizeObserver(){this.container=qe.D.findSingle(this.el.nativeElement,'[data-pc-section="navcontent"]'),this.list=qe.D.findSingle(this.el.nativeElement,'[data-pc-section="nav"]'),this.resizeObserver=new ResizeObserver(()=>{this.buttonVisible=this.list.offsetWidth>=this.container.offsetWidth,this.updateButtonState(),this.cd.detectChanges()}),this.resizeObserver.observe(this.container)}unbindResizeObserver(){this.resizeObserver.unobserve(this.elementToObserve.nativeElement),this.resizeObserver=null}ngAfterViewChecked(){(0,Oe.UE)(this.platformId)&&this.tabChanged&&(this.updateInkBar(),this.tabChanged=!1)}ngOnDestroy(){this.tabChangesSubscription&&this.tabChangesSubscription.unsubscribe(),this.resizeObserver&&this.unbindResizeObserver()}getTabHeaderActionId(t){return`${t}_header_action`}getTabContentId(t){return`${t}_content`}initTabs(){this.tabs=this.tabPanels.toArray(),!this.findSelectedTab()&&this.tabs.length&&(null!=this.activeIndex&&this.tabs.length>this.activeIndex?this.tabs[this.activeIndex].selected=!0:this.tabs[0].selected=!0,this.tabChanged=!0),this.cd.markForCheck()}onTabKeyDown(t,n){switch(t.code){case"ArrowLeft":this.onTabArrowLeftKey(t);break;case"ArrowRight":this.onTabArrowRightKey(t);break;case"Home":case"PageUp":this.onTabHomeKey(t);break;case"End":case"PageDown":this.onTabEndKey(t);break;case"Enter":case"Space":this.open(t,n)}}onTabArrowLeftKey(t){const n=this.findPrevHeaderAction(t.target.parentElement),i=qe.D.getAttribute(n,"data-pc-index");n?this.changeFocusedTab(t,n,i):this.onTabEndKey(t),t.preventDefault()}onTabArrowRightKey(t){const n=this.findNextHeaderAction(t.target.parentElement),i=qe.D.getAttribute(n,"data-pc-index");n?this.changeFocusedTab(t,n,i):this.onTabHomeKey(t),t.preventDefault()}onTabHomeKey(t){const n=this.findFirstHeaderAction(),i=qe.D.getAttribute(n,"data-pc-index");this.changeFocusedTab(t,n,i),t.preventDefault()}onTabEndKey(t){const n=this.findLastHeaderAction(),i=qe.D.getAttribute(n,"data-pc-index");this.changeFocusedTab(t,n,i),t.preventDefault()}changeFocusedTab(t,n,i){n&&(qe.D.focus(n),n.scrollIntoView({block:"nearest"}),this.selectOnFocus)&&this.open(t,this.tabs[i])}findNextHeaderAction(t,n=!1){const i=n?t:t.nextElementSibling;return i?qe.D.getAttribute(i,"data-p-disabled")||"inkbar"===qe.D.getAttribute(i,"data-pc-section")?this.findNextHeaderAction(i):qe.D.findSingle(i,'[data-pc-section="headeraction"]'):null}findPrevHeaderAction(t,n=!1){const i=n?t:t.previousElementSibling;return i?qe.D.getAttribute(i,"data-p-disabled")||"inkbar"===qe.D.getAttribute(i,"data-pc-section")?this.findPrevHeaderAction(i):qe.D.findSingle(i,'[data-pc-section="headeraction"]'):null}findFirstHeaderAction(){return this.findNextHeaderAction(this.navbar.nativeElement.firstElementChild,!0)}findLastHeaderAction(){const t=this.navbar.nativeElement.lastElementChild,n="inkbar"===qe.D.getAttribute(t,"data-pc-section")?t.previousElementSibling:t;return this.findPrevHeaderAction(n,!0)}open(t,n){if(n.disabled)t&&t.preventDefault();else{if(!n.selected){let i=this.findSelectedTab();i&&(i.selected=!1),this.tabChanged=!0,n.selected=!0;let s=this.findTabIndex(n);this.preventActiveIndexPropagation=!0,this.activeIndexChange.emit(s),this.onChange.emit({originalEvent:t,index:s}),this.updateScrollBar(s)}t&&t.preventDefault()}}close(t,n){this.controlClose?this.onClose.emit({originalEvent:t,index:this.findTabIndex(n),close:()=>{this.closeTab(n)}}):(this.closeTab(n),this.onClose.emit({originalEvent:t,index:this.findTabIndex(n)}))}closeTab(t){if(!t.disabled){if(t.selected){this.tabChanged=!0,t.selected=!1;for(let n=0;n<this.tabs.length;n++){let i=this.tabs[n];if(!i.closed&&!t.disabled&&i!=t){i.selected=!0;break}}}t.closed=!0,setTimeout(()=>{this.updateInkBar()})}}findSelectedTab(){for(let t=0;t<this.tabs.length;t++)if(this.tabs[t].selected)return this.tabs[t];return null}findTabIndex(t){let n=-1;for(let i=0;i<this.tabs.length;i++)if(this.tabs[i]==t){n=i;break}return n}getBlockableElement(){return this.el.nativeElement.children[0]}updateInkBar(){if((0,Oe.UE)(this.platformId)&&this.navbar){const t=qe.D.findSingle(this.navbar.nativeElement,"li.p-highlight");if(!t)return;this.inkbar.nativeElement.style.width=qe.D.getWidth(t)+"px",this.inkbar.nativeElement.style.left=qe.D.getOffset(t).left-qe.D.getOffset(this.navbar.nativeElement).left+"px"}}updateScrollBar(t){let n=this.navbar.nativeElement.children[t];n&&n.scrollIntoView({block:"nearest"})}updateButtonState(){const t=this.content.nativeElement,{scrollLeft:n,scrollWidth:i}=t,s=qe.D.getWidth(t);this.backwardIsDisabled=0===n,this.forwardIsDisabled=Math.round(n)===i-s}refreshButtonState(){this.container=qe.D.findSingle(this.el.nativeElement,'[data-pc-section="navcontent"]'),this.list=qe.D.findSingle(this.el.nativeElement,'[data-pc-section="nav"]'),this.list.offsetWidth>=this.container.offsetWidth&&(this.buttonVisible=this.list.offsetWidth>=this.container.offsetWidth,this.updateButtonState(),this.cd.markForCheck())}onScroll(t){this.scrollable&&this.updateButtonState(),t.preventDefault()}getVisibleButtonWidths(){return[this.prevBtn?.nativeElement,this.nextBtn?.nativeElement].reduce((t,n)=>n?t+qe.D.getWidth(n):t,0)}navBackward(){const t=this.content.nativeElement,n=qe.D.getWidth(t)-this.getVisibleButtonWidths(),i=t.scrollLeft-n;t.scrollLeft=i<=0?0:i}navForward(){const t=this.content.nativeElement,n=qe.D.getWidth(t)-this.getVisibleButtonWidths(),i=t.scrollLeft+n,s=t.scrollWidth-n;t.scrollLeft=i>=s?s:i}static \u0275fac=function(n){return new(n||e)(a.rXU(a.Agw),a.rXU(a.aKT),a.rXU(a.gRc),a.rXU(a.sFG))};static \u0275cmp=a.VBU({type:e,selectors:[["p-tabView"]],contentQueries:function(n,i,s){if(1&n&&(a.wni(s,g0,4),a.wni(s,Ze.Ei,4)),2&n){let o;a.mGM(o=a.lsd())&&(i.tabPanels=o),a.mGM(o=a.lsd())&&(i.templates=o)}},viewQuery:function(n,i){if(1&n&&(a.GBs(Sf,5),a.GBs(bf,5),a.GBs(Ef,5),a.GBs(Ff,5),a.GBs(Df,5),a.GBs(Nf,5)),2&n){let s;a.mGM(s=a.lsd())&&(i.content=s.first),a.mGM(s=a.lsd())&&(i.navbar=s.first),a.mGM(s=a.lsd())&&(i.prevBtn=s.first),a.mGM(s=a.lsd())&&(i.nextBtn=s.first),a.mGM(s=a.lsd())&&(i.inkbar=s.first),a.mGM(s=a.lsd())&&(i.elementToObserve=s.first)}},hostAttrs:[1,"p-element"],inputs:{style:"style",styleClass:"styleClass",controlClose:[2,"controlClose","controlClose",a.L39],scrollable:[2,"scrollable","scrollable",a.L39],activeIndex:"activeIndex",selectOnFocus:[2,"selectOnFocus","selectOnFocus",a.L39],nextButtonAriaLabel:"nextButtonAriaLabel",prevButtonAriaLabel:"prevButtonAriaLabel",autoHideButtons:[2,"autoHideButtons","autoHideButtons",a.L39],tabindex:[2,"tabindex","tabindex",a.Udg]},outputs:{onChange:"onChange",onClose:"onClose",activeIndexChange:"activeIndexChange"},features:[a.GFd],ngContentSelectors:c0,decls:14,vars:13,consts:[["elementToObserve",""],["content",""],["navbar",""],["inkbar",""],["prevBtn",""],["nextBtn",""],[3,"ngClass","ngStyle"],[1,"p-tabview-nav-container"],["class","p-tabview-nav-prev p-tabview-nav-btn p-link","type","button","pRipple","",3,"click",4,"ngIf"],[1,"p-tabview-nav-content",3,"scroll"],["role","tablist",1,"p-tabview-nav"],["ngFor","",3,"ngForOf"],["role","presentation","aria-hidden","true",1,"p-tabview-ink-bar"],["class","p-tabview-nav-next p-tabview-nav-btn p-link","type","button","pRipple","",3,"click",4,"ngIf"],[1,"p-tabview-panels"],["type","button","pRipple","",1,"p-tabview-nav-prev","p-tabview-nav-btn","p-link",3,"click"],[4,"ngIf"],[4,"ngTemplateOutlet"],["role","presentation",3,"ngClass","ngStyle","class",4,"ngIf"],["role","presentation",3,"ngClass","ngStyle"],["role","tab","pRipple","",1,"p-tabview-nav-link",3,"click","keydown","pTooltip","tooltipPosition","positionStyle","tooltipStyleClass"],["class","p-tabview-left-icon",3,"ngClass",4,"ngIf"],["class","p-tabview-left-icon",4,"ngIf"],[1,"p-tabview-title"],["class","p-tabview-right-icon",3,"ngClass",4,"ngIf"],["class","p-tabview-right-icon",4,"ngIf"],[1,"p-tabview-left-icon",3,"ngClass"],[1,"p-tabview-left-icon"],[1,"p-tabview-right-icon",3,"ngClass"],[1,"p-tabview-right-icon"],[3,"styleClass","click",4,"ngIf"],["class","tab.closeIconTemplate",4,"ngIf"],[3,"click","styleClass"],[1,"tab.closeIconTemplate"],["type","button","pRipple","",1,"p-tabview-nav-next","p-tabview-nav-btn","p-link",3,"click"]],template:function(n,i){if(1&n){const s=a.RV6();a.NAR(),a.j41(0,"div",6)(1,"div",7,0),a.DNE(3,Lf,4,4,"button",8),a.j41(4,"div",9,1),a.bIt("scroll",function(l){return a.eBV(s),a.Njj(i.onScroll(l))}),a.j41(6,"ul",10,2),a.DNE(8,tu,1,1,"ng-template",11),a.nrm(9,"li",12,3),a.k0s()(),a.DNE(11,au,4,4,"button",13),a.k0s(),a.j41(12,"div",14),a.SdG(13),a.k0s()()}2&n&&(a.HbH(i.styleClass),a.Y8G("ngClass",a.eq3(11,Pf,i.scrollable))("ngStyle",i.style),a.BMQ("data-pc-name","tabview"),a.R7$(3),a.Y8G("ngIf",i.scrollable&&!i.backwardIsDisabled&&i.autoHideButtons),a.R7$(),a.BMQ("data-pc-section","navcontent"),a.R7$(2),a.BMQ("data-pc-section","nav"),a.R7$(2),a.Y8G("ngForOf",i.tabs),a.R7$(),a.BMQ("data-pc-section","inkbar"),a.R7$(2),a.Y8G("ngIf",i.scrollable&&!i.forwardIsDisabled&&i.buttonVisible))},dependencies:()=>[Oe.YU,Oe.Sq,Oe.bT,Oe.T3,Oe.B3,Ma.m,Mi.n,Ba.A,l0.Y,Oa.v],styles:["@layer primeng{.p-tabview-nav-container{position:relative}.p-tabview-scrollable .p-tabview-nav-container{overflow:hidden}.p-tabview-nav-content{overflow-x:auto;overflow-y:hidden;scroll-behavior:smooth;scrollbar-width:none;overscroll-behavior:contain auto}.p-tabview-nav{display:inline-flex;min-width:100%;margin:0;padding:0;list-style-type:none;flex:1 1 auto}.p-tabview-nav-link{cursor:pointer;-webkit-user-select:none;user-select:none;display:flex;align-items:center;position:relative;text-decoration:none;overflow:hidden}.p-tabview-ink-bar{display:none;z-index:1}.p-tabview-nav-link:focus{z-index:1}.p-tabview-title{line-height:1;white-space:nowrap}.p-tabview-nav-btn{position:absolute;top:0;z-index:2;height:100%;display:flex;align-items:center;justify-content:center}.p-tabview-nav-prev{left:0}.p-tabview-nav-next{right:0}.p-tabview-nav-content::-webkit-scrollbar{display:none}.p-tabview-close{z-index:1}}\n"],encapsulation:2,changeDetection:0})}return e})(),su=(()=>{class e{static \u0275fac=function(n){return new(n||e)};static \u0275mod=a.$C({type:e});static \u0275inj=a.G2t({imports:[Oe.MD,Ze.Gg,Ma.S,Mi.Z,Ba.A,l0.Y,Oa.v,Ze.Gg]})}return e})();var u0=Fe(935);let h0=(()=>{class e{constructor(t){this.sanitizer=t}transform(t){return this.sanitizer.bypassSecurityTrustHtml(t)}static{this.\u0275fac=function(n){return new(n||e)(a.rXU(Ut.up,16))}}static{this.\u0275pipe=a.EJ8({name:"safeHtml",type:e,pure:!0})}}return e})();const ou=["productPackageDropdown"],lu=["packageTypeDropdown"],cu=["salesChannelDropdown"],gu=["productAutocomplete"],fu=(e,r)=>({profitRate:20,cost:e,commission:r}),uu=(e,r)=>({cost:e,commission:r}),hu=()=>[0,10,20],Cu=()=>({width:"50vw"});function Iu(e,r){1&e&&(a.nrm(0,"i",21),a.j41(1,"span"),a.EFF(2,"\u0417\u0430\u043a\u0443\u043f\u043a\u0430"),a.k0s())}function Au(e,r){1&e&&(a.j41(0,"tr"),a.nrm(1,"th",26),a.j41(2,"th",26),a.EFF(3,"ID"),a.k0s(),a.j41(4,"th"),a.EFF(5,"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435"),a.k0s(),a.j41(6,"th",26),a.EFF(7,"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e"),a.k0s(),a.j41(8,"th",26),a.EFF(9,"\u0417\u0430\u043a\u0443\u043f\u043e\u0447\u043d\u0430\u044f \u0446\u0435\u043d\u0430"),a.k0s()())}function pu(e,r){if(1&e){const t=a.RV6();a.j41(0,"p-inputNumber",32),a.mxI("ngModelChange",function(i){a.eBV(t);const s=a.XpG().$implicit;return a.DH7(s.count,i)||(s.count=i),a.Njj(i)}),a.k0s()}if(2&e){const t=a.XpG().$implicit;a.R50("ngModel",t.count),a.Y8G("min",0)("required",!0)("useGrouping",!1)}}function du(e,r){if(1&e&&a.EFF(0),2&e){const t=a.XpG().$implicit;a.SpI(" ",t.count," ")}}function mu(e,r){if(1&e){const t=a.RV6();a.j41(0,"p-inputNumber",33),a.mxI("ngModelChange",function(i){a.eBV(t);const s=a.XpG().$implicit;return a.DH7(s.price,i)||(s.price=i),a.Njj(i)}),a.k0s()}if(2&e){const t=a.XpG().$implicit;a.R50("ngModel",t.price),a.Y8G("maxFractionDigits",2)("min",0)("required",!0)("useGrouping",!1)}}function _u(e,r){if(1&e&&a.EFF(0),2&e){const t=a.XpG().$implicit;a.SpI(" ",t.price," ")}}function xu(e,r){if(1&e){const t=a.RV6();a.j41(0,"tr")(1,"td")(2,"p-button",27),a.bIt("click",function(){const i=a.eBV(t).rowIndex,s=a.XpG(4);return a.Njj(s.removeItem(s.calculation.items,i))}),a.k0s()(),a.j41(3,"td"),a.EFF(4),a.k0s(),a.j41(5,"td"),a.EFF(6),a.k0s(),a.j41(7,"td",28)(8,"p-cellEditor"),a.DNE(9,pu,1,4,"ng-template",29)(10,du,1,1,"ng-template",30),a.k0s()(),a.j41(11,"td",31)(12,"p-cellEditor"),a.DNE(13,mu,1,5,"ng-template",29)(14,_u,1,1,"ng-template",30),a.k0s()()()}if(2&e){const t=r.$implicit;a.R7$(4),a.JRh(t.productID),a.R7$(2),a.JRh(t.product.name),a.R7$(),a.Y8G("pEditableColumn",t.count),a.R7$(4),a.Y8G("pEditableColumn",t.price)}}function vu(e,r){if(1&e&&(a.j41(0,"tr")(1,"td",34),a.EFF(2,"\u0418\u0442\u043e\u0433\u043e:"),a.k0s(),a.j41(3,"td",35),a.EFF(4),a.k0s(),a.j41(5,"td",35),a.EFF(6),a.k0s()()),2&e){const t=a.XpG(4);a.R7$(4),a.SpI(" ",t.calculationTotalProductCount," "),a.R7$(2),a.SpI(" ",t.calculationTotalSum," ")}}function ku(e,r){if(1&e&&(a.j41(0,"p-table",24),a.DNE(1,Au,10,0,"ng-template",14)(2,xu,15,4,"ng-template",15)(3,vu,7,2,"ng-template",25),a.k0s()),2&e){const t=a.XpG(3);a.Y8G("value",t.calculation.items)}}function wu(e,r){if(1&e&&(a.j41(0,"div",36)(1,"div"),a.EFF(2),a.k0s()()),2&e){const t=r.$implicit;a.R7$(2),a.Lme("",t.iD,": ",t.name,"")}}function yu(e,r){1&e&&a.EFF(0,"\u041f\u043e\u0438\u0441\u043a \u0442\u043e\u0432\u0430\u0440\u0430")}function Tu(e,r){if(1&e){const t=a.RV6();a.j41(0,"div",5),a.DNE(1,ku,4,1,"p-table",22),a.j41(2,"p-autoComplete",23,1),a.nI1(4,"async"),a.bIt("completeMethod",function(i){a.eBV(t);const s=a.XpG(2);return a.Njj(s.findProductsByName(i))})("onSelect",function(i){a.eBV(t);const s=a.XpG(2);return a.Njj(s.addProduct(i))}),a.DNE(5,wu,3,2,"ng-template",17)(6,yu,1,0,"ng-template",18),a.k0s()()}if(2&e){const t=a.XpG(2);a.R7$(),a.Y8G("ngIf",t.calculation.items.length),a.R7$(),a.Y8G("minLength",3)("suggestions",a.bMT(4,3,t.products))}}function Su(e,r){1&e&&(a.nrm(0,"i",37),a.j41(1,"span"),a.EFF(2,"\u0422\u0438\u043f\u043e\u0444\u043e\u0440\u043c\u0430\u0442\u044b"),a.k0s())}function bu(e,r){if(1&e&&(a.j41(0,"div",36)(1,"div"),a.EFF(2),a.k0s()()),2&e){const t=r.$implicit;a.R7$(2),a.Lme("1",t.iD,": ",t.name,"")}}function Eu(e,r){1&e&&a.EFF(0,"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0430\u0440\u0442\u0438\u043a\u0443\u043b")}function Fu(e,r){if(1&e&&a.EFF(0),2&e){const t=a.XpG().$implicit;a.E5c(" \u0410\u0440\u0442\u0438\u043a\u0443\u043b: ",t.productPackage.iD,", ",t.productPackage.productCount,"\u0448\u0442, ",t.name," ")}}function Du(e,r){1&e&&(a.j41(0,"tr")(1,"th"),a.EFF(2,"\u0422\u0438\u043f \u0443\u043f\u0430\u043a\u043e\u0432\u043a\u0438"),a.k0s(),a.j41(3,"th"),a.EFF(4,"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e"),a.k0s(),a.j41(5,"th"),a.EFF(6,"\u0426\u0435\u043d\u0430 \u0443\u043f\u0430\u043a\u043e\u0432\u043a\u0438"),a.k0s(),a.j41(7,"th"),a.EFF(8,"\u0421\u0443\u043c\u043c\u0430"),a.k0s()())}function Nu(e,r){if(1&e&&(a.j41(0,"tr")(1,"td",34),a.EFF(2,"\u0418\u0442\u043e\u0433\u043e:"),a.k0s(),a.j41(3,"td",35),a.EFF(4),a.k0s()()),2&e){const t=a.XpG(3).$implicit,n=a.XpG(3);a.R7$(4),a.JRh(n.getPackagePrice(t))}}function Pu(e,r){if(1&e&&(a.j41(0,"span"),a.EFF(1),a.k0s()),2&e){const t=r.ngIf;a.R7$(),a.SpI(" ",t.name," ")}}function Ru(e,r){if(1&e){const t=a.RV6();a.j41(0,"div",47)(1,"p-inputNumber",57),a.mxI("ngModelChange",function(i){a.eBV(t);const s=a.XpG(2).$implicit;return a.DH7(s.amount,i)||(s.amount=i),a.Njj(i)}),a.k0s(),a.nrm(2,"span",58),a.nI1(3,"safeHtml"),a.k0s()}if(2&e){const t=a.XpG().ngIf,n=a.XpG().$implicit,i=a.XpG(6);a.R7$(),a.R50("ngModel",n.amount),a.Y8G("maxFractionDigits",t.decimalPlaces)("minFractionDigits",t.decimalPlaces)("min",0)("showButtons",!0)("step",1/i.Math.pow(10,t.decimalPlaces))("useGrouping",!1),a.R7$(),a.Y8G("innerHtml",a.bMT(3,8,i.getUnitOfMeasure(t.unitOfMeasure)),a.npT)}}function Ou(e,r){if(1&e&&(a.qex(0),a.EFF(1),a.nrm(2,"span",59),a.nI1(3,"safeHtml"),a.bVm()),2&e){const t=a.XpG().ngIf,n=a.XpG().$implicit,i=a.XpG(6);a.R7$(),a.SpI(" ",n.amount,""),a.R7$(),a.Y8G("innerHtml",a.bMT(3,2,i.getUnitOfMeasure(t.unitOfMeasure)),a.npT)}}function Bu(e,r){1&e&&(a.j41(0,"p-cellEditor"),a.DNE(1,Ru,4,10,"ng-template",29)(2,Ou,4,4,"ng-template",30),a.k0s())}function Mu(e,r){if(1&e){const t=a.RV6();a.j41(0,"div",47)(1,"p-inputNumber",60),a.mxI("ngModelChange",function(i){a.eBV(t);const s=a.XpG().$implicit;return a.DH7(s.pricePerUom,i)||(s.pricePerUom=i),a.Njj(i)}),a.k0s(),a.nrm(2,"span",58),a.nI1(3,"safeHtml"),a.k0s()}if(2&e){const t=a.XpG().$implicit,n=a.XpG(6);a.R7$(),a.R50("ngModel",t.pricePerUom),a.Y8G("maxFractionDigits",2)("minFractionDigits",0)("min",0)("showButtons",!0)("step",1)("useGrouping",!1),a.R7$(),a.Y8G("innerHtml",a.bMT(3,8,"\u20bd/"+n.getUnitOfMeasureByPackageTypeID(t.packageTypeID)),a.npT)}}function Lu(e,r){if(1&e&&(a.EFF(0),a.nrm(1,"span",59)),2&e){const t=a.XpG().$implicit,n=a.XpG(6);a.SpI(" ",t.pricePerUom,"\u20bd/"),a.R7$(),a.Y8G("innerHtml",n.getUnitOfMeasureByPackageTypeID(t.packageTypeID),a.npT)}}function Uu(e,r){if(1&e){const t=a.RV6();a.j41(0,"tr")(1,"td")(2,"p-button",54),a.bIt("click",function(){const i=a.eBV(t).rowIndex,s=a.XpG(3).$implicit,o=a.XpG(3);return a.Njj(o.removeItem(s.salesItemPackages,i))}),a.k0s(),a.DNE(3,Pu,2,1,"span",20),a.k0s(),a.j41(4,"td",55),a.DNE(5,Bu,3,0,"p-cellEditor",20),a.k0s(),a.j41(6,"td",56)(7,"p-cellEditor"),a.DNE(8,Mu,4,10,"ng-template",29)(9,Lu,2,2,"ng-template",30),a.k0s()(),a.j41(10,"td",35),a.EFF(11),a.nI1(12,"number"),a.k0s()()}if(2&e){const t=r.$implicit,n=a.XpG(6);a.R7$(3),a.Y8G("ngIf",n.getPackageType(t.packageTypeID)),a.R7$(),a.Y8G("pEditableColumn",t.amount),a.R7$(),a.Y8G("ngIf",n.getPackageType(t.packageTypeID)),a.R7$(),a.Y8G("pEditableColumn",t.pricePerUom),a.R7$(5),a.SpI(" ",a.i5U(12,5,t.pricePerUom*t.amount,"1.2-2"),"\u20bd ")}}function Gu(e,r){if(1&e&&(a.j41(0,"p-table",24),a.DNE(1,Du,9,0,"ng-template",14)(2,Nu,5,1,"ng-template",25)(3,Uu,13,8,"ng-template",15),a.k0s()),2&e){const t=a.XpG(2).$implicit;a.Y8G("value",t.salesItemPackages)}}function ju(e,r){if(1&e&&(a.j41(0,"div",36),a.nrm(1,"div",61),a.nI1(2,"safeHtml"),a.k0s()),2&e){const t=r.$implicit,n=a.XpG(5);a.R7$(),a.Y8G("innerHTML",a.bMT(2,1,t.name+" ("+(null==t.price?"-":t.price)+" \u20bd/"+n.getUnitOfMeasure(t.unitOfMeasure)+")"),a.npT)}}function Vu(e,r){if(1&e&&(a.j41(0,"div",36)(1,"div"),a.EFF(2),a.k0s()()),2&e){const t=r.$implicit;a.R7$(2),a.JRh(t.name)}}function $u(e,r){1&e&&a.EFF(0,"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u043b\u0430\u043d \u043f\u0440\u043e\u0434\u0430\u0436 ")}function Wu(e,r){1&e&&(a.j41(0,"tr")(1,"th"),a.EFF(2,"\u041a\u0430\u043d\u0430\u043b"),a.k0s(),a.j41(3,"th",35),a.EFF(4,"\u0426\u0435\u043d\u0430"),a.k0s(),a.j41(5,"th",35),a.EFF(6,"\u0421\u0435\u0431\u0435\u0441"),a.k0s(),a.j41(7,"th",35),a.EFF(8,"\u041e\u0442\u0433\u0440\u0443\u0437\u043a\u0430"),a.k0s(),a.j41(9,"th",35),a.EFF(10,"\u0420\u0435\u043a\u043b\u0430\u043c\u0430, \u20bd/\u043f\u043b\u0430\u043d"),a.k0s(),a.j41(11,"th"),a.EFF(12,"\u041a\u043e\u043b-\u0432\u043e"),a.k0s(),a.j41(13,"th",35),a.EFF(14,"\u041a\u043e\u043c\u0438\u0441\u0441\u0438\u044f"),a.k0s(),a.j41(15,"th",35),a.EFF(16,"\u0412\u043e\u0437\u0432\u0440\u0430\u0442\u044b"),a.k0s(),a.nrm(17,"th"),a.k0s())}function Xu(e,r){if(1&e){const t=a.RV6();a.j41(0,"div",47)(1,"p-inputNumber",74),a.mxI("ngModelChange",function(i){a.eBV(t);const s=a.XpG(2).$implicit;return a.DH7(s.price,i)||(s.price=i),a.Njj(i)}),a.k0s(),a.j41(2,"span",49),a.EFF(3,"\u20bd"),a.k0s()()}if(2&e){const t=a.XpG(2).$implicit;a.R7$(),a.R50("ngModel",t.price),a.Y8G("maxFractionDigits",2)("minFractionDigits",0)("min",0)("required",!0)("showButtons",!0)("step",1)("useGrouping",!1)}}function zu(e,r){if(1&e&&(a.j41(0,"div"),a.EFF(1),a.k0s(),a.j41(2,"p-tag",75),a.EFF(3),a.nI1(4,"number"),a.nI1(5,"number"),a.k0s()),2&e){const t=a.XpG().ngIf,n=a.XpG().$implicit;a.R7$(),a.SpI(" ",n.price,"\u20bd "),a.R7$(),a.Y8G("severity",n.price<t.commission+t.cost?"danger":(n.price-(t.commission+t.cost))/t.cost>t.profitRate/100?"success":"info"),a.R7$(),a.Lme(" ",a.i5U(4,4,n.price-(t.commission+t.cost),"1.2-2"),"\u20bd/",a.i5U(5,7,(n.price-(t.commission+t.cost))/t.cost*100,"1.0-2"),"% ")}}function Hu(e,r){if(1&e){const t=a.RV6();a.j41(0,"div",47)(1,"p-inputNumber",76),a.mxI("ngModelChange",function(i){a.eBV(t);const s=a.XpG(2).$implicit;return a.DH7(s.deliveryCost,i)||(s.deliveryCost=i),a.Njj(i)}),a.k0s(),a.j41(2,"span",49),a.EFF(3,"\u20bd"),a.k0s()()}if(2&e){const t=a.XpG(2).$implicit;a.R7$(),a.R50("ngModel",t.deliveryCost),a.Y8G("maxFractionDigits",2)("minFractionDigits",0)("min",0)("required",!0)("showButtons",!0)("step",50)("useGrouping",!1)}}function Yu(e,r){if(1&e&&(a.j41(0,"div",77),a.EFF(1),a.k0s()),2&e){const t=a.XpG(2).$implicit;a.R7$(),a.SpI(" ",t.deliveryCost,"\u20bd ")}}function Ju(e,r){if(1&e){const t=a.RV6();a.j41(0,"div",47)(1,"p-inputNumber",74),a.mxI("ngModelChange",function(i){a.eBV(t);const s=a.XpG(2).$implicit;return a.DH7(s.marketingBudget,i)||(s.marketingBudget=i),a.Njj(i)}),a.k0s(),a.j41(2,"span",49),a.EFF(3,"\u20bd"),a.k0s()()}if(2&e){const t=a.XpG(2).$implicit;a.R7$(),a.R50("ngModel",t.marketingBudget),a.Y8G("maxFractionDigits",2)("minFractionDigits",0)("min",0)("required",!0)("showButtons",!0)("step",100)("useGrouping",!1)}}function Ku(e,r){if(1&e&&a.EFF(0),2&e){const t=a.XpG(2).$implicit;a.SpI(" ",t.marketingBudget," ")}}function Zu(e,r){if(1&e){const t=a.RV6();a.j41(0,"div",47)(1,"p-inputNumber",78),a.mxI("ngModelChange",function(i){a.eBV(t);const s=a.XpG(2).$implicit;return a.DH7(s.amount,i)||(s.amount=i),a.Njj(i)}),a.k0s(),a.j41(2,"span",49),a.EFF(3,"\u0448\u0442"),a.k0s()()}if(2&e){const t=a.XpG(2).$implicit;a.R7$(),a.R50("ngModel",t.amount),a.Y8G("min",0)("required",!0)("showButtons",!0)("step",10)("useGrouping",!1)}}function Qu(e,r){if(1&e&&a.EFF(0),2&e){const t=a.XpG(2).$implicit;a.SpI(" ",t.amount,"\u0448\u0442 ")}}function qu(e,r){if(1&e){const t=a.RV6();a.j41(0,"div",47)(1,"p-inputNumber",74),a.mxI("ngModelChange",function(i){a.eBV(t);const s=a.XpG(2).$implicit;return a.DH7(s.commissionMultiplier,i)||(s.commissionMultiplier=i),a.Njj(i)}),a.k0s(),a.j41(2,"span",49),a.EFF(3,"%"),a.k0s()()}if(2&e){const t=a.XpG(2).$implicit;a.R7$(),a.R50("ngModel",t.commissionMultiplier),a.Y8G("maxFractionDigits",1)("minFractionDigits",1)("min",0)("required",!0)("showButtons",!0)("step",.5)("useGrouping",!1)}}function eh(e,r){if(1&e&&(a.j41(0,"div",79),a.EFF(1),a.k0s()),2&e){const t=a.XpG(2).$implicit;a.R7$(),a.SpI(" ",t.commissionMultiplier,"% ")}}function th(e,r){if(1&e){const t=a.RV6();a.j41(0,"div",47)(1,"p-inputNumber",74),a.mxI("ngModelChange",function(i){a.eBV(t);const s=a.XpG(2).$implicit;return a.DH7(s.returnPercentage,i)||(s.returnPercentage=i),a.Njj(i)}),a.k0s(),a.j41(2,"span",49),a.EFF(3,"%"),a.k0s()()}if(2&e){const t=a.XpG(2).$implicit;a.R7$(),a.R50("ngModel",t.returnPercentage),a.Y8G("maxFractionDigits",1)("minFractionDigits",1)("min",0)("required",!0)("showButtons",!0)("step",.5)("useGrouping",!1)}}function rh(e,r){if(1&e&&a.EFF(0),2&e){const t=a.XpG(2).$implicit;a.SpI(" ",t.returnPercentage,"% ")}}function nh(e,r){if(1&e){const t=a.RV6();a.j41(0,"tr")(1,"td",65)(2,"div"),a.EFF(3),a.k0s()(),a.j41(4,"td",66)(5,"p-cellEditor"),a.DNE(6,Xu,4,8,"ng-template",29)(7,zu,6,10,"ng-template",30),a.k0s()(),a.j41(8,"td",67)(9,"div",68),a.EFF(10),a.nI1(11,"number"),a.k0s()(),a.j41(12,"td",69)(13,"p-cellEditor"),a.DNE(14,Hu,4,8,"ng-template",29)(15,Yu,2,1,"ng-template",30),a.k0s()(),a.j41(16,"td",70)(17,"p-cellEditor"),a.DNE(18,Ju,4,8,"ng-template",29)(19,Ku,1,1,"ng-template",30),a.k0s()(),a.j41(20,"td",71)(21,"p-cellEditor"),a.DNE(22,Zu,4,6,"ng-template",29)(23,Qu,1,1,"ng-template",30),a.k0s()(),a.j41(24,"td",72)(25,"p-cellEditor"),a.DNE(26,qu,4,8,"ng-template",29)(27,eh,2,1,"ng-template",30),a.k0s()(),a.j41(28,"td",73)(29,"p-cellEditor"),a.DNE(30,th,4,8,"ng-template",29)(31,rh,1,1,"ng-template",30),a.k0s()(),a.j41(32,"td",65)(33,"p-button",27),a.bIt("click",function(){a.eBV(t);const i=a.XpG().rowIndex,s=a.XpG(2).$implicit,o=a.XpG(3);return a.Njj(o.removeItem(s.salesPlans,i))}),a.k0s()()()}if(2&e){const t=r.ngIf,n=a.XpG().$implicit;a.R7$(3),a.SpI(" ",null==n.salesChannel?null:n.salesChannel.name," "),a.R7$(),a.Y8G("pEditableColumn",n.price),a.R7$(6),a.SpI(" ",a.i5U(11,7,t.commission+t.cost,"1.2-2"),"\u20bd "),a.R7$(6),a.Y8G("pEditableColumn",n.marketingBudget),a.R7$(4),a.Y8G("pEditableColumn",n.amount),a.R7$(4),a.Y8G("pEditableColumn",n.commissionMultiplier),a.R7$(4),a.Y8G("pEditableColumn",n.returnPercentage)}}function ih(e,r){if(1&e){const t=a.RV6();a.j41(0,"p-calendar",80),a.mxI("ngModelChange",function(i){a.eBV(t);const s=a.XpG().$implicit;return a.DH7(s.deliveryDate,i)||(s.deliveryDate=i),a.Njj(i)}),a.k0s()}if(2&e){const t=a.XpG().$implicit;a.R50("ngModel",t.deliveryDate),a.Y8G("readonlyInput",!0)}}function ah(e,r){if(1&e&&(a.EFF(0),a.nI1(1,"date")),2&e){const t=a.XpG().$implicit;a.SpI(" ",a.i5U(1,1,t.deliveryDate,"dd.MM.yyyy")," ")}}function sh(e,r){if(1&e){const t=a.RV6();a.j41(0,"div",47)(1,"p-inputNumber",74),a.mxI("ngModelChange",function(i){a.eBV(t);const s=a.XpG().$implicit;return a.DH7(s.commissionAddition,i)||(s.commissionAddition=i),a.Njj(i)}),a.k0s(),a.j41(2,"span",49),a.EFF(3,"\u20bd"),a.k0s()()}if(2&e){const t=a.XpG().$implicit,n=a.XpG(5);a.R7$(),a.R50("ngModel",t.commissionAddition),a.Y8G("maxFractionDigits",2)("minFractionDigits",2)("min",n.getLogisticPrice(t))("required",!0)("showButtons",!0)("step",5)("useGrouping",!1)}}function oh(e,r){if(1&e&&(a.j41(0,"div",81),a.EFF(1),a.k0s()),2&e){const t=a.XpG().$implicit;a.R7$(),a.SpI(" ",t.commissionAddition,"\u20bd ")}}function lh(e,r){if(1&e){const t=a.RV6();a.j41(0,"div",47)(1,"p-inputNumber",74),a.mxI("ngModelChange",function(i){a.eBV(t);const s=a.XpG().$implicit;return a.DH7(s.returnCost,i)||(s.returnCost=i),a.Njj(i)}),a.k0s(),a.j41(2,"span",49),a.EFF(3,"\u20bd"),a.k0s()()}if(2&e){const t=a.XpG().$implicit,n=a.XpG(5);a.R7$(),a.R50("ngModel",t.returnCost),a.Y8G("maxFractionDigits",2)("minFractionDigits",2)("min",n.getBackwardLogisticPrice(t))("required",!0)("showButtons",!0)("step",5)("useGrouping",!1)}}function ch(e,r){if(1&e&&a.EFF(0),2&e){const t=a.XpG().$implicit;a.SpI(" ",t.returnCost,"\u20bd ")}}function gh(e,r){if(1&e){const t=a.RV6();a.j41(0,"span",85),a.bIt("click",function(){const i=a.eBV(t).ngIf,s=a.XpG(3).$implicit;return a.Njj(s.price=i)}),a.EFF(1),a.nI1(2,"number"),a.k0s()}if(2&e){const t=r.ngIf,n=a.XpG().$implicit;a.Y8G("pTooltip","\u041e\u0442\u043f\u0443\u0441\u043a\u043d\u0430\u044f \u0446\u0435\u043d\u0430 \u0434\u043b\u044f \u043f\u0440\u0438\u0431\u044b\u043b\u0438 "+n+"%"),a.R7$(),a.Lme(" ",a.i5U(2,3,t,"1.2-2"),"\u20bd \u0434\u043b\u044f ",n,"% ")}}function fh(e,r){if(1&e&&(a.j41(0,"div"),a.DNE(1,gh,3,6,"span",84),a.k0s()),2&e){const t=r.$implicit,n=a.XpG().ngIf,i=a.XpG().$implicit,s=a.XpG(5);a.R7$(),a.Y8G("ngIf",s.Math.ceil(100*(n.cost*(1+t/100)+i.commissionAddition)/(1-i.commissionMultiplier/100))/100)}}function uh(e,r){if(1&e&&(a.j41(0,"div",88),a.EFF(1),a.k0s()),2&e){const t=a.XpG(3).$implicit,n=a.XpG(5);a.R7$(),a.SpI(" ",n.getLogisticPrice(t),"\u20bd ")}}function hh(e,r){if(1&e){const t=a.RV6();a.qex(0),a.j41(1,"p-dropdown",86),a.mxI("ngModelChange",function(i){a.eBV(t);const s=a.XpG(2).$implicit;return a.DH7(s.selectedLogisticCoefficient,i)||(s.selectedLogisticCoefficient=i),a.Njj(i)}),a.k0s(),a.DNE(2,uh,2,1,"div",87),a.bVm()}if(2&e){const t=a.XpG(2).$implicit;a.R7$(),a.R50("ngModel",t.selectedLogisticCoefficient),a.Y8G("options",null==t.salesChannel?null:t.salesChannel.logisticCoefficients),a.R7$(),a.Y8G("ngIf",null==t.salesChannel||null==t.salesChannel.logisticCoefficients?null:t.salesChannel.logisticCoefficients.length)}}function Ch(e,r){if(1&e&&(a.j41(0,"tr")(1,"td"),a.DNE(2,fh,2,1,"div",19),a.k0s(),a.nrm(3,"td")(4,"td"),a.j41(5,"td",35),a.DNE(6,hh,3,3,"ng-container",20),a.k0s(),a.j41(7,"td",35)(8,"div",82),a.EFF(9),a.k0s(),a.j41(10,"div",83),a.EFF(11),a.k0s()()()),2&e){const t=a.XpG().$implicit,n=a.XpG(5);a.R7$(2),a.Y8G("ngForOf",a.lJ4(4,hu)),a.R7$(4),a.Y8G("ngIf",null==t.salesChannel||null==t.salesChannel.logisticCoefficients?null:t.salesChannel.logisticCoefficients.length),a.R7$(3),a.SpI("",null==t.salesChannel?null:t.salesChannel.CancelledSaleHandlingPrice,"\u20bd "),a.R7$(2),a.SpI("",n.getBackwardLogisticPrice(t),"\u20bd")}}function Ih(e,r){if(1&e&&(a.DNE(0,nh,34,10,"tr",20),a.j41(1,"tr")(2,"td",62)(3,"p-cellEditor"),a.DNE(4,ih,1,2,"ng-template",29)(5,ah,2,4,"ng-template",30),a.k0s()(),a.j41(6,"td",63)(7,"p-cellEditor"),a.DNE(8,sh,4,8,"ng-template",29)(9,oh,2,1,"ng-template",30),a.k0s()(),a.j41(10,"td",64)(11,"p-cellEditor"),a.DNE(12,lh,4,8,"ng-template",29)(13,ch,1,1,"ng-template",30),a.k0s()()(),a.DNE(14,Ch,12,5,"tr",20)),2&e){const t=r.$implicit,n=a.XpG(2).$implicit,i=a.XpG().$implicit,s=a.XpG(2);a.Y8G("ngIf",a.l_i(4,fu,s.getSelfCost(n,t,i),s.getCommission(t))),a.R7$(6),a.Y8G("pEditableColumn",t.commissionAddition),a.R7$(4),a.Y8G("pEditableColumn",t.returnCost),a.R7$(4),a.Y8G("ngIf",a.l_i(7,uu,s.getSelfCost(n,t,i),s.getCommission(t)))}}function Ah(e,r){if(1&e){const t=a.RV6();a.j41(0,"div",40)(1,"p-button",41),a.bIt("click",function(){a.eBV(t);const i=a.XpG().index,s=a.XpG().$implicit,o=a.XpG(2);return a.Njj(o.removeItem(s.salesItems,i))}),a.k0s(),a.j41(2,"h5"),a.EFF(3,"\u041e\u0444\u043e\u0440\u043c\u043b\u0435\u043d\u0438\u0435 \u0443\u043f\u0430\u043a\u043e\u0432\u043a\u0438"),a.k0s(),a.j41(4,"div",42)(5,"div",43)(6,"div")(7,"label",44),a.EFF(8,"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435"),a.k0s()(),a.j41(9,"input",45),a.mxI("ngModelChange",function(i){a.eBV(t);const s=a.XpG().$implicit;return a.DH7(s.name,i)||(s.name=i),a.Njj(i)}),a.k0s()(),a.j41(10,"div",43)(11,"label",46),a.EFF(12,"\u041e\u0431\u044a\u0451\u043c"),a.k0s(),a.j41(13,"div",47)(14,"p-inputNumber",48),a.bIt("onInput",function(){a.eBV(t);const i=a.XpG().$implicit,s=a.XpG(3);return a.Njj(s.onVolumeUpdated(i))}),a.mxI("ngModelChange",function(i){a.eBV(t);const s=a.XpG().$implicit;return a.DH7(s.volume,i)||(s.volume=i),a.Njj(i)}),a.k0s(),a.j41(15,"span",49),a.EFF(16,"\u043b"),a.k0s()()(),a.j41(17,"div",43)(18,"label",50),a.EFF(19,"\u0421\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c \u0444\u0430\u0441\u043e\u0432\u043a\u0438"),a.k0s(),a.j41(20,"div",47)(21,"p-inputNumber",51),a.mxI("ngModelChange",function(i){a.eBV(t);const s=a.XpG().$implicit;return a.DH7(s.packagingPrice,i)||(s.packagingPrice=i),a.Njj(i)}),a.k0s(),a.j41(22,"span",49),a.EFF(23,"\u20bd"),a.k0s()()()(),a.DNE(24,Gu,4,1,"p-table",22),a.j41(25,"p-dropdown",52,2),a.bIt("onChange",function(i){a.eBV(t);const s=a.XpG().$implicit,o=a.XpG(3);return a.Njj(o.addSalesItemPackage(s,i.value))}),a.DNE(27,ju,3,3,"ng-template",17),a.k0s()(),a.j41(28,"div",40)(29,"p-dropdown",53,3),a.nI1(31,"async"),a.bIt("onChange",function(i){a.eBV(t);const s=a.XpG().$implicit,o=a.XpG(3);return a.Njj(o.addSalesPlan(s,i.value))}),a.DNE(32,Vu,3,1,"ng-template",17)(33,$u,1,0,"ng-template",18),a.k0s(),a.j41(34,"p-table",24),a.DNE(35,Wu,18,0,"ng-template",14)(36,Ih,15,10,"ng-template",15),a.k0s()()}if(2&e){const t=a.XpG().$implicit,n=a.XpG(3);a.R7$(9),a.R50("ngModel",t.name),a.R7$(5),a.R50("ngModel",t.volume),a.Y8G("maxFractionDigits",1)("minFractionDigits",0)("min",0)("showButtons",!0)("step",.1)("useGrouping",!1),a.R7$(7),a.R50("ngModel",t.packagingPrice),a.Y8G("maxFractionDigits",2)("minFractionDigits",0)("showButtons",!0)("step",1)("useGrouping",!1),a.R7$(3),a.Y8G("ngIf",null==t.salesItemPackages?null:t.salesItemPackages.length),a.R7$(),a.Y8G("options",n.getAvailablePackageTypes(t)),a.R7$(4),a.Y8G("autoDisplayFirst",!1)("options",a.bMT(31,19,n.salesChannels)),a.R7$(5),a.Y8G("value",t.salesPlans)}}function ph(e,r){1&e&&(a.qex(0),a.j41(1,"p-accordionTab",38),a.DNE(2,Fu,1,3,"ng-template",14)(3,Ah,37,21,"ng-template",39),a.k0s(),a.bVm())}function dh(e,r){if(1&e&&(a.qex(0),a.DNE(1,ph,4,0,"ng-container",19),a.bVm()),2&e){const t=r.$implicit;a.R7$(),a.Y8G("ngForOf",t.salesItems)}}function mh(e,r){if(1&e){const t=a.RV6();a.qex(0),a.j41(1,"p-dialog",89),a.mxI("visibleChange",function(i){a.eBV(t);const s=a.XpG(2);return a.DH7(s.duplicateProductDialogVisible,i)||(s.duplicateProductDialogVisible=i),a.Njj(i)}),a.j41(2,"p",90),a.EFF(3),a.k0s()(),a.bVm()}if(2&e){const t=a.XpG(2);a.R7$(),a.Aen(a.lJ4(7,Cu)),a.R50("visible",t.duplicateProductDialogVisible),a.Y8G("draggable",!1)("modal",!0)("resizable",!1),a.R7$(2),a.SpI(" ",t.addedProduct.name," ")}}function _h(e,r){if(1&e){const t=a.RV6();a.j41(0,"div",5)(1,"h5"),a.EFF(2,"\u0420\u0430\u0441\u0447\u0451\u0442 \u0434\u043e\u0445\u043e\u0434\u043d\u043e\u0441\u0442\u0438 \u043f\u043e \u0430\u0440\u0442\u0438\u043a\u0443\u043b\u0443"),a.k0s(),a.j41(3,"span",6)(4,"input",7),a.mxI("ngModelChange",function(i){a.eBV(t);const s=a.XpG();return a.DH7(s.calculation.name,i)||(s.calculation.name=i),a.Njj(i)}),a.k0s(),a.j41(5,"label",8),a.EFF(6,"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435 \u0440\u0430\u0441\u0447\u0451\u0442\u0430"),a.k0s()(),a.j41(7,"span",6)(8,"p-calendar",9),a.mxI("ngModelChange",function(i){a.eBV(t);const s=a.XpG();return a.DH7(s.calculation.date,i)||(s.calculation.date=i),a.Njj(i)}),a.k0s(),a.j41(9,"label",10),a.EFF(10,"\u0414\u0430\u0442\u0430 \u0437\u0430\u043a\u0443\u043f\u043a\u0438"),a.k0s()(),a.j41(11,"div",11)(12,"p-button",12),a.bIt("click",function(){a.eBV(t);const i=a.XpG();return a.Njj(i.savePurchaseBatch())}),a.k0s()(),a.j41(13,"p-tabView",13)(14,"p-tabPanel"),a.DNE(15,Iu,3,0,"ng-template",14)(16,Tu,7,5,"ng-template",15),a.k0s(),a.j41(17,"p-tabPanel"),a.DNE(18,Su,3,0,"ng-template",14),a.j41(19,"div",5)(20,"p-dropdown",16,0),a.bIt("onChange",function(i){a.eBV(t);const s=a.XpG();return a.Njj(s.addSalesItem(i.value))}),a.mxI("ngModelChange",function(i){a.eBV(t);const s=a.XpG();return a.DH7(s.selectedProductPackage,i)||(s.selectedProductPackage=i),a.Njj(i)}),a.DNE(22,bu,3,2,"ng-template",17)(23,Eu,1,0,"ng-template",18),a.k0s(),a.j41(24,"p-accordion"),a.DNE(25,dh,2,1,"ng-container",19),a.k0s()()()(),a.DNE(26,mh,4,8,"ng-container",20),a.k0s()}if(2&e){const t=a.XpG();a.R7$(4),a.R50("ngModel",t.calculation.name),a.R7$(4),a.R50("ngModel",t.calculation.date),a.Y8G("readonlyInput",!0),a.R7$(12),a.R50("ngModel",t.selectedProductPackage),a.Y8G("options",t.batchPackages),a.R7$(5),a.Y8G("ngForOf",t.calculation.items),a.R7$(),a.Y8G("ngIf",t.addedProduct)}}let xh=(()=>{class e extends Or.x{constructor(t,n,i,s,o,l,g,u){super(u),this.route=t,this.productClient=n,this.purchaseBatchCommandHandlerClient=i,this.salesChannelClient=s,this.messageService=o,this.purchaseService=l,this.router=g,this.productSearchSubject=new s0.B,this.purchaseBatchIDSubject=new s0.B,this.batchPackages=[],this.products=new Fr.t([]),this.salesChannels=new Fr.t([]),this.Math=Math,this.loading=!1}get duplicateProductDialogVisible(){return!!this.addedProduct}set duplicateProductDialogVisible(t){t||(this.addedProduct=null)}get calculationTotalProductCount(){return this.calculation.items.reduce((t,n)=>Math.round(t+n.count),0)}get calculationTotalSum(){return this.calculation.items.reduce((t,n)=>Math.round(t+n.price*n.count),0)}ngOnInit(){this.titleService.setTitle("\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0437\u0430\u043a\u0443\u043f\u043a\u0438"),this.purchaseBatchIDSubject.pipe((0,Da.Q)(this.destroyed)).pipe((0,nn.n)(n=>this.purchaseService.getBatch(n).pipe((0,Le.W)(i=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0437\u0430\u043a\u0443\u043f\u043a\u0438",severity:"error",detail:i}),Nt.w))))).subscribe(n=>{this.batchPackages=n.items.map(i=>i.product.packages).flat(),n.items.forEach(i=>{const s=i.product.packages.reduce((o,l)=>(o.set(l.iD,l),o),new Map);i.salesItems.forEach(o=>{let l={productPackage:s.get(o.productPackageID)};Object.assign(o,l);const g=this.salesChannels.getValue();o.salesPlans.forEach(u=>{const h=g.find(A=>A.iD==u.salesChannelID);if(h){const A=u.salesChannel?.logisticCoefficients;Object.assign(u,{salesChannel:h,selectedLogisticCoefficient:A?.length?A[A.length-1]:null,baseLogisticCost:this.getBaseLogisticCost(o.volume,h.logisticPrices),baseBackwardLogisticCost:this.getBaseLogisticCost(o.volume,h.backwardLogisticPrices)})}})})}),this.calculation=n,this.titleService.setTitle(`\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0437\u0430\u043a\u0443\u043f\u043a\u0438 - ${n.name}`)}),this.productSearchSubject.pipe((0,Da.Q)(this.destroyed)).pipe((0,nn.n)(n=>this.productClient.findProducts(new At.D.FindProductsModel({count:10,offset:0,name:n,excludedIDs:this.calculation.items.map(i=>i.productID)})).pipe((0,Le.W)(i=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u043e\u0438\u0441\u043a\u0430 \u0442\u043e\u0432\u0430\u0440\u043e\u0432",severity:"error",detail:i}),Nt.w))))).subscribe(n=>{this.products.next(n.items)}),this.salesChannelClient.getSalesChannels().pipe((0,Le.W)(n=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0441\u043f\u0438\u0441\u043a\u0430 \u043a\u0430\u043d\u0430\u043b\u043e\u0432 \u043f\u0440\u043e\u0434\u0430\u0436",severity:"error",detail:n}),Nt.w))).subscribe(n=>{const i=n.map(s=>{const o=s.logisticCoefficients.sort((g,u)=>g.priority-u.priority||g.name.localeCompare(u.name));return s.logisticPrices.sort((g,u)=>u.maxVolume-g.maxVolume),s.backwardLogisticPrices.sort((g,u)=>u.maxVolume-g.maxVolume),Object.assign(s,{logisticCoefficients:o})});this.salesChannels.next(i)});const t=+this.route.snapshot.paramMap.get("id");t>0&&t!=this.calculation?.iD?this.purchaseBatchIDSubject.next(t):this.calculation=new At.D.PurchaseBatch({date:new Date,status:At.D.PurchaseBatchStatus.Unknown,items:[],name:"\u041d\u043e\u0432\u0430\u044f \u0437\u0430\u043a\u0443\u043f\u043a\u0430",iD:0})}addSalesPlan(t,n){if(n){t.salesPlans||(t.salesPlans=[]);const i=this.getSalesItemProductPackage(t),s=this.getProductPackageBatchItem(i),o={salesItem:null,salesItemID:t.iD,iD:0,salesPerMonth:0,salesChannel:n,salesChannelID:n.iD,commissionAddition:0,commissionMultiplier:0,returnPercentage:0,returnCost:0,amount:0,marketingBudget:0,deliveryCost:0,deliveryDate:new Date,status:At.D.SalesPlanStatus.InProcess,price:s.price+t.packagingPrice+this.getPackagePrice(t),baseLogisticCost:this.getBaseLogisticCost(t.volume,n.logisticPrices),baseBackwardLogisticCost:this.getBaseLogisticCost(t.volume,n.backwardLogisticPrices),selectedLogisticCoefficient:null},l=new At.D.SalesPlan(o);t.salesPlans.push(l),this.salesChannelDropdown.clear(null)}}getSalesItemProductPackage(t){return this.getProductPackageBatchItem(t.productPackage).product.packages.find(s=>s.iD==t.productPackageID)}getProductPackageBatchItem(t){return this.calculation.items.find(i=>i.productID==t.productID)}addSalesItem(t){if(t){const n=this.getProductPackageBatchItem(t),i=this.createNewSalesItem(t,n);n.salesItems.push(i),this.productPackageDropdown.clear()}}removeItem(t,n){t.splice(n,1)}getAvailablePackageTypes(t){const n=[],i=new Set(t.salesItemPackages.map(o=>o.packageTypeID)),s=this.purchaseService.getPackageTypes();for(const o of s)i.has(o.iD)||n.push(o);return n}addSalesItemPackage(t,n){n&&(t.salesItemPackages.push(new At.D.SalesItemPackage({packageTypeID:n.iD,amount:0,pricePerUom:n.price??0,salesItemID:t.iD})),this.packageTypeDropdown.clear(null))}getSelfCost(t,n,i){return this.purchaseService.getSalesPlanSelfCost(t,n,i)}getCommission(t){return this.purchaseService.getSalesPlanCommission(t)}getPackagePrice(t){return this.purchaseService.getSalesItemCosts(t)}getPackageType(t){return this.purchaseService.getPackageType(t)}findProductsByName(t){t.query.trim().length>2&&this.productSearchSubject.next(t.query)}addProduct(t){const n=t.value;if(n){this.productAutocomplete.clear();const i=this.calculation.items.find(s=>s.productID==n.iD);if(this.selectedProduct=null,i)this.addedProduct=n;else{const s=new At.D.PurchaseBatchItem({productID:n.iD,count:0,product:n,purchaseBatchID:this.calculation.iD,price:0,salesItems:[],iD:0});this.calculation.items.push(s),this.batchPackages.push(...n.packages)}}}savePurchaseBatch(){this.loading=!0,this.purchaseBatchCommandHandlerClient.updatePurchaseBatch(this.calculation).pipe((0,Le.W)(t=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0437\u0430\u043a\u0443\u043f\u043a\u0438",severity:"error",detail:t}),this.loading=!1,Nt.w))).subscribe(t=>{this.calculation.iD||this.router.navigate(["purchase","edit",{id:t}]),this.purchaseService.getBatch(t).pipe((0,Le.W)(n=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0437\u0430\u043a\u0443\u043f\u043a\u0438",severity:"error",detail:n}),this.loading=!1,Nt.w))).subscribe(n=>{this.calculation=n,this.loading=!1,this.messageService.add({summary:"\u0423\u0441\u043f\u0435\u0445",severity:"success",detail:"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435 \u0437\u0430\u043a\u0443\u043f\u043a\u0438 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u043e"})})})}getUnitOfMeasureByPackageTypeID(t){const i=this.purchaseService.getPackageTypes().find(s=>s.iD==t);return i?this.getUnitOfMeasure(i.unitOfMeasure):"?"}getUnitOfMeasure(t){let n;switch(t){case At.D.UnitOfMeasure.Piece:n="\u0448\u0442";break;case At.D.UnitOfMeasure.SquareMeter:n="\u043c&sup2;";break;default:n=""}return n}onVolumeUpdated(t){t.salesPlans.forEach(n=>{n.baseLogisticCost=this.getBaseLogisticCost(t.volume,n.salesChannel.logisticPrices),n.baseBackwardLogisticCost=this.getBaseLogisticCost(t.volume,n.salesChannel.backwardLogisticPrices)})}createNewSalesItem(t,n){return new At.D.SalesItem({packagingPrice:0,volume:0,salesItemPackages:[],salesPlans:[],iD:0,name:"\u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u0430\u044f \u0443\u043f\u0430\u043a\u043e\u0432\u043a\u0430",productPackageID:t.iD,productPackage:t,purchaseBatchItemID:n.iD})}getBaseLogisticCost(t,n){let s,i=0,o=t;if(n?.length)for(let l=0;l<=n.length;l++){const g=l==n.length?void 0:n[l],u=o-(g?.maxVolume??0);if(s&&(u>0||null==g)&&(i+=Math.ceil(s.additive?u:o)*(s.pricePerUnit??0)+(s.basePrice??0),!s?.additive))break;o>g.maxVolume&&(o=g?.maxVolume??0),s=g}return i}getLogisticPrice(t){const n=t.baseLogisticCost??0,i=t.selectedLogisticCoefficient?.salesPriceMultiplier??0;return Math.floor(100*(n*(t.selectedLogisticCoefficient?.logisticPriceMultiplier??1)+(t.selectedLogisticCoefficient?.logisticPriceAddition??0)+t.price*i))/100}getBackwardLogisticPrice(t){const n=t.baseBackwardLogisticCost??0,i=t.selectedLogisticCoefficient?.salesPriceMultiplier??0;return Math.floor(100*(n*(t.selectedLogisticCoefficient?.logisticPriceMultiplier??1)+(t.selectedLogisticCoefficient?.logisticPriceAddition??0)+(t.salesChannel?.cancelledSaleHandlingPrice??0)+t.price*i))/100}static{this.\u0275fac=function(n){return new(n||e)(a.rXU(Ye.nX),a.rXU(At.D.ProductClient),a.rXU(it.X.PurchaseBatchClient),a.rXU(At.D.SalesChannelClient),a.rXU(Ze.bg),a.rXU(Na),a.rXU(Ye.Ix),a.rXU(Ut.hE))}}static{this.\u0275cmp=a.VBU({type:e,selectors:[["app-purchase-editor"]],viewQuery:function(n,i){if(1&n&&(a.GBs(ou,5),a.GBs(lu,5),a.GBs(cu,5),a.GBs(gu,5)),2&n){let s;a.mGM(s=a.lsd())&&(i.productPackageDropdown=s.first),a.mGM(s=a.lsd())&&(i.packageTypeDropdown=s.first),a.mGM(s=a.lsd())&&(i.salesChannelDropdown=s.first),a.mGM(s=a.lsd())&&(i.productAutocomplete=s.first)}},features:[a.Vt3],decls:2,vars:1,consts:[["productPackageDropdown",""],["productAutocomplete",""],["packageTypeDropdown",""],["salesChannelDropdown",""],["class","card",4,"ngIf"],[1,"card"],[1,"p-float-label"],["id","productName","pInputText","","type","text",1,"w-full","md:w-30rem","mb-5","p-3",3,"ngModelChange","ngModel"],["for","productName",1,"font-bold"],["dateFormat","dd.mm.yy","input","date","placeholder","\u0414\u0430\u0442\u0430 \u0437\u0430\u043a\u0443\u043f\u043a\u0438",3,"ngModelChange","ngModel","readonlyInput"],["dateFormat","dd.mm.yy","for","date",1,"font-bold"],[1,"mt-3"],["icon","pi pi-save","label","\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",3,"click"],["styleClass","tabview-custom"],["pTemplate","header"],["pTemplate","body"],["appendTo","body","optionGroupChildren","product.packages","placeholder","\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0430\u0440\u0442\u0438\u043a\u0443\u043b","styleClass","m-3",3,"onChange","ngModelChange","ngModel","options"],["pTemplate","item"],["pTemplate","selectedItem"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"pi","pi-shopping-cart","pi-fw"],[3,"value",4,"ngIf"],["field","name","placeholder","\u041f\u043e\u0438\u0441\u043a \u0442\u043e\u0432\u0430\u0440\u0430","styleClass","mb-3",3,"completeMethod","onSelect","minLength","suggestions"],[3,"value"],["pTemplate","footer"],["width","10%"],["icon","pi pi-trash",3,"click"],["pEditableColumnField","count",1,"text-right",3,"pEditableColumn"],["pTemplate","input"],["pTemplate","output"],["pEditableColumnField","price",1,"text-right",3,"pEditableColumn"],[3,"ngModelChange","ngModel","min","required","useGrouping"],[3,"ngModelChange","ngModel","maxFractionDigits","min","required","useGrouping"],["colspan","3",1,"text-right"],[1,"text-right"],[1,"flex","align-items-center","gap-2"],[1,"pi","pi-box","pi-fw"],["transitionOptions","50ms"],["pTemplate","content"],[1,"card","m-2"],["icon","pi pi-trash","label","\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0442\u0438\u043f\u043e\u0444\u043e\u0440\u043c\u0430\u0442","styleClass","mb-3",3,"click"],[1,"grid"],[1,"col","xs:col-12"],["for","name"],["inputId","name","maxlength","100","pInputText","",3,"ngModelChange","ngModel"],["for","volume"],[1,"p-inputgroup"],["inputId","volume",3,"onInput","ngModelChange","ngModel","maxFractionDigits","minFractionDigits","min","showButtons","step","useGrouping"],[1,"p-inputgroup-addon"],["for","packagingPrice"],["inputId","packagingPrice",3,"ngModelChange","ngModel","maxFractionDigits","minFractionDigits","showButtons","step","useGrouping"],["appendTo","body","optionLabel","name","placeholder","\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043e\u0444\u043e\u0440\u043c\u043b\u0435\u043d\u0438\u0435","styleClass","m-3",3,"onChange","options"],["appendTo","body","optionLabel","\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u043b\u0430\u043d \u043f\u0440\u043e\u0434\u0430\u0436","placeholder","\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u043b\u0430\u043d \u043f\u0440\u043e\u0434\u0430\u0436","styleClass","m-3",3,"onChange","autoDisplayFirst","options"],["icon","pi pi-trash","styleClass","p-button-sm",3,"click"],["pEditableColumnField","amount",1,"text-right",3,"pEditableColumn"],["pEditableColumnField","pricePerUom",1,"text-right",3,"pEditableColumn"],[3,"ngModelChange","ngModel","maxFractionDigits","minFractionDigits","min","showButtons","step","useGrouping"],[1,"p-inputgroup-addon",3,"innerHtml"],[3,"innerHtml"],["emptyValue","empty",3,"ngModelChange","ngModel","maxFractionDigits","minFractionDigits","min","showButtons","step","useGrouping"],[3,"innerHTML"],["pEditableColumn","",1,"text-right"],["pEditableColumnField","commissionAddition",1,"text-right",3,"pEditableColumn"],["pEditableColumnField","returnCost",1,"text-right",3,"pEditableColumn"],["rowspan","3"],["pEditableColumnField","price","rowspan","2",1,"text-right",3,"pEditableColumn"],["rowspan","2",1,"text-right"],["pTooltip","\u0421\u0435\u0431\u0435\u0441\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c \u043f\u0440\u0438 \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u043e\u0442\u043f\u0443\u0441\u043a\u043d\u043e\u0439 \u0446\u0435\u043d\u0435"],["pEditableColumn",""],["pEditableColumnField","marketingBudget","rowspan","3",1,"text-right",3,"pEditableColumn"],["pEditableColumnField","amount","rowspan","3",1,"text-right",3,"pEditableColumn"],["pEditableColumnField","commissionMultiplier",1,"text-right",3,"pEditableColumn"],["pEditableColumnField","returnPercentage",1,"text-right",3,"pEditableColumn"],[3,"ngModelChange","ngModel","maxFractionDigits","minFractionDigits","min","required","showButtons","step","useGrouping"],[3,"severity"],["inputId","deliveryCost",3,"ngModelChange","ngModel","maxFractionDigits","minFractionDigits","min","required","showButtons","step","useGrouping"],["pTooltip","\u0417\u0430\u0442\u0440\u0430\u0442\u044b \u043d\u0430 \u0434\u043e\u0441\u0442\u0430\u0432\u043a\u0443 \u043f\u0430\u0440\u0442\u0438\u0438 \u0434\u043e \u0442\u043e\u0447\u043a\u0438 \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 (\u0434\u043e\u0441\u0442\u0430\u0432\u043a\u0430 \u0434\u043e \u0442\u0440\u0430\u043d\u0437\u0438\u0442\u043d\u043e\u0433\u043e \u0441\u043a\u043b\u0430\u0434\u0430, \u043a\u0440\u043e\u0441\u0441-\u0434\u043e\u043a\u0438\u043d\u0433 \u0438 \u0442.\u043f.)",1,"text-right"],[3,"ngModelChange","ngModel","min","required","showButtons","step","useGrouping"],["pTooltip","\u0421\u0443\u043c\u043c\u0430 \u0432\u0441\u0435\u0445 \u043f\u0440\u043e\u0446\u0435\u043d\u0442\u043d\u044b\u0445 \u043a\u043e\u043c\u0438\u0441\u0441\u0438\u0439 (\u043a\u043e\u043c\u0438\u0441\u0441\u0438\u044f \u043a\u0430\u043d\u0430\u043b\u0430 \u043f\u0440\u043e\u0434\u0430\u0436, \u044d\u043a\u0432\u0430\u0439\u0440\u0438\u043d\u0433 \u0438 \u0442.\u043f.)"],["appendTo","body","dateFormat","dd.mm.yy","input","date","placeholder","\u0414\u0430\u0442\u0430 \u043e\u0442\u0433\u0440\u0443\u0437\u043a\u0438",3,"ngModelChange","ngModel","readonlyInput"],["pTooltip","\u0421\u0443\u043c\u043c\u0430 \u0432\u0441\u0435\u0445 \u0444\u0438\u043a\u0441\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u043a\u043e\u043c\u0438\u0441\u0441\u0438\u0439 (\u0434\u043e\u0441\u0442\u0430\u0432\u043a\u0430 \u0434\u043e \u043f\u043e\u043a\u0443\u043f\u0430\u0442\u0435\u043b\u044f, \u041f\u0412\u0417 \u0438 \u0442.\u043f.)"],["pTooltip","\u0421\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u043e\u0442\u043c\u0435\u043d\u044b"],["pTooltip","\u0421\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c \u043e\u0431\u0440\u0430\u0442\u043d\u043e\u0439 \u043b\u043e\u0433\u0438\u0441\u0442\u0438\u043a\u0438"],["class","p-tag p-danger cursor-pointer",3,"pTooltip","click",4,"ngIf"],[1,"p-tag","p-danger","cursor-pointer",3,"click","pTooltip"],["appendTo","body","optionLabel","name","placeholder","\u041a\u043e\u044d\u0444\u0444\u0438\u0446\u0438\u0435\u043d\u0442 \u043b\u043e\u0433\u0438\u0441\u0442\u0438\u043a\u0438",3,"ngModelChange","ngModel","options"],["pTooltip","\u0421\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c \u043b\u043e\u0433\u0438\u0441\u0442\u0438\u043a\u0438",4,"ngIf"],["pTooltip","\u0421\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c \u043b\u043e\u0433\u0438\u0441\u0442\u0438\u043a\u0438"],["header","\u041e\u0448\u0438\u0431\u043a\u0430",3,"visibleChange","visible","draggable","modal","resizable"],[1,"m-0"]],template:function(n,i){1&n&&(a.nrm(0,"p-toast"),a.DNE(1,_h,27,7,"div",4)),2&n&&(a.R7$(),a.Y8G("ngIf",i.calculation))},dependencies:[Bi.nD,Bi.gV,Ze.Ei,Ri.j9,Gr.$n,ws.Vv,Oe.Sq,Oe.bT,ys.l,Pa.ms,nr.me,nr.BC,nr.YS,nr.tU,nr.vS,Ra.YI,Oi.S,f0,g0,jr.XI,jr.hp,jr.c5,u0.v,hi.y8,Ma.m,Oe.Jj,Oe.QX,Oe.vh,h0]})}}return e})();const vh=e=>({id:e}),kh=e=>["/purchase","edit",e];function wh(e,r){if(1&e&&(a.j41(0,"div",4)(1,"h5"),a.EFF(2,"\u0417\u0430\u043a\u0443\u043f\u043a\u0430"),a.k0s(),a.j41(3,"div",5)(4,"div",6)(5,"div",7)(6,"span",8),a.EFF(7,"\u0421\u0443\u043c\u043c\u0430 \u0437\u0430\u043a\u0443\u043f\u043a\u0438:"),a.k0s(),a.j41(8,"span"),a.EFF(9),a.k0s()(),a.j41(10,"div",7)(11,"span",8),a.EFF(12,"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043f\u043e\u0437\u0438\u0446\u0438\u0439:"),a.k0s(),a.j41(13,"span"),a.EFF(14),a.k0s()(),a.j41(15,"div",7)(16,"span",8),a.EFF(17,"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0442\u043e\u0432\u0430\u0440\u043e\u0432:"),a.k0s(),a.j41(18,"span"),a.EFF(19),a.k0s()()()()()),2&e){const t=a.XpG(2);a.R7$(9),a.SpI("",t.batchInfo.sum,"\u20bd"),a.R7$(5),a.JRh(t.batchInfo.positionCount),a.R7$(5),a.JRh(t.batchInfo.productCount)}}function yh(e,r){if(1&e&&(a.j41(0,"div",11)(1,"div",7)(2,"div",8),a.EFF(3,"\u0422\u043e\u0432\u0430\u0440:"),a.k0s(),a.j41(4,"div"),a.EFF(5),a.k0s()(),a.j41(6,"div",7)(7,"div",8),a.EFF(8,"\u041f\u0440\u043e\u0434\u0430\u0436\u0438, \u043f\u043b\u0430\u043d:"),a.k0s(),a.j41(9,"div"),a.EFF(10),a.k0s()(),a.j41(11,"div",7)(12,"div",8),a.EFF(13,"\u041f\u0440\u043e\u0434\u0430\u0436\u0438, \u0444\u0430\u043a\u0442:"),a.k0s(),a.j41(14,"div"),a.EFF(15),a.k0s()(),a.j41(16,"div",7)(17,"div",8),a.EFF(18,"\u041f\u0440\u043e\u0434\u0430\u0436\u0438, \u043f\u043b\u0430\u043d:"),a.k0s(),a.j41(19,"div"),a.EFF(20),a.nI1(21,"number"),a.k0s()(),a.j41(22,"div",7)(23,"div",8),a.EFF(24,"\u041f\u0440\u043e\u0434\u0430\u0436\u0438, \u0444\u0430\u043a\u0442:"),a.k0s(),a.j41(25,"div"),a.EFF(26),a.nI1(27,"number"),a.k0s()(),a.j41(28,"div",7)(29,"div",8),a.EFF(30,"\u041a\u043e\u043c\u0438\u0441\u0441\u0438\u044f, \u043f\u043b\u0430\u043d:"),a.k0s(),a.j41(31,"div"),a.EFF(32),a.nI1(33,"number"),a.k0s()(),a.j41(34,"div",7)(35,"div",8),a.EFF(36,"\u041a\u043e\u043c\u0438\u0441\u0441\u0438\u044f, \u0444\u0430\u043a\u0442:"),a.k0s(),a.j41(37,"div"),a.EFF(38),a.nI1(39,"number"),a.k0s()(),a.j41(40,"div",7)(41,"div",8),a.EFF(42,"\u0414\u043e\u0441\u0442\u0430\u0432\u043a\u0430, \u043f\u043b\u0430\u043d:"),a.k0s(),a.j41(43,"div"),a.EFF(44),a.nI1(45,"number"),a.k0s()(),a.j41(46,"div",7)(47,"div",8),a.EFF(48,"\u0414\u043e\u0441\u0442\u0430\u0432\u043a\u0430, \u0444\u0430\u043a\u0442:"),a.k0s(),a.j41(49,"div"),a.EFF(50),a.nI1(51,"number"),a.k0s()(),a.j41(52,"div",7)(53,"div",8),a.EFF(54,"\u0412\u043e\u0437\u0432\u0440\u0430\u0442\u044b, \u043f\u043b\u0430\u043d:"),a.k0s(),a.j41(55,"div"),a.EFF(56),a.k0s()(),a.j41(57,"div",7)(58,"div",8),a.EFF(59,"\u0412\u043e\u0437\u0432\u0440\u0430\u0442\u044b, \u0444\u0430\u043a\u0442:"),a.k0s(),a.j41(60,"div"),a.EFF(61),a.k0s()(),a.j41(62,"div",7)(63,"div",8),a.EFF(64,"\u041f\u0440\u0438\u0431\u044b\u043b\u044c, \u043f\u043b\u0430\u043d:"),a.k0s(),a.j41(65,"div"),a.EFF(66),a.nI1(67,"number"),a.k0s()(),a.j41(68,"div",7)(69,"div",8),a.EFF(70,"\u041f\u0440\u0438\u0431\u044b\u043b\u044c, \u0444\u0430\u043a\u0442:"),a.k0s(),a.j41(71,"div"),a.EFF(72),a.nI1(73,"number"),a.k0s()()()),2&e){const t=r.$implicit;a.R7$(5),a.JRh(t.name),a.R7$(5),a.SpI("",t.plannedAmount,"\u0448\u0442"),a.R7$(5),a.SpI("",t.soldAmount,"\u0448\u0442"),a.R7$(5),a.SpI("",a.i5U(21,13,t.plannedSum,"1.2-2"),"\u20bd"),a.R7$(6),a.SpI("",a.i5U(27,16,t.soldSum,"1.2-2"),"\u20bd"),a.R7$(6),a.SpI("",a.i5U(33,19,t.plannedCommissionPercent,"1.2-2"),"\u20bd"),a.R7$(6),a.SpI("",a.i5U(39,22,t.commissionPercent,"1.2-2"),"\u20bd"),a.R7$(6),a.SpI("",a.i5U(45,25,t.plannedCommissionAddition,"1.2-2"),"\u20bd"),a.R7$(6),a.SpI("",a.i5U(51,28,t.commissionAddition,"1.2-2"),"\u20bd"),a.R7$(6),a.SpI("",t.plannedReturnCount,"\u0448\u0442"),a.R7$(5),a.SpI("",t.returnCount,"\u0448\u0442"),a.R7$(5),a.SpI("",a.i5U(67,31,t.plannedProfit,"1.2-2"),"\u20bd"),a.R7$(6),a.SpI("",a.i5U(73,34,t.profit,"1.2-2"),"\u20bd")}}function Th(e,r){if(1&e&&(a.j41(0,"div",4)(1,"h5"),a.EFF(2),a.k0s(),a.j41(3,"div",5),a.DNE(4,yh,74,37,"div",10),a.k0s()()),2&e){const t=r.$implicit;a.R7$(2),a.SpI(" ",t.name," "),a.R7$(2),a.Y8G("ngForOf",t.plans)}}function Sh(e,r){if(1&e&&(a.j41(0,"div",4)(1,"h4"),a.EFF(2,"\u041f\u043b\u0430\u043d\u044b \u043f\u0440\u043e\u0434\u0430\u0436"),a.k0s(),a.DNE(3,Th,5,2,"div",9),a.k0s()),2&e){const t=a.XpG(2);a.R7$(3),a.Y8G("ngForOf",t.salesInfo.salesChannels)}}function bh(e,r){if(1&e){const t=a.RV6();a.qex(0),a.j41(1,"h1"),a.EFF(2),a.k0s(),a.j41(3,"p-button",1),a.bIt("click",function(){a.eBV(t);const i=a.XpG();return a.Njj(i.calcPlans())}),a.k0s(),a.nrm(4,"p-button",2),a.DNE(5,wh,20,3,"div",3)(6,Sh,4,1,"div",3),a.bVm()}if(2&e){const t=a.XpG();a.R7$(2),a.JRh(t.batch.name),a.R7$(2),a.Y8G("routerLink",a.eq3(6,kh,a.eq3(4,vh,t.batch.iD))),a.R7$(),a.Y8G("ngIf",t.batchInfo),a.R7$(),a.Y8G("ngIf",t.salesInfo)}}let Eh=(()=>{class e extends Or.x{constructor(t,n,i){super(i),this.purchaseService=t,this.route=n,this.batchID=new Fr.t(null),this.salesPlanIDs=new Fr.t([])}ngOnInit(){this.titleService.setTitle("\u0421\u0432\u043e\u0434\u043a\u0430 \u043f\u043e \u0437\u0430\u043a\u0443\u043f\u043a\u0435");const t=+this.route.snapshot.paramMap.get("id");t>0&&this.batchID.next(t),this.batchID.pipe((0,Da.Q)(this.destroyed)).pipe((0,Fn.p)(n=>!!n)).pipe((0,nn.n)(n=>this.purchaseService.getBatch(n))).subscribe(n=>{this.batch=n,this.updateBatchInfo(),this.titleService.setTitle(`\u0421\u0432\u043e\u0434\u043a\u0430 \u043f\u043e \u0437\u0430\u043a\u0443\u043f\u043a\u0435 - ${n.name}`)}),this.salesPlanIDs.pipe((0,Da.Q)(this.destroyed)).pipe((0,Fn.p)(n=>!!n?.length)).pipe((0,nn.n)(n=>this.purchaseService.getSalesPlansSummaries(n))).subscribe(n=>{this.summaries=n,this.salesInfo=this.getSalesInfo(this.batch,n)})}updateBatchInfo(){this.batchInfo=this.batch?this.getBatchInfo(this.batch):{},this.salesInfo={},this.summaries=[],this.salesPlanIDs.next(this.batch.items.reduce((t,n)=>n.salesItems.reduce((i,s)=>s.salesPlans.reduce((o,l)=>(t.push(l.iD),t),t),t),[]))}getBatchInfo(t){const n={};return n.sum=t.items.reduce((i,s)=>i+s.count*s.price,0),n.productCount=t.items.reduce((i,s)=>i+s.count,0),n.positionCount=t.items.length,n}getSalesInfo(t,n){const i={},s=[];for(const o of t.items)for(const g of o.salesItems){this.purchaseService.getSalesItemCosts(g);for(const h of g.salesPlans){const A=n.find(w=>w.iD==h.iD);let C=s.find(w=>w.channelID==h.salesChannelID);C||(C={channelID:h.salesChannelID,name:h.salesChannel.name,plans:[]},s.push(C)),this.purchaseService.getSalesPlanSelfCost(g,h,o);const p=this.purchaseService.getSalesPlanSelfCost(g,h,o)*h.amount,d=this.purchaseService.getSalesItemCosts(g)*h.amount;C.plans.push({name:g.productPackage.name+", "+g.name,plannedAmount:h.amount,soldAmount:A.salesCount,plannedSum:h.price*h.amount,soldSum:A.salesSum,plannedCommissionAddition:-h.commissionAddition*h.amount,plannedCommissionPercent:-Math.ceil(h.amount*h.price*h.commissionMultiplier/100),commissionAddition:A.commissionAddition,commissionPercent:A.commissionPercent,plannedReturnCount:Math.ceil(h.amount*h.returnPercentage/100),returnCount:A.returnCount,plannedProfit:h.amount*h.price-p-h.deliveryCost,profit:A.salesSum-A.returnSum+A.commissionPercent+A.commissionAddition-d-h.deliveryCost-o.count*o.price})}}return i.salesChannels=s,i}calcPlans(){this.purchaseService.calcPlans()}static{this.\u0275fac=function(n){return new(n||e)(a.rXU(Na),a.rXU(Ye.nX),a.rXU(Ut.hE))}}static{this.\u0275cmp=a.VBU({type:e,selectors:[["app-purchase-summary"]],inputs:{batchID:"batchID"},features:[a.Jv_([{provide:nr.kq,useExisting:(0,a.Rfq)(()=>e),multi:!0}]),a.Vt3],decls:1,vars:1,consts:[[4,"ngIf"],["styleClass","mb-3","label","\u041f\u0435\u0440\u0435\u0441\u0447\u0438\u0442\u0430\u0442\u044c",3,"click"],["styleClass","mb-3","label","\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0437\u0430\u043a\u0443\u043f\u043a\u0443",3,"routerLink"],["class","card",4,"ngIf"],[1,"card"],[1,"grid"],[1,"col-12","md:col-6","xl:col-4"],[1,"flex","justify-content-between"],[1,"font-bold","text-900"],["class","card",4,"ngFor","ngForOf"],["class","col-6 md:col-12 xl:col-4",4,"ngFor","ngForOf"],[1,"col-6","md:col-12","xl:col-4"]],template:function(n,i){1&n&&a.DNE(0,bh,7,8,"ng-container",0),2&n&&a.Y8G("ngIf",i.batch)},dependencies:[Gr.$n,Oe.Sq,Oe.bT,Ye.Wk,Oe.QX]})}}return e})();var C0=Fe(2356),Li=Fe(9071),I0=Fe(3306),La=Fe(2423),A0=Fe(5434),p0=Fe(6018),Ua=Fe(5998),Ts=Fe(8757);const d0=e=>({"p-treenode-droppoint-active":e}),Fh=(e,r)=>["p-treenode",e,r],m0=e=>({height:e}),Dh=e=>({"padding-left":e}),Nh=(e,r,t)=>({"p-treenode-selectable":e,"p-treenode-dragover":r,"p-highlight":t}),Ga=e=>({$implicit:e}),Ph=(e,r)=>({"p-checkbox-disabled p-disabled":e,"p-variant-filled":r}),Rh=(e,r)=>({"p-highlight":e,"p-indeterminate":r}),Oh=(e,r)=>({$implicit:e,partialSelected:r}),_0=e=>({display:e}),Bh=e=>({"p-treenode-collapsed":e}),Mh=(e,r)=>({"p-treenode-selectable":e,"p-highlight":r}),x0=e=>({"p-treenode-connector-line":e});function Lh(e,r){if(1&e){const t=a.RV6();a.j41(0,"li",4),a.bIt("drop",function(i){a.eBV(t);const s=a.XpG(2);return a.Njj(s.onDropPoint(i,-1))})("dragover",function(i){a.eBV(t);const s=a.XpG(2);return a.Njj(s.onDropPointDragOver(i))})("dragenter",function(i){a.eBV(t);const s=a.XpG(2);return a.Njj(s.onDropPointDragEnter(i,-1))})("dragleave",function(i){a.eBV(t);const s=a.XpG(2);return a.Njj(s.onDropPointDragLeave(i))}),a.k0s()}if(2&e){const t=a.XpG(2);a.Y8G("ngClass",a.eq3(2,d0,t.draghoverPrev)),a.BMQ("aria-hidden",!0)}}function Uh(e,r){1&e&&a.nrm(0,"ChevronRightIcon",14),2&e&&a.Y8G("styleClass","p-tree-toggler-icon")}function Gh(e,r){1&e&&a.nrm(0,"ChevronDownIcon",14),2&e&&a.Y8G("styleClass","p-tree-toggler-icon")}function jh(e,r){if(1&e&&(a.qex(0),a.DNE(1,Uh,1,1,"ChevronRightIcon",13)(2,Gh,1,1,"ChevronDownIcon",13),a.bVm()),2&e){const t=a.XpG(4);a.R7$(),a.Y8G("ngIf",!t.node.expanded),a.R7$(),a.Y8G("ngIf",t.node.expanded)}}function Vh(e,r){1&e&&(a.qex(0),a.nrm(1,"SpinnerIcon",15),a.bVm()),2&e&&(a.R7$(),a.Y8G("spin",!0)("styleClass","p-tree-node-toggler-icon"))}function $h(e,r){if(1&e&&(a.qex(0),a.DNE(1,jh,3,2,"ng-container",8)(2,Vh,2,2,"ng-container",8),a.bVm()),2&e){const t=a.XpG(3);a.R7$(),a.Y8G("ngIf",!t.node.loading),a.R7$(),a.Y8G("ngIf","icon"===t.loadingMode&&t.node.loading)}}function Wh(e,r){}function Xh(e,r){1&e&&a.DNE(0,Wh,0,0,"ng-template")}function zh(e,r){if(1&e&&(a.j41(0,"span",16),a.DNE(1,Xh,1,0,null,17),a.k0s()),2&e){const t=a.XpG(3);a.R7$(),a.Y8G("ngTemplateOutlet",t.tree.togglerIconTemplate)("ngTemplateOutletContext",a.eq3(2,Ga,t.node.expanded))}}function Hh(e,r){1&e&&a.nrm(0,"CheckIcon",14),2&e&&a.Y8G("styleClass","p-checkbox-icon")}function Yh(e,r){1&e&&a.nrm(0,"MinusIcon",14),2&e&&a.Y8G("styleClass","p-checkbox-icon")}function Jh(e,r){if(1&e&&(a.qex(0),a.DNE(1,Hh,1,1,"CheckIcon",13)(2,Yh,1,1,"MinusIcon",13),a.bVm()),2&e){const t=a.XpG(4);a.R7$(),a.Y8G("ngIf",!t.node.partialSelected&&t.isSelected()),a.R7$(),a.Y8G("ngIf",t.node.partialSelected)}}function Kh(e,r){}function Zh(e,r){1&e&&a.DNE(0,Kh,0,0,"ng-template")}function Qh(e,r){if(1&e&&(a.j41(0,"div",18)(1,"div",19),a.DNE(2,Jh,3,2,"ng-container",8)(3,Zh,1,0,null,17),a.k0s()()),2&e){const t=a.XpG(3);a.Y8G("ngClass",a.l_i(5,Ph,!1===t.node.selectable,"filled"===(null==t.tree?null:t.tree.config.inputStyle()))),a.R7$(),a.Y8G("ngClass",a.l_i(8,Rh,t.isSelected(),t.node.partialSelected)),a.R7$(),a.Y8G("ngIf",!t.tree.checkboxIconTemplate),a.R7$(),a.Y8G("ngTemplateOutlet",t.tree.checkboxIconTemplate)("ngTemplateOutletContext",a.l_i(11,Oh,t.isSelected(),t.node.partialSelected))}}function qh(e,r){if(1&e&&a.nrm(0,"span"),2&e){const t=a.XpG(3);a.HbH(t.getIcon())}}function eC(e,r){if(1&e&&(a.j41(0,"span"),a.EFF(1),a.k0s()),2&e){const t=a.XpG(3);a.R7$(),a.JRh(t.node.label)}}function tC(e,r){1&e&&a.eu8(0)}function rC(e,r){if(1&e&&(a.j41(0,"span"),a.DNE(1,tC,1,0,"ng-container",17),a.k0s()),2&e){const t=a.XpG(3);a.R7$(),a.Y8G("ngTemplateOutlet",t.tree.getTemplateForNode(t.node))("ngTemplateOutletContext",a.eq3(2,Ga,t.node))}}function nC(e,r){if(1&e&&a.nrm(0,"p-treeNode",22),2&e){const t=r.$implicit,n=r.first,i=r.last,s=r.index,o=a.XpG(4);a.Y8G("node",t)("parentNode",o.node)("firstChild",n)("lastChild",i)("index",s)("itemSize",o.itemSize)("level",o.level+1)("loadingMode",o.loadingMode)}}function iC(e,r){if(1&e&&(a.j41(0,"ul",20),a.DNE(1,nC,1,8,"p-treeNode",21),a.k0s()),2&e){const t=a.XpG(3);a.Y8G("ngStyle",a.eq3(3,_0,t.node.expanded?"block":"none")),a.R7$(),a.Y8G("ngForOf",t.node.children)("ngForTrackBy",t.tree.trackBy)}}function aC(e,r){if(1&e){const t=a.RV6();a.j41(0,"li",5),a.bIt("keydown",function(i){a.eBV(t);const s=a.XpG(2);return a.Njj(s.onKeyDown(i))}),a.j41(1,"div",6),a.bIt("click",function(i){a.eBV(t);const s=a.XpG(2);return a.Njj(s.onNodeClick(i))})("contextmenu",function(i){a.eBV(t);const s=a.XpG(2);return a.Njj(s.onNodeRightClick(i))})("touchend",function(){a.eBV(t);const i=a.XpG(2);return a.Njj(i.onNodeTouchEnd())})("drop",function(i){a.eBV(t);const s=a.XpG(2);return a.Njj(s.onDropNode(i))})("dragover",function(i){a.eBV(t);const s=a.XpG(2);return a.Njj(s.onDropNodeDragOver(i))})("dragenter",function(i){a.eBV(t);const s=a.XpG(2);return a.Njj(s.onDropNodeDragEnter(i))})("dragleave",function(i){a.eBV(t);const s=a.XpG(2);return a.Njj(s.onDropNodeDragLeave(i))})("dragstart",function(i){a.eBV(t);const s=a.XpG(2);return a.Njj(s.onDragStart(i))})("dragend",function(i){a.eBV(t);const s=a.XpG(2);return a.Njj(s.onDragStop(i))}),a.j41(2,"button",7),a.bIt("click",function(i){a.eBV(t);const s=a.XpG(2);return a.Njj(s.toggle(i))}),a.DNE(3,$h,3,2,"ng-container",8)(4,zh,2,4,"span",9),a.k0s(),a.DNE(5,Qh,4,14,"div",10)(6,qh,1,2,"span",3),a.j41(7,"span",11),a.DNE(8,eC,2,1,"span",8)(9,rC,2,4,"span",8),a.k0s()(),a.DNE(10,iC,2,5,"ul",12),a.k0s()}if(2&e){const t=a.XpG(2);a.Aen(t.node.style),a.Y8G("ngClass",a.l_i(24,Fh,t.node.styleClass||"",t.isLeaf()?"p-treenode-leaf":""))("ngStyle",a.eq3(27,m0,t.itemSize+"px")),a.BMQ("aria-label",t.node.label)("aria-checked",t.ariaChecked)("aria-setsize",t.node.children?t.node.children.length:0)("aria-selected",t.ariaSelected)("aria-expanded",t.node.expanded)("aria-posinset",t.index+1)("aria-level",t.level+1)("tabindex",0===t.index?0:-1)("data-id",t.node.key),a.R7$(),a.Y8G("ngStyle",a.eq3(29,Dh,t.level*t.indentation+"rem"))("draggable",t.tree.draggableNodes)("ngClass",a.sMw(31,Nh,t.tree.selectionMode&&!1!==t.node.selectable,t.draghoverNode,t.isSelected())),a.R7$(),a.BMQ("data-pc-section","toggler"),a.R7$(),a.Y8G("ngIf",!t.tree.togglerIconTemplate),a.R7$(),a.Y8G("ngIf",t.tree.togglerIconTemplate),a.R7$(),a.Y8G("ngIf","checkbox"==t.tree.selectionMode),a.R7$(),a.Y8G("ngIf",t.node.icon||t.node.expandedIcon||t.node.collapsedIcon),a.R7$(2),a.Y8G("ngIf",!t.tree.getTemplateForNode(t.node)),a.R7$(),a.Y8G("ngIf",t.tree.getTemplateForNode(t.node)),a.R7$(),a.Y8G("ngIf",!t.tree.virtualScroll&&t.node.children&&t.node.expanded)}}function sC(e,r){if(1&e){const t=a.RV6();a.j41(0,"li",4),a.bIt("drop",function(i){a.eBV(t);const s=a.XpG(2);return a.Njj(s.onDropPoint(i,1))})("dragover",function(i){a.eBV(t);const s=a.XpG(2);return a.Njj(s.onDropPointDragOver(i))})("dragenter",function(i){a.eBV(t);const s=a.XpG(2);return a.Njj(s.onDropPointDragEnter(i,1))})("dragleave",function(i){a.eBV(t);const s=a.XpG(2);return a.Njj(s.onDropPointDragLeave(i))}),a.k0s()}if(2&e){const t=a.XpG(2);a.Y8G("ngClass",a.eq3(2,d0,t.draghoverNext)),a.BMQ("aria-hidden",!0)}}function oC(e,r){if(1&e&&(a.j41(0,"td",28)(1,"table",29)(2,"tbody")(3,"tr"),a.nrm(4,"td",30),a.k0s(),a.j41(5,"tr"),a.nrm(6,"td",30),a.k0s()()()()),2&e){const t=a.XpG(3);a.R7$(4),a.Y8G("ngClass",a.eq3(2,x0,!t.firstChild)),a.R7$(2),a.Y8G("ngClass",a.eq3(4,x0,!t.lastChild))}}function lC(e,r){if(1&e&&a.nrm(0,"PlusIcon",33),2&e){const t=a.XpG(5);a.Y8G("styleClass","p-tree-toggler-icon")("ariaLabel",t.tree.togglerAriaLabel)}}function cC(e,r){if(1&e&&a.nrm(0,"MinusIcon",33),2&e){const t=a.XpG(5);a.Y8G("styleClass","p-tree-toggler-icon")("ariaLabel",t.tree.togglerAriaLabel)}}function gC(e,r){if(1&e&&(a.qex(0),a.DNE(1,lC,1,2,"PlusIcon",32)(2,cC,1,2,"MinusIcon",32),a.bVm()),2&e){const t=a.XpG(4);a.R7$(),a.Y8G("ngIf",!t.node.expanded),a.R7$(),a.Y8G("ngIf",t.node.expanded)}}function fC(e,r){}function uC(e,r){1&e&&a.DNE(0,fC,0,0,"ng-template")}function hC(e,r){if(1&e&&(a.j41(0,"span",16),a.DNE(1,uC,1,0,null,17),a.k0s()),2&e){const t=a.XpG(4);a.R7$(),a.Y8G("ngTemplateOutlet",t.tree.togglerIconTemplate)("ngTemplateOutletContext",a.eq3(2,Ga,t.node.expanded))}}function CC(e,r){if(1&e){const t=a.RV6();a.j41(0,"span",31),a.bIt("click",function(i){a.eBV(t);const s=a.XpG(3);return a.Njj(s.toggle(i))}),a.DNE(1,gC,3,2,"ng-container",8)(2,hC,2,4,"span",9),a.k0s()}if(2&e){const t=a.XpG(3);a.Y8G("ngClass","p-tree-toggler"),a.R7$(),a.Y8G("ngIf",!t.tree.togglerIconTemplate),a.R7$(),a.Y8G("ngIf",t.tree.togglerIconTemplate)}}function IC(e,r){if(1&e&&a.nrm(0,"span"),2&e){const t=a.XpG(3);a.HbH(t.getIcon())}}function AC(e,r){if(1&e&&(a.j41(0,"span"),a.EFF(1),a.k0s()),2&e){const t=a.XpG(3);a.R7$(),a.JRh(t.node.label)}}function pC(e,r){1&e&&a.eu8(0)}function dC(e,r){if(1&e&&(a.j41(0,"span"),a.DNE(1,pC,1,0,"ng-container",17),a.k0s()),2&e){const t=a.XpG(3);a.R7$(),a.Y8G("ngTemplateOutlet",t.tree.getTemplateForNode(t.node))("ngTemplateOutletContext",a.eq3(2,Ga,t.node))}}function mC(e,r){if(1&e&&a.nrm(0,"p-treeNode",37),2&e){const n=r.first,i=r.last;a.Y8G("node",r.$implicit)("firstChild",n)("lastChild",i)}}function _C(e,r){if(1&e&&(a.j41(0,"td",34)(1,"div",35),a.DNE(2,mC,1,3,"p-treeNode",36),a.k0s()()),2&e){const t=a.XpG(3);a.Y8G("ngStyle",a.eq3(3,_0,t.node.expanded?"table-cell":"none")),a.R7$(2),a.Y8G("ngForOf",t.node.children)("ngForTrackBy",t.tree.trackBy)}}function xC(e,r){if(1&e){const t=a.RV6();a.j41(0,"table")(1,"tbody")(2,"tr"),a.DNE(3,oC,7,6,"td",23),a.j41(4,"td",24)(5,"div",25),a.bIt("click",function(i){a.eBV(t);const s=a.XpG(2);return a.Njj(s.onNodeClick(i))})("contextmenu",function(i){a.eBV(t);const s=a.XpG(2);return a.Njj(s.onNodeRightClick(i))})("touchend",function(){a.eBV(t);const i=a.XpG(2);return a.Njj(i.onNodeTouchEnd())})("keydown",function(i){a.eBV(t);const s=a.XpG(2);return a.Njj(s.onNodeKeydown(i))}),a.DNE(6,CC,3,3,"span",26)(7,IC,1,2,"span",3),a.j41(8,"span",11),a.DNE(9,AC,2,1,"span",8)(10,dC,2,4,"span",8),a.k0s()()(),a.DNE(11,_C,3,5,"td",27),a.k0s()()()}if(2&e){const t=a.XpG(2);a.HbH(t.node.styleClass),a.R7$(3),a.Y8G("ngIf",!t.root),a.R7$(),a.Y8G("ngClass",a.eq3(10,Bh,!t.node.expanded)),a.R7$(),a.Y8G("ngClass",a.l_i(12,Mh,t.tree.selectionMode,t.isSelected())),a.R7$(),a.Y8G("ngIf",!t.isLeaf()),a.R7$(),a.Y8G("ngIf",t.node.icon||t.node.expandedIcon||t.node.collapsedIcon),a.R7$(2),a.Y8G("ngIf",!t.tree.getTemplateForNode(t.node)),a.R7$(),a.Y8G("ngIf",t.tree.getTemplateForNode(t.node)),a.R7$(),a.Y8G("ngIf",t.node.children&&t.node.expanded)}}function vC(e,r){if(1&e&&a.DNE(0,Lh,1,4,"li",1)(1,aC,11,35,"li",2)(2,sC,1,4,"li",1)(3,xC,12,15,"table",3),2&e){const t=a.XpG();a.Y8G("ngIf",t.tree.droppableNodes),a.R7$(),a.Y8G("ngIf",!t.tree.horizontal),a.R7$(),a.Y8G("ngIf",t.tree.droppableNodes&&t.lastChild),a.R7$(),a.Y8G("ngIf",t.tree.horizontal)}}const kC=["filter"],wC=["scroller"],yC=["wrapper"],TC=(e,r,t,n)=>({"p-tree p-component":!0,"p-tree-selectable":e,"p-treenode-dragover":r,"p-tree-loading":t,"p-tree-flex-scrollable":n}),SC=e=>({options:e}),bC=e=>({"max-height":e}),EC=e=>({"p-tree p-tree-horizontal p-component":!0,"p-tree-selectable":e});function FC(e,r){if(1&e&&a.nrm(0,"i"),2&e){const t=a.XpG(3);a.HbH("p-tree-loading-icon pi-spin "+t.loadingIcon)}}function DC(e,r){1&e&&a.nrm(0,"SpinnerIcon",17),2&e&&a.Y8G("spin",!0)("styleClass","p-tree-loading-icon")}function NC(e,r){}function PC(e,r){1&e&&a.DNE(0,NC,0,0,"ng-template")}function RC(e,r){if(1&e&&(a.j41(0,"span",18),a.DNE(1,PC,1,0,null,9),a.k0s()),2&e){const t=a.XpG(4);a.R7$(),a.Y8G("ngTemplateOutlet",t.loadingIconTemplate)}}function OC(e,r){if(1&e&&(a.qex(0),a.DNE(1,DC,1,2,"SpinnerIcon",15)(2,RC,2,1,"span",16),a.bVm()),2&e){const t=a.XpG(3);a.R7$(),a.Y8G("ngIf",!t.loadingIconTemplate),a.R7$(),a.Y8G("ngIf",t.loadingIconTemplate)}}function BC(e,r){if(1&e&&(a.j41(0,"div",13),a.DNE(1,FC,1,2,"i",14)(2,OC,3,2,"ng-container",11),a.k0s()),2&e){const t=a.XpG(2);a.R7$(),a.Y8G("ngIf",t.loadingIcon),a.R7$(),a.Y8G("ngIf",!t.loadingIcon)}}function MC(e,r){1&e&&a.eu8(0)}function LC(e,r){1&e&&a.nrm(0,"SearchIcon",23),2&e&&a.Y8G("styleClass","p-tree-filter-icon")}function UC(e,r){}function GC(e,r){1&e&&a.DNE(0,UC,0,0,"ng-template")}function jC(e,r){if(1&e&&(a.j41(0,"span",24),a.DNE(1,GC,1,0,null,9),a.k0s()),2&e){const t=a.XpG(3);a.R7$(),a.Y8G("ngTemplateOutlet",t.filterIconTemplate)}}function VC(e,r){if(1&e){const t=a.RV6();a.j41(0,"div",19)(1,"input",20,0),a.bIt("keydown.enter",function(i){return a.eBV(t),a.Njj(i.preventDefault())})("input",function(i){a.eBV(t);const s=a.XpG(2);return a.Njj(s._filter(i.target.value))}),a.k0s(),a.DNE(3,LC,1,1,"SearchIcon",21)(4,jC,2,1,"span",22),a.k0s()}if(2&e){const t=a.XpG(2);a.R7$(),a.BMQ("placeholder",t.filterPlaceholder),a.R7$(2),a.Y8G("ngIf",!t.filterIconTemplate),a.R7$(),a.Y8G("ngIf",t.filterIconTemplate)}}function $C(e,r){if(1&e&&a.nrm(0,"p-treeNode",31,2),2&e){const t=r.$implicit,n=r.first,i=a.XpG(2).options,s=a.XpG(4);a.Y8G("level",t.level)("rowNode",t)("node",t.node)("parentNode",t.parent)("firstChild",n)("lastChild",t.lastChild)("index",t.index)("itemSize",i.itemSize)("indentation",s.indentation)("loadingMode",s.loadingMode)}}function WC(e,r){if(1&e&&(a.j41(0,"ul",29),a.DNE(1,$C,2,10,"p-treeNode",30),a.k0s()),2&e){const t=a.XpG(),n=t.$implicit,i=t.options,s=a.XpG(4);a.Aen(i.contentStyle),a.Y8G("ngClass",i.contentStyleClass),a.BMQ("aria-label",s.ariaLabel)("aria-labelledby",s.ariaLabelledBy),a.R7$(),a.Y8G("ngForOf",n)("ngForTrackBy",s.trackBy)}}function XC(e,r){1&e&&a.DNE(0,WC,2,7,"ul",28),2&e&&a.Y8G("ngIf",r.$implicit)}function zC(e,r){1&e&&a.eu8(0)}function HC(e,r){if(1&e&&a.DNE(0,zC,1,0,"ng-container",33),2&e){const t=r.options,n=a.XpG(5);a.Y8G("ngTemplateOutlet",n.loaderTemplate)("ngTemplateOutletContext",a.eq3(2,SC,t))}}function YC(e,r){1&e&&(a.qex(0),a.DNE(1,HC,1,4,"ng-template",32),a.bVm())}function JC(e,r){if(1&e){const t=a.RV6();a.j41(0,"p-scroller",26,1),a.bIt("onScroll",function(i){a.eBV(t);const s=a.XpG(3);return a.Njj(s.onScroll.emit(i))})("onScrollIndexChange",function(i){a.eBV(t);const s=a.XpG(3);return a.Njj(s.onScrollIndexChange.emit(i))})("onLazyLoad",function(i){a.eBV(t);const s=a.XpG(3);return a.Njj(s.onLazyLoad.emit(i))}),a.DNE(2,XC,1,1,"ng-template",27)(3,YC,2,0,"ng-container",11),a.k0s()}if(2&e){const t=a.XpG(3);a.Aen(a.eq3(9,m0,"flex"!==t.scrollHeight?t.scrollHeight:void 0)),a.Y8G("items",t.serializedValue)("tabindex",-1)("scrollHeight","flex"!==t.scrollHeight?void 0:"100%")("itemSize",t.virtualScrollItemSize||t._virtualNodeHeight)("lazy",t.lazy)("options",t.virtualScrollOptions),a.R7$(3),a.Y8G("ngIf",t.loaderTemplate)}}function KC(e,r){if(1&e&&a.nrm(0,"p-treeNode",38),2&e){const t=r.$implicit,n=r.first,i=r.last,s=r.index,o=a.XpG(5);a.Y8G("node",t)("firstChild",n)("lastChild",i)("index",s)("level",0)("loadingMode",o.loadingMode)}}function ZC(e,r){if(1&e&&(a.j41(0,"ul",36),a.DNE(1,KC,1,6,"p-treeNode",37),a.k0s()),2&e){const t=a.XpG(4);a.BMQ("aria-label",t.ariaLabel)("aria-labelledby",t.ariaLabelledBy),a.R7$(),a.Y8G("ngForOf",t.getRootNode())("ngForTrackBy",t.trackBy)}}function QC(e,r){if(1&e&&(a.qex(0),a.j41(1,"div",34,3),a.DNE(3,ZC,2,4,"ul",35),a.k0s(),a.bVm()),2&e){const t=a.XpG(3);a.R7$(),a.Y8G("ngStyle",a.eq3(2,bC,t.scrollHeight)),a.R7$(2),a.Y8G("ngIf",t.getRootNode())}}function qC(e,r){if(1&e&&(a.qex(0),a.DNE(1,JC,4,11,"p-scroller",25)(2,QC,4,4,"ng-container",11),a.bVm()),2&e){const t=a.XpG(2);a.R7$(),a.Y8G("ngIf",t.virtualScroll),a.R7$(),a.Y8G("ngIf",!t.virtualScroll)}}function eI(e,r){if(1&e&&(a.qex(0),a.EFF(1),a.bVm()),2&e){const t=a.XpG(3);a.R7$(),a.SpI(" ",t.emptyMessageLabel," ")}}function tI(e,r){1&e&&a.eu8(0,null,4)}function rI(e,r){if(1&e&&(a.j41(0,"div",39),a.DNE(1,eI,2,1,"ng-container",40)(2,tI,2,0,"ng-container",9),a.k0s()),2&e){const t=a.XpG(2);a.R7$(),a.Y8G("ngIf",!t.emptyMessageTemplate)("ngIfElse",t.emptyFilter),a.R7$(),a.Y8G("ngTemplateOutlet",t.emptyMessageTemplate)}}function nI(e,r){1&e&&a.eu8(0)}function iI(e,r){if(1&e){const t=a.RV6();a.j41(0,"div",7),a.bIt("drop",function(i){a.eBV(t);const s=a.XpG();return a.Njj(s.onDrop(i))})("dragover",function(i){a.eBV(t);const s=a.XpG();return a.Njj(s.onDragOver(i))})("dragenter",function(){a.eBV(t);const i=a.XpG();return a.Njj(i.onDragEnter())})("dragleave",function(i){a.eBV(t);const s=a.XpG();return a.Njj(s.onDragLeave(i))}),a.DNE(1,BC,3,2,"div",8)(2,MC,1,0,"ng-container",9)(3,VC,5,3,"div",10)(4,qC,3,2,"ng-container",11)(5,rI,3,3,"div",12)(6,nI,1,0,"ng-container",9),a.k0s()}if(2&e){let t;const n=a.XpG();a.HbH(n.styleClass),a.Y8G("ngClass",a.ziG(10,TC,n.selectionMode,n.dragHover,n.loading,"flex"===n.scrollHeight))("ngStyle",n.style),a.R7$(),a.Y8G("ngIf",n.loading&&"mask"===n.loadingMode),a.R7$(),a.Y8G("ngTemplateOutlet",n.headerTemplate),a.R7$(),a.Y8G("ngIf",n.filter),a.R7$(),a.Y8G("ngIf",null==(t=n.getRootNode())?null:t.length),a.R7$(),a.Y8G("ngIf",!n.loading&&(null==n.getRootNode()||0===n.getRootNode().length)),a.R7$(),a.Y8G("ngTemplateOutlet",n.footerTemplate)}}function aI(e,r){1&e&&a.eu8(0)}function sI(e,r){if(1&e&&a.nrm(0,"i"),2&e){const t=a.XpG(3);a.HbH("p-tree-loading-icon pi-spin "+t.loadingIcon)}}function oI(e,r){1&e&&a.nrm(0,"SpinnerIcon",17),2&e&&a.Y8G("spin",!0)("styleClass","p-tree-loading-icon")}function lI(e,r){}function cI(e,r){1&e&&a.DNE(0,lI,0,0,"ng-template")}function gI(e,r){if(1&e&&(a.j41(0,"span",18),a.DNE(1,cI,1,0,null,9),a.k0s()),2&e){const t=a.XpG(4);a.R7$(),a.Y8G("ngTemplateOutlet",t.loadingIconTemplate)}}function fI(e,r){if(1&e&&(a.qex(0),a.DNE(1,oI,1,2,"SpinnerIcon",15)(2,gI,2,1,"span",16),a.bVm()),2&e){const t=a.XpG(3);a.R7$(),a.Y8G("ngIf",!t.loadingIconTemplate),a.R7$(),a.Y8G("ngIf",t.loadingIconTemplate)}}function uI(e,r){if(1&e&&(a.j41(0,"div",43),a.DNE(1,sI,1,2,"i",14)(2,fI,3,2,"ng-container",11),a.k0s()),2&e){const t=a.XpG(2);a.R7$(),a.Y8G("ngIf",t.loadingIcon),a.R7$(),a.Y8G("ngIf",!t.loadingIcon)}}function hI(e,r){if(1&e&&(a.j41(0,"table"),a.nrm(1,"p-treeNode",44),a.k0s()),2&e){const t=a.XpG(2);a.R7$(),a.Y8G("node",t.value[0])("root",!0)}}function CI(e,r){if(1&e&&(a.qex(0),a.EFF(1),a.bVm()),2&e){const t=a.XpG(3);a.R7$(),a.SpI(" ",t.emptyMessageLabel," ")}}function II(e,r){1&e&&a.eu8(0,null,4)}function AI(e,r){if(1&e&&(a.j41(0,"div",39),a.DNE(1,CI,2,1,"ng-container",40)(2,II,2,0,"ng-container",9),a.k0s()),2&e){const t=a.XpG(2);a.R7$(),a.Y8G("ngIf",!t.emptyMessageTemplate)("ngIfElse",t.emptyFilter),a.R7$(),a.Y8G("ngTemplateOutlet",t.emptyMessageTemplate)}}function pI(e,r){1&e&&a.eu8(0)}function dI(e,r){if(1&e&&(a.j41(0,"div",41),a.DNE(1,aI,1,0,"ng-container",9)(2,uI,3,2,"div",42)(3,hI,2,2,"table",11)(4,AI,3,3,"div",12)(5,pI,1,0,"ng-container",9),a.k0s()),2&e){const t=a.XpG();a.HbH(t.styleClass),a.Y8G("ngClass",a.eq3(9,EC,t.selectionMode))("ngStyle",t.style),a.R7$(),a.Y8G("ngTemplateOutlet",t.headerTemplate),a.R7$(),a.Y8G("ngIf",t.loading),a.R7$(),a.Y8G("ngIf",t.value&&t.value[0]),a.R7$(),a.Y8G("ngIf",!t.loading&&(null==t.getRootNode()||0===t.getRootNode().length)),a.R7$(),a.Y8G("ngTemplateOutlet",t.footerTemplate)}}let mI=(()=>{class e{static ICON_CLASS="p-treenode-icon ";rowNode;node;parentNode;root;index;firstChild;lastChild;level;indentation;itemSize;loadingMode;tree;timeout;draghoverPrev;draghoverNext;draghoverNode;get ariaSelected(){return"single"===this.tree.selectionMode||"multiple"===this.tree.selectionMode?this.isSelected():void 0}get ariaChecked(){return"checkbox"===this.tree.selectionMode?this.isSelected():void 0}constructor(t){this.tree=t}ngOnInit(){this.node.parent=this.parentNode;const n=this.tree.el.nativeElement.closest("p-dialog");this.parentNode&&!n&&(this.setAllNodesTabIndexes(),this.tree.syncNodeOption(this.node,this.tree.value,"parent",this.tree.getNodeWithKey(this.parentNode.key,this.tree.value)))}getIcon(){let t;return t=this.node.icon?this.node.icon:this.node.expanded&&this.node.children&&this.node.children?.length?this.node.expandedIcon:this.node.collapsedIcon,e.ICON_CLASS+" "+t}isLeaf(){return this.tree.isNodeLeaf(this.node)}toggle(t){this.node.expanded?this.collapse(t):this.expand(t),t.stopPropagation()}expand(t){this.node.expanded=!0,this.tree.virtualScroll&&(this.tree.updateSerializedValue(),this.focusVirtualNode()),this.tree.onNodeExpand.emit({originalEvent:t,node:this.node})}collapse(t){this.node.expanded=!1,this.tree.virtualScroll&&(this.tree.updateSerializedValue(),this.focusVirtualNode()),this.tree.onNodeCollapse.emit({originalEvent:t,node:this.node})}onNodeClick(t){this.tree.onNodeClick(t,this.node)}onNodeKeydown(t){"Enter"===t.key&&this.tree.onNodeClick(t,this.node)}onNodeTouchEnd(){this.tree.onNodeTouchEnd()}onNodeRightClick(t){this.tree.onNodeRightClick(t,this.node)}isSelected(){return this.tree.isSelected(this.node)}isSameNode(t){return t.currentTarget&&(t.currentTarget.isSameNode(t.target)||t.currentTarget.isSameNode(t.target.closest('[role="treeitem"]')))}onDropPoint(t,n){t.preventDefault();let i=this.tree.dragNode,l=this.tree.dragNodeTree!==this.tree||1===n||this.tree.dragNodeIndex!==this.index-1;if(this.tree.allowDrop(i,this.node,this.tree.dragNodeScope,"between")&&l){let g={...this.createDropPointEventMetadata(n)};this.tree.validateDrop?this.tree.onNodeDrop.emit({originalEvent:t,dragNode:i,dropNode:this.node,dropPoint:"between",index:this.index,accept:()=>{this.processPointDrop(g)}}):(this.processPointDrop(g),this.tree.onNodeDrop.emit({originalEvent:t,dragNode:i,dropNode:this.node,dropPoint:"between",index:this.index}))}this.draghoverPrev=!1,this.draghoverNext=!1}processPointDrop(t){let n=t.dropNode.parent?t.dropNode.parent.children:this.tree.value;t.dragNodeSubNodes.splice(t.dragNodeIndex,1);let i=this.index;t.position<0?(i=t.dragNodeSubNodes===n?t.dragNodeIndex>t.index?t.index:t.index-1:t.index,n.splice(i,0,t.dragNode)):(i=n.length,n.push(t.dragNode)),this.tree.dragDropService.stopDrag({node:t.dragNode,subNodes:t.dropNode.parent?t.dropNode.parent.children:this.tree.value,index:t.dragNodeIndex})}createDropPointEventMetadata(t){return{dragNode:this.tree.dragNode,dragNodeIndex:this.tree.dragNodeIndex,dragNodeSubNodes:this.tree.dragNodeSubNodes,dropNode:this.node,index:this.index,position:t}}onDropPointDragOver(t){t.dataTransfer.dropEffect="move",t.preventDefault()}onDropPointDragEnter(t,n){this.tree.allowDrop(this.tree.dragNode,this.node,this.tree.dragNodeScope,"between")&&(n<0?this.draghoverPrev=!0:this.draghoverNext=!0)}onDropPointDragLeave(t){this.draghoverPrev=!1,this.draghoverNext=!1}onDragStart(t){this.tree.draggableNodes&&!1!==this.node.draggable?(t.dataTransfer.setData("text","data"),this.tree.dragDropService.startDrag({tree:this,node:this.node,subNodes:this.node?.parent?this.node.parent.children:this.tree.value,index:this.index,scope:this.tree.draggableScope})):t.preventDefault()}onDragStop(t){this.tree.dragDropService.stopDrag({node:this.node,subNodes:this.node?.parent?this.node.parent.children:this.tree.value,index:this.index})}onDropNodeDragOver(t){t.dataTransfer.dropEffect="move",this.tree.droppableNodes&&(t.preventDefault(),t.stopPropagation())}onDropNode(t){if(this.tree.droppableNodes&&!1!==this.node?.droppable){let n=this.tree.dragNode;if(this.tree.allowDrop(n,this.node,this.tree.dragNodeScope)){let i={...this.createDropNodeEventMetadata()};this.tree.validateDrop?this.tree.onNodeDrop.emit({originalEvent:t,dragNode:n,dropNode:this.node,dropPoint:"node",index:this.index,accept:()=>{this.processNodeDrop(i)}}):(this.processNodeDrop(i),this.tree.onNodeDrop.emit({originalEvent:t,dragNode:n,dropNode:this.node,dropPoint:"node",index:this.index}))}}t.preventDefault(),t.stopPropagation(),this.draghoverNode=!1}createDropNodeEventMetadata(){return{dragNode:this.tree.dragNode,dragNodeIndex:this.tree.dragNodeIndex,dragNodeSubNodes:this.tree.dragNodeSubNodes,dropNode:this.node}}processNodeDrop(t){let n=t.dragNodeIndex;t.dragNodeSubNodes.splice(n,1),t.dropNode.children?t.dropNode.children.push(t.dragNode):t.dropNode.children=[t.dragNode],this.tree.dragDropService.stopDrag({node:t.dragNode,subNodes:t.dropNode.parent?t.dropNode.parent.children:this.tree.value,index:n})}onDropNodeDragEnter(t){this.tree.droppableNodes&&!1!==this.node?.droppable&&this.tree.allowDrop(this.tree.dragNode,this.node,this.tree.dragNodeScope)&&(this.draghoverNode=!0)}onDropNodeDragLeave(t){if(this.tree.droppableNodes){let n=t.currentTarget.getBoundingClientRect();(t.x>n.left+n.width||t.x<n.left||t.y>=Math.floor(n.top+n.height)||t.y<n.top)&&(this.draghoverNode=!1)}}onKeyDown(t){if(this.isSameNode(t)&&(!this.tree.contextMenu||"block"!==this.tree.contextMenu.containerViewChild?.nativeElement.style.display))switch(t.code){case"ArrowDown":this.onArrowDown(t);break;case"ArrowUp":this.onArrowUp(t);break;case"ArrowRight":this.onArrowRight(t);break;case"ArrowLeft":this.onArrowLeft(t);break;case"Enter":case"NumpadEnter":this.onEnter(t);break;case"Space":const n=t.target instanceof HTMLElement&&t.target.nodeName;["INPUT"].includes(n)||this.onEnter(t);break;case"Tab":this.setAllNodesTabIndexes()}}onArrowUp(t){const n="toggler"===t.target.getAttribute("data-pc-section")?t.target.closest('[role="treeitem"]'):t.target.parentElement;if(n.previousElementSibling)this.focusRowChange(n,n.previousElementSibling,this.findLastVisibleDescendant(n.previousElementSibling));else{let i=this.getParentNodeElement(n);i&&this.focusRowChange(n,i)}t.preventDefault()}onArrowDown(t){const n="toggler"===t.target.getAttribute("data-pc-section")?t.target.closest('[role="treeitem"]'):t.target,i=n.children[1];if(i&&i.children.length>0)this.focusRowChange(n,i.children[0]);else if(n.parentElement.nextElementSibling)this.focusRowChange(n,n.parentElement.nextElementSibling);else{let s=this.findNextSiblingOfAncestor(n.parentElement);s&&this.focusRowChange(n,s)}t.preventDefault()}onArrowRight(t){!this.node?.expanded&&!this.tree.isNodeLeaf(this.node)&&(this.expand(t),t.currentTarget.tabIndex=-1,setTimeout(()=>{this.onArrowDown(t)},1)),t.preventDefault()}onArrowLeft(t){const n="toggler"===t.target.getAttribute("data-pc-section")?t.target.closest('[role="treeitem"]'):t.target;if(0===this.level&&!this.node?.expanded)return!1;if(this.node?.expanded)return void this.collapse(t);let i=this.getParentNodeElement(n.parentElement);i&&this.focusRowChange(t.currentTarget,i),t.preventDefault()}isActionableElement(t){const n=t.target;return n instanceof HTMLElement&&("A"==n.nodeName||"BUTTON"==n.nodeName)}onEnter(t){this.tree.onNodeClick(t,this.node),this.setTabIndexForSelectionMode(t,this.tree.nodeTouched),this.isActionableElement(t)||t.preventDefault()}setAllNodesTabIndexes(){const t=qe.D.find(this.tree.el.nativeElement,".p-treenode"),n=[...t].some(i=>"true"===i.getAttribute("aria-selected")||"true"===i.getAttribute("aria-checked"));[...t].forEach(i=>{i.tabIndex=-1}),n?[...t].filter(s=>"true"===s.getAttribute("aria-selected")||"true"===s.getAttribute("aria-checked"))[0].tabIndex=0:[...t][0].tabIndex=0}setTabIndexForSelectionMode(t,n){if(null!==this.tree.selectionMode){const i=[...qe.D.find(this.tree.el.nativeElement,".p-treenode")];t.currentTarget.tabIndex=!1===n?-1:0,i.every(s=>-1===s.tabIndex)&&(i[0].tabIndex=0)}}findNextSiblingOfAncestor(t){let n=this.getParentNodeElement(t);return n?n.nextElementSibling?n.nextElementSibling:this.findNextSiblingOfAncestor(n):null}findLastVisibleDescendant(t){const i=Array.from(t.children).find(s=>qe.D.hasClass(s,"p-treenode")).children[1];return i&&i.children.length>0?this.findLastVisibleDescendant(i.children[i.children.length-1]):t}getParentNodeElement(t){const n=t.parentElement?.parentElement?.parentElement;return"P-TREENODE"===n?.tagName?n:null}focusNode(t){this.tree.droppableNodes?t.children[1].focus():t.children[0].focus()}focusRowChange(t,n,i){t.tabIndex="-1",n.children[0].tabIndex="0",this.focusNode(i||n)}focusVirtualNode(){this.timeout=setTimeout(()=>{let t=qe.D.findSingle(document.body,`[data-id="${this.node?.key??this.node?.data}"]`);qe.D.focus(t)},1)}static \u0275fac=function(n){return new(n||e)(a.rXU((0,a.Rfq)(()=>Ss)))};static \u0275cmp=a.VBU({type:e,selectors:[["p-treeNode"]],hostAttrs:[1,"p-element"],inputs:{rowNode:"rowNode",node:"node",parentNode:"parentNode",root:[2,"root","root",a.L39],index:[2,"index","index",a.Udg],firstChild:[2,"firstChild","firstChild",a.L39],lastChild:[2,"lastChild","lastChild",a.L39],level:[2,"level","level",a.Udg],indentation:[2,"indentation","indentation",a.Udg],itemSize:[2,"itemSize","itemSize",a.Udg],loadingMode:"loadingMode"},features:[a.GFd],decls:1,vars:1,consts:[[3,"ngIf"],["class","p-treenode-droppoint",3,"ngClass","drop","dragover","dragenter","dragleave",4,"ngIf"],["role","treeitem",3,"ngClass","ngStyle","style","keydown",4,"ngIf"],[3,"class",4,"ngIf"],[1,"p-treenode-droppoint",3,"drop","dragover","dragenter","dragleave","ngClass"],["role","treeitem",3,"keydown","ngClass","ngStyle"],[1,"p-treenode-content",3,"click","contextmenu","touchend","drop","dragover","dragenter","dragleave","dragstart","dragend","ngStyle","draggable","ngClass"],["type","button","pRipple","","tabindex","-1",1,"p-tree-toggler","p-link",3,"click"],[4,"ngIf"],["class","p-tree-toggler-icon",4,"ngIf"],["class","p-checkbox p-component","aria-hidden","true",3,"ngClass",4,"ngIf"],[1,"p-treenode-label"],["class","p-treenode-children","role","group",3,"ngStyle",4,"ngIf"],[3,"styleClass",4,"ngIf"],[3,"styleClass"],[3,"spin","styleClass"],[1,"p-tree-toggler-icon"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["aria-hidden","true",1,"p-checkbox","p-component",3,"ngClass"],["role","checkbox",1,"p-checkbox-box",3,"ngClass"],["role","group",1,"p-treenode-children",3,"ngStyle"],[3,"node","parentNode","firstChild","lastChild","index","itemSize","level","loadingMode",4,"ngFor","ngForOf","ngForTrackBy"],[3,"node","parentNode","firstChild","lastChild","index","itemSize","level","loadingMode"],["class","p-treenode-connector",4,"ngIf"],[1,"p-treenode",3,"ngClass"],["tabindex","0",1,"p-treenode-content",3,"click","contextmenu","touchend","keydown","ngClass"],[3,"ngClass","click",4,"ngIf"],["class","p-treenode-children-container",3,"ngStyle",4,"ngIf"],[1,"p-treenode-connector"],[1,"p-treenode-connector-table"],[3,"ngClass"],[3,"click","ngClass"],[3,"styleClass","ariaLabel",4,"ngIf"],[3,"styleClass","ariaLabel"],[1,"p-treenode-children-container",3,"ngStyle"],[1,"p-treenode-children"],[3,"node","firstChild","lastChild",4,"ngFor","ngForOf","ngForTrackBy"],[3,"node","firstChild","lastChild"]],template:function(n,i){1&n&&a.DNE(0,vC,4,4,"ng-template",0),2&n&&a.Y8G("ngIf",i.node)},dependencies:()=>[Oe.YU,Oe.Sq,Oe.bT,Oe.T3,Oe.B3,Mi.n,I0.S,La.D,Oa.v,A0.Q,Ts.N,p0.c,e],encapsulation:2})}return e})(),Ss=(()=>{class e{el;dragDropService;config;cd;value;selectionMode;loadingMode="mask";selection;style;styleClass;contextMenu;layout="vertical";draggableScope;droppableScope;draggableNodes;droppableNodes;metaKeySelection=!1;propagateSelectionUp=!0;propagateSelectionDown=!0;loading;loadingIcon;emptyMessage="";ariaLabel;togglerAriaLabel;ariaLabelledBy;validateDrop;filter;filterBy="label";filterMode="lenient";filterPlaceholder;filteredNodes;filterLocale;scrollHeight;lazy=!1;virtualScroll;virtualScrollItemSize;virtualScrollOptions;indentation=1.5;_templateMap;trackBy=(t,n)=>n;_virtualNodeHeight;get virtualNodeHeight(){return this._virtualNodeHeight}set virtualNodeHeight(t){this._virtualNodeHeight=t,console.warn("The virtualNodeHeight property is deprecated, use virtualScrollItemSize property instead.")}selectionChange=new a.bkB;onNodeSelect=new a.bkB;onNodeUnselect=new a.bkB;onNodeExpand=new a.bkB;onNodeCollapse=new a.bkB;onNodeContextMenuSelect=new a.bkB;onNodeDrop=new a.bkB;onLazyLoad=new a.bkB;onScroll=new a.bkB;onScrollIndexChange=new a.bkB;onFilter=new a.bkB;templates;filterViewChild;scroller;wrapperViewChild;serializedValue;headerTemplate;footerTemplate;loaderTemplate;emptyMessageTemplate;togglerIconTemplate;checkboxIconTemplate;loadingIconTemplate;filterIconTemplate;nodeTouched;dragNodeTree;dragNode;dragNodeSubNodes;dragNodeIndex;dragNodeScope;dragHover;dragStartSubscription;dragStopSubscription;constructor(t,n,i,s){this.el=t,this.dragDropService=n,this.config=i,this.cd=s}ngOnInit(){this.droppableNodes&&(this.dragStartSubscription=this.dragDropService.dragStart$.subscribe(t=>{this.dragNodeTree=t.tree,this.dragNode=t.node,this.dragNodeSubNodes=t.subNodes,this.dragNodeIndex=t.index,this.dragNodeScope=t.scope}),this.dragStopSubscription=this.dragDropService.dragStop$.subscribe(t=>{this.dragNodeTree=null,this.dragNode=null,this.dragNodeSubNodes=null,this.dragNodeIndex=null,this.dragNodeScope=null,this.dragHover=!1}))}ngOnChanges(t){t.value&&(this.updateSerializedValue(),this.hasFilterActive()&&this._filter(this.filterViewChild.nativeElement.value))}get horizontal(){return"horizontal"==this.layout}get emptyMessageLabel(){return this.emptyMessage||this.config.getTranslation(Ze.Yj.EMPTY_MESSAGE)}ngAfterContentInit(){this.templates.length&&(this._templateMap={}),this.templates.forEach(t=>{switch(t.getType()){case"header":this.headerTemplate=t.template;break;case"empty":this.emptyMessageTemplate=t.template;break;case"footer":this.footerTemplate=t.template;break;case"loader":this.loaderTemplate=t.template;break;case"togglericon":this.togglerIconTemplate=t.template;break;case"checkboxicon":this.checkboxIconTemplate=t.template;break;case"loadingicon":this.loadingIconTemplate=t.template;break;case"filtericon":this.filterIconTemplate=t.template;break;default:this._templateMap[t.name]=t.template}})}updateSerializedValue(){this.serializedValue=[],this.serializeNodes(null,this.getRootNode(),0,!0)}serializeNodes(t,n,i,s){n&&n.length&&n.forEach((o,l)=>{o.parent=t;const g={node:o,parent:t,level:i,visible:s&&(!t||t.expanded),lastChild:l===n.length-1,index:l};this.serializedValue.push(g),g.visible&&o.expanded&&this.serializeNodes(o,o.children,i+1,g.visible)})}onNodeClick(t,n){let i=t.target;if(!qe.D.hasClass(i,"p-tree-toggler")&&!qe.D.hasClass(i,"p-tree-toggler-icon")){if(this.selectionMode){if(!1===n.selectable)return void(n.style="--p-focus-ring-color: none;");if(n.style="--p-focus-ring-color: var(--primary-color)",this.hasFilteredNodes()&&!(n=this.getNodeWithKey(n.key,this.filteredNodes)))return;let s=this.findIndexInSelection(n),o=s>=0;if(this.isCheckboxSelectionMode())o?(this.propagateSelectionDown?this.propagateDown(n,!1):this.selection=this.selection.filter((l,g)=>g!=s),this.propagateSelectionUp&&n.parent&&this.propagateUp(n.parent,!1),this.selectionChange.emit(this.selection),this.onNodeUnselect.emit({originalEvent:t,node:n})):(this.propagateSelectionDown?this.propagateDown(n,!0):this.selection=[...this.selection||[],n],this.propagateSelectionUp&&n.parent&&this.propagateUp(n.parent,!0),this.selectionChange.emit(this.selection),this.onNodeSelect.emit({originalEvent:t,node:n}));else if(!this.nodeTouched&&this.metaKeySelection){let g=t.metaKey||t.ctrlKey;o&&g?(this.isSingleSelectionMode()?this.selectionChange.emit(null):(this.selection=this.selection.filter((u,h)=>h!=s),this.selectionChange.emit(this.selection)),this.onNodeUnselect.emit({originalEvent:t,node:n})):(this.isSingleSelectionMode()?this.selectionChange.emit(n):this.isMultipleSelectionMode()&&(this.selection=g&&this.selection||[],this.selection=[...this.selection,n],this.selectionChange.emit(this.selection)),this.onNodeSelect.emit({originalEvent:t,node:n}))}else this.isSingleSelectionMode()?o?(this.selection=null,this.onNodeUnselect.emit({originalEvent:t,node:n})):(this.selection=n,setTimeout(()=>{this.onNodeSelect.emit({originalEvent:t,node:n})})):o?(this.selection=this.selection.filter((g,u)=>u!=s),this.onNodeUnselect.emit({originalEvent:t,node:n})):(this.selection=[...this.selection||[],n],setTimeout(()=>{this.onNodeSelect.emit({originalEvent:t,node:n})})),this.selectionChange.emit(this.selection)}this.nodeTouched=!1}}onNodeTouchEnd(){this.nodeTouched=!0}onNodeRightClick(t,n){if(this.contextMenu){let s=t.target.getAttribute("class");if(s&&s.includes("p-tree-toggler"))return;this.findIndexInSelection(n)>=0||(this.isSingleSelectionMode()?this.selectionChange.emit(n):this.selectionChange.emit([n])),this.contextMenu.show(t),this.onNodeContextMenuSelect.emit({originalEvent:t,node:n})}}findIndexInSelection(t){return this.selectionMode&&this.selection?(this.isSingleSelectionMode()?[this.selection]:this.selection).findIndex(i=>i===t||i.key===t.key&&void 0!==i.key):-1}syncNodeOption(t,n,i,s){const o=this.hasFilteredNodes()?this.getNodeWithKey(t.key,n):null;o&&(o[i]=s||t[i])}hasFilteredNodes(){return this.filter&&this.filteredNodes&&this.filteredNodes.length}hasFilterActive(){return this.filter&&this.filterViewChild?.nativeElement?.value.length>0}getNodeWithKey(t,n){for(let i of n){if(i.key===t)return i;if(i.children){let s=this.getNodeWithKey(t,i.children);if(s)return s}}}propagateUp(t,n){if(t.children&&t.children.length){let s=0,o=!1;for(let l of t.children)this.isSelected(l)?s++:l.partialSelected&&(o=!0);if(n&&s==t.children.length)this.selection=[...this.selection||[],t],t.partialSelected=!1;else{if(!n){let l=this.findIndexInSelection(t);l>=0&&(this.selection=this.selection.filter((g,u)=>u!=l))}t.partialSelected=!!(o||s>0&&s!=t.children.length)}this.syncNodeOption(t,this.filteredNodes,"partialSelected")}let i=t.parent;i&&this.propagateUp(i,n)}propagateDown(t,n){let i=this.findIndexInSelection(t);if(n&&-1==i&&!1!==t.selectable?this.selection=[...this.selection||[],this.filterUnselectableChildren(t)]:!n&&i>-1&&(this.selection=this.selection.filter((s,o)=>o!=i)),t.partialSelected=!1,this.syncNodeOption(t,this.filteredNodes,"partialSelected"),t.children&&t.children.length)for(let s of t.children)this.propagateDown(s,n)}filterUnselectableChildren(t){let n=Object.assign({},t);if(n.children&&n.children.length)for(let i of n.children)!1===i.selectable&&(n.children=n.children.filter(s=>s!=i)),i=this.filterUnselectableChildren(i);return n}isSelected(t){return-1!=this.findIndexInSelection(t)}isSingleSelectionMode(){return this.selectionMode&&"single"==this.selectionMode}isMultipleSelectionMode(){return this.selectionMode&&"multiple"==this.selectionMode}isCheckboxSelectionMode(){return this.selectionMode&&"checkbox"==this.selectionMode}isNodeLeaf(t){return 0!=t.leaf&&!(t.children&&t.children.length)}getRootNode(){return this.filteredNodes?this.filteredNodes:this.value}getTemplateForNode(t){return this._templateMap?t.type?this._templateMap[t.type]:this._templateMap.default:null}onDragOver(t){this.droppableNodes&&(!this.value||0===this.value.length)&&(t.dataTransfer.dropEffect="move",t.preventDefault())}onDrop(t){if(this.droppableNodes&&(!this.value||0===this.value.length)){t.preventDefault();let n=this.dragNode;if(this.allowDrop(n,null,this.dragNodeScope)){let i=this.dragNodeIndex;this.value=this.value||[],this.validateDrop?this.onNodeDrop.emit({originalEvent:t,dragNode:n,dropNode:null,index:i,accept:()=>{this.processTreeDrop(n,i)}}):(this.onNodeDrop.emit({originalEvent:t,dragNode:n,dropNode:null,index:i}),this.processTreeDrop(n,i))}}}processTreeDrop(t,n){this.dragNodeSubNodes.splice(n,1),this.value.push(t),this.dragDropService.stopDrag({node:t})}onDragEnter(){this.droppableNodes&&this.allowDrop(this.dragNode,null,this.dragNodeScope)&&(this.dragHover=!0)}onDragLeave(t){if(this.droppableNodes){let n=t.currentTarget.getBoundingClientRect();(t.x>n.left+n.width||t.x<n.left||t.y>n.top+n.height||t.y<n.top)&&(this.dragHover=!1)}}allowDrop(t,n,i,s="node"){if(t){if(this.isValidDragScope(i)){let o=!0;if(n)if(t===n)o=!1;else{let l=n.parent;for(;null!=l;){if(l===t){o=!1;break}l=l.parent}}return o}return!1}return!1}isValidDragScope(t){let n=this.droppableScope;if(n){if("string"==typeof n){if("string"==typeof t)return n===t;if(Array.isArray(t))return-1!=t.indexOf(n)}else if(Array.isArray(n)){if("string"==typeof t)return-1!=n.indexOf(t);if(Array.isArray(t))for(let i of n)for(let s of t)if(i===s)return!0}return!1}return!0}_filter(t){let n=t;if(""===n)this.filteredNodes=null;else{this.filteredNodes=[];const i=this.filterBy.split(","),s=pn.BF.removeAccents(n).toLocaleLowerCase(this.filterLocale),o="strict"===this.filterMode;for(let l of this.value){let g={...l},u={searchFields:i,filterText:s,isStrictMode:o};(o&&(this.findFilteredNodes(g,u)||this.isFilterMatched(g,u))||!o&&(this.isFilterMatched(g,u)||this.findFilteredNodes(g,u)))&&this.filteredNodes.push(g)}}this.updateSerializedValue(),this.onFilter.emit({filter:n,filteredValue:this.filteredNodes})}resetFilter(){this.filteredNodes=null,this.filterViewChild&&this.filterViewChild.nativeElement&&(this.filterViewChild.nativeElement.value="")}scrollToVirtualIndex(t){this.virtualScroll&&this.scroller?.scrollToIndex(t)}scrollTo(t){this.virtualScroll?this.scroller?.scrollTo(t):this.wrapperViewChild&&this.wrapperViewChild.nativeElement&&(this.wrapperViewChild.nativeElement.scrollTo?this.wrapperViewChild.nativeElement.scrollTo(t):(this.wrapperViewChild.nativeElement.scrollLeft=t.left,this.wrapperViewChild.nativeElement.scrollTop=t.top))}findFilteredNodes(t,n){if(t){let i=!1;if(t.children){let s=[...t.children];t.children=[];for(let o of s){let l={...o};this.isFilterMatched(l,n)&&(i=!0,t.children.push(l))}}if(i)return t.expanded=!0,!0}}isFilterMatched(t,n){let{searchFields:i,filterText:s,isStrictMode:o}=n,l=!1;for(let g of i)pn.BF.removeAccents(String(pn.BF.resolveFieldData(t,g))).toLocaleLowerCase(this.filterLocale).indexOf(s)>-1&&(l=!0);return(!l||o&&!this.isNodeLeaf(t))&&(l=this.findFilteredNodes(t,{searchFields:i,filterText:s,isStrictMode:o})||l),l}getIndex(t,n){const i=t.getItemOptions;return i?i(n).index:n}getBlockableElement(){return this.el.nativeElement.children[0]}ngOnDestroy(){this.dragStartSubscription&&this.dragStartSubscription.unsubscribe(),this.dragStopSubscription&&this.dragStopSubscription.unsubscribe()}static \u0275fac=function(n){return new(n||e)(a.rXU(a.aKT),a.rXU(Ze.$9,8),a.rXU(Ze.r1),a.rXU(a.gRc))};static \u0275cmp=a.VBU({type:e,selectors:[["p-tree"]],contentQueries:function(n,i,s){if(1&n&&a.wni(s,Ze.Ei,4),2&n){let o;a.mGM(o=a.lsd())&&(i.templates=o)}},viewQuery:function(n,i){if(1&n&&(a.GBs(kC,5),a.GBs(wC,5),a.GBs(yC,5)),2&n){let s;a.mGM(s=a.lsd())&&(i.filterViewChild=s.first),a.mGM(s=a.lsd())&&(i.scroller=s.first),a.mGM(s=a.lsd())&&(i.wrapperViewChild=s.first)}},hostAttrs:[1,"p-element"],inputs:{value:"value",selectionMode:"selectionMode",loadingMode:"loadingMode",selection:"selection",style:"style",styleClass:"styleClass",contextMenu:"contextMenu",layout:"layout",draggableScope:"draggableScope",droppableScope:"droppableScope",draggableNodes:[2,"draggableNodes","draggableNodes",a.L39],droppableNodes:[2,"droppableNodes","droppableNodes",a.L39],metaKeySelection:[2,"metaKeySelection","metaKeySelection",a.L39],propagateSelectionUp:[2,"propagateSelectionUp","propagateSelectionUp",a.L39],propagateSelectionDown:[2,"propagateSelectionDown","propagateSelectionDown",a.L39],loading:[2,"loading","loading",a.L39],loadingIcon:"loadingIcon",emptyMessage:"emptyMessage",ariaLabel:"ariaLabel",togglerAriaLabel:"togglerAriaLabel",ariaLabelledBy:"ariaLabelledBy",validateDrop:[2,"validateDrop","validateDrop",a.L39],filter:[2,"filter","filter",a.L39],filterBy:"filterBy",filterMode:"filterMode",filterPlaceholder:"filterPlaceholder",filteredNodes:"filteredNodes",filterLocale:"filterLocale",scrollHeight:"scrollHeight",lazy:[2,"lazy","lazy",a.L39],virtualScroll:[2,"virtualScroll","virtualScroll",a.L39],virtualScrollItemSize:[2,"virtualScrollItemSize","virtualScrollItemSize",a.Udg],virtualScrollOptions:"virtualScrollOptions",indentation:[2,"indentation","indentation",a.Udg],_templateMap:"_templateMap",trackBy:"trackBy",virtualNodeHeight:"virtualNodeHeight"},outputs:{selectionChange:"selectionChange",onNodeSelect:"onNodeSelect",onNodeUnselect:"onNodeUnselect",onNodeExpand:"onNodeExpand",onNodeCollapse:"onNodeCollapse",onNodeContextMenuSelect:"onNodeContextMenuSelect",onNodeDrop:"onNodeDrop",onLazyLoad:"onLazyLoad",onScroll:"onScroll",onScrollIndexChange:"onScrollIndexChange",onFilter:"onFilter"},features:[a.GFd,a.OA$],decls:2,vars:2,consts:[["filter",""],["scroller",""],["treeNode",""],["wrapper",""],["emptyFilter",""],[3,"ngClass","ngStyle","class","drop","dragover","dragenter","dragleave",4,"ngIf"],[3,"ngClass","ngStyle","class",4,"ngIf"],[3,"drop","dragover","dragenter","dragleave","ngClass","ngStyle"],["class","p-tree-loading-overlay p-component-overlay",4,"ngIf"],[4,"ngTemplateOutlet"],["class","p-tree-filter-container",4,"ngIf"],[4,"ngIf"],["class","p-tree-empty-message",4,"ngIf"],[1,"p-tree-loading-overlay","p-component-overlay"],[3,"class",4,"ngIf"],[3,"spin","styleClass",4,"ngIf"],["class","p-tree-loading-icon",4,"ngIf"],[3,"spin","styleClass"],[1,"p-tree-loading-icon"],[1,"p-tree-filter-container"],["type","search","autocomplete","off",1,"p-tree-filter","p-inputtext","p-component",3,"keydown.enter","input"],[3,"styleClass",4,"ngIf"],["class","p-tree-filter-icon",4,"ngIf"],[3,"styleClass"],[1,"p-tree-filter-icon"],["styleClass","p-tree-wrapper",3,"items","tabindex","style","scrollHeight","itemSize","lazy","options","onScroll","onScrollIndexChange","onLazyLoad",4,"ngIf"],["styleClass","p-tree-wrapper",3,"onScroll","onScrollIndexChange","onLazyLoad","items","tabindex","scrollHeight","itemSize","lazy","options"],["pTemplate","content"],["class","p-tree-container","role","tree",3,"ngClass","style",4,"ngIf"],["role","tree",1,"p-tree-container",3,"ngClass"],[3,"level","rowNode","node","parentNode","firstChild","lastChild","index","itemSize","indentation","loadingMode",4,"ngFor","ngForOf","ngForTrackBy"],[3,"level","rowNode","node","parentNode","firstChild","lastChild","index","itemSize","indentation","loadingMode"],["pTemplate","loader"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"p-tree-wrapper",3,"ngStyle"],["class","p-tree-container","role","tree",4,"ngIf"],["role","tree",1,"p-tree-container"],[3,"node","firstChild","lastChild","index","level","loadingMode",4,"ngFor","ngForOf","ngForTrackBy"],[3,"node","firstChild","lastChild","index","level","loadingMode"],[1,"p-tree-empty-message"],[4,"ngIf","ngIfElse"],[3,"ngClass","ngStyle"],["class","p-tree-loading-mask p-component-overlay",4,"ngIf"],[1,"p-tree-loading-mask","p-component-overlay"],[3,"node","root"]],template:function(n,i){1&n&&a.DNE(0,iI,7,15,"div",5)(1,dI,6,11,"div",6),2&n&&(a.Y8G("ngIf",!i.horizontal),a.R7$(),a.Y8G("ngIf",i.horizontal))},dependencies:()=>[Oe.YU,Oe.Sq,Oe.bT,Oe.T3,Oe.B3,Ze.Ei,Li.H,Ua.W,Ts.N,mI],styles:["@layer primeng{.p-tree-container{margin:0;padding:0;list-style-type:none;overflow:auto}.p-treenode-children{margin:0;padding:0;list-style-type:none}.p-tree-wrapper{overflow:auto}.p-treenode-selectable{cursor:pointer;-webkit-user-select:none;user-select:none}.p-tree-toggler{cursor:pointer;-webkit-user-select:none;user-select:none;display:inline-flex;align-items:center;justify-content:center;overflow:hidden;position:relative;flex-shrink:0}.p-treenode-leaf>.p-treenode-content .p-tree-toggler{visibility:hidden}.p-treenode-content{display:flex;align-items:center}.p-tree-filter{width:100%}.p-tree-filter-container{position:relative;display:block;width:100%}.p-tree-filter-icon{position:absolute;top:50%;margin-top:-.5rem}.p-tree-loading{position:relative;min-height:4rem}.p-tree .p-tree-loading-overlay{position:absolute;display:flex;align-items:center;justify-content:center;z-index:2}.p-tree-flex-scrollable{display:flex;flex:1;height:100%;flex-direction:column}.p-tree-flex-scrollable .p-tree-wrapper{flex:1}.p-tree .p-treenode-droppoint{height:4px;list-style-type:none}.p-tree .p-treenode-droppoint-active{border:0 none}.p-tree-horizontal{width:auto;padding-left:0;padding-right:0;overflow:auto}.p-tree.p-tree-horizontal table,.p-tree.p-tree-horizontal tr,.p-tree.p-tree-horizontal td{border-collapse:collapse;margin:0;padding:0;vertical-align:middle}.p-tree-horizontal .p-treenode-content{font-weight:400;padding:.4em 1em .4em .2em;display:flex;align-items:center}.p-tree-horizontal .p-treenode-parent .p-treenode-content{font-weight:400;white-space:nowrap}.p-tree.p-tree-horizontal .p-treenode{background:url(data:image/gif;base64,R0lGODlhAQABAIAAALGxsf///yH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNC4xLWMwMzQgNDYuMjcyOTc2LCBTYXQgSmFuIDI3IDIwMDcgMjI6Mzc6MzcgICAgICAgICI+CiAgIDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CiAgICAgIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICAgICAgICAgIHhtbG5zOnhhcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyI+CiAgICAgICAgIDx4YXA6Q3JlYXRvclRvb2w+QWRvYmUgRmlyZXdvcmtzIENTMzwveGFwOkNyZWF0b3JUb29sPgogICAgICAgICA8eGFwOkNyZWF0ZURhdGU+MjAxMC0wMy0xMVQxMDoxNjo0MVo8L3hhcDpDcmVhdGVEYXRlPgogICAgICAgICA8eGFwOk1vZGlmeURhdGU+MjAxMC0wMy0xMVQxMjo0NDoxOVo8L3hhcDpNb2RpZnlEYXRlPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIj4KICAgICAgICAgPGRjOmZvcm1hdD5pbWFnZS9naWY8L2RjOmZvcm1hdD4KICAgICAgPC9yZGY6RGVzY3JpcHRpb24+CiAgIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgCjw/eHBhY2tldCBlbmQ9InciPz4B//79/Pv6+fj39vX08/Lx8O/u7ezr6uno5+bl5OPi4eDf3t3c29rZ2NfW1dTT0tHQz87NzMvKycjHxsXEw8LBwL++vby7urm4t7a1tLOysbCvrq2sq6qpqKempaSjoqGgn56dnJuamZiXlpWUk5KRkI+OjYyLiomIh4aFhIOCgYB/fn18e3p5eHd2dXRzcnFwb25tbGtqaWhnZmVkY2JhYF9eXVxbWllYV1ZVVFNSUVBPTk1MS0pJSEdGRURDQkFAPz49PAA6OTg3NjU0MzIxMC8uLSwrKikoJyYlJCMiISAfHh0cGxoZGBcWFRQTEhEQDw4NDAsKCQgHBgUEAwIBAAAh+QQABwD/ACwAAAAAAQABAAACAkQBADs=) repeat-x scroll center center transparent;padding:.25rem 2.5rem}.p-tree.p-tree-horizontal .p-treenode.p-treenode-leaf,.p-tree.p-tree-horizontal .p-treenode.p-treenode-collapsed{padding-right:0}.p-tree.p-tree-horizontal .p-treenode-children{padding:0;margin:0}.p-tree.p-tree-horizontal .p-treenode-connector{width:1px}.p-tree.p-tree-horizontal .p-treenode-connector-table{height:100%;width:1px}.p-tree.p-tree-horizontal .p-treenode-connector-line{background:url(data:image/gif;base64,R0lGODlhAQABAIAAALGxsf///yH/C1hNUCBEYXRhWE1QPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNC4xLWMwMzQgNDYuMjcyOTc2LCBTYXQgSmFuIDI3IDIwMDcgMjI6Mzc6MzcgICAgICAgICI+CiAgIDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CiAgICAgIDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiCiAgICAgICAgICAgIHhtbG5zOnhhcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyI+CiAgICAgICAgIDx4YXA6Q3JlYXRvclRvb2w+QWRvYmUgRmlyZXdvcmtzIENTMzwveGFwOkNyZWF0b3JUb29sPgogICAgICAgICA8eGFwOkNyZWF0ZURhdGU+MjAxMC0wMy0xMVQxMDoxNjo0MVo8L3hhcDpDcmVhdGVEYXRlPgogICAgICAgICA8eGFwOk1vZGlmeURhdGU+MjAxMC0wMy0xMVQxMjo0NDoxOVo8L3hhcDpNb2RpZnlEYXRlPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIj4KICAgICAgICAgPGRjOmZvcm1hdD5pbWFnZS9naWY8L2RjOmZvcm1hdD4KICAgICAgPC9yZGY6RGVzY3JpcHRpb24+CiAgIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgCjw/eHBhY2tldCBlbmQ9InciPz4B//79/Pv6+fj39vX08/Lx8O/u7ezr6uno5+bl5OPi4eDf3t3c29rZ2NfW1dTT0tHQz87NzMvKycjHxsXEw8LBwL++vby7urm4t7a1tLOysbCvrq2sq6qpqKempaSjoqGgn56dnJuamZiXlpWUk5KRkI+OjYyLiomIh4aFhIOCgYB/fn18e3p5eHd2dXRzcnFwb25tbGtqaWhnZmVkY2JhYF9eXVxbWllYV1ZVVFNSUVBPTk1MS0pJSEdGRURDQkFAPz49PAA6OTg3NjU0MzIxMC8uLSwrKikoJyYlJCMiISAfHh0cGxoZGBcWFRQTEhEQDw4NDAsKCQgHBgUEAwIBAAAh+QQABwD/ACwAAAAAAQABAAACAkQBADs=) repeat-y scroll 0 0 transparent;width:1px}.p-tree.p-tree-horizontal table{height:0}.p-scroller .p-tree-container{overflow:visible}}\n"],encapsulation:2})}return e})(),bs=(()=>{class e{static \u0275fac=function(n){return new(n||e)};static \u0275mod=a.$C({type:e});static \u0275inj=a.G2t({imports:[Oe.MD,Ze.Gg,Mi.Z,Li.h,I0.S,La.D,Oa.v,A0.Q,Ua.W,Ts.N,p0.c,Ze.Gg,Li.h]})}return e})();var Es=Fe(9335),v0=Fe(1880);const _I=["container"],xI=["focusInput"],vI=["filter"],kI=["tree"],wI=["panel"],yI=["overlay"],TI=["firstHiddenFocusableEl"],SI=["lastHiddenFocusableEl"],bI=(e,r)=>({$implicit:e,placeholder:r}),k0=(e,r)=>({$implicit:e,options:r}),EI=e=>({"max-height":e}),FI=e=>({$implicit:e}),DI=(e,r)=>({$implicit:e,partialSelected:r});function NI(e,r){1&e&&a.eu8(0)}function PI(e,r){if(1&e&&(a.qex(0),a.DNE(1,NI,1,0,"ng-container",22),a.bVm()),2&e){const t=a.XpG();a.R7$(),a.Y8G("ngTemplateOutlet",t.valueTemplate)("ngTemplateOutletContext",a.l_i(2,bI,t.value,t.placeholder))}}function RI(e,r){if(1&e&&(a.qex(0),a.EFF(1),a.bVm()),2&e){const t=a.XpG(2);a.R7$(),a.SpI(" ",t.label||"empty"," ")}}function OI(e,r){if(1&e&&(a.j41(0,"div",24)(1,"span",25),a.EFF(2),a.k0s()()),2&e){const t=r.$implicit;a.R7$(2),a.JRh(t.label)}}function BI(e,r){if(1&e&&(a.qex(0),a.EFF(1),a.bVm()),2&e){const t=a.XpG(3);a.R7$(),a.JRh(t.placeholder||"empty")}}function MI(e,r){if(1&e&&a.DNE(0,OI,3,1,"div",23)(1,BI,2,1,"ng-container",16),2&e){const t=a.XpG(2);a.Y8G("ngForOf",t.value),a.R7$(),a.Y8G("ngIf",t.emptyValue)}}function LI(e,r){if(1&e&&a.DNE(0,RI,2,1,"ng-container",15)(1,MI,2,2,"ng-template",null,4,a.C5r),2&e){const t=a.sdS(2),n=a.XpG();a.Y8G("ngIf","comma"===n.display)("ngIfElse",t)}}function UI(e,r){if(1&e){const t=a.RV6();a.j41(0,"TimesIcon",28),a.bIt("click",function(i){a.eBV(t);const s=a.XpG(2);return a.Njj(s.clear(i))}),a.k0s()}2&e&&a.Y8G("styleClass","p-treeselect-clear-icon")}function GI(e,r){}function jI(e,r){1&e&&a.DNE(0,GI,0,0,"ng-template")}function VI(e,r){if(1&e){const t=a.RV6();a.j41(0,"span",29),a.bIt("click",function(i){a.eBV(t);const s=a.XpG(2);return a.Njj(s.clear(i))}),a.DNE(1,jI,1,0,null,30),a.k0s()}if(2&e){const t=a.XpG(2);a.R7$(),a.Y8G("ngTemplateOutlet",t.clearIconTemplate)}}function $I(e,r){if(1&e&&(a.qex(0),a.DNE(1,UI,1,1,"TimesIcon",26)(2,VI,2,1,"span",27),a.bVm()),2&e){const t=a.XpG();a.R7$(),a.Y8G("ngIf",!t.clearIconTemplate),a.R7$(),a.Y8G("ngIf",t.clearIconTemplate)}}function WI(e,r){1&e&&a.nrm(0,"ChevronDownIcon",31),2&e&&a.Y8G("styleClass","p-treeselect-trigger-icon")}function XI(e,r){}function zI(e,r){1&e&&a.DNE(0,XI,0,0,"ng-template")}function HI(e,r){if(1&e&&(a.j41(0,"span",32),a.DNE(1,zI,1,0,null,30),a.k0s()),2&e){const t=a.XpG();a.R7$(),a.Y8G("ngTemplateOutlet",t.triggerIconTemplate)}}function YI(e,r){1&e&&a.eu8(0)}function JI(e,r){1&e&&a.nrm(0,"SearchIcon",31),2&e&&a.Y8G("styleClass","p-treeselect-filter-icon")}function KI(e,r){}function ZI(e,r){1&e&&a.DNE(0,KI,0,0,"ng-template")}function QI(e,r){if(1&e&&(a.j41(0,"span",43),a.DNE(1,ZI,1,0,null,30),a.k0s()),2&e){const t=a.XpG(3);a.R7$(),a.Y8G("ngTemplateOutlet",t.filterIconTemplate)}}function qI(e,r){1&e&&a.nrm(0,"TimesIcon")}function eA(e,r){}function tA(e,r){1&e&&a.DNE(0,eA,0,0,"ng-template")}function rA(e,r){if(1&e&&(a.j41(0,"span"),a.DNE(1,tA,1,0,null,30),a.k0s()),2&e){const t=a.XpG(3);a.R7$(),a.Y8G("ngTemplateOutlet",t.closeIconTemplate)}}function nA(e,r){if(1&e){const t=a.RV6();a.j41(0,"div",38),a.bIt("keydown.arrowdown",function(i){a.eBV(t);const s=a.XpG(2);return a.Njj(s.onArrowDown(i))}),a.j41(1,"div",39)(2,"input",40,9),a.bIt("keydown.enter",function(i){return a.eBV(t),a.Njj(i.preventDefault())})("input",function(i){a.eBV(t);const s=a.XpG(2);return a.Njj(s.onFilterInput(i))}),a.k0s(),a.DNE(4,JI,1,1,"SearchIcon",18)(5,QI,2,1,"span",41),a.k0s(),a.j41(6,"button",42),a.bIt("click",function(){a.eBV(t);const i=a.XpG(2);return a.Njj(i.hide())}),a.DNE(7,qI,1,0,"TimesIcon",16)(8,rA,2,1,"span",16),a.k0s()()}if(2&e){const t=a.XpG(2);a.R7$(2),a.Y8G("value",t.filterValue),a.BMQ("placeholder",t.filterPlaceholder),a.R7$(2),a.Y8G("ngIf",!t.filterIconTemplate),a.R7$(),a.Y8G("ngIf",t.filterIconTemplate),a.R7$(2),a.Y8G("ngIf",!t.closeIconTemplate),a.R7$(),a.Y8G("ngIf",t.closeIconTemplate)}}function iA(e,r){1&e&&a.eu8(0)}function aA(e,r){if(1&e&&a.DNE(0,iA,1,0,"ng-container",30),2&e){const t=a.XpG(3);a.Y8G("ngTemplateOutlet",t.emptyTemplate)}}function sA(e,r){1&e&&(a.qex(0),a.DNE(1,aA,1,1,"ng-template",44),a.bVm())}function oA(e,r){1&e&&a.eu8(0)}function lA(e,r){if(1&e&&a.DNE(0,oA,1,0,"ng-container",22),2&e){const t=r.$implicit,n=a.XpG(3);a.Y8G("ngTemplateOutlet",n.itemTogglerIconTemplate)("ngTemplateOutletContext",a.eq3(2,FI,t))}}function cA(e,r){1&e&&a.DNE(0,lA,1,4,"ng-template",45)}function gA(e,r){1&e&&a.eu8(0)}function fA(e,r){if(1&e&&a.DNE(0,gA,1,0,"ng-container",22),2&e){const t=r.$implicit,n=r.partialSelected,i=a.XpG(3);a.Y8G("ngTemplateOutlet",i.itemCheckboxIconTemplate)("ngTemplateOutletContext",a.l_i(2,DI,t,n))}}function uA(e,r){1&e&&a.DNE(0,fA,1,5,"ng-template",46)}function hA(e,r){1&e&&a.eu8(0)}function CA(e,r){if(1&e&&a.DNE(0,hA,1,0,"ng-container",30),2&e){const t=a.XpG(3);a.Y8G("ngTemplateOutlet",t.itemLoadingIconTemplate)}}function IA(e,r){1&e&&a.DNE(0,CA,1,1,"ng-template",47)}function AA(e,r){1&e&&a.eu8(0)}function pA(e,r){if(1&e){const t=a.RV6();a.j41(0,"div",33,5)(2,"span",34,6),a.bIt("focus",function(i){a.eBV(t);const s=a.XpG();return a.Njj(s.onFirstHiddenFocus(i))}),a.k0s(),a.DNE(4,YI,1,0,"ng-container",22)(5,nA,9,6,"div",35),a.j41(6,"div",36)(7,"p-tree",37,7),a.bIt("selectionChange",function(i){a.eBV(t);const s=a.XpG();return a.Njj(s.onSelectionChange(i))})("onNodeExpand",function(i){a.eBV(t);const s=a.XpG();return a.Njj(s.nodeExpand(i))})("onNodeCollapse",function(i){a.eBV(t);const s=a.XpG();return a.Njj(s.nodeCollapse(i))})("onNodeSelect",function(i){a.eBV(t);const s=a.XpG();return a.Njj(s.onSelect(i))})("onNodeUnselect",function(i){a.eBV(t);const s=a.XpG();return a.Njj(s.onUnselect(i))}),a.DNE(9,sA,2,0,"ng-container",16)(10,cA,1,0,null,16)(11,uA,1,0,null,16)(12,IA,1,0,null,16),a.k0s()(),a.DNE(13,AA,1,0,"ng-container",22),a.j41(14,"span",34,8),a.bIt("focus",function(i){a.eBV(t);const s=a.XpG();return a.Njj(s.onLastHiddenFocus(i))}),a.k0s()()}if(2&e){const t=a.XpG();a.HbH(t.panelStyleClass),a.Y8G("ngStyle",t.panelStyle)("ngClass",t.panelClass),a.BMQ("id",t.listId),a.R7$(2),a.BMQ("tabindex",0)("data-p-hidden-accessible",!0)("data-p-hidden-focusable",!0),a.R7$(2),a.Y8G("ngTemplateOutlet",t.headerTemplate)("ngTemplateOutletContext",a.l_i(38,k0,t.value,t.options)),a.R7$(),a.Y8G("ngIf",t.filter),a.R7$(),a.Y8G("ngStyle",a.eq3(41,EI,t.scrollHeight)),a.R7$(),a.Y8G("value",t.options)("propagateSelectionDown",t.propagateSelectionDown)("propagateSelectionUp",t.propagateSelectionUp)("selectionMode",t.selectionMode)("selection",t.value)("metaKeySelection",t.metaKeySelection)("emptyMessage",t.emptyMessage)("filterBy",t.filterBy)("filterMode",t.filterMode)("filterPlaceholder",t.filterPlaceholder)("filterLocale",t.filterLocale)("filteredNodes",t.filteredNodes)("virtualScroll",t.virtualScroll)("virtualScrollItemSize",t.virtualScrollItemSize)("virtualScrollOptions",t.virtualScrollOptions)("_templateMap",t.templateMap)("loading",t.loading),a.R7$(2),a.Y8G("ngIf",t.emptyTemplate),a.R7$(),a.Y8G("ngIf",t.itemTogglerIconTemplate),a.R7$(),a.Y8G("ngIf",t.itemCheckboxIconTemplate),a.R7$(),a.Y8G("ngIf",t.itemLoadingIconTemplate),a.R7$(),a.Y8G("ngTemplateOutlet",t.footerTemplate)("ngTemplateOutletContext",a.l_i(43,k0,t.value,t.options)),a.R7$(),a.BMQ("tabindex",0)("data-p-hidden-accessible",!0)("data-p-hidden-focusable",!0)}}const dA={provide:nr.kq,useExisting:(0,a.Rfq)(()=>w0),multi:!0};let w0=(()=>{class e{config;cd;el;overlayService;inputId;scrollHeight="400px";disabled;metaKeySelection=!1;variant="outlined";display="comma";selectionMode="single";tabindex="0";ariaLabel;ariaLabelledBy;placeholder;panelClass;panelStyle;panelStyleClass;containerStyle;containerStyleClass;labelStyle;labelStyleClass;overlayOptions;emptyMessage="";appendTo;filter=!1;filterBy="label";filterMode="lenient";filterPlaceholder;filterLocale;filterInputAutoFocus=!0;propagateSelectionDown=!0;propagateSelectionUp=!0;showClear=!1;resetFilterOnHide=!0;virtualScroll;virtualScrollItemSize;virtualScrollOptions;autofocus;get options(){return this._options}set options(t){this._options=t,this.updateTreeState()}get showTransitionOptions(){return this._showTransitionOptions}set showTransitionOptions(t){this._showTransitionOptions=t,console.warn("The showTransitionOptions property is deprecated since v14.2.0, use overlayOptions property instead.")}get hideTransitionOptions(){return this._hideTransitionOptions}set hideTransitionOptions(t){this._hideTransitionOptions=t,console.warn("The hideTransitionOptions property is deprecated since v14.2.0, use overlayOptions property instead.")}loading;onNodeExpand=new a.bkB;onNodeCollapse=new a.bkB;onShow=new a.bkB;onHide=new a.bkB;onClear=new a.bkB;onFilter=new a.bkB;onFocus=new a.bkB;onBlur=new a.bkB;onNodeUnselect=new a.bkB;onNodeSelect=new a.bkB;_showTransitionOptions;_hideTransitionOptions;templates;containerEl;focusInput;filterViewChild;treeViewChild;panelEl;overlayViewChild;firstHiddenFocusableElementOnOverlay;lastHiddenFocusableElementOnOverlay;filteredNodes;filterValue=null;serializedValue;valueTemplate;headerTemplate;emptyTemplate;footerTemplate;clearIconTemplate;triggerIconTemplate;filterIconTemplate;closeIconTemplate;itemTogglerIconTemplate;itemCheckboxIconTemplate;itemLoadingIconTemplate;focused;overlayVisible;selfChange;value;expandedNodes=[];_options;templateMap;onModelChange=()=>{};onModelTouched=()=>{};listId="";constructor(t,n,i,s){this.config=t,this.cd=n,this.el=i,this.overlayService=s}ngOnInit(){this.listId=(0,pn._Y)()+"_list",this.updateTreeState()}ngAfterContentInit(){this.templates.length&&(this.templateMap={}),this.templates.forEach(t=>{switch(t.getType()){case"value":this.valueTemplate=t.template;break;case"header":this.headerTemplate=t.template;break;case"empty":this.emptyTemplate=t.template;break;case"footer":this.footerTemplate=t.template;break;case"clearicon":this.clearIconTemplate=t.template;break;case"triggericon":this.triggerIconTemplate=t.template;break;case"filtericon":this.filterIconTemplate=t.template;break;case"closeicon":this.closeIconTemplate=t.template;break;case"itemtogglericon":this.itemTogglerIconTemplate=t.template;break;case"itemcheckboxicon":this.itemCheckboxIconTemplate=t.template;break;case"itemloadingicon":this.itemLoadingIconTemplate=t.template;break;default:t.name?this.templateMap[t.name]=t.template:this.valueTemplate=t.template}})}onOverlayAnimationStart(t){if("visible"===t.toState)if(this.filter)pn.BF.isNotEmpty(this.filterValue)&&this.treeViewChild?._filter(this.filterValue),this.filterInputAutoFocus&&this.filterViewChild?.nativeElement.focus();else{let n=qe.D.getFocusableElements(this.panelEl.nativeElement);n&&n.length>0&&n[0].focus()}}onOverlayBeforeHide(t){let n=qe.D.getFocusableElements(this.containerEl.nativeElement);n&&n.length>0&&n[0].focus()}onSelectionChange(t){this.value=t,this.onModelChange(this.value),this.cd.markForCheck()}onClick(t){this.disabled||!this.overlayViewChild?.el?.nativeElement?.contains(t.target)&&!qe.D.hasClass(t.target,"p-treeselect-close")&&!qe.D.hasClass(t.target,"p-checkbox-box")&&!qe.D.hasClass(t.target,"p-checkbox-icon")&&(this.overlayVisible?this.hide():this.show(),this.focusInput?.nativeElement.focus())}onKeyDown(t){switch(t.code){case"ArrowDown":this.overlayVisible||(this.show(),t.preventDefault()),this.onArrowDown(t),t.preventDefault();break;case"Space":case"Enter":this.overlayVisible||(this.show(),t.preventDefault());break;case"Escape":this.overlayVisible&&(this.hide(),this.focusInput?.nativeElement.focus(),t.preventDefault());break;case"Tab":this.onTabKey(t)}}onFilterInput(t){this.filterValue=t.target.value,this.treeViewChild?._filter(this.filterValue),this.onFilter.emit({filter:this.filterValue,filteredValue:this.treeViewChild?.filteredNodes}),setTimeout(()=>{this.overlayViewChild.alignOverlay()})}onArrowDown(t){if(this.overlayVisible&&this.panelEl?.nativeElement){let n=qe.D.getFocusableElements(this.panelEl.nativeElement,".p-treenode");n&&n.length>0&&n[0].focus(),t.preventDefault()}}onFirstHiddenFocus(t){const n=t.relatedTarget===this.focusInput?.nativeElement?qe.D.getFirstFocusableElement(this.overlayViewChild?.overlayViewChild?.nativeElement,':not([data-p-hidden-focusable="true"])'):this.focusInput?.nativeElement;qe.D.focus(n)}onLastHiddenFocus(t){const n=t.relatedTarget===this.focusInput?.nativeElement?qe.D.getLastFocusableElement(this.overlayViewChild?.overlayViewChild?.nativeElement,':not([data-p-hidden-focusable="true"])'):this.focusInput?.nativeElement;qe.D.focus(n)}show(){this.overlayVisible=!0}hide(t){this.overlayVisible=!1,this.resetFilter(),this.onHide.emit(t),this.cd.markForCheck()}clear(t){this.value=null,this.resetExpandedNodes(),this.resetPartialSelected(),this.onModelChange(this.value),this.onClear.emit(),t.stopPropagation()}checkValue(){return null!==this.value&&pn.BF.isNotEmpty(this.value)}onTabKey(t,n=!1){n||(this.overlayVisible&&this.hasFocusableElements()?(qe.D.focus(t.shiftKey?this.lastHiddenFocusableElementOnOverlay.nativeElement:this.firstHiddenFocusableElementOnOverlay.nativeElement),t.preventDefault()):this.overlayVisible&&this.hide(this.filter))}hasFocusableElements(){return qe.D.getFocusableElements(this.overlayViewChild.overlayViewChild.nativeElement,':not([data-p-hidden-focusable="true"])').length>0}resetFilter(){this.filter&&!this.resetFilterOnHide?(this.filteredNodes=this.treeViewChild?.filteredNodes,this.treeViewChild?.resetFilter()):this.filterValue=null}updateTreeState(){if(this.value){let t="single"===this.selectionMode?[this.value]:[...this.value];this.resetExpandedNodes(),this.resetPartialSelected(),t&&this.options&&this.updateTreeBranchState(null,null,t)}}updateTreeBranchState(t,n,i){if(t){if(this.isSelected(t)&&(this.expandPath(n),i.splice(i.indexOf(t),1)),i.length>0&&t.children)for(let s of t.children)this.updateTreeBranchState(s,[...n,t],i)}else for(let s of this.options)this.updateTreeBranchState(s,[],i)}expandPath(t){for(let n of t)n.expanded=!0;this.expandedNodes=[...t]}nodeExpand(t){this.onNodeExpand.emit(t),this.expandedNodes.push(t.node)}nodeCollapse(t){this.onNodeCollapse.emit(t),this.expandedNodes.splice(this.expandedNodes.indexOf(t.node),1)}resetExpandedNodes(){for(let t of this.expandedNodes)t.expanded=!1;this.expandedNodes=[]}resetPartialSelected(t=this.options){if(t)for(let n of t)n.partialSelected=!1,n.children&&n.children?.length>0&&this.resetPartialSelected(n.children)}findSelectedNodes(t,n,i){if(t){if(this.isSelected(t)&&(i.push(t),delete n[t.key]),Object.keys(n).length&&t.children)for(let s of t.children)this.findSelectedNodes(s,n,i)}else for(let s of this.options)this.findSelectedNodes(s,n,i)}isSelected(t){return-1!=this.findIndexInSelection(t)}findIndexInSelection(t){return this.value?("single"===this.selectionMode?[this.value]:this.value).findIndex(i=>i===t||i.key===t.key&&void 0!==i.key):-1}onSelect(t){this.onNodeSelect.emit(t),"single"===this.selectionMode&&(this.hide(),this.focusInput?.nativeElement.focus())}onUnselect(t){this.onNodeUnselect.emit(t)}onInputFocus(t){this.disabled||(this.focused=!0,this.onFocus.emit(t))}onInputBlur(t){this.focused=!1,this.onBlur.emit(t),this.onModelTouched()}writeValue(t){this.value=t,this.updateTreeState(),this.cd.markForCheck()}registerOnChange(t){this.onModelChange=t}registerOnTouched(t){this.onModelTouched=t}setDisabledState(t){setTimeout(()=>{this.disabled=t,this.cd.markForCheck()})}containerClass(){return{"p-treeselect p-component p-inputwrapper":!0,"p-treeselect-chip":"chip"===this.display,"p-disabled":this.disabled,"p-focus":this.focused,"p-variant-filled":"filled"===this.variant||"filled"===this.config.inputStyle()}}labelClass(){return{"p-treeselect-label":!0,"p-placeholder":this.label===this.placeholder,"p-treeselect-label-empty":!this.placeholder&&this.emptyValue}}get emptyValue(){return!this.value||0===Object.keys(this.value).length}get emptyOptions(){return!this.options||0===this.options.length}get label(){let t=this.value||[];return t.length?t.map(n=>n.label).join(", "):"single"===this.selectionMode&&this.value?t.label:this.placeholder}static \u0275fac=function(n){return new(n||e)(a.rXU(Ze.r1),a.rXU(a.gRc),a.rXU(a.aKT),a.rXU(Ze.si))};static \u0275cmp=a.VBU({type:e,selectors:[["p-treeSelect"]],contentQueries:function(n,i,s){if(1&n&&a.wni(s,Ze.Ei,4),2&n){let o;a.mGM(o=a.lsd())&&(i.templates=o)}},viewQuery:function(n,i){if(1&n&&(a.GBs(_I,5),a.GBs(xI,5),a.GBs(vI,5),a.GBs(kI,5),a.GBs(wI,5),a.GBs(yI,5),a.GBs(TI,5),a.GBs(SI,5)),2&n){let s;a.mGM(s=a.lsd())&&(i.containerEl=s.first),a.mGM(s=a.lsd())&&(i.focusInput=s.first),a.mGM(s=a.lsd())&&(i.filterViewChild=s.first),a.mGM(s=a.lsd())&&(i.treeViewChild=s.first),a.mGM(s=a.lsd())&&(i.panelEl=s.first),a.mGM(s=a.lsd())&&(i.overlayViewChild=s.first),a.mGM(s=a.lsd())&&(i.firstHiddenFocusableElementOnOverlay=s.first),a.mGM(s=a.lsd())&&(i.lastHiddenFocusableElementOnOverlay=s.first)}},hostAttrs:[1,"p-element","p-inputwrapper"],hostVars:6,hostBindings:function(n,i){2&n&&a.AVh("p-inputwrapper-filled",!i.emptyValue)("p-inputwrapper-focus",i.focused)("p-treeselect-clearable",i.showClear&&!i.disabled)},inputs:{inputId:"inputId",scrollHeight:"scrollHeight",disabled:[2,"disabled","disabled",a.L39],metaKeySelection:[2,"metaKeySelection","metaKeySelection",a.L39],variant:"variant",display:"display",selectionMode:"selectionMode",tabindex:"tabindex",ariaLabel:"ariaLabel",ariaLabelledBy:"ariaLabelledBy",placeholder:"placeholder",panelClass:"panelClass",panelStyle:"panelStyle",panelStyleClass:"panelStyleClass",containerStyle:"containerStyle",containerStyleClass:"containerStyleClass",labelStyle:"labelStyle",labelStyleClass:"labelStyleClass",overlayOptions:"overlayOptions",emptyMessage:"emptyMessage",appendTo:"appendTo",filter:[2,"filter","filter",a.L39],filterBy:"filterBy",filterMode:"filterMode",filterPlaceholder:"filterPlaceholder",filterLocale:"filterLocale",filterInputAutoFocus:[2,"filterInputAutoFocus","filterInputAutoFocus",a.L39],propagateSelectionDown:[2,"propagateSelectionDown","propagateSelectionDown",a.L39],propagateSelectionUp:[2,"propagateSelectionUp","propagateSelectionUp",a.L39],showClear:[2,"showClear","showClear",a.L39],resetFilterOnHide:[2,"resetFilterOnHide","resetFilterOnHide",a.L39],virtualScroll:"virtualScroll",virtualScrollItemSize:"virtualScrollItemSize",virtualScrollOptions:"virtualScrollOptions",autofocus:[2,"autofocus","autofocus",a.L39],options:"options",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",loading:[2,"loading","loading",a.L39]},outputs:{onNodeExpand:"onNodeExpand",onNodeCollapse:"onNodeCollapse",onShow:"onShow",onHide:"onHide",onClear:"onClear",onFilter:"onFilter",onFocus:"onFocus",onBlur:"onBlur",onNodeUnselect:"onNodeUnselect",onNodeSelect:"onNodeSelect"},features:[a.Jv_([dA]),a.GFd],decls:17,vars:30,consts:[["container",""],["focusInput",""],["defaultValueTemplate",""],["overlay",""],["chipsValueTemplate",""],["panel",""],["firstHiddenFocusableEl",""],["tree",""],["lastHiddenFocusableEl",""],["filter",""],[3,"click","ngClass","ngStyle"],[1,"p-hidden-accessible"],["type","text","role","combobox","readonly","","pAutoFocus","",3,"focus","blur","keydown","disabled","autofocus"],[1,"p-treeselect-label-container"],[3,"ngClass","ngStyle"],[4,"ngIf","ngIfElse"],[4,"ngIf"],["role","button","aria-haspopup","tree",1,"p-treeselect-trigger"],[3,"styleClass",4,"ngIf"],["class","p-treeselect-trigger-icon",4,"ngIf"],[3,"visibleChange","onAnimationStart","onBeforeHide","onShow","onHide","visible","options","target","appendTo","showTransitionOptions","hideTransitionOptions"],["pTemplate","content"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["class","p-treeselect-token",4,"ngFor","ngForOf"],[1,"p-treeselect-token"],[1,"p-treeselect-token-label"],[3,"styleClass","click",4,"ngIf"],["class","p-treeselect-clear-icon",3,"click",4,"ngIf"],[3,"click","styleClass"],[1,"p-treeselect-clear-icon",3,"click"],[4,"ngTemplateOutlet"],[3,"styleClass"],[1,"p-treeselect-trigger-icon"],[1,"p-treeselect-panel","p-component",3,"ngStyle","ngClass"],["role","presentation",1,"p-hidden-accessible","p-hidden-focusable",3,"focus"],["class","p-treeselect-header",3,"keydown.arrowdown",4,"ngIf"],[1,"p-treeselect-items-wrapper",3,"ngStyle"],[3,"selectionChange","onNodeExpand","onNodeCollapse","onNodeSelect","onNodeUnselect","value","propagateSelectionDown","propagateSelectionUp","selectionMode","selection","metaKeySelection","emptyMessage","filterBy","filterMode","filterPlaceholder","filterLocale","filteredNodes","virtualScroll","virtualScrollItemSize","virtualScrollOptions","_templateMap","loading"],[1,"p-treeselect-header",3,"keydown.arrowdown"],[1,"p-treeselect-filter-container"],["type","search","autocomplete","off",1,"p-treeselect-filter","p-inputtext","p-component",3,"keydown.enter","input","value"],["class","p-treeselect-filter-icon",4,"ngIf"],[1,"p-treeselect-close","p-link",3,"click"],[1,"p-treeselect-filter-icon"],["pTemplate","empty"],["pTemplate","togglericon"],["pTemplate","checkboxicon"],["pTemplate","loadingicon"]],template:function(n,i){if(1&n){const s=a.RV6();a.j41(0,"div",10,0),a.bIt("click",function(l){return a.eBV(s),a.Njj(i.onClick(l))}),a.j41(2,"div",11)(3,"input",12,1),a.bIt("focus",function(l){return a.eBV(s),a.Njj(i.onInputFocus(l))})("blur",function(l){return a.eBV(s),a.Njj(i.onInputBlur(l))})("keydown",function(l){return a.eBV(s),a.Njj(i.onKeyDown(l))}),a.k0s()(),a.j41(5,"div",13)(6,"div",14),a.DNE(7,PI,2,5,"ng-container",15)(8,LI,3,2,"ng-template",null,2,a.C5r),a.k0s(),a.DNE(10,$I,3,2,"ng-container",16),a.k0s(),a.j41(11,"div",17),a.DNE(12,WI,1,1,"ChevronDownIcon",18)(13,HI,2,1,"span",19),a.k0s(),a.j41(14,"p-overlay",20,3),a.mxI("visibleChange",function(l){return a.eBV(s),a.DH7(i.overlayVisible,l)||(i.overlayVisible=l),a.Njj(l)}),a.bIt("onAnimationStart",function(l){return a.eBV(s),a.Njj(i.onOverlayAnimationStart(l))})("onBeforeHide",function(l){return a.eBV(s),a.Njj(i.onOverlayBeforeHide(l))})("onShow",function(l){return a.eBV(s),a.Njj(i.onShow.emit(l))})("onHide",function(l){return a.eBV(s),a.Njj(i.hide(l))}),a.DNE(16,pA,16,46,"ng-template",21),a.k0s()()}if(2&n){let s,o;const l=a.sdS(9);a.HbH(i.containerStyleClass),a.Y8G("ngClass",i.containerClass())("ngStyle",i.containerStyle),a.R7$(3),a.Y8G("disabled",i.disabled)("autofocus",i.autofocus),a.BMQ("id",i.inputId)("tabindex",i.disabled?-1:i.tabindex)("aria-controls",i.overlayVisible?i.listId:null)("aria-haspopup","tree")("aria-expanded",null!==(s=i.overlayVisible)&&void 0!==s&&s)("aria-labelledby",i.ariaLabelledBy)("aria-label",i.ariaLabel||("p-emptylabel"===i.label?void 0:i.label)),a.R7$(3),a.HbH(i.labelStyleClass),a.Y8G("ngClass",i.labelClass())("ngStyle",i.labelStyle),a.R7$(),a.Y8G("ngIf",i.valueTemplate)("ngIfElse",l),a.R7$(3),a.Y8G("ngIf",i.checkValue()&&!i.disabled&&i.showClear),a.R7$(),a.BMQ("aria-expanded",null!==(o=i.overlayVisible)&&void 0!==o&&o)("aria-label","treeselect trigger"),a.R7$(),a.Y8G("ngIf",!i.triggerIconTemplate),a.R7$(),a.Y8G("ngIf",i.triggerIconTemplate),a.R7$(),a.R50("visible",i.overlayVisible),a.Y8G("options",i.overlayOptions)("target","@parent")("appendTo",i.appendTo)("showTransitionOptions",i.showTransitionOptions)("hideTransitionOptions",i.hideTransitionOptions)}},dependencies:()=>[Oe.YU,Oe.Sq,Oe.bT,Oe.T3,Oe.B3,Es.hJ,Ze.Ei,Ss,v0.q,Ua.W,Ba.A,La.D],styles:["@layer primeng{.p-treeselect{display:inline-flex;cursor:pointer;position:relative;-webkit-user-select:none;user-select:none}.p-treeselect-trigger{display:flex;align-items:center;justify-content:center;flex-shrink:0}.p-treeselect-label-container{overflow:hidden;flex:1 1 auto;cursor:pointer;display:flex}.p-treeselect-label{display:block;white-space:nowrap;cursor:pointer;overflow:hidden;text-overflow:ellipsis}.p-treeselect-label-empty{overflow:hidden;visibility:hidden}.p-treeselect-token{cursor:default;display:inline-flex;align-items:center;flex:0 0 auto}.p-treeselect-items-wrapper{overflow:auto}.p-treeselect-header{display:flex;align-items:center;justify-content:space-between}.p-treeselect-filter-container{position:relative;flex:1 1 auto}.p-treeselect-filter-icon{position:absolute;top:50%;margin-top:-.5rem}.p-treeselect-filter-container .p-inputtext{width:100%}.p-treeselect-close{display:flex;align-items:center;justify-content:center;flex-shrink:0;overflow:hidden;position:relative;margin-left:auto}.p-treeselect-clear-icon{position:absolute;top:50%;margin-top:-.5rem}.p-fluid .p-treeselect{display:flex}.p-treeselect-clear-icon{position:absolute;top:50%;margin-top:-.5rem;cursor:pointer}.p-treeselect-clearable{position:relative}}\n"],encapsulation:2,changeDetection:0})}return e})(),mA=(()=>{class e{static \u0275fac=function(n){return new(n||e)};static \u0275mod=a.$C({type:e});static \u0275inj=a.G2t({imports:[Oe.MD,Es.z_,Mi.Z,Ze.Gg,bs,v0.u,Ua.W,Ba.A,La.D,Es.z_,Ze.Gg,bs]})}return e})();function _A(e,r){if(1&e){const t=a.RV6();a.j41(0,"p-checkbox",7),a.mxI("ngModelChange",function(i){const s=a.eBV(t).$implicit;return a.DH7(s.data.analyzable,i)||(s.data.analyzable=i),a.Njj(i)}),a.bIt("onChange",function(i){const s=a.eBV(t).$implicit,o=a.XpG();return a.Njj(o.updateCategoryAnalizability(s.data.iD,i))}),a.k0s(),a.EFF(1)}if(2&e){const t=r.$implicit;a.R50("ngModel",t.data.analyzable),a.Y8G("binary",!0),a.R7$(),a.SpI(" ",t.label," ")}}function xA(e,r){if(1&e){const t=a.RV6();a.j41(0,"p-checkbox",7),a.mxI("ngModelChange",function(i){const s=a.eBV(t).$implicit;return a.DH7(s.data.analyzable,i)||(s.data.analyzable=i),a.Njj(i)}),a.bIt("onChange",function(i){const s=a.eBV(t).$implicit,o=a.XpG();return a.Njj(o.updateTypeAnalizability(s.data.iD,i))}),a.k0s(),a.EFF(1)}if(2&e){const t=r.$implicit;a.R50("ngModel",t.data.analyzable),a.Y8G("binary",!0),a.R7$(),a.SpI(" ",t.label," ")}}function vA(e,r){}let kA=(()=>{class e extends Or.x{constructor(t,n,i){super(i),this.messageService=t,this.categoryTreeService=n,this.filteredCategories=new Fr.t([]),this.selectedCategory=null,this.filterTextChanged=new Fr.t("")}onShow(t){t.filterValue=this.filterTextChanged.getValue()}ngOnInit(){this.titleService.setTitle("\u0414\u0435\u0440\u0435\u0432\u043e \u0442\u043e\u0432\u0430\u0440\u043e\u0432"),this.filterTextChanged.pipe((0,rn.B)(500),(0,ui.F)()).pipe((0,nn.n)(t=>this.categoryTreeService.filterCategories(new C0.z.FilterCategoryModel({term:t,count:10})).pipe((0,Le.W)(n=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0444\u0438\u043b\u044c\u0442\u0440\u0430 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0439",severity:"error",detail:n}),Nt.w))))).subscribe(t=>{const n=t.map(i=>this.mapCategory(i,null,null));this.filteredCategories.next(n)})}onFilterNodeSelect(t){const n=t.node.leaf?t.node.parent.data.iD:t.node.iD;this.loadChildCategories(n,i=>this.topCategories=i.map(s=>this.mapCategory(s,null,n)))}clearCategoriesFilter(t){t.filterValue="",this.filterCategories("")}loadChildCategories(t,n){this.loading=!0,this.categoryTreeService.getCategories(t).pipe((0,Le.W)(i=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0434\u0435\u0440\u0435\u0432\u0430 \u0442\u0438\u043f\u043e\u0432 \u0442\u043e\u0432\u0430\u0440\u043e\u0432",severity:"error",detail:i}),this.loading=!1,Nt.w))).subscribe(i=>{n(i.sort((s,o)=>s.name.localeCompare(o.name))),this.loading=!1})}mapProductType(t){return{label:t.name,children:[],leaf:!0,key:t.iD.toString(),icon:"pi pi-list",hasChildren:!1,type:"productType",data:t}}mapCategory(t,n,i){const s={label:t.name,expandedIcon:"pi pi-folder-open",collapsedIcon:"pi pi-folder",leaf:!1,key:t.iD.toString(),icon:"pi pi-folder",type:"category",data:t,parent:n};if(i==t.iD){let o=s;for(;o;)o.expanded=!0,o=o.parent}return s.children=t.children?.sort((o,l)=>o.name.localeCompare(l.name)).map(o=>this.mapCategory(o,s,i))??[],s.children=s.children.concat(t.types.sort((o,l)=>o.name.localeCompare(l.name)).map(o=>this.mapProductType(o))),s}filterCategories(t){this.filterTextChanged.next(t)}importProductTypes(){this.categoryTreeService.importCategoryTree().pipe((0,Le.W)(t=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0434\u0435\u0440\u0435\u0432\u0430 \u0442\u0438\u043f\u043e\u0432 \u0442\u043e\u0432\u0430\u0440\u043e\u0432",severity:"error",detail:t}),Nt.w))).subscribe(()=>{this.messageService.add({summary:"\u0423\u0441\u043f\u0435\u0445",severity:"success",detail:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0434\u0435\u0440\u0435\u0432\u0430 \u0442\u0438\u043f\u043e\u0432 \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0430"})})}updateCategoryAnalizability(t,n){this.categoryTreeService.setCategoryAnalyzability(t,n.checked).pipe((0,Le.W)(i=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0444\u043b\u0430\u0433\u0430 \u0430\u043d\u0430\u043b\u0438\u0437\u0430 \u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u0438",severity:"error",detail:i}),Nt.w))).subscribe(()=>{this.messageService.add({summary:"\u0423\u0441\u043f\u0435\u0445",severity:"success",detail:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0434\u0435\u0440\u0435\u0432\u0430 \u0442\u0438\u043f\u043e\u0432 \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0430"})})}updateTypeAnalizability(t,n){this.categoryTreeService.setProductTypeAnalyzability(t,n.checked).pipe((0,Le.W)(i=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0444\u043b\u0430\u0433\u0430 \u0430\u043d\u0430\u043b\u0438\u0437\u0430 \u0442\u0438\u043f\u0430 \u0442\u043e\u0432\u0430\u0440\u043e\u0432",severity:"error",detail:i}),Nt.w))).subscribe(()=>{this.messageService.add({summary:"\u0423\u0441\u043f\u0435\u0445",severity:"success",detail:"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0434\u0435\u0440\u0435\u0432\u0430 \u0442\u0438\u043f\u043e\u0432 \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0430"})})}static{this.\u0275fac=function(n){return new(n||e)(a.rXU(Ze.bg),a.rXU(C0.z.CategoryTreeClient),a.rXU(Ut.hE))}}static{this.\u0275cmp=a.VBU({type:e,selectors:[["app-product-tree"]],features:[a.Vt3],decls:10,vars:6,consts:[["treeSelect",""],["containerStyleClass","w-full","appendTo","body","placeholder","Select Item",1,"md:w-20rem","w-full",3,"onShow","onClear","onNodeSelect","onFilter","options","filter","filterInputAutoFocus"],["pButton","",3,"click"],["filterMode","strict","filterPlaceholder","\u0424\u0438\u043b\u044c\u0442\u0440\u043e\u0432\u0430\u0442\u044c",1,"w-full","md:w-30rem",3,"value"],["pTemplate","category"],["pTemplate","productType"],["pTemplate","empty"],[3,"ngModelChange","onChange","ngModel","binary"]],template:function(n,i){if(1&n){const s=a.RV6();a.nrm(0,"p-toast"),a.j41(1,"p-treeSelect",1,0),a.nI1(3,"async"),a.bIt("onShow",function(){a.eBV(s);const l=a.sdS(2);return a.Njj(i.onShow(l))})("onClear",function(){a.eBV(s);const l=a.sdS(2);return a.Njj(i.clearCategoriesFilter(l))})("onNodeSelect",function(l){return a.eBV(s),a.Njj(i.onFilterNodeSelect(l))})("onFilter",function(){a.eBV(s);const l=a.sdS(2);return a.Njj(i.filterCategories(l.filterValue))}),a.k0s(),a.j41(4,"button",2),a.bIt("click",function(){return a.eBV(s),a.Njj(i.importProductTypes())}),a.EFF(5,"\u0418\u043c\u043f\u043e\u0440\u0442 \u0442\u0438\u043f\u043e\u0432 \u0442\u043e\u0432\u0430\u0440\u043e\u0432"),a.k0s(),a.j41(6,"p-tree",3),a.DNE(7,_A,2,3,"ng-template",4)(8,xA,2,3,"ng-template",5)(9,vA,0,0,"ng-template",6),a.k0s()}2&n&&(a.R7$(),a.Y8G("options",a.bMT(3,4,i.filteredCategories))("filter",!0)("filterInputAutoFocus",!0),a.R7$(5),a.Y8G("value",i.topCategories))},dependencies:[Ze.Ei,Gr._f,Fa.Sc,nr.BC,nr.vS,hi.y8,Ss,w0,Oe.Jj]})}}return e})();var Fs,se=Fe(1397),ke=Fe(8810),be=Fe(7673),wA=Fe(1985),ne=Fe(1626);!function(e){e.REDICY_API_BASE_URL=new a.nKC("REDICY_API_BASE_URL");let r=(()=>{class T{constructor(f,k){this.jsonParseReviver=void 0,this.http=f,this.baseUrl=k??"/"}findShipments(f){let k=this.baseUrl+"/v1/Shipment/FindShipments";k=k.replace(/[?&]$/,"");let V={body:JSON.stringify(f),observe:"response",responseType:"blob",headers:new ne.Lr({"Content-Type":"application/json",Accept:"application/json"})};return this.http.request("post",k,V).pipe((0,se.Z)(x=>this.processFindShipments(x))).pipe((0,Le.W)(x=>{if(!(x instanceof ne.xB))return(0,ke.$)(x);try{return this.processFindShipments(x)}catch(te){return(0,ke.$)(te)}}))}processFindShipments(f){const k=f.status,B=f instanceof ne.cS?f.body:f.error instanceof Blob?f.error:void 0;let V={};if(f.headers)for(let x of f.headers.keys())V[x]=f.headers.get(x);return 200===k?ye(B).pipe((0,se.Z)(x=>{let te=null,Be=""===x?null:JSON.parse(x,this.jsonParseReviver);return te=bt.fromJS(Be),(0,be.of)(te)})):200!==k&&204!==k?ye(B).pipe((0,se.Z)(x=>tt("An unexpected server error occurred.",k,x,V))):(0,be.of)(null)}updateShipments(){let f=this.baseUrl+"/v1/Shipment/UpdateShipments";f=f.replace(/[?&]$/,"");let k={observe:"response",responseType:"blob",headers:new ne.Lr({})};return this.http.request("post",f,k).pipe((0,se.Z)(B=>this.processUpdateShipments(B))).pipe((0,Le.W)(B=>{if(!(B instanceof ne.xB))return(0,ke.$)(B);try{return this.processUpdateShipments(B)}catch(V){return(0,ke.$)(V)}}))}processUpdateShipments(f){const k=f.status,B=f instanceof ne.cS?f.body:f.error instanceof Blob?f.error:void 0;let V={};if(f.headers)for(let x of f.headers.keys())V[x]=f.headers.get(x);return 200===k?ye(B).pipe((0,se.Z)(x=>(0,be.of)(null))):200!==k&&204!==k?ye(B).pipe((0,se.Z)(x=>tt("An unexpected server error occurred.",k,x,V))):(0,be.of)(null)}static{this.\u0275fac=function(k){return new(k||T)(a.KVO(ne.Qq),a.KVO(e.REDICY_API_BASE_URL,8))}}static{this.\u0275prov=a.jDH({token:T,factory:T.\u0275fac})}}return T})();e.ShipmentClient=r;let t=(()=>{class T{constructor(f,k){this.jsonParseReviver=void 0,this.http=f,this.baseUrl=k??"/"}getLatestSalesInfo(){let f=this.baseUrl+"/v1/Dashboard/GetLatestSalesInfo";f=f.replace(/[?&]$/,"");let k={observe:"response",responseType:"blob",headers:new ne.Lr({Accept:"application/json"})};return this.http.request("get",f,k).pipe((0,se.Z)(B=>this.processGetLatestSalesInfo(B))).pipe((0,Le.W)(B=>{if(!(B instanceof ne.xB))return(0,ke.$)(B);try{return this.processGetLatestSalesInfo(B)}catch(V){return(0,ke.$)(V)}}))}processGetLatestSalesInfo(f){const k=f.status,B=f instanceof ne.cS?f.body:f.error instanceof Blob?f.error:void 0;let V={};if(f.headers)for(let x of f.headers.keys())V[x]=f.headers.get(x);return 200===k?ye(B).pipe((0,se.Z)(x=>{let te=null,Be=""===x?null:JSON.parse(x,this.jsonParseReviver);return te=I.fromJS(Be),(0,be.of)(te)})):200!==k&&204!==k?ye(B).pipe((0,se.Z)(x=>tt("An unexpected server error occurred.",k,x,V))):(0,be.of)(null)}static{this.\u0275fac=function(k){return new(k||T)(a.KVO(ne.Qq),a.KVO(e.REDICY_API_BASE_URL,8))}}static{this.\u0275prov=a.jDH({token:T,factory:T.\u0275fac})}}return T})();e.DashboardClient=t;let n=(()=>{class T{constructor(f,k){this.jsonParseReviver=void 0,this.http=f,this.baseUrl=k??"/"}createVideoBatch(){let f=this.baseUrl+"/v1/ImageTool/CreateVideoBatch";f=f.replace(/[?&]$/,"");let k={observe:"response",responseType:"blob",headers:new ne.Lr({Accept:"application/json"})};return this.http.request("get",f,k).pipe((0,se.Z)(B=>this.processCreateVideoBatch(B))).pipe((0,Le.W)(B=>{if(!(B instanceof ne.xB))return(0,ke.$)(B);try{return this.processCreateVideoBatch(B)}catch(V){return(0,ke.$)(V)}}))}processCreateVideoBatch(f){const k=f.status,B=f instanceof ne.cS?f.body:f.error instanceof Blob?f.error:void 0;let V={};if(f.headers)for(let x of f.headers.keys())V[x]=f.headers.get(x);return 200===k?ye(B).pipe((0,se.Z)(x=>{let te=null,Be=""===x?null:JSON.parse(x,this.jsonParseReviver);return te=void 0!==Be?Be:null,(0,be.of)(te)})):200!==k&&204!==k?ye(B).pipe((0,se.Z)(x=>tt("An unexpected server error occurred.",k,x,V))):(0,be.of)(null)}finishBatch(f,k){let B=this.baseUrl+"/v1/ImageTool/FinishBatch?";if(null==f)throw new Error("The parameter 'batchID' must be defined and cannot be null.");if(B+="batchID="+encodeURIComponent(""+f)+"&",null==k)throw new Error("The parameter 'frameRate' must be defined and cannot be null.");B+="frameRate="+encodeURIComponent(""+k)+"&",B=B.replace(/[?&]$/,"");let V={observe:"response",responseType:"blob",headers:new ne.Lr({Accept:"application/json"})};return this.http.request("get",B,V).pipe((0,se.Z)(x=>this.processFinishBatch(x))).pipe((0,Le.W)(x=>{if(!(x instanceof ne.xB))return(0,ke.$)(x);try{return this.processFinishBatch(x)}catch(te){return(0,ke.$)(te)}}))}processFinishBatch(f){const k=f.status,B=f instanceof ne.cS?f.body:f.error instanceof Blob?f.error:void 0;let V={};if(f.headers)for(let x of f.headers.keys())V[x]=f.headers.get(x);if(200===k||206===k){const x=f.headers?f.headers.get("content-disposition"):void 0;let te=x?/filename\*=(?:(\\?['"])(.*?)\1|(?:[^\s]+'.*?')?([^;\n]*))/g.exec(x):void 0,Be=te&&te.length>1?te[3]||te[2]:void 0;return Be?Be=decodeURIComponent(Be):(te=x?/filename="?([^"]*?)"?(;|$)/g.exec(x):void 0,Be=te&&te.length>1?te[1]:void 0),(0,be.of)({fileName:Be,data:B,status:k,headers:V})}return 200!==k&&204!==k?ye(B).pipe((0,se.Z)(x=>tt("An unexpected server error occurred.",k,x,V))):(0,be.of)(null)}uploadBatchImage(f,k){let B=this.baseUrl+"/v1/ImageTool/UploadBatchImage?";if(null==f)throw new Error("The parameter 'batchID' must be defined and cannot be null.");B+="batchID="+encodeURIComponent(""+f)+"&",B=B.replace(/[?&]$/,"");const V=new FormData;if(null==k)throw new Error("The parameter 'files' cannot be null.");k.forEach(te=>V.append("files",te.data,te.fileName?te.fileName:"files"));let x={body:V,observe:"response",responseType:"blob",headers:new ne.Lr({})};return this.http.request("post",B,x).pipe((0,se.Z)(te=>this.processUploadBatchImage(te))).pipe((0,Le.W)(te=>{if(!(te instanceof ne.xB))return(0,ke.$)(te);try{return this.processUploadBatchImage(te)}catch(Be){return(0,ke.$)(Be)}}))}processUploadBatchImage(f){const k=f.status,B=f instanceof ne.cS?f.body:f.error instanceof Blob?f.error:void 0;let V={};if(f.headers)for(let x of f.headers.keys())V[x]=f.headers.get(x);return 204===k?ye(B).pipe((0,se.Z)(x=>(0,be.of)(null))):200!==k&&204!==k?ye(B).pipe((0,se.Z)(x=>tt("An unexpected server error occurred.",k,x,V))):(0,be.of)(null)}static{this.\u0275fac=function(k){return new(k||T)(a.KVO(ne.Qq),a.KVO(e.REDICY_API_BASE_URL,8))}}static{this.\u0275prov=a.jDH({token:T,factory:T.\u0275fac})}}return T})();e.ImageToolClient=n;let i=(()=>{class T{constructor(f,k){this.jsonParseReviver=void 0,this.http=f,this.baseUrl=k??"/"}importProducts(){let f=this.baseUrl+"/v1/Ozon/ImportProducts";f=f.replace(/[?&]$/,"");let k={observe:"response",responseType:"blob",headers:new ne.Lr({})};return this.http.request("get",f,k).pipe((0,se.Z)(B=>this.processImportProducts(B))).pipe((0,Le.W)(B=>{if(!(B instanceof ne.xB))return(0,ke.$)(B);try{return this.processImportProducts(B)}catch(V){return(0,ke.$)(V)}}))}processImportProducts(f){const k=f.status,B=f instanceof ne.cS?f.body:f.error instanceof Blob?f.error:void 0;let V={};if(f.headers)for(let x of f.headers.keys())V[x]=f.headers.get(x);return 204===k?ye(B).pipe((0,se.Z)(x=>(0,be.of)(null))):200!==k&&204!==k?ye(B).pipe((0,se.Z)(x=>tt("An unexpected server error occurred.",k,x,V))):(0,be.of)(null)}importTransactions(f,k){let B=this.baseUrl+"/v1/Ozon/ImportTransactions?";if(void 0===f)throw new Error("The parameter 'dateFrom' must be defined.");if(null!==f&&(B+="dateFrom="+encodeURIComponent(f?""+f.toISOString():"")+"&"),void 0===k)throw new Error("The parameter 'dateTo' must be defined.");null!==k&&(B+="dateTo="+encodeURIComponent(k?""+k.toISOString():"")+"&"),B=B.replace(/[?&]$/,"");let V={observe:"response",responseType:"blob",headers:new ne.Lr({})};return this.http.request("get",B,V).pipe((0,se.Z)(x=>this.processImportTransactions(x))).pipe((0,Le.W)(x=>{if(!(x instanceof ne.xB))return(0,ke.$)(x);try{return this.processImportTransactions(x)}catch(te){return(0,ke.$)(te)}}))}processImportTransactions(f){const k=f.status,B=f instanceof ne.cS?f.body:f.error instanceof Blob?f.error:void 0;let V={};if(f.headers)for(let x of f.headers.keys())V[x]=f.headers.get(x);return 204===k?ye(B).pipe((0,se.Z)(x=>(0,be.of)(null))):200!==k&&204!==k?ye(B).pipe((0,se.Z)(x=>tt("An unexpected server error occurred.",k,x,V))):(0,be.of)(null)}importWarehouses(){let f=this.baseUrl+"/v1/Ozon/ImportWarehouses";f=f.replace(/[?&]$/,"");let k={observe:"response",responseType:"blob",headers:new ne.Lr({})};return this.http.request("get",f,k).pipe((0,se.Z)(B=>this.processImportWarehouses(B))).pipe((0,Le.W)(B=>{if(!(B instanceof ne.xB))return(0,ke.$)(B);try{return this.processImportWarehouses(B)}catch(V){return(0,ke.$)(V)}}))}processImportWarehouses(f){const k=f.status,B=f instanceof ne.cS?f.body:f.error instanceof Blob?f.error:void 0;let V={};if(f.headers)for(let x of f.headers.keys())V[x]=f.headers.get(x);return 204===k?ye(B).pipe((0,se.Z)(x=>(0,be.of)(null))):200!==k&&204!==k?ye(B).pipe((0,se.Z)(x=>tt("An unexpected server error occurred.",k,x,V))):(0,be.of)(null)}importSellerApiOzonWarehouses(f){let k=this.baseUrl+"/v1/Ozon/ImportSellerApiOzonWarehouses";k=k.replace(/[?&]$/,"");let V={body:JSON.stringify(f),observe:"response",responseType:"blob",headers:new ne.Lr({"Content-Type":"application/json"})};return this.http.request("post",k,V).pipe((0,se.Z)(x=>this.processImportSellerApiOzonWarehouses(x))).pipe((0,Le.W)(x=>{if(!(x instanceof ne.xB))return(0,ke.$)(x);try{return this.processImportSellerApiOzonWarehouses(x)}catch(te){return(0,ke.$)(te)}}))}processImportSellerApiOzonWarehouses(f){const k=f.status,B=f instanceof ne.cS?f.body:f.error instanceof Blob?f.error:void 0;let V={};if(f.headers)for(let x of f.headers.keys())V[x]=f.headers.get(x);return 200===k?ye(B).pipe((0,se.Z)(x=>(0,be.of)(null))):200!==k&&204!==k?ye(B).pipe((0,se.Z)(x=>tt("An unexpected server error occurred.",k,x,V))):(0,be.of)(null)}getOzonLocalizationIndex(f,k){let B=this.baseUrl+"/v1/Ozon/GetOzonLocalizationIndex?";if(null===f)throw new Error("The parameter 'from' cannot be null.");if(void 0!==f&&(B+="from="+encodeURIComponent(f?""+f.toISOString():"")+"&"),null===k)throw new Error("The parameter 'to' cannot be null.");void 0!==k&&(B+="to="+encodeURIComponent(k?""+k.toISOString():"")+"&"),B=B.replace(/[?&]$/,"");let V={observe:"response",responseType:"blob",headers:new ne.Lr({Accept:"application/json"})};return this.http.request("get",B,V).pipe((0,se.Z)(x=>this.processGetOzonLocalizationIndex(x))).pipe((0,Le.W)(x=>{if(!(x instanceof ne.xB))return(0,ke.$)(x);try{return this.processGetOzonLocalizationIndex(x)}catch(te){return(0,ke.$)(te)}}))}processGetOzonLocalizationIndex(f){const k=f.status,B=f instanceof ne.cS?f.body:f.error instanceof Blob?f.error:void 0;let V={};if(f.headers)for(let x of f.headers.keys())V[x]=f.headers.get(x);return 200===k?ye(B).pipe((0,se.Z)(x=>{let te=null,Be=""===x?null:JSON.parse(x,this.jsonParseReviver);return te=void 0!==Be?Be:null,(0,be.of)(te)})):200!==k&&204!==k?ye(B).pipe((0,se.Z)(x=>tt("An unexpected server error occurred.",k,x,V))):(0,be.of)(null)}importProductStocks(){let f=this.baseUrl+"/v1/Ozon/ImportProductStocks";f=f.replace(/[?&]$/,"");let k={observe:"response",responseType:"blob",headers:new ne.Lr({})};return this.http.request("get",f,k).pipe((0,se.Z)(B=>this.processImportProductStocks(B))).pipe((0,Le.W)(B=>{if(!(B instanceof ne.xB))return(0,ke.$)(B);try{return this.processImportProductStocks(B)}catch(V){return(0,ke.$)(V)}}))}processImportProductStocks(f){const k=f.status,B=f instanceof ne.cS?f.body:f.error instanceof Blob?f.error:void 0;let V={};if(f.headers)for(let x of f.headers.keys())V[x]=f.headers.get(x);return 204===k?ye(B).pipe((0,se.Z)(x=>(0,be.of)(null))):200!==k&&204!==k?ye(B).pipe((0,se.Z)(x=>tt("An unexpected server error occurred.",k,x,V))):(0,be.of)(null)}importOzonPostings(f,k){let B=this.baseUrl+"/v1/Ozon/ImportOzonPostings?";if(void 0===f)throw new Error("The parameter 'dateFrom' must be defined.");if(null!==f&&(B+="dateFrom="+encodeURIComponent(f?""+f.toISOString():"")+"&"),void 0===k)throw new Error("The parameter 'dateTo' must be defined.");null!==k&&(B+="dateTo="+encodeURIComponent(k?""+k.toISOString():"")+"&"),B=B.replace(/[?&]$/,"");let V={observe:"response",responseType:"blob",headers:new ne.Lr({})};return this.http.request("post",B,V).pipe((0,se.Z)(x=>this.processImportOzonPostings(x))).pipe((0,Le.W)(x=>{if(!(x instanceof ne.xB))return(0,ke.$)(x);try{return this.processImportOzonPostings(x)}catch(te){return(0,ke.$)(te)}}))}processImportOzonPostings(f){const k=f.status,B=f instanceof ne.cS?f.body:f.error instanceof Blob?f.error:void 0;let V={};if(f.headers)for(let x of f.headers.keys())V[x]=f.headers.get(x);return 204===k?ye(B).pipe((0,se.Z)(x=>(0,be.of)(null))):200!==k&&204!==k?ye(B).pipe((0,se.Z)(x=>tt("An unexpected server error occurred.",k,x,V))):(0,be.of)(null)}importOzonSupplyOrders(){let f=this.baseUrl+"/v1/Ozon/ImportOzonSupplyOrders";f=f.replace(/[?&]$/,"");let k={observe:"response",responseType:"blob",headers:new ne.Lr({})};return this.http.request("post",f,k).pipe((0,se.Z)(B=>this.processImportOzonSupplyOrders(B))).pipe((0,Le.W)(B=>{if(!(B instanceof ne.xB))return(0,ke.$)(B);try{return this.processImportOzonSupplyOrders(B)}catch(V){return(0,ke.$)(V)}}))}processImportOzonSupplyOrders(f){const k=f.status,B=f instanceof ne.cS?f.body:f.error instanceof Blob?f.error:void 0;let V={};if(f.headers)for(let x of f.headers.keys())V[x]=f.headers.get(x);return 204===k?ye(B).pipe((0,se.Z)(x=>(0,be.of)(null))):200!==k&&204!==k?ye(B).pipe((0,se.Z)(x=>tt("An unexpected server error occurred.",k,x,V))):(0,be.of)(null)}findOzonOrders(f){let k=this.baseUrl+"/v1/Ozon/FindOzonOrders";k=k.replace(/[?&]$/,"");let V={body:JSON.stringify(f),observe:"response",responseType:"blob",headers:new ne.Lr({"Content-Type":"application/json",Accept:"application/json"})};return this.http.request("post",k,V).pipe((0,se.Z)(x=>this.processFindOzonOrders(x))).pipe((0,Le.W)(x=>{if(!(x instanceof ne.xB))return(0,ke.$)(x);try{return this.processFindOzonOrders(x)}catch(te){return(0,ke.$)(te)}}))}processFindOzonOrders(f){const k=f.status,B=f instanceof ne.cS?f.body:f.error instanceof Blob?f.error:void 0;let V={};if(f.headers)for(let x of f.headers.keys())V[x]=f.headers.get(x);return 200===k?ye(B).pipe((0,se.Z)(x=>{let te=null,Be=""===x?null:JSON.parse(x,this.jsonParseReviver);if(Array.isArray(Be)){te=[];for(let Er of Be)te.push(_.fromJS(Er))}else te=null;return(0,be.of)(te)})):200!==k&&204!==k?ye(B).pipe((0,se.Z)(x=>tt("An unexpected server error occurred.",k,x,V))):(0,be.of)(null)}findOzonSupplyOrders(f){let k=this.baseUrl+"/v1/Ozon/FindOzonSupplyOrders";k=k.replace(/[?&]$/,"");let V={body:JSON.stringify(f),observe:"response",responseType:"blob",headers:new ne.Lr({"Content-Type":"application/json",Accept:"application/json"})};return this.http.request("post",k,V).pipe((0,se.Z)(x=>this.processFindOzonSupplyOrders(x))).pipe((0,Le.W)(x=>{if(!(x instanceof ne.xB))return(0,ke.$)(x);try{return this.processFindOzonSupplyOrders(x)}catch(te){return(0,ke.$)(te)}}))}processFindOzonSupplyOrders(f){const k=f.status,B=f instanceof ne.cS?f.body:f.error instanceof Blob?f.error:void 0;let V={};if(f.headers)for(let x of f.headers.keys())V[x]=f.headers.get(x);return 200===k?ye(B).pipe((0,se.Z)(x=>{let te=null,Be=""===x?null:JSON.parse(x,this.jsonParseReviver);return te=ee.fromJS(Be),(0,be.of)(te)})):200!==k&&204!==k?ye(B).pipe((0,se.Z)(x=>tt("An unexpected server error occurred.",k,x,V))):(0,be.of)(null)}updateOzonSupplyOrderCrossDockWarehouse(f,k){let B=this.baseUrl+"/v1/Ozon/UpdateOzonSupplyOrderCrossDockWarehouse?";if(null===f)throw new Error("The parameter 'supplyOrderID' cannot be null.");if(void 0!==f&&(B+="supplyOrderID="+encodeURIComponent(""+f)+"&"),null===k)throw new Error("The parameter 'warehouseID' cannot be null.");void 0!==k&&(B+="warehouseID="+encodeURIComponent(""+k)+"&"),B=B.replace(/[?&]$/,"");let V={observe:"response",responseType:"blob",headers:new ne.Lr({})};return this.http.request("post",B,V).pipe((0,se.Z)(x=>this.processUpdateOzonSupplyOrderCrossDockWarehouse(x))).pipe((0,Le.W)(x=>{if(!(x instanceof ne.xB))return(0,ke.$)(x);try{return this.processUpdateOzonSupplyOrderCrossDockWarehouse(x)}catch(te){return(0,ke.$)(te)}}))}processUpdateOzonSupplyOrderCrossDockWarehouse(f){const k=f.status,B=f instanceof ne.cS?f.body:f.error instanceof Blob?f.error:void 0;let V={};if(f.headers)for(let x of f.headers.keys())V[x]=f.headers.get(x);return 200===k?ye(B).pipe((0,se.Z)(x=>(0,be.of)(null))):200!==k&&204!==k?ye(B).pipe((0,se.Z)(x=>tt("An unexpected server error occurred.",k,x,V))):(0,be.of)(null)}findOzonProducts(f){let k=this.baseUrl+"/v1/Ozon/FindOzonProducts";k=k.replace(/[?&]$/,"");let V={body:JSON.stringify(f),observe:"response",responseType:"blob",headers:new ne.Lr({"Content-Type":"application/json",Accept:"application/json"})};return this.http.request("post",k,V).pipe((0,se.Z)(x=>this.processFindOzonProducts(x))).pipe((0,Le.W)(x=>{if(!(x instanceof ne.xB))return(0,ke.$)(x);try{return this.processFindOzonProducts(x)}catch(te){return(0,ke.$)(te)}}))}processFindOzonProducts(f){const k=f.status,B=f instanceof ne.cS?f.body:f.error instanceof Blob?f.error:void 0;let V={};if(f.headers)for(let x of f.headers.keys())V[x]=f.headers.get(x);return 200===k?ye(B).pipe((0,se.Z)(x=>{let te=null,Be=""===x?null:JSON.parse(x,this.jsonParseReviver);return te=ue.fromJS(Be),(0,be.of)(te)})):200!==k&&204!==k?ye(B).pipe((0,se.Z)(x=>tt("An unexpected server error occurred.",k,x,V))):(0,be.of)(null)}findOzonOperations(f){let k=this.baseUrl+"/v1/Ozon/FindOzonOperations";k=k.replace(/[?&]$/,"");let V={body:JSON.stringify(f),observe:"response",responseType:"blob",headers:new ne.Lr({"Content-Type":"application/json",Accept:"application/json"})};return this.http.request("post",k,V).pipe((0,se.Z)(x=>this.processFindOzonOperations(x))).pipe((0,Le.W)(x=>{if(!(x instanceof ne.xB))return(0,ke.$)(x);try{return this.processFindOzonOperations(x)}catch(te){return(0,ke.$)(te)}}))}processFindOzonOperations(f){const k=f.status,B=f instanceof ne.cS?f.body:f.error instanceof Blob?f.error:void 0;let V={};if(f.headers)for(let x of f.headers.keys())V[x]=f.headers.get(x);return 200===k?ye(B).pipe((0,se.Z)(x=>{let te=null,Be=""===x?null:JSON.parse(x,this.jsonParseReviver);return te=he.fromJS(Be),(0,be.of)(te)})):200!==k&&204!==k?ye(B).pipe((0,se.Z)(x=>tt("An unexpected server error occurred.",k,x,V))):(0,be.of)(null)}removeOzonProduct(f){let k=this.baseUrl+"/v1/Ozon/RemoveOzonProduct";k=k.replace(/[?&]$/,"");let V={body:JSON.stringify(f),observe:"response",responseType:"blob",headers:new ne.Lr({"Content-Type":"application/json"})};return this.http.request("delete",k,V).pipe((0,se.Z)(x=>this.processRemoveOzonProduct(x))).pipe((0,Le.W)(x=>{if(!(x instanceof ne.xB))return(0,ke.$)(x);try{return this.processRemoveOzonProduct(x)}catch(te){return(0,ke.$)(te)}}))}processRemoveOzonProduct(f){const k=f.status,B=f instanceof ne.cS?f.body:f.error instanceof Blob?f.error:void 0;let V={};if(f.headers)for(let x of f.headers.keys())V[x]=f.headers.get(x);return 204===k?ye(B).pipe((0,se.Z)(x=>(0,be.of)(null))):200!==k&&204!==k?ye(B).pipe((0,se.Z)(x=>tt("An unexpected server error occurred.",k,x,V))):(0,be.of)(null)}static{this.\u0275fac=function(k){return new(k||T)(a.KVO(ne.Qq),a.KVO(e.REDICY_API_BASE_URL,8))}}static{this.\u0275prov=a.jDH({token:T,factory:T.\u0275fac})}}return T})();e.OzonClient=i;let s=(()=>{class T{constructor(f,k){this.jsonParseReviver=void 0,this.http=f,this.baseUrl=k??"/"}getOzonStockStarvationReport(f,k,B,V,x,te){let Be=this.baseUrl+"/v1/Report/GetOzonStockStarvationReport?";if(null==f)throw new Error("The parameter 'salesAnalysisInDays' must be defined and cannot be null.");if(Be+="salesAnalysisInDays="+encodeURIComponent(""+f)+"&",null==k)throw new Error("The parameter 'notificationPeriodInDays' must be defined and cannot be null.");if(Be+="notificationPeriodInDays="+encodeURIComponent(""+k)+"&",null!=B&&(Be+="date="+encodeURIComponent(B?""+B.toISOString():"")+"&"),null===V)throw new Error("The parameter 'respectMinimalStock' cannot be null.");if(void 0!==V&&(Be+="respectMinimalStock="+encodeURIComponent(""+V)+"&"),null===x)throw new Error("The parameter 'respectSupplyPreparationPeriod' cannot be null.");if(void 0!==x&&(Be+="respectSupplyPreparationPeriod="+encodeURIComponent(""+x)+"&"),null===te)throw new Error("The parameter 'respectActiveSupplyOrders' cannot be null.");void 0!==te&&(Be+="respectActiveSupplyOrders="+encodeURIComponent(""+te)+"&"),Be=Be.replace(/[?&]$/,"");let Er={observe:"response",responseType:"blob",headers:new ne.Lr({Accept:"application/json"})};return this.http.request("get",Be,Er).pipe((0,se.Z)(ci=>this.processGetOzonStockStarvationReport(ci))).pipe((0,Le.W)(ci=>{if(!(ci instanceof ne.xB))return(0,ke.$)(ci);try{return this.processGetOzonStockStarvationReport(ci)}catch(e0){return(0,ke.$)(e0)}}))}processGetOzonStockStarvationReport(f){const k=f.status,B=f instanceof ne.cS?f.body:f.error instanceof Blob?f.error:void 0;let V={};if(f.headers)for(let x of f.headers.keys())V[x]=f.headers.get(x);return 200===k?ye(B).pipe((0,se.Z)(x=>{let te=null,Be=""===x?null:JSON.parse(x,this.jsonParseReviver);if(Array.isArray(Be)){te=[];for(let Er of Be)te.push(C.fromJS(Er))}else te=null;return(0,be.of)(te)})):200!==k&&204!==k?ye(B).pipe((0,se.Z)(x=>tt("An unexpected server error occurred.",k,x,V))):(0,be.of)(null)}static{this.\u0275fac=function(k){return new(k||T)(a.KVO(ne.Qq),a.KVO(e.REDICY_API_BASE_URL,8))}}static{this.\u0275prov=a.jDH({token:T,factory:T.\u0275fac})}}return T})();e.ReportClient=s;let o=(()=>{class T{constructor(f,k){this.jsonParseReviver=void 0,this.http=f,this.baseUrl=k??"/"}getPackageTypesWithLatestPrices(){let f=this.baseUrl+"/v1/PackageType/GetPackageTypesWithLatestPrices";f=f.replace(/[?&]$/,"");let k={observe:"response",responseType:"blob",headers:new ne.Lr({Accept:"application/json"})};return this.http.request("get",f,k).pipe((0,se.Z)(B=>this.processGetPackageTypesWithLatestPrices(B))).pipe((0,Le.W)(B=>{if(!(B instanceof ne.xB))return(0,ke.$)(B);try{return this.processGetPackageTypesWithLatestPrices(B)}catch(V){return(0,ke.$)(V)}}))}processGetPackageTypesWithLatestPrices(f){const k=f.status,B=f instanceof ne.cS?f.body:f.error instanceof Blob?f.error:void 0;let V={};if(f.headers)for(let x of f.headers.keys())V[x]=f.headers.get(x);return 200===k?ye(B).pipe((0,se.Z)(x=>{let te=null,Be=""===x?null:JSON.parse(x,this.jsonParseReviver);if(Array.isArray(Be)){te=[];for(let Er of Be)te.push(Ne.fromJS(Er))}else te=null;return(0,be.of)(te)})):200!==k&&204!==k?ye(B).pipe((0,se.Z)(x=>tt("An unexpected server error occurred.",k,x,V))):(0,be.of)(null)}addPackageType(f){let k=this.baseUrl+"/v1/PackageType/AddPackageType";k=k.replace(/[?&]$/,"");let V={body:JSON.stringify(f),observe:"response",responseType:"blob",headers:new ne.Lr({"Content-Type":"application/json",Accept:"application/json"})};return this.http.request("post",k,V).pipe((0,se.Z)(x=>this.processAddPackageType(x))).pipe((0,Le.W)(x=>{if(!(x instanceof ne.xB))return(0,ke.$)(x);try{return this.processAddPackageType(x)}catch(te){return(0,ke.$)(te)}}))}processAddPackageType(f){const k=f.status,B=f instanceof ne.cS?f.body:f.error instanceof Blob?f.error:void 0;let V={};if(f.headers)for(let x of f.headers.keys())V[x]=f.headers.get(x);return 200===k?ye(B).pipe((0,se.Z)(x=>{let te=null,Be=""===x?null:JSON.parse(x,this.jsonParseReviver);return te=z.fromJS(Be),(0,be.of)(te)})):200!==k&&204!==k?ye(B).pipe((0,se.Z)(x=>tt("An unexpected server error occurred.",k,x,V))):(0,be.of)(null)}updatePackageType(f){let k=this.baseUrl+"/v1/PackageType/UpdatePackageType";k=k.replace(/[?&]$/,"");let V={body:JSON.stringify(f),observe:"response",responseType:"blob",headers:new ne.Lr({"Content-Type":"application/json"})};return this.http.request("post",k,V).pipe((0,se.Z)(x=>this.processUpdatePackageType(x))).pipe((0,Le.W)(x=>{if(!(x instanceof ne.xB))return(0,ke.$)(x);try{return this.processUpdatePackageType(x)}catch(te){return(0,ke.$)(te)}}))}processUpdatePackageType(f){const k=f.status,B=f instanceof ne.cS?f.body:f.error instanceof Blob?f.error:void 0;let V={};if(f.headers)for(let x of f.headers.keys())V[x]=f.headers.get(x);return 204===k?ye(B).pipe((0,se.Z)(x=>(0,be.of)(null))):200!==k&&204!==k?ye(B).pipe((0,se.Z)(x=>tt("An unexpected server error occurred.",k,x,V))):(0,be.of)(null)}removePackageType(f){let k=this.baseUrl+"/v1/PackageType/RemovePackageType?";if(null==f)throw new Error("The parameter 'model' must be defined and cannot be null.");k+="model="+encodeURIComponent(""+f)+"&",k=k.replace(/[?&]$/,"");let B={observe:"response",responseType:"blob",headers:new ne.Lr({})};return this.http.request("delete",k,B).pipe((0,se.Z)(V=>this.processRemovePackageType(V))).pipe((0,Le.W)(V=>{if(!(V instanceof ne.xB))return(0,ke.$)(V);try{return this.processRemovePackageType(V)}catch(x){return(0,ke.$)(x)}}))}processRemovePackageType(f){const k=f.status,B=f instanceof ne.cS?f.body:f.error instanceof Blob?f.error:void 0;let V={};if(f.headers)for(let x of f.headers.keys())V[x]=f.headers.get(x);return 204===k?ye(B).pipe((0,se.Z)(x=>(0,be.of)(null))):200!==k&&204!==k?ye(B).pipe((0,se.Z)(x=>tt("An unexpected server error occurred.",k,x,V))):(0,be.of)(null)}static{this.\u0275fac=function(k){return new(k||T)(a.KVO(ne.Qq),a.KVO(e.REDICY_API_BASE_URL,8))}}static{this.\u0275prov=a.jDH({token:T,factory:T.\u0275fac})}}return T})();e.PackageTypeClient=o;let l=(()=>{class T{constructor(f,k){this.jsonParseReviver=void 0,this.http=f,this.baseUrl=k??"/"}findProducts(f){let k=this.baseUrl+"/v1/Product/FindProducts";k=k.replace(/[?&]$/,"");let V={body:JSON.stringify(f),observe:"response",responseType:"blob",headers:new ne.Lr({"Content-Type":"application/json",Accept:"application/json"})};return this.http.request("post",k,V).pipe((0,se.Z)(x=>this.processFindProducts(x))).pipe((0,Le.W)(x=>{if(!(x instanceof ne.xB))return(0,ke.$)(x);try{return this.processFindProducts(x)}catch(te){return(0,ke.$)(te)}}))}processFindProducts(f){const k=f.status,B=f instanceof ne.cS?f.body:f.error instanceof Blob?f.error:void 0;let V={};if(f.headers)for(let x of f.headers.keys())V[x]=f.headers.get(x);return 200===k?ye(B).pipe((0,se.Z)(x=>{let te=null,Be=""===x?null:JSON.parse(x,this.jsonParseReviver);return te=U.fromJS(Be),(0,be.of)(te)})):200!==k&&204!==k?ye(B).pipe((0,se.Z)(x=>tt("An unexpected server error occurred.",k,x,V))):(0,be.of)(null)}findProductPackages(f){let k=this.baseUrl+"/v1/Product/FindProductPackages";k=k.replace(/[?&]$/,"");let V={body:JSON.stringify(f),observe:"response",responseType:"blob",headers:new ne.Lr({"Content-Type":"application/json",Accept:"application/json"})};return this.http.request("post",k,V).pipe((0,se.Z)(x=>this.processFindProductPackages(x))).pipe((0,Le.W)(x=>{if(!(x instanceof ne.xB))return(0,ke.$)(x);try{return this.processFindProductPackages(x)}catch(te){return(0,ke.$)(te)}}))}processFindProductPackages(f){const k=f.status,B=f instanceof ne.cS?f.body:f.error instanceof Blob?f.error:void 0;let V={};if(f.headers)for(let x of f.headers.keys())V[x]=f.headers.get(x);return 200===k?ye(B).pipe((0,se.Z)(x=>{let te=null,Be=""===x?null:JSON.parse(x,this.jsonParseReviver);return te=De.fromJS(Be),(0,be.of)(te)})):200!==k&&204!==k?ye(B).pipe((0,se.Z)(x=>tt("An unexpected server error occurred.",k,x,V))):(0,be.of)(null)}updateProduct(f){let k=this.baseUrl+"/v1/Product/UpdateProduct";k=k.replace(/[?&]$/,"");let V={body:JSON.stringify(f),observe:"response",responseType:"blob",headers:new ne.Lr({"Content-Type":"application/json"})};return this.http.request("post",k,V).pipe((0,se.Z)(x=>this.processUpdateProduct(x))).pipe((0,Le.W)(x=>{if(!(x instanceof ne.xB))return(0,ke.$)(x);try{return this.processUpdateProduct(x)}catch(te){return(0,ke.$)(te)}}))}processUpdateProduct(f){const k=f.status,B=f instanceof ne.cS?f.body:f.error instanceof Blob?f.error:void 0;let V={};if(f.headers)for(let x of f.headers.keys())V[x]=f.headers.get(x);return 204===k?ye(B).pipe((0,se.Z)(x=>(0,be.of)(null))):200!==k&&204!==k?ye(B).pipe((0,se.Z)(x=>tt("An unexpected server error occurred.",k,x,V))):(0,be.of)(null)}updateProductPackage(f){let k=this.baseUrl+"/v1/Product/UpdateProductPackage";k=k.replace(/[?&]$/,"");let V={body:JSON.stringify(f),observe:"response",responseType:"blob",headers:new ne.Lr({"Content-Type":"application/json"})};return this.http.request("post",k,V).pipe((0,se.Z)(x=>this.processUpdateProductPackage(x))).pipe((0,Le.W)(x=>{if(!(x instanceof ne.xB))return(0,ke.$)(x);try{return this.processUpdateProductPackage(x)}catch(te){return(0,ke.$)(te)}}))}processUpdateProductPackage(f){const k=f.status,B=f instanceof ne.cS?f.body:f.error instanceof Blob?f.error:void 0;let V={};if(f.headers)for(let x of f.headers.keys())V[x]=f.headers.get(x);return 204===k?ye(B).pipe((0,se.Z)(x=>(0,be.of)(null))):200!==k&&204!==k?ye(B).pipe((0,se.Z)(x=>tt("An unexpected server error occurred.",k,x,V))):(0,be.of)(null)}addProduct(f){let k=this.baseUrl+"/v1/Product/AddProduct";k=k.replace(/[?&]$/,"");let V={body:JSON.stringify(f),observe:"response",responseType:"blob",headers:new ne.Lr({"Content-Type":"application/json",Accept:"application/json"})};return this.http.request("post",k,V).pipe((0,se.Z)(x=>this.processAddProduct(x))).pipe((0,Le.W)(x=>{if(!(x instanceof ne.xB))return(0,ke.$)(x);try{return this.processAddProduct(x)}catch(te){return(0,ke.$)(te)}}))}processAddProduct(f){const k=f.status,B=f instanceof ne.cS?f.body:f.error instanceof Blob?f.error:void 0;let V={};if(f.headers)for(let x of f.headers.keys())V[x]=f.headers.get(x);return 200===k?ye(B).pipe((0,se.Z)(x=>{let te=null,Be=""===x?null:JSON.parse(x,this.jsonParseReviver);return te=ce.fromJS(Be),(0,be.of)(te)})):200!==k&&204!==k?ye(B).pipe((0,se.Z)(x=>tt("An unexpected server error occurred.",k,x,V))):(0,be.of)(null)}addProductPackage(f){let k=this.baseUrl+"/v1/Product/AddProductPackage";k=k.replace(/[?&]$/,"");let V={body:JSON.stringify(f),observe:"response",responseType:"blob",headers:new ne.Lr({"Content-Type":"application/json",Accept:"application/json"})};return this.http.request("post",k,V).pipe((0,se.Z)(x=>this.processAddProductPackage(x))).pipe((0,Le.W)(x=>{if(!(x instanceof ne.xB))return(0,ke.$)(x);try{return this.processAddProductPackage(x)}catch(te){return(0,ke.$)(te)}}))}processAddProductPackage(f){const k=f.status,B=f instanceof ne.cS?f.body:f.error instanceof Blob?f.error:void 0;let V={};if(f.headers)for(let x of f.headers.keys())V[x]=f.headers.get(x);return 200===k?ye(B).pipe((0,se.Z)(x=>{let te=null,Be=""===x?null:JSON.parse(x,this.jsonParseReviver);return te=Pe.fromJS(Be),(0,be.of)(te)})):200!==k&&204!==k?ye(B).pipe((0,se.Z)(x=>tt("An unexpected server error occurred.",k,x,V))):(0,be.of)(null)}removeProduct(f){let k=this.baseUrl+"/v1/Product/RemoveProduct";k=k.replace(/[?&]$/,"");let V={body:JSON.stringify(f),observe:"response",responseType:"blob",headers:new ne.Lr({"Content-Type":"application/json"})};return this.http.request("delete",k,V).pipe((0,se.Z)(x=>this.processRemoveProduct(x))).pipe((0,Le.W)(x=>{if(!(x instanceof ne.xB))return(0,ke.$)(x);try{return this.processRemoveProduct(x)}catch(te){return(0,ke.$)(te)}}))}processRemoveProduct(f){const k=f.status,B=f instanceof ne.cS?f.body:f.error instanceof Blob?f.error:void 0;let V={};if(f.headers)for(let x of f.headers.keys())V[x]=f.headers.get(x);return 204===k?ye(B).pipe((0,se.Z)(x=>(0,be.of)(null))):200!==k&&204!==k?ye(B).pipe((0,se.Z)(x=>tt("An unexpected server error occurred.",k,x,V))):(0,be.of)(null)}removeProductPackage(f){let k=this.baseUrl+"/v1/Product/RemoveProductPackage";k=k.replace(/[?&]$/,"");let V={body:JSON.stringify(f),observe:"response",responseType:"blob",headers:new ne.Lr({"Content-Type":"application/json"})};return this.http.request("delete",k,V).pipe((0,se.Z)(x=>this.processRemoveProductPackage(x))).pipe((0,Le.W)(x=>{if(!(x instanceof ne.xB))return(0,ke.$)(x);try{return this.processRemoveProductPackage(x)}catch(te){return(0,ke.$)(te)}}))}processRemoveProductPackage(f){const k=f.status,B=f instanceof ne.cS?f.body:f.error instanceof Blob?f.error:void 0;let V={};if(f.headers)for(let x of f.headers.keys())V[x]=f.headers.get(x);return 204===k?ye(B).pipe((0,se.Z)(x=>(0,be.of)(null))):200!==k&&204!==k?ye(B).pipe((0,se.Z)(x=>tt("An unexpected server error occurred.",k,x,V))):(0,be.of)(null)}static{this.\u0275fac=function(k){return new(k||T)(a.KVO(ne.Qq),a.KVO(e.REDICY_API_BASE_URL,8))}}static{this.\u0275prov=a.jDH({token:T,factory:T.\u0275fac})}}return T})();e.ProductClient=l;let g=(()=>{class T{constructor(f,k){this.jsonParseReviver=void 0,this.http=f,this.baseUrl=k??"/"}updatePurchaseBatch(f){let k=this.baseUrl+"/v1/PurchaseBatch/UpdatePurchaseBatch";k=k.replace(/[?&]$/,"");let V={body:JSON.stringify(f),observe:"response",responseType:"blob",headers:new ne.Lr({"Content-Type":"application/json",Accept:"application/json"})};return this.http.request("post",k,V).pipe((0,se.Z)(x=>this.processUpdatePurchaseBatch(x))).pipe((0,Le.W)(x=>{if(!(x instanceof ne.xB))return(0,ke.$)(x);try{return this.processUpdatePurchaseBatch(x)}catch(te){return(0,ke.$)(te)}}))}processUpdatePurchaseBatch(f){const k=f.status,B=f instanceof ne.cS?f.body:f.error instanceof Blob?f.error:void 0;let V={};if(f.headers)for(let x of f.headers.keys())V[x]=f.headers.get(x);return 200===k?ye(B).pipe((0,se.Z)(x=>{let te=null,Be=""===x?null:JSON.parse(x,this.jsonParseReviver);return te=ge.fromJS(Be),(0,be.of)(te)})):200!==k&&204!==k?ye(B).pipe((0,se.Z)(x=>tt("An unexpected server error occurred.",k,x,V))):(0,be.of)(null)}getPurchaseBatch(f){let k=this.baseUrl+"/v1/PurchaseBatch/GetPurchaseBatch?";if(null==f)throw new Error("The parameter 'model' must be defined and cannot be null.");k+="model="+encodeURIComponent(""+f)+"&",k=k.replace(/[?&]$/,"");let B={observe:"response",responseType:"blob",headers:new ne.Lr({Accept:"application/json"})};return this.http.request("post",k,B).pipe((0,se.Z)(V=>this.processGetPurchaseBatch(V))).pipe((0,Le.W)(V=>{if(!(V instanceof ne.xB))return(0,ke.$)(V);try{return this.processGetPurchaseBatch(V)}catch(x){return(0,ke.$)(x)}}))}processGetPurchaseBatch(f){const k=f.status,B=f instanceof ne.cS?f.body:f.error instanceof Blob?f.error:void 0;let V={};if(f.headers)for(let x of f.headers.keys())V[x]=f.headers.get(x);return 200===k?ye(B).pipe((0,se.Z)(x=>{let te=null,Be=""===x?null:JSON.parse(x,this.jsonParseReviver);return te=ge.fromJS(Be),(0,be.of)(te)})):200!==k&&204!==k?ye(B).pipe((0,se.Z)(x=>tt("An unexpected server error occurred.",k,x,V))):(0,be.of)(null)}findPurchaseBatches(f){let k=this.baseUrl+"/v1/PurchaseBatch/FindPurchaseBatches";k=k.replace(/[?&]$/,"");let V={body:JSON.stringify(f),observe:"response",responseType:"blob",headers:new ne.Lr({"Content-Type":"application/json",Accept:"application/json"})};return this.http.request("post",k,V).pipe((0,se.Z)(x=>this.processFindPurchaseBatches(x))).pipe((0,Le.W)(x=>{if(!(x instanceof ne.xB))return(0,ke.$)(x);try{return this.processFindPurchaseBatches(x)}catch(te){return(0,ke.$)(te)}}))}processFindPurchaseBatches(f){const k=f.status,B=f instanceof ne.cS?f.body:f.error instanceof Blob?f.error:void 0;let V={};if(f.headers)for(let x of f.headers.keys())V[x]=f.headers.get(x);return 200===k?ye(B).pipe((0,se.Z)(x=>{let te=null,Be=""===x?null:JSON.parse(x,this.jsonParseReviver);return te=de.fromJS(Be),(0,be.of)(te)})):200!==k&&204!==k?ye(B).pipe((0,se.Z)(x=>tt("An unexpected server error occurred.",k,x,V))):(0,be.of)(null)}getSalesPlansSummaries(f){let k=this.baseUrl+"/v1/PurchaseBatch/GetSalesPlansSummaries";k=k.replace(/[?&]$/,"");let V={body:JSON.stringify(f),observe:"response",responseType:"blob",headers:new ne.Lr({"Content-Type":"application/json",Accept:"application/json"})};return this.http.request("post",k,V).pipe((0,se.Z)(x=>this.processGetSalesPlansSummaries(x))).pipe((0,Le.W)(x=>{if(!(x instanceof ne.xB))return(0,ke.$)(x);try{return this.processGetSalesPlansSummaries(x)}catch(te){return(0,ke.$)(te)}}))}processGetSalesPlansSummaries(f){const k=f.status,B=f instanceof ne.cS?f.body:f.error instanceof Blob?f.error:void 0;let V={};if(f.headers)for(let x of f.headers.keys())V[x]=f.headers.get(x);return 200===k?ye(B).pipe((0,se.Z)(x=>{let te=null,Be=""===x?null:JSON.parse(x,this.jsonParseReviver);if(Array.isArray(Be)){te=[];for(let Er of Be)te.push(fr.fromJS(Er))}else te=null;return(0,be.of)(te)})):200!==k&&204!==k?ye(B).pipe((0,se.Z)(x=>tt("An unexpected server error occurred.",k,x,V))):(0,be.of)(null)}calcSalesPlans(){let f=this.baseUrl+"/v1/PurchaseBatch/CalcSalesPlansAsync";f=f.replace(/[?&]$/,"");let k={observe:"response",responseType:"blob",headers:new ne.Lr({})};return this.http.request("get",f,k).pipe((0,se.Z)(B=>this.processCalcSalesPlans(B))).pipe((0,Le.W)(B=>{if(!(B instanceof ne.xB))return(0,ke.$)(B);try{return this.processCalcSalesPlans(B)}catch(V){return(0,ke.$)(V)}}))}processCalcSalesPlans(f){const k=f.status,B=f instanceof ne.cS?f.body:f.error instanceof Blob?f.error:void 0;let V={};if(f.headers)for(let x of f.headers.keys())V[x]=f.headers.get(x);return 204===k?ye(B).pipe((0,se.Z)(x=>(0,be.of)(null))):200!==k&&204!==k?ye(B).pipe((0,se.Z)(x=>tt("An unexpected server error occurred.",k,x,V))):(0,be.of)(null)}static{this.\u0275fac=function(k){return new(k||T)(a.KVO(ne.Qq),a.KVO(e.REDICY_API_BASE_URL,8))}}static{this.\u0275prov=a.jDH({token:T,factory:T.\u0275fac})}}return T})();e.PurchaseBatchClient=g;let u=(()=>{class T{constructor(f,k){this.jsonParseReviver=void 0,this.http=f,this.baseUrl=k??"/"}getSalesChannels(){let f=this.baseUrl+"/v1/SalesChannel/GetSalesChannels";f=f.replace(/[?&]$/,"");let k={observe:"response",responseType:"blob",headers:new ne.Lr({Accept:"application/json"})};return this.http.request("get",f,k).pipe((0,se.Z)(B=>this.processGetSalesChannels(B))).pipe((0,Le.W)(B=>{if(!(B instanceof ne.xB))return(0,ke.$)(B);try{return this.processGetSalesChannels(B)}catch(V){return(0,ke.$)(V)}}))}processGetSalesChannels(f){const k=f.status,B=f instanceof ne.cS?f.body:f.error instanceof Blob?f.error:void 0;let V={};if(f.headers)for(let x of f.headers.keys())V[x]=f.headers.get(x);return 200===k?ye(B).pipe((0,se.Z)(x=>{let te=null,Be=""===x?null:JSON.parse(x,this.jsonParseReviver);if(Array.isArray(Be)){te=[];for(let Er of Be)te.push(Lt.fromJS(Er))}else te=null;return(0,be.of)(te)})):200!==k&&204!==k?ye(B).pipe((0,se.Z)(x=>tt("An unexpected server error occurred.",k,x,V))):(0,be.of)(null)}static{this.\u0275fac=function(k){return new(k||T)(a.KVO(ne.Qq),a.KVO(e.REDICY_API_BASE_URL,8))}}static{this.\u0275prov=a.jDH({token:T,factory:T.\u0275fac})}}return T})();e.SalesChannelClient=u;let p,h=(()=>{class T{constructor(f,k){this.jsonParseReviver=void 0,this.http=f,this.baseUrl=k??"/"}getOzonWarehouses(){let f=this.baseUrl+"/v1/Warehouse/GetOzonWarehouses";f=f.replace(/[?&]$/,"");let k={observe:"response",responseType:"blob",headers:new ne.Lr({Accept:"application/json"})};return this.http.request("post",f,k).pipe((0,se.Z)(B=>this.processGetOzonWarehouses(B))).pipe((0,Le.W)(B=>{if(!(B instanceof ne.xB))return(0,ke.$)(B);try{return this.processGetOzonWarehouses(B)}catch(V){return(0,ke.$)(V)}}))}processGetOzonWarehouses(f){const k=f.status,B=f instanceof ne.cS?f.body:f.error instanceof Blob?f.error:void 0;let V={};if(f.headers)for(let x of f.headers.keys())V[x]=f.headers.get(x);return 200===k?ye(B).pipe((0,se.Z)(x=>{let te=null,Be=""===x?null:JSON.parse(x,this.jsonParseReviver);if(Array.isArray(Be)){te=[];for(let Er of Be)te.push(W.fromJS(Er))}else te=null;return(0,be.of)(te)})):200!==k&&204!==k?ye(B).pipe((0,se.Z)(x=>tt("An unexpected server error occurred.",k,x,V))):(0,be.of)(null)}updateOzonWarehouse(f){let k=this.baseUrl+"/v1/Warehouse/UpdateOzonWarehouse";k=k.replace(/[?&]$/,"");let V={body:JSON.stringify(f),observe:"response",responseType:"blob",headers:new ne.Lr({"Content-Type":"application/json"})};return this.http.request("post",k,V).pipe((0,se.Z)(x=>this.processUpdateOzonWarehouse(x))).pipe((0,Le.W)(x=>{if(!(x instanceof ne.xB))return(0,ke.$)(x);try{return this.processUpdateOzonWarehouse(x)}catch(te){return(0,ke.$)(te)}}))}processUpdateOzonWarehouse(f){const k=f.status,B=f instanceof ne.cS?f.body:f.error instanceof Blob?f.error:void 0;let V={};if(f.headers)for(let x of f.headers.keys())V[x]=f.headers.get(x);return 204===k?ye(B).pipe((0,se.Z)(x=>(0,be.of)(null))):200!==k&&204!==k?ye(B).pipe((0,se.Z)(x=>tt("An unexpected server error occurred.",k,x,V))):(0,be.of)(null)}static{this.\u0275fac=function(k){return new(k||T)(a.KVO(ne.Qq),a.KVO(e.REDICY_API_BASE_URL,8))}}static{this.\u0275prov=a.jDH({token:T,factory:T.\u0275fac})}}return T})();e.WarehouseClient=h;class A{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){c&&(this.iD=c.ID,this.name=c.Name,this.disabled=c.Disabled,this.analyzable=c.Analyzable)}static fromJS(c){c="object"==typeof c?c:{};let f=new A;return f.init(c),f}toJSON(c){return(c="object"==typeof c?c:{}).ID=this.iD,c.Name=this.name,c.Disabled=this.disabled,c.Analyzable=this.analyzable,c}}e.ProductType=A;class C{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){c&&(this.warehouseID=c.WarehouseID,this.warehouseName=c.WarehouseName,this.warehouseClusterName=c.WarehouseClusterName,this.productPackageID=c.ProductPackageID,this.productPackageName=c.ProductPackageName,this.salesCount=c.SalesCount,this.standaloneWarehouse=c.StandaloneWarehouse,this.present=c.Present,this.reserved=c.Reserved,this.salesRate=c.SalesRate,this.stockDays=c.StockDays,this.moving=c.Moving)}static fromJS(c){c="object"==typeof c?c:{};let f=new C;return f.init(c),f}toJSON(c){return(c="object"==typeof c?c:{}).WarehouseID=this.warehouseID,c.WarehouseName=this.warehouseName,c.WarehouseClusterName=this.warehouseClusterName,c.ProductPackageID=this.productPackageID,c.ProductPackageName=this.productPackageName,c.SalesCount=this.salesCount,c.StandaloneWarehouse=this.standaloneWarehouse,c.Present=this.present,c.Reserved=this.reserved,c.SalesRate=this.salesRate,c.StockDays=this.stockDays,c.Moving=this.moving,c}}e.OzonStockStarvationReportItem=C;class I{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){if(c&&(this.lastDayOrderCount=c.LastDayOrderCount,this.lastDayOrderSum=c.LastDayOrderSum,this.weekSales=c.WeekSales?m.fromJS(c.WeekSales):void 0,Array.isArray(c.LastSales))){this.lastSales=[];for(let f of c.LastSales)this.lastSales.push(_.fromJS(f))}}static fromJS(c){c="object"==typeof c?c:{};let f=new I;return f.init(c),f}toJSON(c){if((c="object"==typeof c?c:{}).LastDayOrderCount=this.lastDayOrderCount,c.LastDayOrderSum=this.lastDayOrderSum,c.WeekSales=this.weekSales?this.weekSales.toJSON():void 0,Array.isArray(this.lastSales)){c.LastSales=[];for(let f of this.lastSales)c.LastSales.push(f.toJSON())}return c}}e.LatestSales=I;class m{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){c&&(this.lastWeekIncome=c.LastWeekIncome,this.previousWeekIncome=c.PreviousWeekIncome)}static fromJS(c){c="object"==typeof c?c:{};let f=new m;return f.init(c),f}toJSON(c){return(c="object"==typeof c?c:{}).LastWeekIncome=this.lastWeekIncome,c.PreviousWeekIncome=this.previousWeekIncome,c}}e.WeekSales=m;class _{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){if(c){if(this.iD=c.ID,this.ozonOrderID=c.OzonOrderID,this.ozonOrderNumber=c.OzonOrderNumber,this.date=c.Date?new Date(c.Date.toString()):void 0,Array.isArray(c.Operations)){this.operations=[];for(let f of c.Operations)this.operations.push(d.fromJS(f))}if(Array.isArray(c.OrderItems)){this.orderItems=[];for(let f of c.OrderItems)this.orderItems.push(X.fromJS(f))}this.type=c.Type}}static fromJS(c){c="object"==typeof c?c:{};let f=new _;return f.init(c),f}toJSON(c){if((c="object"==typeof c?c:{}).ID=this.iD,c.OzonOrderID=this.ozonOrderID,c.OzonOrderNumber=this.ozonOrderNumber,c.Date=this.date?this.date.toISOString():void 0,Array.isArray(this.operations)){c.Operations=[];for(let f of this.operations)c.Operations.push(f.toJSON())}if(Array.isArray(this.orderItems)){c.OrderItems=[];for(let f of this.orderItems)c.OrderItems.push(f.toJSON())}return c.Type=this.type,c}}var T;e.OzonSalesOrder=_,(T=p=e.OzonSalesOrderType||(e.OzonSalesOrderType={}))[T.Unknown=0]="Unknown",T[T.Fbo=1]="Fbo",T[T.Fbs=2]="Fbs";class d{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){if(c&&(this.iD=c.ID,this.date=c.Date?new Date(c.Date.toString()):void 0,this.accrualsForSale=c.AccrualsForSale,this.amount=c.Amount,this.saleCommission=c.SaleCommission,this.operationType=c.OperationType,this.accrualType=c.AccrualType,this.deliveryCharge=c.DeliveryCharge,this.returnDeliveryCharge=c.ReturnDeliveryCharge,this.postingNumber=c.PostingNumber,Array.isArray(c.Services))){this.services=[];for(let f of c.Services)this.services.push(S.fromJS(f))}}static fromJS(c){c="object"==typeof c?c:{};let f=new d;return f.init(c),f}toJSON(c){if((c="object"==typeof c?c:{}).ID=this.iD,c.Date=this.date?this.date.toISOString():void 0,c.AccrualsForSale=this.accrualsForSale,c.Amount=this.amount,c.SaleCommission=this.saleCommission,c.OperationType=this.operationType,c.AccrualType=this.accrualType,c.DeliveryCharge=this.deliveryCharge,c.ReturnDeliveryCharge=this.returnDeliveryCharge,c.PostingNumber=this.postingNumber,Array.isArray(this.services)){c.Services=[];for(let f of this.services)c.Services.push(f.toJSON())}return c}}let w,v,G,E,H,re,Ce,D,N,He,Dt,Pi;e.OzonOperation=d,function(T){T[T.ClientReturnAgentOperation=0]="ClientReturnAgentOperation",T[T.MarketplaceMarketingActionCostOperation=1]="MarketplaceMarketingActionCostOperation",T[T.MarketplaceSaleReviewsOperation=2]="MarketplaceSaleReviewsOperation",T[T.MarketplaceSellerCompensationOperation=3]="MarketplaceSellerCompensationOperation",T[T.OperationAgentDeliveredToCustomer=4]="OperationAgentDeliveredToCustomer",T[T.OperationAgentDeliveredToCustomerCanceled=5]="OperationAgentDeliveredToCustomerCanceled",T[T.OperationAgentStornoDeliveredToCustomer=6]="OperationAgentStornoDeliveredToCustomer",T[T.OperationClaim=7]="OperationClaim",T[T.OperationCorrectionSeller=8]="OperationCorrectionSeller",T[T.OperationDefectiveWriteOff=9]="OperationDefectiveWriteOff",T[T.OperationItemReturn=10]="OperationItemReturn",T[T.OperationLackWriteOff=11]="OperationLackWriteOff",T[T.OperationMarketplaceCrossDockServiceWriteOff=12]="OperationMarketplaceCrossDockServiceWriteOff",T[T.OperationMarketplaceServiceStorage=13]="OperationMarketplaceServiceStorage",T[T.OperationSetOff=14]="OperationSetOff",T[T.MarketplaceSellerReexposureDeliveryReturnOperation=15]="MarketplaceSellerReexposureDeliveryReturnOperation",T[T.OperationReturnGoodsFBSofRMS=16]="OperationReturnGoodsFBSofRMS",T[T.ReturnAgentOperationRFBS=17]="ReturnAgentOperationRFBS",T[T.MarketplaceSellerShippingCompensationReturnOperation=18]="MarketplaceSellerShippingCompensationReturnOperation",T[T.OperationMarketplaceServicePremiumCashback=19]="OperationMarketplaceServicePremiumCashback",T[T.MarketplaceServicePremiumPromotion=20]="MarketplaceServicePremiumPromotion",T[T.MarketplaceRedistributionOfAcquiringOperation=21]="MarketplaceRedistributionOfAcquiringOperation",T[T.MarketplaceReturnStorageServiceAtThePickupPointFbsItem=22]="MarketplaceReturnStorageServiceAtThePickupPointFbsItem",T[T.MarketplaceReturnStorageServiceInTheWarehouseFbsItem=23]="MarketplaceReturnStorageServiceInTheWarehouseFbsItem",T[T.MarketplaceServiceItemDeliveryKGT=24]="MarketplaceServiceItemDeliveryKGT",T[T.MarketplaceServiceItemDirectFlowLogistic=25]="MarketplaceServiceItemDirectFlowLogistic",T[T.MarketplaceServiceItemReturnFlowLogistic=26]="MarketplaceServiceItemReturnFlowLogistic",T[T.MarketplaceServicePremiumCashbackIndividualPoints=27]="MarketplaceServicePremiumCashbackIndividualPoints",T[T.OperationMarketplaceWithHoldingForUndeliverableGoods=28]="OperationMarketplaceWithHoldingForUndeliverableGoods",T[T.OperationMarketplaceSupplyAdditional=29]="OperationMarketplaceSupplyAdditional",T[T.OperationMarketplaceSupplyExpirationDateProcessing=30]="OperationMarketplaceSupplyExpirationDateProcessing",T[T.OperationMarketplaceServiceSupplyInboundCargoSurplus=31]="OperationMarketplaceServiceSupplyInboundCargoSurplus",T[T.MarketplaceSellerCompensationItemOperation=32]="MarketplaceSellerCompensationItemOperation",T[T.MarketplaceSellerCorrectionOperation=33]="MarketplaceSellerCorrectionOperation",T[T.OperationMarketplaceServiceStockDisposal=34]="OperationMarketplaceServiceStockDisposal",T[T.AccrualConsigWriteOff=35]="AccrualConsigWriteOff",T[T.OperationElectronicServiceStencil=36]="OperationElectronicServiceStencil",T[T.OperationMarketplaceServiceSupplyInboundCargoShortage=37]="OperationMarketplaceServiceSupplyInboundCargoShortage"}(w=e.OperationType||(e.OperationType={})),function(T){T[T.All=0]="All",T[T.Orders=1]="Orders",T[T.Returns=2]="Returns",T[T.Services=3]="Services",T[T.Compensation=4]="Compensation",T[T.TransferDelivery=5]="TransferDelivery",T[T.Other=6]="Other"}(v=e.TransactionType||(e.TransactionType={}));class S{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){c&&(this.type=c.Type,this.price=c.Price)}static fromJS(c){c="object"==typeof c?c:{};let f=new S;return f.init(c),f}toJSON(c){return(c="object"==typeof c?c:{}).Type=this.type,c.Price=this.price,c}}e.OzonOperationService=S,function(T){T[T.MarketplaceNotDeliveredCostItem=0]="MarketplaceNotDeliveredCostItem",T[T.MarketplaceReturnAfterDeliveryCostItem=1]="MarketplaceReturnAfterDeliveryCostItem",T[T.MarketplaceDeliveryCostItem=2]="MarketplaceDeliveryCostItem",T[T.MarketplaceSaleReviewsItem=3]="MarketplaceSaleReviewsItem",T[T.ItemAdvertisementForSupplierLogistic=4]="ItemAdvertisementForSupplierLogistic",T[T.MarketplaceServiceStorageItem=5]="MarketplaceServiceStorageItem",T[T.MarketplaceMarketingActionCostItem=6]="MarketplaceMarketingActionCostItem",T[T.MarketplaceServiceItemInstallment=7]="MarketplaceServiceItemInstallment",T[T.MarketplaceServiceItemMarkingItems=8]="MarketplaceServiceItemMarkingItems",T[T.MarketplaceServiceItemFlexiblePaymentSchedule=9]="MarketplaceServiceItemFlexiblePaymentSchedule",T[T.MarketplaceServiceItemReturnFromStock=10]="MarketplaceServiceItemReturnFromStock",T[T.ItemAdvertisementForSupplierLogisticSeller=11]="ItemAdvertisementForSupplierLogisticSeller",T[T.MarketplaceServiceItemDelivToCustomer=12]="MarketplaceServiceItemDelivToCustomer",T[T.MarketplaceServiceItemDirectFlowTrans=13]="MarketplaceServiceItemDirectFlowTrans",T[T.MarketplaceServiceItemDropoffFF=14]="MarketplaceServiceItemDropoffFF",T[T.MarketplaceServiceItemDropoffPVZ=15]="MarketplaceServiceItemDropoffPVZ",T[T.MarketplaceServiceItemDropoffSC=16]="MarketplaceServiceItemDropoffSC",T[T.MarketplaceServiceItemFulfillment=17]="MarketplaceServiceItemFulfillment",T[T.MarketplaceServiceItemPickup=18]="MarketplaceServiceItemPickup",T[T.MarketplaceServiceItemReturnAfterDelivToCustomer=19]="MarketplaceServiceItemReturnAfterDelivToCustomer",T[T.MarketplaceServiceItemReturnFlowTrans=20]="MarketplaceServiceItemReturnFlowTrans",T[T.MarketplaceServiceItemReturnNotDelivToCustomer=21]="MarketplaceServiceItemReturnNotDelivToCustomer",T[T.MarketplaceServiceItemReturnPartGoodsCustomer=22]="MarketplaceServiceItemReturnPartGoodsCustomer",T[T.MarketplaceRedistributionOfAcquiringOperation=23]="MarketplaceRedistributionOfAcquiringOperation",T[T.MarketplaceReturnStorageServiceAtThePickupPointFbsItem=24]="MarketplaceReturnStorageServiceAtThePickupPointFbsItem",T[T.MarketplaceReturnStorageServiceInTheWarehouseFbsItem=25]="MarketplaceReturnStorageServiceInTheWarehouseFbsItem",T[T.MarketplaceServiceItemDeliveryKGT=26]="MarketplaceServiceItemDeliveryKGT",T[T.MarketplaceServiceItemDirectFlowLogistic=27]="MarketplaceServiceItemDirectFlowLogistic",T[T.MarketplaceServiceItemReturnFlowLogistic=28]="MarketplaceServiceItemReturnFlowLogistic",T[T.MarketplaceServicePremiumCashbackIndividualPoints=29]="MarketplaceServicePremiumCashbackIndividualPoints",T[T.MarketplaceServicePremiumPromotion=30]="MarketplaceServicePremiumPromotion",T[T.OperationMarketplaceWithHoldingForUndeliverableGoods=31]="OperationMarketplaceWithHoldingForUndeliverableGoods"}(G=e.OperationServiceType||(e.OperationServiceType={}));class X{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){c&&(this.iD=c.ID,this.postingNumber=c.PostingNumber,this.currencyCode=c.CurrencyCode,this.price=c.Price,this.quantity=c.Quantity,this.product=c.Product?O.fromJS(c.Product):void 0,this.status=c.Status,this.city=c.City,this.region=c.Region,this.clusterFrom=c.ClusterFrom,this.clusterTo=c.ClusterTo,this.deliveryType=c.DeliveryType,this.ozonWarehouse=c.OzonWarehouse?W.fromJS(c.OzonWarehouse):void 0)}static fromJS(c){c="object"==typeof c?c:{};let f=new X;return f.init(c),f}toJSON(c){return(c="object"==typeof c?c:{}).ID=this.iD,c.PostingNumber=this.postingNumber,c.CurrencyCode=this.currencyCode,c.Price=this.price,c.Quantity=this.quantity,c.Product=this.product?this.product.toJSON():void 0,c.Status=this.status,c.City=this.city,c.Region=this.region,c.ClusterFrom=this.clusterFrom,c.ClusterTo=this.clusterTo,c.DeliveryType=this.deliveryType,c.OzonWarehouse=this.ozonWarehouse?this.ozonWarehouse.toJSON():void 0,c}}e.OzonSalesOrderItem=X,function(T){T[T.RUB=0]="RUB",T[T.BYN=1]="BYN",T[T.KZT=2]="KZT",T[T.EUR=3]="EUR",T[T.USD=4]="USD",T[T.CNY=5]="CNY"}(E=e.Currency||(e.Currency={}));class O{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){if(c){if(this.productPackageID=c.ProductPackageID,this.name=c.Name,this.primaryImage=c.PrimaryImage,this.categoryID=c.CategoryID,this.fboSku=c.FboSku,this.fbsSku=c.FbsSku,this.sku=c.Sku,Array.isArray(c.Barcodes)){this.barcodes=[];for(let f of c.Barcodes)this.barcodes.push(f)}if(this.marketingPrice=c.MarketingPrice,this.minPrice=c.MinPrice,this.oldPrice=c.OldPrice,this.premiumPrice=c.PremiumPrice,this.price=c.Price,this.recommendedPrice=c.RecommendedPrice,this.externalCompetitorMinimalPrice=c.ExternalCompetitorMinimalPrice,this.externalCompetitorMinimalPriceCurrency=c.ExternalCompetitorMinimalPriceCurrency,this.externalCompetitorPriceIndexValue=c.ExternalCompetitorPriceIndexValue,this.ozonCompetitorMinimalPrice=c.OzonCompetitorMinimalPrice,this.ozonCompetitorMinimalPriceCurrency=c.OzonCompetitorMinimalPriceCurrency,this.ozonCompetitorPriceIndexValue=c.OzonCompetitorPriceIndexValue,this.externalMinimalPrice=c.ExternalMinimalPrice,this.externalMinimalPriceCurrency=c.ExternalMinimalPriceCurrency,this.externalPriceIndexValue=c.ExternalPriceIndexValue,Array.isArray(c.Stocks)){this.stocks=[];for(let f of c.Stocks)this.stocks.push(L.fromJS(f))}}}static fromJS(c){c="object"==typeof c?c:{};let f=new O;return f.init(c),f}toJSON(c){if((c="object"==typeof c?c:{}).ProductPackageID=this.productPackageID,c.Name=this.name,c.PrimaryImage=this.primaryImage,c.CategoryID=this.categoryID,c.FboSku=this.fboSku,c.FbsSku=this.fbsSku,c.Sku=this.sku,Array.isArray(this.barcodes)){c.Barcodes=[];for(let f of this.barcodes)c.Barcodes.push(f)}if(c.MarketingPrice=this.marketingPrice,c.MinPrice=this.minPrice,c.OldPrice=this.oldPrice,c.PremiumPrice=this.premiumPrice,c.Price=this.price,c.RecommendedPrice=this.recommendedPrice,c.ExternalCompetitorMinimalPrice=this.externalCompetitorMinimalPrice,c.ExternalCompetitorMinimalPriceCurrency=this.externalCompetitorMinimalPriceCurrency,c.ExternalCompetitorPriceIndexValue=this.externalCompetitorPriceIndexValue,c.OzonCompetitorMinimalPrice=this.ozonCompetitorMinimalPrice,c.OzonCompetitorMinimalPriceCurrency=this.ozonCompetitorMinimalPriceCurrency,c.OzonCompetitorPriceIndexValue=this.ozonCompetitorPriceIndexValue,c.ExternalMinimalPrice=this.externalMinimalPrice,c.ExternalMinimalPriceCurrency=this.externalMinimalPriceCurrency,c.ExternalPriceIndexValue=this.externalPriceIndexValue,Array.isArray(this.stocks)){c.Stocks=[];for(let f of this.stocks)c.Stocks.push(f.toJSON())}return c}}e.OzonProduct=O;class L{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){c&&(this.present=c.Present,this.reserved=c.Reserved,this.productID=c.ProductID,this.warehouseID=c.WarehouseID,this.warehouse=c.Warehouse?W.fromJS(c.Warehouse):void 0)}static fromJS(c){c="object"==typeof c?c:{};let f=new L;return f.init(c),f}toJSON(c){return(c="object"==typeof c?c:{}).Present=this.present,c.Reserved=this.reserved,c.ProductID=this.productID,c.WarehouseID=this.warehouseID,c.Warehouse=this.warehouse?this.warehouse.toJSON():void 0,c}}e.OzonProductStock=L;class W{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){if(c){if(this.iD=c.ID,this.ozonID=c.OzonID,this.name=c.Name,this.address=c.Address,this.warehouseCluster=c.WarehouseCluster,this.standalone=c.Standalone,Array.isArray(c.Aliases)){this.aliases=[];for(let f of c.Aliases)this.aliases.push(f)}this.status=c.Status}}static fromJS(c){c="object"==typeof c?c:{};let f=new W;return f.init(c),f}toJSON(c){if((c="object"==typeof c?c:{}).ID=this.iD,c.OzonID=this.ozonID,c.Name=this.name,c.Address=this.address,c.WarehouseCluster=this.warehouseCluster,c.Standalone=this.standalone,Array.isArray(this.aliases)){c.Aliases=[];for(let f of this.aliases)c.Aliases.push(f)}return c.Status=this.status,c}}e.OzonWarehouse=W,function(T){T[T.AwaitingPackaging=0]="AwaitingPackaging",T[T.AwaitingDeliver=1]="AwaitingDeliver",T[T.Delivering=2]="Delivering",T[T.Delivered=3]="Delivered",T[T.Cancelled=4]="Cancelled",T[T.AwaitingRegistration=5]="AwaitingRegistration",T[T.AcceptanceInProgress=6]="AcceptanceInProgress",T[T.AwaitingApprove=7]="AwaitingApprove",T[T.Arbitration=8]="Arbitration",T[T.ClientArbitration=9]="ClientArbitration",T[T.DriverPickup=10]="DriverPickup",T[T.NotAccepted=11]="NotAccepted",T[T.SentBySeller=12]="SentBySeller",T[T._13=13]="_13"}(H=e.PostingStatus||(e.PostingStatus={}));class Y{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){if(c&&(this.dateFrom=c.DateFrom?new Date(c.DateFrom.toString()):void 0,this.dateTo=c.DateTo?new Date(c.DateTo.toString()):void 0,Array.isArray(c.PostingNumbers))){this.postingNumbers=[];for(let f of c.PostingNumbers)this.postingNumbers.push(f)}}static fromJS(c){c="object"==typeof c?c:{};let f=new Y;return f.init(c),f}toJSON(c){if((c="object"==typeof c?c:{}).DateFrom=this.dateFrom?this.dateFrom.toISOString():void 0,c.DateTo=this.dateTo?this.dateTo.toISOString():void 0,Array.isArray(this.postingNumbers)){c.PostingNumbers=[];for(let f of this.postingNumbers)c.PostingNumbers.push(f)}return c}}e.FindPostingsModel=Y;class ee{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){if(c&&(this.totalCount=c.TotalCount,Array.isArray(c.Items))){this.items=[];for(let f of c.Items)this.items.push(Te.fromJS(f))}}static fromJS(c){c="object"==typeof c?c:{};let f=new ee;return f.init(c),f}toJSON(c){if((c="object"==typeof c?c:{}).TotalCount=this.totalCount,Array.isArray(this.items)){c.Items=[];for(let f of this.items)c.Items.push(f.toJSON())}return c}}e.PagedResponseOfOzonSupplyOrders=ee;class Te{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){if(c){if(this.iD=c.ID,Array.isArray(c.OrderItems)){this.orderItems=[];for(let f of c.OrderItems)this.orderItems.push(le.fromJS(f))}this.ozonOrderNumber=c.OzonOrderNumber,this.totalQuantity=c.TotalQuantity,this.totalItemCount=c.TotalItemCount,this.ozonWarehouseOzonID=c.OzonWarehouseOzonID,this.ozonCrossDockWarehouseID=c.OzonCrossDockWarehouseID,this.date=c.Date?new Date(c.Date.toString()):void 0,this.ozonWarehouse=c.OzonWarehouse?W.fromJS(c.OzonWarehouse):void 0,this.ozonCrossDockWarehouse=c.OzonCrossDockWarehouse?W.fromJS(c.OzonCrossDockWarehouse):void 0,this.state=c.State}}static fromJS(c){c="object"==typeof c?c:{};let f=new Te;return f.init(c),f}toJSON(c){if((c="object"==typeof c?c:{}).ID=this.iD,Array.isArray(this.orderItems)){c.OrderItems=[];for(let f of this.orderItems)c.OrderItems.push(f.toJSON())}return c.OzonOrderNumber=this.ozonOrderNumber,c.TotalQuantity=this.totalQuantity,c.TotalItemCount=this.totalItemCount,c.OzonWarehouseOzonID=this.ozonWarehouseOzonID,c.OzonCrossDockWarehouseID=this.ozonCrossDockWarehouseID,c.Date=this.date?this.date.toISOString():void 0,c.OzonWarehouse=this.ozonWarehouse?this.ozonWarehouse.toJSON():void 0,c.OzonCrossDockWarehouse=this.ozonCrossDockWarehouse?this.ozonCrossDockWarehouse.toJSON():void 0,c.State=this.state,c}}e.OzonSupplyOrder=Te;class le{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){c&&(this.productPackageID=c.ProductPackageID,this.ozonSupplyOrderID=c.OzonSupplyOrderID,this.quantity=c.Quantity,this.productPackage=c.ProductPackage?Pe.fromJS(c.ProductPackage):void 0,this.supplyOrder=c.SupplyOrder?Te.fromJS(c.SupplyOrder):void 0)}static fromJS(c){c="object"==typeof c?c:{};let f=new le;return f.init(c),f}toJSON(c){return(c="object"==typeof c?c:{}).ProductPackageID=this.productPackageID,c.OzonSupplyOrderID=this.ozonSupplyOrderID,c.Quantity=this.quantity,c.ProductPackage=this.productPackage?this.productPackage.toJSON():void 0,c.SupplyOrder=this.supplyOrder?this.supplyOrder.toJSON():void 0,c}}e.OzonSupplyOrderItem=le;class Pe{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){c&&(this.iD=c.ID,this.name=c.Name,this.minimumWarehouseStock=c.MinimumWarehouseStock,this.productCount=c.ProductCount,this.productID=c.ProductID,this.supplyPreparationTimeInDays=c.SupplyPreparationTimeInDays,this.product=c.Product?ce.fromJS(c.Product):void 0)}static fromJS(c){c="object"==typeof c?c:{};let f=new Pe;return f.init(c),f}toJSON(c){return(c="object"==typeof c?c:{}).ID=this.iD,c.Name=this.name,c.MinimumWarehouseStock=this.minimumWarehouseStock,c.ProductCount=this.productCount,c.ProductID=this.productID,c.SupplyPreparationTimeInDays=this.supplyPreparationTimeInDays,c.Product=this.product?this.product.toJSON():void 0,c}}e.ProductPackage=Pe;class ce{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){if(c&&(this.iD=c.ID,this.categoryID=c.CategoryID,this.stockAmount=c.StockAmount,this.name=c.Name,this.category=c.Category?Re.fromJS(c.Category):void 0,Array.isArray(c.Packages))){this.packages=[];for(let f of c.Packages)this.packages.push(Pe.fromJS(f))}}static fromJS(c){c="object"==typeof c?c:{};let f=new ce;return f.init(c),f}toJSON(c){if((c="object"==typeof c?c:{}).ID=this.iD,c.CategoryID=this.categoryID,c.StockAmount=this.stockAmount,c.Name=this.name,c.Category=this.category?this.category.toJSON():void 0,Array.isArray(this.packages)){c.Packages=[];for(let f of this.packages)c.Packages.push(f.toJSON())}return c}}e.Product=ce;class Re{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){if(c&&(this.iD=c.ID,this.name=c.Name,Array.isArray(c.Product))){this.product=[];for(let f of c.Product)this.product.push(ce.fromJS(f))}}static fromJS(c){c="object"==typeof c?c:{};let f=new Re;return f.init(c),f}toJSON(c){if((c="object"==typeof c?c:{}).ID=this.iD,c.Name=this.name,Array.isArray(this.product)){c.Product=[];for(let f of this.product)c.Product.push(f.toJSON())}return c}}e.ProductCategory=Re;class Xe{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){c&&(this.offset=c.Offset,this.count=c.Count)}static fromJS(c){c="object"==typeof c?c:{};let f=new Xe;return f.init(c),f}toJSON(c){return(c="object"==typeof c?c:{}).Offset=this.offset,c.Count=this.count,c}}e.FindOzonSupplyOrdersModel=Xe;class ue{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){if(c&&(this.totalCount=c.TotalCount,Array.isArray(c.Items))){this.items=[];for(let f of c.Items)this.items.push(O.fromJS(f))}}static fromJS(c){c="object"==typeof c?c:{};let f=new ue;return f.init(c),f}toJSON(c){if((c="object"==typeof c?c:{}).TotalCount=this.totalCount,Array.isArray(this.items)){c.Items=[];for(let f of this.items)c.Items.push(f.toJSON())}return c}}e.PagedResponseOfOzonProducts=ue;class Ke{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){c&&(this.offset=c.Offset,this.count=c.Count,this.productName=c.ProductName,this.productPackageID=c.ProductPackageID,this.includeStocks=c.IncludeStocks,this.orderField=c.OrderField,this.orderAscending=c.OrderAscending)}static fromJS(c){c="object"==typeof c?c:{};let f=new Ke;return f.init(c),f}toJSON(c){return(c="object"==typeof c?c:{}).Offset=this.offset,c.Count=this.count,c.ProductName=this.productName,c.ProductPackageID=this.productPackageID,c.IncludeStocks=this.includeStocks,c.OrderField=this.orderField,c.OrderAscending=this.orderAscending,c}}e.FindOzonProductsModel=Ke,function(T){T[T.Unknown=0]="Unknown",T[T.ProductPackageID=1]="ProductPackageID",T[T.ProductName=2]="ProductName"}(re=e.FindOzonProductsModelSortField||(e.FindOzonProductsModelSortField={}));class he{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){if(c){for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f]);if(this.totalCount=c.TotalCount,Array.isArray(c.Items)){this.items=[];for(let k of c.Items)this.items.push(d.fromJS(k))}}}static fromJS(c){c="object"==typeof c?c:{};let f=new he;return f.init(c),f}toJSON(c){for(var f in c="object"==typeof c?c:{},this)this.hasOwnProperty(f)&&(c[f]=this[f]);if(c.TotalCount=this.totalCount,Array.isArray(this.items)){c.Items=[];for(let k of this.items)c.Items.push(k.toJSON())}return c}}e.PagedResponseOfOzonOperations=he,function(T){T[T.New=0]="New",T[T.Ready=1]="Ready",T[T.Missing=2]="Missing"}(Ce=e.OzonWarehouseStatus||(e.OzonWarehouseStatus={}));class Ue{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){if(c){for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f]);this.clearingWarehouseId=c.clearingWarehouseId,this.name=c.name,this.address=c.address}}static fromJS(c){c="object"==typeof c?c:{};let f=new Ue;return f.init(c),f}toJSON(c){for(var f in c="object"==typeof c?c:{},this)this.hasOwnProperty(f)&&(c[f]=this[f]);return c.clearingWarehouseId=this.clearingWarehouseId,c.name=this.name,c.address=this.address,c}}e.SupplierApiOzonWarehouseInfo=Ue;class ve{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){c&&(this.offset=c.Offset,this.count=c.Count,this.dateFrom=c.DateFrom?new Date(c.DateFrom.toString()):void 0,this.dateTo=c.DateTo?new Date(c.DateTo.toString()):void 0)}static fromJS(c){c="object"==typeof c?c:{};let f=new ve;return f.init(c),f}toJSON(c){return(c="object"==typeof c?c:{}).Offset=this.offset,c.Count=this.count,c.DateFrom=this.dateFrom?ur(this.dateFrom):void 0,c.DateTo=this.dateTo?ur(this.dateTo):void 0,c}}e.FindOzonOperationsModel=ve;class Ne{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){c&&(this.iD=c.ID,this.name=c.Name,this.unitOfMeasure=c.UnitOfMeasure,this.decimalPlaces=c.DecimalPlaces,this.price=c.Price)}static fromJS(c){c="object"==typeof c?c:{};let f=new Ne;return f.init(c),f}toJSON(c){return(c="object"==typeof c?c:{}).ID=this.iD,c.Name=this.name,c.UnitOfMeasure=this.unitOfMeasure,c.DecimalPlaces=this.decimalPlaces,c.Price=this.price,c}}e.PackageTypeWithPrice=Ne,function(T){T[T.Unknown=0]="Unknown",T[T.SquareMeter=1]="SquareMeter",T[T.Piece=2]="Piece",T[T.Meter=3]="Meter"}(D=e.UnitOfMeasure||(e.UnitOfMeasure={}));class z{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){if(c&&(this.iD=c.ID,this.name=c.Name,this.unitOfMeasure=c.UnitOfMeasure,this.decimalPlaces=c.DecimalPlaces,Array.isArray(c.Prices))){this.prices=[];for(let f of c.Prices)this.prices.push(j.fromJS(f))}}static fromJS(c){c="object"==typeof c?c:{};let f=new z;return f.init(c),f}toJSON(c){if((c="object"==typeof c?c:{}).ID=this.iD,c.Name=this.name,c.UnitOfMeasure=this.unitOfMeasure,c.DecimalPlaces=this.decimalPlaces,Array.isArray(this.prices)){c.Prices=[];for(let f of this.prices)c.Prices.push(f.toJSON())}return c}}e.PackageType=z;class j{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){c&&(this.packageTypeID=c.PackageTypeID,this.price=c.Price,this.date=c.Date?new Date(c.Date.toString()):void 0)}static fromJS(c){c="object"==typeof c?c:{};let f=new j;return f.init(c),f}toJSON(c){return(c="object"==typeof c?c:{}).PackageTypeID=this.packageTypeID,c.Price=this.price,c.Date=this.date?this.date.toISOString():void 0,c}}e.PackageTypePrice=j;class U{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){if(c&&(this.totalCount=c.TotalCount,Array.isArray(c.Items))){this.items=[];for(let f of c.Items)this.items.push(ce.fromJS(f))}}static fromJS(c){c="object"==typeof c?c:{};let f=new U;return f.init(c),f}toJSON(c){if((c="object"==typeof c?c:{}).TotalCount=this.totalCount,Array.isArray(this.items)){c.Items=[];for(let f of this.items)c.Items.push(f.toJSON())}return c}}e.PagedResponseOfProduct=U;class ae{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){c&&(this.offset=c.Offset,this.count=c.Count,this.iD=c.ID,this.name=c.Name,this.orderField=c.OrderField,this.orderAscending=c.OrderAscending)}static fromJS(c){c="object"==typeof c?c:{};let f=new ae;return f.init(c),f}toJSON(c){return(c="object"==typeof c?c:{}).Offset=this.offset,c.Count=this.count,c.ID=this.iD,c.Name=this.name,c.OrderField=this.orderField,c.OrderAscending=this.orderAscending,c}}e.FindProductsModel=ae,function(T){T[T.Unknown=0]="Unknown",T[T.ID=1]="ID",T[T.Name=2]="Name"}(N=e.FindProductsModelSortField||(e.FindProductsModelSortField={}));class De{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){if(c&&(this.totalCount=c.TotalCount,Array.isArray(c.Items))){this.items=[];for(let f of c.Items)this.items.push(Pe.fromJS(f))}}static fromJS(c){c="object"==typeof c?c:{};let f=new De;return f.init(c),f}toJSON(c){if((c="object"==typeof c?c:{}).TotalCount=this.totalCount,Array.isArray(this.items)){c.Items=[];for(let f of this.items)c.Items.push(f.toJSON())}return c}}e.PagedResponseOfProductPackage=De;class we{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){c&&(this.offset=c.Offset,this.count=c.Count,this.productPackageName=c.ProductPackageName,this.productID=c.ProductID)}static fromJS(c){c="object"==typeof c?c:{};let f=new we;return f.init(c),f}toJSON(c){return(c="object"==typeof c?c:{}).Offset=this.offset,c.Count=this.count,c.ProductPackageName=this.productPackageName,c.ProductID=this.productID,c}}e.FindProductPackagesModel=we;class ge{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){if(c&&(this.iD=c.ID,this.name=c.Name,this.date=c.Date?new Date(c.Date.toString()):void 0,this.status=c.Status,Array.isArray(c.Items))){this.items=[];for(let f of c.Items)this.items.push(et.fromJS(f))}}static fromJS(c){c="object"==typeof c?c:{};let f=new ge;return f.init(c),f}toJSON(c){if((c="object"==typeof c?c:{}).ID=this.iD,c.Name=this.name,c.Date=this.date?ur(this.date):void 0,c.Status=this.status,Array.isArray(this.items)){c.Items=[];for(let f of this.items)c.Items.push(f.toJSON())}return c}}e.PurchaseBatch=ge,function(T){T[T.Unknown=0]="Unknown",T[T.Purchased=1]="Purchased",T[T.InSale=2]="InSale",T[T.Sold=3]="Sold"}(He=e.PurchaseBatchStatus||(e.PurchaseBatchStatus={}));class et{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){if(c&&(this.iD=c.ID,this.count=c.Count,this.price=c.Price,this.productID=c.ProductID,this.purchaseBatchID=c.PurchaseBatchID,this.product=c.Product?ce.fromJS(c.Product):void 0,this.purchaseBatch=c.PurchaseBatch?ge.fromJS(c.PurchaseBatch):void 0,Array.isArray(c.SalesItems))){this.salesItems=[];for(let f of c.SalesItems)this.salesItems.push(Ee.fromJS(f))}}static fromJS(c){c="object"==typeof c?c:{};let f=new et;return f.init(c),f}toJSON(c){if((c="object"==typeof c?c:{}).ID=this.iD,c.Count=this.count,c.Price=this.price,c.ProductID=this.productID,c.PurchaseBatchID=this.purchaseBatchID,c.Product=this.product?this.product.toJSON():void 0,c.PurchaseBatch=this.purchaseBatch?this.purchaseBatch.toJSON():void 0,Array.isArray(this.salesItems)){c.SalesItems=[];for(let f of this.salesItems)c.SalesItems.push(f.toJSON())}return c}}e.PurchaseBatchItem=et;class Ee{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){if(c){if(this.iD=c.ID,this.name=c.Name,this.volume=c.Volume,this.packagingPrice=c.PackagingPrice,this.purchaseBatchItemID=c.PurchaseBatchItemID,this.productPackageID=c.ProductPackageID,this.productPackage=c.ProductPackage?Pe.fromJS(c.ProductPackage):void 0,this.purchaseBatchItem=c.PurchaseBatchItem?et.fromJS(c.PurchaseBatchItem):void 0,Array.isArray(c.SalesItemPackages)){this.salesItemPackages=[];for(let f of c.SalesItemPackages)this.salesItemPackages.push(mt.fromJS(f))}if(Array.isArray(c.SalesPlans)){this.salesPlans=[];for(let f of c.SalesPlans)this.salesPlans.push(_t.fromJS(f))}}}static fromJS(c){c="object"==typeof c?c:{};let f=new Ee;return f.init(c),f}toJSON(c){if((c="object"==typeof c?c:{}).ID=this.iD,c.Name=this.name,c.Volume=this.volume,c.PackagingPrice=this.packagingPrice,c.PurchaseBatchItemID=this.purchaseBatchItemID,c.ProductPackageID=this.productPackageID,c.ProductPackage=this.productPackage?this.productPackage.toJSON():void 0,c.PurchaseBatchItem=this.purchaseBatchItem?this.purchaseBatchItem.toJSON():void 0,Array.isArray(this.salesItemPackages)){c.SalesItemPackages=[];for(let f of this.salesItemPackages)c.SalesItemPackages.push(f.toJSON())}if(Array.isArray(this.salesPlans)){c.SalesPlans=[];for(let f of this.salesPlans)c.SalesPlans.push(f.toJSON())}return c}}e.SalesItem=Ee;class mt{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){c&&(this.amount=c.Amount,this.pricePerUom=c.PricePerUom,this.packageTypeID=c.PackageTypeID,this.salesItemID=c.SalesItemID,this.salesItem=c.SalesItem?Ee.fromJS(c.SalesItem):void 0,this.packageType=c.PackageType?z.fromJS(c.PackageType):void 0)}static fromJS(c){c="object"==typeof c?c:{};let f=new mt;return f.init(c),f}toJSON(c){return(c="object"==typeof c?c:{}).Amount=this.amount,c.PricePerUom=this.pricePerUom,c.PackageTypeID=this.packageTypeID,c.SalesItemID=this.salesItemID,c.SalesItem=this.salesItem?this.salesItem.toJSON():void 0,c.PackageType=this.packageType?this.packageType.toJSON():void 0,c}}e.SalesItemPackage=mt;class _t{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){c&&(this.iD=c.ID,this.status=c.Status,this.price=c.Price,this.amount=c.Amount,this.salesPerMonth=c.SalesPerMonth,this.commissionMultiplier=c.CommissionMultiplier,this.commissionAddition=c.CommissionAddition,this.returnPercentage=c.ReturnPercentage,this.returnCost=c.ReturnCost,this.deliveryCost=c.DeliveryCost,this.deliveryDate=c.DeliveryDate?new Date(c.DeliveryDate.toString()):void 0,this.marketingBudget=c.MarketingBudget,this.salesItemID=c.SalesItemID,this.salesChannelID=c.SalesChannelID,this.salesItem=c.SalesItem?Ee.fromJS(c.SalesItem):void 0,this.salesChannel=c.SalesChannel?Lt.fromJS(c.SalesChannel):void 0)}static fromJS(c){c="object"==typeof c?c:{};let f=new _t;return f.init(c),f}toJSON(c){return(c="object"==typeof c?c:{}).ID=this.iD,c.Status=this.status,c.Price=this.price,c.Amount=this.amount,c.SalesPerMonth=this.salesPerMonth,c.CommissionMultiplier=this.commissionMultiplier,c.CommissionAddition=this.commissionAddition,c.ReturnPercentage=this.returnPercentage,c.ReturnCost=this.returnCost,c.DeliveryCost=this.deliveryCost,c.DeliveryDate=this.deliveryDate?ur(this.deliveryDate):void 0,c.MarketingBudget=this.marketingBudget,c.SalesItemID=this.salesItemID,c.SalesChannelID=this.salesChannelID,c.SalesItem=this.salesItem?this.salesItem.toJSON():void 0,c.SalesChannel=this.salesChannel?this.salesChannel.toJSON():void 0,c}}e.SalesPlan=_t,function(T){T[T.Draft=0]="Draft",T[T.InProcess=1]="InProcess",T[T.Finalized=2]="Finalized"}(Dt=e.SalesPlanStatus||(e.SalesPlanStatus={}));class Lt{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){c&&(this.iD=c.ID,this.name=c.Name)}static fromJS(c){c="object"==typeof c?c:{};let f=new Lt;return f.init(c),f}toJSON(c){return(c="object"==typeof c?c:{}).ID=this.iD,c.Name=this.name,c}}e.SalesChannel=Lt;class de{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){if(c&&(this.totalCount=c.TotalCount,Array.isArray(c.Items))){this.items=[];for(let f of c.Items)this.items.push(ge.fromJS(f))}}static fromJS(c){c="object"==typeof c?c:{};let f=new de;return f.init(c),f}toJSON(c){if((c="object"==typeof c?c:{}).TotalCount=this.totalCount,Array.isArray(this.items)){c.Items=[];for(let f of this.items)c.Items.push(f.toJSON())}return c}}e.PagedResponseOfPurchaseBatches=de;class xe{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){c&&(this.offset=c.Offset,this.count=c.Count,this.dateFrom=c.DateFrom?new Date(c.DateFrom.toString()):void 0,this.dateTo=c.DateTo?new Date(c.DateTo.toString()):void 0,this.article=c.Article,this.name=c.Name)}static fromJS(c){c="object"==typeof c?c:{};let f=new xe;return f.init(c),f}toJSON(c){return(c="object"==typeof c?c:{}).Offset=this.offset,c.Count=this.count,c.DateFrom=this.dateFrom?ur(this.dateFrom):void 0,c.DateTo=this.dateTo?ur(this.dateTo):void 0,c.Article=this.article,c.Name=this.name,c}}e.FindPurchaseBatchesModel=xe;class fr{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){c&&(this.iD=c.ID,this.salesCount=c.SalesCount,this.returnCount=c.ReturnCount,this.commissionPercent=c.CommissionPercent,this.commissionAddition=c.CommissionAddition,this.returnSum=c.ReturnSum,this.salesSum=c.SalesSum)}static fromJS(c){c="object"==typeof c?c:{};let f=new fr;return f.init(c),f}toJSON(c){return(c="object"==typeof c?c:{}).ID=this.iD,c.SalesCount=this.salesCount,c.ReturnCount=this.returnCount,c.CommissionPercent=this.commissionPercent,c.CommissionAddition=this.commissionAddition,c.ReturnSum=this.returnSum,c.SalesSum=this.salesSum,c}}e.SalesPlanSummary=fr;class Wt{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){if(c){if(this.iD=c.ID,this.name=c.Name,this.disabled=c.Disabled,this.analyzable=c.Analyzable,Array.isArray(c.Types)){this.types=[];for(let f of c.Types)this.types.push(A.fromJS(f))}if(Array.isArray(c.Children)){this.children=[];for(let f of c.Children)this.children.push(Wt.fromJS(f))}}}static fromJS(c){c="object"==typeof c?c:{};let f=new Wt;return f.init(c),f}toJSON(c){if((c="object"==typeof c?c:{}).ID=this.iD,c.Name=this.name,c.Disabled=this.disabled,c.Analyzable=this.analyzable,Array.isArray(this.types)){c.Types=[];for(let f of this.types)c.Types.push(f.toJSON())}if(Array.isArray(this.children)){c.Children=[];for(let f of this.children)c.Children.push(f.toJSON())}return c}}e.Category=Wt;class Rt{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){c&&(this.quantity=c.Quantity,this.month=c.Month?new Date(c.Month.toString()):void 0)}static fromJS(c){c="object"==typeof c?c:{};let f=new Rt;return f.init(c),f}toJSON(c){return(c="object"==typeof c?c:{}).Quantity=this.quantity,c.Month=this.month?ur(this.month):void 0,c}}e.ProductTypeHistoryItem=Rt;class Jt{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){if(c){for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f]);if(this.iD=c.ID,this.date=c.Date?new Date(c.Date.toString()):void 0,this.salesChannelID=c.SalesChannelID,Array.isArray(c.ShipmentPackages)){this.shipmentPackages=[];for(let k of c.ShipmentPackages)this.shipmentPackages.push(ze.fromJS(k))}if(Array.isArray(c.Supplies)){this.supplies=[];for(let k of c.Supplies)this.supplies.push(lr.fromJS(k))}}}static fromJS(c){c="object"==typeof c?c:{};let f=new Jt;return f.init(c),f}toJSON(c){for(var f in c="object"==typeof c?c:{},this)this.hasOwnProperty(f)&&(c[f]=this[f]);if(c.ID=this.iD,c.Date=this.date?this.date.toISOString():void 0,c.SalesChannelID=this.salesChannelID,Array.isArray(this.shipmentPackages)){c.ShipmentPackages=[];for(let k of this.shipmentPackages)c.ShipmentPackages.push(k.toJSON())}if(Array.isArray(this.supplies)){c.Supplies=[];for(let k of this.supplies)c.Supplies.push(k.toJSON())}return c}}e.Shipment=Jt;class lr{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){if(c){for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f]);if(this.price=c.Price,Array.isArray(c.SupplyItems)){this.supplyItems=[];for(let k of c.SupplyItems)this.supplyItems.push(Je.fromJS(k))}if(Array.isArray(c.SupplyPackages)){this.supplyPackages=[];for(let k of c.SupplyPackages)this.supplyPackages.push(ze.fromJS(k))}this.ozonWarehouse=c.OzonWarehouse?W.fromJS(c.OzonWarehouse):void 0}}static fromJS(c){c="object"==typeof c?c:{};let f=new lr;return f.init(c),f}toJSON(c){for(var f in c="object"==typeof c?c:{},this)this.hasOwnProperty(f)&&(c[f]=this[f]);if(c.Price=this.price,Array.isArray(this.supplyItems)){c.SupplyItems=[];for(let k of this.supplyItems)c.SupplyItems.push(k.toJSON())}if(Array.isArray(this.supplyPackages)){c.SupplyPackages=[];for(let k of this.supplyPackages)c.SupplyPackages.push(k.toJSON())}return c.OzonWarehouse=this.ozonWarehouse?this.ozonWarehouse.toJSON():void 0,c}}e.Supply=lr;class Je{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){if(c){for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f]);if(this.quantity=c.Quantity,this.productPackage=c.ProductPackage?Pe.fromJS(c.ProductPackage):void 0,Array.isArray(c.SupplyItemPackages)){this.supplyItemPackages=[];for(let k of c.SupplyItemPackages)this.supplyItemPackages.push(ze.fromJS(k))}}}static fromJS(c){c="object"==typeof c?c:{};let f=new Je;return f.init(c),f}toJSON(c){for(var f in c="object"==typeof c?c:{},this)this.hasOwnProperty(f)&&(c[f]=this[f]);if(c.Quantity=this.quantity,c.ProductPackage=this.productPackage?this.productPackage.toJSON():void 0,Array.isArray(this.supplyItemPackages)){c.SupplyItemPackages=[];for(let k of this.supplyItemPackages)c.SupplyItemPackages.push(k.toJSON())}return c}}e.SupplyItem=Je;class ze{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){if(c){for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f]);this.iD=c.ID,this.amount=c.Amount,this.pricePerUom=c.PricePerUom,this.packageTypeID=c.PackageTypeID}}static fromJS(c){c="object"==typeof c?c:{};let f=new ze;return f.init(c),f}toJSON(c){for(var f in c="object"==typeof c?c:{},this)this.hasOwnProperty(f)&&(c[f]=this[f]);return c.ID=this.iD,c.Amount=this.amount,c.PricePerUom=this.pricePerUom,c.PackageTypeID=this.packageTypeID,c}}e.ShipmentPackage=ze;class vt{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){if(c){for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f]);this.dateFrom=c.DateFrom?new Date(c.DateFrom.toString()):void 0,this.offset=c.Offset,this.count=c.Count}}static fromJS(c){c="object"==typeof c?c:{};let f=new vt;return f.init(c),f}toJSON(c){for(var f in c="object"==typeof c?c:{},this)this.hasOwnProperty(f)&&(c[f]=this[f]);return c.DateFrom=this.dateFrom?ur(this.dateFrom):void 0,c.Offset=this.offset,c.Count=this.count,c}}e.FindShipmentsModel=vt;class bt{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f])}init(c){if(c){for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f]);if(this.totalCount=c.TotalCount,Array.isArray(c.Items)){this.items=[];for(let k of c.Items)this.items.push(Jt.fromJS(k))}}}static fromJS(c){c="object"==typeof c?c:{};let f=new bt;return f.init(c),f}toJSON(c){for(var f in c="object"==typeof c?c:{},this)this.hasOwnProperty(f)&&(c[f]=this[f]);if(c.TotalCount=this.totalCount,Array.isArray(this.items)){c.Items=[];for(let k of this.items)c.Items.push(k.toJSON())}return c}}function ur(T){return T.getFullYear()+"-"+(T.getMonth()<9?"0"+(T.getMonth()+1):T.getMonth()+1)+"-"+(T.getDate()<10?"0"+T.getDate():T.getDate())}e.PagedResponseOfShipments=bt,function(T){T.DRAFT="DRAFT",T.SUPPLY_VARIANTS_ARRANGING="SUPPLY_VARIANTS_ARRANGING",T.HAS_NO_SUPPLY_VARIANTS_ARCHIVE="HAS_NO_SUPPLY_VARIANTS_ARCHIVE",T.HAS_NO_SUPPLY_VARIANTS_NEW="HAS_NO_SUPPLY_VARIANTS_NEW",T.SUPPLY_VARIANT_CONFIRMATION="SUPPLY_VARIANT_CONFIRMATION",T.TIMESLOT_BOOKING="TIMESLOT_BOOKING",T.DATA_FILLING="DATA_FILLING",T.READY_TO_SUPPLY="READY_TO_SUPPLY",T.ACCEPTED_AT_SUPPLY_WAREHOUSE="ACCEPTED_AT_SUPPLY_WAREHOUSE",T.IN_TRANSIT="IN_TRANSIT",T.ACCEPTANCE_AT_STORAGE_WAREHOUSE="ACCEPTANCE_AT_STORAGE_WAREHOUSE",T.REPORTS_CONFIRMATION_AWAITING="REPORTS_CONFIRMATION_AWAITING",T.REPORT_REJECTED="REPORT_REJECTED",T.COMPLETED="COMPLETED",T.REJECTED_AT_SUPPLY_WAREHOUSE="REJECTED_AT_SUPPLY_WAREHOUSE",T.CANCELLED="CANCELLED",T.OVERDUE="OVERDUE"}(Pi=e.SupplyOrderState||(e.SupplyOrderState={}));class An extends Error{constructor(c,f,k,B,V){super(),this.isApiException=!0,this.message=c,this.status=f,this.response=k,this.headers=B,this.result=V}static isApiException(c){return!0===c.isApiException}}function tt(T,c,f,k,B){return(0,ke.$)(null!=B?B:new An(T,c,f,k,null))}function ye(T){return new wA.c(c=>{if(T){let f=new FileReader;f.onload=k=>{c.next(k.target.result),c.complete()},f.readAsText(T)}else c.next(""),c.complete()})}e.ApiException=An}(Fs||(Fs={}));var yA=Fe(2102),TA=Fs.PackageTypePrice;const SA=()=>({"min-width":"75rem"}),bA=()=>[10,25,50],EA=()=>({width:"50vw"});function FA(e,r){1&e&&(a.j41(0,"tr")(1,"th"),a.EFF(2,"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435"),a.k0s(),a.j41(3,"th",6),a.EFF(4,"\u0415\u0434\u0438\u043d\u0438\u0446\u0430 \u0438\u0437\u043c\u0435\u0440\u0435\u043d\u0438\u044f "),a.nrm(5,"p-sortIcon",7),a.k0s(),a.j41(6,"th"),a.EFF(7,"\u041a\u0432\u0430\u043d\u0442"),a.k0s(),a.j41(8,"th"),a.EFF(9,"\u0426\u0435\u043d\u044b"),a.k0s(),a.nrm(10,"th"),a.k0s())}function DA(e,r){if(1&e&&(a.j41(0,"div"),a.EFF(1),a.nI1(2,"date"),a.k0s()),2&e){const t=r.$implicit,n=a.XpG().$implicit,i=a.XpG(2);a.R7$(),a.E5c(" ",a.i5U(2,3,t.date,"yyyy.MM.dd"),": ",t.price,"\u20bd/",i.getMeasureUnitText(n.unitOfMeasure)," ")}}function NA(e,r){if(1&e){const t=a.RV6();a.j41(0,"tr")(1,"td"),a.EFF(2),a.k0s(),a.j41(3,"td"),a.EFF(4),a.k0s(),a.j41(5,"td"),a.EFF(6),a.k0s(),a.j41(7,"td"),a.DNE(8,DA,3,6,"div",8),a.k0s(),a.j41(9,"td")(10,"p-button",9),a.bIt("click",function(){const i=a.eBV(t).$implicit,s=a.XpG(2);return a.Njj(s.showEditPackageTypeDialog(i))}),a.k0s(),a.j41(11,"p-button",10),a.bIt("click",function(){const i=a.eBV(t).$implicit,s=a.XpG(2);return a.Njj(s.removePackageType(i))}),a.k0s()()()}if(2&e){const t=r.$implicit,n=a.XpG(2);a.R7$(2),a.JRh(t.name),a.R7$(2),a.JRh(n.getMeasureUnitText(t.unitOfMeasure)),a.R7$(2),a.JRh(n.getQuantum(t)),a.R7$(2),a.Y8G("ngForOf",t.prices)}}function PA(e,r){if(1&e&&(a.j41(0,"p-table",3),a.DNE(1,FA,11,0,"ng-template",4)(2,NA,12,4,"ng-template",5),a.k0s()),2&e){const t=a.XpG();a.Y8G("value",t.data)("tableStyle",a.lJ4(6,SA))("paginator",!0)("rows",50)("rowsPerPageOptions",a.lJ4(7,bA))("totalRecords",t.totalRecords)}}function RA(e,r){1&e&&(a.j41(0,"tr")(1,"th"),a.EFF(2,"\u0414\u0430\u0442\u0430"),a.k0s(),a.j41(3,"th"),a.EFF(4,"\u0426\u0435\u043d\u0430"),a.k0s(),a.nrm(5,"th"),a.k0s())}function OA(e,r){if(1&e){const t=a.RV6();a.j41(0,"tr")(1,"td")(2,"p-calendar",23),a.mxI("ngModelChange",function(i){const s=a.eBV(t).$implicit;return a.DH7(s.date,i)||(s.date=i),a.Njj(i)}),a.k0s()(),a.j41(3,"td")(4,"p-inputNumber",24),a.mxI("ngModelChange",function(i){const s=a.eBV(t).$implicit;return a.DH7(s.price,i)||(s.price=i),a.Njj(i)}),a.k0s()(),a.j41(5,"td")(6,"p-button",10),a.bIt("click",function(){const i=a.eBV(t).$implicit,s=a.XpG(2);return a.Njj(s.removePrice(i))}),a.k0s()()()}if(2&e){const t=r.$implicit;a.R7$(2),a.R50("ngModel",t.date),a.Y8G("readonlyInput",!0)("selectOtherMonths",!0)("showClear",!0),a.R7$(2),a.R50("ngModel",t.price),a.Y8G("min",0)("minFractionDigits",2)("maxFractionDigits",2)("showButtons",!0)}}function BA(e,r){if(1&e){const t=a.RV6();a.j41(0,"button",25),a.bIt("click",function(){a.eBV(t);const i=a.XpG(2);return a.Njj(i.addPackageType())}),a.EFF(1,"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"),a.k0s()}}function MA(e,r){if(1&e){const t=a.RV6();a.j41(0,"button",25),a.bIt("click",function(){a.eBV(t);const i=a.XpG(2);return a.Njj(i.updatePackageType())}),a.EFF(1,"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c"),a.k0s()}}function LA(e,r){if(1&e){const t=a.RV6();a.j41(0,"p-dialog",11),a.mxI("visibleChange",function(i){a.eBV(t);const s=a.XpG();return a.DH7(s.showDialog,i)||(s.showDialog=i),a.Njj(i)}),a.j41(1,"div")(2,"div",12)(3,"label",13),a.EFF(4,"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435"),a.k0s(),a.j41(5,"input",14),a.mxI("ngModelChange",function(i){a.eBV(t);const s=a.XpG();return a.DH7(s.newItem.name,i)||(s.newItem.name=i),a.Njj(i)}),a.k0s()(),a.j41(6,"div",12)(7,"label",15),a.EFF(8,"\u0422\u043e\u0447\u043d\u043e\u0441\u0442\u044c, \u0437\u043d\u0430\u043a\u043e\u0432 \u043f\u043e\u0441\u043b\u0435 \u0437\u0430\u043f\u044f\u0442\u043e\u0439"),a.k0s(),a.j41(9,"p-inputNumber",16),a.mxI("ngModelChange",function(i){a.eBV(t);const s=a.XpG();return a.DH7(s.newItem.decimalPlaces,i)||(s.newItem.decimalPlaces=i),a.Njj(i)}),a.k0s()(),a.j41(10,"div",12)(11,"label",17),a.EFF(12,"\u0415\u0434\u0438\u043d\u0438\u0446\u0430 \u0438\u0437\u043c\u0435\u0440\u0435\u043d\u0438\u044f"),a.k0s(),a.j41(13,"p-dropdown",18),a.mxI("ngModelChange",function(i){a.eBV(t);const s=a.XpG();return a.DH7(s.newItem.unitOfMeasure,i)||(s.newItem.unitOfMeasure=i),a.Njj(i)}),a.k0s()(),a.j41(14,"div",12)(15,"label",19),a.EFF(16,"\u0426\u0435\u043d\u044b"),a.k0s(),a.j41(17,"p-table",20),a.DNE(18,RA,6,0,"ng-template",4)(19,OA,7,9,"ng-template",5),a.k0s(),a.j41(20,"p-button",21),a.bIt("click",function(){a.eBV(t);const i=a.XpG();return a.Njj(i.addPrice())}),a.k0s()()(),a.DNE(21,BA,2,0,"button",22)(22,MA,2,0,"button",22),a.k0s()}if(2&e){const t=a.XpG();a.Aen(a.lJ4(19,EA)),a.Y8G("header",t.dialogTitle)("modal",!0),a.R50("visible",t.showDialog),a.Y8G("draggable",!1)("resizable",!1),a.R7$(5),a.R50("ngModel",t.newItem.name),a.R7$(4),a.R50("ngModel",t.newItem.decimalPlaces),a.Y8G("min",0)("max",5)("showButtons",!0),a.R7$(4),a.R50("ngModel",t.newItem.unitOfMeasure),a.Y8G("options",t.measureUnits)("autoDisplayFirst",!1),a.R7$(4),a.Y8G("value",t.newItem.prices)("editable",!0),a.R7$(4),a.Y8G("ngIf",t.isAdding),a.R7$(),a.Y8G("ngIf",!t.isAdding)}}let UA=(()=>{class e{constructor(t,n,i){this.purchaseService=t,this.messageService=n,this.timeService=i,this.measureUnits=[{value:At.D.UnitOfMeasure.Piece,name:"\u0448\u0442"},{value:At.D.UnitOfMeasure.SquareMeter,name:"\u043c2"},{value:At.D.UnitOfMeasure.Meter,name:"\u043c"}]}getMeasureUnitText(t){return this.measureUnits.find(n=>n.value==t)?.name??t.toString()}get data(){return this.purchaseService.getPackageTypes()}getQuantum(t){return Math.pow(10,-t.decimalPlaces)}showAddPackageTypeDialog(){this.isAdding=!0,this.dialogTitle="\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0442\u0438\u043f\u0430 \u0443\u043f\u0430\u043a\u043e\u0432\u043a\u0438",this.newItem={decimalPlaces:0},this.showDialog=!0}showEditPackageTypeDialog(t){this.isAdding=!1,this.dialogTitle="\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0442\u0438\u043f\u0430 \u0443\u043f\u0430\u043a\u043e\u0432\u043a\u0438",this.newItem=t,this.showDialog=!0}removePackageType(t){this.purchaseService.removePackageType(t.iD).pipe((0,Le.W)(n=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u0442\u0438\u043f\u0430 \u0443\u043f\u0430\u043a\u043e\u0432\u043a\u0438",severity:"error",detail:n}),Nt.w))).subscribe()}addPackageType(){this.purchaseService.addPackageType(this.newItem).pipe((0,Le.W)(t=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0442\u0438\u043f\u0430 \u0443\u043f\u0430\u043a\u043e\u0432\u043a\u0438",severity:"error",detail:t}),Nt.w))).subscribe(()=>{this.showDialog=!1})}addPrice(){this.newItem.prices||(this.newItem.prices=[]);const t=new TA({packageTypeID:0,price:0,date:this.timeService.asUtc(new Date)});this.newItem.prices.push(t)}removePrice(t){this.newItem.prices=this.newItem.prices.filter(n=>n!==t)}updatePackageType(){for(const t of this.newItem.prices)t.date=new Date(Date.UTC(t.date.getFullYear(),t.date.getMonth(),t.date.getDate(),0,0,0));this.purchaseService.updatePackageType(this.newItem).pipe((0,Le.W)(t=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0442\u0438\u043f\u0430 \u0443\u043f\u0430\u043a\u043e\u0432\u043a\u0438",severity:"error",detail:t}),Nt.w))).subscribe(()=>{this.showDialog=!1})}static{this.\u0275fac=function(n){return new(n||e)(a.rXU(Na),a.rXU(Ze.bg),a.rXU(yA.v))}}static{this.\u0275cmp=a.VBU({type:e,selectors:[["app-package-type-list"]],decls:7,vars:2,consts:[[3,"click"],["dataKey","iD",3,"value","tableStyle","paginator","rows","rowsPerPageOptions","totalRecords",4,"ngIf"],[3,"header","modal","style","visible","draggable","resizable","visibleChange",4,"ngIf"],["dataKey","iD",3,"value","tableStyle","paginator","rows","rowsPerPageOptions","totalRecords"],["pTemplate","header"],["pTemplate","body"],["pSortableColumn","unitOfMeasure"],["field","unitOfMeasure"],[4,"ngFor","ngForOf"],["type","button","pRipple","","icon","pi pi-pencil",3,"click"],["icon","pi pi-trash","styleClass","p-button-danger",3,"click"],[3,"visibleChange","header","modal","visible","draggable","resizable"],[1,"flex-auto","m-3"],["for","name",1,"block","font-bold"],["pInputText","","inputId","name",3,"ngModelChange","ngModel"],["for","decimalPlaces",1,"mb-2","block","font-bold"],["inputId","decimalPlaces",3,"ngModelChange","ngModel","min","max","showButtons"],["for","unitOfMeasure",1,"mb-2","block","font-bold"],["appendTo","body","placeholder","\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0435\u0434\u0438\u043d\u0438\u0446\u0443 \u0438\u0437\u043c\u0435\u0440\u0435\u043d\u0438\u0439","inputId","unitOfMeasure","optionLabel","name","optionValue","value",3,"ngModelChange","ngModel","options","autoDisplayFirst"],[1,"mb-2","block","font-bold"],[3,"value","editable"],["label","\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0446\u0435\u043d\u0443","icon","pi pi-plus",3,"click"],["pButton","",3,"click",4,"ngIf"],["appendTo","body","placeholder","\u0414\u0430\u0442\u0430 \u043d\u0430\u0447\u0430\u043b\u0430 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f",3,"ngModelChange","ngModel","readonlyInput","selectOtherMonths","showClear"],[3,"ngModelChange","ngModel","min","minFractionDigits","maxFractionDigits","showButtons"],["pButton","",3,"click"]],template:function(n,i){1&n&&(a.nrm(0,"p-toast"),a.j41(1,"h1"),a.EFF(2,"\u0423\u043f\u0430\u043a\u043e\u0432\u043a\u0430 \u0442\u043e\u0432\u0430\u0440\u043e\u0432"),a.k0s(),a.j41(3,"p-button",0),a.bIt("click",function(){return i.showAddPackageTypeDialog()}),a.EFF(4,"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"),a.k0s(),a.DNE(5,PA,3,8,"p-table",1)(6,LA,23,20,"p-dialog",2)),2&n&&(a.R7$(5),a.Y8G("ngIf",i.data),a.R7$(),a.Y8G("ngIf",i.newItem))},dependencies:[Ze.Ei,Gr._f,Gr.$n,ws.Vv,Oe.Sq,Oe.bT,ys.l,Pa.ms,nr.me,nr.BC,nr.vS,Ra.YI,Oi.S,jr.XI,jr.Tg,jr.yc,hi.y8,Oe.vh]})}}return e})();var gt,Ui=Fe(467),Gi={version:"0.20.3"},Zt=1200,Un=1252,GA=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Ds={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},ja=function(e){-1!=GA.indexOf(e)&&(Un=Ds[0]=e)},Vr=function(e){Zt=e,ja(e)};
/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */function Va(){Vr(1200),function jA(){ja(1252)}()}function $a(e){for(var r=[],t=0,n=e.length;t<n;++t)r[t]=e.charCodeAt(t);return r}function y0(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return r.join("")}function T0(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return r.join("")}var Ci=function(e){var r=e.charCodeAt(0),t=e.charCodeAt(1);return 255==r&&254==t?y0(e.slice(2)):254==r&&255==t?T0(e.slice(2)):65279==r?e.slice(1):e},ji=function(r){return String.fromCharCode(r)},Ns=function(r){return String.fromCharCode(r)},Gt=null,hr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Wa(e){for(var r="",t=0,n=0,i=0,s=0,o=0,l=0,g=0,u=0;u<e.length;)s=(t=e.charCodeAt(u++))>>2,o=(3&t)<<4|(n=e.charCodeAt(u++))>>4,l=(15&n)<<2|(i=e.charCodeAt(u++))>>6,g=63&i,isNaN(n)?l=g=64:isNaN(i)&&(g=64),r+=hr.charAt(s)+hr.charAt(o)+hr.charAt(l)+hr.charAt(g);return r}function Br(e){var r="",s=0,o=0,l=0,g=0;"data:"==e.slice(0,5)&&(u=e.slice(0,1024).indexOf(";base64,"))>-1&&(e=e.slice(u+8)),e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)s=hr.indexOf(e.charAt(u++)),o=hr.indexOf(e.charAt(u++)),r+=String.fromCharCode(s<<2|o>>4),64!==(l=hr.indexOf(e.charAt(u++)))&&(r+=String.fromCharCode((15&o)<<4|l>>2)),64!==(g=hr.indexOf(e.charAt(u++)))&&(r+=String.fromCharCode((3&l)<<6|g));return r}var ft=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),an=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(r,t){return t?new Buffer(r,t):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}}(),Vi=function(){if(typeof Buffer>"u")return!1;var e=an([65,0]);return!!e&&1==e.toString("utf16le").length}();function Dn(e){return ft?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function b0(e){return ft?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var wr=function(r){return ft?an(r,"binary"):r.split("").map(function(t){return 255&t.charCodeAt(0)})};function $i(e){if(typeof ArrayBuffer>"u")return wr(e);for(var r=new ArrayBuffer(e.length),t=new Uint8Array(r),n=0;n!=e.length;++n)t[n]=255&e.charCodeAt(n);return r}function sn(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var r=[],t=0;t<e.length;++t)r[t]=String.fromCharCode(e[t]);return r.join("")}function Ps(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Ps(new Uint8Array(e));for(var r=new Array(e.length),t=0;t<e.length;++t)r[t]=e[t];return r}var jt=ft?function(e){return Buffer.concat(e.map(function(r){return Buffer.isBuffer(r)?r:an(r)}))}:function(e){if(typeof Uint8Array<"u"){var r=0,t=0;for(r=0;r<e.length;++r)t+=e[r].length;var n=new Uint8Array(t),i=0;for(r=0,t=0;r<e.length;t+=i,++r)i=e[r].length,e[r]instanceof Uint8Array?n.set(e[r],t):n.set("string"==typeof e[r]?new Uint8Array(wr(e[r])):new Uint8Array(e[r]),t);return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))},yr=/\u0000/g,Wi=/[\u0001-\u0006]/g;function Ii(e){for(var r="",t=e.length-1;t>=0;)r+=e.charAt(t--);return r}function Kr(e,r){var t=""+e;return t.length>=r?t:dt("0",r-t.length)+t}function Rs(e,r){var t=""+e;return t.length>=r?t:dt(" ",r-t.length)+t}function Xa(e,r){var t=""+e;return t.length>=r?t:t+dt(" ",r-t.length)}var E0=Math.pow(2,32);function Ai(e,r){return e>E0||e<-E0?function YA(e,r){var t=""+Math.round(e);return t.length>=r?t:dt("0",r-t.length)+t}(e,r):function JA(e,r){var t=""+e;return t.length>=r?t:dt("0",r-t.length)+t}(Math.round(e),r)}function za(e,r){return e.length>=7+(r=r||0)&&103==(32|e.charCodeAt(r))&&101==(32|e.charCodeAt(r+1))&&110==(32|e.charCodeAt(r+2))&&101==(32|e.charCodeAt(r+3))&&114==(32|e.charCodeAt(r+4))&&97==(32|e.charCodeAt(r+5))&&108==(32|e.charCodeAt(r+6))}var F0=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Os=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]],Ve={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "'},D0={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},ZA={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Ha(e,r,t){for(var n=e<0?-1:1,i=e*n,s=0,o=1,l=0,g=1,u=0,h=0,A=Math.floor(i);u<r&&(l=(A=Math.floor(i))*o+s,h=A*u+g,!(i-A<5e-8));)i=1/(i-A),s=o,o=l,g=u,u=h;if(h>r&&(u>r?(h=g,l=s):(h=u,l=o)),!t)return[0,n*l,h];var C=Math.floor(n*l/h);return[C,n*l-C*h,h]}function on(e,r,t){if(e>2958465||e<0)return null;e=function QA(e){var r=e.toPrecision(16);if(r.indexOf("e")>-1){var t=r.slice(0,r.indexOf("e"));return(t=t.indexOf(".")>-1?t.slice(0,"0."==t.slice(0,2)?17:16):t.slice(0,15)+dt("0",t.length-15))+r.slice(r.indexOf("e"))}var n=r.indexOf(".")>-1?r.slice(0,"0."==r.slice(0,2)?17:16):r.slice(0,15)+dt("0",r.length-15);return Number(n)}(e);var n=0|e,i=Math.floor(86400*(e-n)),s=0,o=[],l={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),r&&r.date1904&&(n+=1462),l.u>.9999&&(l.u=0,86400==++i&&(l.T=i=0,++n,++l.D)),60===n)o=t?[1317,10,29]:[1900,2,29],s=3;else if(0===n)o=t?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var g=new Date(1900,0,1);g.setDate(g.getDate()+n-1),o=[g.getFullYear(),g.getMonth()+1,g.getDate()],s=g.getDay(),n<60&&(s=(s+6)%7),t&&(s=function rp(e,r){r[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}(g,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=i%60,i=Math.floor(i/60),l.M=i%60,i=Math.floor(i/60),l.H=i,l.q=s,l}function Bs(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Xi(e){if(!isFinite(e))return isNaN(e)?"#NUM!":"#DIV/0!";var t,r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return t=r>=-4&&r<=-1?e.toPrecision(10+r):Math.abs(r)<=9?function ep(e){var r=e<0?12:11,t=Bs(e.toFixed(12));return t.length<=r||(t=e.toPrecision(10)).length<=r?t:e.toExponential(5)}(e):10===r?e.toFixed(10).substr(0,12):function tp(e){var r=Bs(e.toFixed(11));return r.length>(e<0?12:11)||"0"===r||"-0"===r?e.toPrecision(6):r}(e),Bs(function qA(e){return-1==e.indexOf("E")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(t.toUpperCase()))}function Gn(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):Xi(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return Dr(14,Ot(e,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+e)}function np(e,r,t,n){var g,i="",s=0,o=0,l=t.y,u=0;switch(e){case 98:l=t.y+543;case 121:switch(r.length){case 1:case 2:g=l%100,u=2;break;default:g=l%1e4,u=4}break;case 109:switch(r.length){case 1:case 2:g=t.m,u=r.length;break;case 3:return Os[t.m-1][1];case 5:return Os[t.m-1][0];default:return Os[t.m-1][2]}break;case 100:switch(r.length){case 1:case 2:g=t.d,u=r.length;break;case 3:return F0[t.q][0];default:return F0[t.q][1]}break;case 104:switch(r.length){case 1:case 2:g=1+(t.H+11)%12,u=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:g=t.H,u=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:g=t.M,u=r.length;break;default:throw"bad minute format: "+r}break;case 115:if("s"!=r&&"ss"!=r&&".0"!=r&&".00"!=r&&".000"!=r)throw"bad second format: "+r;return 0!==t.u||"s"!=r&&"ss"!=r?(o=n>=2?3===n?1e3:100:1===n?10:1,(s=Math.round(o*(t.S+t.u)))>=60*o&&(s=0),"s"===r?0===s?"0":""+s/o:(i=Kr(s,2+n),"ss"===r?i.substr(0,2):"."+i.substr(2,r.length-1))):Kr(t.S,r.length);case 90:switch(r){case"[h]":case"[hh]":g=24*t.D+t.H;break;case"[m]":case"[mm]":g=60*(24*t.D+t.H)+t.M;break;case"[s]":case"[ss]":g=60*(60*(24*t.D+t.H)+t.M)+(0==n?Math.round(t.S+t.u):t.S);break;default:throw"bad abstime format: "+r}u=3===r.length?1:2;break;case 101:g=l,u=1}return u>0?Kr(g,u):""}function dn(e){if(e.length<=3)return e;for(var t=e.length%3,n=e.substr(0,t);t!=e.length;t+=3)n+=(n.length>0?",":"")+e.substr(t,3);return n}var N0=/%/g;function P0(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==r)return"0.0E+0";if(r<0)return"-"+P0(e,-r);var i=e.indexOf(".");-1===i&&(i=e.indexOf("E"));var s=Math.floor(Math.log(r)*Math.LOG10E)%i;if(s<0&&(s+=i),-1===(t=(r/Math.pow(10,s)).toPrecision(n+1+(i+s)%i)).indexOf("e")){var o=Math.floor(Math.log(r)*Math.LOG10E);for(-1===t.indexOf(".")?t=t.charAt(0)+"."+t.substr(1)+"E+"+(o-t.length+s):t+="E+"+(o-s);"0."===t.substr(0,2);)t=(t=t.charAt(0)+t.substr(2,i)+"."+t.substr(2+i)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,g,u,h){return g+u+h.substr(0,(i+s)%i)+"."+h.substr(s)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var R0=/# (\?+)( ?)\/( ?)(\d+)/,O0=/^#*0*\.([0#]+)/,B0=/\)[^)]*[0#]/,M0=/\(###\) ###\\?-####/;function Tr(e){for(var t,r="",n=0;n!=e.length;++n)switch(t=e.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function L0(e,r){var t=Math.pow(10,r);return""+Math.round(e*t)/t}function U0(e,r){var t=e-Math.floor(e),n=Math.pow(10,r);return r<(""+Math.round(t*n)).length?0:Math.round(t*n)}function $r(e,r,t){if(40===e.charCodeAt(0)&&!r.match(B0)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?$r("n",n,t):"("+$r("n",n,-t)+")"}if(44===r.charCodeAt(r.length-1))return function ap(e,r,t){for(var n=r.length-1;44===r.charCodeAt(n-1);)--n;return mn(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}(e,r,t);if(-1!==r.indexOf("%"))return function ip(e,r,t){var n=r.replace(N0,""),i=r.length-n.length;return mn(e,n,t*Math.pow(10,2*i))+dt("%",i)}(e,r,t);if(-1!==r.indexOf("E"))return P0(r,t);if(36===r.charCodeAt(0))return"$"+$r(e,r.substr(" "==r.charAt(1)?2:1),t);var i,s,o,l,g=Math.abs(t),u=t<0?"-":"";if(r.match(/^00+$/))return u+Ai(g,r.length);if(r.match(/^[#?]+$/))return"0"===(i=Ai(t,0))&&(i=""),i.length>r.length?i:Tr(r.substr(0,r.length-i.length))+i;if(s=r.match(R0))return function sp(e,r,t){var n=parseInt(e[4],10),i=Math.round(r*n),s=Math.floor(i/n),o=i-s*n,l=n;return t+(0===s?"":""+s)+" "+(0===o?dt(" ",e[1].length+1+e[4].length):Rs(o,e[1].length)+e[2]+"/"+e[3]+Kr(l,e[4].length))}(s,g,u);if(r.match(/^#+0+$/))return u+Ai(g,r.length-r.indexOf("0"));if(s=r.match(O0))return i=L0(t,s[1].length).replace(/^([^\.]+)$/,"$1."+Tr(s[1])).replace(/\.$/,"."+Tr(s[1])).replace(/\.(\d*)$/,function(m,_){return"."+_+dt("0",Tr(s[1]).length-_.length)}),-1!==r.indexOf("0.")?i:i.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),s=r.match(/^(0*)\.(#*)$/))return u+L0(g,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=r.match(/^#{1,3},##0(\.?)$/))return u+dn(Ai(g,0));if(s=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+$r(e,r,-t):dn(""+(Math.floor(t)+function lp(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?1:0}(t,s[1].length)))+"."+Kr(U0(t,s[1].length),s[1].length);if(s=r.match(/^#,#*,#0/))return $r(e,r.replace(/^#,#*,/,""),t);if(s=r.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Ii($r(e,r.replace(/[\\-]/g,""),t)),o=0,Ii(Ii(r.replace(/\\/g,"")).replace(/[0#]/g,function(m){return o<i.length?i.charAt(o++):"0"===m?"0":""}));if(r.match(M0))return"("+(i=$r(e,"##########",t)).substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(s=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),l=Ha(g,Math.pow(10,o)-1,!1),i=""+u," "==(h=mn("n",s[1],l[1])).charAt(h.length-1)&&(h=h.substr(0,h.length-1)+"0"),i+=h+s[2]+"/"+s[3],(h=Xa(l[2],o)).length<s[4].length&&(h=Tr(s[4].substr(s[4].length-h.length))+h),i+=h;if(s=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),u+((l=Ha(g,Math.pow(10,o)-1,!0))[0]||(l[1]?"":"0"))+" "+(l[1]?Rs(l[1],o)+s[2]+"/"+s[3]+Xa(l[2],o):dt(" ",2*o+1+s[2].length+s[3].length));if(s=r.match(/^[#0?]+$/))return i=Ai(t,0),r.length<=i.length?i:Tr(r.substr(0,r.length-i.length))+i;if(s=r.match(/^([#0?]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var A=r.indexOf(".")-o,C=r.length-i.length-A;return Tr(r.substr(0,A)+i+r.substr(r.length-C))}if(s=r.match(/^00,000\.([#0]*0)$/))return o=U0(t,s[1].length),t<0?"-"+$r(e,r,-t):dn(function cp(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Kr(0,3-m.length):"")+m})+"."+Kr(o,s[1].length);switch(r){case"###,##0.00":return $r(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var I=dn(Ai(g,0));return"0"!==I?u+I:"";case"###,###.00":return $r(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return $r(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function G0(e,r){var t,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==r)return"0.0E+0";if(r<0)return"-"+G0(e,-r);var i=e.indexOf(".");-1===i&&(i=e.indexOf("E"));var s=Math.floor(Math.log(r)*Math.LOG10E)%i;if(s<0&&(s+=i),!(t=(r/Math.pow(10,s)).toPrecision(n+1+(i+s)%i)).match(/[Ee]/)){var o=Math.floor(Math.log(r)*Math.LOG10E);-1===t.indexOf(".")?t=t.charAt(0)+"."+t.substr(1)+"E+"+(o-t.length+s):t+="E+"+(o-s),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,g,u,h){return g+u+h.substr(0,(i+s)%i)+"."+h.substr(s)+"E"})}else t=r.toExponential(n);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function ln(e,r,t){if(40===e.charCodeAt(0)&&!r.match(B0)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?ln("n",n,t):"("+ln("n",n,-t)+")"}if(44===r.charCodeAt(r.length-1))return function gp(e,r,t){for(var n=r.length-1;44===r.charCodeAt(n-1);)--n;return mn(e,r.substr(0,n),t/Math.pow(10,3*(r.length-n)))}(e,r,t);if(-1!==r.indexOf("%"))return function fp(e,r,t){var n=r.replace(N0,""),i=r.length-n.length;return mn(e,n,t*Math.pow(10,2*i))+dt("%",i)}(e,r,t);if(-1!==r.indexOf("E"))return G0(r,t);if(36===r.charCodeAt(0))return"$"+ln(e,r.substr(" "==r.charAt(1)?2:1),t);var i,s,o,l,g=Math.abs(t),u=t<0?"-":"";if(r.match(/^00+$/))return u+Kr(g,r.length);if(r.match(/^[#?]+$/))return i=""+t,0===t&&(i=""),i.length>r.length?i:Tr(r.substr(0,r.length-i.length))+i;if(s=r.match(R0))return function op(e,r,t){return t+(0===r?"":""+r)+dt(" ",e[1].length+2+e[4].length)}(s,g,u);if(r.match(/^#+0+$/))return u+Kr(g,r.length-r.indexOf("0"));if(s=r.match(O0))return i=(i=(""+t).replace(/^([^\.]+)$/,"$1."+Tr(s[1])).replace(/\.$/,"."+Tr(s[1]))).replace(/\.(\d*)$/,function(m,_){return"."+_+dt("0",Tr(s[1]).length-_.length)}),-1!==r.indexOf("0.")?i:i.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),s=r.match(/^(0*)\.(#*)$/))return u+(""+g).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=r.match(/^#{1,3},##0(\.?)$/))return u+dn(""+g);if(s=r.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+ln(e,r,-t):dn(""+t)+"."+dt("0",s[1].length);if(s=r.match(/^#,#*,#0/))return ln(e,r.replace(/^#,#*,/,""),t);if(s=r.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Ii(ln(e,r.replace(/[\\-]/g,""),t)),o=0,Ii(Ii(r.replace(/\\/g,"")).replace(/[0#]/g,function(m){return o<i.length?i.charAt(o++):"0"===m?"0":""}));if(r.match(M0))return"("+(i=ln(e,"##########",t)).substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(s=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),l=Ha(g,Math.pow(10,o)-1,!1),i=""+u," "==(h=mn("n",s[1],l[1])).charAt(h.length-1)&&(h=h.substr(0,h.length-1)+"0"),i+=h+s[2]+"/"+s[3],(h=Xa(l[2],o)).length<s[4].length&&(h=Tr(s[4].substr(s[4].length-h.length))+h),i+=h;if(s=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),u+((l=Ha(g,Math.pow(10,o)-1,!0))[0]||(l[1]?"":"0"))+" "+(l[1]?Rs(l[1],o)+s[2]+"/"+s[3]+Xa(l[2],o):dt(" ",2*o+1+s[2].length+s[3].length));if(s=r.match(/^[#0?]+$/))return r.length<=(i=""+t).length?i:Tr(r.substr(0,r.length-i.length))+i;if(s=r.match(/^([#0]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var A=r.indexOf(".")-o,C=r.length-i.length-A;return Tr(r.substr(0,A)+i+r.substr(r.length-C))}if(s=r.match(/^00,000\.([#0]*0)$/))return t<0?"-"+ln(e,r,-t):dn(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Kr(0,3-m.length):"")+m})+"."+Kr(0,s[1].length);switch(r){case"###,###":case"##,###":case"#,###":var I=dn(""+g);return"0"!==I?u+I:"";default:if(r.match(/\.[0#?]*$/))return ln(e,r.slice(0,r.lastIndexOf(".")),t)+Tr(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function mn(e,r,t){return(0|t)===t?ln(e,r,t):$r(e,r,t)}var j0=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Mr(e){for(var r=0,t="",n="";r<e.length;)switch(t=e.charAt(r)){case"G":za(e,r)&&(r+=6),r++;break;case'"':for(;34!==e.charCodeAt(++r)&&r<e.length;);++r;break;case"\\":case"_":r+=2;break;case"@":++r;break;case"B":case"b":if("1"===e.charAt(r+1)||"2"===e.charAt(r+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4e0a":if("A/P"===e.substr(r,3).toUpperCase()||"AM/PM"===e.substr(r,5).toUpperCase()||"\u4e0a\u5348/\u4e0b\u5348"===e.substr(r,5).toUpperCase())return!0;++r;break;case"[":for(n=t;"]"!==e.charAt(r++)&&r<e.length;)n+=e.charAt(r);if(n.match(j0))return!0;break;case".":case"0":case"#":for(;r<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++r))>-1||"\\"==t&&"-"==e.charAt(r+1)&&"0#".indexOf(e.charAt(r+2))>-1););break;case"?":for(;e.charAt(++r)===t;);break;case"*":++r,(" "==e.charAt(r)||"*"==e.charAt(r))&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&"0123456789".indexOf(e.charAt(++r))>-1;);break;default:++r}return!1}var V0=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function $0(e,r){if(null==r)return!1;var t=parseFloat(r[2]);switch(r[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0}return!1}function Dr(e,r,t){null==t&&(t={});var n="";switch(typeof e){case"string":n="m/d/yy"==e&&t.dateNF?t.dateNF:e;break;case"number":null==(n=14==e&&t.dateNF?t.dateNF:(null!=t.table?t.table:Ve)[e])&&(n=t.table&&t.table[D0[e]]||Ve[D0[e]]),null==n&&(n=ZA[e]||"General")}if(za(n,0))return Gn(r,t);r instanceof Date&&(r=Ot(r,t.date1904));var i=function Cp(e,r){var t=function up(e){for(var r=[],t=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:t=!t;break;case 95:case 42:case 92:++n;break;case 59:r[r.length]=e.substr(i,n-i),i=n+1}if(r[r.length]=e.substr(i),!0===t)throw new Error("Format |"+e+"| unterminated string ");return r}(e),n=t.length,i=t[n-1].indexOf("@");if(n<4&&i>-1&&--n,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if("number"!=typeof r)return[4,4===t.length||i>-1?t[t.length-1]:"@"];switch("number"==typeof r&&!isFinite(r)&&(r=0),t.length){case 1:t=i>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=i>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=i>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"]}var s=r>0?t[0]:r<0?t[1]:t[2];if(-1===t[0].indexOf("[")&&-1===t[1].indexOf("["))return[n,s];if(null!=t[0].match(/\[[=<>]/)||null!=t[1].match(/\[[=<>]/)){var o=t[0].match(V0),l=t[1].match(V0);return $0(r,o)?[n,t[0]]:$0(r,l)?[n,t[1]]:[n,t[null!=o&&null!=l?2:1]]}return[n,s]}(n,r);if(za(i[1]))return Gn(r,t);if(!0===r)r="TRUE";else if(!1===r)r="FALSE";else{if(""===r||null==r)return"";if(isNaN(r)&&i[1].indexOf("0")>-1)return"#NUM!";if(!isFinite(r)&&i[1].indexOf("0")>-1)return"#DIV/0!"}return function hp(e,r,t,n){for(var u,h,A,i=[],s="",o=0,l="",g="t",C="H";o<e.length;)switch(l=e.charAt(o)){case"G":if(!za(e,o))throw new Error("unrecognized character "+l+" in "+e);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";34!==(A=e.charCodeAt(++o))&&o<e.length;)s+=String.fromCharCode(A);i[i.length]={t:"t",v:s},++o;break;case"\\":var I=e.charAt(++o);i[i.length]={t:"("===I||")"===I?I:"t",v:I},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:r},++o;break;case"B":case"b":if("1"===e.charAt(o+1)||"2"===e.charAt(o+1)){if(null==u&&null==(u=on(r,t,"2"===e.charAt(o+1))))return"";i[i.length]={t:"X",v:e.substr(o,2)},g=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||null==u&&null==(u=on(r,t)))return"";for(s=l;++o<e.length&&e.charAt(o).toLowerCase()===l;)s+=l;"m"===l&&"h"===g.toLowerCase()&&(l="M"),"h"===l&&(l=C),i[i.length]={t:l,v:s},g=l;break;case"A":case"a":case"\u4e0a":var _={t:l,v:l};if(null==u&&(u=on(r,t)),"A/P"===e.substr(o,3).toUpperCase()?(null!=u&&(_.v=u.H>=12?e.charAt(o+2):l),_.t="T",C="h",o+=3):"AM/PM"===e.substr(o,5).toUpperCase()?(null!=u&&(_.v=u.H>=12?"PM":"AM"),_.t="T",o+=5,C="h"):"\u4e0a\u5348/\u4e0b\u5348"===e.substr(o,5).toUpperCase()?(null!=u&&(_.v=u.H>=12?"\u4e0b\u5348":"\u4e0a\u5348"),_.t="T",o+=5,C="h"):(_.t="t",++o),null==u&&"T"===_.t)return"";i[i.length]=_,g=l;break;case"[":for(s=l;"]"!==e.charAt(o++)&&o<e.length;)s+=e.charAt(o);if("]"!==s.slice(-1))throw'unterminated "[" block: |'+s+"|";if(s.match(j0)){if(null==u&&null==(u=on(r,t)))return"";i[i.length]={t:"Z",v:s.toLowerCase()},g=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Mr(e)||(i[i.length]={t:"t",v:s}));break;case".":if(null!=u){for(s=l;++o<e.length&&"0"===(l=e.charAt(o));)s+=l;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=l;++o<e.length&&"0#?.,E+-%".indexOf(l=e.charAt(o))>-1;)s+=l;i[i.length]={t:"n",v:s};break;case"?":for(s=l;e.charAt(++o)===l;)s+=l;i[i.length]={t:l,v:s},g=l;break;case"*":++o,(" "==e.charAt(o)||"*"==e.charAt(o))&&++o;break;case"(":case")":i[i.length]={t:1===n?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=l;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)s+=e.charAt(o);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:l,v:l},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(-1===",$-+/():!^&'~{}<>=\u20acacfijklopqrtuvwxzP".indexOf(l))throw new Error("unrecognized character "+l+" in "+e);i[i.length]={t:"t",v:l},++o}var w,v,p=0,d=0;for(o=i.length-1,g="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=C,g="h",p<1&&(p=1);break;case"s":(w=i[o].v.match(/\.0+$/))&&(d=Math.max(d,w[0].length-1),p=4),p<3&&(p=3);case"d":case"y":case"e":g=i[o].t;break;case"M":g=i[o].t,p<2&&(p=2);break;case"m":"s"===g&&(i[o].t="M",p<2&&(p=2));break;case"X":break;case"Z":p<1&&i[o].v.match(/[Hh]/)&&(p=1),p<2&&i[o].v.match(/[Mm]/)&&(p=2),p<3&&i[o].v.match(/[Ss]/)&&(p=3)}switch(p){case 0:break;case 1:case 2:case 3:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H),u.H>=24&&(u.H=0,++u.D,(v=on(u.D)).u=u.u,v.S=u.S,v.M=u.M,v.H=u.H,u=v);break;case 4:switch(d){case 1:u.u=Math.round(10*u.u)/10;break;case 2:u.u=Math.round(100*u.u)/100;break;case 3:u.u=Math.round(1e3*u.u)/1e3}u.u>=1&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H),u.H>=24&&(u.H=0,++u.D,(v=on(u.D)).u=u.u,v.S=u.S,v.M=u.M,v.H=u.H,u=v)}var G,S="";for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=np(i[o].t.charCodeAt(0),i[o].v,u,d),i[o].t="t";break;case"n":case"?":for(G=o+1;null!=i[G]&&("?"===(l=i[G].t)||"D"===l||(" "===l||"t"===l)&&null!=i[G+1]&&("?"===i[G+1].t||"t"===i[G+1].t&&"/"===i[G+1].v)||"("===i[o].t&&(" "===l||"n"===l||")"===l)||"t"===l&&("/"===i[G].v||" "===i[G].v&&null!=i[G+1]&&"?"==i[G+1].t));)i[o].v+=i[G].v,i[G]={v:"",t:";"},++G;S+=i[o].v,o=G-1;break;case"G":i[o].t="t",i[o].v=Gn(r,t)}var E,O,X="";if(S.length>0){40==S.charCodeAt(0)?(E=r<0&&45===S.charCodeAt(0)?-r:r,O=mn("n",S,E)):(O=mn("n",S,E=r<0&&n>1?-r:r),E<0&&i[0]&&"t"==i[0].t&&(O=O.substr(1),i[0].v="-"+i[0].v)),G=O.length-1;var L=i.length;for(o=0;o<i.length;++o)if(null!=i[o]&&"t"!=i[o].t&&i[o].v.indexOf(".")>-1){L=o;break}var W=i.length;if(L===i.length&&-1===O.indexOf("E")){for(o=i.length-1;o>=0;--o)null==i[o]||-1==="n?".indexOf(i[o].t)||(G>=i[o].v.length-1?i[o].v=O.substr(1+(G-=i[o].v.length),i[o].v.length):G<0?i[o].v="":(i[o].v=O.substr(0,G+1),G=-1),i[o].t="t",W=o);G>=0&&W<i.length&&(i[W].v=O.substr(0,G+1)+i[W].v)}else if(L!==i.length&&-1===O.indexOf("E")){for(G=O.indexOf(".")-1,o=L;o>=0;--o)if(null!=i[o]&&-1!=="n?".indexOf(i[o].t)){for(h=i[o].v.indexOf(".")>-1&&o===L?i[o].v.indexOf(".")-1:i[o].v.length-1,X=i[o].v.substr(h+1);h>=0;--h)G>=0&&("0"===i[o].v.charAt(h)||"#"===i[o].v.charAt(h))&&(X=O.charAt(G--)+X);i[o].v=X,i[o].t="t",W=o}for(G>=0&&W<i.length&&(i[W].v=O.substr(0,G+1)+i[W].v),G=O.indexOf(".")+1,o=L;o<i.length;++o)if(null!=i[o]&&(-1!=="n?(".indexOf(i[o].t)||o===L)){for(h=i[o].v.indexOf(".")>-1&&o===L?i[o].v.indexOf(".")+1:0,X=i[o].v.substr(0,h);h<i[o].v.length;++h)G<O.length&&(X+=O.charAt(G++));i[o].v=X,i[o].t="t",W=o}}}for(o=0;o<i.length;++o)null!=i[o]&&"n?".indexOf(i[o].t)>-1&&(i[o].v=mn(i[o].t,i[o].v,E=n>1&&r<0&&o>0&&"-"===i[o-1].v?-r:r),i[o].t="t");var H="";for(o=0;o!==i.length;++o)null!=i[o]&&(H+=i[o].v);return H}(i[1],r,t,i[0])}function Ms(e,r){if("number"!=typeof r){r=+r||-1;for(var t=0;t<392;++t)if(null!=Ve[t]){if(Ve[t]==e){r=t;break}}else r<0&&(r=t);r<0&&(r=391)}return Ve[r]=e,r}function pi(e){for(var r=0;392!=r;++r)void 0!==e[r]&&Ms(e[r],r)}function jn(){Ve=function KA(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4e0a\u5348/\u4e0b\u5348 "hh"\u6642"mm"\u5206"ss"\u79d2 "',e}()}var Ip={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Ya=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g,dp={"d.m":"d\\.m"};function Nn(e,r){return Ms(dp[e]||e,r)}var _n,X0=function(){var e={version:"1.2.0"},t=function r(){for(var E=0,O=new Array(256),L=0;256!=L;++L)O[L]=E=1&(E=1&(E=1&(E=1&(E=1&(E=1&(E=1&(E=1&(E=L)?-306674912^E>>>1:E>>>1)?-306674912^E>>>1:E>>>1)?-306674912^E>>>1:E>>>1)?-306674912^E>>>1:E>>>1)?-306674912^E>>>1:E>>>1)?-306674912^E>>>1:E>>>1)?-306674912^E>>>1:E>>>1)?-306674912^E>>>1:E>>>1;return typeof Int32Array<"u"?new Int32Array(O):O}(),i=function n(E){var O=0,L=0,W=0,H=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(W=0;256!=W;++W)H[W]=E[W];for(W=0;256!=W;++W)for(L=E[W],O=256+W;O<4096;O+=256)L=H[O]=L>>>8^E[255&L];var Y=[];for(W=1;16!=W;++W)Y[W-1]=typeof Int32Array<"u"&&"function"==typeof H.subarray?H.subarray(256*W,256*W+256):H.slice(256*W,256*W+256);return Y}(t),s=i[0],o=i[1],l=i[2],g=i[3],u=i[4],h=i[5],A=i[6],C=i[7],I=i[8],m=i[9],_=i[10],p=i[11],d=i[12],w=i[13],v=i[14];return e.table=t,e.bstr=function S(E,O){for(var L=~O,W=0,H=E.length;W<H;)L=L>>>8^t[255&(L^E.charCodeAt(W++))];return~L},e.buf=function G(E,O){for(var L=~O,W=E.length-15,H=0;H<W;)L=v[E[H++]^255&L]^w[E[H++]^L>>8&255]^d[E[H++]^L>>16&255]^p[E[H++]^L>>>24]^_[E[H++]]^m[E[H++]]^I[E[H++]]^C[E[H++]]^A[E[H++]]^h[E[H++]]^u[E[H++]]^g[E[H++]]^l[E[H++]]^o[E[H++]]^s[E[H++]]^t[E[H++]];for(W+=15;H<W;)L=L>>>8^t[255&(L^E[H++])];return~L},e.str=function X(E,O){for(var L=~O,W=0,H=E.length,Y=0,ee=0;W<H;)(Y=E.charCodeAt(W++))<128?L=L>>>8^t[255&(L^Y)]:Y<2048?L=(L=L>>>8^t[255&(L^(192|Y>>6&31))])>>>8^t[255&(L^(128|63&Y))]:Y>=55296&&Y<57344?(Y=64+(1023&Y),ee=1023&E.charCodeAt(W++),L=(L=(L=(L=L>>>8^t[255&(L^(240|Y>>8&7))])>>>8^t[255&(L^(128|Y>>2&63))])>>>8^t[255&(L^(128|ee>>6&15|(3&Y)<<4))])>>>8^t[255&(L^(128|63&ee))]):L=(L=(L=L>>>8^t[255&(L^(224|Y>>12&15))])>>>8^t[255&(L^(128|Y>>6&63))])>>>8^t[255&(L^(128|63&Y))];return~L},e}(),We=function(){var g,r={};function n(y){if("/"==y.charAt(y.length-1))return-1===y.slice(0,-1).indexOf("/")?y:n(y.slice(0,-1));var R=y.lastIndexOf("/");return-1===R?y:y.slice(0,R+1)}function i(y){if("/"==y.charAt(y.length-1))return i(y.slice(0,-1));var R=y.lastIndexOf("/");return-1===R?y:y.slice(R+1)}function s(y,R){"string"==typeof R&&(R=new Date(R));var b=R.getHours();b=(b=b<<6|R.getMinutes())<<5|R.getSeconds()>>>1,y.write_shift(2,b);var F=R.getFullYear()-1980;F=(F=F<<4|R.getMonth()+1)<<5|R.getDate(),y.write_shift(2,F)}function l(y){er(y,0);for(var R={},b=0;y.l<=y.length-4;){var F=y.read_shift(2),P=y.read_shift(2),M=y.l+P,Q={};switch(F){case 21589:1&(b=y.read_shift(1))&&(Q.mtime=y.read_shift(4)),P>5&&(2&b&&(Q.atime=y.read_shift(4)),4&b&&(Q.ctime=y.read_shift(4))),Q.mtime&&(Q.mt=new Date(1e3*Q.mtime));break;case 1:var ie=y.read_shift(4),K=y.read_shift(4);Q.usz=K*Math.pow(2,32)+ie,ie=y.read_shift(4),K=y.read_shift(4),Q.csz=K*Math.pow(2,32)+ie}y.l=M,R[F]=Q}return R}function u(){return g||(g=_n)}function h(y,R){if(80==y[0]&&75==y[1])return T(y,R);if(109==(32|y[0])&&105==(32|y[1]))return function Er(y,R){if("mime-version:"!=Xe(y.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var b=R&&R.root||"",F=(ft&&Buffer.isBuffer(y)?y.toString("binary"):Xe(y)).split("\r\n"),P=0,M="";for(P=0;P<F.length;++P)if(/^Content-Location:/i.test(M=F[P])&&(M=M.slice(M.indexOf("file")),b||(b=M.slice(0,M.lastIndexOf("/")+1)),M.slice(0,b.length)!=b))for(;b.length>0&&(b=(b=b.slice(0,b.length-1)).slice(0,b.lastIndexOf("/")+1),M.slice(0,b.length)!=b););var Q=(F[1]||"").match(/boundary="(.*?)"/);if(!Q)throw new Error("MAD cannot find boundary");var ie="--"+(Q[1]||""),q={FileIndex:[],FullPaths:[]};E(q);var Ae,_e=0;for(P=0;P<F.length;++P){var Ge=F[P];Ge!==ie&&Ge!==ie+"--"||(_e++&&Be(q,F.slice(Ae,P),b),Ae=P)}return q}(y,R);if(y.length<512)throw new Error("CFB file size "+y.length+" < 512");var b,P,M,Q,ie,K,F=512,Z=[],q=y.slice(0,512);er(q,0);var Ae=function A(y){if(80==y[y.l]&&75==y[y.l+1])return[0,0];y.chk(Te,"Header Signature: "),y.l+=16;var R=y.read_shift(2,"u");return[y.read_shift(2,"u"),R]}(q);switch(b=Ae[0]){case 3:F=512;break;case 4:F=4096;break;case 0:if(0==Ae[1])return T(y,R);default:throw new Error("Major Version: Expected 3 or 4 saw "+b)}512!==F&&er(q=y.slice(0,F),28);var _e=y.slice(0,F);!function C(y,R){var b;switch(y.l+=2,b=y.read_shift(2)){case 9:if(3!=R)throw new Error("Sector Shift: Expected 9 saw "+b);break;case 12:if(4!=R)throw new Error("Sector Shift: Expected 12 saw "+b);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+b)}y.chk("0600","Mini Sector Shift: "),y.chk("000000000000","Reserved: ")}(q,b);var Ge=q.read_shift(4,"i");if(3===b&&0!==Ge)throw new Error("# Directory Sectors: Expected 0 saw "+Ge);q.l+=4,Q=q.read_shift(4,"i"),q.l+=4,q.chk("00100000","Mini Stream Cutoff Size: "),ie=q.read_shift(4,"i"),P=q.read_shift(4,"i"),K=q.read_shift(4,"i"),M=q.read_shift(4,"i");for(var Se=-1,Ie=0;Ie<109&&!((Se=q.read_shift(4,"i"))<0);++Ie)Z[Ie]=Se;var nt=function I(y,R){for(var b=Math.ceil(y.length/R)-1,F=[],P=1;P<b;++P)F[P-1]=y.slice(P*R,(P+1)*R);return F[b-1]=y.slice(b*R),F}(y,F);p(K,M,nt,F,Z);var Et=function w(y,R,b,F){var P=y.length,M=[],Q=[],ie=[],K=[],Z=F-1,q=0,Ae=0,_e=0,Ge=0;for(q=0;q<P;++q)if(ie=[],(_e=q+R)>=P&&(_e-=P),!Q[_e]){K=[];var Se=[];for(Ae=_e;Ae>=0;){Se[Ae]=!0,Q[Ae]=!0,ie[ie.length]=Ae,K.push(y[Ae]);var Ie=b[Math.floor(4*Ae/F)];if(F<4+(Ge=4*Ae&Z))throw new Error("FAT boundary crossed: "+Ae+" 4 "+F);if(!y[Ie]||Se[Ae=Hn(y[Ie],Ge)])break}M[_e]={nodes:ie,data:Cl([K])}}return M}(nt,Q,Z,F);Q<Et.length&&(Et[Q].name="!Directory"),P>0&&ie!==ee&&(Et[ie].name="!MiniFAT"),Et[Z[0]].name="!FAT",Et.fat_addrs=Z,Et.ssz=F;var Kt=[],Ur=[],ba=[];(function v(y,R,b,F,P,M,Q,ie){for(var Ge,K=0,Z=F.length?2:0,q=R[y].data,Ae=0,_e=0;Ae<q.length;Ae+=128){var Se=q.slice(Ae,Ae+128);er(Se,64),_e=Se.read_shift(2),Ge=qa(Se,0,_e-Z),F.push(Ge);var Ie={name:Ge,type:Se.read_shift(1),color:Se.read_shift(1),L:Se.read_shift(4,"i"),R:Se.read_shift(4,"i"),C:Se.read_shift(4,"i"),clsid:Se.read_shift(16),state:Se.read_shift(4,"i"),start:0,size:0};0!==Se.read_shift(2)+Se.read_shift(2)+Se.read_shift(2)+Se.read_shift(2)&&(Ie.ct=S(Se,Se.l-8)),0!==Se.read_shift(2)+Se.read_shift(2)+Se.read_shift(2)+Se.read_shift(2)&&(Ie.mt=S(Se,Se.l-8)),Ie.start=Se.read_shift(4,"i"),Ie.size=Se.read_shift(4,"i"),Ie.size<0&&Ie.start<0&&(Ie.size=Ie.type=0,Ie.start=ee,Ie.name=""),5===Ie.type?(K=Ie.start,P>0&&K!==ee&&(R[K].name="!StreamData")):Ie.size>=4096?(Ie.storage="fat",void 0===R[Ie.start]&&(R[Ie.start]=d(b,Ie.start,R.fat_addrs,R.ssz)),R[Ie.start].name=Ie.name,Ie.content=R[Ie.start].data.slice(0,Ie.size)):(Ie.storage="minifat",Ie.size<0?Ie.size=0:K!==ee&&Ie.start!==ee&&R[K]&&(Ie.content=_(Ie,R[K].data,(R[ie]||{}).data))),Ie.content&&er(Ie.content,0),M[Ge]=Ie,Q.push(Ie)}})(Q,Et,nt,Kt,P,{},Ur,ie),function m(y,R,b){for(var F=0,P=0,M=0,Q=0,ie=0,K=b.length,Z=[],q=[];F<K;++F)Z[F]=q[F]=F,R[F]=b[F];for(;ie<q.length;++ie)P=y[F=q[ie]].L,M=y[F].R,Q=y[F].C,Z[F]===F&&(-1!==P&&Z[P]!==P&&(Z[F]=Z[P]),-1!==M&&Z[M]!==M&&(Z[F]=Z[M])),-1!==Q&&(Z[Q]=F),-1!==P&&F!=Z[F]&&(Z[P]=Z[F],q.lastIndexOf(P)<ie&&q.push(P)),-1!==M&&F!=Z[F]&&(Z[M]=Z[F],q.lastIndexOf(M)<ie&&q.push(M));for(F=1;F<K;++F)Z[F]===F&&(-1!==M&&Z[M]!==M?Z[F]=Z[M]:-1!==P&&Z[P]!==P&&(Z[F]=Z[P]));for(F=1;F<K;++F)if(0!==y[F].type){if((ie=F)!=Z[ie])do{R[F]=R[ie=Z[ie]]+"/"+R[F]}while(0!==ie&&-1!==Z[ie]&&ie!=Z[ie]);Z[F]=-1}for(R[0]+="/",F=1;F<K;++F)2!==y[F].type&&(R[F]+="/")}(Ur,ba,Kt),Kt.shift();var Ea={FileIndex:Ur,FullPaths:ba};return R&&R.raw&&(Ea.raw={header:_e,sectors:nt}),Ea}function _(y,R,b){for(var P=y.size,M=[],Q=y.start;b&&P>0&&Q>=0;)M.push(R.slice(Q*Y,Q*Y+Y)),P-=Y,Q=Hn(b,4*Q);return 0===M.length?J(0):jt(M).slice(0,y.size)}function p(y,R,b,F,P){var M=ee;if(y===ee){if(0!==R)throw new Error("DIFAT chain shorter than expected")}else if(-1!==y){var Q=b[y],ie=(F>>>2)-1;if(!Q)return;for(var K=0;K<ie&&(M=Hn(Q,4*K))!==ee;++K)P.push(M);R>=1&&p(Hn(Q,F-4),R-1,b,F,P)}}function d(y,R,b,F,P){var M=[],Q=[];P||(P=[]);var ie=F-1,K=0,Z=0;for(K=R;K>=0;){P[K]=!0,M[M.length]=K,Q.push(y[K]);var q=b[Math.floor(4*K/F)];if(F<4+(Z=4*K&ie))throw new Error("FAT boundary crossed: "+K+" 4 "+F);if(!y[q])break;K=Hn(y[q],Z)}return{nodes:M,data:Cl([Q])}}function S(y,R){return new Date(1e3*(ar(y,R+4)/1e7*Math.pow(2,32)+ar(y,R)/1e7-11644473600))}function E(y,R){var b=R||{},F=b.root||"Root Entry";if(y.FullPaths||(y.FullPaths=[]),y.FileIndex||(y.FileIndex=[]),y.FullPaths.length!==y.FileIndex.length)throw new Error("inconsistent CFB structure");0===y.FullPaths.length&&(y.FullPaths[0]=F+"/",y.FileIndex[0]={name:F,type:5}),b.CLSID&&(y.FileIndex[0].clsid=b.CLSID),function O(y){var R="\x01Sh33tJ5";if(!We.find(y,"/"+R)){var b=J(4);b[0]=55,b[1]=b[3]=50,b[2]=54,y.FileIndex.push({name:R,type:2,content:b,size:4,L:69,R:69,C:69}),y.FullPaths.push(y.FullPaths[0]+R),L(y)}}(y)}function L(y,R){E(y);for(var b=!1,F=!1,P=y.FullPaths.length-1;P>=0;--P){var M=y.FileIndex[P];switch(M.type){case 0:F?b=!0:(y.FileIndex.pop(),y.FullPaths.pop());break;case 1:case 2:case 5:F=!0,isNaN(M.R*M.L*M.C)&&(b=!0),M.R>-1&&M.L>-1&&M.R==M.L&&(b=!0);break;default:b=!0}}if(b||R){var Q=new Date(1987,1,19),ie=0,K=Object.create?Object.create(null):{},Z=[];for(P=0;P<y.FullPaths.length;++P)K[y.FullPaths[P]]=!0,0!==y.FileIndex[P].type&&Z.push([y.FullPaths[P],y.FileIndex[P]]);for(P=0;P<Z.length;++P){var q=n(Z[P][0]);for(F=K[q];!F;){for(;n(q)&&!K[n(q)];)q=n(q);Z.push([q,{name:i(q).replace("/",""),type:1,clsid:Pe,ct:Q,mt:Q,content:null}]),K[q]=!0,F=K[q=n(Z[P][0])]}}for(Z.sort(function(Ge,Se){return function t(y,R){for(var b=y.split("/"),F=R.split("/"),P=0,M=0,Q=Math.min(b.length,F.length);P<Q;++P){if(M=b[P].length-F[P].length)return M;if(b[P]!=F[P])return b[P]<F[P]?-1:1}return b.length-F.length}(Ge[0],Se[0])}),y.FullPaths=[],y.FileIndex=[],P=0;P<Z.length;++P)y.FullPaths[P]=Z[P][0],y.FileIndex[P]=Z[P][1];for(P=0;P<Z.length;++P){var Ae=y.FileIndex[P],_e=y.FullPaths[P];if(Ae.name=i(_e).replace("/",""),Ae.L=Ae.R=Ae.C=-(Ae.color=1),Ae.size=Ae.content?Ae.content.length:0,Ae.start=0,Ae.clsid=Ae.clsid||Pe,0===P)Ae.C=Z.length>1?1:-1,Ae.size=0,Ae.type=5;else if("/"==_e.slice(-1)){for(ie=P+1;ie<Z.length&&n(y.FullPaths[ie])!=_e;++ie);for(Ae.C=ie>=Z.length?-1:ie,ie=P+1;ie<Z.length&&n(y.FullPaths[ie])!=n(_e);++ie);Ae.R=ie>=Z.length?-1:ie,Ae.type=1}else n(y.FullPaths[P+1]||"")==n(_e)&&(Ae.R=P+1),Ae.type=2}}}function W(y,R){var b=R||{};if("mad"==b.fileType)return function ci(y,R){for(var b=R||{},F=b.boundary||"SheetJS",P=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(F="------="+F).slice(2)+'"',"","",""],M=y.FullPaths[0],Q=M,ie=y.FileIndex[0],K=1;K<y.FullPaths.length;++K)if(Q=y.FullPaths[K].slice(M.length),(ie=y.FileIndex[K]).size&&ie.content&&"\x01Sh33tJ5"!=Q){Q=Q.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(nt){return"_x"+nt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(nt){return"_u"+nt.charCodeAt(0).toString(16)+"_"});for(var Z=ie.content,q=ft&&Buffer.isBuffer(Z)?Z.toString("binary"):Xe(Z),Ae=0,_e=Math.min(1024,q.length),Ge=0,Se=0;Se<=_e;++Se)(Ge=q.charCodeAt(Se))>=32&&Ge<128&&++Ae;var Ie=Ae>=4*_e/5;P.push(F),P.push("Content-Location: "+(b.root||"file:///C:/SheetJS/")+Q),P.push("Content-Transfer-Encoding: "+(Ie?"quoted-printable":"base64")),P.push("Content-Type: "+B(ie,Q)),P.push(""),P.push(Ie?x(q):V(q))}return P.push(F+"--\r\n"),P.join("\r\n")}(y,b);if("zip"===(L(y),b.fileType))return function f(y,R){var b=R||{},F=[],P=[],M=J(1),Q=b.compression?8:0,ie=0,Z=0,q=0,Ae=0,_e=0,Ge=y.FullPaths[0],Se=Ge,Ie=y.FileIndex[0],nt=[],Et=0;for(Z=1;Z<y.FullPaths.length;++Z)if(Se=y.FullPaths[Z].slice(Ge.length),(Ie=y.FileIndex[Z]).size&&Ie.content&&(!Array.isArray(Ie.content)||0!=Ie.content.length)&&"\x01Sh33tJ5"!=Se){var Rr=Ae,Kt=J(Se.length);for(q=0;q<Se.length;++q)Kt.write_shift(1,127&Se.charCodeAt(q));Kt=Kt.slice(0,Kt.l),nt[_e]="string"==typeof Ie.content?X0.bstr(Ie.content,0):X0.buf(Ie.content,0);var Ur="string"==typeof Ie.content?wr(Ie.content):Ie.content;8==Q&&(Ur=Ce(Ur)),(M=J(30)).write_shift(4,67324752),M.write_shift(2,20),M.write_shift(2,ie),M.write_shift(2,Q),Ie.mt?s(M,Ie.mt):M.write_shift(4,0),M.write_shift(-4,8&ie?0:nt[_e]),M.write_shift(4,8&ie?0:Ur.length),M.write_shift(4,8&ie?0:Ie.content.length),M.write_shift(2,Kt.length),M.write_shift(2,0),Ae+=M.length,F.push(M),Ae+=Kt.length,F.push(Kt),Ae+=Ur.length,F.push(Ur),8&ie&&((M=J(12)).write_shift(-4,nt[_e]),M.write_shift(4,Ur.length),M.write_shift(4,Ie.content.length),Ae+=M.l,F.push(M)),(M=J(46)).write_shift(4,33639248),M.write_shift(2,0),M.write_shift(2,20),M.write_shift(2,ie),M.write_shift(2,Q),M.write_shift(4,0),M.write_shift(-4,nt[_e]),M.write_shift(4,Ur.length),M.write_shift(4,Ie.content.length),M.write_shift(2,Kt.length),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(4,0),M.write_shift(4,Rr),Et+=M.l,P.push(M),Et+=Kt.length,P.push(Kt),++_e}return(M=J(22)).write_shift(4,101010256),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,_e),M.write_shift(2,_e),M.write_shift(4,Et),M.write_shift(4,Ae),M.write_shift(2,0),jt([jt(F),jt(P),M])}(y,b);var F=function(Ge){for(var Se=0,Ie=0,nt=0;nt<Ge.FileIndex.length;++nt){var Et=Ge.FileIndex[nt];if(Et.content){var Rr=Et.content.length;Rr>0&&(Rr<4096?Se+=Rr+63>>6:Ie+=Rr+511>>9)}}for(var Kt=Ge.FullPaths.length+3>>2,ba=Se+127>>7,Ea=(Se+7>>3)+Ie+Kt+ba,gi=Ea+127>>7,r0=gi<=109?0:Math.ceil((gi-109)/127);Ea+gi+r0+127>>7>gi;)r0=++gi<=109?0:Math.ceil((gi-109)/127);var En=[1,r0,gi,ba,Kt,Ie,Se,0];return Ge.FileIndex[0].size=Se<<6,En[7]=(Ge.FileIndex[0].start=En[0]+En[1]+En[2]+En[3]+En[4]+En[5])+(En[6]+7>>3),En}(y),P=J(F[7]<<9),M=0,Q=0;for(M=0;M<8;++M)P.write_shift(1,le[M]);for(M=0;M<8;++M)P.write_shift(2,0);for(P.write_shift(2,62),P.write_shift(2,3),P.write_shift(2,65534),P.write_shift(2,9),P.write_shift(2,6),M=0;M<3;++M)P.write_shift(2,0);for(P.write_shift(4,0),P.write_shift(4,F[2]),P.write_shift(4,F[0]+F[1]+F[2]+F[3]-1),P.write_shift(4,0),P.write_shift(4,4096),P.write_shift(4,F[3]?F[0]+F[1]+F[2]-1:ee),P.write_shift(4,F[3]),P.write_shift(-4,F[1]?F[0]-1:ee),P.write_shift(4,F[1]),M=0;M<109;++M)P.write_shift(-4,M<F[2]?F[1]+M:-1);if(F[1])for(Q=0;Q<F[1];++Q){for(;M<236+127*Q;++M)P.write_shift(-4,M<F[2]?F[1]+M:-1);P.write_shift(-4,Q===F[1]-1?ee:Q+1)}var ie=function(Ge){for(Q+=Ge;M<Q-1;++M)P.write_shift(-4,M+1);Ge&&(++M,P.write_shift(-4,ee))};for(Q=M=0,Q+=F[1];M<Q;++M)P.write_shift(-4,ce.DIFSECT);for(Q+=F[2];M<Q;++M)P.write_shift(-4,ce.FATSECT);ie(F[3]),ie(F[4]);for(var K=0,Z=0,q=y.FileIndex[0];K<y.FileIndex.length;++K)(q=y.FileIndex[K]).content&&!((Z=q.content.length)<4096)&&(q.start=Q,ie(Z+511>>9));for(ie(F[6]+7>>3);511&P.l;)P.write_shift(-4,ce.ENDOFCHAIN);for(Q=M=0,K=0;K<y.FileIndex.length;++K)(q=y.FileIndex[K]).content&&(Z=q.content.length)&&!(Z>=4096)&&(q.start=Q,ie(Z+63>>6));for(;511&P.l;)P.write_shift(-4,ce.ENDOFCHAIN);for(M=0;M<F[4]<<2;++M){var Ae=y.FullPaths[M];if(Ae&&0!==Ae.length){q=y.FileIndex[M],0===M&&(q.start=q.size?q.start-1:ee);var _e=0===M&&b.root||q.name;if(_e.length>31&&(console.error("Name "+_e+" will be truncated to "+_e.slice(0,31)),_e=_e.slice(0,31)),Z=2*(_e.length+1),P.write_shift(64,_e,"utf16le"),P.write_shift(2,Z),P.write_shift(1,q.type),P.write_shift(1,q.color),P.write_shift(-4,q.L),P.write_shift(-4,q.R),P.write_shift(-4,q.C),q.clsid)P.write_shift(16,q.clsid,"hex");else for(K=0;K<4;++K)P.write_shift(4,0);P.write_shift(4,q.state||0),P.write_shift(4,0),P.write_shift(4,0),P.write_shift(4,0),P.write_shift(4,0),P.write_shift(4,q.start),P.write_shift(4,q.size),P.write_shift(4,0)}else{for(K=0;K<17;++K)P.write_shift(4,0);for(K=0;K<3;++K)P.write_shift(4,-1);for(K=0;K<12;++K)P.write_shift(4,0)}}for(M=1;M<y.FileIndex.length;++M)if((q=y.FileIndex[M]).size>=4096)if(P.l=q.start+1<<9,ft&&Buffer.isBuffer(q.content))q.content.copy(P,P.l,0,q.size),P.l+=q.size+511&-512;else{for(K=0;K<q.size;++K)P.write_shift(1,q.content[K]);for(;511&K;++K)P.write_shift(1,0)}for(M=1;M<y.FileIndex.length;++M)if((q=y.FileIndex[M]).size>0&&q.size<4096)if(ft&&Buffer.isBuffer(q.content))q.content.copy(P,P.l,0,q.size),P.l+=q.size+63&-64;else{for(K=0;K<q.size;++K)P.write_shift(1,q.content[K]);for(;63&K;++K)P.write_shift(1,0)}if(ft)P.l=P.length;else for(;P.l<P.length;)P.write_shift(1,0);return P}r.version="1.2.2";var Ke,Y=64,ee=-2,Te="d0cf11e0a1b11ae1",le=[208,207,17,224,161,177,26,225],Pe="00000000000000000000000000000000",ce={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ee,FREESECT:-1,HEADER_SIGNATURE:Te,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Pe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Xe(y){for(var R=new Array(y.length),b=0;b<y.length;++b)R[b]=String.fromCharCode(y[b]);return R.join("")}function Ce(y){return Ke?Ke.deflateRawSync(y):lr(y)}for(var y,R,Ue=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ve=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Ne=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],z=typeof Uint8Array<"u",j=z?new Uint8Array(256):[],U=0;U<256;++U)j[U]=(void 0,255&((R=139536&((y=U)<<1|y<<11)|558144&(y<<5|y<<15))>>16|R>>8|R));function ae(y,R){var b=j[255&y];return R<=8?b>>>8-R:(b=b<<8|j[y>>8&255],R<=16?b>>>16-R:(b=b<<8|j[y>>16&255])>>>24-R)}function N(y,R){var b=7&R,F=R>>>3;return(y[F]|(b<=6?0:y[F+1]<<8))>>>b&3}function De(y,R){var b=7&R,F=R>>>3;return(y[F]|(b<=5?0:y[F+1]<<8))>>>b&7}function ge(y,R){var b=7&R,F=R>>>3;return(y[F]|(b<=3?0:y[F+1]<<8))>>>b&31}function He(y,R){var b=7&R,F=R>>>3;return(y[F]|(b<=1?0:y[F+1]<<8))>>>b&127}function et(y,R,b){var F=7&R,P=R>>>3,Q=y[P]>>>F;return b<8-F||(Q|=y[P+1]<<8-F,b<16-F)||(Q|=y[P+2]<<16-F,b<24-F)||(Q|=y[P+3]<<24-F),Q&(1<<b)-1}function Ee(y,R,b){var F=7&R,P=R>>>3;return F<=5?y[P]|=(7&b)<<F:(y[P]|=b<<F&255,y[P+1]=(7&b)>>8-F),R+3}function mt(y,R,b){return y[R>>>3]|=b=(1&b)<<(7&R),R+1}function _t(y,R,b){var P=R>>>3;return y[P]|=255&(b<<=7&R),y[P+1]=b>>>=8,R+8}function Dt(y,R,b){var P=R>>>3;return y[P]|=255&(b<<=7&R),y[P+1]=255&(b>>>=8),y[P+2]=b>>>8,R+16}function Lt(y,R){var b=y.length,F=2*b>R?2*b:R+5,P=0;if(b>=R)return y;if(ft){var M=b0(F);if(y.copy)y.copy(M);else for(;P<y.length;++P)M[P]=y[P];return M}if(z){var Q=new Uint8Array(F);if(Q.set)Q.set(y);else for(;P<b;++P)Q[P]=y[P];return Q}return y.length=F,y}function de(y){for(var R=new Array(y),b=0;b<y;++b)R[b]=0;return R}function xe(y,R,b){var F=1,P=0,M=0,Q=0,ie=0,K=y.length,Z=z?new Uint16Array(32):de(32);for(M=0;M<32;++M)Z[M]=0;for(M=K;M<b;++M)y[M]=0;K=y.length;var q=z?new Uint16Array(K):de(K);for(M=0;M<K;++M)Z[P=y[M]]++,F<P&&(F=P),q[M]=0;for(Z[0]=0,M=1;M<=F;++M)Z[M+16]=ie=ie+Z[M-1]<<1;for(M=0;M<K;++M)0!=(ie=y[M])&&(q[M]=Z[ie+16]++);var Ae=0;for(M=0;M<K;++M)if(0!=(Ae=y[M]))for(ie=ae(q[M],F)>>F-Ae,Q=(1<<F+4-Ae)-1;Q>=0;--Q)R[ie|Q<<Ae]=15&Ae|M<<4;return F}var fr=z?new Uint16Array(512):de(512),Wt=z?new Uint16Array(32):de(32);if(!z){for(var Rt=0;Rt<512;++Rt)fr[Rt]=0;for(Rt=0;Rt<32;++Rt)Wt[Rt]=0}!function(){for(var y=[],R=0;R<32;R++)y.push(5);xe(y,Wt,32);var b=[];for(R=0;R<=143;R++)b.push(8);for(;R<=255;R++)b.push(9);for(;R<=279;R++)b.push(7);for(;R<=287;R++)b.push(8);xe(b,fr,288)}();var Jt=function(){for(var R=z?new Uint8Array(32768):[],b=0,F=0;b<Ne.length-1;++b)for(;F<Ne[b+1];++F)R[F]=b;for(;F<32768;++F)R[F]=29;var P=z?new Uint8Array(259):[];for(b=0,F=0;b<ve.length-1;++b)for(;F<ve[b+1];++F)P[F]=b;return function(K,Z){return K.length<8?function M(ie,K){for(var Z=0;Z<ie.length;){var q=Math.min(65535,ie.length-Z);for(K.write_shift(1,+(Z+q==ie.length)),K.write_shift(2,q),K.write_shift(2,65535&~q);q-- >0;)K[K.l++]=ie[Z++]}return K.l}(K,Z):function Q(ie,K){for(var Z=0,q=0,Ae=z?new Uint16Array(32768):[];q<ie.length;){var _e=Math.min(65535,ie.length-q);if(_e<10){for(7&(Z=Ee(K,Z,+(q+_e==ie.length)))&&(Z+=8-(7&Z)),K.l=Z/8|0,K.write_shift(2,_e),K.write_shift(2,65535&~_e);_e-- >0;)K[K.l++]=ie[q++];Z=8*K.l}else{Z=Ee(K,Z,+(q+_e==ie.length)+2);for(var Ge=0;_e-- >0;){var Se=ie[q],Ie=-1,nt=0;if((Ie=Ae[Ge=32767&(Ge<<5^Se)])&&((Ie|=-32768&q)>q&&(Ie-=32768),Ie<q))for(;ie[Ie+nt]==ie[q+nt]&&nt<250;)++nt;if(nt>2){(Se=P[nt])<=22?Z=_t(K,Z,j[Se+1]>>1)-1:(_t(K,Z,3),_t(K,Z+=5,j[Se-23]>>5),Z+=3);var Et=Se<8?0:Se-4>>2;Et>0&&(Dt(K,Z,nt-ve[Se]),Z+=Et),Z=_t(K,Z,j[Se=R[q-Ie]]>>3),Z-=3;var Rr=Se<4?0:Se-2>>1;Rr>0&&(Dt(K,Z,q-Ie-Ne[Se]),Z+=Rr);for(var Kt=0;Kt<nt;++Kt)Ae[Ge]=32767&q,Ge=32767&(Ge<<5^ie[q]),++q;_e-=nt-1}else Se<=143?Se+=48:Z=mt(K,Z,1),Z=_t(K,Z,j[Se]),Ae[Ge]=32767&q,++q}Z=_t(K,Z,0)-1}}return K.l=(Z+7)/8|0,K.l}(K,Z)}}();function lr(y){var R=J(50+Math.floor(1.1*y.length)),b=Jt(y,R);return R.slice(0,b)}var Je=z?new Uint16Array(32768):de(32768),ze=z?new Uint16Array(32768):de(32768),vt=z?new Uint16Array(128):de(128),bt=1,Pi=1;function ur(y,R){var b=ge(y,R)+257,F=ge(y,R+=5)+1,P=function we(y,R){var b=7&R,F=R>>>3;return(y[F]|(b<=4?0:y[F+1]<<8))>>>b&15}(y,R+=5)+4;R+=4;for(var M=0,Q=z?new Uint8Array(19):de(19),ie=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],K=1,Z=z?new Uint8Array(8):de(8),q=z?new Uint8Array(8):de(8),Ae=Q.length,_e=0;_e<P;++_e)Q[Ue[_e]]=M=De(y,R),K<M&&(K=M),Z[M]++,R+=3;var Ge=0;for(Z[0]=0,_e=1;_e<=K;++_e)q[_e]=Ge=Ge+Z[_e-1]<<1;for(_e=0;_e<Ae;++_e)0!=(Ge=Q[_e])&&(ie[_e]=q[Ge]++);var Se=0;for(_e=0;_e<Ae;++_e)if(0!=(Se=Q[_e])){Ge=j[ie[_e]]>>8-Se;for(var Ie=(1<<7-Se)-1;Ie>=0;--Ie)vt[Ge|Ie<<Se]=7&Se|_e<<3}var nt=[];for(K=1;nt.length<b+F;)switch(Ge=vt[He(y,R)],R+=7&Ge,Ge>>>=3){case 16:for(M=3+N(y,R),R+=2,Ge=nt[nt.length-1];M-- >0;)nt.push(Ge);break;case 17:for(M=3+De(y,R),R+=3;M-- >0;)nt.push(0);break;case 18:for(M=11+He(y,R),R+=7;M-- >0;)nt.push(0);break;default:nt.push(Ge),K<Ge&&(K=Ge)}var Et=nt.slice(0,b),Rr=nt.slice(b);for(_e=b;_e<286;++_e)Et[_e]=0;for(_e=F;_e<30;++_e)Rr[_e]=0;return bt=xe(Et,Je,286),Pi=xe(Rr,ze,30),R}function tt(y,R){var F=function An(y,R){if(3==y[0]&&!(3&y[1]))return[Dn(R),2];for(var b=0,F=0,P=b0(R||1<<18),M=0,Q=P.length>>>0,ie=0,K=0;!(1&F);)if(F=De(y,b),b+=3,F>>>1)for(F>>1==1?(ie=9,K=5):(b=ur(y,b),ie=bt,K=Pi);;){!R&&Q<M+32767&&(Q=(P=Lt(P,M+32767)).length);var q=et(y,b,ie),Ae=F>>>1==1?fr[q]:Je[q];if(b+=15&Ae,(Ae>>>=4)>>>8&255){if(256==Ae)break;var _e=(Ae-=257)<8?0:Ae-4>>2;_e>5&&(_e=0);var Ge=M+ve[Ae];_e>0&&(Ge+=et(y,b,_e),b+=_e),q=et(y,b,K),b+=15&(Ae=F>>>1==1?Wt[q]:ze[q]);var Se=(Ae>>>=4)<4?0:Ae-2>>1,Ie=Ne[Ae];for(Se>0&&(Ie+=et(y,b,Se),b+=Se),!R&&Q<Ge&&(Q=(P=Lt(P,Ge+100)).length);M<Ge;)P[M]=P[M-Ie],++M}else P[M++]=Ae}else{7&b&&(b+=8-(7&b));var Z=y[b>>>3]|y[1+(b>>>3)]<<8;if(b+=32,Z>0)for(!R&&Q<M+Z&&(Q=(P=Lt(P,M+Z)).length);Z-- >0;)P[M++]=y[b>>>3],b+=8}return R?[P,b+7>>>3]:[P.slice(0,M),b+7>>>3]}(y.slice(y.l||0),R);return y.l+=F[1],F[0]}function ye(y,R){if(!y)throw new Error(R);typeof console<"u"&&console.error(R)}function T(y,R){var b=y;er(b,0);var M={FileIndex:[],FullPaths:[]};E(M,{root:R.root});for(var Q=b.length-4;(80!=b[Q]||75!=b[Q+1]||5!=b[Q+2]||6!=b[Q+3])&&Q>=0;)--Q;b.l=Q+4,b.l+=4;var ie=b.read_shift(2);b.l+=6;var K=b.read_shift(4);for(b.l=K,Q=0;Q<ie;++Q){b.l+=20;var Z=b.read_shift(4),q=b.read_shift(4),Ae=b.read_shift(2),_e=b.read_shift(2),Ge=b.read_shift(2);b.l+=8;var Se=b.read_shift(4),Ie=l(b.slice(b.l+Ae,b.l+Ae+_e));b.l+=Ae+_e+Ge;var nt=b.l;b.l=Se+4,Ie&&Ie[1]&&((Ie[1]||{}).usz&&(q=Ie[1].usz),(Ie[1]||{}).csz&&(Z=Ie[1].csz)),c(b,Z,q,M,Ie),b.l=nt}return M}function c(y,R,b,F,P){y.l+=2;var M=y.read_shift(2),Q=y.read_shift(2),ie=function o(y){var R=65535&y.read_shift(2),b=65535&y.read_shift(2),F=new Date,P=31&b,M=15&(b>>>=5);b>>>=4,F.setMilliseconds(0),F.setFullYear(b+1980),F.setMonth(M-1),F.setDate(P);var Q=31&R,ie=63&(R>>>=5);return F.setHours(R>>>=6),F.setMinutes(ie),F.setSeconds(Q<<1),F}(y);if(8257&M)throw new Error("Unsupported ZIP encryption");y.read_shift(4);for(var Z=y.read_shift(4),q=y.read_shift(4),Ae=y.read_shift(2),_e=y.read_shift(2),Ge="",Se=0;Se<Ae;++Se)Ge+=String.fromCharCode(y[y.l++]);if(_e){var Ie=l(y.slice(y.l,y.l+_e));(Ie[21589]||{}).mt&&(ie=Ie[21589].mt),(Ie[1]||{}).usz&&(q=Ie[1].usz),(Ie[1]||{}).csz&&(Z=Ie[1].csz),P&&((P[21589]||{}).mt&&(ie=P[21589].mt),(P[1]||{}).usz&&(q=P[1].usz),(P[1]||{}).csz&&(Z=P[1].csz))}y.l+=_e;var nt=y.slice(y.l,y.l+Z);switch(Q){case 8:nt=function he(y,R){if(!Ke)return tt(y,R);var F=new(0,Ke.InflateRaw),P=F._processChunk(y.slice(y.l),F._finishFlushFlag);return y.l+=F.bytesRead,P}(y,q);break;case 0:y.l+=Z;break;default:throw new Error("Unsupported ZIP Compression method "+Q)}var Et=!1;8&M&&(134695760==y.read_shift(4)&&(y.read_shift(4),Et=!0),Z=y.read_shift(4),q=y.read_shift(4)),Z!=R&&ye(Et,"Bad compressed size: "+R+" != "+Z),q!=b&&ye(Et,"Bad uncompressed size: "+b+" != "+q),t0(F,Ge,nt,{unsafe:!0,mt:ie})}var k={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function B(y,R){if(y.ctype)return y.ctype;var b=y.name||"",F=b.match(/\.([^\.]+)$/);return F&&k[F[1]]||R&&(F=(b=R).match(/[\.\\]([^\.\\])+$/))&&k[F[1]]?k[F[1]]:"application/octet-stream"}function V(y){for(var R=Wa(y),b=[],F=0;F<R.length;F+=76)b.push(R.slice(F,F+76));return b.join("\r\n")+"\r\n"}function x(y){var R=y.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Z){var q=Z.charCodeAt(0).toString(16).toUpperCase();return"="+(1==q.length?"0"+q:q)});"\n"==(R=R.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(R="=0D"+R.slice(1));for(var b=[],F=(R=R.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),P=0;P<F.length;++P){var M=F[P];if(0!=M.length)for(var Q=0;Q<M.length;){var ie=76,K=M.slice(Q,Q+ie);"="==K.charAt(ie-1)?ie--:"="==K.charAt(ie-2)?ie-=2:"="==K.charAt(ie-3)&&(ie-=3),K=M.slice(Q,Q+ie),(Q+=ie)<M.length&&(K+="="),b.push(K)}else b.push("")}return b.join("\r\n")}function Be(y,R,b){for(var Q,F="",P="",M="",ie=0;ie<10;++ie){var K=R[ie];if(!K||K.match(/^\s*$/))break;var Z=K.match(/^([^:]*?):\s*([^\s].*)$/);if(Z)switch(Z[1].toLowerCase()){case"content-location":F=Z[2].trim();break;case"content-type":M=Z[2].trim();break;case"content-transfer-encoding":P=Z[2].trim()}}switch(++ie,P.toLowerCase()){case"base64":Q=wr(Br(R.slice(ie).join("")));break;case"quoted-printable":Q=function te(y){for(var R=[],b=0;b<y.length;++b){for(var F=y[b];b<=y.length&&"="==F.charAt(F.length-1);)F=F.slice(0,F.length-1)+y[++b];R.push(F)}for(var P=0;P<R.length;++P)R[P]=R[P].replace(/[=][0-9A-Fa-f]{2}/g,function(M){return String.fromCharCode(parseInt(M.slice(1),16))});return wr(R.join("\r\n"))}(R.slice(ie));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+P)}var q=t0(y,F.slice(b.length),Q,{unsafe:!0});M&&(q.ctype=M)}function t0(y,R,b,F){var P=F&&F.unsafe;P||E(y);var M=!P&&We.find(y,R);if(!M){var Q=y.FullPaths[0];R.slice(0,Q.length)==Q?Q=R:("/"!=Q.slice(-1)&&(Q+="/"),Q=(Q+R).replace("//","/")),M={name:i(R),type:2},y.FileIndex.push(M),y.FullPaths.push(Q),P||We.utils.cfb_gc(y)}return M.content=b,M.size=b?b.length:0,F&&(F.CLSID&&(M.clsid=F.CLSID),F.mt&&(M.mt=F.mt),F.ct&&(M.ct=F.ct)),M}return r.find=function H(y,R){var b=y.FullPaths.map(function(K){return K.toUpperCase()}),F=b.map(function(K){var Z=K.split("/");return Z[Z.length-("/"==K.slice(-1)?2:1)]}),P=!1;47===R.charCodeAt(0)?(P=!0,R=b[0].slice(0,-1)+R):P=-1!==R.indexOf("/");var M=R.toUpperCase(),Q=!0===P?b.indexOf(M):F.indexOf(M);if(-1!==Q)return y.FileIndex[Q];var ie=!M.match(Wi);for(M=M.replace(yr,""),ie&&(M=M.replace(Wi,"!")),Q=0;Q<b.length;++Q)if((ie?b[Q].replace(Wi,"!"):b[Q]).replace(yr,"")==M||(ie?F[Q].replace(Wi,"!"):F[Q]).replace(yr,"")==M)return y.FileIndex[Q];return null},r.read=function X(y,R){var b=R&&R.type;switch(b||ft&&Buffer.isBuffer(y)&&(b="buffer"),b||"base64"){case"file":return function G(y,R){return u(),h(g.readFileSync(y),R)}(y,R);case"base64":return h(wr(Br(y)),R);case"binary":return h(wr(y),R)}return h(y,R)},r.parse=h,r.write=function ue(y,R){var b=W(y,R);switch(R&&R.type||"buffer"){case"file":return u(),g.writeFileSync(R.filename,b),b;case"binary":return"string"==typeof b?b:Xe(b);case"base64":return Wa("string"==typeof b?b:Xe(b));case"buffer":if(ft)return Buffer.isBuffer(b)?b:an(b);case"array":return"string"==typeof b?wr(b):b}return b},r.writeFile=function Re(y,R,b){u();var F=W(y,b);g.writeFileSync(R,F)},r.utils={cfb_new:function e0(y){var R={};return E(R,y),R},cfb_add:t0,cfb_del:function qy(y,R){E(y);var b=We.find(y,R);if(b)for(var F=0;F<y.FileIndex.length;++F)if(y.FileIndex[F]==b)return y.FileIndex.splice(F,1),y.FullPaths.splice(F,1),!0;return!1},cfb_mov:function eT(y,R,b){E(y);var F=We.find(y,R);if(F)for(var P=0;P<y.FileIndex.length;++P)if(y.FileIndex[P]==F)return y.FileIndex[P].name=i(b),y.FullPaths[P]=b,!0;return!1},cfb_gc:function tT(y){L(y,!0)},ReadShift:Zi,CheckField:Tl,prep_blob:er,bconcat:jt,use_zlib:function re(y){try{var b=new(0,y.InflateRaw);if(b._processChunk(new Uint8Array([3,0]),b._finishFlushFlag),!b.bytesRead)throw new Error("zlib does not expose bytesRead");Ke=y}catch(F){console.error("cannot use native zlib: "+(F.message||F))}},_deflateRaw:lr,_inflateRaw:tt,consts:ce},r}();function z0(e){return"string"==typeof e?$i(e):Array.isArray(e)?function zA(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}(e):e}function zi(e,r,t){if(typeof _n<"u"&&_n.writeFileSync)return t?_n.writeFileSync(e,r,t):_n.writeFileSync(e,r);if(typeof Deno<"u"){if(t&&"string"==typeof r)switch(t){case"utf8":r=new TextEncoder(t).encode(r);break;case"binary":r=$i(r);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(e,r)}var n="utf8"==t?cn(r):r;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var i=new Blob([z0(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if("object"==typeof chrome&&"function"==typeof(chrome.downloads||{}).download)return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var o=document.createElement("a");if(null!=o.download)return o.download=e,o.href=s,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}else if(typeof URL<"u"&&!URL.createObjectURL&&"object"==typeof chrome){var l="data:application/octet-stream;base64,"+function XA(e){for(var r="",t=0,n=0,i=0,s=0,o=0,l=0,g=0,u=0;u<e.length;)s=(t=e[u++])>>2,o=(3&t)<<4|(n=e[u++])>>4,l=(15&n)<<2|(i=e[u++])>>6,g=63&i,isNaN(n)?l=g=64:isNaN(i)&&(g=64),r+=hr.charAt(s)+hr.charAt(o)+hr.charAt(l)+hr.charAt(g);return r}(new Uint8Array(z0(n)));return chrome.downloads.download({url:l,filename:e,saveAs:!0})}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var g=File(e);return g.open("w"),g.encoding="binary",Array.isArray(r)&&(r=sn(r)),g.write(r),g.close(),r}catch(u){if(!u.message||-1==u.message.indexOf("onstruct"))throw u}throw new Error("cannot save file "+e)}function Ft(e){for(var r=Object.keys(e),t=[],n=0;n<r.length;++n)Object.prototype.hasOwnProperty.call(e,r[n])&&t.push(r[n]);return t}function H0(e,r){for(var t=[],n=Ft(e),i=0;i!==n.length;++i)null==t[e[n[i]][r]]&&(t[e[n[i]][r]]=n[i]);return t}function Ja(e){for(var r=[],t=Ft(e),n=0;n!==t.length;++n)r[e[t[n]]]=t[n];return r}function Hi(e){for(var r=[],t=Ft(e),n=0;n!==t.length;++n)r[e[t[n]]]=parseInt(t[n],10);return r}var Y0=Date.UTC(1899,11,30,0,0,0),vp=Date.UTC(1899,11,31,0,0,0),kp=Date.UTC(1904,0,1,0,0,0);function Ot(e,r){var n=(e.getTime()-Y0)/864e5;return r?(n-=1462)<-1402?n-1:n:n<60?n-1:n}function xn(e){if(e>=60&&e<61)return e;var r=new Date;return r.setTime(24*(e>60?e:e+1)*60*60*1e3+Y0),r}function wp(e){var r=0,t=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(t=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":t*=24;case"H":t*=60;case"M":if(!n)throw new Error("Unsupported ISO Duration Field: M");t*=60}r+=t*parseInt(i[s],10)}return r}var yp=/^(\d+):(\d+)(:\d+)?(\.\d+)?$/,Tp=/^(\d+)-(\d+)-(\d+)$/,J0=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)?(\.\d+)?$/;function Pt(e,r){if(e instanceof Date)return e;var t=e.match(yp);return t?new Date((r?kp:vp)+1e3*(60*(60*parseInt(t[1],10)+parseInt(t[2],10))+(t[3]?parseInt(t[3].slice(1),10):0))+(t[4]?parseInt((t[4]+"000").slice(1,4),10):0)):(t=e.match(Tp))?new Date(Date.UTC(+t[1],+t[2]-1,+t[3],0,0,0,0)):(t=e.match(J0))?new Date(Date.UTC(+t[1],+t[2]-1,+t[3],+t[4],+t[5],t[6]&&parseInt(t[6].slice(1),10)||0,t[7]&&parseInt((t[7]+"0000").slice(1,4),10)||0)):new Date(e)}function Vn(e,r){if(ft&&Buffer.isBuffer(e)){if(r&&Vi){if(255==e[0]&&254==e[1])return cn(e.slice(2).toString("utf16le"));if(254==e[1]&&255==e[2])return cn(T0(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(r){if(255==e[0]&&254==e[1])return cn(new TextDecoder("utf-16le").decode(e.slice(2)));if(254==e[0]&&255==e[1])return cn(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"\u20ac":"\x80","\u201a":"\x82",\u0192:"\x83","\u201e":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87",\u02c6:"\x88","\u2030":"\x89",\u0160:"\x8a","\u2039":"\x8b",\u0152:"\x8c",\u017d:"\x8e","\u2018":"\x91","\u2019":"\x92","\u201c":"\x93","\u201d":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02dc":"\x98","\u2122":"\x99",\u0161:"\x9a","\u203a":"\x9b",\u0153:"\x9c",\u017e:"\x9e",\u0178:"\x9f"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[\u20ac\u201a\u0192\u201e\u2026\u2020\u2021\u02c6\u2030\u0160\u2039\u0152\u017d\u2018\u2019\u201c\u201d\u2022\u2013\u2014\u02dc\u2122\u0161\u203a\u0153\u017e\u0178]/g,function(s){return t[s]||s})}catch{}var n=[],i=0;try{for(i=0;i<e.length-65536;i+=65536)n.push(String.fromCharCode.apply(0,e.slice(i,i+65536)));n.push(String.fromCharCode.apply(0,e.slice(i)))}catch{try{for(;i<e.length-16384;i+=16384)n.push(String.fromCharCode.apply(0,e.slice(i,i+16384)));n.push(String.fromCharCode.apply(0,e.slice(i)))}catch{for(;i!=e.length;++i)n.push(String.fromCharCode(e[i]))}}return n.join("")}function xt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var r={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=xt(e[t]));return r}function dt(e,r){for(var t="";t.length<r;)t+=e;return t}function Lr(e){var r=Number(e);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(e))return r;var t=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return isNaN(r=Number(n))&&(n=n.replace(/[(]([^()]*)[)]/,function(i,s){return t=-t,s}),isNaN(r=Number(n)))?r:r/t}var Sp=/^(0?\d|1[0-2])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))\s+([ap])m?$/,bp=/^([01]?\d|2[0-3])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))$/,Ep=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)(\.\d+)?[Z]?$/,Fp=-177984e5==new Date("6/9/69 00:00 UTC").valueOf(),Pp=["january","february","march","april","may","june","july","august","september","october","november","december"];function Yi(e){if(Ep.test(e))return-1==e.indexOf("Z")?Ka(new Date(e)):new Date(e);var r=e.toLowerCase(),t=r.replace(/\s+/g," ").trim(),n=t.match(Sp);if(n)return function Dp(e){return e[2]?e[3]?e[4]?new Date(Date.UTC(1899,11,31,+e[1]%12+("p"==e[7]?12:0),+e[2],+e[4],1e3*parseFloat(e[3]))):new Date(Date.UTC(1899,11,31,"p"==e[7]?12:0,+e[1],+e[2],1e3*parseFloat(e[3]))):e[5]?new Date(Date.UTC(1899,11,31,+e[1]%12+("p"==e[7]?12:0),+e[2],+e[5],e[6]?1e3*parseFloat(e[6]):0)):new Date(Date.UTC(1899,11,31,+e[1]%12+("p"==e[7]?12:0),+e[2],0,0)):new Date(Date.UTC(1899,11,31,+e[1]%12+("p"==e[7]?12:0),0,0,0))}(n);if(n=t.match(bp))return function Np(e){return e[2]?e[3]?e[4]?new Date(Date.UTC(1899,11,31,+e[1],+e[2],+e[4],1e3*parseFloat(e[3]))):new Date(Date.UTC(1899,11,31,0,+e[1],+e[2],1e3*parseFloat(e[3]))):e[5]?new Date(Date.UTC(1899,11,31,+e[1],+e[2],+e[5],e[6]?1e3*parseFloat(e[6]):0)):new Date(Date.UTC(1899,11,31,+e[1],+e[2],0,0)):new Date(Date.UTC(1899,11,31,+e[1],0,0,0))}(n);if(n=t.match(J0))return new Date(Date.UTC(+n[1],+n[2]-1,+n[3],+n[4],+n[5],n[6]&&parseInt(n[6].slice(1),10)||0,n[7]&&parseInt((n[7]+"0000").slice(1,4),10)||0));var i=new Date(Fp&&-1==e.indexOf("UTC")?e+" UTC":e),s=new Date(NaN),o=i.getYear(),g=(i.getMonth(),i.getDate());if(isNaN(g))return s;if(r.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((r=r.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==Pp.indexOf(r))return s}else if(r.replace(/[ap]m?/,"").match(/[a-z]/))return s;return o<0||o>8099||e.match(/[^-0-9:,\/\\\ ]/)?s:i}var Rp=function(){var e=5=="abacaba".split(/(:?b)/i).length;return function(t,n,i){if(e||"string"==typeof n)return t.split(n);for(var s=t.split(n),o=[s[0]],l=1;l<s.length;++l)o.push(i),o.push(s[l]);return o}}();function $n(e){return new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds())}function Ka(e){return new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()))}function Ls(e){var t=e.slice(0,1024).indexOf("<!DOCTYPE");if(-1==t)return e;var n=e.match(/<[\w]/);return n?e.slice(0,t)+e.slice(n.index):e}function Us(e,r,t){for(var n=[],i=e.indexOf(r);i>-1;){var s=e.indexOf(t,i+r.length);if(-1==s)break;n.push(e.slice(i,s+t.length)),i=e.indexOf(r,s+t.length)}return n.length>0?n:null}function Ji(e,r,t){var n=[],i=0,s=e.indexOf(r);if(-1==s)return e;for(;s>-1;){n.push(e.slice(i,s));var o=e.indexOf(t,s+r.length);if(-1==o)break;-1==(s=e.indexOf(r,i=o+t.length))&&n.push(e.slice(i))}return n.join("")}var Op={" ":1,"\t":1,"\r":1,"\n":1,">":1};function Wn(e,r){for(var t=e.indexOf("<"+r),n=r.length+1,i=e.length;t>=0&&t<=i-n&&!Op[e.charAt(t+n)];)t=e.indexOf("<"+r,t+1);if(-1===t)return null;var s=e.indexOf(">",t+r.length);if(-1===s)return null;var o="</"+r+">",l=e.indexOf(o,s);return-1==l?null:[e.slice(t,l+o.length),e.slice(s+1,l)]}var ir=function(){var e={};return function(t,n){var i=e[n];i||(e[n]=i=[new RegExp("<(?:\\w+:)?"+n+"\\b[^<>]*>","g"),new RegExp("</(?:\\w+:)?"+n+">","g")]),i[0].lastIndex=i[1].lastIndex=0;var s=i[0].exec(t);if(!s)return null;var o=s.index,l=i[0].lastIndex;if(i[1].lastIndex=i[0].lastIndex,!(s=i[1].exec(t)))return null;var g=s.index;return[t.slice(o,i[1].lastIndex),t.slice(l,g)]}}(),K0=function(){var e={};return function(t,n){var o,i=[],s=e[n];for(s||(e[n]=s=[new RegExp("<(?:\\w+:)?"+n+"\\b[^<>]*>","g"),new RegExp("</(?:\\w+:)?"+n+">","g")]),s[0].lastIndex=s[1].lastIndex=0;o=s[0].exec(t);){var l=o.index;if(s[1].lastIndex=s[0].lastIndex,!(o=s[1].exec(t)))return null;i.push(t.slice(l,s[1].lastIndex)),s[0].lastIndex=s[1].lastIndex}return 0==i.length?null:i}}(),Bp=function(){var e={};return function(t,n){var i=[],s=e[n];s||(e[n]=s=[new RegExp("<(?:\\w+:)?"+n+"\\b[^<>]*>","g"),new RegExp("</(?:\\w+:)?"+n+">","g")]),s[0].lastIndex=s[1].lastIndex=0;for(var o,l=0,g=0;o=s[0].exec(t);){if(i.push(t.slice(g,l=o.index)),g=l,s[1].lastIndex=s[0].lastIndex,!(o=s[1].exec(t)))return null;g=s[1].lastIndex,s[0].lastIndex=s[1].lastIndex}return i.push(t.slice(g)),0==i.length?"":i.join("")}}(),Mp=function(){var e={};return function(t,n){var o,i=[],s=e[n];for(s||(e[n]=s=[new RegExp("<"+n+"\\b[^<>]*>","ig"),new RegExp("</"+n+">","ig")]),s[0].lastIndex=s[1].lastIndex=0;o=s[0].exec(t);){var l=o.index;if(s[1].lastIndex=s[0].lastIndex,!(o=s[1].exec(t)))return null;i.push(t.slice(l,s[1].lastIndex)),s[0].lastIndex=s[1].lastIndex}return 0==i.length?null:i}}();function Z0(e){return e?e.content&&e.type?Vn(e.content,!0):e.data?Ci(e.data):e.asNodeBuffer&&ft?Ci(e.asNodeBuffer().toString("binary")):e.asBinary?Ci(e.asBinary()):e._data&&e._data.getContent?Ci(Vn(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Q0(e){if(!e)return null;if(e.data)return $a(e.data);if(e.asNodeBuffer&&ft)return e.asNodeBuffer();if(e._data&&e._data.getContent){var r=e._data.getContent();return"string"==typeof r?$a(r):Array.prototype.slice.call(r)}return e.content&&e.type?e.content:null}function Wr(e,r){for(var t=e.FullPaths||Ft(e.files),n=r.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<t.length;++s){var o=t[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||i==o)return e.files?e.files[t[s]]:e.FileIndex[s]}return null}function Gs(e,r){var t=Wr(e,r);if(null==t)throw new Error("Cannot find file "+r+" in zip");return t}function Xt(e,r,t){if(!t)return function Lp(e){return e&&".bin"===e.name.slice(-4)?Q0(e):Z0(e)}(Gs(e,r));if(!r)return null;try{return Xt(e,r)}catch{return null}}function Sr(e,r,t){if(!t)return Z0(Gs(e,r));if(!r)return null;try{return Sr(e,r)}catch{return null}}function q0(e,r,t){if(!t)return Q0(Gs(e,r));if(!r)return null;try{return q0(e,r)}catch{return null}}function el(e){for(var r=e.FullPaths||Ft(e.files),t=[],n=0;n<r.length;++n)"/"!=r[n].slice(-1)&&t.push(r[n].replace(/^Root Entry[\/]/,""));return t.sort()}function at(e,r,t){if(e.FullPaths){var n;if(Array.isArray(t)&&"string"==typeof t[0]&&(t=t.join("")),"string"==typeof t)return n=ft?an(t):function HA(e){for(var r=[],t=0,n=e.length+250,i=Dn(e.length+255),s=0;s<e.length;++s){var o=e.charCodeAt(s);if(o<128)i[t++]=o;else if(o<2048)i[t++]=192|o>>6&31,i[t++]=128|63&o;else if(o>=55296&&o<57344){o=64+(1023&o);var l=1023&e.charCodeAt(++s);i[t++]=240|o>>8&7,i[t++]=128|o>>2&63,i[t++]=128|l>>6&15|(3&o)<<4,i[t++]=128|63&l}else i[t++]=224|o>>12&15,i[t++]=128|o>>6&63,i[t++]=128|63&o;t>n&&(r.push(i.slice(0,t)),t=0,i=Dn(65535),n=65530)}return r.push(i.slice(0,t)),jt(r)}(t),We.utils.cfb_add(e,r,n);We.utils.cfb_add(e,r,t)}else e.file(r,t)}function js(){return We.utils.cfb_new()}function tl(e,r){switch(r.type){case"base64":return We.read(e,{type:"base64"});case"binary":return We.read(e,{type:"binary"});case"buffer":case"array":return We.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+r.type)}function di(e,r){if("/"==e.charAt(0))return e.slice(1);var t=r.split("/");"/"!=r.slice(-1)&&t.pop();for(var n=e.split("/");0!==n.length;){var i=n.shift();".."===i?t.pop():"."!==i&&t.push(i)}return t.join("/")}var Bt='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',rl=/\s([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,nl=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?<>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'"<>\s=]+))*\s*[\/\?]?>/gm,cr=Bt.match(nl)?nl:/<[^<>]*>/g,Gp=/<\w*:/,jp=/<(\/?)\w+:/;function Me(e,r,t){for(var n={},i=0,s=0;i!==e.length&&32!==(s=e.charCodeAt(i))&&10!==s&&13!==s;++i);if(r||(n[0]=e.slice(0,i)),i===e.length)return n;var o=e.match(rl),l=0,g="",u=0,h="",A="",C=1;if(o)for(u=0;u!=o.length;++u){for(A=o[u].slice(1),s=0;s!=A.length&&61!==A.charCodeAt(s);++s);for(h=A.slice(0,s).trim();32==A.charCodeAt(s+1);)++s;for(C=34==(i=A.charCodeAt(s+1))||39==i?1:0,g=A.slice(s+1+C,A.length-C),l=0;l!=h.length&&58!==h.charCodeAt(l);++l);if(l===h.length)h.indexOf("_")>0&&(h=h.slice(0,h.indexOf("_"))),n[h]=g,t||(n[h.toLowerCase()]=g);else{var I=(5===l&&"xmlns"===h.slice(0,5)?"xmlns":"")+h.slice(l+1);if(n[I]&&"ext"==h.slice(l-3,l))continue;n[I]=g,t||(n[I.toLowerCase()]=g)}}return n}function Vp(e,r,t){for(var n={},i=0,s=0;i!==e.length&&32!==(s=e.charCodeAt(i))&&10!==s&&13!==s;++i);if(r||(n[0]=e.slice(0,i)),i===e.length)return n;var o=e.match(rl),g="",u=0,h="",A="",C=1;if(o)for(u=0;u!=o.length;++u){for(A=o[u].slice(1),s=0;s!=A.length&&61!==A.charCodeAt(s);++s);for(h=A.slice(0,s).trim();32==A.charCodeAt(s+1);)++s;C=34==(i=A.charCodeAt(s+1))||39==i?1:0,g=A.slice(s+1+C,A.length-C),h.indexOf("_")>0&&(h=h.slice(0,h.indexOf("_"))),n[h]=g,t||(n[h.toLowerCase()]=g)}return n}function Xr(e){return e.replace(jp,"<$1")}var il={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Vs=Ja(il),pt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,r=/_x([\da-fA-F]{4})_/gi;function t(n){var i=n+"",s=i.indexOf("<![CDATA[");if(-1==s)return i.replace(e,function(l,g){return il[l]||String.fromCharCode(parseInt(g,l.indexOf("x")>-1?16:10))||l}).replace(r,function(l,g){return String.fromCharCode(parseInt(g,16))});var o=i.indexOf("]]>");return t(i.slice(0,s))+i.slice(s+9,o)+t(i.slice(o+3))}return function(i,s){var o=t(i);return s?o.replace(/\r\n/g,"\n"):o}}(),$s=/[&<>'"]/g,$p=/[\u0000-\u0008\u000b-\u001f\uFFFE-\uFFFF]/g;function st(e){return(e+"").replace($s,function(t){return Vs[t]}).replace($p,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function al(e){return st(e).replace(/ /g,"_x0020_")}var sl=/[\u0000-\u001f]/g;function Ki(e){return(e+"").replace($s,function(t){return Vs[t]}).replace(/\n/g,"<br/>").replace(sl,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}var ol=function(){var e=/&#(\d+);/g;function r(t,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,r)}}();function kt(e){switch(e){case 1:case!0:case"1":case"true":return!0;case 0:case!1:case"0":case"false":return!1}return!1}function Ws(e){for(var r="",t=0,n=0,i=0,s=0,o=0,l=0;t<e.length;)(n=e.charCodeAt(t++))<128?r+=String.fromCharCode(n):(i=e.charCodeAt(t++),n>191&&n<224?(o=(31&n)<<6,o|=63&i,r+=String.fromCharCode(o)):(s=e.charCodeAt(t++),n<240?r+=String.fromCharCode((15&n)<<12|(63&i)<<6|63&s):(l=((7&n)<<18|(63&i)<<12|(63&s)<<6|63&(o=e.charCodeAt(t++)))-65536,r+=String.fromCharCode(55296+(l>>>10&1023)),r+=String.fromCharCode(56320+(1023&l)))));return r}function ll(e){var t,n,l,r=Dn(2*e.length),i=1,s=0,o=0;for(n=0;n<e.length;n+=i)i=1,(l=e.charCodeAt(n))<128?t=l:l<224?(t=64*(31&l)+(63&e.charCodeAt(n+1)),i=2):l<240?(t=4096*(15&l)+64*(63&e.charCodeAt(n+1))+(63&e.charCodeAt(n+2)),i=3):(i=4,t=262144*(7&l)+4096*(63&e.charCodeAt(n+1))+64*(63&e.charCodeAt(n+2))+(63&e.charCodeAt(n+3)),o=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==o&&(r[s++]=255&o,r[s++]=o>>>8,o=0),r[s++]=t%256,r[s++]=t>>>8;return r.slice(0,s).toString("ucs2")}function cl(e){return an(e,"binary").toString("utf8")}var Za="foo bar baz\xe2\x98\x83\xf0\x9f\x8d\xa3",yt=ft&&(cl(Za)==Ws(Za)&&cl||ll(Za)==Ws(Za)&&ll)||Ws,cn=ft?function(e){return an(e,"utf8").toString("binary")}:function(e){for(var r=[],t=0,n=0,i=0;t<e.length;)switch(n=e.charCodeAt(t++),!0){case n<128:r.push(String.fromCharCode(n));break;case n<2048:r.push(String.fromCharCode(192+(n>>6))),r.push(String.fromCharCode(128+(63&n)));break;case n>=55296&&n<57344:n-=55296,i=e.charCodeAt(t++)-56320+(n<<10),r.push(String.fromCharCode(240+(i>>18&7))),r.push(String.fromCharCode(144+(i>>12&63))),r.push(String.fromCharCode(128+(i>>6&63))),r.push(String.fromCharCode(128+(63&i)));break;default:r.push(String.fromCharCode(224+(n>>12))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(63&n)))}return r.join("")},gl=function(){var e=[["nbsp"," "],["middot","\xb7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(t){for(var n=t.replace(/^[\t\n\r ]+/,"").replace(/(^|[^\t\n\r ])[\t\n\r ]+$/,"$1").replace(/>\s+/g,">").replace(/\b\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^<>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),zp=/<\/?(?:vt:)?variant>/g,Hp=/<(?:vt:)([^<"'>]*)>([\s\S]*)</;function fl(e,r){var t=Me(e),n=K0(e,t.baseType)||[],i=[];if(n.length!=t.size){if(r.WTF)throw new Error("unexpected vector length "+n.length+" != "+t.size);return i}return n.forEach(function(s){var o=s.replace(zp,"").match(Hp);o&&i.push({v:yt(o[2]),t:o[1]})}),i}var ul=/(^\s|\s$|\n)/;function gr(e,r){return"<"+e+(r.match(ul)?' xml:space="preserve"':"")+">"+r+"</"+e+">"}function Xn(e){return Ft(e).map(function(r){return" "+r+'="'+e[r]+'"'}).join("")}function pe(e,r,t){return"<"+e+(null!=t?Xn(t):"")+(null!=r?(r.match(ul)?' xml:space="preserve"':"")+">"+r+"</"+e:"/")+">"}function Xs(e,r){try{return e.toISOString().replace(/\.\d*/,"")}catch(t){if(r)throw t}return""}function Qa(e){if(ft&&Buffer.isBuffer(e))return e.toString("utf8");if("string"==typeof e)return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return yt(sn(Ps(e)));throw new Error("Bad input format: expected Buffer or string")}var zt=/<([\/]?)([^\s?><!\/:"]*:|)([^\s?<>:\/"]+)(?:\s+[^<>=?"'\s]+="[^"]*?")*\s*[\/]?>/gm,Qt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},zn=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],qt={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"},hl=function(e){for(var r=[],n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,s=e[0][n].length;i<s;i+=10240)r.push.apply(r,e[0][n].slice(i,i+10240));return r},Cl=ft?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(r){return Buffer.isBuffer(r)?r:an(r)})):hl(e)}:hl,Il=function(e,r,t){for(var n=[],i=r;i<t;i+=2)n.push(String.fromCharCode(vn(e,i)));return n.join("").replace(yr,"")},qa=ft?function(e,r,t){return Buffer.isBuffer(e)&&Vi?e.toString("utf16le",r,t).replace(yr,""):Il(e,r,t)}:Il,Al=function(e,r,t){for(var n=[],i=r;i<r+t;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},pl=ft?function(e,r,t){return Buffer.isBuffer(e)?e.toString("hex",r,r+t):Al(e,r,t)}:Al,dl=function(e,r,t){for(var n=[],i=r;i<t;i++)n.push(String.fromCharCode(_i(e,i)));return n.join("")},mi=ft?function(r,t,n){return Buffer.isBuffer(r)?r.toString("utf8",t,n):dl(r,t,n)}:dl,ml=function(e,r){var t=ar(e,r);return t>0?mi(e,r+4,r+4+t-1):""},zs=ml,_l=function(e,r){var t=ar(e,r);return t>0?mi(e,r+4,r+4+t-1):""},Hs=_l,xl=function(e,r){var t=2*ar(e,r);return t>0?mi(e,r+4,r+4+t-1):""},Ys=xl,vl=function(r,t){var n=ar(r,t);return n>0?qa(r,t+4,t+4+n):""},Js=vl,kl=function(e,r){var t=ar(e,r);return t>0?mi(e,r+4,r+4+t):""},Ks=kl,wl=function(e,r){return function Jp(e,r){for(var t=1-2*(e[r+7]>>>7),n=((127&e[r+7])<<4)+(e[r+6]>>>4&15),i=15&e[r+6],s=5;s>=0;--s)i=256*i+e[r+s];return 2047==n?0==i?t*(1/0):NaN:(0==n?n=-1022:(n-=1023,i+=Math.pow(2,52)),t*Math.pow(2,n-52)*i)}(e,r)},es=wl,Zs=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};ft&&(zs=function(r,t){if(!Buffer.isBuffer(r))return ml(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},Hs=function(r,t){if(!Buffer.isBuffer(r))return _l(r,t);var n=r.readUInt32LE(t);return n>0?r.toString("utf8",t+4,t+4+n-1):""},Ys=function(r,t){if(!Buffer.isBuffer(r)||!Vi)return xl(r,t);var n=2*r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n-1)},Js=function(r,t){if(!Buffer.isBuffer(r)||!Vi)return vl(r,t);var n=r.readUInt32LE(t);return r.toString("utf16le",t+4,t+4+n)},Ks=function(r,t){if(!Buffer.isBuffer(r))return kl(r,t);var n=r.readUInt32LE(t);return r.toString("utf8",t+4,t+4+n)},es=function(r,t){return Buffer.isBuffer(r)?r.readDoubleLE(t):wl(r,t)},Zs=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array}),typeof gt<"u"&&function yl(){qa=function(e,r,t){return gt.utils.decode(1200,e.slice(r,t)).replace(yr,"")},mi=function(e,r,t){return gt.utils.decode(65001,e.slice(r,t))},zs=function(e,r){var t=ar(e,r);return t>0?gt.utils.decode(Un,e.slice(r+4,r+4+t-1)):""},Hs=function(e,r){var t=ar(e,r);return t>0?gt.utils.decode(Zt,e.slice(r+4,r+4+t-1)):""},Ys=function(e,r){var t=2*ar(e,r);return t>0?gt.utils.decode(1200,e.slice(r+4,r+4+t-1)):""},Js=function(e,r){var t=ar(e,r);return t>0?gt.utils.decode(1200,e.slice(r+4,r+4+t)):""},Ks=function(e,r){var t=ar(e,r);return t>0?gt.utils.decode(65001,e.slice(r+4,r+4+t)):""}}();var _i=function(e,r){return e[r]},vn=function(e,r){return 256*e[r+1]+e[r]},Zp=function(e,r){var t=256*e[r+1]+e[r];return t<32768?t:-1*(65535-t+1)},ar=function(e,r){return e[r+3]*(1<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r]},Hn=function(e,r){return e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]},Qp=function(e,r){return e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]};function Zi(e,r){var n,i,o,l,g,u,t="",s=[];switch(r){case"dbcs":if(u=this.l,ft&&Buffer.isBuffer(this)&&Vi)t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(g=0;g<e;++g)t+=String.fromCharCode(vn(this,u)),u+=2;e*=2;break;case"utf8":t=mi(this,this.l,this.l+e);break;case"utf16le":t=qa(this,this.l,this.l+(e*=2));break;case"wstr":if(!(typeof gt<"u"))return Zi.call(this,e,"dbcs");t=gt.utils.decode(Zt,this.slice(this.l,this.l+2*e)),e*=2;break;case"lpstr-ansi":t=zs(this,this.l),e=4+ar(this,this.l);break;case"lpstr-cp":t=Hs(this,this.l),e=4+ar(this,this.l);break;case"lpwstr":t=Ys(this,this.l),e=4+2*ar(this,this.l);break;case"lpp4":e=4+ar(this,this.l),t=Js(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+ar(this,this.l),t=Ks(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,t="";0!==(o=_i(this,this.l+e++));)s.push(ji(o));t=s.join("");break;case"_wstr":for(e=0,t="";0!==(o=vn(this,this.l+e));)s.push(ji(o)),e+=2;e+=2,t=s.join("");break;case"dbcs-cont":for(t="",u=this.l,g=0;g<e;++g){if(this.lens&&-1!==this.lens.indexOf(u))return o=_i(this,u),this.l=u+1,l=Zi.call(this,e-g,o?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(ji(vn(this,u))),u+=2}t=s.join(""),e*=2;break;case"cpstr":if(typeof gt<"u"){t=gt.utils.decode(Zt,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(t="",u=this.l,g=0;g!=e;++g){if(this.lens&&-1!==this.lens.indexOf(u))return o=_i(this,u),this.l=u+1,l=Zi.call(this,e-g,o?"dbcs-cont":"sbcs-cont"),s.join("")+l;s.push(ji(_i(this,u))),u+=1}t=s.join("");break;default:switch(e){case 1:return n=_i(this,this.l),this.l++,n;case 2:return n=("i"===r?Zp:vn)(this,this.l),this.l+=2,n;case 4:case-4:return"i"!==r&&128&this[this.l+3]?(i=ar(this,this.l),this.l+=4,i):(n=(e>0?Hn:Qp)(this,this.l),this.l+=4,n);case 8:case-8:if("f"===r)return i=8==e?es(this,this.l):es([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:t=pl(this,this.l,e)}}return this.l+=e,t}var qp=function(e,r,t){e[t]=255&r,e[t+1]=r>>>8&255,e[t+2]=r>>>16&255,e[t+3]=r>>>24&255},ed=function(e,r,t){e[t]=255&r,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255},td=function(e,r,t){e[t]=255&r,e[t+1]=r>>>8&255};function rd(e,r,t){var n=0,i=0;if("dbcs"===t){for(i=0;i!=r.length;++i)td(this,r.charCodeAt(i),this.l+2*i);n=2*r.length}else if("sbcs"===t||"cpstr"==t)if(typeof gt<"u"&&874==Un){for(i=0;i!=r.length;++i){var s=gt.utils.encode(Un,r.charAt(i));this[this.l+i]=s[0]}n=r.length}else if(typeof gt<"u"&&"cpstr"==t){if((s=gt.utils.encode(Zt,r)).length==r.length)for(i=0;i<r.length;++i)0==s[i]&&0!=r.charCodeAt(i)&&(s[i]=95);if(s.length==2*r.length)for(i=0;i<r.length;++i)0==s[2*i]&&0==s[2*i+1]&&0!=r.charCodeAt(i)&&(s[2*i]=95);for(i=0;i<s.length;++i)this[this.l+i]=s[i];n=s.length}else{for(r=r.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=r.length;++i)this[this.l+i]=255&r.charCodeAt(i);n=r.length}else{if("hex"===t){for(;i<e;++i)this[this.l++]=parseInt(r.slice(2*i,2*i+2),16)||0;return this}if("utf16le"===t){var o=Math.min(this.l+e,this.length);for(i=0;i<Math.min(r.length,e);++i){var l=r.charCodeAt(i);this[this.l++]=255&l,this[this.l++]=l>>8}for(;this.l<o;)this[this.l++]=0;return this}switch(e){case 1:n=1,this[this.l]=255&r;break;case 2:n=2,this[this.l]=255&r,this[this.l+1]=255&(r>>>=8);break;case 3:n=3,this[this.l]=255&r,this[this.l+1]=255&(r>>>=8),this[this.l+2]=255&(r>>>=8);break;case 4:n=4,qp(this,r,this.l);break;case 8:if(n=8,"f"===t){!function Kp(e,r,t){var n=(r<0||1/r==-1/0?1:0)<<7,i=0,s=0,o=n?-r:r;isFinite(o)?0==o?i=s=0:(i=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(r)?26985:0);for(var l=0;l<=5;++l,s/=256)e[t+l]=255&s;e[t+6]=(15&i)<<4|15&s,e[t+7]=i>>4|n}(this,r,this.l);break}case 16:break;case-4:n=4,ed(this,r,this.l)}}return this.l+=n,this}function Tl(e,r){var t=pl(this,this.l,e.length>>1);if(t!==e)throw new Error(r+"Expected "+e+" saw "+t);this.l+=e.length>>1}function er(e,r){e.l=r,e.read_shift=Zi,e.chk=Tl,e.write_shift=rd}function Cr(e,r){e.l+=r}function J(e){var r=Dn(e);return er(r,0),r}function kn(e,r,t){if(e){var n,i,s;er(e,e.l||0);for(var o=e.length,l=0,g=0;e.l<o;){128&(l=e.read_shift(1))&&(l=(127&l)+((127&e.read_shift(1))<<7));var u=_a[l]||_a[65535];for(s=127&(n=e.read_shift(1)),i=1;i<4&&128&n;++i)s+=(127&(n=e.read_shift(1)))<<7*i;g=e.l+s;var h=u.f&&u.f(e,s,t);if(e.l=g,r(h,u,l))return}}}function Ir(){var e=[],r=ft?16384:2048,n=(ft&&J(r),function(A){var C=J(A);return er(C,0),C}),i=n(r),s=function(){i&&(i.l&&(i.length>i.l&&((i=i.slice(0,i.l)).l=i.length),i.length>0&&e.push(i)),i=null)},o=function(A){return i&&A<i.length-i.l?i:(s(),i=n(Math.max(A+1,r)))};return{next:o,push:function(A){s(),null==(i=A).l&&(i.l=i.length),o(r)},end:function(){return s(),jt(e)},_bufs:e,end2:function(){return s(),e}}}function oe(e,r,t,n){var s,i=+r;if(!isNaN(i)){n||(n=_a[i].p||(t||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var o=e.next(s);i<=127?o.write_shift(1,i):(o.write_shift(1,128+(127&i)),o.write_shift(1,i>>7));for(var l=0;4!=l;++l){if(!(n>=128)){o.write_shift(1,n);break}o.write_shift(1,128+(127&n)),n>>=7}n>0&&Zs(t)&&e.push(t)}}function Qi(e,r,t){var n=xt(e);if(r.s?(n.cRel&&(n.c+=r.s.c),n.rRel&&(n.r+=r.s.r)):(n.cRel&&(n.c+=r.c),n.rRel&&(n.r+=r.r)),!t||t.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Sl(e,r,t){var n=xt(e);return n.s=Qi(n.s,r.s,t),n.e=Qi(n.e,r.s,t),n}function qi(e,r){if(e.cRel&&e.c<0)for(e=xt(e);e.c<0;)e.c+=r>8?16384:256;if(e.rRel&&e.r<0)for(e=xt(e);e.r<0;)e.r+=r>8?1048576:r>5?65536:16384;var t=ht(e);return!e.cRel&&null!=e.cRel&&(t=function ad(e){return e.replace(/^([A-Z])/,"$$$1")}(t)),!e.rRel&&null!=e.rRel&&(t=function nd(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}(t)),t}function Qs(e,r){return 0!=e.s.r||e.s.rRel||e.e.r!=(r.biff>=12?1048575:r.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(r.biff>=12?16383:255)||e.e.cRel?qi(e.s,r.biff)+":"+qi(e.e,r.biff):(e.s.rRel?"":"$")+ut(e.s.r)+":"+(e.e.rRel?"":"$")+ut(e.e.r):(e.s.cRel?"":"$")+rt(e.s.c)+":"+(e.e.cRel?"":"$")+rt(e.e.c)}function qs(e){return parseInt(function id(e){return e.replace(/\$(\d+)$/,"$1")}(e),10)-1}function ut(e){return""+(e+1)}function eo(e){for(var r=function sd(e){return e.replace(/^\$([A-Z])/,"$1")}(e),t=0,n=0;n!==r.length;++n)t=26*t+r.charCodeAt(n)-64;return t-1}function rt(e){if(e<0)throw new Error("invalid column "+e);var r="";for(++e;e;e=Math.floor((e-1)/26))r=String.fromCharCode((e-1)%26+65)+r;return r}function Tt(e){for(var r=0,t=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?r=10*r+(i-48):i>=65&&i<=90&&(t=26*t+(i-64))}return{c:t-1,r:r-1}}function ht(e){for(var r=e.c+1,t="";r;r=(r-1)/26|0)t=String.fromCharCode((r-1)%26+65)+t;return t+(e.r+1)}function Ht(e){var r=e.indexOf(":");return-1==r?{s:Tt(e),e:Tt(e)}:{s:Tt(e.slice(0,r)),e:Tt(e.slice(r+1))}}function ot(e,r){return typeof r>"u"||"number"==typeof r?ot(e.s,e.e):("string"!=typeof e&&(e=ht(e)),"string"!=typeof r&&(r=ht(r)),e==r?e:e+":"+r)}function xi(e){var r=Ht(e);return"$"+rt(r.s.c)+"$"+ut(r.s.r)+":$"+rt(r.e.c)+"$"+ut(r.e.r)}function ea(e,r){if(!(e||r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e.replace(/'/g,"''")+"'":e}function Ct(e){var r={s:{c:0,r:0},e:{c:0,r:0}},t=0,n=0,i=0,s=e.length;for(t=0;n<s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)t=26*t+i;for(r.s.c=--t,t=0;n<s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)t=10*t+i;if(r.s.r=--t,n===s||10!=i)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++n,t=0;n!=s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)t=26*t+i;for(r.e.c=--t,t=0;n!=s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)t=10*t+i;return r.e.r=--t,r}function gn(e,r,t){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),"e"==e.t?rr[e.v]||e.v:function bl(e,r){var t="d"==e.t&&r instanceof Date;if(null!=e.z)try{return e.w=Dr(e.z,t?Ot(r):r)}catch{}try{return e.w=Dr((e.XF||{}).numFmtId||(t?14:0),t?Ot(r):r)}catch{return""+r}}(e,null==r?e.v:r))}function Pn(e,r){var t=r&&r.sheet?r.sheet:"Sheet1",n={};return n[t]=e,{SheetNames:[t],Sheets:n}}function El(e,r,t){var n=t||{},i=e?null!=e["!data"]:n.dense;null!=Gt&&null==i&&(i=Gt);var s=e||(i?{"!data":[]}:{});i&&!s["!data"]&&(s["!data"]=[]);var o=0,l=0;if(s&&null!=n.origin)if("number"==typeof n.origin)o=n.origin;else{var g="string"==typeof n.origin?Tt(n.origin):n.origin;o=g.r,l=g.c}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var h=Ct(s["!ref"]);u.s.c=h.s.c,u.s.r=h.s.r,u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),-1==o&&(u.e.r=o=s["!ref"]?h.e.r+1:0)}else u.s.c=u.e.c=u.s.r=u.e.r=0;for(var A=[],C=!1,I=0;I!=r.length;++I)if(r[I]){if(!Array.isArray(r[I]))throw new Error("aoa_to_sheet expects an array of arrays");var m=o+I;i&&(s["!data"][m]||(s["!data"][m]=[]),A=s["!data"][m]);for(var _=r[I],p=0;p!=_.length;++p)if(!(typeof _[p]>"u")){var d={v:_[p],t:""},w=l+p;if(u.s.r>m&&(u.s.r=m),u.s.c>w&&(u.s.c=w),u.e.r<m&&(u.e.r=m),u.e.c<w&&(u.e.c=w),C=!0,!_[p]||"object"!=typeof _[p]||Array.isArray(_[p])||_[p]instanceof Date)if(Array.isArray(d.v)&&(d.f=_[p][1],d.v=d.v[0]),null===d.v)if(d.f)d.t="n";else if(n.nullError)d.t="e",d.v=0;else{if(!n.sheetStubs)continue;d.t="z"}else"number"==typeof d.v?isFinite(d.v)?d.t="n":isNaN(d.v)?(d.t="e",d.v=15):(d.t="e",d.v=7):"boolean"==typeof d.v?d.t="b":d.v instanceof Date?(d.z=n.dateNF||Ve[14],n.UTC||(d.v=Ka(d.v)),n.cellDates?(d.t="d",d.w=Dr(d.z,Ot(d.v,n.date1904))):(d.t="n",d.v=Ot(d.v,n.date1904),d.w=Dr(d.z,d.v))):d.t="s";else d=_[p];if(i)A[w]&&A[w].z&&(d.z=A[w].z),A[w]=d;else{var v=rt(w)+(m+1);s[v]&&s[v].z&&(d.z=s[v].z),s[v]=d}}}return C&&u.s.c<104e5&&(s["!ref"]=ot(u)),s}function vi(e,r){return El(null,e,r)}function Zr(e,r){return r||(r=J(4)),r.write_shift(4,e),r}function Ar(e){var r=e.read_shift(4);return 0===r?"":e.read_shift(r,"dbcs")}function tr(e,r){var t=!1;return null==r&&(t=!0,r=J(4+2*e.length)),r.write_shift(4,e.length),e.length>0&&r.write_shift(0,e,"dbcs"),t?r.slice(0,r.l):r}function gd(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function to(e,r){var t=e.l,n=e.read_shift(1),i=Ar(e),s=[],o={t:i,h:i};if(1&n){for(var l=e.read_shift(4),g=0;g!=l;++g)s.push(gd(e));o.r=s}else o.r=[{ich:0,ifnt:0}];return e.l=t+r,o}var hd=to;function zr(e){var r=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:r,iStyleRef:t}}function Yn(e,r){return null==r&&(r=J(8)),r.write_shift(-4,e.c),r.write_shift(3,e.iStyleRef||e.s),r.write_shift(1,0),r}function Jn(e){var r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:r}}function Kn(e,r){return null==r&&(r=J(4)),r.write_shift(3,e.iStyleRef||e.s),r.write_shift(1,0),r}var Id=Ar,Fl=tr;function ts(e){var r=e.read_shift(4);return 0===r||4294967295===r?"":e.read_shift(r,"dbcs")}function ta(e,r){var t=!1;return null==r&&(t=!0,r=J(127)),r.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&r.write_shift(0,e,"dbcs"),t?r.slice(0,r.l):r}var Ad=Ar,ro=ts,no=ta;function rs(e){var r=e.slice(e.l,e.l+4),t=1&r[0],n=2&r[0];e.l+=4;var i=0===n?es([0,0,0,0,252&r[0],r[1],r[2],r[3]],0):Hn(r,0)>>2;return t?i/100:i}function Dl(e,r){null==r&&(r=J(4));var t=0,n=0,i=100*e;if(e==(0|e)&&e>=-(1<<29)&&e<1<<29?n=1:i==(0|i)&&i>=-(1<<29)&&i<1<<29&&(n=1,t=1),!n)throw new Error("unsupported RkNumber "+e);r.write_shift(-4,((t?i:e)<<2)+(t+2))}function Nl(e){var r={s:{},e:{}};return r.s.r=e.read_shift(4),r.e.r=e.read_shift(4),r.s.c=e.read_shift(4),r.e.c=e.read_shift(4),r}var Zn=Nl,ki=function pd(e,r){return r||(r=J(16)),r.write_shift(4,e.s.r),r.write_shift(4,e.e.r),r.write_shift(4,e.s.c),r.write_shift(4,e.e.c),r};function pr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Qn(e,r){return(r||J(8)).write_shift(8,e,"f")}function ns(e,r){if(r||(r=J(8)),!e||e.auto)return r.write_shift(4,0),r.write_shift(4,0),r;null!=e.index?(r.write_shift(1,2),r.write_shift(1,e.index)):null!=e.theme?(r.write_shift(1,6),r.write_shift(1,e.theme)):(r.write_shift(1,5),r.write_shift(1,0));var t=e.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),r.write_shift(2,t),e.rgb&&null==e.theme){var n=e.rgb||"FFFFFF";"number"==typeof n&&(n=("000000"+n.toString(16)).slice(-6)),r.write_shift(1,parseInt(n.slice(0,2),16)),r.write_shift(1,parseInt(n.slice(2,4),16)),r.write_shift(1,parseInt(n.slice(4,6),16)),r.write_shift(1,255)}else r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);return r}function Pl(e,r){var n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,1==r?"lpstr":"lpwstr")}var io=2,Nr=3,Rl=12,Ol=81,Sd=[80,Ol],ao={1:{n:"CodePage",t:io},2:{n:"Category",t:80},3:{n:"PresentationFormat",t:80},4:{n:"ByteCount",t:Nr},5:{n:"LineCount",t:Nr},6:{n:"ParagraphCount",t:Nr},7:{n:"SlideCount",t:Nr},8:{n:"NoteCount",t:Nr},9:{n:"HiddenCount",t:Nr},10:{n:"MultimediaClipCount",t:Nr},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:80},15:{n:"Company",t:80},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:Nr},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:Nr,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:80},27:{n:"ContentStatus",t:80},28:{n:"Language",t:80},29:{n:"Version",t:80},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},so={1:{n:"CodePage",t:io},2:{n:"Title",t:80},3:{n:"Subject",t:80},4:{n:"Author",t:80},5:{n:"Keywords",t:80},6:{n:"Comments",t:80},7:{n:"Template",t:80},8:{n:"LastAuthor",t:80},9:{n:"RevNumber",t:80},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:Nr},15:{n:"WordCount",t:Nr},16:{n:"CharCount",t:Nr},17:{n:"Thumbnail",t:71},18:{n:"Application",t:80},19:{n:"DocSecurity",t:Nr},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},Bl={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},bd=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Ed(e){return e.map(function(r){return[r>>16&255,r>>8&255,255&r]})}var qn=xt(Ed([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,0,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),rr={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},or={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},oo=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"],lo={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},os={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Ml(e,r,t){var s,n=function xp(e){for(var r=[],t=Ft(e),n=0;n!==t.length;++n)null==r[e[t[n]]]&&(r[e[t[n]]]=[]),r[e[t[n]]].push(t[n]);return r}(lo),i=[];t||(i[i.length]=Bt,i[i.length]=pe("Types",null,{xmlns:Qt.CT,"xmlns:xsd":Qt.xsd,"xmlns:xsi":Qt.xsi}),i=i.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(u){return pe("Default",null,{Extension:u[0],ContentType:u[1]})})));var o=function(u){e[u]&&e[u].length>0&&(i[i.length]=pe("Override",null,{PartName:("/"==(s=e[u][0])[0]?"":"/")+s,ContentType:os[u][r.bookType]||os[u].xlsx}))},l=function(u){(e[u]||[]).forEach(function(h){i[i.length]=pe("Override",null,{PartName:("/"==h[0]?"":"/")+h,ContentType:os[u][r.bookType]||os[u].xlsx})})},g=function(u){(e[u]||[]).forEach(function(h){i[i.length]=pe("Override",null,{PartName:("/"==h[0]?"":"/")+h,ContentType:n[u][0]})})};return o("workbooks"),l("sheets"),l("charts"),g("themes"),["strs","styles"].forEach(o),["coreprops","extprops","custprops"].forEach(g),g("vba"),g("comments"),g("threadedcomments"),g("drawings"),l("metadata"),g("people"),!t&&i.length>2&&(i[i.length]="</Types>",i[1]=i[1].replace("/>",">")),i.join("")}var lt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",CONN:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/connections",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function ra(e){var r=e.lastIndexOf("/");return e.slice(0,r+1)+"_rels/"+e.slice(r+1)+".rels"}function na(e,r){var t={"!id":{}};if(!e)return t;"/"!==r.charAt(0)&&(r="/"+r);var n={};return(e.match(cr)||[]).forEach(function(i){var s=Me(i);if("<Relationship"===s[0]){var o={};o.Type=s.Type,o.Target=pt(s.Target),o.Id=s.Id,s.TargetMode&&(o.TargetMode=s.TargetMode);var l="External"===s.TargetMode?s.Target:di(s.Target,r);t[l]=o,n[s.Id]=o}}),t["!id"]=n,t}function wi(e){var r=[Bt,pe("Relationships",null,{xmlns:Qt.RELS})];return Ft(e["!id"]).forEach(function(t){r[r.length]=pe("Relationship",null,e["!id"][t])}),r.length>2&&(r[r.length]="</Relationships>",r[1]=r[1].replace("/>",">")),r.join("")}function wt(e,r,t,n,i,s){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),r<0)for(r=e["!idx"];e["!id"]["rId"+r];++r);if(e["!idx"]=r+1,i.Id="rId"+r,i.Type=n,i.Target=t,s?i.TargetMode=s:[lt.HLINK,lt.XPATH,lt.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+r);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,r}var Nd="application/vnd.oasis.opendocument.spreadsheet";function Ll(e,r,t){return['  <rdf:Description rdf:about="'+e+'">\n','    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+r+'"/>\n',"  </rdf:Description>\n"].join("")}function Od(e,r){return['  <rdf:Description rdf:about="'+e+'">\n','    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+r+'"/>\n',"  </rdf:Description>\n"].join("")}function Ul(e,r){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Gi.version+"</meta:generator></office:meta></office:document-meta>"}var wn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Gl(e){var r={};e=yt(e);for(var t=0;t<wn.length;++t){var n=wn[t],i=Wn(e,n[0]);null!=i&&i.length>0&&(r[n[1]]=pt(i[1])),"date"===n[2]&&r[n[1]]&&(r[n[1]]=Pt(r[n[1]]))}return r}function go(e,r,t,n,i){null!=i[e]||null==r||""===r||(i[e]=r,r=st(r),n[n.length]=t?pe(e,r,t):gr(e,r))}function jl(e,r){var t=r||{},n=[Bt,pe("cp:coreProperties",null,{"xmlns:cp":Qt.CORE_PROPS,"xmlns:dc":Qt.dc,"xmlns:dcterms":Qt.dcterms,"xmlns:dcmitype":Qt.dcmitype,"xmlns:xsi":Qt.xsi})],i={};if(!e&&!t.Props)return n.join("");e&&(null!=e.CreatedDate&&go("dcterms:created","string"==typeof e.CreatedDate?e.CreatedDate:Xs(e.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),null!=e.ModifiedDate&&go("dcterms:modified","string"==typeof e.ModifiedDate?e.ModifiedDate:Xs(e.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=wn.length;++s){var o=wn[s],l=t.Props&&null!=t.Props[o[1]]?t.Props[o[1]]:e?e[o[1]]:null;!0===l?l="1":!1===l?l="0":"number"==typeof l&&(l=String(l)),null!=l&&go(o[0],l,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var ei=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],Vl=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function $l(e,r,t,n){var i=[];if("string"==typeof e)i=fl(e,n);else for(var s=0;s<e.length;++s)i=i.concat(e[s].map(function(h){return{v:h}}));var o="string"==typeof r?fl(r,n).map(function(h){return h.v}):r,l=0,g=0;if(o.length>0)for(var u=0;u!==i.length;u+=2){switch(g=+i[u+1].v,i[u].v){case"Worksheets":case"\u5de5\u4f5c\u8868":case"\u041b\u0438\u0441\u0442\u044b":case"\u0623\u0648\u0631\u0627\u0642 \u0627\u0644\u0639\u0645\u0644":case"\u30ef\u30fc\u30af\u30b7\u30fc\u30c8":case"\u05d2\u05dc\u05d9\u05d5\u05e0\u05d5\u05ea \u05e2\u05d1\u05d5\u05d3\u05d4":case"Arbeitsbl\xe4tter":case"\xc7al\u0131\u015fma Sayfalar\u0131":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xe1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xe1lculo":case"Werkbladen":t.Worksheets=g,t.SheetNames=o.slice(l,l+g);break;case"Named Ranges":case"Rangos con nombre":case"\u540d\u524d\u4ed8\u304d\u4e00\u89a7":case"Benannte Bereiche":case"Navngivne omr\xe5der":t.NamedRanges=g,t.DefinedNames=o.slice(l,l+g);break;case"Charts":case"Diagramme":t.Chartsheets=g,t.ChartNames=o.slice(l,l+g)}l+=g}}function Wl(e){var r=[],t=pe;return e||(e={}),e.Application="SheetJS",r[r.length]=Bt,r[r.length]=pe("Properties",null,{xmlns:Qt.EXT_PROPS,"xmlns:vt":Qt.vt}),ei.forEach(function(n){if(void 0!==e[n[1]]){var i;switch(n[2]){case"string":i=st(String(e[n[1]]));break;case"bool":i=e[n[1]]?"true":"false"}void 0!==i&&(r[r.length]=t(n[0],i))}}),r[r.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),r[r.length]=t("TitlesOfParts",t("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+st(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var Ld=/<[^<>]+>[^<]*/g;function Xl(e){var r=[Bt,pe("Properties",null,{xmlns:Qt.CUST_PROPS,"xmlns:vt":Qt.vt})];if(!e)return r.join("");var t=1;return Ft(e).forEach(function(i){++t,r[r.length]=pe("property",function Yp(e,r){switch(typeof e){case"string":var t=pe("vt:lpwstr",st(e));return r&&(t=t.replace(/&quot;/g,"_x0022_")),t;case"number":return pe((0|e)==e?"vt:i4":"vt:r8",st(String(e)));case"boolean":return pe("vt:bool",e?"true":"false")}if(e instanceof Date)return pe("vt:filetime",Xs(e));throw new Error("Unable to serialize "+e)}(e[i],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:st(i)})}),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var uo,fo={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function Gd(e,r,t){uo||(uo=Ja(fo)),e[r=uo[r]||r]=t}function ho(e){var r=e.read_shift(4),t=e.read_shift(4);return new Date(1e3*(t/1e7*Math.pow(2,32)+r/1e7-11644473600)).toISOString().replace(/\.000/,"")}function zl(e,r,t){return 31===r?function Xd(e,r,t){var n=e.read_shift(0,"lpwstr");return t&&(e.l+=4-(n.length+1&3)&3),n}(e):function Wd(e,r,t){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-n&3;)++e.l;return i}(e,0,t)}function ia(e,r,t){return zl(e,r,!1===t?0:4)}function Jd(e){var r=e.l,t=ls(e,Ol);return 0==e[e.l]&&0==e[e.l+1]&&e.l-r&2&&(e.l+=2),[t,ls(e,Nr)]}function Hl(e,r){for(var t=e.read_shift(4),n={},i=0;i!=t;++i){var s=e.read_shift(4),o=e.read_shift(4);n[s]=e.read_shift(o,1200===r?"utf16le":"utf8").replace(yr,"").replace(Wi,"!"),1200===r&&o%2&&(e.l+=2)}return 3&e.l&&(e.l=e.l>>3<<2),n}function Yl(e){var r=e.read_shift(4),t=e.slice(e.l,e.l+r);return e.l+=r,(3&r)>0&&(e.l+=4-(3&r)&3),t}function ls(e,r,t){var i,n=e.read_shift(2),s=t||{};if(e.l+=2,r!==Rl&&n!==r&&-1===Sd.indexOf(r)&&(4126!=(65534&r)||4126!=(65534&n)))throw new Error("Expected type "+r+" saw "+n);switch(r===Rl?n:r){case 2:return i=e.read_shift(2,"i"),s.raw||(e.l+=2),i;case 3:return e.read_shift(4,"i");case 11:return 0!==e.read_shift(4);case 19:return e.read_shift(4);case 30:case 31:e.l+=4,val=ia(e,e[e.l-4]).replace(/(^|[^\u0000])\u0000+$/,"$1");break;case 64:return ho(e);case 65:return Yl(e);case 71:return function Zd(e){var r={};return r.Size=e.read_shift(4),e.l+=r.Size+3-(r.Size-1)%4,r}(e);case 80:return ia(e,n,!s.raw).replace(yr,"");case 81:return function zd(e,r){if(!r)throw new Error("VtUnalignedString must have positive length");return zl(e,r,0)}(e,n).replace(yr,"");case 4108:return function Kd(e){for(var r=e.read_shift(4),t=[],n=0;n<r/2;++n)t.push(Jd(e));return t}(e);case 4126:case 4127:return 4127==n?function Hd(e){for(var r=e.read_shift(4),t=[],n=0;n!=r;++n){var i=e.l;t[n]=e.read_shift(0,"lpwstr").replace(yr,""),e.l-i&2&&(e.l+=2)}return t}(e):function Yd(e){for(var r=e.read_shift(4),t=[],n=0;n!=r;++n)t[n]=e.read_shift(0,"lpstr-cp").replace(yr,"");return t}(e);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+n)}}function Jl(e,r){var t=J(4),n=J(4);switch(t.write_shift(4,80==e?31:e),e){case 3:n.write_shift(-4,r);break;case 5:(n=J(8)).write_shift(8,r,"f");break;case 11:n.write_shift(4,r?1:0);break;case 64:n=function $d(e){var t=("string"==typeof e?new Date(Date.parse(e)):e).getTime()/1e3+11644473600,n=t%Math.pow(2,32),i=(t-n)/Math.pow(2,32);i*=1e7;var s=(n*=1e7)/Math.pow(2,32)|0;s>0&&(n%=Math.pow(2,32),i+=s);var o=J(8);return o.write_shift(4,n),o.write_shift(4,i),o}(r);break;case 31:case 80:for((n=J(4+2*(r.length+1)+(r.length%2?0:2))).write_shift(4,r.length+1),n.write_shift(0,r,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+r)}return jt([t,n])}function Kl(e,r){var t=e.l,n=e.read_shift(4),i=e.read_shift(4),s=[],o=0,l=0,g=-1,u={};for(o=0;o!=i;++o){var h=e.read_shift(4),A=e.read_shift(4);s[o]=[h,A+t]}s.sort(function(w,v){return w[1]-v[1]});var C={};for(o=0;o!=i;++o){if(e.l!==s[o][1]){var I=!0;if(o>0&&r)switch(r[s[o-1][0]].t){case 2:e.l+2===s[o][1]&&(e.l+=2,I=!1);break;case 80:case 4108:e.l<=s[o][1]&&(e.l=s[o][1],I=!1)}if((!r||0==o)&&e.l<=s[o][1]&&(I=!1,e.l=s[o][1]),I)throw new Error("Read Error: Expected address "+s[o][1]+" at "+e.l+" :"+o)}if(r){if(0==s[o][0]&&s.length>o+1&&s[o][1]==s[o+1][1])continue;var m=r[s[o][0]];if(C[m.n]=ls(e,m.t,{raw:!0}),"version"===m.p&&(C[m.n]=String(C[m.n]>>16)+"."+("0000"+String(65535&C[m.n])).slice(-4)),"CodePage"==m.n)switch(C[m.n]){case 0:C[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Vr(l=C[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+C[m.n])}}else if(1===s[o][0]){if(l=C.CodePage=ls(e,io),Vr(l),-1!==g){var _=e.l;e.l=s[g][1],u=Hl(e,l),e.l=_}}else if(0===s[o][0]){if(0===l){g=o,e.l=s[o+1][1];continue}u=Hl(e,l)}else{var d,p=u[s[o][0]];switch(e[e.l]){case 65:e.l+=4,d=Yl(e);break;case 30:case 31:e.l+=4,d=ia(e,e[e.l-4]).replace(/(^|[^\u0000])\u0000+$/,"$1");break;case 3:e.l+=4,d=e.read_shift(4,"i");break;case 19:e.l+=4,d=e.read_shift(4);break;case 5:e.l+=4,d=e.read_shift(8,"f");break;case 11:e.l+=4,d=Vt(e,4);break;case 64:e.l+=4,d=Pt(ho(e));break;default:throw new Error("unparsed value: "+e[e.l])}C[p]=d}}return e.l=t+n,C}var Zl=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Qd(e){switch(typeof e){case"boolean":return 11;case"number":return(0|e)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64}return-1}function Ql(e,r,t){var n=J(8),i=[],s=[],o=8,l=0,g=J(8),u=J(8);if(g.write_shift(4,2),g.write_shift(4,1200),u.write_shift(4,1),s.push(g),i.push(u),o+=8+g.length,!r){(u=J(8)).write_shift(4,0),i.unshift(u);var h=[J(4)];for(h[0].write_shift(4,e.length),l=0;l<e.length;++l){var A=e[l][0];for((g=J(8+2*(A.length+1)+(A.length%2?0:2))).write_shift(4,l+2),g.write_shift(4,A.length+1),g.write_shift(0,A,"dbcs");g.l!=g.length;)g.write_shift(1,0);h.push(g)}g=jt(h),s.unshift(g),o+=8+g.length}for(l=0;l<e.length;++l)if((!r||r[e[l][0]])&&!(Zl.indexOf(e[l][0])>-1||Vl.indexOf(e[l][0])>-1)&&null!=e[l][1]){var C=e[l][1],I=0;if(r){var m=t[I=+r[e[l][0]]];if("version"==m.p&&"string"==typeof C){var _=C.split(".");C=(+_[0]<<16)+(+_[1]||0)}g=Jl(m.t,C)}else{var p=Qd(C);-1==p&&(p=31,C=String(C)),g=Jl(p,C)}s.push(g),(u=J(8)).write_shift(4,r?I:2+l),i.push(u),o+=8+g.length}var d=8*(s.length+1);for(l=0;l<s.length;++l)i[l].write_shift(4,d),d+=s[l].length;return n.write_shift(4,o),n.write_shift(4,s.length),jt([n].concat(i).concat(s))}function ql(e,r,t){var n=e.content;if(!n)return{};er(n,0);var i,s,o,l,g=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),h=n.read_shift(16);if(h!==We.utils.consts.HEADER_CLSID&&h!==t)throw new Error("Bad PropertySet CLSID "+h);if(1!==(i=n.read_shift(4))&&2!==i)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),l=n.read_shift(4),1===i&&l!==n.l)throw new Error("Length mismatch: "+l+" !== "+n.l);2===i&&(o=n.read_shift(16),g=n.read_shift(4));var m,A=Kl(n,r),C={SystemIdentifier:u};for(var I in A)C[I]=A[I];if(C.FMTID=s,1===i)return C;if(g-n.l==2&&(n.l+=2),n.l!==g)throw new Error("Length mismatch 2: "+n.l+" !== "+g);try{m=Kl(n,null)}catch{}for(I in m)C[I]=m[I];return C.FMTID=[s,o],C}function ec(e,r,t,n,i,s){var o=J(i?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,We.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,i?2:1),o.write_shift(16,r,"hex"),o.write_shift(4,i?68:48);var g=Ql(e,t,n);if(l.push(g),i){var u=Ql(i,null,null);o.write_shift(16,s,"hex"),o.write_shift(4,68+g.length),l.push(u)}return jt(l)}function Rn(e,r){return e.read_shift(r),null}function Vt(e,r){return 1===e.read_shift(r)}function dr(e,r){return r||(r=J(2)),r.write_shift(2,+!!e),r}function Mt(e){return e.read_shift(2,"u")}function Hr(e,r){return r||(r=J(2)),r.write_shift(2,e),r}function tc(e,r){return function e1(e,r,t){for(var n=[],i=e.l+r;e.l<i;)n.push(t(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}(e,r,Mt)}function rc(e){var r=e.read_shift(1);return 1===e.read_shift(1)?r:1===r}function nc(e,r,t){return t||(t=J(2)),t.write_shift(1,"e"==r?+e:+!!e),t.write_shift(1,"e"==r?1:0),t}function yi(e,r,t){var n=e.read_shift(t&&t.biff>=12?2:1),i="sbcs-cont",s=Zt;t&&t.biff>=8&&(Zt=1200),t&&8!=t.biff?12==t.biff&&(i="wstr"):e.read_shift(1)&&(i="dbcs-cont"),t.biff>=2&&t.biff<=5&&(i="cpstr");var l=n?e.read_shift(n,i):"";return Zt=s,l}function t1(e){var r=Zt;Zt=1200;var g,t=e.read_shift(2),n=e.read_shift(1),i=4&n,s=8&n,o=1+(1&n),l=0,u={};s&&(l=e.read_shift(2)),i&&(g=e.read_shift(4));var A=0===t?"":e.read_shift(t,2==o?"dbcs-cont":"sbcs-cont");return s&&(e.l+=4*l),i&&(e.l+=g),u.t=A,s||(u.raw="<t>"+u.t+"</t>",u.r=u.t),Zt=r,u}function r1(e){var r=e.t||"",n=J(3);n.write_shift(2,r.length),n.write_shift(1,1);var i=J(2*r.length);return i.write_shift(2*r.length,r,"utf16le"),jt([n,i])}function ti(e,r,t){if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(r,"cpstr");if(t.biff>=12)return e.read_shift(r,"dbcs-cont")}var i=e.read_shift(1);return e.read_shift(r,0===i?"sbcs-cont":"dbcs-cont")}function aa(e,r,t){var n=e.read_shift(t&&2==t.biff?1:2);return 0===n?(e.l++,""):ti(e,n,t)}function ri(e,r,t){if(t.biff>5)return aa(e,0,t);var n=e.read_shift(1);return 0===n?(e.l++,""):e.read_shift(n,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function ic(e,r,t){return t||(t=J(3+2*e.length)),t.write_shift(2,e.length),t.write_shift(1,1),t.write_shift(31,e,"utf16le"),t}function cs(e){var r=e.read_shift(4);return r>0?e.read_shift(r,"utf16le").replace(yr,""):""}function ac(e,r){r||(r=J(6+2*e.length)),r.write_shift(4,1+e.length);for(var t=0;t<e.length;++t)r.write_shift(2,e.charCodeAt(t));return r.write_shift(2,0),r}function c1(e){var r=J(512),t=0,n=e.Target;"file://"==n.slice(0,7)&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3}r.write_shift(4,2),r.write_shift(4,s);var o=[8,6815827,6619237,4849780,83];for(t=0;t<o.length;++t)r.write_shift(4,o[t]);if(28==s)ac(n=n.slice(1),r);else if(2&s){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<o.length;++t)r.write_shift(1,parseInt(o[t],16));var l=i>-1?n.slice(0,i):n;for(r.write_shift(4,2*(l.length+1)),t=0;t<l.length;++t)r.write_shift(2,l.charCodeAt(t));r.write_shift(2,0),8&s&&ac(i>-1?n.slice(i+1):"",r)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<o.length;++t)r.write_shift(1,parseInt(o[t],16));for(var g=0;"../"==n.slice(3*g,3*g+3)||"..\\"==n.slice(3*g,3*g+3);)++g;for(r.write_shift(2,g),r.write_shift(4,n.length-3*g+1),t=0;t<n.length-3*g;++t)r.write_shift(1,255&n.charCodeAt(t+3*g));for(r.write_shift(1,0),r.write_shift(2,65535),r.write_shift(2,57005),t=0;t<6;++t)r.write_shift(4,0)}return r.slice(0,r.l)}function sc(e){return[e.read_shift(1),e.read_shift(1),e.read_shift(1),e.read_shift(1)]}function oc(e,r){var t=sc(e);return t[3]=0,t}function Qr(e,r,t){var s={r:e.read_shift(2),c:e.read_shift(2),ixfe:0};if(t&&2==t.biff||7==r){var o=e.read_shift(1);s.ixfe=63&o,e.l+=2}else s.ixfe=e.read_shift(2);return s}function ni(e,r,t,n){return n||(n=J(6)),n.write_shift(2,e),n.write_shift(2,r),n.write_shift(2,t||0),n}function u1(e,r,t){var n=t.biff>8?4:2;return[e.read_shift(n),e.read_shift(n,"i"),e.read_shift(n,"i")]}function lc(e){return[e.read_shift(2),rs(e)]}function gs(e){var r=e.read_shift(2),t=e.read_shift(2);return{s:{c:e.read_shift(2),r},e:{c:e.read_shift(2),r:t}}}function cc(e,r){return r||(r=J(8)),r.write_shift(2,e.s.r),r.write_shift(2,e.e.r),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c),r}function gc(e){var r=e.read_shift(2),t=e.read_shift(2);return{s:{c:e.read_shift(1),r},e:{c:e.read_shift(1),r:t}}}var C1=gc;function fc(e){e.l+=4;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[t,r,n]}function mr(e){e.l+=2,e.l+=e.read_shift(2)}var p1={0:mr,4:mr,5:mr,6:mr,7:function A1(e){return e.l+=4,e.cf=e.read_shift(2),{}},8:mr,9:mr,10:mr,11:mr,12:mr,13:function I1(e){var r={};return e.l+=4,e.l+=16,r.fSharedNote=e.read_shift(2),e.l+=4,r},14:mr,15:mr,16:mr,17:mr,18:mr,19:mr,20:mr,21:fc};function fs(e,r){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),(r-=2)>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(r),t}function Co(e,r,t){var n=1536,i=16;switch(t.bookType){case"biff8":case"xla":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;default:throw new Error("unsupported BIFF version")}var s=J(i);return s.write_shift(2,n),s.write_shift(2,r),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function w1(e,r){var t=!r||r.biff>=8?2:1,n=J(8+t*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),r.biff>=8&&n.write_shift(1,1),n.write_shift(t*e.name.length,e.name,r.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function uc(e,r,t){var n=0;t&&2==t.biff||(n=e.read_shift(2));var i=e.read_shift(2);return t&&2==t.biff&&(n=1-(i>>15),i&=32767),[{Unsynced:1&n,DyZero:(2&n)>>1,ExAsc:(4&n)>>2,ExDsc:(8&n)>>3},i]}function $1(e,r,t,n){var i=t&&5==t.biff;n||(n=J(i?3+r.length:5+2*r.length)),n.write_shift(2,e),n.write_shift(i?1:2,r.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*r.length,r,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return null==s.l&&(s.l=s.length),s}var W1=ri;function hc(e,r,t){var n=e.l+r,i=8!=t.biff&&t.biff?2:4,s=e.read_shift(i),o=e.read_shift(i),l=e.read_shift(2),g=e.read_shift(2);return e.l=n,{s:{r:s,c:l},e:{r:o,c:g}}}function Cc(e,r,t,n){var i=t&&5==t.biff;n||(n=J(i?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,r<<4));var s=0;return e.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function Ic(e){var r=J(12);return r.l++,r.write_shift(1,e.numFmtId),r.l+=10,r}var tm=Ic;function Io(e,r,t,n,i,s){var o=J(8);return ni(e,r,n,o),nc(t,s,o),o}var Ac=function f1(e,r,t){return 0===r?"":ri(e,0,t)};function pc(e,r,t){var i,n=e.read_shift(2),s={fBuiltIn:1&n,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return 14849===t.sbcch&&(i=function h1(e,r,t){e.l+=4;var n=e.l+(r-=4),i=yi(e,0,t),s=e.read_shift(2);if(s!==(n-=e.l))throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,i}(e,r-2,t)),s.body=i||e.read_shift(r-2),"string"==typeof i&&(s.Name=i),s}function dc(e,r,t){var n=e.l+r,i=e.read_shift(2),s=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(t&&2==t.biff?1:2),g=0;(!t||t.biff>=5)&&(5!=t.biff&&(e.l+=2),g=e.read_shift(2),5==t.biff&&(e.l+=2),e.l+=4);var u=ti(e,o,t);32&i&&(u=oo[u.charCodeAt(0)]);var h=n-e.l;t&&2==t.biff&&--h;var A=n!=e.l&&0!==l&&h>0?function wv(e,r,t,n){var o,i=e.l+r,s=Ca(e,n,t);return i!==e.l&&(o=ha(e,i-e.l,s,t)),[s,o]}(e,h,t,l):[];return{chKey:s,Name:u,itab:g,rgce:A}}function mc(e,r,t){if(t.biff<8||!(t.biff>8)&&r==e[e.l]+(3==e[e.l+1]?1:0)+1)return function _c(e,r,t){3==e[e.l+1]&&e[e.l]++;var n=yi(e,0,t);return 3==n.charCodeAt(0)?n.slice(1):n}(e,0,t);for(var n=[],i=e.l+r,s=e.read_shift(t.biff>8?4:2);0!=s--;)n.push(u1(e,0,t));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function xc(e,r,t){var n=C1(e,6);switch(t.biff){case 2:e.l++,r-=7;break;case 3:case 4:e.l+=2,r-=8;break;default:e.l+=6,r-=12}return[n,vv(e,r,t)]}function Ao(e,r,t,n){var i=J(6+(n||e.length));return i.write_shift(2,r),i.write_shift(2,t),i.write_shift(2,n||e.length),i.write_shift(e.length,e,"sbcs"),i}var dm={8:function(e,r){var t=e.l+r;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=t,{fmt:n}}};function vm(e){var r=J(24),t=Tt(e[0]);r.write_shift(2,t.r),r.write_shift(2,t.r),r.write_shift(2,t.c),r.write_shift(2,t.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)r.write_shift(1,parseInt(n[i],16));return jt([r,c1(e[1])])}function wm(e){var r=e[1].Tooltip,t=J(10+2*(r.length+1));t.write_shift(2,2048);var n=Tt(e[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var i=0;i<r.length;++i)t.write_shift(2,r.charCodeAt(i));return t.write_shift(2,0),t}function vc(e,r,t){if(!t.cellStyles)return Cr(e,r);var n=t&&t.biff>=12?4:2,i=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(n),g=e.read_shift(2);2==n&&(e.l+=2);var u={s:i,e:s,w:o,ixfe:l,flags:g};return(t.biff>=5||!t.biff)&&(u.level=g>>8&7),u}var Rm=Qr,Om=tc,Bm=aa;function sa(e,r,t,n,i){return e||(e=J(7)),e.write_shift(2,r),e.write_shift(2,t),e.write_shift(1,n||0),e.write_shift(1,i||0),e.write_shift(1,0),e}var Ym=[2,3,48,49,131,139,140,245],po=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=Ja({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(l,g){var u=g||{};u.dateNF||(u.dateNF="yyyymmdd");var h=vi(function t(l,g){var u=[],h=Dn(1);switch(g.type){case"base64":h=wr(Br(l));break;case"binary":h=wr(l);break;case"buffer":case"array":h=l}er(h,0);var A=h.read_shift(1),C=!!(136&A),I=!1,m=!1;switch(A){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:I=!0,C=!0;break;case 140:m=!0;break;default:throw new Error("DBF Unsupported Version: "+A.toString(16))}var _=0,p=521;2==A&&(_=h.read_shift(2)),h.l+=3,2!=A&&(_=h.read_shift(4)),_>1048576&&(_=1e6),2!=A&&(p=h.read_shift(2));var d=h.read_shift(2),w=g.codepage||1252;2!=A&&(h.l+=16,h.read_shift(1),0!==h[h.l]&&(w=e[h[h.l]]),h.l+=1,h.l+=2),m&&(h.l+=36);for(var v=[],S={},G=Math.min(h.length,2==A?521:p-10-(I?264:0)),X=m?32:11;h.l<G&&13!=h[h.l];)switch(S={},S.name=(typeof gt<"u"?gt.utils.decode(w,h.slice(h.l,h.l+X)):sn(h.slice(h.l,h.l+X))).replace(/[\u0000\r\n][\S\s]*$/g,""),h.l+=X,S.type=String.fromCharCode(h.read_shift(1)),2!=A&&!m&&(S.offset=h.read_shift(4)),S.len=h.read_shift(1),2==A&&(S.offset=h.read_shift(2)),S.dec=h.read_shift(1),S.name.length&&v.push(S),2!=A&&(h.l+=m?13:14),S.type){case"B":(!I||8!=S.len)&&g.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"G":case"P":g.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+S.type)}if(13!==h[h.l]&&(h.l=p-1),13!==h.read_shift(1))throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=p;var E=0,O=0;for(u[0]=[],O=0;O!=v.length;++O)u[0][O]=v[O].name;for(;_-- >0;)if(42!==h[h.l])for(++h.l,u[++E]=[],O=0,O=0;O!=v.length;++O){var L=h.slice(h.l,h.l+v[O].len);h.l+=v[O].len,er(L,0);var W=typeof gt<"u"?gt.utils.decode(w,L):sn(L);switch(v[O].type){case"C":W.trim().length&&(u[E][O]=W.replace(/([^\s])\s+$/,"$1"));break;case"D":8===W.length?(u[E][O]=new Date(Date.UTC(+W.slice(0,4),+W.slice(4,6)-1,+W.slice(6,8),0,0,0,0)),g&&g.UTC||(u[E][O]=$n(u[E][O]))):u[E][O]=W;break;case"F":u[E][O]=parseFloat(W.trim());break;case"+":case"I":u[E][O]=m?2147483648^L.read_shift(-4,"i"):L.read_shift(4,"i");break;case"L":switch(W.trim().toUpperCase()){case"Y":case"T":u[E][O]=!0;break;case"N":case"F":u[E][O]=!1;break;case"":case"\0":case"?":break;default:throw new Error("DBF Unrecognized L:|"+W+"|")}break;case"M":if(!C)throw new Error("DBF Unexpected MEMO for type "+A.toString(16));u[E][O]="##MEMO##"+(m?parseInt(W.trim(),10):L.read_shift(4));break;case"N":(W=W.replace(/\u0000/g,"").trim())&&"."!=W&&(u[E][O]=+W||0);break;case"@":u[E][O]=new Date(L.read_shift(-8,"f")-621356832e5);break;case"T":var H=L.read_shift(4),Y=L.read_shift(4);if(0==H&&0==Y)break;u[E][O]=new Date(864e5*(H-2440588)+Y),g&&g.UTC||(u[E][O]=$n(u[E][O]));break;case"Y":u[E][O]=L.read_shift(4,"i")/1e4+L.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[E][O]=-L.read_shift(-8,"f");break;case"B":if(I&&8==v[O].len){u[E][O]=L.read_shift(8,"f");break}case"G":case"P":L.l+=v[O].len;break;case"0":if("_NullFlags"===v[O].name)break;default:throw new Error("DBF Unsupported data type "+v[O].type)}}else h.l+=d;if(2!=A&&h.l<h.length&&26!=h[h.l++])throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return g&&g.sheetRows&&(u=u.slice(0,g.sheetRows)),g.DBF=v,u}(l,u),u);return h["!cols"]=u.DBF.map(function(A){return{wch:A.len,DBF:A}}),delete u.DBF,h}var s={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function i(l,g){try{var u=Pn(n(l,g),g);return u.bookType="dbf",u}catch(h){if(g&&g.WTF)throw h}return{SheetNames:[],Sheets:{}}},to_sheet:n,from_sheet:function o(l,g){if(!l["!ref"])throw new Error("Cannot export empty sheet to DBF");var u=g||{},h=Zt;if(+u.codepage>=0&&Vr(+u.codepage),"string"==u.type)throw new Error("Cannot write DBF to JS string");var A=Ir(),C=Ko(l,{header:1,raw:!0,cellDates:!0}),I=C[0],m=C.slice(1),_=l["!cols"]||[],p=0,d=0,w=0,v=1;for(p=0;p<I.length;++p)if(((_[p]||{}).DBF||{}).name)I[p]=_[p].DBF.name,++w;else if(null!=I[p]){if(++w,"number"==typeof I[p]&&(I[p]=I[p].toString(10)),"string"!=typeof I[p])throw new Error("DBF Invalid column name "+I[p]+" |"+typeof I[p]+"|");if(I.indexOf(I[p])!==p)for(d=0;d<1024;++d)if(-1==I.indexOf(I[p]+"_"+d)){I[p]+="_"+d;break}}var S=Ct(l["!ref"]),G=[],X=[],E=[];for(p=0;p<=S.e.c-S.s.c;++p){var O="",L="",W=0,H=[];for(d=0;d<m.length;++d)null!=m[d][p]&&H.push(m[d][p]);if(0!=H.length&&null!=I[p]){for(d=0;d<H.length;++d){switch(typeof H[d]){case"number":L="B";break;case"string":default:L="C";break;case"boolean":L="L";break;case"object":L=H[d]instanceof Date?"D":"C"}W=Math.max(W,(typeof gt<"u"&&"string"==typeof H[d]?gt.utils.encode(Un,H[d]):String(H[d])).length),O=O&&O!=L?"C":L}W>250&&(W=250),"C"==(L=((_[p]||{}).DBF||{}).type)&&_[p].DBF.len>W&&(W=_[p].DBF.len),"B"==O&&"N"==L&&(O="N",E[p]=_[p].DBF.dec,W=_[p].DBF.len),X[p]="C"==O||"N"==L?W:s[O]||0,v+=X[p],G[p]=O}else G[p]="?"}var Y=A.next(32);for(Y.write_shift(4,318902576),Y.write_shift(4,m.length),Y.write_shift(2,296+32*w),Y.write_shift(2,v),p=0;p<4;++p)Y.write_shift(4,0);var ee=+r[Zt]||3;for(Y.write_shift(4,ee<<8),e[ee]!=+u.codepage&&(u.codepage&&console.error("DBF Unsupported codepage "+Zt+", using 1252"),Zt=1252),p=0,d=0;p<I.length;++p)if(null!=I[p]){var Te=A.next(32),le=(I[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);Te.write_shift(1,le,"sbcs"),Te.write_shift(1,"?"==G[p]?"C":G[p],"sbcs"),Te.write_shift(4,d),Te.write_shift(1,X[p]||s[G[p]]||0),Te.write_shift(1,E[p]||0),Te.write_shift(1,2),Te.write_shift(4,0),Te.write_shift(1,0),Te.write_shift(4,0),Te.write_shift(4,0),d+=X[p]||s[G[p]]||0}var Pe=A.next(264);for(Pe.write_shift(4,13),p=0;p<65;++p)Pe.write_shift(4,0);for(p=0;p<m.length;++p){var ce=A.next(v);for(ce.write_shift(1,0),d=0;d<I.length;++d)if(null!=I[d])switch(G[d]){case"L":ce.write_shift(1,null==m[p][d]?63:m[p][d]?84:70);break;case"B":ce.write_shift(8,m[p][d]||0,"f");break;case"N":var Re="0";for("number"==typeof m[p][d]&&(Re=m[p][d].toFixed(E[d]||0)),Re.length>X[d]&&(Re=Re.slice(0,X[d])),w=0;w<X[d]-Re.length;++w)ce.write_shift(1,32);ce.write_shift(1,Re,"sbcs");break;case"D":m[p][d]?(ce.write_shift(4,("0000"+m[p][d].getFullYear()).slice(-4),"sbcs"),ce.write_shift(2,("00"+(m[p][d].getMonth()+1)).slice(-2),"sbcs"),ce.write_shift(2,("00"+m[p][d].getDate()).slice(-2),"sbcs")):ce.write_shift(8,"00000000","sbcs");break;case"C":var Xe=ce.l,ue=String(null!=m[p][d]?m[p][d]:"").slice(0,X[d]);for(ce.write_shift(1,ue,"cpstr"),Xe+=X[d]-ce.l,w=0;w<Xe;++w)ce.write_shift(1,32)}}return Zt=h,A.next(1).write_shift(1,26),A.end()}}}(),kc=function(){var e={AA:"\xc0",BA:"\xc1",CA:"\xc2",DA:195,HA:"\xc4",JA:197,AE:"\xc8",BE:"\xc9",CE:"\xca",HE:"\xcb",AI:"\xcc",BI:"\xcd",CI:"\xce",HI:"\xcf",AO:"\xd2",BO:"\xd3",CO:"\xd4",DO:213,HO:"\xd6",AU:"\xd9",BU:"\xda",CU:"\xdb",HU:"\xdc",Aa:"\xe0",Ba:"\xe1",Ca:"\xe2",Da:227,Ha:"\xe4",Ja:229,Ae:"\xe8",Be:"\xe9",Ce:"\xea",He:"\xeb",Ai:"\xec",Bi:"\xed",Ci:"\xee",Hi:"\xef",Ao:"\xf2",Bo:"\xf3",Co:"\xf4",Do:245,Ho:"\xf6",Au:"\xf9",Bu:"\xfa",Cu:"\xfb",Hu:"\xfc",KC:"\xc7",Kc:"\xe7",q:"\xe6",z:"\u0153",a:"\xc6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1bN("+Ft(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1").replace("{","\\{")+"|\\|)","gm");try{r=new RegExp("\x1bN("+Ft(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm")}catch{}var t=function(I,m){var _=e[m];return"number"==typeof _?Ns(_):_},n=function(I,m,_){var p=m.charCodeAt(0)-32<<4|_.charCodeAt(0)-48;return 59==p?I:Ns(p)};e["|"]=254;function o(I,m){var Y,_=I.split(/[\n\r]+/),p=-1,d=-1,w=0,v=0,S=[],G=[],X=null,E={},O=[],L=[],W=[],H=0,ee={Workbook:{WBProps:{},Names:[]}};for(+m.codepage>=0&&Vr(+m.codepage);w!==_.length;++w){H=0;var ce,Te=_[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(r,t),le=Te.replace(/;;/g,"\0").split(";").map(function(U){return U.replace(/\u0000/g,";")});if(Te.length>0)switch(le[0]){case"ID":case"E":case"B":case"W":break;case"O":for(v=1;v<le.length;++v)if("V"===le[v].charAt(0)){var Re=parseInt(le[v].slice(1),10);Re>=1&&Re<=4&&(ee.Workbook.WBProps.date1904=!0)}break;case"P":"P"===le[1].charAt(0)&&G.push(Te.slice(3).replace(/;;/g,";"));break;case"NN":var Xe={Sheet:0};for(v=1;v<le.length;++v)switch(le[v].charAt(0)){case"N":Xe.Name=le[v].slice(1);break;case"E":Xe.Ref=(m&&m.sheet||"Sheet1")+"!"+ai(le[v].slice(1))}ee.Workbook.Names.push(Xe);break;case"C":var ue=!1,Ke=!1,re=!1,he=!1,Ce=-1,Ue=-1,ve="",Ne="z",D="";for(v=1;v<le.length;++v)switch(le[v].charAt(0)){case"A":D=le[v].slice(1);break;case"X":d=parseInt(le[v].slice(1),10)-1,Ke=!0;break;case"Y":for(p=parseInt(le[v].slice(1),10)-1,Ke||(d=0),Y=S.length;Y<=p;++Y)S[Y]=[];break;case"K":'"'===(ce=le[v].slice(1)).charAt(0)?(ce=ce.slice(1,ce.length-1),Ne="s"):"TRUE"===ce||"FALSE"===ce?(ce="TRUE"===ce,Ne="b"):"#"==ce.charAt(0)&&null!=or[ce]?(Ne="e",ce=or[ce]):isNaN(Lr(ce))||(ce=Lr(ce),Ne="n",null!==X&&Mr(X)&&m.cellDates&&(Ne="number"==typeof(ce=xn(ee.Workbook.WBProps.date1904?ce+1462:ce))?"n":"d")),typeof gt<"u"&&"string"==typeof ce&&"string"!=(m||{}).type&&(m||{}).codepage&&(ce=gt.utils.decode(m.codepage,ce)),ue=!0;break;case"E":he=!0,ve=ai(le[v].slice(1),{r:p,c:d});break;case"S":re=!0;break;case"G":break;case"R":Ce=parseInt(le[v].slice(1),10)-1;break;case"C":Ue=parseInt(le[v].slice(1),10)-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+Te)}if(ue&&(S[p][d]?(S[p][d].t=Ne,S[p][d].v=ce):S[p][d]={t:Ne,v:ce},X&&(S[p][d].z=X),!1!==m.cellText&&X&&(S[p][d].w=Dr(S[p][d].z,S[p][d].v,{date1904:ee.Workbook.WBProps.date1904})),X=null),re){if(he)throw new Error("SYLK shared formula cannot have own formula");var z=Ce>-1&&S[Ce][Ue];if(!z||!z[1])throw new Error("SYLK shared formula cannot find base");ve=Gc(z[1],{r:p-Ce,c:d-Ue})}ve&&(S[p][d]?S[p][d].f=ve:S[p][d]={t:"n",f:ve}),D&&(S[p][d]||(S[p][d]={t:"z"}),S[p][d].c=[{a:"SheetJSYLK",t:D}]);break;case"F":var j=0;for(v=1;v<le.length;++v)switch(le[v].charAt(0)){case"X":d=parseInt(le[v].slice(1),10)-1,++j;break;case"Y":for(p=parseInt(le[v].slice(1),10)-1,Y=S.length;Y<=p;++Y)S[Y]=[];break;case"M":H=parseInt(le[v].slice(1),10)/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":X=G[parseInt(le[v].slice(1),10)];break;case"W":for(W=le[v].slice(1).split(" "),Y=parseInt(W[0],10);Y<=parseInt(W[1],10);++Y)H=parseInt(W[2],10),L[Y-1]=0===H?{hidden:!0}:{wch:H};break;case"C":L[d=parseInt(le[v].slice(1),10)-1]||(L[d]={});break;case"R":O[p=parseInt(le[v].slice(1),10)-1]||(O[p]={}),H>0?(O[p].hpt=H,O[p].hpx=bi(H)):0===H&&(O[p].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+Te)}j<1&&(X=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+Te)}}return O.length>0&&(E["!rows"]=O),L.length>0&&(E["!cols"]=L),L.forEach(function(U){Tn(U)}),m&&m.sheetRows&&(S=S.slice(0,m.sheetRows)),[S,E,ee]}function g(I,m,_,p,d,w){var v="C;Y"+(_+1)+";X"+(p+1)+";K";switch(I.t){case"n":v+=isFinite(I.v)?I.v||0:rr[isNaN(I.v)?36:7],I.f&&!I.F&&(v+=";E"+fa(I.f,{r:_,c:p}));break;case"b":v+=I.v?"TRUE":"FALSE";break;case"e":v+=I.w||rr[I.v]||I.v;break;case"d":v+=Ot(Pt(I.v,w),w);break;case"s":v+='"'+(null==I.v?"":String(I.v)).replace(/"/g,"").replace(/;/g,";;")+'"'}return v}function u(I,m,_){return"C;Y"+(m+1)+";X"+(_+1)+";A"+function(I){return I.replace(/\n/g,"\x1b :").replace(/\r/g,"\x1b =")}(I.map(function(d){return d.t}).join(""))}return{to_workbook:function l(I,m){var _=function s(I,m){switch(m.type){case"base64":return o(Br(I),m);case"binary":return o(I,m);case"buffer":return o(ft&&Buffer.isBuffer(I)?I.toString("binary"):sn(I),m);case"array":return o(Vn(I),m)}throw new Error("Unrecognized type "+m.type)}(I,m),p=_[0],d=_[1],w=_[2],v=xt(m);v.date1904=(((w||{}).Workbook||{}).WBProps||{}).date1904;var S=vi(p,v);Ft(d).forEach(function(X){S[X]=d[X]});var G=Pn(S,m);return Ft(w).forEach(function(X){G[X]=w[X]}),G.bookType="sylk",G},from_sheet:function C(I,m,_){m||(m={}),m._formats=["General"];var v,p=["ID;PSheetJS;N;E"],d=[],w=Ct(I["!ref"]||"A1"),S=null!=I["!data"],G="\r\n",X=(((_||{}).Workbook||{}).WBProps||{}).date1904;p.push("P;PGeneral");var O=w.s.r,L=w.s.c,W=[];if(I["!ref"])for(O=w.s.r;O<=w.e.r;++O)if(!S||I["!data"][O]){for(W=[],L=w.s.c;L<=w.e.c;++L)(v=S?I["!data"][O][L]:I[rt(L)+ut(O)])&&v.c&&W.push(u(v.c,O,L));W.length&&d.push(W.join(G))}if(I["!ref"])for(O=w.s.r;O<=w.e.r;++O)if(!S||I["!data"][O]){for(W=[],L=w.s.c;L<=w.e.c;++L)if((v=S?I["!data"][O][L]:I[rt(L)+ut(O)])&&(null!=v.v||v.f&&!v.F)){if("General"!=(v.z||("d"==v.t?Ve[14]:"General"))){var H=m._formats.indexOf(v.z);-1==H&&(m._formats.push(v.z),H=m._formats.length-1,p.push("P;P"+v.z.replace(/;/g,";;"))),W.push("F;P"+H+";Y"+(O+1)+";X"+(L+1))}W.push(g(v,0,O,L,0,X))}d.push(W.join(G))}return p.push("F;P0;DG0G8;M255"),I["!cols"]&&function h(I,m){m.forEach(function(_,p){var d="F;W"+(p+1)+" "+(p+1)+" ";_.hidden?d+="0":("number"==typeof _.width&&!_.wpx&&(_.wpx=Si(_.width)),"number"==typeof _.wpx&&!_.wch&&(_.wch=la(_.wpx)),"number"==typeof _.wch&&(d+=Math.round(_.wch)))," "!=d.charAt(d.length-1)&&I.push(d)})}(p,I["!cols"]),I["!rows"]&&function A(I,m){m.forEach(function(_,p){var d="F;";_.hidden?d+="M0;":_.hpt?d+="M"+20*_.hpt+";":_.hpx&&(d+="M"+20*ca(_.hpx)+";"),d.length>2&&I.push(d+"R"+(p+1))})}(p,I["!rows"]),I["!ref"]&&p.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" ")),p.push("O;L;D;B"+(X?";V4":"")+";K47;G100 0.001"),delete m._formats,p.join(G)+G+d.join(G)+G+"E"+G}}}(),wc=function(){function r(l,g){for(var u=l.split("\n"),h=-1,A=-1,C=0,I=[];C!==u.length;++C)if("BOT"!==u[C].trim()){if(!(h<0)){for(var m=u[C].trim().split(","),_=m[0],p=m[1],d=u[++C]||"";1&(d.match(/["]/g)||[]).length&&C<u.length-1;)d+="\n"+u[++C];switch(d=d.trim(),+_){case-1:if("BOT"===d){I[++h]=[],A=0;continue}if("EOD"!==d)throw new Error("Unrecognized DIF special command "+d);break;case 0:"TRUE"===d?I[h][A]=!0:"FALSE"===d?I[h][A]=!1:isNaN(Lr(p))?isNaN(Yi(p).getDate())?I[h][A]=p:(I[h][A]=Pt(p),g&&g.UTC||(I[h][A]=$n(I[h][A]))):I[h][A]=Lr(p),++A;break;case 1:(d=(d=d.slice(1,d.length-1)).replace(/""/g,'"'))&&d.match(/^=".*"$/)&&(d=d.slice(2,-1)),I[h][A++]=""!==d?d:null}if("EOD"===d)break}}else I[++h]=[],A=0;return g&&g.sheetRows&&(I=I.slice(0,g.sheetRows)),I}function t(l,g){return vi(function e(l,g){switch(g.type){case"base64":return r(Br(l),g);case"binary":return r(l,g);case"buffer":return r(ft&&Buffer.isBuffer(l)?l.toString("binary"):sn(l),g);case"array":return r(Vn(l),g)}throw new Error("Unrecognized type "+g.type)}(l,g),g)}function i(l,g){return"0,"+String(l)+"\r\n"+g}function s(l){return'1,0\r\n"'+l.replace(/"/g,'""')+'"'}return{to_workbook:function n(l,g){var u=Pn(t(l,g),g);return u.bookType="dif",u},to_sheet:t,from_sheet:function o(l){if(!l["!ref"])throw new Error("Cannot export empty sheet to DIF");for(var u=Ct(l["!ref"]),h=null!=l["!data"],A=['TABLE\r\n0,1\r\n"sheetjs"\r\n',"VECTORS\r\n0,"+(u.e.r-u.s.r+1)+'\r\n""\r\n',"TUPLES\r\n0,"+(u.e.c-u.s.c+1)+'\r\n""\r\n','DATA\r\n0,0\r\n""\r\n'],C=u.s.r;C<=u.e.r;++C){for(var I=h?l["!data"][C]:[],m="-1,0\r\nBOT\r\n",_=u.s.c;_<=u.e.c;++_){var p=h?I&&I[_]:l[ht({r:C,c:_})];if(null!=p){switch(p.t){case"n":m+=null!=p.w?"0,"+p.w+"\r\nV":null!=p.v?i(p.v,"V"):null==p.f||p.F?'1,0\r\n""':s("="+p.f);break;case"b":m+=p.v?i(1,"TRUE"):i(0,"FALSE");break;case"s":m+=s(isNaN(+p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=Dr(p.z||Ve[14],Ot(Pt(p.v)))),m+=i(p.w,"V");break;default:m+='1,0\r\n""'}m+="\r\n"}else m+='1,0\r\n""\r\n'}A.push(m)}return A.join("")+"-1,0\r\nEOD"}}}(),yc=function(){function e(A){return A.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n")}function r(A){return A.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function n(A,C){return vi(function t(A,C){for(var I=A.split("\n"),m=-1,_=-1,p=0,d=[];p!==I.length;++p){var w=I[p].trim().split(":");if("cell"===w[0]){var v=Tt(w[1]);if(d.length<=v.r)for(m=d.length;m<=v.r;++m)d[m]||(d[m]=[]);switch(m=v.r,_=v.c,w[2]){case"t":d[m][_]=e(w[3]);break;case"v":d[m][_]=+w[3];break;case"vtf":var S=w[w.length-1];case"vtc":d[m][_]="nl"===w[3]?!!+w[4]:"#"==w[w.length-1].charAt(0)?{t:"e",v:or[w[w.length-1]]}:+w[4],"vtf"==w[2]&&(d[m][_]=[d[m][_],S])}}}return C&&C.sheetRows&&(d=d.slice(0,C.sheetRows)),d}(A,C),C)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),g="--SocialCalcSpreadsheetControlSave--";function u(A){if(!A||!A["!ref"])return"";for(var m,C=[],I=[],_="",p=Ht(A["!ref"]),d=null!=A["!data"],w=p.s.r;w<=p.e.r;++w)for(var v=p.s.c;v<=p.e.c;++v)if(_=ht({r:w,c:v}),(m=d?(A["!data"][w]||[])[v]:A[_])&&null!=m.v&&"z"!==m.t){switch(I=["cell",_,"t"],m.t){case"s":I.push(r(m.v));break;case"b":I[2]="vt"+(m.f?"f":"c"),I[3]="nl",I[4]=m.v?"1":"0",I[5]=r(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var S=Ot(Pt(m.v));I[2]="vtc",I[3]="nd",I[4]=""+S,I[5]=m.w||Dr(m.z||Ve[14],S);break;case"n":isFinite(m.v)?m.f?(I[2]="vtf",I[3]="n",I[4]=m.v,I[5]=r(m.f)):(I[2]="v",I[3]=m.v):(I[2]="vt"+(m.f?"f":"c"),I[3]="e"+rr[isNaN(m.v)?36:7],I[4]="0",I[5]=m.f||I[3].slice(1),I[6]="e",I[7]=I[3].slice(1));break;case"e":continue}C.push(I.join(":"))}return C.push("sheet:c:"+(p.e.c-p.s.c+1)+":r:"+(p.e.r-p.s.r+1)+":tvf:1"),C.push("valueformat:1:text-wiki"),C.join("\n")}return{to_workbook:function i(A,C){return Pn(n(A,C),C)},to_sheet:n,from_sheet:function h(A){return[s,o,l,o,u(A),g].join("\n")}}}(),Ti=function(){function e(h,A,C,I,m){m.raw?A[C][I]=h:""===h||(A[C][I]="TRUE"===h||"FALSE"!==h&&(isNaN(Lr(h))?isNaN(Yi(h).getDate())?35==h.charCodeAt(0)&&null!=or[h]?{t:"e",v:or[h],w:h}:h:Pt(h):Lr(h)))}var t={44:",",9:"\t",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(h){for(var A={},C=!1,I=0,m=0;I<h.length;++I)34==(m=h.charCodeAt(I))?C=!C:!C&&m in t&&(A[m]=(A[m]||0)+1);for(I in m=[],A)Object.prototype.hasOwnProperty.call(A,I)&&m.push([A[I],I]);if(!m.length)for(I in A=n)Object.prototype.hasOwnProperty.call(A,I)&&m.push([A[I],I]);return m.sort(function(_,p){return _[0]-p[0]||n[_[1]]-n[p[1]]}),t[m.pop()[1]]||44}function o(h,A){return!A||!A.PRN||A.FS||"sep="==h.slice(0,4)||h.indexOf("\t")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?function s(h,A){var C=A||{},I="";null!=Gt&&null==C.dense&&(C.dense=Gt);var m={};C.dense&&(m["!data"]=[]);var _={s:{c:0,r:0},e:{c:0,r:0}};"sep="==h.slice(0,4)?13==h.charCodeAt(5)&&10==h.charCodeAt(6)?(I=h.charAt(4),h=h.slice(7)):13==h.charCodeAt(5)||10==h.charCodeAt(5)?(I=h.charAt(4),h=h.slice(6)):I=i(h.slice(0,1024)):I=C&&C.FS?C.FS:i(h.slice(0,1024));var p=0,d=0,w=0,v=0,S=0,G=I.charCodeAt(0),X=!1,E=0,O=h.charCodeAt(0),L=null!=C.dateNF?function Ap(e){var r="number"==typeof e?Ve[e]:e;return r=r.replace(Ya,"(\\d+)"),Ya.lastIndex=0,new RegExp("^"+r+"$")}(C.dateNF):null;function W(){var H=h.slice(v,S);"\r"==H.slice(-1)&&(H=H.slice(0,-1));var Y={};if('"'==H.charAt(0)&&'"'==H.charAt(H.length-1)&&(H=H.slice(1,-1).replace(/""/g,'"')),!1!==C.cellText&&(Y.w=H),0===H.length)Y.t="z";else if(C.raw)Y.t="s",Y.v=H;else if(0===H.trim().length)Y.t="s",Y.v=H;else if(61==H.charCodeAt(0))34==H.charCodeAt(1)&&34==H.charCodeAt(H.length-1)?(Y.t="s",Y.v=H.slice(2,-1).replace(/""/g,'"')):function l2(e){return 1!=e.length}(H)?(Y.t="s",Y.f=H.slice(1),Y.v=H):(Y.t="s",Y.v=H);else if("TRUE"==H)Y.t="b",Y.v=!0;else if("FALSE"==H)Y.t="b",Y.v=!1;else if(isNaN(w=Lr(H)))if(!isNaN((w=Yi(H)).getDate())||L&&H.match(L)){if(Y.z=C.dateNF||Ve[14],L&&H.match(L)){var ee=function pp(e,r,t){var n=-1,i=-1,s=-1,o=-1,l=-1,g=-1;(r.match(Ya)||[]).forEach(function(A,C){var I=parseInt(t[C+1],10);switch(A.toLowerCase().charAt(0)){case"y":n=I;break;case"d":s=I;break;case"h":o=I;break;case"s":g=I;break;case"m":o>=0?l=I:i=I}}),Ya.lastIndex=0,g>=0&&-1==l&&i>=0&&(l=i,i=-1);var u=(""+(n>=0?n:(new Date).getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);7==u.length&&(u="0"+u),8==u.length&&(u="20"+u);var h=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(g>=0?g:0)).slice(-2);return-1==o&&-1==l&&-1==g?u:-1==n&&-1==i&&-1==s?h:u+"T"+h}(0,C.dateNF,H.match(L)||[]);w=Pt(ee),C&&!1===C.UTC&&(w=$n(w))}else C&&!1===C.UTC?w=$n(w):!1!==C.cellText&&C.dateNF&&(Y.w=Dr(Y.z,w));C.cellDates?(Y.t="d",Y.v=w):(Y.t="n",Y.v=Ot(w)),C.cellNF||delete Y.z}else 35==H.charCodeAt(0)&&null!=or[H]?(Y.t="e",Y.w=H,Y.v=or[H]):(Y.t="s",Y.v=H);else Y.t="n",Y.v=w;if("z"==Y.t||(C.dense?(m["!data"][p]||(m["!data"][p]=[]),m["!data"][p][d]=Y):m[ht({c:d,r:p})]=Y),O=h.charCodeAt(v=S+1),_.e.c<d&&(_.e.c=d),_.e.r<p&&(_.e.r=p),E==G)++d;else if(d=0,++p,C.sheetRows&&C.sheetRows<=p)return!0}e:for(;S<h.length;++S)switch(E=h.charCodeAt(S)){case 34:34===O&&(X=!X);break;case 13:if(X)break;10==h.charCodeAt(S+1)&&++S;case G:case 10:if(!X&&W())break e}return S-v>0&&W(),m["!ref"]=ot(_),m}(h,A):vi(function r(h,A){var C=A||{},I=[];if(!h||0===h.length)return I;for(var m=h.split(/[\r\n]/),_=m.length-1;_>=0&&0===m[_].length;)--_;for(var p=10,d=0,w=0;w<=_;++w)-1==(d=m[w].indexOf(" "))?d=m[w].length:d++,p=Math.max(p,d);for(w=0;w<=_;++w){I[w]=[];var v=0;for(e(m[w].slice(0,p).trim(),I,w,v,C),v=1;v<=(m[w].length-p)/10+1;++v)e(m[w].slice(p+10*(v-1),p+10*v).trim(),I,w,v,C)}return C.sheetRows&&(I=I.slice(0,C.sheetRows)),I}(h,A),A)}function l(h,A){var C="",I="string"==A.type?[0,0,0,0]:Xo(h,A);switch(A.type){case"base64":C=Br(h);break;case"binary":case"string":C=h;break;case"buffer":C=65001==A.codepage?h.toString("utf8"):A.codepage&&typeof gt<"u"?gt.utils.decode(A.codepage,h):ft&&Buffer.isBuffer(h)?h.toString("binary"):sn(h);break;case"array":C=Vn(h);break;default:throw new Error("Unrecognized type "+A.type)}return 239==I[0]&&187==I[1]&&191==I[2]?C=yt(C.slice(3)):"string"!=A.type&&"buffer"!=A.type&&65001==A.codepage?C=yt(C):"binary"==A.type&&typeof gt<"u"&&A.codepage&&(C=gt.utils.decode(A.codepage,gt.utils.encode(28591,C))),"socialcalc:version:"==C.slice(0,19)?yc.to_sheet("string"==A.type?C:yt(C),A):o(C,A)}return{to_workbook:function g(h,A){return Pn(l(h,A),A)},to_sheet:l,from_sheet:function u(h){var A=[];if(!h["!ref"])return"";for(var I,C=Ct(h["!ref"]),m=null!=h["!data"],_=C.s.r;_<=C.e.r;++_){for(var p=[],d=C.s.c;d<=C.e.c;++d){var w=ht({r:_,c:d});if((I=m?(h["!data"][_]||[])[d]:h[w])&&null!=I.v){for(var v=(I.w||(gn(I),I.w)||"").slice(0,10);v.length<10;)v+=" ";p.push(v+(0===d?" ":""))}else p.push("          ")}A.push(p.join(""))}return A.join("\n")}}}(),ii=function(){function e(D,z,j){if(D){er(D,D.l||0);for(var U=j.Enum||he;D.l<D.length;){var ae=D.read_shift(2),N=U[ae]||U[65535],De=D.read_shift(2),we=D.l+De,ge=N.f&&N.f(D,De,j);if(D.l=we,z(ge,N,ae))return}}}var t=["mmmm","dd-mmm-yyyy","dd-mmm","mmm-yyyy","@","mm/dd","hh:mm:ss AM/PM","hh:mm AM/PM","mm/dd/yyyy","mm/dd","hh:mm:ss","hh:mm"];function n(D,z){if(!D)return D;var j=z||{};null!=Gt&&null==j.dense&&(j.dense=Gt);var U={},ae="Sheet1",N="",De=0,we={},ge=[],He=[],et=[];j.dense&&(et=U["!data"]=[]);var Ee={s:{r:0,c:0},e:{r:0,c:0}},mt=j.sheetRows||0,_t={};if(81==D[4]&&80==D[5]&&87==D[6])return function Ne(D,z){er(D,0);var j=z||{};null!=Gt&&null==j.dense&&(j.dense=Gt);var U={};j.dense&&(U["!data"]=[]);var ae=[],N="",we={s:{r:-1,c:-1},e:{r:-1,c:-1}},ge=0,He=0,et=0,Ee=0,mt={SheetNames:[],Sheets:{}},_t=[];e:for(;D.l<D.length;){var Dt=D.read_shift(2),Lt=D.read_shift(2),de=D.slice(D.l,D.l+Lt);switch(er(de,0),Dt){case 1:if(962023505!=de.read_shift(4))throw"Bad QPW9 BOF!";break;case 2:break e;case 8:case 1025:case 1026:case 1032:default:break;case 10:for(var xe=de.read_shift(4),fr=(de.length-de.l)/xe|0,Wt=0;Wt<xe;++Wt){var Rt=de.l+fr,Jt={};de.l+=2,Jt.numFmtId=de.read_shift(2),Ue[Jt.numFmtId]&&(Jt.z=Ue[Jt.numFmtId]),de.l=Rt,_t.push(Jt)}break;case 1031:for(de.l+=12;de.l<de.length;)ge=de.read_shift(2),He=de.read_shift(1),ae.push(de.read_shift(ge,"cstr"));break;case 1537:var lr=de.read_shift(2);U={},j.dense&&(U["!data"]=[]),we.s.c=de.read_shift(2),we.e.c=de.read_shift(2),we.s.r=de.read_shift(4),we.e.r=de.read_shift(4),de.l+=4,de.l+2<de.length&&(ge=de.read_shift(2),He=de.read_shift(1),N=0==ge?"":de.read_shift(ge,"cstr")),N||(N=rt(lr));break;case 1538:if(we.s.c>255||we.s.r>999999)break;we.e.c<we.s.c&&(we.e.c=we.s.c),we.e.r<we.s.r&&(we.e.r=we.s.r),U["!ref"]=ot(we),Ta(mt,U,N);break;case 2561:et=de.read_shift(2),we.e.c<et&&(we.e.c=et),we.s.c>et&&(we.s.c=et),Ee=de.read_shift(4),we.s.r>Ee&&(we.s.r=Ee),Ee=de.read_shift(4),we.e.r<Ee&&(we.e.r=Ee);break;case 3073:Ee=de.read_shift(4),ge=de.read_shift(4),we.s.r>Ee&&(we.s.r=Ee),we.e.r<Ee+ge-1&&(we.e.r=Ee+ge-1);for(var Je=rt(et);de.l<de.length;){var ze={t:"z"},vt=de.read_shift(1),bt=-1;128&vt&&(bt=de.read_shift(2));var Pi=64&vt?de.read_shift(2)-1:0;switch(31&vt){case 0:case 1:break;case 2:ze={t:"n",v:de.read_shift(2)};break;case 3:ze={t:"n",v:de.read_shift(2,"i")};break;case 4:ze={t:"n",v:rs(de)};break;case 5:ze={t:"n",v:de.read_shift(8,"f")};break;case 7:ze={t:"s",v:ae[He=de.read_shift(4)-1]};break;case 8:ze={t:"n",v:de.read_shift(8,"f")},de.l+=2,de.l+=4,isNaN(ze.v)&&(ze={t:"e",v:15});break;default:throw"Unrecognized QPW cell type "+(31&vt)}-1!=bt&&(_t[bt-1]||{}).z&&(ze.z=_t[bt-1].z);var ur=0;if(32&vt)switch(31&vt){case 2:case 7:ur=de.read_shift(2);break;case 3:ur=de.read_shift(2,"i");break;default:throw"Unsupported delta for QPW cell type "+(31&vt)}if(j.sheetStubs||"z"!=ze.t){var An=xt(ze);"n"==ze.t&&ze.z&&Mr(ze.z)&&j.cellDates&&(An.v=xn(ze.v),An.t="number"==typeof An.v?"n":"d"),null!=U["!data"]?(U["!data"][Ee]||(U["!data"][Ee]=[]),U["!data"][Ee][et]=An):U[Je+ut(Ee)]=An}for(++Ee,--ge;Pi-- >0&&ge>=0;){if(32&vt)switch(31&vt){case 2:ze={t:"n",v:ze.v+ur&65535};break;case 3:(ze={t:"n",v:ze.v+ur&65535}).v>32767&&(ze.v-=65536);break;case 7:ze={t:"s",v:ae[He=He+ur>>>0]};break;default:throw"Cannot apply delta for QPW cell type "+(31&vt)}else switch(31&vt){case 1:ze={t:"z"};break;case 2:ze={t:"n",v:de.read_shift(2)};break;case 7:ze={t:"s",v:ae[He=de.read_shift(4)-1]};break;default:throw"Cannot apply repeat for QPW cell type "+(31&vt)}!j.sheetStubs&&"z"==ze.t||(null!=U["!data"]?(U["!data"][Ee]||(U["!data"][Ee]=[]),U["!data"][Ee][et]=ze):U[Je+ut(Ee)]=ze),++Ee,--ge}}break;case 3074:et=de.read_shift(2),Ee=de.read_shift(4);var tt=ve(de);null!=U["!data"]?(U["!data"][Ee]||(U["!data"][Ee]=[]),U["!data"][Ee][et]={t:"s",v:tt}):U[rt(et)+ut(Ee)]={t:"s",v:tt}}D.l+=Lt}return mt}(D,z);if(0==D[2]&&(8==D[3]||9==D[3])&&D.length>=16&&5==D[14]&&108===D[15])throw new Error("Unsupported Works 3 for Mac file");if(2==D[2])j.Enum=he,e(D,function(xe,fr,Wt){switch(Wt){case 0:j.vers=xe,xe>=4096&&(j.qpro=!0);break;case 255:j.vers=xe,j.works=!0;break;case 6:Ee=xe;break;case 204:xe&&(N=xe);break;case 222:N=xe;break;case 15:case 51:(!j.qpro&&!j.works||51==Wt)&&xe[1].v.charCodeAt(0)<48&&(xe[1].v=xe[1].v.slice(1)),(j.works||j.works2)&&(xe[1].v=xe[1].v.replace(/\r\n/g,"\n"));case 13:case 14:case 16:!(112&~xe[2])&&(15&xe[2])>1&&(15&xe[2])<15&&(xe[1].z=j.dateNF||t[(15&xe[2])-1]||Ve[14],j.cellDates&&(xe[1].v=xn(xe[1].v),xe[1].t="number"==typeof xe[1].v?"n":"d")),j.qpro&&xe[3]>De&&(U["!ref"]=ot(Ee),we[ae]=U,ge.push(ae),U={},j.dense&&(et=U["!data"]=[]),Ee={s:{r:0,c:0},e:{r:0,c:0}},De=xe[3],ae=N||"Sheet"+(De+1),N="");var Rt=j.dense?(et[xe[0].r]||[])[xe[0].c]:U[ht(xe[0])];if(Rt){Rt.t=xe[1].t,Rt.v=xe[1].v,null!=xe[1].z&&(Rt.z=xe[1].z),null!=xe[1].f&&(Rt.f=xe[1].f),_t=Rt;break}j.dense?(et[xe[0].r]||(et[xe[0].r]=[]),et[xe[0].r][xe[0].c]=xe[1]):U[ht(xe[0])]=xe[1],_t=xe[1];break;case 21509:j.works2=!0;break;case 21506:5281==xe&&(_t.z="hh:mm:ss",j.cellDates&&"n"==_t.t&&(_t.v=xn(_t.v),_t.t="number"==typeof _t.v?"n":"d"))}},j);else{if(26!=D[2]&&14!=D[2])throw new Error("Unrecognized LOTUS BOF "+D[2]);j.Enum=Ce,14==D[2]&&(j.qpro=!0,D.l=0),e(D,function(xe,fr,Wt){switch(Wt){case 204:ae=xe;break;case 22:xe[1].v.charCodeAt(0)<48&&(xe[1].v=xe[1].v.slice(1)),xe[1].v=xe[1].v.replace(/\x0F./g,function(Rt){return String.fromCharCode(Rt.charCodeAt(1)-32)}).replace(/\r\n/g,"\n");case 23:case 24:case 25:case 37:case 39:case 40:if(xe[3]>De&&(U["!ref"]=ot(Ee),we[ae]=U,ge.push(ae),U={},j.dense&&(et=U["!data"]=[]),Ee={s:{r:0,c:0},e:{r:0,c:0}},ae="Sheet"+((De=xe[3])+1)),mt>0&&xe[0].r>=mt)break;j.dense?(et[xe[0].r]||(et[xe[0].r]=[]),et[xe[0].r][xe[0].c]=xe[1]):U[ht(xe[0])]=xe[1],Ee.e.c<xe[0].c&&(Ee.e.c=xe[0].c),Ee.e.r<xe[0].r&&(Ee.e.r=xe[0].r);break;case 27:xe[14e3]&&(He[xe[14e3][0]]=xe[14e3][1]);break;case 1537:He[xe[0]]=xe[1],xe[0]==De&&(ae=xe[1])}},j)}if(U["!ref"]=ot(Ee),we[N||ae]=U,ge.push(N||ae),!He.length)return{SheetNames:ge,Sheets:we};for(var Dt={},Lt=[],de=0;de<He.length;++de)we[ge[de]]?(Lt.push(He[de]||ge[de]),Dt[He[de]]=we[He[de]]||we[ge[de]]):(Lt.push(He[de]),Dt[He[de]]={"!ref":"A1"});return{SheetNames:Lt,Sheets:Dt}}function h(D,z,j){var U=[{c:0,r:0},{t:"n",v:0},0,0];return j.qpro&&20768!=j.vers?(U[0].c=D.read_shift(1),U[3]=D.read_shift(1),U[0].r=D.read_shift(2),D.l+=2):j.works?(U[0].c=D.read_shift(2),U[0].r=D.read_shift(2),U[2]=D.read_shift(2)):(U[2]=D.read_shift(1),U[0].c=D.read_shift(2),U[0].r=D.read_shift(2)),U}function A(D){return D.z&&Mr(D.z)?240|(t.indexOf(D.z)+1||2):255}function I(D,z,j){var U=J(7+j.length);U.write_shift(1,255),U.write_shift(2,z),U.write_shift(2,D),U.write_shift(1,39);for(var ae=0;ae<U.length;++ae){var N=j.charCodeAt(ae);U.write_shift(1,N>=128?95:N)}return U.write_shift(1,0),U}function p(D,z,j){var U=J(7);return U.write_shift(1,A(j)),U.write_shift(2,z),U.write_shift(2,D),U.write_shift(2,j.v,"i"),U}function w(D,z,j){var U=J(13);return U.write_shift(1,A(j)),U.write_shift(2,z),U.write_shift(2,D),U.write_shift(8,j.v,"f"),U}function S(D,z,j){var U=32768&z;return z=(U?D:0)+((z&=-32769)>=8192?z-16384:z),(U?"":"$")+(j?rt(z):ut(z))}var G={31:["NA",0],33:["ABS",1],34:["TRUNC",1],35:["SQRT",1],36:["LOG",1],37:["LN",1],38:["PI",0],39:["SIN",1],40:["COS",1],41:["TAN",1],42:["ATAN2",2],43:["ATAN",1],44:["ASIN",1],45:["ACOS",1],46:["EXP",1],47:["MOD",2],49:["ISNA",1],50:["ISERR",1],51:["FALSE",0],52:["TRUE",0],53:["RAND",0],54:["DATE",3],63:["ROUND",2],64:["TIME",3],68:["ISNUMBER",1],69:["ISTEXT",1],70:["LEN",1],71:["VALUE",1],73:["MID",3],74:["CHAR",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],102:["UPPER",1],103:["LOWER",1],107:["PROPER",1],109:["TRIM",1],111:["T",1]},X=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function O(D){var z=[{c:0,r:0},{t:"n",v:0},0];return z[0].r=D.read_shift(2),z[3]=D[D.l++],z[0].c=D[D.l++],z}function W(D,z,j,U){var ae=J(6+U.length);ae.write_shift(2,D),ae.write_shift(1,j),ae.write_shift(1,z),ae.write_shift(1,39);for(var N=0;N<U.length;++N){var De=U.charCodeAt(N);ae.write_shift(1,De>=128?95:De)}return ae.write_shift(1,0),ae}function Y(D,z){var j=O(D),U=D.read_shift(4),ae=D.read_shift(4),N=D.read_shift(2);if(65535==N)return 0===U&&3221225472===ae?(j[1].t="e",j[1].v=15):0===U&&3489660928===ae?(j[1].t="e",j[1].v=42):j[1].v=0,j;var De=32768&N;return N=(32767&N)-16446,j[1].v=(1-2*De)*(ae*Math.pow(2,N+32)+U*Math.pow(2,N)),j}function ee(D,z,j,U){var ae=J(14);if(ae.write_shift(2,D),ae.write_shift(1,j),ae.write_shift(1,z),0==U)return ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(2,65535),ae;var N=0,De=0,ge=0;return U<0&&(N=1,U=-U),De=0|Math.log2(U),2147483648&(ge=(U/=Math.pow(2,De-31))>>>0)||(++De,ge=(U/=2)>>>0),U-=ge,ge|=2147483648,ge>>>=0,U*=Math.pow(2,32),ae.write_shift(4,U>>>0),ae.write_shift(4,ge),ae.write_shift(2,De+=16383+(N?32768:0)),ae}function Pe(D,z){var j=O(D),U=D.read_shift(8,"f");return j[1].v=U,j}function Re(D,z){return 0==D[D.l+z-1]?D.read_shift(z,"cstr"):""}function re(D,z){var j=J(5+D.length);j.write_shift(2,14e3),j.write_shift(2,z);for(var U=0;U<D.length;++U){var ae=D.charCodeAt(U);j[j.l++]=ae>127?95:ae}return j[j.l++]=0,j}var he={0:{n:"BOF",f:Mt},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function g(D,z,j){var U={s:{c:0,r:0},e:{c:0,r:0}};return 8==z&&j.qpro?(U.s.c=D.read_shift(1),D.l++,U.s.r=D.read_shift(2),U.e.c=D.read_shift(1),D.l++,U.e.r=D.read_shift(2),U):(U.s.c=D.read_shift(2),U.s.r=D.read_shift(2),12==z&&j.qpro&&(D.l+=2),U.e.c=D.read_shift(2),U.e.r=D.read_shift(2),12==z&&j.qpro&&(D.l+=2),65535==U.s.c&&(U.s.c=U.e.c=U.s.r=U.e.r=0),U)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function _(D,z,j){var U=h(D,0,j);return U[1].v=D.read_shift(2,"i"),U}},14:{n:"NUMBER",f:function d(D,z,j){var U=h(D,0,j);return U[1].v=D.read_shift(8,"f"),U}},15:{n:"LABEL",f:function C(D,z,j){var U=D.l+z,ae=h(D,0,j);if(ae[1].t="s",20768==(65534&j.vers)){D.l++;var N=D.read_shift(1);return ae[1].v=D.read_shift(N,"utf8"),ae}return j.qpro&&D.l++,ae[1].v=D.read_shift(U-D.l,"cstr"),ae}},16:{n:"FORMULA",f:function v(D,z,j){var U=D.l+z,ae=h(D,0,j);if(ae[1].v=D.read_shift(8,"f"),j.qpro)D.l=U;else{var N=D.read_shift(2);(function E(D,z){er(D,0);for(var j=[],U=0,ae="",N="",De="",we="";D.l<D.length;){var ge=D[D.l++];switch(ge){case 0:j.push(D.read_shift(8,"f"));break;case 1:N=S(z[0].c,D.read_shift(2),!0),ae=S(z[0].r,D.read_shift(2),!1),j.push(N+ae);break;case 2:var He=S(z[0].c,D.read_shift(2),!0),et=S(z[0].r,D.read_shift(2),!1);N=S(z[0].c,D.read_shift(2),!0),ae=S(z[0].r,D.read_shift(2),!1),j.push(He+et+":"+N+ae);break;case 3:if(D.l<D.length)return void console.error("WK1 premature formula end");break;case 4:j.push("("+j.pop()+")");break;case 5:j.push(D.read_shift(2));break;case 6:for(var Ee="";ge=D[D.l++];)Ee+=String.fromCharCode(ge);j.push('"'+Ee.replace(/"/g,'""')+'"');break;case 8:j.push("-"+j.pop());break;case 23:j.push("+"+j.pop());break;case 22:j.push("NOT("+j.pop()+")");break;case 20:case 21:we=j.pop(),De=j.pop(),j.push(["AND","OR"][ge-20]+"("+De+","+we+")");break;default:if(ge<32&&X[ge])we=j.pop(),De=j.pop(),j.push(De+X[ge]+we);else{if(!G[ge])return ge<=7?console.error("WK1 invalid opcode "+ge.toString(16)):ge<=24?console.error("WK1 unsupported op "+ge.toString(16)):ge<=30?console.error("WK1 invalid opcode "+ge.toString(16)):ge<=115?console.error("WK1 unsupported function opcode "+ge.toString(16)):console.error("WK1 unrecognized opcode "+ge.toString(16));if(69==(U=G[ge][1])&&(U=D[D.l++]),U>j.length)return void console.error("WK1 bad formula parse 0x"+ge.toString(16)+":|"+j.join("|")+"|");var mt=j.slice(-U);j.length-=U,j.push(G[ge][0]+"("+mt.join(",")+")")}}}1==j.length?z[1].f=""+j[0]:console.error("WK1 bad formula parse |"+j.join("|")+"|")})(D.slice(D.l,D.l+N),ae),D.l+=N}return ae}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:function m(D,z,j){var U=D.l+z,ae=h(D,0,j);if(ae[1].t="s",20768==j.vers){var N=D.read_shift(1);return ae[1].v=D.read_shift(N,"utf8"),ae}return ae[1].v=D.read_shift(U-D.l,"cstr"),ae}},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Re},222:{n:"SHEETNAMELP",f:function Xe(D,z){var j=D[D.l++];j>z-1&&(j=z-1);for(var U="";U.length<j;)U+=String.fromCharCode(D[D.l++]);return U}},255:{n:"BOF",f:Mt},21506:{n:"WKSNF",f:Mt},65535:{n:""}},Ce={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function L(D,z){var j=O(D);return j[1].t="s",j[1].v=D.read_shift(z-4,"cstr"),j}},23:{n:"NUMBER17",f:Y},24:{n:"NUMBER18",f:function H(D,z){var j=O(D);j[1].v=D.read_shift(2);var U=j[1].v>>1;if(1&j[1].v)switch(7&U){case 0:U=5e3*(U>>3);break;case 1:U=500*(U>>3);break;case 2:U=(U>>3)/20;break;case 3:U=(U>>3)/200;break;case 4:U=(U>>3)/2e3;break;case 5:U=(U>>3)/2e4;break;case 6:U=(U>>3)/16;break;case 7:U=(U>>3)/64}return j[1].v=U,j}},25:{n:"FORMULA19",f:function Te(D,z){var j=Y(D);return D.l+=z-14,j}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function Ke(D,z){for(var j={},U=D.l+z;D.l<U;){var ae=D.read_shift(2);if(14e3==ae){for(j[ae]=[0,""],j[ae][0]=D.read_shift(2);D[D.l];)j[ae][1]+=String.fromCharCode(D[D.l]),D.l++;D.l++}}return j}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function le(D,z){var j=O(D),U=D.read_shift(4);return j[1].v=U>>6,j}},38:{n:"??"},39:{n:"NUMBER27",f:Pe},40:{n:"FORMULA28",f:function ce(D,z){var j=Pe(D);return D.l+=z-12,j}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Re},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function ue(D,z,j){if(j.qpro&&!(z<21)){var U=D.read_shift(1);return D.l+=17,D.l+=1,D.l+=2,[U,D.read_shift(z-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}},Ue={5:"dd-mmm-yy",6:"dd-mmm",7:"mmm-yy",8:"mm/dd/yy",10:"hh:mm:ss AM/PM",11:"hh:mm AM/PM",14:"dd-mmm-yyyy",15:"mmm-yyyy",34:"0.00",50:"0.00;[Red]0.00",66:"0.00;(0.00)",82:"0.00;[Red](0.00)",162:'"$"#,##0.00;\\("$"#,##0.00\\)',288:"0%",304:"0E+00",320:"# ?/?"};function ve(D){var z=D.read_shift(2),j=D.read_shift(1);if(0!=j)throw"unsupported QPW string type "+j.toString(16);return D.read_shift(z,"sbcs-cont")}return{sheet_to_wk1:function i(D,z){var j=z||{};if(+j.codepage>=0&&Vr(+j.codepage),"string"==j.type)throw new Error("Cannot write WK1 to JS string");var U=Ir();if(!D["!ref"])throw new Error("Cannot export empty sheet to WK1");var ae=Ct(D["!ref"]),N=null!=D["!data"],De=[];fe(U,0,function o(D){var z=J(2);return z.write_shift(2,D),z}(1030)),fe(U,6,function u(D){var z=J(8);return z.write_shift(2,D.s.c),z.write_shift(2,D.s.r),z.write_shift(2,D.e.c),z.write_shift(2,D.e.r),z}(ae));for(var we=Math.min(ae.e.r,8191),ge=ae.s.c;ge<=ae.e.c;++ge)De[ge]=rt(ge);for(var He=ae.s.r;He<=we;++He){var et=ut(He);for(ge=ae.s.c;ge<=ae.e.c;++ge){var Ee=N?(D["!data"][He]||[])[ge]:D[De[ge]+et];if(Ee&&"z"!=Ee.t)switch(Ee.t){case"n":(0|Ee.v)==Ee.v&&Ee.v>=-32768&&Ee.v<=32767?fe(U,13,p(He,ge,Ee)):fe(U,14,w(He,ge,Ee));break;case"d":var mt=Ot(Ee.v);(0|mt)==mt&&mt>=-32768&&mt<=32767?fe(U,13,p(He,ge,{t:"n",v:mt,z:Ee.z||Ve[14]})):fe(U,14,w(He,ge,{t:"n",v:mt,z:Ee.z||Ve[14]}));break;default:fe(U,15,I(He,ge,gn(Ee).slice(0,239)))}}}return fe(U,1),U.end()},book_to_wk3:function s(D,z){var j=z||{};if(+j.codepage>=0&&Vr(+j.codepage),"string"==j.type)throw new Error("Cannot write WK3 to JS string");var U=Ir();fe(U,0,function l(D){var z=J(26);z.write_shift(2,4096),z.write_shift(2,4),z.write_shift(4,0);for(var j=0,U=0,ae=0,N=0;N<D.SheetNames.length;++N){var we=D.Sheets[D.SheetNames[N]];if(we&&we["!ref"]){++ae;var ge=Ht(we["!ref"]);j<ge.e.r&&(j=ge.e.r),U<ge.e.c&&(U=ge.e.c)}}return j>8191&&(j=8191),z.write_shift(2,j),z.write_shift(1,ae),z.write_shift(1,U),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(1,1),z.write_shift(1,2),z.write_shift(4,0),z.write_shift(4,0),z}(D));for(var ae=0,N=0;ae<D.SheetNames.length;++ae)(D.Sheets[D.SheetNames[ae]]||{})["!ref"]&&fe(U,27,re(D.SheetNames[ae],N++));var De=0;for(ae=0;ae<D.SheetNames.length;++ae){var we=D.Sheets[D.SheetNames[ae]];if(we&&we["!ref"]){for(var ge=Ct(we["!ref"]),He=null!=we["!data"],et=[],Ee=Math.min(ge.e.r,8191),mt=ge.s.r;mt<=Ee;++mt)for(var _t=ut(mt),Dt=ge.s.c;Dt<=ge.e.c;++Dt){mt===ge.s.r&&(et[Dt]=rt(Dt));var de=He?(we["!data"][mt]||[])[Dt]:we[et[Dt]+_t];de&&"z"!=de.t&&("n"==de.t?fe(U,23,ee(mt,Dt,De,de.v)):fe(U,22,W(mt,Dt,De,gn(de).slice(0,239))))}++De}}return fe(U,1),U.end()},to_workbook:function r(D,z){switch(z.type){case"base64":return n(wr(Br(D)),z);case"binary":return n(wr(D),z);case"buffer":case"array":return n(D,z)}throw"Unsupported type "+z.type}}}(),Zm=function(){function e(n){var i=ir(n,"t");if(!i)return{t:"s",v:""};var s={t:"s",v:pt(i[1])},o=ir(n,"rPr");return o&&(s.s=function Km(e){var r={},t=e.match(cr),n=0,i=!1;if(t)for(;n!=t.length;++n){var s=Me(t[n]);switch(s[0].replace(/<\w*:/g,"<")){case"<condense":case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if("1"==s.val)break;r.cp=Ds[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=s.val;break;case"<sz":r.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting"}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if("0"==s.val)break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if("0"==s.val)break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":s.rgb&&(r.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":r.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":r.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":case"<scheme>":case"<scheme/>":case"</scheme>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(47!==s[0].charCodeAt(1)&&!i)throw new Error("Unrecognized rich format "+s[0])}}return r}(o[1])),s}var r=/<(?:\w+:)?r>/g,t=/<\/(?:\w+:)?r>/;return function(i){return i.replace(r,"").split(t).map(e).filter(function(s){return s.v})}}(),Qm=function(){var r=/(\r\n|\n)/g;function n(i){var s=[[],i.v,[]];return i.v?(i.s&&function t(i,s,o){var l=[];i.u&&l.push("text-decoration: underline;"),i.uval&&l.push("text-underline-style:"+i.uval+";"),i.sz&&l.push("font-size:"+i.sz+"pt;"),i.outline&&l.push("text-effect: outline;"),i.shadow&&l.push("text-shadow: auto;"),s.push('<span style="'+l.join("")+'">'),i.b&&(s.push("<b>"),o.push("</b>")),i.i&&(s.push("<i>"),o.push("</i>")),i.strike&&(s.push("<s>"),o.push("</s>"));var g=i.valign||"";"superscript"==g||"super"==g?g="sup":"subscript"==g&&(g="sub"),""!=g&&(s.push("<"+g+">"),o.push("</"+g+">")),o.push("</span>")}(i.s,s[0],s[2]),s[0].join("")+s[1].replace(r,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),qm=/<(?:\w+:)?t\b[^<>]*>([^<]*)<\/(?:\w+:)?t>/g,e_=/<(?:\w+:)?r\b[^<>]*>/;function mo(e,r){var t=!r||r.cellHTML,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=pt(yt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||""),!0),n.r=yt(e),t&&(n.h=Ki(n.t))):e.match(e_)&&(n.r=yt(e),n.t=pt(yt((Bp(e,"rPh").match(qm)||[]).join("").replace(cr,"")),!0),t&&(n.h=Qm(Zm(n.r)))),n):{t:""}}var t_=/<(?:\w+:)?(?:si|sstItem)>/g,r_=/<\/(?:\w+:)?(?:si|sstItem)>/,i_=/^\s|\s$|[\t\n\r]/,c_=function ud(e,r){var t=!1;return null==r&&(t=!0,r=J(15+4*e.t.length)),r.write_shift(1,0),tr(e.t,r),t?r.slice(0,r.l):r};function Tc(e){if(typeof gt<"u")return gt.utils.encode(Un,e);for(var r=[],t=e.split(""),n=0;n<t.length;++n)r[n]=t[n].charCodeAt(0);return r}function yn(e,r){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),r>=4&&(e.l+=r-4),t}function u_(e){for(var r=e.read_shift(4),t=e.l+r-4,n={},i=e.read_shift(4),s=[];i-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return n}function Sc(e,r){var t=e.l+r,n={};n.Flags=63&e.read_shift(4),e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=36==n.Flags;break;case 26625:i=4==n.Flags;break;case 0:i=16==n.Flags||4==n.Flags||36==n.Flags;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,n}function bc(e,r){var t={},n=e.l+r;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,n),e.l=n,t}function d_(e){if(36!=(63&e.read_shift(4)))throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4);return{t:"Std",h:Sc(e,t),v:bc(e,e.length-e.l)}}function m_(){throw new Error("File is password-protected: ECMA-376 Extensible")}function __(e){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),n={};return t.replace(cr,function(s){var o=Me(s);switch(Xr(o[0])){case"<?xml":case"<encryption":case"</encryption>":case"</keyEncryptors>":case"</keyEncryptor>":break;case"<keyData":r.forEach(function(l){n[l]=o[l]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"<keyEncryptor":n.uri=o.uri;break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function _o(e){var t,s,r=0,n=Tc(e),i=n.length+1;for((t=Dn(i))[0]=n.length,s=1;s!=i;++s)t[s]=n[s-1];for(s=i-1;s>=0;--s)r=((16384&r?1:0)|r<<1&32767)^t[s];return 52811^r}var Ec=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],i=function(o,l){return function(o){return 255&(o/2|128*o)}(o^l)};return function(o){for(var l=Tc(o),g=function(o){for(var l=r[o.length-1],g=104,u=o.length-1;u>=0;--u)for(var h=o[u],A=0;7!=A;++A)64&h&&(l^=t[g]),h*=2,--g;return l}(l),u=l.length,h=Dn(16),A=0;16!=A;++A)h[A]=0;var m;for(!(1&~u)&&(h[u]=i(e[0],g>>8),h[--u]=i(l[l.length-1],255&g));u>0;)h[--u]=i(l[u],g>>8),h[--u]=i(l[u],255&g);for(u=15,m=15-l.length;m>0;)h[u]=i(e[m],g>>8),--m,h[--u]=i(l[u],255&g),--u,--m;return h}}();function us(e,r){var t=r||{},n={},i=t.dense;i&&(n["!data"]=[]);var s=Us(e,"\\trowd","\\row");if(!s)throw new Error("RTF missing table");var o={s:{c:0,r:0},e:{c:0,r:s.length-1}},l=[];return s.forEach(function(g,u){i&&(l=n["!data"][u]=[]);for(var C,h=/\\[\w\-]+\b/g,A=0,I=-1,m=[];null!=(C=h.exec(g));){var _=g.slice(A,h.lastIndex-C[0].length);switch(32==_.charCodeAt(0)&&(_=_.slice(1)),_.length&&m.push(_),C[0]){case"\\cell":if(++I,m.length){var p={v:m.join(""),t:"s"};"TRUE"==p.v||"FALSE"==p.v?(p.v="TRUE"==p.v,p.t="b"):isNaN(Lr(p.v))?null!=or[p.v]&&(p.t="e",p.w=p.v,p.v=or[p.v]):(p.t="n",!1!==t.cellText&&(p.w=p.v),p.v=Lr(p.v)),i?l[I]=p:n[ht({r:u,c:I})]=p}m=[];break;case"\\par":m.push("\n")}A=h.lastIndex}I>o.e.c&&(o.e.c=I)}),n["!ref"]=ot(o),n}function oa(e){for(var r=0,t=1;3!=r;++r)t=256*t+(e[r]>255?255:e[r]<0?0:e[r]);return t.toString(16).toUpperCase().slice(1)}function hs(e,r){if(0===r)return e;var t=function N_(e){var r=e[0]/255,t=e[1]/255,n=e[2]/255,i=Math.max(r,t,n),s=Math.min(r,t,n),o=i-s;if(0===o)return[0,0,r];var g,l=0,u=i+s;switch(g=o/(u>1?2-u:u),i){case r:l=((t-n)/o+6)%6;break;case t:l=(n-r)/o+2;break;case n:l=(r-t)/o+4}return[l/6,g,u/2]}(function D_(e){var r=e.slice("#"===e[0]?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}(e));return t[2]=r<0?t[2]*(1+r):1-(1-t[2])*(1-r),oa(function P_(e){var g,t=e[1],n=e[2],i=2*t*(n<.5?n:1-n),s=n-i/2,o=[s,s,s],l=6*e[0];if(0!==t)switch(0|l){case 0:case 6:g=i*l,o[0]+=i,o[1]+=g;break;case 1:o[0]+=g=i*(2-l),o[1]+=i;break;case 2:g=i*(l-2),o[1]+=i,o[2]+=g;break;case 3:o[1]+=g=i*(4-l),o[2]+=i;break;case 4:g=i*(l-4),o[2]+=i,o[0]+=g;break;case 5:o[2]+=g=i*(6-l),o[0]+=i}for(var u=0;3!=u;++u)o[u]=Math.round(255*o[u]);return o}(t))}var Fc=6,R_=15,O_=1,_r=Fc;function Si(e){return Math.floor((e+Math.round(128/_r)/256)*_r)}function la(e){return Math.floor((e-5)/_r*100+.5)/100}function Cs(e){return Math.round((e*_r+5)/_r*256)/256}function xo(e){return Cs(la(Si(e)))}function vo(e){var r=Math.abs(e-xo(e)),t=_r;if(r>.005)for(_r=O_;_r<R_;++_r)Math.abs(e-xo(e))<=r&&(r=Math.abs(e-xo(e)),t=_r);_r=t}function Tn(e){e.width?(e.wpx=Si(e.width),e.wch=la(e.wpx),e.MDW=_r):e.wpx?(e.wch=la(e.wpx),e.width=Cs(e.wch),e.MDW=_r):"number"==typeof e.wch&&(e.width=Cs(e.wch),e.wpx=Si(e.width),e.MDW=_r),e.customWidth&&delete e.customWidth}var Dc=96;function ca(e){return 96*e/Dc}function bi(e){return e*Dc/96}var M_={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"},Is=["numFmtId","fillId","fontId","borderId","xfId"],As=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"],X_=function(){return function(t,n,i){var o,s={};return t?(t=Ls(Ji(t,"\x3c!--","--\x3e")),(o=ir(t,"numFmts"))&&function j_(e,r,t){r.NumberFmt=[];for(var n=Ft(Ve),i=0;i<n.length;++i)r.NumberFmt[n[i]]=Ve[n[i]];var s=e.match(cr);if(s)for(i=0;i<s.length;++i){var o=Me(s[i]);switch(Xr(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":case"</numFmt>":break;case"<numFmt":var l=pt(yt(o.formatCode)),g=parseInt(o.numFmtId,10);if(r.NumberFmt[g]=l,g>0){if(g>392){for(g=392;g>60&&null!=r.NumberFmt[g];--g);r.NumberFmt[g]=l}Nn(l,g)}break;default:if(t.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}(o[0],s,i),(o=ir(t,"fonts"))&&function G_(e,r,t,n){r.Fonts=[];var i={},s=!1;(e.match(cr)||[]).forEach(function(o){var l=Me(o);switch(Xr(l[0])){case"<fonts":case"<fonts>":case"</fonts>":case"<font":case"<font>":case"<name/>":case"</name>":case"</b>":case"</b":case"</i>":case"</i":case"</u>":case"</u":case"</strike>":case"</strike":case"</outline>":case"</outline":case"</shadow>":case"</shadow":case"</condense>":case"</condense":case"</extend>":case"</extend":case"<sz/>":case"</sz>":case"</sz":case"<vertAlign/>":case"</vertAlign>":case"</vertAlign":case"<family/>":case"</family>":case"</family":case"<scheme/>":case"</scheme>":case"</scheme":case"<charset/>":case"</charset>":case"</charset":case"<color/>":case"</color>":case"</color":case"<extLst":case"<extLst>":case"</extLst>":break;case"</font>":case"<font/>":r.Fonts.push(i),i={};break;case"<name":l.val&&(i.name=yt(l.val));break;case"<b":i.bold=l.val?kt(l.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=l.val?kt(l.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(l.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=l.val?kt(l.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=l.val?kt(l.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=l.val?kt(l.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=l.val?kt(l.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=l.val?kt(l.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":l.val&&(i.sz=+l.val);break;case"<vertAlign":l.val&&(i.vertAlign=l.val);break;case"<family":l.val&&(i.family=parseInt(l.val,10));break;case"<scheme":l.val&&(i.scheme=l.val);break;case"<charset":if("1"==l.val)break;l.codepage=Ds[parseInt(l.val,10)];break;case"<color":if(i.color||(i.color={}),l.auto&&(i.color.auto=kt(l.auto)),l.rgb)i.color.rgb=l.rgb.slice(-6);else if(l.indexed){i.color.index=parseInt(l.indexed,10);var g=qn[i.color.index];81==i.color.index&&(g=qn[1]),g||(g=qn[1]),i.color.rgb=g[0].toString(16)+g[1].toString(16)+g[2].toString(16)}else l.theme&&(i.color.theme=parseInt(l.theme,10),l.tint&&(i.color.tint=parseFloat(l.tint)),l.theme&&t.themeElements&&t.themeElements.clrScheme&&(i.color.rgb=hs(t.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<AlternateContent":case"<ext":s=!0;break;case"</AlternateContent>":case"</AlternateContent":case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in fonts")}})}(o[0],s,n,i),(o=ir(t,"fills"))&&function U_(e,r,t,n){r.Fills=[];var i={},s=!1;(e.match(cr)||[]).forEach(function(o){var l=Me(o);switch(Xr(l[0])){case"<fills":case"<fills>":case"</fills>":case"</fill>":case"<gradientFill>":case"<patternFill/>":case"</patternFill>":case"<bgColor/>":case"</bgColor>":case"<fgColor/>":case"</fgColor>":case"<stop":case"<stop/>":case"</stop>":case"<color":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<fill>":case"<fill":case"<fill/>":r.Fills.push(i={});break;case"<gradientFill":case"</gradientFill>":r.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":l.patternType&&(i.patternType=l.patternType);break;case"<bgColor":i.bgColor||(i.bgColor={}),l.indexed&&(i.bgColor.indexed=parseInt(l.indexed,10)),l.theme&&(i.bgColor.theme=parseInt(l.theme,10)),l.tint&&(i.bgColor.tint=parseFloat(l.tint)),l.rgb&&(i.bgColor.rgb=l.rgb.slice(-6));break;case"<fgColor":i.fgColor||(i.fgColor={}),l.theme&&(i.fgColor.theme=parseInt(l.theme,10)),l.tint&&(i.fgColor.tint=parseFloat(l.tint)),null!=l.rgb&&(i.fgColor.rgb=l.rgb.slice(-6));break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in fills")}})}(o[0],s,0,i),(o=ir(t,"borders"))&&function L_(e,r,t,n){r.Borders=[];var i={},s=!1;(e.match(cr)||[]).forEach(function(o){var l=Me(o);switch(Xr(l[0])){case"<borders":case"<borders>":case"</borders>":case"</border>":case"<left/>":case"<left":case"<left>":case"</left>":case"<right/>":case"<right":case"<right>":case"</right>":case"<top/>":case"<top":case"<top>":case"</top>":case"<bottom/>":case"<bottom":case"<bottom>":case"</bottom>":case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":case"<start":case"<start>":case"<start/>":case"</start>":case"<end":case"<end>":case"<end/>":case"</end>":case"<color":case"<color>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<border":case"<border>":case"<border/>":i={},l.diagonalUp&&(i.diagonalUp=kt(l.diagonalUp)),l.diagonalDown&&(i.diagonalDown=kt(l.diagonalDown)),r.Borders.push(i);break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+l[0]+" in borders")}})}(o[0],s,0,i),(o=ir(t,"cellXfs"))&&function $_(e,r,t){r.CellXf=[];var n,i=!1;(e.match(cr)||[]).forEach(function(s){var o=Me(s),l=0;switch(Xr(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":case"</xf>":case"</alignment>":case"<protection":case"<protection>":case"</protection>":case"<protection/>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<xf":case"<xf/>":case"<xf>":for(delete(n=o)[0],l=0;l<Is.length;++l)n[Is[l]]&&(n[Is[l]]=parseInt(n[Is[l]],10));for(l=0;l<As.length;++l)n[As[l]]&&(n[As[l]]=kt(n[As[l]]));if(r.NumberFmt&&n.numFmtId>392)for(l=392;l>60;--l)if(r.NumberFmt[n.numFmtId]==r.NumberFmt[l]){n.numFmtId=l;break}r.CellXf.push(n);break;case"<alignment":case"<alignment/>":case"<alignment>":var g={};o.vertical&&(g.vertical=o.vertical),o.horizontal&&(g.horizontal=o.horizontal),null!=o.textRotation&&(g.textRotation=o.textRotation),o.indent&&(g.indent=o.indent),o.wrapText&&(g.wrapText=kt(o.wrapText)),n.alignment=g;break;case"<AlternateContent":case"<AlternateContent>":case"<ext":i=!0;break;case"</AlternateContent>":case"</ext>":i=!1;break;default:if(t&&t.WTF&&!i)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}(o[0],s,i),s):s}}();function Y_(e,r,t){t||(t=J(6+4*r.length)),t.write_shift(2,e),tr(r,t);var n=t.length>t.l?t.slice(0,t.l):t;return null==t.l&&(t.l=t.length),n}var ko,Z_=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Q_=Cr;function Nc(e,r){r||(r=J(84)),ko||(ko=Ja(Z_));var t=ko[e.patternType];null==t&&(t=40),r.write_shift(4,t);var n=0;if(40!=t)for(ns({auto:1},r),ns({auto:1},r);n<12;++n)r.write_shift(4,0);else{for(;n<4;++n)r.write_shift(4,0);for(;n<12;++n)r.write_shift(4,0)}return r.length>r.l?r.slice(0,r.l):r}function Pc(e,r,t){return t||(t=J(16)),t.write_shift(2,r||0),t.write_shift(2,e.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function ga(e,r){return r||(r=J(10)),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(4,0),r}var ex=Cr;function Cx(e,r){var t=Ir();return oe(t,278),function ax(e,r){if(r){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)null!=r[i]&&++t}),0!=t&&(oe(e,615,Zr(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)null!=r[i]&&oe(e,44,Y_(i,r[i]))}),oe(e,616))}}(t,e.SSF),function sx(e){oe(e,611,Zr(1)),oe(e,43,function K_(e,r){r||(r=J(153)),r.write_shift(2,20*e.sz),function _d(e,r){r||(r=J(2)),r.write_shift(1,(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0)),r.write_shift(1,0)}(e,r),r.write_shift(2,e.bold?700:400);var t=0;"superscript"==e.vertAlign?t=1:"subscript"==e.vertAlign&&(t=2),r.write_shift(2,t),r.write_shift(1,e.underline||0),r.write_shift(1,e.family||0),r.write_shift(1,e.charset||0),r.write_shift(1,0),ns(e.color,r);var n=0;return"major"==e.scheme&&(n=1),"minor"==e.scheme&&(n=2),r.write_shift(1,n),tr(e.name,r),r.length>r.l?r.slice(0,r.l):r}({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),oe(e,612)}(t),function ox(e){oe(e,603,Zr(2)),oe(e,45,Nc({patternType:"none"})),oe(e,45,Nc({patternType:"gray125"})),oe(e,604)}(t),function lx(e){oe(e,613,Zr(1)),oe(e,46,function tx(e,r){return r||(r=J(51)),r.write_shift(1,0),ga(0,r),ga(0,r),ga(0,r),ga(0,r),ga(0,r),r.length>r.l?r.slice(0,r.l):r}()),oe(e,614)}(t),function cx(e){oe(e,626,Zr(1)),oe(e,47,Pc({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),oe(e,627)}(t),function gx(e,r){oe(e,617,Zr(r.length)),r.forEach(function(t){oe(e,47,Pc(t,0))}),oe(e,618)}(t,r.cellXfs),function fx(e){oe(e,619,Zr(1)),oe(e,48,function rx(e,r){return r||(r=J(52)),r.write_shift(4,e.xfId),r.write_shift(2,1),r.write_shift(1,+e.builtinId),r.write_shift(1,0),ta(e.name||"",r),r.length>r.l?r.slice(0,r.l):r}({xfId:0,builtinId:0,name:"Normal"})),oe(e,620)}(t),function ux(e){oe(e,505,Zr(0)),oe(e,506)}(t),function hx(e){oe(e,508,function nx(e,r,t){var n=J(2052);return n.write_shift(4,e),ta(r,n),ta(t,n),n.length>n.l?n.slice(0,n.l):n}(0,"TableStyleMedium9","PivotStyleMedium4")),oe(e,509)}(t),oe(t,279),t.end()}var Ix=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Rc(e,r){(!e||0===e.length)&&(e=wo());var t,n={};if(!(t=Wn(e,"a:themeElements")))throw new Error("themeElements not found in theme");return function px(e,r,t){var n;if(r.themeElements={},!(n=Wn(e,"a:clrScheme")))throw new Error("clrScheme not found in themeElements");if(function Ax(e,r,t){r.themeElements.clrScheme=[];var n={};(e[0].match(cr)||[]).forEach(function(i){var s=Me(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":case"</a:srgbClr>":case"</a:sysClr>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"</a:dk1>":case"</a:lt1>":case"<a:dk1>":case"<a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":"/"===s[0].charAt(1)?(r.themeElements.clrScheme[Ix.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}(n,r,t),!(n=Wn(e,"a:fontScheme")))throw new Error("fontScheme not found in themeElements");if(!(n=Wn(e,"a:fmtScheme")))throw new Error("fmtScheme not found in themeElements")}(t[0],n,r),n.raw=e,n}function wo(e,r){if(r&&r.themeXLSX)return r.themeXLSX;if(e&&"string"==typeof e.raw)return e.raw;var t=[Bt];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',t[t.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',t[t.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',t[t.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="\uff2d\uff33 \uff30\u30b4\u30b7\u30c3\u30af"/>',t[t.length]='<a:font script="Hang" typeface="\ub9d1\uc740 \uace0\ub515"/>',t[t.length]='<a:font script="Hans" typeface="\u5b8b\u4f53"/>',t[t.length]='<a:font script="Hant" typeface="\u65b0\u7d30\u660e\u9ad4"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function kx(e){var r=e.read_shift(2),t=e.read_shift(2)-4,n=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=function _x(e){var r={};switch(r.xclrType=e.read_shift(2),r.nTintShade=e.read_shift(2),r.xclrType){case 0:case 4:e.l+=4;break;case 1:r.xclrValue=function xx(e,r){return Cr(e,r)}(e,4);break;case 2:r.xclrValue=sc(e);break;case 3:r.xclrValue=function mx(e){return e.read_shift(4)}(e)}return e.l+=8,r}(e);break;case 6:n[1]=function vx(e,r){return Cr(e,r)}(e,t);break;case 14:case 15:n[1]=e.read_shift(1===t?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+t)}return n}function yx(e,r){r.forEach(function(t){})}function Oc(e,r,t){var n=[21600,21600],i=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),s=[pe("xml",null,{"xmlns:v":qt.v,"xmlns:o":qt.o,"xmlns:x":qt.x,"xmlns:mv":qt.mv}).replace(/\/>/,">"),pe("o:shapelayout",pe("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"})],o=65536*e,l=r||[];return l.length>0&&s.push(pe("v:shapetype",[pe("v:stroke",null,{joinstyle:"miter"}),pe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202",coordsize:n.join(","),"o:spt":202,path:i})),l.forEach(function(g){++o,s.push(function $x(e,r){var n=Tt(e[0]),i={color2:"#BEFF82",type:"gradient"};"gradient"==i.type&&(i.angle="-180");var s="gradient"==i.type?pe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,o=pe("v:fill",s,i);return["<v:shape"+Xn({id:"_x0000_s"+r,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(e[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",o,pe("v:shadow",null,{on:"t",obscured:"t"}),pe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",gr("x:Anchor",[n.c+1,0,n.r+1,0,n.c+3,20,n.r+5,20].join(",")),gr("x:AutoFill","False"),gr("x:Row",String(n.r)),gr("x:Column",String(n.c)),e[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"].join("")}(g,o))}),s.push("</xml>"),s.join("")}function Bc(e,r,t,n){var s,i=null!=e["!data"];r.forEach(function(o){var l=Tt(o.ref);if(!(l.r<0||l.c<0)){if(i?(e["!data"][l.r]||(e["!data"][l.r]=[]),s=e["!data"][l.r][l.c]):s=e[o.ref],!s){s={t:"z"},i?e["!data"][l.r][l.c]=s:e[o.ref]=s;var g=Ct(e["!ref"]||"BDWGO1000001:A1");g.s.r>l.r&&(g.s.r=l.r),g.e.r<l.r&&(g.e.r=l.r),g.s.c>l.c&&(g.s.c=l.c),g.e.c<l.c&&(g.e.c=l.c);var u=ot(g);e["!ref"]=u}s.c||(s.c=[]);var h={a:o.author,t:o.t,r:o.r,T:t};o.h&&(h.h=o.h);for(var A=s.c.length-1;A>=0;--A){if(!t&&s.c[A].T)return;t&&!s.c[A].T&&s.c.splice(A,1)}if(t&&n)for(A=0;A<n.length;++A)if(h.a==n[A].id){h.a=n[A].name||h.a;break}s.c.push(h)}})}function Xx(e){var r=[Bt,pe("comments",null,{xmlns:zn[0]})],t=[];return r.push("<authors>"),e.forEach(function(n){n[1].forEach(function(i){var s=st(i.a);-1==t.indexOf(s)&&(t.push(s),r.push("<author>"+s+"</author>")),i.T&&i.ID&&-1==t.indexOf("tc="+i.ID)&&(t.push("tc="+i.ID),r.push("<author>tc="+i.ID+"</author>"))})}),0==t.length&&(t.push("SheetJ5"),r.push("<author>SheetJ5</author>")),r.push("</authors>"),r.push("<commentList>"),e.forEach(function(n){var i=0,s=[],o=0;if(n[1][0]&&n[1][0].T&&n[1][0].ID&&(i=t.indexOf("tc="+n[1][0].ID)),n[1].forEach(function(u){u.a&&(i=t.indexOf(st(u.a))),u.T&&++o,s.push(null==u.t?"":st(u.t))}),0===o)n[1].forEach(function(u){r.push('<comment ref="'+n[0]+'" authorId="'+t.indexOf(st(u.a))+'"><text>'),r.push(gr("t",null==u.t?"":st(u.t))),r.push("</text></comment>")});else{n[1][0]&&n[1][0].T&&n[1][0].ID&&(i=t.indexOf("tc="+n[1][0].ID)),r.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>');for(var l="Comment:\n    "+s[0]+"\n",g=1;g<s.length;++g)l+="Reply:\n    "+s[g]+"\n";r.push(gr("t",st(l))),r.push("</text></comment>")}}),r.push("</commentList>"),r.length>2&&(r[r.length]="</comments>",r[1]=r[1].replace("/>",">")),r.join("")}function Mc(e,r,t){var n=[Bt,pe("ThreadedComments",null,{xmlns:Qt.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var s="";(i[1]||[]).forEach(function(o,l){if(o.T){o.a&&-1==r.indexOf(o.a)&&r.push(o.a);var g={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};0==l?s=g.id:g.parentId=s,o.ID=g.id,o.a&&(g.personId="{54EE7950-7262-4200-6969-"+("000000000000"+r.indexOf(o.a)).slice(-12)+"}"),n.push(pe("threadedComment",gr("text",o.t||""),g))}else delete o.ID})}),n.push("</ThreadedComments>"),n.join("")}function Lc(e){var r=[Bt,pe("personList",null,{xmlns:Qt.TCMNT,"xmlns:x":zn[0]}).replace(/[\/]>/,">")];return e.forEach(function(t,n){r.push(pe("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:t,providerId:"None"}))}),r.push("</personList>"),r.join("")}var Kx=Ar;function Uc(e){return tr(e.slice(0,54))}function Qx(e){var r=Ir(),t=[];return oe(r,628),oe(r,630),e.forEach(function(n){n[1].forEach(function(i){t.indexOf(i.a)>-1||(t.push(i.a.slice(0,54)),oe(r,632,Uc(i.a)),i.T&&i.ID&&-1==t.indexOf("tc="+i.ID)&&(t.push("tc="+i.ID),oe(r,632,Uc("tc="+i.ID))))})}),oe(r,631),oe(r,633),e.forEach(function(n){n[1].forEach(function(i){var s=-1;i.ID&&(s=t.indexOf("tc="+i.ID)),-1==s&&n[1][0].T&&n[1][0].ID&&(s=t.indexOf("tc="+n[1][0].ID)),-1==s&&(s=t.indexOf(i.a)),i.iauthor=s;var o={s:Tt(n[0]),e:Tt(n[0])};oe(r,635,function Jx(e,r){return null==r&&(r=J(36)),r.write_shift(4,e[1].iauthor),ki(e[0],r),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r}([o,i])),i.t&&i.t.length>0&&oe(r,637,function Cd(e,r){var t=!1;return null==r&&(t=!0,r=J(23+4*e.t.length)),r.write_shift(1,1),tr(e.t,r),r.write_shift(4,1),function fd(e,r){r||(r=J(4)),r.write_shift(2,e.ich||0),r.write_shift(2,e.ifnt||0)}({ich:0,ifnt:0},r),t?r.slice(0,r.l):r}(i)),oe(r,636),delete i.iauthor})}),oe(r,634),oe(r,629),r.end()}var qx="application/vnd.ms-office.vbaProject",r2=["xlsb","xlsm","xlam","biff8","xla"],ai=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function t(n,i,s,o){var l=!1,g=!1;0==s.length?g=!0:"["==s.charAt(0)&&(g=!0,s=s.slice(1,-1)),0==o.length?l=!0:"["==o.charAt(0)&&(l=!0,o=o.slice(1,-1));var u=s.length>0?0|parseInt(s,10):0,h=o.length>0?0|parseInt(o,10):0;return l?h+=r.c:--h,g?u+=r.r:--u,i+(l?"":"$")+rt(h)+(g?"":"$")+ut(u)}return function(i,s){return r=s,i.replace(e,t)}}(),ps=/(^|[^._A-Z0-9])(\$?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])(\$?)(\d{1,7})(?![_.\(A-Za-z0-9])/g;try{ps=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g}catch{}var fa=function(){return function(r,t){return r.replace(ps,function(n,i,s,o,l,g){var u=eo(o)-(s?0:t.c),h=qs(g)-(l?0:t.r);return i+"R"+("$"==l?h+1:0==h?"":"["+h+"]")+"C"+("$"==s?u+1:0==u?"":"["+u+"]")})}}();function Gc(e,r){return e.replace(ps,function(t,n,i,s,o,l){return n+("$"==i?i+s:rt(eo(s)+r.c))+("$"==o?o+l:ut(qs(l)+r.r))})}function jc(e,r,t){var i=Ht(r).s,s=Tt(t);return Gc(e,{r:s.r-i.r,c:s.c-i.c})}function Vc(e){return e.replace(/_xlfn\./g,"")}function Yt(e){e.l+=1}function On(e,r){var t=e.read_shift(1==r?1:2);return[16383&t,t>>14&1,t>>15&1]}function $c(e,r,t){var n=2;if(t){if(t.biff>=2&&t.biff<=5)return Wc(e);12==t.biff&&(n=4)}var i=e.read_shift(n),s=e.read_shift(n),o=On(e,2),l=On(e,2);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:l[0],cRel:l[1],rRel:l[2]}}}function Wc(e){var r=On(e,2),t=On(e,2),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:r[0],c:n,cRel:r[1],rRel:r[2]},e:{r:t[0],c:i,cRel:t[1],rRel:t[2]}}}function Xc(e,r,t){if(t&&t.biff>=2&&t.biff<=5)return function g2(e){var r=On(e,2),t=e.read_shift(1);return{r:r[0],c:t,cRel:r[1],rRel:r[2]}}(e);var n=e.read_shift(t&&12==t.biff?4:2),i=On(e,2);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function f2(e){var r=e.read_shift(2),t=e.read_shift(2);return{r,c:255&t,fQuoted:!!(16384&t),cRel:t>>15,rRel:t>>15}}function zc(e){var r=1&e[e.l+1];return e.l+=4,[r,1]}function Hc(e){return[e.read_shift(1),e.read_shift(1)]}function G2(e,r){var t=[e.read_shift(1)];if(12==r)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2}switch(t[0]){case 4:t[1]=Vt(e,1)?"TRUE":"FALSE",12!=r&&(e.l+=7);break;case 37:case 16:t[1]=rr[e[e.l]],e.l+=12==r?4:8;break;case 0:e.l+=8;break;case 1:t[1]=pr(e);break;case 2:t[1]=ri(e,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function j2(e,r,t){for(var n=e.read_shift(12==t.biff?4:2),i=[],s=0;s!=n;++s)i.push((12==t.biff?Zn:gs)(e,8));return i}function V2(e,r,t){var n=0,i=0;12==t.biff?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--n,0==--i&&(i=256));for(var s=0,o=[];s!=n&&(o[s]=[]);++s)for(var l=0;l!=i;++l)o[s][l]=G2(e,t.biff);return o}function ua(e,r,t){return e.l+=2,[f2(e)]}function yo(e){return e.l+=6,[]}function Yc(e){return e.l+=2,[Mt(e),1&e.read_shift(2)]}var lv=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"],Jc={1:{n:"PtgExp",f:function R2(e,r,t){return e.l++,t&&12==t.biff?[e.read_shift(4,"i"),0]:[e.read_shift(2),e.read_shift(t&&2==t.biff?1:2)]}},2:{n:"PtgTbl",f:Cr},3:{n:"PtgAdd",f:Yt},4:{n:"PtgSub",f:Yt},5:{n:"PtgMul",f:Yt},6:{n:"PtgDiv",f:Yt},7:{n:"PtgPower",f:Yt},8:{n:"PtgConcat",f:Yt},9:{n:"PtgLt",f:Yt},10:{n:"PtgLe",f:Yt},11:{n:"PtgEq",f:Yt},12:{n:"PtgGe",f:Yt},13:{n:"PtgGt",f:Yt},14:{n:"PtgNe",f:Yt},15:{n:"PtgIsect",f:Yt},16:{n:"PtgUnion",f:Yt},17:{n:"PtgRange",f:Yt},18:{n:"PtgUplus",f:Yt},19:{n:"PtgUminus",f:Yt},20:{n:"PtgPercent",f:Yt},21:{n:"PtgParen",f:Yt},22:{n:"PtgMissArg",f:Yt},23:{n:"PtgStr",f:function U2(e,r,t){return e.l++,yi(e,0,t)}},26:{n:"PtgSheet",f:function fv(e,r,t){return e.l+=5,e.l+=2,e.l+=2==t.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function uv(e,r,t){return e.l+=2==t.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function O2(e){return e.l++,rr[e.read_shift(1)]}},29:{n:"PtgBool",f:function M2(e){return e.l++,0!==e.read_shift(1)}},30:{n:"PtgInt",f:function B2(e){return e.l++,e.read_shift(2)}},31:{n:"PtgNum",f:function L2(e){return e.l++,pr(e)}},32:{n:"PtgArray",f:function m2(e,r,t){var n=(96&e[e.l++])>>5;return e.l+=2==t.biff?6:12==t.biff?14:7,[n]}},33:{n:"PtgFunc",f:function F2(e,r,t){var n=(96&e[e.l])>>5;e.l+=1;var i=e.read_shift(t&&t.biff<=3?1:2);return[Wv[i],qc[i],n]}},34:{n:"PtgFuncVar",f:function D2(e,r,t){var n=e[e.l++],i=e.read_shift(1),s=t&&t.biff<=3?[88==n?-1:0,e.read_shift(1)]:function N2(e){return[e[e.l+1]>>7,32767&e.read_shift(2)]}(e);return[i,(0===s[0]?qc:$v)[s[1]]]}},35:{n:"PtgName",f:function $2(e,r,t){var n=e.read_shift(1)>>>5&3,s=e.read_shift(!t||t.biff>=8?4:2);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[n,0,s]}},36:{n:"PtgRef",f:function S2(e,r,t){var n=(96&e[e.l])>>5;return e.l+=1,[n,Xc(e,0,t)]}},37:{n:"PtgArea",f:function C2(e,r,t){return[(96&e[e.l++])>>5,$c(e,0,t)]}},38:{n:"PtgMemArea",f:function z2(e,r,t){var n=e.read_shift(1)>>>5&3;return e.l+=t&&2==t.biff?3:4,[n,e.read_shift(t&&2==t.biff?1:2)]}},39:{n:"PtgMemErr",f:Cr},40:{n:"PtgMemNoMem",f:Cr},41:{n:"PtgMemFunc",f:function H2(e,r,t){return[e.read_shift(1)>>>5&3,e.read_shift(t&&2==t.biff?1:2)]}},42:{n:"PtgRefErr",f:function Y2(e,r,t){var n=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,12==t.biff&&(e.l+=2),[n]}},43:{n:"PtgAreaErr",f:function A2(e,r,t){var n=(96&e[e.l++])>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[n]}},44:{n:"PtgRefN",f:function b2(e,r,t){var n=(96&e[e.l])>>5;e.l+=1;var i=function u2(e,r,t){var n=t&&t.biff?t.biff:8;if(n>=2&&n<=5)return function h2(e){var r=e.read_shift(2),t=e.read_shift(1),n=(32768&r)>>15,i=(16384&r)>>14;return r&=16383,1==n&&r>=8192&&(r-=16384),1==i&&t>=128&&(t-=256),{r,c:t,cRel:i,rRel:n}}(e);var i=e.read_shift(n>=12?4:2),s=e.read_shift(2),o=(16384&s)>>14,l=(32768&s)>>15;if(s&=16383,1==l)for(;i>524287;)i-=1048576;if(1==o)for(;s>8191;)s-=16384;return{r:i,c:s,cRel:o,rRel:l}}(e,0,t);return[n,i]}},45:{n:"PtgAreaN",f:function d2(e,r,t){var n=(96&e[e.l++])>>5,i=function c2(e,r,t){if(t.biff<8)return Wc(e);var n=e.read_shift(12==t.biff?4:2),i=e.read_shift(12==t.biff?4:2),s=On(e,2),o=On(e,2);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}(e,0,t);return[n,i]}},46:{n:"PtgMemAreaN",f:function hv(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function Cv(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},57:{n:"PtgNameX",f:function W2(e,r,t){return 5==t.biff?function X2(e){var r=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[r,t,n]}(e):[e.read_shift(1)>>>5&3,e.read_shift(2),e.read_shift(4)]}},58:{n:"PtgRef3d",f:function E2(e,r,t){var n=(96&e[e.l])>>5;e.l+=1;var i=e.read_shift(2);return t&&5==t.biff&&(e.l+=12),[n,i,Xc(e,0,t)]}},59:{n:"PtgArea3d",f:function I2(e,r,t){var n=(96&e[e.l++])>>5,i=e.read_shift(2,"i");if(t&&5===t.biff)e.l+=12;return[n,i,$c(e,0,t)]}},60:{n:"PtgRefErr3d",f:function J2(e,r,t){var n=(96&e[e.l++])>>5,i=e.read_shift(2),s=4;if(t)switch(t.biff){case 5:s=15;break;case 12:s=6}return e.l+=s,[n,i]}},61:{n:"PtgAreaErr3d",f:function p2(e,r,t){var n=(96&e[e.l++])>>5,i=e.read_shift(2),s=8;if(t)switch(t.biff){case 5:e.l+=12,s=6;break;case 12:s=12}return e.l+=s,[n,i]}},255:{}},Av={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},pv={1:{n:"PtgElfLel",f:Yc},2:{n:"PtgElfRw",f:ua},3:{n:"PtgElfCol",f:ua},6:{n:"PtgElfRwV",f:ua},7:{n:"PtgElfColV",f:ua},10:{n:"PtgElfRadical",f:ua},11:{n:"PtgElfRadicalS",f:yo},13:{n:"PtgElfColS",f:yo},15:{n:"PtgElfColSV",f:yo},16:{n:"PtgElfRadicalLel",f:Yc},25:{n:"PtgList",f:function cv(e){e.l+=2;var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),s=e.read_shift(2);return{ixti:r,coltype:3&t,rt:lv[t>>2&31],idx:n,c:i,C:s}}},29:{n:"PtgSxName",f:function gv(e){return e.l+=2,[e.read_shift(4)]}},255:{}},dv={0:{n:"PtgAttrNoop",f:function Iv(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function w2(e,r,t){var n=255&e[e.l+1]?1:0;return e.l+=t&&2==t.biff?3:4,[n]}},2:{n:"PtgAttrIf",f:function v2(e,r,t){var n=255&e[e.l+1]?1:0;return e.l+=2,[n,e.read_shift(t&&2==t.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function _2(e,r,t){e.l+=2;for(var n=e.read_shift(t&&2==t.biff?1:2),i=[],s=0;s<=n;++s)i.push(e.read_shift(t&&2==t.biff?1:2));return i}},8:{n:"PtgAttrGoto",f:function x2(e,r,t){var n=255&e[e.l+1]?1:0;return e.l+=2,[n,e.read_shift(t&&2==t.biff?1:2)]}},16:{n:"PtgAttrSum",f:function P2(e,r,t){e.l+=t&&2==t.biff?3:4}},32:{n:"PtgAttrBaxcel",f:zc},33:{n:"PtgAttrBaxcel",f:zc},64:{n:"PtgAttrSpace",f:function y2(e){return e.read_shift(2),Hc(e)}},65:{n:"PtgAttrSpaceSemi",f:function T2(e){return e.read_shift(2),Hc(e)}},128:{n:"PtgAttrIfError",f:function k2(e){var r=255&e[e.l+1]?1:0;return e.l+=2,[r,e.read_shift(2)]}},255:{}};function ha(e,r,t,n){if(n.biff<8)return Cr(e,r);for(var i=e.l+r,s=[],o=0;o!==t.length;++o)switch(t[o][0]){case"PtgArray":t[o][1]=V2(e,0,n),s.push(t[o][1]);break;case"PtgMemArea":t[o][2]=j2(e,0,n),s.push(t[o][2]);break;case"PtgExp":n&&12==n.biff&&(t[o][1][1]=e.read_shift(4),s.push(t[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[o][0]}return 0!=(r=i-e.l)&&s.push(Cr(e,r)),s}function Ca(e,r,t){for(var i,s,n=e.l+r,o=[];n!=e.l;)r=n-e.l,i=Jc[s=e[e.l]]||Jc[Av[s]],(24===s||25===s)&&(i=(24===s?pv:dv)[e[e.l+1]]),i&&i.f?o.push([i.n,i.f(e,r,t)]):Cr(e,r);return o}function mv(e){for(var r=[],t=0;t<e.length;++t){for(var n=e[t],i=[],s=0;s<n.length;++s){var o=n[s];i.push(o?2===o[0]?'"'+o[1].replace(/"/g,'""')+'"':o[1]:"")}r.push(i.join(","))}return r.join(";")}var _v={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function xv(e,r){var t=e.lastIndexOf("!"),n=r.lastIndexOf("!");return-1==t&&-1==n?e+":"+r:t>0&&n>0&&e.slice(0,t).toLowerCase()==r.slice(0,n).toLowerCase()?e+":"+r.slice(n+1):(console.error("Cannot hydrate range",e,r),e+":"+r)}function Kc(e,r,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[r]))return e.SheetNames[r];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[r];if(t.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),0==r?"":e.XTI[r-1];if(!n)return"SH33TJSERR1";var i="";if(t.biff>8)switch(e[n[0]][0]){case 357:return i=-1==n[1]?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return null!=t.SID?e.SheetNames[t.SID]:"SH33TJSSAME"+e[n[0]][0];default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=-1==n[1]?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(i=-1==n[1]?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Zc(e,r,t){var n=Kc(e,r,t);return"#REF"==n?n:ea(n,t)}function xr(e,r,t,n,i){var g,u,h,I,s=i&&i.biff||8,o={s:{c:0,r:0},e:{c:0,r:0}},l=[],A=0,C=0,m="";if(!e[0]||!e[0][0])return"";for(var _=-1,p="",d=0,w=e[0].length;d<w;++d){var v=e[0][d];switch(v[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(g=l.pop(),u=l.pop(),_>=0){switch(e[0][_][1][0]){case 0:p=dt(" ",e[0][_][1][1]);break;case 1:p=dt("\r",e[0][_][1][1]);break;default:if(p="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][_][1][0])}u+=p,_=-1}l.push(u+_v[v[0]]+g);break;case"PtgIsect":g=l.pop(),u=l.pop(),l.push(u+" "+g);break;case"PtgUnion":g=l.pop(),u=l.pop(),l.push(u+","+g);break;case"PtgRange":g=l.pop(),u=l.pop(),l.push(xv(u,g));break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":h=Qi(v[1][1],o,i),l.push(qi(h,s));break;case"PtgRefN":h=t?Qi(v[1][1],t,i):v[1][1],l.push(qi(h,s));break;case"PtgRef3d":A=v[1][1],h=Qi(v[1][2],o,i),m=Zc(n,A,i),l.push(m+"!"+qi(h,s));break;case"PtgFunc":case"PtgFuncVar":var G=v[1][0],X=v[1][1];G||(G=0);var E=0==(G&=127)?[]:l.slice(-G);l.length-=G,"User"===X&&(X=E.shift()),l.push(X+"("+E.join(",")+")");break;case"PtgBool":l.push(v[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":l.push(v[1]);break;case"PtgNum":l.push(String(v[1]));break;case"PtgStr":l.push('"'+v[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":I=Sl(v[1][1],t?{s:t}:o,i),l.push(Qs(I,i));break;case"PtgArea":I=Sl(v[1][1],o,i),l.push(Qs(I,i));break;case"PtgArea3d":I=v[1][2],m=Zc(n,A=v[1][1],i),l.push(m+"!"+Qs(I,i));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgName":var O=(n.names||[])[(C=v[1][2])-1]||(n[0]||[])[C],L=O?O.Name:"SH33TJSNAME"+String(C);L&&"_xlfn."==L.slice(0,6)&&!i.xlfn&&(L=L.slice(6)),l.push(L);break;case"PtgNameX":var H,W=v[1][1];if(C=v[1][2],!(i.biff<=5)){var Y="";if(14849==((n[W]||[])[0]||[])[0]||(1025==((n[W]||[])[0]||[])[0]?n[W][C]&&n[W][C].itab>0&&(Y=n.SheetNames[n[W][C].itab-1]+"!"):Y=n.SheetNames[C-1]+"!"),n[W]&&n[W][C])Y+=n[W][C].Name;else if(n[0]&&n[0][C])Y+=n[0][C].Name;else{var ee=(Kc(n,W,i)||"").split(";;");ee[C-1]?Y=ee[C-1]:Y+="SH33TJSERRX"}l.push(Y);break}W<0&&(W=-W),n[W]&&(H=n[W][C]),H||(H={Name:"SH33TJSERRY"}),l.push(H.Name);break;case"PtgParen":var Te="(",le=")";if(_>=0){switch(p="",e[0][_][1][0]){case 2:Te=dt(" ",e[0][_][1][1])+Te;break;case 3:Te=dt("\r",e[0][_][1][1])+Te;break;case 4:le=dt(" ",e[0][_][1][1])+le;break;case 5:le=dt("\r",e[0][_][1][1])+le;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][_][1][0])}_=-1}l.push(Te+l.pop()+le);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":l.push("#REF!");break;case"PtgExp":var Pe={c:t.c,r:t.r};if(n.sharedf[ht(h={c:v[1][1],r:v[1][0]})]){var ce=n.sharedf[ht(h)];l.push(xr(ce,0,Pe,n,i))}else{var Re=!1;for(g=0;g!=n.arrayf.length;++g)if(!(h.c<(u=n.arrayf[g])[0].s.c||h.c>u[0].e.c||h.r<u[0].s.r||h.r>u[0].e.r)){l.push(xr(u[1],0,Pe,n,i)),Re=!0;break}Re||l.push(v[1])}break;case"PtgArray":l.push("{"+mv(v[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":_=d;break;case"PtgMissArg":l.push("");break;case"PtgList":l.push("Table"+v[1].idx+"[#"+v[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(v))}if(3!=i.biff&&_>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(e[0][d][0])){var ue=!0;switch((v=e[0][_])[1][0]){case 4:ue=!1;case 0:p=dt(" ",v[1][1]);break;case 5:ue=!1;case 1:p=dt("\r",v[1][1]);break;default:if(p="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+v[1][0])}l.push((ue?p:"")+l.pop()+(ue?"":p)),_=-1}}if(l.length>1&&i.WTF)throw new Error("bad formula stack");return"TRUE"==l[0]||"FALSE"!=l[0]&&l[0]}function vv(e,r,t){var s,n=e.l+r,i=2==t.biff?1:2,o=e.read_shift(i);if(65535==o)return[[],Cr(e,r-2)];var l=Ca(e,o,t);return r!==o+i&&(s=ha(e,r-o-i,l,t)),e.l=n,[l,s]}function yv(e,r,t){var i,n=e.l+r,s=e.read_shift(2),o=Ca(e,s,t);return 65535==s?[[],Cr(e,r-2)]:(r!==s+2&&(i=ha(e,n-s-2,o,t)),[o,i])}function To(e,r,t){var n=e.l+r,i=Qr(e,6,t),s=function Tv(e){var r;if(65535!==vn(e,e.l+6))return[pr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return r=1===e[e.l+2],e.l+=8,[r,"b"];case 2:return r=e[e.l+2],e.l+=8,[r,"e"];case 3:return e.l+=8,["","s"]}return[]}(e),o=e.read_shift(1);2!=t.biff&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var l=function kv(e,r,t){var s,n=e.l+r,i=2==t.biff?1:2,o=e.read_shift(i);if(65535==o)return[[],Cr(e,r-2)];var l=Ca(e,o,t);return r!==o+i&&(s=ha(e,r-o-i,l,t)),e.l=n,[l,s]}(e,n-e.l,t);return{cell:i,val:s[0],formula:l,shared:o>>3&1,tt:s[1]}}function ds(e,r,t){var n=e.read_shift(4),i=Ca(e,n,t),s=e.read_shift(4);return[i,s>0?ha(e,s,i,t):null]}var Ev=ds,ms=ds,Fv=ds,Dv=ds;function Qc(e){if((0|e)==e&&e<Math.pow(2,16)&&e>=0){var r=J(11);return r.write_shift(4,3),r.write_shift(1,30),r.write_shift(2,e),r.write_shift(4,0),r}var t=J(17);return t.write_shift(4,11),t.write_shift(1,31),t.write_shift(8,e),t.write_shift(4,0),t}var Vv=function jv(e,r){if("number"==typeof e)return Qc(e);if("boolean"==typeof e)return function Pv(e){var r=J(10);return r.write_shift(4,2),r.write_shift(1,29),r.write_shift(1,e?1:0),r.write_shift(4,0),r}(e);if(/^#(DIV\/0!|GETTING_DATA|N\/A|NAME\?|NULL!|NUM!|REF!|VALUE!)$/.test(e))return function Nv(e){var r=J(10);return r.write_shift(4,2),r.write_shift(1,28),r.write_shift(1,e),r.write_shift(4,0),r}(+or[e]);if(e.match(/^\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return function Ov(e){var r=Tt(e),t=J(15);return t.write_shift(4,7),t.write_shift(1,36),t.write_shift(4,r.r),t.write_shift(2,r.c|("$"==e.charAt(0)?0:1)<<14|(e.match(/\$\d/)?0:1)<<15),t.write_shift(4,0),t}(e);if(e.match(/^\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return function Lv(e){var r=e.split(":"),t=r[0],n=J(23);n.write_shift(4,15);var i=Tt(t=r[0]);return n.write_shift(1,36),n.write_shift(4,i.r),n.write_shift(2,i.c|("$"==t.charAt(0)?0:1)<<14|(t.match(/\$\d/)?0:1)<<15),n.write_shift(4,0),i=Tt(t=r[1]),n.write_shift(1,36),n.write_shift(4,i.r),n.write_shift(2,i.c|("$"==t.charAt(0)?0:1)<<14|(t.match(/\$\d/)?0:1)<<15),n.write_shift(4,0),n.write_shift(1,17),n.write_shift(4,0),n}(e);if(e.match(/^#REF!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return function Gv(e,r){var t=e.lastIndexOf("!"),n=e.slice(0,t);e=e.slice(t+1),"'"==n.charAt(0)&&(n=n.slice(1,-1).replace(/''/g,"'"));var i=Ht(e),s=J(23);return s.write_shift(4,15),s.write_shift(1,59),s.write_shift(2,2+r.SheetNames.map(function(o){return o.toLowerCase()}).indexOf(n.toLowerCase())),s.write_shift(4,i.s.r),s.write_shift(4,i.e.r),s.write_shift(2,i.s.c),s.write_shift(2,i.e.c),s.write_shift(4,0),s}(e,r);if(e.match(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return function Bv(e,r){var t=e.lastIndexOf("!"),n=e.slice(0,t),i=Tt(e=e.slice(t+1));"'"==n.charAt(0)&&(n=n.slice(1,-1).replace(/''/g,"'"));var s=J(17);return s.write_shift(4,9),s.write_shift(1,58),s.write_shift(2,2+r.SheetNames.map(function(o){return o.toLowerCase()}).indexOf(n.toLowerCase())),s.write_shift(4,i.r),s.write_shift(2,i.c|("$"==e.charAt(0)?0:1)<<14|(e.match(/\$\d/)?0:1)<<15),s.write_shift(4,0),s}(e,r);if(e.match(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return function Uv(e,r){var t=e.lastIndexOf("!"),n=e.slice(0,t);e=e.slice(t+1),"'"==n.charAt(0)&&(n=n.slice(1,-1).replace(/''/g,"'"));var i=e.split(":"),s=J(27);s.write_shift(4,19);var o=i[0],l=Tt(o);return s.write_shift(1,58),s.write_shift(2,2+r.SheetNames.map(function(g){return g.toLowerCase()}).indexOf(n.toLowerCase())),s.write_shift(4,l.r),s.write_shift(2,l.c|("$"==o.charAt(0)?0:1)<<14|(o.match(/\$\d/)?0:1)<<15),l=Tt(o=i[1]),s.write_shift(1,58),s.write_shift(2,2+r.SheetNames.map(function(g){return g.toLowerCase()}).indexOf(n.toLowerCase())),s.write_shift(4,l.r),s.write_shift(2,l.c|("$"==o.charAt(0)?0:1)<<14|(o.match(/\$\d/)?0:1)<<15),s.write_shift(1,17),s.write_shift(4,0),s}(e,r);if(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!#REF!$/.test(e))return function Mv(e,r){var t=e.lastIndexOf("!"),n=e.slice(0,t);e=e.slice(t+1),"'"==n.charAt(0)&&(n=n.slice(1,-1).replace(/''/g,"'"));var i=J(17);return i.write_shift(4,9),i.write_shift(1,60),i.write_shift(2,2+r.SheetNames.map(function(s){return s.toLowerCase()}).indexOf(n.toLowerCase())),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(4,0),i}(e,r);if(/^".*"$/.test(e))return function Rv(e){var r=J(7);r.write_shift(4,3+2*e.length),r.write_shift(1,23),r.write_shift(2,e.length);var t=J(2*e.length);t.write_shift(2*e.length,e,"utf16le");var n=J(4);return n.write_shift(4,0),jt([r,t,n])}(e);if(/^[+-]\d+$/.test(e))return Qc(parseInt(e,10));throw"Formula |"+e+"| not supported for XLSB"},$v={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},qc={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Wv={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function eg(e){return"of:"==e.slice(0,3)&&(e=e.slice(3)),61==e.charCodeAt(0)&&61==(e=e.slice(1)).charCodeAt(0)&&(e=e.slice(1)),(e=(e=(e=(e=(e=e.replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(r,t){return t.replace(/\./g,"")})).replace(/\$'([^']|'')+'/g,function(r){return r.slice(1)})).replace(/\$([^\]\. #$]+)/g,function(r,t){return t.match(/^([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])?(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})?$/)?r:t})).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function Xv(e){return("of:="+e.replace(ps,"$1[.$2$3$4$5]").replace(/\]:\[/g,":")).replace(/;/g,"|").replace(/,/g,";")}function So(e){var r=(e=(e=e.replace(/\$'([^']|'')+'/g,function(n){return n.slice(1)})).replace(/\$([^\]\. #$]+)/g,function(n,i){return i.match(/^([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])?(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})?$/)?n:i})).split(":");return[r[0].split(".")[0],r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}function tg(e){return e.replace(/!/,".").replace(/:/,":.")}var Ia={},Ei={},Aa=typeof Map<"u";function bo(e,r,t){var n=0,i=e.length;if(t){if(Aa?t.has(r):Object.prototype.hasOwnProperty.call(t,r))for(var s=Aa?t.get(r):t[r];n<s.length;++n)if(e[s[n]].t===r)return e.Count++,s[n]}else for(;n<i;++n)if(e[n].t===r)return e.Count++,n;return e[i]={t:r},e.Count++,e.Unique++,t&&(Aa?(t.has(r)||t.set(r,[]),t.get(r).push(i)):(Object.prototype.hasOwnProperty.call(t,r)||(t[r]=[]),t[r].push(i))),i}function pa(e,r){var t={min:e+1,max:e+1},n=-1;return r.MDW&&(_r=r.MDW),null!=r.width?t.customWidth=1:null!=r.wpx?n=la(r.wpx):null!=r.wch&&(n=r.wch),n>-1?(t.width=Cs(n),t.customWidth=1):null!=r.width&&(t.width=r.width),r.hidden&&(t.hidden=!0),null!=r.level&&(t.outlineLevel=t.level=r.level),t}function si(e,r){if(e){var t=[.7,.7,.75,.75,.3,.3];"xlml"==r&&(t=[1,1,1,1,.5,.5]),null==e.left&&(e.left=t[0]),null==e.right&&(e.right=t[1]),null==e.top&&(e.top=t[2]),null==e.bottom&&(e.bottom=t[3]),null==e.header&&(e.header=t[4]),null==e.footer&&(e.footer=t[5])}}function fn(e,r,t){var n=t.revssf[null!=r.z?r.z:"General"],i=60,s=e.length;if(null==n&&t.ssf)for(;i<392;++i)if(null==t.ssf[i]){Nn(r.z,i),t.ssf[i]=r.z,t.revssf[r.z]=n=i;break}for(i=0;i!=s;++i)if(e[i].numFmtId===n)return i;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function rg(e,r,t,n,i,s,o){try{n.cellNF&&(e.z=Ve[r])}catch(g){if(n.WTF)throw g}if("z"!==e.t||n.cellStyles){if("d"===e.t&&"string"==typeof e.v&&(e.v=Pt(e.v)),(!n||!1!==n.cellText)&&"z"!==e.t)try{if(null==Ve[r]&&Nn(Ip[r]||"General",r),"e"===e.t)e.w=e.w||rr[e.v];else if(0===r)if("n"===e.t)e.w=(0|e.v)===e.v?e.v.toString(10):Xi(e.v);else if("d"===e.t){var l=Ot(e.v,!!o);e.w=(0|l)===l?l.toString(10):Xi(l)}else{if(void 0===e.v)return"";e.w=Gn(e.v,Ei)}else e.w=Dr(r,"d"===e.t?Ot(e.v,!!o):e.v,Ei)}catch(g){if(n.WTF)throw g}if(n.cellStyles&&null!=t)try{e.s=s.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=hs(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=hs(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(g){if(n.WTF&&s.Fills)throw g}}}function zv(e,r,t){if(e&&e["!ref"]){var n=Ct(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+t+"): "+e["!ref"])}}var Yv=/<(?:\w+:)?mergeCell ref=["'][A-Z0-9:]+['"]\s*[\/]?>/g,Jv=/<(?:\w+:)?hyperlink [^<>]*>/gm,Kv=/"(\w*:\w*)"/,Zv=/<(?:\w+:)?col\b[^<>]*[\/]?>/g,Qv=/<(?:\w+:)?autoFilter[^>]*/g,qv=/<(?:\w+:)?pageMargins[^<>]*\/>/g,ng=/<(?:\w+:)?sheetPr\b[^<>]*?\/>/;function Eo(e,r,t,n){var i=Me(e);t.Sheets[n]||(t.Sheets[n]={}),i.codeName&&(t.Sheets[n].CodeName=pt(yt(i.codeName)))}var i4=["objects","scenarios","selectLockedCells","selectUnlockedCells"],a4=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"],C4=/<(?:\w:)?sheetView(?:[^<>a-z][^<>]*)?\/?>/g;function p4(e,r,t,n,i,s,o){if(e.c&&t["!comments"].push([r,e.c]),(void 0===e.v||"z"===e.t&&!(n||{}).sheetStubs)&&"string"!=typeof e.f&&typeof e.z>"u")return"";var l="",g=e.t,u=e.v;if("z"!==e.t)switch(e.t){case"b":l=e.v?"1":"0";break;case"n":isNaN(e.v)?(e.t="e",l=rr[e.v=36]):isFinite(e.v)?l=""+e.v:(e.t="e",l=rr[e.v=7]);break;case"e":l=rr[e.v];break;case"d":if(n&&n.cellDates){var h=Pt(e.v,o);l=h.toISOString(),h.getUTCFullYear()<1900&&(l=l.slice(l.indexOf("T")+1).replace("Z",""))}else(e=xt(e)).t="n",l=""+(e.v=Ot(Pt(e.v,o),o));typeof e.z>"u"&&(e.z=Ve[14]);break;default:l=e.v}var A="z"==e.t||null==e.v?"":gr("v",st(l)),C={r},I=fn(n.cellXfs,e,n);switch(0!==I&&(C.s=I),e.t){case"n":case"z":break;case"d":C.t="d";break;case"b":C.t="b";break;case"e":C.t="e";break;default:if(null==e.v){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){A=gr("v",""+bo(n.Strings,e.v,n.revStrings)),C.t="s";break}C.t="str"}if(e.t!=g&&(e.t=g,e.v=u),"string"==typeof e.f&&e.f){var m=e.F&&e.F.slice(0,r.length)==r?{t:"array",ref:e.F}:null;A=pe("f",st(e.f),m)+(null!=e.v?A:"")}return e.l&&(e.l.display=st(l),t["!links"].push([r,e.l])),e.D&&(C.cm=1),pe("c",A,C)}var d4=function(){var e=/<(?:\w+:)?c[ \/>]/,r=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,n=/ref=["']([^"']*)["']/;return function(s,o,l,g,u,h,A){for(var S,G,O,L,ee,C=0,I="",m=[],_=[],p=0,d=0,w=0,v="",X=0,E=0,W=0,H=0,Y=Array.isArray(h.CellXf),Te=[],le=[],Pe=null!=o["!data"],ce=[],Re={},Xe=!1,ue=!!l.sheetStubs,Ke=!!((A||{}).WBProps||{}).date1904,re=s.split(r),he=0,Ce=re.length;he!=Ce;++he){var Ue=(I=re[he].trim()).length;if(0!==Ue){var ve=0;e:for(C=0;C<Ue;++C)switch(I[C]){case">":if("/"!=I[C-1]){++C;break e}if(l&&l.cellStyles){if(X=null!=(G=Me(I.slice(ve,C),!0)).r?parseInt(G.r,10):X+1,E=-1,l.sheetRows&&l.sheetRows<X)continue;Re={},Xe=!1,G.ht&&(Xe=!0,Re.hpt=parseFloat(G.ht),Re.hpx=bi(Re.hpt)),G.hidden&&kt(G.hidden)&&(Xe=!0,Re.hidden=!0),null!=G.outlineLevel&&(Xe=!0,Re.level=+G.outlineLevel),Xe&&(ce[X-1]=Re)}break;case"<":ve=C}if(ve>=C)break;if(X=null!=(G=Me(I.slice(ve,C),!0)).r?parseInt(G.r,10):X+1,E=-1,!(l.sheetRows&&l.sheetRows<X)){l.nodim||(g.s.r>X-1&&(g.s.r=X-1),g.e.r<X-1&&(g.e.r=X-1)),l&&l.cellStyles&&(Re={},Xe=!1,G.ht&&(Xe=!0,Re.hpt=parseFloat(G.ht),Re.hpx=bi(Re.hpt)),G.hidden&&kt(G.hidden)&&(Xe=!0,Re.hidden=!0),null!=G.outlineLevel&&(Xe=!0,Re.level=+G.outlineLevel),Xe&&(ce[X-1]=Re)),m=I.slice(C).split(e);for(var Ne=0;Ne!=m.length&&"<"==m[Ne].trim().charAt(0);++Ne);for(m=m.slice(Ne),C=0;C!=m.length;++C)if(0!==(I=m[C].trim()).length){if(_=I.match(t),p=C,d=0,w=0,I="<c "+("<"==I.slice(0,1)?">":"")+I,null!=_&&2===_.length){for(p=0,v=_[1],d=0;d!=v.length&&!((w=v.charCodeAt(d)-64)<1||w>26);++d)p=26*p+w;E=--p}else++E;for(d=0;d!=I.length&&62!==I.charCodeAt(d);++d);if(++d,(G=Me(I.slice(0,d),!0)).r||(G.r=ht({r:X-1,c:E})),v=I.slice(d),S={t:""},null!=(_=ir(v,"v"))&&""!==_[1]&&(S.v=pt(_[1])),l.cellFormula){if(null!=(_=ir(v,"f"))){if(""==_[1])_[0].indexOf('t="shared"')>-1&&le[(L=Me(_[0])).si]&&(S.f=jc(le[L.si][1],le[L.si][2],G.r));else if(S.f=pt(yt(_[1]),!0),l.xlfn||(S.f=Vc(S.f)),_[0].indexOf('t="array"')>-1)S.F=(v.match(n)||[])[1],S.F.indexOf(":")>-1&&Te.push([Ct(S.F),S.F]);else if(_[0].indexOf('t="shared"')>-1){L=Me(_[0]);var D=pt(yt(_[1]));l.xlfn||(D=Vc(D)),le[parseInt(L.si,10)]=[L,D,G.r]}}else(_=v.match(/<f[^<>]*\/>/))&&le[(L=Me(_[0])).si]&&(S.f=jc(le[L.si][1],le[L.si][2],G.r));var z=Tt(G.r);for(d=0;d<Te.length;++d)z.r>=Te[d][0].s.r&&z.r<=Te[d][0].e.r&&z.c>=Te[d][0].s.c&&z.c<=Te[d][0].e.c&&(S.F=Te[d][1])}if(null==G.t&&void 0===S.v)if(S.f||S.F)S.v=0,S.t="n";else{if(!ue)continue;S.t="z"}else S.t=G.t||"n";switch(g.s.c>E&&(g.s.c=E),g.e.c<E&&(g.e.c=E),S.t){case"n":if(""==S.v||null==S.v){if(!ue)continue;S.t="z"}else S.v=parseFloat(S.v);break;case"s":if(typeof S.v>"u"){if(!ue)continue;S.t="z"}else O=Ia[parseInt(S.v,10)],S.v=O.t,S.r=O.r,l.cellHTML&&(S.h=O.h);break;case"str":S.t="s",S.v=null!=S.v?pt(yt(S.v),!0):"",l.cellHTML&&(S.h=Ki(S.v));break;case"inlineStr":_=ir(v,"is"),S.t="s",null!=_&&(O=mo(_[1]))?(S.v=O.t,l.cellHTML&&(S.h=O.h)):S.v="";break;case"b":S.v=kt(S.v);break;case"d":l.cellDates?S.v=Pt(S.v,Ke):(S.v=Ot(Pt(S.v,Ke),Ke),S.t="n");break;case"e":(!l||!1!==l.cellText)&&(S.w=S.v),S.v=or[S.v]}if(W=H=0,ee=null,Y&&void 0!==G.s&&null!=(ee=h.CellXf[G.s])&&(null!=ee.numFmtId&&(W=ee.numFmtId),l.cellStyles&&null!=ee.fillId&&(H=ee.fillId)),rg(S,W,H,l,u,h,Ke),l.cellDates&&Y&&"n"==S.t&&Mr(Ve[W])&&(S.v=xn(S.v+(Ke?1462:0)),S.t="number"==typeof S.v?"n":"d"),G.cm&&l.xlmeta){var j=(l.xlmeta.Cell||[])[+G.cm-1];j&&"XLDAPR"==j.type&&(S.D=!0)}var U;l.nodim&&(U=Tt(G.r),g.s.r>U.r&&(g.s.r=U.r),g.e.r<U.r&&(g.e.r=U.r)),Pe?(U=Tt(G.r),o["!data"][U.r]||(o["!data"][U.r]=[]),o["!data"][U.r][U.c]=S):o[G.r]=S}}}}ce.length>0&&(o["!rows"]=ce)}}();function _4(e,r,t,n){var o,i=[Bt,pe("worksheet",null,{xmlns:zn[0],"xmlns:r":Qt.r})],l="",g=t.Sheets[t.SheetNames[e]];null==g&&(g={});var u=g["!ref"]||"A1",h=Ct(u);if(h.e.c>16383||h.e.r>1048575){if(r.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575),u=ot(h)}n||(n={}),g["!comments"]=[];var A=[];(function n4(e,r,t,n,i){var s=!1,o={},l=null;if("xlsx"!==n.bookType&&r.vbaraw){var g=r.SheetNames[t];try{r.Workbook&&(g=r.Workbook.Sheets[t].CodeName||g)}catch{}s=!0,o.codeName=cn(st(g))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),l=(l||"")+pe("outlinePr",null,u)}!s&&!l||(i[i.length]=pe("sheetPr",l,o))})(g,t,e,r,i),i[i.length]=pe("dimension",null,{ref:u}),i[i.length]=function A4(e,r,t,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),pe("sheetViews",pe("sheetView",null,i),{})}(0,0,0,t),r.sheetFormat&&(i[i.length]=pe("sheetFormatPr",null,{defaultRowHeight:r.sheetFormat.defaultRowHeight||"16",baseColWidth:r.sheetFormat.baseColWidth||"10",outlineLevelRow:r.sheetFormat.outlineLevelRow||"7"})),null!=g["!cols"]&&g["!cols"].length>0&&(i[i.length]=function f4(e,r){for(var n,t=["<cols>"],i=0;i!=r.length;++i)(n=r[i])&&(t[t.length]=pe("col",null,pa(i,n)));return t[t.length]="</cols>",t.join("")}(0,g["!cols"])),i[o=i.length]="<sheetData/>",g["!links"]=[],null!=g["!ref"]&&(l=function m4(e,r,t,n){var g,d,i=[],s=[],o=Ct(e["!ref"]),l="",u="",h=[],A=0,C=0,I=e["!rows"],m=null!=e["!data"],_=m?e["!data"]:[],p={r:u},w=-1,v=(((n||{}).Workbook||{}).WBProps||{}).date1904;for(C=o.s.c;C<=o.e.c;++C)h[C]=rt(C);for(A=o.s.r;A<=o.e.r;++A){s=[],u=ut(A);var S=m?_[A]:[];for(C=o.s.c;C<=o.e.c;++C){g=h[C]+u;var G=m?S[C]:e[g];void 0!==G&&null!=(l=p4(G,g,e,r,0,0,v))&&s.push(l)}(s.length>0||I&&I[A])&&(p={r:u},I&&I[A]&&((d=I[A]).hidden&&(p.hidden=1),w=-1,d.hpx?w=ca(d.hpx):d.hpt&&(w=d.hpt),w>-1&&(p.ht=w,p.customHeight=1),d.level&&(p.outlineLevel=d.level)),i[i.length]=pe("row",s.join(""),p))}if(I)for(;A<I.length;++A)I&&I[A]&&(p={r:A+1},(d=I[A]).hidden&&(p.hidden=1),w=-1,d.hpx?w=ca(d.hpx):d.hpt&&(w=d.hpt),w>-1&&(p.ht=w,p.customHeight=1),d.level&&(p.outlineLevel=d.level),i[i.length]=pe("row","",p));return i.join("")}(g,r,0,t),l.length>0&&(i[i.length]=l)),i.length>o+1&&(i[i.length]="</sheetData>",i[o]=i[o].replace("/>",">")),g["!protect"]&&(i[i.length]=function s4(e){var r={sheet:1};return i4.forEach(function(t){null!=e[t]&&e[t]&&(r[t]="1")}),a4.forEach(function(t){null!=e[t]&&!e[t]&&(r[t]="0")}),e.password&&(r.password=_o(e.password).toString(16).toUpperCase()),pe("sheetProtection",null,r)}(g["!protect"])),null!=g["!autofilter"]&&(i[i.length]=function h4(e,r,t,n){var i="string"==typeof e.ref?e.ref:ot(e.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var s=t.Workbook.Names,o=Ht(i);o.s.r==o.e.r&&(o.e.r=Ht(r["!ref"]).e.r,i=ot(o));for(var l=0;l<s.length;++l){var g=s[l];if("_xlnm._FilterDatabase"==g.Name&&g.Sheet==n){g.Ref=ea(t.SheetNames[n])+"!"+xi(i);break}}return l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+t.SheetNames[n]+"'!"+i}),pe("autoFilter",null,{ref:i})}(g["!autofilter"],g,t,e)),null!=g["!merges"]&&g["!merges"].length>0&&(i[i.length]=function t4(e){if(0===e.length)return"";for(var r='<mergeCells count="'+e.length+'">',t=0;t!=e.length;++t)r+='<mergeCell ref="'+ot(e[t])+'"/>';return r+"</mergeCells>"}(g["!merges"]));var I,C=-1,m=-1;return g["!links"].length>0&&(i[i.length]="<hyperlinks>",g["!links"].forEach(function(_){_[1].Target&&(I={ref:_[0]},"#"!=_[1].Target.charAt(0)&&(m=wt(n,-1,st(_[1].Target).replace(/#[\s\S]*$/,""),lt.HLINK),I["r:id"]="rId"+m),(C=_[1].Target.indexOf("#"))>-1&&(I.location=st(_[1].Target.slice(C+1))),_[1].Tooltip&&(I.tooltip=st(_[1].Tooltip)),I.display=_[1].display,i[i.length]=pe("hyperlink",null,I))}),i[i.length]="</hyperlinks>"),delete g["!links"],null!=g["!margins"]&&(i[i.length]=function c4(e){return si(e),pe("pageMargins",null,e)}(g["!margins"])),(!r||r.ignoreEC||null==r.ignoreEC)&&(i[i.length]=gr("ignoredErrors",pe("ignoredError",null,{numberStoredAsText:1,sqref:u}))),A.length>0&&(m=wt(n,-1,"../drawings/drawing"+(e+1)+".xml",lt.DRAW),i[i.length]=pe("drawing",null,{"r:id":"rId"+m}),g["!drawing"]=A),g["!comments"].length>0&&(m=wt(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",lt.VML),i[i.length]=pe("legacyDrawing",null,{"r:id":"rId"+m}),g["!legacy"]=m),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function k4(e,r,t,n){var i=function v4(e,r,t){var n=J(145),i=(t["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;i.hpx?s=20*ca(i.hpx):i.hpt&&(s=20*i.hpt),n.write_shift(2,s),n.write_shift(1,0);var o=0;i.level&&(o|=i.level),i.hidden&&(o|=16),(i.hpx||i.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var l=0,g=n.l;n.l+=4;for(var u={r:e,c:0},h=null!=t["!data"],A=0;A<16;++A)if(!(r.s.c>A+1<<10||r.e.c<A<<10)){for(var C=-1,I=-1,m=A<<10;m<A+1<<10;++m)u.c=m,(h?(t["!data"][u.r]||[])[u.c]:t[ht(u)])&&(C<0&&(C=m),I=m);C<0||(++l,n.write_shift(4,C),n.write_shift(4,I))}var p=n.l;return n.l=g,n.write_shift(4,l),n.l=p,n.length>n.l?n.slice(0,n.l):n}(n,t,r);(i.length>17||(r["!rows"]||[])[n])&&oe(e,0,i)}var w4=Zn,y4=ki;function Fo(e,r,t){return null==t&&(t=J(9)),Yn(r,t),t.write_shift(1,e.v),t}function Do(e,r,t){return null==t&&(t=J(8)),Kn(r,t),t.write_shift(1,e.v),t.write_shift(2,0),t.write_shift(1,0),t}function ig(e){return[Jn(e),pr(e),"n"]}var s3=Zn,o3=ki,ag=["left","right","top","bottom","header","footer"];function w3(e,r,t,n,i,s,o,l){var g={r:t,c:n};if(r.c&&s["!comments"].push([ht(g),r.c]),void 0===r.v)return!1;var u="";switch(r.t){case"b":u=r.v?"1":"0";break;case"d":(r=xt(r)).z=r.z||Ve[14],r.v=Ot(Pt(r.v,l),l),r.t="n";break;case"n":case"e":u=""+r.v;break;default:u=r.v}switch(g.s=fn(i.cellXfs,r,i),r.l&&s["!links"].push([ht(g),r.l]),r.t){case"s":case"str":return i.bookSST?(u=bo(i.Strings,null==r.v?"":String(r.v),i.revStrings),g.t="s",g.v=u,o?oe(e,18,function V4(e,r,t){return null==t&&(t=J(8)),Kn(r,t),t.write_shift(4,r.v),t}(0,g)):oe(e,7,function G4(e,r,t){return null==t&&(t=J(12)),Yn(r,t),t.write_shift(4,r.v),t}(0,g))):(g.t="str",o?oe(e,17,function e3(e,r,t){var n=null==e.v?"":String(e.v);return null==t&&(t=J(8+4*n.length)),Kn(r,t),tr(n,t),t.length>t.l?t.slice(0,t.l):t}(r,g)):oe(e,6,function Q4(e,r,t){var n=null==e.v?"":String(e.v);return null==t&&(t=J(12+4*e.v.length)),Yn(r,t),tr(n,t),t.length>t.l?t.slice(0,t.l):t}(r,g))),!0;case"n":return r.v==(0|r.v)&&r.v>-1e3&&r.v<1e3?o?oe(e,13,function J4(e,r,t){return null==t&&(t=J(8)),Kn(r,t),Dl(e.v,t),t}(r,g)):oe(e,2,function H4(e,r,t){return null==t&&(t=J(12)),Yn(r,t),Dl(e.v,t),t}(r,g)):isFinite(r.v)?o?oe(e,16,function X4(e,r,t){return null==t&&(t=J(12)),Kn(r,t),Qn(e.v,t),t}(r,g)):oe(e,5,function W4(e,r,t){return null==t&&(t=J(16)),Yn(r,t),Qn(e.v,t),t}(r,g)):(g.t="e",isNaN(r.v)?o?oe(e,14,Do({t:"e",v:36},g)):oe(e,3,Fo({t:"e",v:36},g)):o?oe(e,14,Do({t:"e",v:7},g)):oe(e,3,Fo({t:"e",v:7},g))),!0;case"b":return g.t="b",o?oe(e,15,function B4(e,r,t){return null==t&&(t=J(5)),Kn(r,t),t.write_shift(1,e.v?1:0),t}(r,g)):oe(e,4,function R4(e,r,t){return null==t&&(t=J(9)),Yn(r,t),t.write_shift(1,e.v?1:0),t}(r,g)),!0;case"e":return g.t="e",o?oe(e,14,Do(r,g)):oe(e,3,Fo(r,g)),!0}return o?oe(e,12,function N4(e,r,t){return null==t&&(t=J(4)),Kn(r,t)}(0,g)):oe(e,1,function F4(e,r,t){return null==t&&(t=J(8)),Yn(r,t)}(0,g)),!0}function R3(e,r,t,n){var i=Ir(),s=t.SheetNames[e],o=t.Sheets[s]||{},l=s;try{t&&t.Workbook&&(l=t.Workbook.Sheets[e].CodeName||l)}catch{}var g=Ct(o["!ref"]||"A1");if(g.e.c>16383||g.e.r>1048575){if(r.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");g.e.c=Math.min(g.e.c,16383),g.e.r=Math.min(g.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],oe(i,129),(t.vbaraw||o["!outline"])&&oe(i,147,function b4(e,r,t){null==t&&(t=J(84+4*e.length));var n=192;r&&(r.above&&(n&=-65),r.left&&(n&=-129)),t.write_shift(1,n);for(var i=1;i<3;++i)t.write_shift(1,0);return ns({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),Fl(e,t),t.slice(0,t.l)}(l,o["!outline"])),oe(i,148,y4(g)),function N3(e,r,t){oe(e,133),oe(e,137,function d3(e,r,t){null==t&&(t=J(30));var n=924;return(((r||{}).Views||[])[0]||{}).RTL&&(n|=32),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}(0,t)),oe(e,138),oe(e,134)}(i,0,t.Workbook),function S3(e,r){!r||!r["!cols"]||(oe(e,390),r["!cols"].forEach(function(t,n){t&&oe(e,60,function C3(e,r,t){null==t&&(t=J(18));var n=pa(e,r);t.write_shift(-4,e),t.write_shift(-4,e),t.write_shift(4,256*(n.width||10)),t.write_shift(4,0);var i=0;return r.hidden&&(i|=1),"number"==typeof n.width&&(i|=2),r.level&&(i|=r.level<<8),t.write_shift(2,i),t}(n,t))}),oe(e,391))}(i,o),function y3(e,r,t,n,i){var s=Ct(r["!ref"]||"A1"),o="",l=[],g=(((i||{}).Workbook||{}).WBProps||{}).date1904;oe(e,145);var u=null!=r["!data"],h=u?r["!data"][s.s.r]:[],A=s.e.r;r["!rows"]&&(A=Math.max(s.e.r,r["!rows"].length-1));for(var C=s.s.r;C<=A;++C)if(o=ut(C),u&&(h=r["!data"][C]),k4(e,r,s,C),!u||h){var I=!1;if(C<=s.e.r)for(var m=s.s.c;m<=s.e.c;++m){C===s.s.r&&(l[m]=rt(m));var _=u?h[m]:r[l[m]+o];I=!!_&&w3(e,_,C,m,n,r,I,g)}}oe(e,146)}(i,o,0,r,t),function P3(e,r){r["!protect"]&&oe(e,535,function _3(e,r){return null==r&&(r=J(66)),r.write_shift(2,e.password?_o(e.password):0),r.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){r.write_shift(4,t[1]?null==e[t[0]]||e[t[0]]?0:1:null!=e[t[0]]&&e[t[0]]?0:1)}),r}(r["!protect"]))}(i,o),function D3(e,r,t,n){if(r["!autofilter"]){var i=r["!autofilter"],s="string"==typeof i.ref?i.ref:ot(i.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var o=t.Workbook.Names,l=Ht(s);l.s.r==l.e.r&&(l.e.r=Ht(r["!ref"]).e.r,s=ot(l));for(var g=0;g<o.length;++g){var u=o[g];if("_xlnm._FilterDatabase"==u.Name&&u.Sheet==n){u.Ref=ea(t.SheetNames[n])+"!"+xi(s);break}}g==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:ea(t.SheetNames[n])+"!"+xi(s)}),oe(e,161,ki(Ct(s))),oe(e,162)}}(i,o,t,e),function T3(e,r){!r||!r["!merges"]||(oe(e,177,function l3(e,r){return null==r&&(r=J(4)),r.write_shift(4,e),r}(r["!merges"].length)),r["!merges"].forEach(function(t){oe(e,176,o3(t))}),oe(e,178))}(i,o),function E3(e,r,t){r["!links"].forEach(function(n){if(n[1].Target){var i=wt(t,-1,n[1].Target.replace(/#[\s\S]*$/,""),lt.HLINK);oe(e,494,function g3(e,r){var t=J(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));ki({s:Tt(e[0]),e:Tt(e[0])},t),no("rId"+r,t);var n=e[1].Target.indexOf("#");return tr((-1==n?"":e[1].Target.slice(n+1))||"",t),tr(e[1].Tooltip||"",t),tr("",t),t.slice(0,t.l)}(n,i))}}),delete r["!links"]}(i,o,n),o["!margins"]&&oe(i,476,function A3(e,r){return null==r&&(r=J(48)),si(e),ag.forEach(function(t){Qn(e[t],r)}),r}(o["!margins"])),(!r||r.ignoreEC||null==r.ignoreEC)&&function b3(e,r){!r||!r["!ref"]||(oe(e,648),oe(e,649,function m3(e){var r=J(24);return r.write_shift(4,4),r.write_shift(4,1),ki(e,r),r}(Ct(r["!ref"]))),oe(e,650))}(i,o),function F3(e,r,t,n){if(r["!comments"].length>0){var i=wt(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",lt.VML);oe(e,551,no("rId"+i)),r["!legacy"]=i}}(i,o,e,n),oe(i,130),i.end()}var No=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],G3=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],j3=[],V3=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function sg(e,r){for(var t=0;t!=e.length;++t)for(var n=e[t],i=0;i!=r.length;++i){var s=r[i];if(null==n[s[0]])n[s[0]]=s[1];else switch(s[2]){case"bool":"string"==typeof n[s[0]]&&(n[s[0]]=kt(n[s[0]]));break;case"int":"string"==typeof n[s[0]]&&(n[s[0]]=parseInt(n[s[0]],10))}}}function og(e,r){for(var t=0;t!=r.length;++t){var n=r[t];if(null==e[n[0]])e[n[0]]=n[1];else switch(n[2]){case"bool":"string"==typeof e[n[0]]&&(e[n[0]]=kt(e[n[0]]));break;case"int":"string"==typeof e[n[0]]&&(e[n[0]]=parseInt(e[n[0]],10))}}}function lg(e){og(e.WBProps,No),og(e.CalcPr,V3),sg(e.WBView,G3),sg(e.Sheets,j3),Ei.date1904=kt(e.WBProps.date1904)}var W3=":][*?/\\".split("");function cg(e,r){try{if(""==e)throw new Error("Sheet name cannot be blank");if(e.length>31)throw new Error("Sheet name cannot exceed 31 chars");if(39==e.charCodeAt(0)||39==e.charCodeAt(e.length-1))throw new Error("Sheet name cannot start or end with apostrophe (')");if("history"==e.toLowerCase())throw new Error("Sheet name cannot be 'History'");W3.forEach(function(t){if(-1!=e.indexOf(t))throw new Error("Sheet name cannot contain : \\ / ? * [ ]")})}catch(t){if(r)return!1;throw t}return!0}var z3=/<\w+:workbook/;function K3(e,r){return r||(r=J(127)),r.write_shift(4,e.Hidden),r.write_shift(4,e.iTabID),no(e.strRelID,r),tr(e.name.slice(0,31),r),r.length>r.l?r.slice(0,r.l):r}function q3(e,r){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=r-8,t}function gk(e,r){var t=Ir();return oe(t,131),oe(t,128,function ik(e,r){r||(r=J(127));for(var t=0;4!=t;++t)r.write_shift(4,0);return tr("SheetJS",r),tr(Gi.version,r),tr(Gi.version,r),tr("7262",r),r.length>r.l?r.slice(0,r.l):r}()),oe(t,153,function Q3(e,r){r||(r=J(72));var t=0;return e&&(e.date1904&&(t|=1),e.filterPrivacy&&(t|=8)),r.write_shift(4,t),r.write_shift(4,0),Fl(e&&e.CodeName||"ThisWorkbook",r),r.slice(0,r.l)}(e.Workbook&&e.Workbook.WBProps||null)),function sk(e,r){if(r.Workbook&&r.Workbook.Sheets){for(var t=r.Workbook.Sheets,n=0,i=-1,s=-1;n<t.length;++n)!t[n]||!t[n].Hidden&&-1==i?i=n:1==t[n].Hidden&&-1==s&&(s=n);s>i||(oe(e,135),oe(e,158,function ak(e,r){return r||(r=J(29)),r.write_shift(-4,0),r.write_shift(-4,460),r.write_shift(4,28800),r.write_shift(4,17600),r.write_shift(4,500),r.write_shift(4,e),r.write_shift(4,e),r.write_shift(1,120),r.length>r.l?r.slice(0,r.l):r}(i)),oe(e,136))}}(t,e),function nk(e,r){oe(e,143);for(var t=0;t!=r.SheetNames.length;++t)oe(e,156,K3({Hidden:r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[t]&&r.Workbook.Sheets[t].Hidden||0,iTabID:t+1,strRelID:"rId"+(t+1),name:r.SheetNames[t]}));oe(e,144)}(t,e),function ck(e,r){oe(e,353),oe(e,357),oe(e,362,function lk(e){var r=e.SheetNames.length,t=J(12*r+28);t.write_shift(4,r+2),t.write_shift(4,0),t.write_shift(4,-2),t.write_shift(4,-2),t.write_shift(4,0),t.write_shift(4,-1),t.write_shift(4,-1);for(var n=0;n<r;++n)t.write_shift(4,0),t.write_shift(4,n),t.write_shift(4,n);return t}(r)),oe(e,354)}(t,e),(e.Workbook||{}).Names&&function ok(e,r){!r.Workbook||!r.Workbook.Names||r.Workbook.Names.forEach(function(t){try{if(14&t.Flags)return;oe(e,39,function tk(e,r){var t=J(9),n=0,i=e.Name;oo.indexOf(i)>-1&&(n|=32,i=i.slice(6)),t.write_shift(4,n),t.write_shift(1,0),t.write_shift(4,null==e.Sheet?4294967295:e.Sheet);var s=[t,tr(i),Vv(e.Ref,r)];if(e.Comment)s.push(ta(e.Comment));else{var o=J(4);o.write_shift(4,4294967295),s.push(o)}return jt(s)}(t,r))}catch{console.error("Could not serialize defined name "+JSON.stringify(t))}})}(t,e),oe(t,132),t.end()}function uk(e,r,t,n,i,s,o,l){return".bin"===r.slice(-4)?function k3(e,r,t,n,i,s,o){if(!e)return e;var l=r||{};n||(n={"!id":{}}),null!=Gt&&null==l.dense&&(l.dense=Gt);var g={};l.dense&&(g["!data"]=[]);var u,m,_,p,d,w,v,S,G,X,h={s:{r:2e6,c:2e6},e:{r:0,c:0}},A=[],C=!1,I=!1,E=[];l.biff=12,l["!row"]=0;var O=0,L=!1,W=[],H={},Y=l.supbooks||i.supbooks||[[]];if(Y.sharedf=H,Y.arrayf=W,Y.SheetNames=i.SheetNames||i.Sheets.map(function(Ke){return Ke.name}),!l.supbooks&&(l.supbooks=Y,i.Names))for(var ee=0;ee<i.Names.length;++ee)Y[0][ee+1]=i.Names[ee];var Te=[],le=[],Pe=!1;_a[16]={n:"BrtShortReal",f:ig};var ce,Re,Xe=1462*+!!((i||{}).WBProps||{}).date1904;if(kn(e,function(re,he,Ce){if(!I)switch(Ce){case 148:u=re;break;case 0:m=re,l.sheetRows&&l.sheetRows<=m.r&&(I=!0),G=ut(d=m.r),l["!row"]=m.r,(re.hidden||re.hpt||null!=re.level)&&(re.hpt&&(re.hpx=bi(re.hpt)),le[re.r]=re);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(_={t:re[2]},re[2]){case"n":_.v=re[1];break;case"s":_.v=(S=Ia[re[1]]).t,_.r=S.r;break;case"b":_.v=!!re[1];break;case"e":_.v=re[1],!1!==l.cellText&&(_.w=rr[_.v]);break;case"str":_.t="s",_.v=re[1];break;case"is":_.t="s",_.v=re[1].t}if((p=o.CellXf[re[0].iStyleRef])&&rg(_,p.numFmtId,null,l,s,o,Xe>0),w=-1==re[0].c?w+1:re[0].c,l.dense?(g["!data"][d]||(g["!data"][d]=[]),g["!data"][d][w]=_):g[rt(w)+G]=_,l.cellFormula){for(L=!1,O=0;O<W.length;++O){var Ue=W[O];m.r>=Ue[0].s.r&&m.r<=Ue[0].e.r&&w>=Ue[0].s.c&&w<=Ue[0].e.c&&(_.F=ot(Ue[0]),L=!0)}!L&&re.length>3&&(_.f=re[3])}if(h.s.r>m.r&&(h.s.r=m.r),h.s.c>w&&(h.s.c=w),h.e.r<m.r&&(h.e.r=m.r),h.e.c<w&&(h.e.c=w),l.cellDates&&p&&"n"==_.t&&Mr(Ve[p.numFmtId])){var ve=on(_.v+Xe);ve&&(_.t="d",_.v=new Date(Date.UTC(ve.y,ve.m-1,ve.d,ve.H,ve.M,ve.S,ve.u)))}ce&&("XLDAPR"==ce.type&&(_.D=!0),ce=void 0),Re&&(Re=void 0);break;case 1:case 12:if(!l.sheetStubs||C)break;_={t:"z",v:void 0},w=-1==re[0].c?w+1:re[0].c,l.dense?(g["!data"][d]||(g["!data"][d]=[]),g["!data"][d][w]=_):g[rt(w)+G]=_,h.s.r>m.r&&(h.s.r=m.r),h.s.c>w&&(h.s.c=w),h.e.r<m.r&&(h.e.r=m.r),h.e.c<w&&(h.e.c=w),ce&&("XLDAPR"==ce.type&&(_.D=!0),ce=void 0),Re&&(Re=void 0);break;case 176:E.push(re);break;case 49:ce=((l.xlmeta||{}).Cell||[])[re-1];break;case 494:var Ne=n["!id"][re.relId];for(Ne?(re.Target=Ne.Target,re.loc&&(re.Target+="#"+re.loc),re.Rel=Ne):""==re.relId&&(re.Target="#"+re.loc),d=re.rfx.s.r;d<=re.rfx.e.r;++d)for(w=re.rfx.s.c;w<=re.rfx.e.c;++w)l.dense?(g["!data"][d]||(g["!data"][d]=[]),g["!data"][d][w]||(g["!data"][d][w]={t:"z",v:void 0}),g["!data"][d][w].l=re):(v=rt(w)+ut(d),g[v]||(g[v]={t:"z",v:void 0}),g[v].l=re);break;case 426:if(!l.cellFormula)break;W.push(re),(X=l.dense?g["!data"][d][w]:g[rt(w)+G]).f=xr(re[1],0,{r:m.r,c:w},Y,l),X.F=ot(re[0]);break;case 427:if(!l.cellFormula)break;H[ht(re[0].s)]=re[1],(X=l.dense?g["!data"][d][w]:g[rt(w)+G]).f=xr(re[1],0,{r:m.r,c:w},Y,l);break;case 60:if(!l.cellStyles)break;for(;re.e>=re.s;)Te[re.e--]={width:re.w/256,hidden:!!(1&re.flags),level:re.level},Pe||(Pe=!0,vo(re.w/256)),Tn(Te[re.e+1]);break;case 551:re&&(g["!legrel"]=re);break;case 161:g["!autofilter"]={ref:ot(re)};break;case 476:g["!margins"]=re;break;case 147:i.Sheets[t]||(i.Sheets[t]={}),re.name&&(i.Sheets[t].CodeName=re.name),(re.above||re.left)&&(g["!outline"]={above:re.above,left:re.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),re.RTL&&(i.Views[0].RTL=!0);break;case 485:case 64:case 1053:case 151:case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:C=!0;break;case 36:C=!1;break;case 37:A.push(Ce),C=!0;break;case 38:A.pop(),C=!1;break;default:if(!he.T&&(!C||l.WTF))throw new Error("Unexpected record 0x"+Ce.toString(16))}},l),delete l.supbooks,delete l["!row"],!g["!ref"]&&(h.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(g["!ref"]=ot(u||h)),l.sheetRows&&g["!ref"]){var ue=Ct(g["!ref"]);l.sheetRows<=+ue.e.r&&(ue.e.r=l.sheetRows-1,ue.e.r>h.e.r&&(ue.e.r=h.e.r),ue.e.r<ue.s.r&&(ue.s.r=ue.e.r),ue.e.c>h.e.c&&(ue.e.c=h.e.c),ue.e.c<ue.s.c&&(ue.s.c=ue.e.c),g["!fullref"]=g["!ref"],g["!ref"]=ot(ue))}return E.length>0&&(g["!merges"]=E),Te.length>0&&(g["!cols"]=Te),le.length>0&&(g["!rows"]=le),n["!id"][g["!legrel"]]&&(g["!legdrawel"]=n["!id"][g["!legrel"]]),g}(e,n,t,i,s,o,l):function e4(e,r,t,n,i,s,o){if(!e)return e;n||(n={"!id":{}}),null!=Gt&&null==r.dense&&(r.dense=Gt);var l={};r.dense&&(l["!data"]=[]);var g={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",h="",A=ir(e,"sheetData");A?(u=e.slice(0,A.index),h=e.slice(A.index+A[0].length)):u=h=e;var C=u.match(ng);C?Eo(C[0],0,i,t):(C=ir(u,"sheetPr"))&&function r4(e,r,t,n,i){Eo(e.slice(0,e.indexOf(">")),0,n,i)}(C[0],0,0,i,t);var I=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(I>0){var m=u.slice(I,I+50).match(Kv);m&&(!r||!r.nodim)&&function Hv(e,r){var t=Ct(r);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=ot(t))}(l,m[1])}var _=ir(u,"sheetViews");_&&_[1]&&function I4(e,r){r.Views||(r.Views=[{}]),(e.match(C4)||[]).forEach(function(t,n){var i=Me(t);r.Views[n]||(r.Views[n]={}),+i.zoomScale&&(r.Views[n].zoom=+i.zoomScale),i.rightToLeft&&kt(i.rightToLeft)&&(r.Views[n].RTL=!0)})}(_[1],i);var p=[];if(r.cellStyles){var d=u.match(Zv);d&&function g4(e,r){for(var t=!1,n=0;n!=r.length;++n){var i=Me(r[n],!0);i.hidden&&(i.hidden=kt(i.hidden));var s=parseInt(i.min,10)-1,o=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!t&&i.width&&(t=!0,vo(i.width)),Tn(i);s<=o;)e[s++]=xt(i)}}(p,d)}A&&d4(A[1],l,r,g,s,o,i);var w=h.match(Qv);w&&(l["!autofilter"]=function u4(e){return{ref:(e.match(/ref="([^"]*)"/)||[])[1]}}(w[0]));var v=[],S=h.match(Yv);if(S)for(I=0;I!=S.length;++I)v[I]=Ct(S[I].slice(S[I].indexOf("=")+2));var G=h.match(Jv);G&&function o4(e,r,t){for(var n=null!=e["!data"],i=0;i!=r.length;++i){var s=Me(yt(r[i]),!0);if(!s.ref)return;var o=((t||{})["!id"]||[])[s.id];o?(s.Target=o.Target,s.location&&(s.Target+="#"+pt(s.location))):(s.Target="#"+pt(s.location),o={Target:s.Target,TargetMode:"Internal"}),s.Rel=o,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var l=Ct(s.ref),g=l.s.r;g<=l.e.r;++g)for(var u=l.s.c;u<=l.e.c;++u){var h=rt(u)+ut(g);n?(e["!data"][g]||(e["!data"][g]=[]),e["!data"][g][u]||(e["!data"][g][u]={t:"z",v:void 0}),e["!data"][g][u].l=s):(e[h]||(e[h]={t:"z",v:void 0}),e[h].l=s)}}}(l,G,n);var E,X=h.match(qv);if(X&&(l["!margins"]=function l4(e){var r={};return["left","right","top","bottom","header","footer"].forEach(function(t){e[t]&&(r[t]=parseFloat(e[t]))}),r}(Me(X[0]))),(E=h.match(/legacyDrawing r:id="(.*?)"/))&&(l["!legrel"]=E[1]),r&&r.nodim&&(g.s.c=g.s.r=0),!l["!ref"]&&g.e.c>=g.s.c&&g.e.r>=g.s.r&&(l["!ref"]=ot(g)),r.sheetRows>0&&l["!ref"]){var O=Ct(l["!ref"]);r.sheetRows<=+O.e.r&&(O.e.r=r.sheetRows-1,O.e.r>g.e.r&&(O.e.r=g.e.r),O.e.r<O.s.r&&(O.s.r=O.e.r),O.e.c>g.e.c&&(O.e.c=g.e.c),O.e.c<O.s.c&&(O.s.c=O.e.c),l["!fullref"]=l["!ref"],l["!ref"]=ot(O))}return p.length>0&&(l["!cols"]=p),v.length>0&&(l["!merges"]=v),n["!id"][l["!legrel"]]&&(l["!legdrawel"]=n["!id"][l["!legrel"]]),l}(e,n,t,i,s,o,l)}var da,fg=/\b((?:\w+:)?[\w]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,ug=/\b((?:\w+:)?[\w]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function qr(e,r){var t=e.split(/\s+/),n=[];if(r||(n[0]=t[0]),1===t.length)return n;var s,o,g,i=e.match(fg);if(i)for(g=0;g!=i.length;++g)-1===(o=(s=i[g].match(ug))[1].indexOf(":"))?n[s[1]]=s[2].slice(1,s[2].length-1):n["xmlns:"===s[1].slice(0,6)?"xmlns"+s[1].slice(6):s[1].slice(o+1)]=s[2].slice(1,s[2].length-1);return n}function vk(e){var t={};if(1===e.split(/\s+/).length)return t;var i,s,l,n=e.match(fg);if(n)for(l=0;l!=n.length;++l)-1===(s=(i=n[l].match(ug))[1].indexOf(":"))?t[i[1]]=i[2].slice(1,i[2].length-1):t["xmlns:"===i[1].slice(0,6)?"xmlns"+i[1].slice(6):i[1].slice(s+1)]=i[2].slice(1,i[2].length-1);return t}function wk(e,r,t,n){var i=n;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=kt(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=Pt(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[pt(r)]=i}function Tk(e,r,t){if(t.cellStyles&&r.Interior){var n=r.Interior;n.Pattern&&(n.patternType=M_[n.Pattern]||n.Pattern)}e[r.ID]=r}function Sk(e,r,t,n,i,s,o,l,g,u,h){var A="General",C=n.StyleID,I={};u=u||{};var m=[],_=0;for(void 0===C&&l&&(C=l.StyleID),void 0===C&&o&&(C=o.StyleID);void 0!==s[C];){var p=s[C];if(p.nf&&(A=p.nf),p.Interior&&m.push(p.Interior),!p.Parent)break;C=p.Parent}switch(t.Type){case"Boolean":n.t="b",n.v=kt(e);break;case"String":n.t="s",n.r=ol(pt(e)),n.v=e.indexOf("<")>-1?pt(r||e).replace(/<[^<>]*>/g,""):n.r;break;case"DateTime":"Z"!=e.slice(-1)&&(e+="Z"),n.v=Ot(Pt(e,h),h),n.v!=n.v&&(n.v=pt(e)),(!A||"General"==A)&&(A="yyyy-mm-dd");case"Number":void 0===n.v&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=or[e],!1!==u.cellText&&(n.w=e);break;default:""==e&&""==r?n.t="z":(n.t="s",n.v=ol(r||e))}if(function yk(e,r,t,n){if("z"!==e.t){if(!t||!1!==t.cellText)try{e.w="e"===e.t?e.w||rr[e.v]:"General"===r?"n"===e.t?(0|e.v)===e.v?e.v.toString(10):Xi(e.v):Gn(e.v):function kk(e,r,t){var n=da[e]||pt(e);return"General"===n?Gn(r):Dr(n,r,{date1904:!!t})}(r||"General",e.v,n)}catch(o){if(t.WTF)throw o}try{var i=da[r]||r||"General";if(t.cellNF&&(e.z=i),t.cellDates&&"n"==e.t&&Mr(i)){var s=on(e.v+(n?1462:0));s&&(e.t="d",e.v=new Date(Date.UTC(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u)))}}catch(o){if(t.WTF)throw o}}}(n,A,u,h),!1!==u.cellFormula)if(n.Formula){var d=pt(n.Formula);61==d.charCodeAt(0)&&(d=d.slice(1)),n.f=ai(d,i),delete n.Formula,"RC"==n.ArrayRange?n.F=ai("RC:RC",i):n.ArrayRange&&(n.F=ai(n.ArrayRange,i),g.push([Ct(n.F),n.F]))}else for(_=0;_<g.length;++_)i.r>=g[_][0].s.r&&i.r<=g[_][0].e.r&&i.c>=g[_][0].s.c&&i.c<=g[_][0].e.c&&(n.F=g[_][1]);u.cellStyles&&(m.forEach(function(w){!I.patternType&&w.patternType&&(I.patternType=w.patternType)}),n.s=I),void 0!==n.StyleID&&(n.ixfe=n.StyleID)}function bk(e){return oo.indexOf("_xlnm."+e)>-1?"_xlnm."+e:e}function Ek(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),e.v=e.w=e.ixfe=void 0}function Po(e,r){var t=r||{};jn();var n=Ci(Qa(e));("binary"==t.type||"array"==t.type||"base64"==t.type)&&(n=typeof gt<"u"?gt.utils.decode(65001,$a(n)):yt(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if((1023&(i=i.replace(/".*?"/g,"")).indexOf(">"))>Math.min(1023&i.indexOf(","),1023&i.indexOf(";"))){var o=xt(t);return o.type="string",Ti.to_workbook(n,o)}if(-1==i.indexOf("<?xml")&&["html","table","head","meta","script","style","div"].forEach(function(et){i.indexOf("<"+et)>=0&&(s=!0)}),s)return function iw(e,r){var t=Mp(e,"table");if(!t||0==t.length)throw new Error("Invalid HTML: could not find <table>");if(1==t.length){var n=Pn(wg(t[0],r),r);return n.bookType="html",n}var i=Qo();return t.forEach(function(s,o){Ta(i,wg(s,r),"Sheet"+(o+1))}),i.bookType="html",i}(n,t);da={"General Number":"General","General Date":Ve[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ve[15],"Short Date":Ve[14],"Long Time":Ve[19],"Medium Time":Ve[18],"Short Time":Ve[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ve[2],Standard:Ve[4],Percent:Ve[10],Scientific:Ve[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,u,g=[];null!=Gt&&null==t.dense&&(t.dense=Gt);var h={},A=[],C={},I="";t.dense&&(C["!data"]=[]);var ce,m={},_={},p=qr('<Data ss:Type="String">'),d=0,w=0,v=0,S={s:{r:2e6,c:2e6},e:{r:0,c:0}},G={},X={},E="",O=0,L=[],W={},H={},Y=0,ee=[],Te=[],le={},Pe=[],Re=!1,Xe=[],ue=[],Ke={},re=0,he=0,Ce={Sheets:[],WBProps:{date1904:!1}},Ue={};zt.lastIndex=0,n=Ji(n,"\x3c!--","--\x3e");for(var ve="";l=zt.exec(n);)switch(l[3]=(ve=l[3]).toLowerCase()){case"data":if("data"==ve){if("/"===l[1]){if((u=g.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else"/"!==l[0].charAt(l[0].length-2)&&g.push([l[3],!0]);break}if(g[g.length-1][1])break;"/"===l[1]?Sk(n.slice(d,l.index),E,p,"comment"==g[g.length-1][0]?le:m,{c:w,r:v},G,Pe[w],_,Xe,t,Ce.WBProps.date1904):(E="",p=qr(l[0]),d=l.index+l[0].length);break;case"cell":if("/"===l[1])if(Te.length>0&&(m.c=Te),(!t.sheetRows||t.sheetRows>v)&&void 0!==m.v&&(t.dense?(C["!data"][v]||(C["!data"][v]=[]),C["!data"][v][w]=m):C[rt(w)+ut(v)]=m),m.HRef&&(m.l={Target:pt(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(re=w+(0|parseInt(m.MergeAcross,10)),he=v+(0|parseInt(m.MergeDown,10)),(re>w||he>v)&&L.push({s:{c:w,r:v},e:{c:re,r:he}})),t.sheetStubs)if(m.MergeAcross||m.MergeDown){for(var Ne=w;Ne<=re;++Ne)for(var D=v;D<=he;++D)(Ne>w||D>v)&&(t.dense?(C["!data"][D]||(C["!data"][D]=[]),C["!data"][D][Ne]={t:"z"}):C[rt(Ne)+ut(D)]={t:"z"});w=re+1}else++w;else m.MergeAcross?w=re+1:++w;else(m=vk(l[0])).Index&&(w=+m.Index-1),w<S.s.c&&(S.s.c=w),w>S.e.c&&(S.e.c=w),"/>"===l[0].slice(-2)&&++w,Te=[];break;case"row":"/"===l[1]||"/>"===l[0].slice(-2)?(v<S.s.r&&(S.s.r=v),v>S.e.r&&(S.e.r=v),"/>"===l[0].slice(-2)&&(_=qr(l[0])).Index&&(v=+_.Index-1),w=0,++v):((_=qr(l[0])).Index&&(v=+_.Index-1),Ke={},("0"==_.AutoFitHeight||_.Height)&&(Ke.hpx=parseInt(_.Height,10),Ke.hpt=ca(Ke.hpx),ue[v]=Ke),"1"==_.Hidden&&(Ke.hidden=!0,ue[v]=Ke));break;case"worksheet":if("/"===l[1]){if((u=g.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));A.push(I),S.s.r<=S.e.r&&S.s.c<=S.e.c&&(C["!ref"]=ot(S),t.sheetRows&&t.sheetRows<=S.e.r&&(C["!fullref"]=C["!ref"],S.e.r=t.sheetRows-1,C["!ref"]=ot(S))),L.length&&(C["!merges"]=L),Pe.length>0&&(C["!cols"]=Pe),ue.length>0&&(C["!rows"]=ue),h[I]=C}else S={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=w=0,g.push([l[3],!1]),u=qr(l[0]),I=pt(u.Name),C={},t.dense&&(C["!data"]=[]),L=[],Xe=[],ue=[],Ce.Sheets.push(Ue={name:I,Hidden:0});break;case"table":if("/"===l[1]){if((u=g.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else{if("/>"==l[0].slice(-2))break;g.push([l[3],!1]),Pe=[],Re=!1}break;case"style":"/"===l[1]?Tk(G,X,t):X=qr(l[0]);break;case"numberformat":X.nf=pt(qr(l[0]).Format||"General"),da[X.nf]&&(X.nf=da[X.nf]);for(var z=0;392!=z&&Ve[z]!=X.nf;++z);if(392==z)for(z=57;392!=z;++z)if(null==Ve[z]){Nn(X.nf,z);break}break;case"column":if("table"!==g[g.length-1][0]||"/"===l[1])break;if((ce=qr(l[0])).Hidden&&(ce.hidden=!0,delete ce.Hidden),ce.Width&&(ce.wpx=parseInt(ce.Width,10)),!Re&&ce.wpx>10){Re=!0,_r=Fc;for(var j=0;j<Pe.length;++j)Pe[j]&&Tn(Pe[j])}Re&&Tn(ce),Pe[ce.Index-1||Pe.length]=ce;for(var U=0;U<+ce.Span;++U)Pe[Pe.length]=xt(ce);break;case"namedrange":if("/"===l[1])break;Ce.Names||(Ce.Names=[]);var ae=Me(l[0]),N={Name:bk(ae.Name),Ref:ai(ae.RefersTo.slice(1),{r:0,c:0})};Ce.Sheets.length>0&&(N.Sheet=Ce.Sheets.length-1),Ce.Names.push(N);break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":case"protection":case"paragraphs":case"name":case"pixelsperinch":case"null":break;case"font":if("/>"===l[0].slice(-2))break;"/"===l[1]?E+=n.slice(O,l.index):O=l.index+l[0].length;break;case"interior":if(!t.cellStyles)break;X.Interior=qr(l[0]);break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if("/>"===l[0].slice(-2))break;"/"===l[1]?Gd(W,ve,n.slice(Y,l.index)):Y=l.index+l[0].length;break;case"styles":case"workbook":if("/"===l[1]){if((u=g.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else g.push([l[3],!1]);break;case"comment":if("/"===l[1]){if((u=g.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"));Ek(le),Te.push(le)}else g.push([l[3],!1]),kt((u=qr(l[0])).ShowAlways||"0")||(Te.hidden=!0),le={a:u.Author};break;case"autofilter":if("/"===l[1]){if((u=g.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else if("/"!==l[0].charAt(l[0].length-2)){var De=qr(l[0]);C["!autofilter"]={ref:ai(De.Range).replace(/\$/g,"")},g.push([l[3],!0])}break;case"datavalidation":if("/"===l[1]){if((u=g.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else"/"!==l[0].charAt(l[0].length-2)&&g.push([l[3],!0]);break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if("/"===l[1]){if((u=g.pop())[0]!==l[3])throw new Error("Bad state: "+u.join("|"))}else"/"!==l[0].charAt(l[0].length-2)&&g.push([l[3],!0]);break;default:if(0==g.length&&"document"==l[3]||0==g.length&&"uof"==l[3])return Bg(n,t);var we=!0;switch(g[g.length-1][0]){case"officedocumentsettings":switch(l[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:we=!1}break;case"componentoptions":switch(l[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:we=!1}break;case"excelworkbook":switch(l[3]){case"date1904":Ce.WBProps.date1904=!0;break;case"hidehorizontalscrollbar":case"hideverticalscrollbar":case"hideworkbooktabs":case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:we=!1}break;case"workbookoptions":switch(l[3]){case"owcversion":case"height":case"width":break;default:we=!1}break;case"worksheetoptions":switch(l[3]){case"visible":if("/>"!==l[0].slice(-2))if("/"===l[1])switch(n.slice(Y,l.index)){case"SheetHidden":Ue.Hidden=1;break;case"SheetVeryHidden":Ue.Hidden=2}else Y=l.index+l[0].length;break;case"header":C["!margins"]||si(C["!margins"]={},"xlml"),isNaN(+Me(l[0]).Margin)||(C["!margins"].header=+Me(l[0]).Margin);break;case"footer":C["!margins"]||si(C["!margins"]={},"xlml"),isNaN(+Me(l[0]).Margin)||(C["!margins"].footer=+Me(l[0]).Margin);break;case"pagemargins":var ge=Me(l[0]);C["!margins"]||si(C["!margins"]={},"xlml"),isNaN(+ge.Top)||(C["!margins"].top=+ge.Top),isNaN(+ge.Left)||(C["!margins"].left=+ge.Left),isNaN(+ge.Right)||(C["!margins"].right=+ge.Right),isNaN(+ge.Bottom)||(C["!margins"].bottom=+ge.Bottom);break;case"displayrighttoleft":Ce.Views||(Ce.Views=[]),Ce.Views[0]||(Ce.Views[0]={}),Ce.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"printerrors":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;case"nosummaryrowsbelowdetail":C["!outline"]||(C["!outline"]={}),C["!outline"].above=!0;break;case"nosummarycolumnsrightdetail":C["!outline"]||(C["!outline"]={}),C["!outline"].left=!0;break;default:we=!1}break;case"pivottable":case"pivotcache":switch(l[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:we=!1}break;case"pagebreaks":switch(l[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:we=!1}break;case"autofilter":switch(l[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:we=!1}break;case"querytable":switch(l[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:we=!1}break;case"datavalidation":switch(l[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:we=!1}break;case"sorting":case"conditionalformatting":switch(l[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:we=!1}break;case"mapinfo":case"schema":case"data":switch(l[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:we=!1}break;case"smarttags":break;default:we=!1}if(we||l[3].match(/!\[CDATA/))break;if(!g[g.length-1][1])throw"Unrecognized tag: "+l[3]+"|"+g.join("|");if("customdocumentproperties"===g[g.length-1][0]){if("/>"===l[0].slice(-2))break;"/"===l[1]?wk(H,ve,ee,n.slice(Y,l.index)):(ee=l,Y=l.index+l[0].length);break}if(t.WTF)throw"Unrecognized tag: "+l[3]+"|"+g.join("|")}var He={};return!t.bookSheets&&!t.bookProps&&(He.Sheets=h),He.SheetNames=A,He.Workbook=Ce,He.SSF=xt(Ve),He.Props=W,He.Custprops=H,He.bookType="xlml",He}function Ro(e,r){switch($o(r=r||{}),r.type||"base64"){case"base64":return Po(Br(e),r);case"binary":case"buffer":case"file":return Po(e,r);case"array":return Po(sn(e),r)}}function Ag(e){return pe("NamedRange",null,{"ss:Name":"_xlnm."==e.Name.slice(0,6)?e.Name.slice(6):e.Name,"ss:RefersTo":"="+fa(e.Ref,{r:0,c:0})})}function _g(e,r,t,n,i,s,o){if(!e||null==e.v&&null==e.f)return"";var l={};if(e.f&&(l["ss:Formula"]="="+st(fa(e.f,o))),e.F&&e.F.slice(0,r.length)==r){var g=Tt(e.F.slice(r.length+1));l["ss:ArrayRange"]="RC:R"+(g.r==o.r?"":"["+(g.r-o.r)+"]")+"C"+(g.c==o.c?"":"["+(g.c-o.c)+"]")}if(e.l&&e.l.Target&&(l["ss:HRef"]=st(e.l.Target),e.l.Tooltip&&(l["x:HRefScreenTip"]=st(e.l.Tooltip))),t["!merges"])for(var u=t["!merges"],h=0;h!=u.length;++h)u[h].s.c!=o.c||u[h].s.r!=o.r||(u[h].e.c>u[h].s.c&&(l["ss:MergeAcross"]=u[h].e.c-u[h].s.c),u[h].e.r>u[h].s.r&&(l["ss:MergeDown"]=u[h].e.r-u[h].s.r));var A="",C="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":isFinite(e.v)?(A="Number",C=String(e.v)):(A="Error",C=rr[isNaN(e.v)?36:7]);break;case"b":A="Boolean",C=e.v?"1":"0";break;case"e":A="Error",C=rr[e.v];break;case"d":A="DateTime",C=new Date(e.v).toISOString(),null==e.z&&(e.z=e.z||Ve[14]);break;case"s":A="String",C=function Wp(e){return(e+"").replace($s,function(t){return Vs[t]}).replace(sl,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}(e.v||"")}var I=fn(n.cellXfs,e,n);l["ss:StyleID"]="s"+(21+I),l["ss:Index"]=o.c+1;var _="z"==e.t?"":'<Data ss:Type="'+A+'">'+(null!=e.v?C:"")+"</Data>";return(e.c||[]).length>0&&(_+=function Fk(e){return e.map(function(r){var t=function Xp(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}(r.t||""),n=pe("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"}),i={};return r.a&&(i["ss:Author"]=r.a),e.hidden||(i["ss:ShowAlways"]="1"),pe("Comment",n,i)}).join("")}(e.c)),pe("Cell",_,l)}function xg(e,r){var t='<Row ss:Index="'+(e+1)+'"';return r&&(r.hpt&&!r.hpx&&(r.hpx=bi(r.hpt)),r.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+r.hpx+'"'),r.hidden&&(t+=' ss:Hidden="1"')),t+">"}function Nk(e,r,t){var n=[],s=t.Sheets[t.SheetNames[e]],o=s?function dg(e,r,t,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],o=0;o<i.length;++o){var l=i[o];l.Sheet==t&&(l.Name.match(/^_xlfn\./)||s.push(Ag(l)))}return s.join("")}(s,0,e,t):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=s?function Dk(e,r){if(!e["!ref"])return"";var i=Ct(e["!ref"]),s=e["!merges"]||[],o=0,l=[];e["!cols"]&&e["!cols"].forEach(function(p,d){Tn(p);var w=!!p.width,v=pa(d,p),S={"ss:Index":d+1};w&&(S["ss:Width"]=Si(v.width)),p.hidden&&(S["ss:Hidden"]="1"),l.push(pe("Column",null,S))});for(var g=null!=e["!data"],u={r:0,c:0},h=i.s.r;h<=i.e.r;++h){var A=[xg(h,(e["!rows"]||[])[h])];u.r=h;for(var C=i.s.c;C<=i.e.c;++C){u.c=C;var I=!1;for(o=0;o!=s.length;++o)if(!(s[o].s.c>C||s[o].s.r>h||s[o].e.c<C||s[o].e.r<h)){(s[o].s.c!=C||s[o].s.r!=h)&&(I=!0);break}if(!I){var m=rt(C)+ut(h);A.push(_g(g?(e["!data"][h]||[])[C]:e[m],m,e,r,0,0,u))}}A.push("</Row>"),A.length>2&&l.push(A.join(""))}return l.join("")}(s,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(function mg(e,r,t,n){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(pe("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(pe("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(pe("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[t])if(n.Workbook.Sheets[t].Hidden)i.push(pe("Visible",1==n.Workbook.Sheets[t].Hidden?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<t&&(!n.Workbook.Sheets[s]||n.Workbook.Sheets[s].Hidden);++s);s==t&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(gr("ProtectContents","True")),e["!protect"].objects&&i.push(gr("ProtectObjects","True")),e["!protect"].scenarios&&i.push(gr("ProtectScenarios","True")),null==e["!protect"].selectLockedCells||e["!protect"].selectLockedCells?null!=e["!protect"].selectUnlockedCells&&!e["!protect"].selectUnlockedCells&&i.push(gr("EnableSelection","UnlockedCells")):i.push(gr("EnableSelection","NoSelection")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&i.push("<"+o[1]+"/>")})),0==i.length?"":pe("WorksheetOptions",i.join(""),{xmlns:qt.x})}(s,0,e,t)),s&&s["!autofilter"]&&n.push('<AutoFilter x:Range="'+fa(xi(s["!autofilter"].ref),{r:0,c:0})+'" xmlns="urn:schemas-microsoft-com:office:excel"></AutoFilter>'),n.join("")}var Ok=[60,1084,2066,2165,2175];function Bk(e,r,t,n,i){var s=n,o=[],l=t.slice(t.l,t.l+s);if(i&&i.enc&&i.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:case 133:break;default:i.enc.insitu(l)}o.push(l),t.l+=s;for(var g=vn(t,t.l),u=Bo[g],h=0;null!=u&&Ok.indexOf(g)>-1;)s=vn(t,t.l+2),h=t.l+4,2066==g?h+=4:(2165==g||2175==g)&&(h+=12),l=t.slice(h,t.l+4+s),o.push(l),t.l+=4+s,u=Bo[g=vn(t,t.l)];var A=jt(o);er(A,0);var C=0;A.lens=[];for(var I=0;I<o.length;++I)A.lens.push(C),C+=o[I].length;if(A.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+A.length+" < "+n;return r.f(A,A.length,i)}function un(e,r,t){if("z"!==e.t&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,r.cellNF&&null==e.z&&(e.z=Ve[n])}catch(s){if(r.WTF)throw s}if(!r||!1!==r.cellText)try{e.w="e"===e.t?e.w||rr[e.v]:0===n||"General"==n?"n"===e.t?(0|e.v)===e.v?e.v.toString(10):Xi(e.v):Gn(e.v):Dr(n,e.v,{date1904:!!t,dateNF:r&&r.dateNF})}catch(s){if(r.WTF)throw s}if(r.cellDates&&n&&"n"==e.t&&Mr(Ve[n]||String(n))){var i=on(e.v+(t?1462:0));i&&(e.t="d",e.v=new Date(Date.UTC(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u)))}}}function _s(e,r,t){return{v:e,ixfe:r,t}}var ma={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Oo(e,r){var t,n,i,s;if(r||(r={}),$o(r),Va(),r.codepage&&ja(r.codepage),e.FullPaths){if(We.find(e,"/encryption"))throw new Error("File is password-protected");t=We.find(e,"!CompObj"),n=We.find(e,"/Workbook")||We.find(e,"/Book")}else{switch(r.type){case"base64":e=wr(Br(e));break;case"binary":e=wr(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e))}er(e,0),n={content:e}}if(t&&function Rk(e){var r={},t=e.content;if(t.l=28,r.AnsiUserType=t.read_shift(0,"lpstr-ansi"),r.AnsiClipboardFormat=function xd(e){return Pl(e,1)}(t),t.length-t.l<=4)return r;var n=t.read_shift(4);if(0==n||n>40||(t.l-=4,r.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||1907505652!==(n=t.read_shift(4))||(r.UnicodeClipboardFormat=function vd(e){return Pl(e,2)}(t),0==(n=t.read_shift(4))||n>40))return r;t.l-=4,r.Reserved2=t.read_shift(0,"lpwstr")}(t),r.bookProps&&!r.bookSheets)i={};else{var o=ft?"buffer":"array";if(n&&n.content)i=function Mk(e,r){var t={opts:{}},n={};null!=Gt&&null==r.dense&&(r.dense=Gt);var i={};r.dense&&(i["!data"]=[]);var A,I,m,_,p,v,S,s={},o={},l=null,g=[],u="",h={},C="",d={},w=[],G=[],X=[],E={Sheets:[],WBProps:{date1904:!1},Views:[{}]},O={},L=!1,W=function(Je){return Je<8?qn[Je]:Je<64&&X[Je-8]||qn[Je]},Y=function(Je,ze,vt){if((L||!(re>1))&&!(vt.sheetRows&&Je.r>=vt.sheetRows)){if(vt.cellStyles&&ze.XF&&ze.XF.data&&function(Je,ze){var bt,vt=Je.XF.data;vt&&vt.patternType&&ze&&ze.cellStyles&&(Je.s={},Je.s.patternType=vt.patternType,(bt=oa(W(vt.icvFore)))&&(Je.s.fgColor={rgb:bt}),(bt=oa(W(vt.icvBack)))&&(Je.s.bgColor={rgb:bt}))}(ze,vt),delete ze.ixfe,delete ze.XF,A=Je,C=ht(Je),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),Je.r<o.s.r&&(o.s.r=Je.r),Je.c<o.s.c&&(o.s.c=Je.c),Je.r+1>o.e.r&&(o.e.r=Je.r+1),Je.c+1>o.e.c&&(o.e.c=Je.c+1),vt.cellFormula&&ze.f)for(var bt=0;bt<w.length;++bt)if(!(w[bt][0].s.c>Je.c||w[bt][0].s.r>Je.r||w[bt][0].e.c<Je.c||w[bt][0].e.r<Je.r)){ze.F=ot(w[bt][0]),(w[bt][0].s.c!=Je.c||w[bt][0].s.r!=Je.r)&&delete ze.f,ze.f&&(ze.f=""+xr(w[bt][1],0,Je,ue,ee));break}vt.dense?(i["!data"][Je.r]||(i["!data"][Je.r]=[]),i["!data"][Je.r][Je.c]=ze):i[C]=ze}},ee={enc:!1,sbcch:0,snames:[],sharedf:d,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};r.password&&(ee.password=r.password);var Te,le=[],Pe=[],ce=[],Re=[],Xe=!1,ue=[];ue.SheetNames=ee.snames,ue.sharedf=ee.sharedf,ue.arrayf=ee.arrayf,ue.names=[],ue.XTI=[];var ve,Ke=0,re=0,he=0,Ce=[],Ue=[];ee.codepage=1200,Vr(1200);for(var Ne=!1;e.l<e.length-1;){var D=e.l,z=e.read_shift(2);if(0===z&&10===Ke)break;var j=e.l===e.length?0:e.read_shift(2),U=Bo[z];if(0==re&&-1==[9,521,1033,2057].indexOf(z))break;if(U&&U.f){if(r.bookSheets&&133===Ke&&133!==z)break;if(Ke=z,2===U.r||12==U.r){var ae=e.read_shift(2);if(j-=2,!ee.enc&&ae!==z&&((255&ae)<<8|ae>>8)!==z)throw new Error("rt mismatch: "+ae+"!="+z);12==U.r&&(e.l+=10,j-=10)}var N={};if(N=10===z?U.f(e,j,ee):Bk(z,U,e,j,ee),0==re&&-1===[9,521,1033,2057].indexOf(Ke))continue;switch(z){case 34:t.opts.Date1904=E.WBProps.date1904=N;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(ee.enc||(e.l=0),ee.enc=N,!r.password)throw new Error("File is password-protected");if(null==N.valid)throw new Error("Encryption scheme unsupported");if(!N.valid)throw new Error("Password is incorrect");break;case 92:ee.lastuser=N;break;case 66:var De=Number(N);switch(De){case 21010:De=1200;break;case 32768:De=1e4;break;case 32769:De=1252}Vr(ee.codepage=De),Ne=!0;break;case 317:ee.rrtabid=N;break;case 25:ee.winlocked=N;break;case 439:t.opts.RefreshAll=N;break;case 12:t.opts.CalcCount=N;break;case 16:t.opts.CalcDelta=N;break;case 17:t.opts.CalcIter=N;break;case 13:t.opts.CalcMode=N;break;case 14:t.opts.CalcPrecision=N;break;case 95:t.opts.CalcSaveRecalc=N;break;case 15:ee.CalcRefMode=N;break;case 2211:t.opts.FullCalc=N;break;case 129:N.fDialog&&(i["!type"]="dialog"),N.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),N.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 67:case 579:case 1091:case 224:G.push(N);break;case 430:ue.push([N]),ue[ue.length-1].XTI=[];break;case 35:case 547:ue[ue.length-1].push(N);break;case 24:case 536:ve={Name:N.Name,Ref:xr(N.rgce,0,null,ue,ee)},N.itab>0&&(ve.Sheet=N.itab-1),ue.names.push(ve),ue[0]||(ue[0]=[],ue[0].XTI=[]),ue[ue.length-1].push(N),"_xlnm._FilterDatabase"==N.Name&&N.itab>0&&N.rgce&&N.rgce[0]&&N.rgce[0][0]&&"PtgArea3d"==N.rgce[0][0][0]&&(Ue[N.itab-1]={ref:ot(N.rgce[0][0][1][2])});break;case 22:ee.ExternCount=N;break;case 23:0==ue.length&&(ue[0]=[],ue[0].XTI=[]),ue[ue.length-1].XTI=ue[ue.length-1].XTI.concat(N),ue.XTI=ue.XTI.concat(N);break;case 2196:if(ee.biff<8)break;null!=ve&&(ve.Comment=N[1]);break;case 18:i["!protect"]=N;break;case 19:0!==N&&ee.WTF&&console.error("Password verifier: "+N);break;case 133:s[4==ee.biff?ee.snames.length:N.pos]=N,ee.snames.push(N.name);break;case 10:if(--re?!L:L)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,i["!ref"]=ot(o),r.sheetRows&&r.sheetRows<=o.e.r){var we=o.e.r;o.e.r=r.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=ot(o),o.e.r=we}o.e.r++,o.e.c++}le.length>0&&(i["!merges"]=le),Pe.length>0&&(i["!objects"]=Pe),ce.length>0&&(i["!cols"]=ce),Re.length>0&&(i["!rows"]=Re),E.Sheets.push(O)}""===u?h=i:n[u]=i,i={},r.dense&&(i["!data"]=[]);break;case 9:case 521:case 1033:case 2057:if(8===ee.biff&&(ee.biff={9:2,521:3,1033:4}[z]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[N.BIFFVer]||8),ee.biffguess=0==N.BIFFVer,0==N.BIFFVer&&4096==N.dt&&(ee.biff=5,Ne=!0,Vr(ee.codepage=28591)),4==ee.biff&&256&N.dt&&(L=!0),8==ee.biff&&0==N.BIFFVer&&16==N.dt&&(ee.biff=2),re++&&!L)break;if(i={},r.dense&&(i["!data"]=[]),ee.biff<8&&!Ne&&(Ne=!0,Vr(ee.codepage=r.codepage||1252)),4==ee.biff&&L)u=(s[ee.snames.indexOf(u)+1]||{name:""}).name;else if(ee.biff<5||0==N.BIFFVer&&4096==N.dt){""===u&&(u="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var ge={pos:e.l-j,name:u};s[ge.pos]=ge,ee.snames.push(u)}else u=(s[D]||{name:""}).name;32==N.dt&&(i["!type"]="chart"),64==N.dt&&(i["!type"]="macro"),le=[],Pe=[],ee.arrayf=w=[],ce=[],Re=[],Xe=!1,O={Hidden:(s[D]||{hs:0}).hs,name:u};break;case 515:case 3:case 2:"chart"==i["!type"]&&(r.dense?(i["!data"][N.r]||[])[N.c]:i[rt(N.c)+ut(N.r)])&&++N.c,v={ixfe:N.ixfe,XF:G[N.ixfe]||{},v:N.val,t:"n"},he>0&&(v.z=v.XF&&v.XF.numFmtId&&Ce[v.XF.numFmtId]||Ce[v.ixfe>>8&63]),un(v,r,t.opts.Date1904),Y({c:N.c,r:N.r},v,r);break;case 5:case 517:v={ixfe:N.ixfe,XF:G[N.ixfe],v:N.val,t:N.t},he>0&&(v.z=v.XF&&v.XF.numFmtId&&Ce[v.XF.numFmtId]||Ce[v.ixfe>>8&63]),un(v,r,t.opts.Date1904),Y({c:N.c,r:N.r},v,r);break;case 638:v={ixfe:N.ixfe,XF:G[N.ixfe],v:N.rknum,t:"n"},he>0&&(v.z=v.XF&&v.XF.numFmtId&&Ce[v.XF.numFmtId]||Ce[v.ixfe>>8&63]),un(v,r,t.opts.Date1904),Y({c:N.c,r:N.r},v,r);break;case 189:for(var He=N.c;He<=N.C;++He){var et=N.rkrec[He-N.c][0];v={ixfe:et,XF:G[et],v:N.rkrec[He-N.c][1],t:"n"},he>0&&(v.z=v.XF&&v.XF.numFmtId&&Ce[v.XF.numFmtId]||Ce[v.ixfe>>8&63]),un(v,r,t.opts.Date1904),Y({c:He,r:N.r},v,r)}break;case 6:case 518:case 1030:if("String"==N.val){l=N;break}if((v=_s(N.val,N.cell.ixfe,N.tt)).XF=G[v.ixfe],r.cellFormula){var Ee=N.formula;if(Ee&&Ee[0]&&Ee[0][0]&&"PtgExp"==Ee[0][0][0]){var mt=Ee[0][0][1][0],_t=Ee[0][0][1][1],Dt=ht({r:mt,c:_t});d[Dt]?v.f=""+xr(N.formula,0,N.cell,ue,ee):v.F=((r.dense?(i["!data"][mt]||[])[_t]:i[Dt])||{}).F}else v.f=""+xr(N.formula,0,N.cell,ue,ee)}he>0&&(v.z=v.XF&&v.XF.numFmtId&&Ce[v.XF.numFmtId]||Ce[v.ixfe>>8&63]),un(v,r,t.opts.Date1904),Y(N.cell,v,r),l=N;break;case 7:case 519:if(!l)throw new Error("String record expects Formula");l.val=N,(v=_s(N,l.cell.ixfe,"s")).XF=G[v.ixfe],r.cellFormula&&(v.f=""+xr(l.formula,0,l.cell,ue,ee)),he>0&&(v.z=v.XF&&v.XF.numFmtId&&Ce[v.XF.numFmtId]||Ce[v.ixfe>>8&63]),un(v,r,t.opts.Date1904),Y(l.cell,v,r),l=null;break;case 33:case 545:w.push(N);var Lt=ht(N[0].s);if(I=r.dense?(i["!data"][N[0].s.r]||[])[N[0].s.c]:i[Lt],r.cellFormula&&I){if(!l||!Lt||!I)break;I.f=""+xr(N[1],0,N[0],ue,ee),I.F=ot(N[0])}break;case 1212:if(!r.cellFormula)break;if(C){if(!l)break;d[ht(l.cell)]=N[0],((I=r.dense?(i["!data"][l.cell.r]||[])[l.cell.c]:i[ht(l.cell)])||{}).f=""+xr(N[0],0,A,ue,ee)}break;case 253:v=_s(g[N.isst].t,N.ixfe,"s"),g[N.isst].h&&(v.h=g[N.isst].h),v.XF=G[v.ixfe],he>0&&(v.z=v.XF&&v.XF.numFmtId&&Ce[v.XF.numFmtId]||Ce[v.ixfe>>8&63]),un(v,r,t.opts.Date1904),Y({c:N.c,r:N.r},v,r);break;case 513:r.sheetStubs&&(v={ixfe:N.ixfe,XF:G[N.ixfe],t:"z"},he>0&&(v.z=v.XF&&v.XF.numFmtId&&Ce[v.XF.numFmtId]||Ce[v.ixfe>>8&63]),un(v,r,t.opts.Date1904),Y({c:N.c,r:N.r},v,r));break;case 190:if(r.sheetStubs)for(var de=N.c;de<=N.C;++de){var xe=N.ixfe[de-N.c];v={ixfe:xe,XF:G[xe],t:"z"},he>0&&(v.z=v.XF&&v.XF.numFmtId&&Ce[v.XF.numFmtId]||Ce[v.ixfe>>8&63]),un(v,r,t.opts.Date1904),Y({c:de,r:N.r},v,r)}break;case 214:case 516:case 4:(v=_s(N.val,N.ixfe,"s")).XF=G[v.ixfe],he>0&&(v.z=v.XF&&v.XF.numFmtId&&Ce[v.XF.numFmtId]||Ce[v.ixfe>>8&63]),un(v,r,t.opts.Date1904),Y({c:N.c,r:N.r},v,r);break;case 0:case 512:1===re&&(o=N);break;case 252:g=N;break;case 1054:if(ee.biff>=3&&ee.biff<=4){Ce[he++]=N[1];for(var fr=0;fr<he+163&&Ve[fr]!=N[1];++fr);fr>=163&&Nn(N[1],he+163)}else Nn(N[1],N[0]);break;case 30:Ce[he++]=N;for(var Wt=0;Wt<he+163&&Ve[Wt]!=N;++Wt);Wt>=163&&Nn(N,he+163);break;case 229:le=le.concat(N);break;case 93:Pe[N.cmo[0]]=ee.lastobj=N;break;case 438:ee.lastobj.TxO=N;break;case 127:ee.lastobj.ImData=N;break;case 440:for(p=N[0].s.r;p<=N[0].e.r;++p)for(_=N[0].s.c;_<=N[0].e.c;++_)(I=r.dense?(i["!data"][p]||[])[_]:i[ht({c:_,r:p})])&&(I.l=N[1]);break;case 2048:for(p=N[0].s.r;p<=N[0].e.r;++p)for(_=N[0].s.c;_<=N[0].e.c;++_)(I=r.dense?(i["!data"][p]||[])[_]:i[ht({c:_,r:p})])&&I.l&&(I.l.Tooltip=N[1]);break;case 28:(I=r.dense?(i["!data"][N[0].r]||[])[N[0].c]:i[ht(N[0])])||(r.dense?(i["!data"][N[0].r]||(i["!data"][N[0].r]=[]),I=i["!data"][N[0].r][N[0].c]={t:"z"}):I=i[ht(N[0])]={t:"z"},o.e.r=Math.max(o.e.r,N[0].r),o.s.r=Math.min(o.s.r,N[0].r),o.e.c=Math.max(o.e.c,N[0].c),o.s.c=Math.min(o.s.c,N[0].c)),I.c||(I.c=[]),ee.biff<=5&&ee.biff>=2?m={a:"SheetJ5",t:N[1]}:(m={a:N[1],t:Pe[N[2]].TxO.t},null!=N[3]&&!(2&N[3])&&(I.c.hidden=!0)),I.c.push(m);break;case 2173:yx(0,N.ext);break;case 125:if(!ee.cellStyles)break;for(;N.e>=N.s;)ce[N.e--]={width:N.w/256,level:N.level||0,hidden:!!(1&N.flags)},Xe||(Xe=!0,vo(N.w/256)),Tn(ce[N.e+1]);break;case 520:var Jt={};null!=N.level&&(Re[N.r]=Jt,Jt.level=N.level),N.hidden&&(Re[N.r]=Jt,Jt.hidden=!0),N.hpt&&(Re[N.r]=Jt,Jt.hpt=N.hpt,Jt.hpx=bi(N.hpt));break;case 38:case 39:case 40:case 41:i["!margins"]||si(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[z]]=N;break;case 161:i["!margins"]||si(i["!margins"]={}),i["!margins"].header=N.header,i["!margins"].footer=N.footer;break;case 574:N.RTL&&(E.Views[0].RTL=!0);break;case 146:X=N;break;case 2198:Te=N;break;case 140:S=N;break;case 442:u?O.CodeName=N||O.name:E.WBProps.CodeName=N||"ThisWorkbook"}}else U||console.error("Missing Info for XLS Record 0x"+z.toString(16)),e.l+=j}return t.SheetNames=Ft(s).sort(function(lr,Je){return Number(lr)-Number(Je)}).map(function(lr){return s[lr].name}),r.bookSheets||(t.Sheets=n),!t.SheetNames.length&&h["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=h)):t.Preamble=h,t.Sheets&&Ue.forEach(function(lr,Je){t.Sheets[t.SheetNames[Je]]["!autofilter"]=lr}),t.Strings=g,t.SSF=xt(Ve),ee.enc&&(t.Encryption=ee.enc),Te&&(t.Themes=Te),t.Metadata={},void 0!==S&&(t.Metadata.Country=S),ue.names.length>0&&(E.Names=ue.names),t.Workbook=E,t}(n.content,r);else if((s=We.find(e,"PerfectOffice_MAIN"))&&s.content)i=ii.to_workbook(s.content,(r.type=o,r));else{if(!(s=We.find(e,"NativeContent_MAIN"))||!s.content)throw(s=We.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");i=ii.to_workbook(s.content,(r.type=o,r))}r.bookVBA&&e.FullPaths&&We.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=function e2(e){var r=We.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,n){if("/"!==t.slice(-1)&&t.match(/_VBA_PROJECT_CUR/)){var i=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");We.utils.cfb_add(r,i,e.FileIndex[n].content)}}),We.write(r)}(e))}var l={};return e.FullPaths&&function Lk(e,r,t){var n=We.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=ql(n,ao,ma.DSI);for(var s in i)r[s]=i[s]}catch(u){if(t.WTF)throw u}var o=We.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var l=ql(o,so,ma.SI);for(var g in l)null==r[g]&&(r[g]=l[g])}catch(u){if(t.WTF)throw u}r.HeadingPairs&&r.TitlesOfParts&&($l(r.HeadingPairs,r.TitlesOfParts,r,t),delete r.HeadingPairs,delete r.TitlesOfParts)}(e,l,r),i.Props=i.Custprops=l,r.bookFiles&&(i.cfb=e),i}var _a={0:{f:function x4(e,r){var t={},n=e.l+r;t.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,7&s&&(t.level=7&s),16&s&&(t.hidden=!0),32&s&&(t.hpt=i/20),t}},1:{f:function E4(e){return[zr(e)]}},2:{f:function z4(e){return[zr(e),rs(e),"n"]}},3:{f:function M4(e){return[zr(e),e.read_shift(1),"e"]}},4:{f:function P4(e){return[zr(e),e.read_shift(1),"b"]}},5:{f:function $4(e){return[zr(e),pr(e),"n"]}},6:{f:function Z4(e){return[zr(e),Ar(e),"str"]}},7:{f:function U4(e){return[zr(e),e.read_shift(4),"s"]}},8:{f:function a3(e,r,t){var n=e.l+r,i=zr(e);i.r=t["!row"];var o=[i,Ar(e),"str"];if(t.cellFormula){e.l+=2;var l=ms(e,n-e.l,t);o[3]=xr(l,0,i,t.supbooks,t)}else e.l=n;return o}},9:{f:function n3(e,r,t){var n=e.l+r,i=zr(e);i.r=t["!row"];var o=[i,pr(e),"n"];if(t.cellFormula){e.l+=2;var l=ms(e,n-e.l,t);o[3]=xr(l,0,i,t.supbooks,t)}else e.l=n;return o}},10:{f:function t3(e,r,t){var n=e.l+r,i=zr(e);i.r=t["!row"];var o=[i,e.read_shift(1),"b"];if(t.cellFormula){e.l+=2;var l=ms(e,n-e.l,t);o[3]=xr(l,0,i,t.supbooks,t)}else e.l=n;return o}},11:{f:function r3(e,r,t){var n=e.l+r,i=zr(e);i.r=t["!row"];var o=[i,e.read_shift(1),"e"];if(t.cellFormula){e.l+=2;var l=ms(e,n-e.l,t);o[3]=xr(l,0,i,t.supbooks,t)}else e.l=n;return o}},12:{f:function D4(e){return[Jn(e)]}},13:{f:function Y4(e){return[Jn(e),rs(e),"n"]}},14:{f:function L4(e){return[Jn(e),e.read_shift(1),"e"]}},15:{f:function O4(e){return[Jn(e),e.read_shift(1),"b"]}},16:{f:ig},17:{f:function q4(e){return[Jn(e),Ar(e),"str"]}},18:{f:function j4(e){return[Jn(e),e.read_shift(4),"s"]}},19:{f:to},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function ek(e,r,t){var n=e.l+r,i=e.read_shift(4);e.l+=1;var l,s=e.read_shift(4),o=Ad(e),g="";try{l=Fv(e,0,t);try{g=ts(e)}catch{}}catch{console.error("Could not parse defined name "+o)}32&i&&(o="_xlnm."+o),e.l=n;var u={Name:o,Ptg:l,Flags:i};return s<268435455&&(u.Sheet=s),g&&(u.Comment=g),u}},40:{},42:{},43:{f:function J_(e,r,t){var n={};n.sz=e.read_shift(2)/20;var i=function md(e){var r=e.read_shift(1);return e.l++,{fBold:1&r,fItalic:2&r,fUnderline:4&r,fStrikeout:8&r,fOutline:16&r,fShadow:32&r,fCondense:64&r,fExtend:128&r}}(e);switch(i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1),700===e.read_shift(2)&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript"}var o=e.read_shift(1);0!=o&&(n.underline=o);var l=e.read_shift(1);l>0&&(n.family=l);var g=e.read_shift(1);switch(g>0&&(n.charset=g),e.l++,n.color=function dd(e){var r={},n=e.read_shift(1)>>>1,i=e.read_shift(1),s=e.read_shift(2,"i"),o=e.read_shift(1),l=e.read_shift(1),g=e.read_shift(1);switch(e.l++,n){case 0:r.auto=1;break;case 1:r.index=i;var u=qn[i];u&&(r.rgb=oa(u));break;case 2:r.rgb=oa([o,l,g]);break;case 3:r.theme=i}return 0!=s&&(r.tint=s>0?s/32767:s/32768),r}(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor"}return n.name=Ar(e),n}},44:{f:function H_(e,r){return[e.read_shift(2),Ar(e)]}},45:{f:Q_},46:{f:ex},47:{f:function q_(e,r){var t=e.l+r,n=e.read_shift(2),i=e.read_shift(2);return e.l=t,{ixfe:n,numFmtId:i}}},48:{},49:{f:function cd(e){return e.read_shift(4,"i")}},50:{},51:{f:function bx(e){for(var r=[],t=e.read_shift(4);t-- >0;)r.push([e.read_shift(4),e.read_shift(4)]);return r}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:vc},62:{f:function K4(e){return[zr(e),to(e),"is"]}},63:{f:function Lx(e){var r={};r.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),r.r=ht(t);var n=e.read_shift(1);return 2&n&&(r.l="1"),8&n&&(r.a="1"),r}},64:{f:function x3(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Cr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function p3(e){var r=e.read_shift(2);return e.l+=28,{RTL:32&r}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function S4(e,r){var t={},n=e[e.l];return++e.l,t.above=!(64&n),t.left=!(128&n),e.l+=18,t.name=Id(e,r-19),t}},148:{f:w4,p:16},151:{f:function f3(){}},152:{},153:{f:function Z3(e,r){var t={},n=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var i=r>8?Ar(e):"";return i.length>0&&(t.CodeName=i),t.autoCompressPictures=!!(65536&n),t.backupFile=!!(64&n),t.checkCompatibility=!!(4096&n),t.date1904=!!(1&n),t.filterPrivacy=!!(8&n),t.hidePivotFieldList=!!(1024&n),t.promptedSolutions=!!(16&n),t.publishItems=!!(2048&n),t.refreshAllConnections=!!(262144&n),t.saveExternalLinkValues=!!(128&n),t.showBorderUnselectedTables=!!(4&n),t.showInkAnnotation=!!(32&n),t.showObjects=["all","placeholders","none"][n>>13&3],t.showPivotChartFilter=!!(32768&n),t.updateLinks=["userSet","never","always"][n>>8&3],t}},154:{},155:{},156:{f:function J3(e,r){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=ro(e,r-8),t.name=Ar(e),t}},157:{},158:{},159:{T:1,f:function s_(e){return[e.read_shift(4),e.read_shift(4)]}},160:{T:-1},161:{T:1,f:Zn},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:s3},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function Tx(e,r){return{flags:e.read_shift(4),version:e.read_shift(4),name:Ar(e)}}},336:{T:-1},337:{f:function Dx(e){return e.l+=4,0!=e.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:ro},357:{},358:{},359:{},360:{T:1},361:{},362:{f:mc},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function u3(e,r,t){var n=e.l+r,i=Nl(e),s=e.read_shift(1),o=[i];if(o[2]=s,t.cellFormula){var l=Ev(e,n-e.l,t);o[1]=l}else e.l=n;return o}},427:{f:function h3(e,r,t){var n=e.l+r,s=[Zn(e,16)];if(t.cellFormula){var o=Dv(e,n-e.l,t);s[1]=o,e.l=n}else e.l=n;return s}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function I3(e){var r={};return ag.forEach(function(t){r[t]=pr(e)}),r}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function T4(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function c3(e,r){var t=e.l+r,n=Zn(e,16),i=ts(e),s=Ar(e),o=Ar(e),l=Ar(e);e.l=t;var g={rfx:n,relId:i,loc:s,display:l};return o&&(g.Tooltip=o),g}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:ro},551:{f:ts},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Kx},633:{T:1},634:{T:-1},635:{T:1,f:function Yx(e){var r={};r.iauthor=e.read_shift(4);var t=Zn(e,16);return r.rfx=t.s,r.ref=ht(t.s),e.l+=16,r}},636:{T:-1},637:{f:hd},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function L3(e,r){return e.l+=10,{name:Ar(e)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function v3(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Bo={6:{f:To},10:{f:Rn},12:{f:Mt},13:{f:Mt},14:{f:Vt},15:{f:Vt},16:{f:pr},17:{f:Vt},18:{f:Vt},19:{f:Mt},20:{f:Ac},21:{f:Ac},23:{f:mc},24:{f:dc},25:{f:Vt},26:{},27:{},28:{f:function Cm(e,r,t){if(t&&t.biff<8){var n=e.read_shift(2),i=e.read_shift(2);if(65535==n||-1==n)return;var s=e.read_shift(2);return[{r:n,c:i},e.read_shift(Math.min(s,2048),"cpstr")]}return function hm(e,r,t){var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2);return[{r:n,c:i},ri(e,0,t),o,s]}(e,0,t)}},29:{},34:{f:Vt},35:{f:pc},38:{f:pr},39:{f:pr},40:{f:pr},41:{f:pr},42:{f:Vt},43:{f:Vt},47:{f:function S_(e,r,t){var n={Type:t.biff>=8?e.read_shift(2):0};return n.Type?function T_(e,r,t){var n=t||{};return n.Info=e.read_shift(2),e.l-=2,n.Data=1===n.Info?function v_(e){var r={},t=r.EncryptionVersionInfo=yn(e,4);if(1!=t.Major||1!=t.Minor)throw"unrecognized version code "+t.Major+" : "+t.Minor;return r.Salt=e.read_shift(16),r.EncryptedVerifier=e.read_shift(16),r.EncryptedVerifierHash=e.read_shift(16),r}(e):function x_(e,r){var t={},n=t.EncryptionVersionInfo=yn(e,4);if(r-=4,2!=n.Minor)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);t.Flags=e.read_shift(4),r-=4;var i=e.read_shift(4);return r-=4,t.EncryptionHeader=Sc(e,i),t.EncryptionVerifier=bc(e,r-=i),t}(e,r),n}(e,r-2,n):function y_(e,r,t,n){var i={key:Mt(e),verificationBytes:Mt(e)};t.password&&(i.verifier=_o(t.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=function(e){var r=0,t=Ec(e);return function(n){var i=function(e,r,t,n,i){var s,o;for(i||(i=r),n||(n=Ec("")),s=0;s!=r.length;++s)o=r[s],i[s]=o=255&((o^=n[t])>>5|o<<3),++t;return[i,t,n]}(0,n,r,t);return r=i[1],i[0]}}(t.password))}(e,0,t,n),n}},49:{f:function B1(e,r,t){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10}return n.name=yi(e,0,t),n}},51:{f:Mt},60:{},61:{f:function D1(e){return{Pos:[e.read_shift(2),e.read_shift(2)],Dim:[e.read_shift(2),e.read_shift(2)],Flags:e.read_shift(2),CurTab:e.read_shift(2),FirstTab:e.read_shift(2),Selected:e.read_shift(2),TabRatio:e.read_shift(2)}}},64:{f:Vt},65:{f:function O1(){}},66:{f:Mt},77:{},80:{},81:{},82:{},85:{f:Mt},89:{},90:{},91:{},92:{f:function _1(e,r,t){if(t.enc)return e.l+=r,"";var n=e.l,i=ri(e,0,t);return e.read_shift(r+n-e.l),i}},93:{f:function pm(e,r,t){if(t&&t.biff<8)return function mm(e,r,t){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6;var o=[];return o.push((dm[n]||Cr)(e,r-=36,t)),{cmo:[i,n,s],ft:o}}(e,r,t);var n=fc(e),i=function d1(e,r){for(var t=e.l+r,n=[];e.l<t;){var i=e.read_shift(2);e.l-=2;try{n[i]=p1[i](e,t-e.l)}catch{return e.l=t,n}}return e.l!=t&&(e.l=t),n}(e,r-22);return{cmo:n,ft:i}}},94:{},95:{f:Vt},96:{},97:{},99:{f:Vt},125:{f:vc},128:{f:function im(e){e.l+=4;var r=[e.read_shift(2),e.read_shift(2)];if(0!==r[0]&&r[0]--,0!==r[1]&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}},129:{f:function v1(e,r,t){var n=t&&8==t.biff||2==r?e.read_shift(2):(e.l+=r,0);return{fDialog:16&n,fBelow:64&n,fRight:128&n}}},130:{f:Mt},131:{f:Vt},132:{f:Vt},133:{f:function k1(e,r,t){var n="";if(4==t.biff)return 0===(n=yi(e,0,t)).length&&(n="Sheet1"),{name:n};var i=e.read_shift(4),s=3&e.read_shift(1),o=e.read_shift(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule"}return 0===(n=yi(e,0,t)).length&&(n="Sheet1"),{pos:i,hs:s,dt:o,name:n}}},134:{},140:{f:function ym(e){var t,r=[0,0];return t=e.read_shift(2),r[0]=Bl[t]||t,t=e.read_shift(2),r[1]=Bl[t]||t,r}},141:{f:Mt},144:{},146:{f:function bm(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(oc(e));return t}},151:{},152:{},153:{},154:{},155:{},156:{f:Mt},157:{},158:{},160:{f:Om},161:{f:function Dm(e,r){var t={};return r<32||(e.l+=16,t.header=pr(e),t.footer=pr(e),e.l+=2),t}},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:function J1(e,r){for(var t=e.l+r-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<t;)s.push(lc(e));if(e.l!==t)throw new Error("MulRK read error");var o=e.read_shift(2);if(s.length!=o-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:o,rkrec:s}}},190:{f:function K1(e,r){for(var t=e.l+r-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<t;)s.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var o=e.read_shift(2);if(s.length!=o-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:o,ixfe:s}}},193:{f:Rn},197:{},198:{},199:{},200:{},201:{},202:{f:Vt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Mt},220:{},221:{f:Vt},222:{},224:{f:function Q1(e,r,t){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,n.data=function Z1(e,r,t,n){var i={},s=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(4),g=e.read_shift(2);return i.patternType=bd[l>>26],n.cellStyles&&(i.alc=7&s,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=15&o,i.dgRight=o>>4&15,i.dgTop=o>>8&15,i.dgBottom=o>>12&15,i.icvLeft=o>>16&127,i.icvRight=o>>23&127,i.grbitDiag=o>>30&3,i.icvTop=127&l,i.icvBottom=l>>7&127,i.icvDiag=l>>14&127,i.dgDiag=l>>21&15,i.icvFore=127&g,i.icvBack=g>>7&127,i.fsxButton=g>>14&1),i}(e,0,0,t),n}},225:{f:function m1(e,r){return 0===r||e.read_shift(2),1200}},226:{f:Rn},227:{},229:{f:function Im(e,r){for(var t=[],n=e.read_shift(2);n--;)t.push(gs(e));return t}},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:function y1(e,r){for(var t=e.l+r,n=e.read_shift(4),i=e.read_shift(4),s=[],o=0;o!=i&&e.l<t;++o)s.push(t1(e));return s.Count=n,s.Unique=i,s}},253:{f:function L1(e,r,t){var n=Qr(e,r,t);return n.isst=e.read_shift(4),n}},255:{f:function S1(e,r){var t={};return t.dsst=e.read_shift(2),e.l+=r-2,t}},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:tc},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Vt},353:{f:Rn},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:function cm(e,r,t){var n=e.l+r,i=e.read_shift(2),s=e.read_shift(2);if(t.sbcch=s,1025==s||14849==s)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var o=ti(e,s),l=[];n>e.l;)l.push(aa(e));return[s,i,o,l]}},431:{f:Vt},432:{},433:{},434:{},437:{},438:{f:function _m(e,r,t){var n=e.l,i="";try{e.l+=4,-1==[0,5,7,11,12,14].indexOf((t.lastobj||{cmo:[0,0]}).cmo[1])?e.l+=6:function n1(e){var r=e.read_shift(1);e.l++;var t=e.read_shift(2);e.l+=2}(e);var l=e.read_shift(2);e.read_shift(2),Mt(e);var g=e.read_shift(2);e.l+=g;for(var u=1;u<e.lens.length-1;++u){if(e.l-n!=e.lens[u])throw new Error("TxO: bad continue record");var h=e[e.l];if((i+=ti(e,e.lens[u+1]-e.lens[u]-1)).length>=(h?l:2*l))break}if(i.length!==l&&i.length!==2*l)throw new Error("cchText: "+l+" != "+i.length);return e.l=n+r,{t:i}}catch{return e.l=n+r,{t:i}}}},439:{f:Vt},440:{f:function xm(e,r){var t=gs(e);e.l+=16;var n=function l1(e,r){var t=e.l+r,n=e.read_shift(4);if(2!==n)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var s,o,l,g,h,A,u="";16&i&&(s=cs(e)),128&i&&(o=cs(e)),!(257&~i)&&(l=cs(e)),1==(257&i)&&(g=function o1(e,r){var t=e.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return function a1(e){var r=e.read_shift(4),t=e.l,n=!1;r>24&&(e.l+=r-24,"795881f43b1d7f48af2c825dc4852763"===e.read_shift(16)&&(n=!0),e.l=t);var i=e.read_shift((n?r-24:r)>>1,"utf16le").replace(yr,"");return n&&(e.l+=24),i}(e);case"0303000000000000c000000000000046":return function s1(e){for(var r=e.read_shift(2),t="";r-- >0;)t+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,57005!=e.read_shift(2))throw new Error("Bad FileMoniker");if(0===e.read_shift(4))return t+n.replace(/\\/g,"/");var s=e.read_shift(4);if(3!=e.read_shift(2))throw new Error("Bad FileMoniker");return t+e.read_shift(s>>1,"utf16le").replace(yr,"")}(e);default:throw new Error("Unsupported Moniker "+t)}}(e)),8&i&&(u=cs(e)),32&i&&(h=e.read_shift(16)),64&i&&(A=ho(e)),e.l=t;var C=o||l||g||"";C&&u&&(C+="#"+u),C||(C="#"+u),2&i&&"/"==C.charAt(0)&&"/"!=C.charAt(1)&&(C="file://"+C);var I={Target:C};return h&&(I.guid=h),A&&(I.time=A),s&&(I.Tooltip=s),I}(e,r-24);return[t,n]}},441:{},442:{f:aa},443:{},444:{f:Mt},445:{},446:{},448:{f:Rn},449:{f:function F1(e){return e.read_shift(2),e.read_shift(4)},r:2},450:{f:Rn},512:{f:hc},513:{f:Rm},515:{f:function om(e,r,t){t.biffguess&&2==t.biff&&(t.biff=5);var n=Qr(e,6,t),i=pr(e);return n.val=i,n}},516:{f:function G1(e,r,t){t.biffguess&&2==t.biff&&(t.biff=5);var i=Qr(e,r,t),s=aa(e,0,t);return i.val=s,i}},517:{f:function sm(e,r,t){var n=Qr(e,6,t),i=rc(e);return n.val=i,n.t=!0===i||!1===i?"b":"e",n}},519:{f:Bm},520:{f:function b1(e){var r={};r.r=e.read_shift(2),r.c=e.read_shift(2),r.cnt=e.read_shift(2)-r.c;var t=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,7&n&&(r.level=7&n),32&n&&(r.hidden=!0),64&n&&(r.hpt=t/20),r}},523:{},545:{f:xc},549:{f:uc},566:{},574:{f:function P1(e,r,t){return t&&t.biff>=2&&t.biff<5?{}:{RTL:64&e.read_shift(2)}}},638:{f:function Y1(e){var r=e.read_shift(2),t=e.read_shift(2),n=lc(e);return{r,c:t,ixfe:n[0],rknum:n[1]}}},659:{},1048:{},1054:{f:function V1(e,r,t){return[e.read_shift(2),ri(e,0,t)]}},1084:{},1212:{f:function fm(e,r,t){var n=gc(e);e.l++;var i=e.read_shift(1);return[yv(e,r-=8,t),i,n]}},2048:{f:function km(e,r){e.read_shift(2);var t=gs(e),n=e.read_shift((r-10)/2,"dbcs-cont");return[t,n=n.replace(yr,"")]}},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:fs},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Rn},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:function Em(e){e.l+=2;var r={cxfs:0,crc:0};return r.cxfs=e.read_shift(2),r.crc=e.read_shift(4),r},r:12},2173:{f:function wx(e,r){e.l+=2;var n=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),s=[];i-- >0;)s.push(kx(e));return{ixfe:n,ext:s}},r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Vt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:function gm(e,r,t){if(!(t.biff<8)){var n=e.read_shift(2),i=e.read_shift(2);return[ti(e,n,t),ti(e,i,t)]}e.l+=r},r:12},2197:{},2198:{f:function dx(e,r,t){var n=e.l+r;if(124226!==e.read_shift(4)){if(!t.cellStyles)return void(e.l=n);var o,s=e.slice(e.l);e.l=n;try{o=tl(s,{type:"array"})}catch{return}var l=Sr(o,"theme/theme/theme1.xml",!0);if(l)return Rc(l,t)}},r:12},2199:{},2200:{},2201:{},2202:{f:function um(e){return[0!==e.read_shift(4),0!==e.read_shift(4),e.read_shift(4)]},r:12},2203:{f:Rn},2204:{},2205:{},2206:{},2207:{},2211:{f:function E1(e){var r=function g1(e){var r=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:r,flags:t}}(e);if(2211!=r.type)throw new Error("Invalid Future Record "+r.type);return 0!==e.read_shift(4)}},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Mt},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:function Nm(e,r,t){var n={area:!1};if(5!=t.biff)return e.l+=r,n;var i=e.read_shift(1);return e.l+=3,16&i&&(n.area=!0),n}},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:function Sm(e){for(var r=e.read_shift(2),t=[];r-- >0;)t.push(oc(e));return t}},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:hc},1:{},2:{f:function jm(e,r,t){var n=Qr(e,7,t),i=e.read_shift(2);return n.t="n",n.val=i,n}},3:{f:function Um(e,r,t){var n=Qr(e,7,t),i=pr(e);return n.t="n",n.val=i,n}},4:{f:function Lm(e,r,t){t.biffguess&&5==t.biff&&(t.biff=2);var n=Qr(e,7,t),i=ri(e,0,t);return n.t="str",n.val=i,n}},5:{f:function Wm(e,r,t){var n=e.l+7,i=Qr(e,6,t);e.l=n;var s=rc(e);return i.val=s,i.t=!0===s||!1===s?"b":"e",i}},7:{f:function $m(e){var r=e.read_shift(1);return 0===r?(e.l++,""):e.read_shift(r,"sbcs-cont")}},8:{},9:{f:fs},11:{},22:{f:Mt},30:{f:W1},31:{},32:{},33:{f:xc},36:{},37:{f:uc},50:{f:function Xm(e,r){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=r-13}},62:{},52:{},67:{f:function q1(e){var r={};return r.ifnt=e.read_shift(1),e.l++,r.flags=e.read_shift(1),r.numFmtId=63&r.flags,r.flags>>=6,r.fStyle=0,r.data={},r}},68:{f:Mt},69:{},86:{},126:{},127:{f:function Mm(e){var r=e.read_shift(2),t=e.read_shift(2),n=e.read_shift(4),i={fmt:r,env:t,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}},135:{},136:{},137:{},143:{f:function Hm(e){var r=e.read_shift(4),t=e.read_shift(1),n=e.read_shift(t,"sbcs");return 0===n.length&&(n="Sheet1"),{flags:r,name:n}}},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:function zm(e,r,t){var n=e.l+r,i=Qr(e,6,t),s=e.read_shift(2),o=ti(e,s,t);return e.l=n,i.t="str",i.val=o,i}},223:{},234:{},354:{},421:{},518:{f:To},521:{f:fs},536:{f:dc},547:{f:pc},561:{},579:{f:function rm(e){var r={};return r.ifnt=e.read_shift(1),r.numFmtId=e.read_shift(1),r.flags=e.read_shift(2),r.fStyle=r.flags>>2&1,r.data={},r}},1030:{f:To},1033:{f:fs},1091:{f:function nm(e){var r={};return r.ifnt=e.read_shift(1),r.numFmtId=e.read_shift(1),r.flags=e.read_shift(2),r.fStyle=r.flags>>2&1,r.data={},r}},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},101:{},102:{},105:{},106:{},107:{},109:{},112:{},114:{},29282:{}};function fe(e,r,t,n){var i=r;if(!isNaN(i)){var s=n||(t||[]).length||0,o=e.next(4);o.write_shift(2,i),o.write_shift(2,s),s>0&&Zs(t)&&e.push(t)}}function Mo(e,r,t,n){var i=J(9);return sa(i,e,r),nc(t,n||"b",i),i}function vg(e,r){r.forEach(function(t){var n=t[0].map(function(s){return s.t}).join("");if(n.length<=2048)return fe(e,28,Ao(n,t[1],t[2]));fe(e,28,Ao(n.slice(0,2048),t[1],t[2],n.length));for(var i=2048;i<n.length;i+=2048)fe(e,28,Ao(n.slice(i,Math.min(i+2048,n.length)),-1,-1,Math.min(2048,n.length-i)))})}function $k(e,r,t,n,i,s){var o=0;null!=r.z&&-1==(o=i._BIFF2FmtTable.indexOf(r.z))&&(i._BIFF2FmtTable.push(r.z),o=i._BIFF2FmtTable.length-1);var l=0;if(null!=r.z){for(;l<i.cellXfs.length&&i.cellXfs[l].numFmtId!=o;++l);l==i.cellXfs.length&&i.cellXfs.push({numFmtId:o})}if(null!=r.v)switch(r.t){case"d":case"n":var g="d"==r.t?Ot(Pt(r.v,s),s):r.v;return void(2==i.biff&&g==(0|g)&&g>=0&&g<65536?fe(e,2,function Vm(e,r,t,n,i){var s=J(9);return sa(s,e,r,n||0,i||0),s.write_shift(2,t),s}(t,n,g,l,o)):isNaN(g)?fe(e,5,Mo(t,n,36,"e")):isFinite(g)?fe(e,3,function Gm(e,r,t,n,i){var s=J(15);return sa(s,e,r,n||0,i||0),s.write_shift(8,t,"f"),s}(t,n,g,l,o)):fe(e,5,Mo(t,n,7,"e")));case"b":case"e":return void fe(e,5,Mo(t,n,r.v,r.t));case"s":case"str":return void fe(e,4,function Vk(e,r,t){var n=J(8+2*t.length);return sa(n,e,r),n.write_shift(1,t.length),n.write_shift(t.length,t,"sbcs"),n.l<n.length?n.slice(0,n.l):n}(t,n,null==r.v?"":String(r.v).slice(0,255)))}fe(e,1,sa(null,t,n))}var en=1,Yr=[];function ew(e,r,t,n,i,s){var o=16+fn(i.cellXfs,r,i);if(null!=r.v||r.bf)if(r.bf)fe(e,6,function bv(e,r,t,n,i){var s=ni(r,t,i),o=function Sv(e){if(null==e){var r=J(8);return r.write_shift(1,3),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,65535),r}return Qn("number"==typeof e?e:0)}(e.v),l=J(6);l.write_shift(2,33),l.write_shift(4,0);for(var u=J(e.bf.length),h=0;h<e.bf.length;++h)u[h]=e.bf[h];return jt([s,o,l,u])}(r,t,n,0,o));else switch(r.t){case"d":case"n":var l="d"==r.t?Ot(Pt(r.v,s),s):r.v;isNaN(l)?fe(e,517,Io(t,n,36,o,0,"e")):isFinite(l)?fe(e,515,function lm(e,r,t,n){var i=J(14);return ni(e,r,n,i),Qn(t,i),i}(t,n,l,o)):fe(e,517,Io(t,n,7,o,0,"e"));break;case"b":case"e":fe(e,517,Io(t,n,r.v,o,0,r.t));break;case"s":case"str":i.bookSST?fe(e,253,function U1(e,r,t,n){var i=J(10);return ni(e,r,n,i),i.write_shift(4,t),i}(t,n,bo(i.Strings,null==r.v?"":String(r.v),i.revStrings),o)):fe(e,516,function j1(e,r,t,n,i){var s=!i||8==i.biff,o=J(+s+8+(1+s)*t.length);return ni(e,r,n,o),o.write_shift(2,t.length),s&&o.write_shift(1,1),o.write_shift((1+s)*t.length,t,s?"utf16le":"sbcs"),o}(t,n,(null==r.v?"":String(r.v)).slice(0,255),o,i));break;default:fe(e,513,ni(t,n,o))}else fe(e,513,ni(t,n,o))}function tw(e,r,t){var n=Ir(),i=t.SheetNames[e],s=t.Sheets[i]||{},o=(t||{}).Workbook||{},l=(o.Sheets||[])[e]||{},g=null!=s["!data"],u=8==r.biff,A="",C=[],I=Ct(s["!ref"]||"A1"),m=u?65536:16384;if(I.e.c>255||I.e.r>=m){if(r.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV"+m);I.e.c=Math.min(I.e.c,255),I.e.r=Math.min(I.e.r,m-1)}fe(n,2057,Co(0,16,r)),fe(n,13,Hr(1)),fe(n,12,Hr(100)),fe(n,15,dr(!0)),fe(n,17,dr(!1)),fe(n,16,Qn(.001)),fe(n,95,dr(!0)),fe(n,42,dr(!1)),fe(n,43,dr(!1)),fe(n,130,Hr(1)),fe(n,128,function am(e){var r=J(8);return r.write_shift(4,0),r.write_shift(2,e[0]?e[0]+1:0),r.write_shift(2,e[1]?e[1]+1:0),r}([0,0])),fe(n,131,dr(!1)),fe(n,132,dr(!1)),u&&function qk(e,r){if(r){var t=0;r.forEach(function(n,i){++t<=256&&n&&fe(e,125,function Fm(e,r){var t=J(12);t.write_shift(2,r),t.write_shift(2,r),t.write_shift(2,256*e.width),t.write_shift(2,0);var n=0;return e.hidden&&(n|=1),t.write_shift(1,n),t.write_shift(1,n=e.level||0),t.write_shift(2,0),t}(pa(i,n),i))})}}(n,s["!cols"]),fe(n,512,function H1(e,r){var t=8!=r.biff&&r.biff?2:4,n=J(2*t+6);return n.write_shift(t,e.s.r),n.write_shift(t,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}(I,r));var _=(((t||{}).Workbook||{}).WBProps||{}).date1904;u&&(s["!links"]=[]);for(var p=I.s.c;p<=I.e.c;++p)C[p]=rt(p);for(var d=[],w=[],v=I.s.r;v<=I.e.r;++v)for(g&&(w=s["!data"][v]||[]),A=ut(v),p=I.s.c;p<=I.e.c;++p){var S=g?w[p]:s[C[p]+A];S&&(ew(n,S,v,p,r,_),u&&S.l&&s["!links"].push([C[p]+A,S.l]),S.c&&d.push([S.c,v,p]))}var G=l.CodeName||l.name||i;return u?function Hk(e,r){var o,t=[],n=0,i=Ir(),s=en;r.forEach(function(g,u){var h="",A=g[0].map(function(v){return v.a&&!h&&(h=v.a),v.t}).join("");++en;var C=J(150);C.write_shift(2,15),C.write_shift(2,61444),C.write_shift(4,150),C.write_shift(2,3234),C.write_shift(2,61450),C.write_shift(4,8),C.write_shift(4,en),C.write_shift(4,2560),C.write_shift(2,227),C.write_shift(2,61451),C.write_shift(4,84),C.write_shift(2,128),C.write_shift(4,0),C.write_shift(2,139),C.write_shift(4,2),C.write_shift(2,191),C.write_shift(4,524296),C.write_shift(2,344),C.l+=4,C.write_shift(2,385),C.write_shift(4,134217808),C.write_shift(2,387),C.write_shift(4,134217808),C.write_shift(2,389),C.write_shift(4,268435700),C.write_shift(2,447),C.write_shift(4,1048592),C.write_shift(2,448),C.write_shift(4,134217809),C.write_shift(2,451),C.write_shift(4,268435700),C.write_shift(2,513),C.write_shift(4,134217809),C.write_shift(2,515),C.write_shift(4,268435700),C.write_shift(2,575),C.write_shift(4,196609),C.write_shift(2,959),C.write_shift(4,131072|(g[0].hidden?2:0)),C.l+=2,C.write_shift(2,61456),C.write_shift(4,18),C.write_shift(2,3),C.write_shift(2,g[2]+2),C.l+=2,C.write_shift(2,g[1]+1),C.l+=2,C.write_shift(2,g[2]+4),C.l+=2,C.write_shift(2,g[1]+5),C.l+=2,C.l+=2,C.write_shift(2,61457),C.l+=4,C.l=150,0==u?o=C:fe(i,236,C),n+=150;var I=J(52);I.write_shift(2,21),I.write_shift(2,18),I.write_shift(2,25),I.write_shift(2,en),I.write_shift(2,0),I.l=22,I.write_shift(2,13),I.write_shift(2,22),I.write_shift(4,1651663474),I.write_shift(4,2503426821),I.write_shift(4,2150634280),I.write_shift(4,1768515844+256*en),I.write_shift(2,0),I.write_shift(4,0),I.l+=4,fe(i,93,I);var m=J(8);m.l+=2,m.write_shift(2,61453),m.l+=4,fe(i,236,m),n+=8;var _=J(18);_.write_shift(2,18),_.l+=8,_.write_shift(2,A.length),_.write_shift(2,16),_.l+=4,fe(i,438,_);var p=J(1+A.length);p.write_shift(1,0),p.write_shift(A.length,A,"sbcs"),fe(i,60,p);var d=J(16);d.l+=8,d.write_shift(2,A.length),d.l+=6,fe(i,60,d);var w=J(12+h.length);w.write_shift(2,g[1]),w.write_shift(2,g[2]),w.write_shift(2,0|(g[0].hidden?0:2)),w.write_shift(2,en),w.write_shift(2,h.length),w.write_shift(1,0),w.write_shift(h.length,h,"sbcs"),w.l++,t.push(w)});var l=J(80);l.write_shift(2,15),l.write_shift(2,61442),l.write_shift(4,n+l.length-8),l.write_shift(2,16),l.write_shift(2,61448),l.write_shift(4,8),l.write_shift(4,r.length+1),l.write_shift(4,en),l.write_shift(2,15),l.write_shift(2,61443),l.write_shift(4,n+48),l.write_shift(2,15),l.write_shift(2,61444),l.write_shift(4,40),l.write_shift(2,1),l.write_shift(2,61449),l.write_shift(4,16),l.l+=16,l.write_shift(2,2),l.write_shift(2,61450),l.write_shift(4,8),l.write_shift(4,s),l.write_shift(4,5),fe(e,236,o?jt([l,o]):l),e.push(i.end()),t.forEach(function(g){fe(e,28,g)}),Yr.push([s,r.length+1,en]),++en}(n,d):vg(n,d),u&&fe(n,574,function R1(e){var r=J(18),t=1718;return e&&e.RTL&&(t|=64),r.write_shift(2,t),r.write_shift(4,0),r.write_shift(4,64),r.write_shift(4,0),r.write_shift(4,0),r}((o.Views||[])[0])),u&&(s["!merges"]||[]).length&&fe(n,229,function Am(e){var r=J(2+8*e.length);r.write_shift(2,e.length);for(var t=0;t<e.length;++t)cc(e[t],r);return r}(s["!merges"])),u&&function Qk(e,r){for(var t=0;t<r["!links"].length;++t){var n=r["!links"][t];fe(e,440,vm(n)),n[1].Tooltip&&fe(e,2048,wm(n))}delete r["!links"]}(n,s),fe(n,442,ic(G)),u&&function Kk(e,r){var t=J(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),fe(e,2151,t),(t=J(39)).write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),cc(Ct(r["!ref"]||"A1"),t),t.write_shift(4,4),fe(e,2152,t)}(n,s),fe(n,10),n.end()}function rw(e,r,t){var n=Ir(),i=(e||{}).Workbook||{},s=i.Sheets||[],o=i.WBProps||{},l=8==t.biff,g=5==t.biff;fe(n,2057,Co(0,5,t)),"xla"==t.bookType&&fe(n,135),fe(n,225,l?Hr(1200):null),fe(n,193,function qd(e,r){r||(r=J(e));for(var t=0;t<e;++t)r.write_shift(1,0);return r}(2)),g&&fe(n,191),g&&fe(n,192),fe(n,226),fe(n,92,function x1(e,r){var t=!r||8==r.biff,n=J(t?112:54);for(n.write_shift(8==r.biff?2:1,7),t&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(t?0:536870912));n.l<n.length;)n.write_shift(1,t?0:32);return n}(0,t)),fe(n,66,Hr(l?1200:1252)),l&&fe(n,353,Hr(0)),l&&fe(n,448),fe(n,317,function Pm(e){for(var r=J(2*e),t=0;t<e;++t)r.write_shift(2,t+1);return r}(e.SheetNames.length)),l&&e.vbaraw&&fe(n,211),l&&e.vbaraw&&fe(n,442,ic(o.CodeName||"ThisWorkbook")),fe(n,156,Hr(17)),fe(n,25,dr(!1)),fe(n,18,dr(!1)),fe(n,19,Hr(0)),l&&fe(n,431,dr(!1)),l&&fe(n,444,Hr(0)),fe(n,61,function N1(){var e=J(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}()),fe(n,64,dr(!1)),fe(n,141,Hr(0)),fe(n,34,dr("true"==function $3(e){return e.Workbook&&e.Workbook.WBProps&&kt(e.Workbook.WBProps.date1904)?"true":"false"}(e))),fe(n,14,dr(!0)),l&&fe(n,439,dr(!1)),fe(n,218,Hr(0)),function Yk(e,r,t){fe(e,49,function M1(e,r){var t=e.name||"Arial",n=r&&5==r.biff,s=J(n?15+t.length:16+2*t.length);return s.write_shift(2,20*(e.sz||12)),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,t.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le"),s}({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},t))}(n,0,t),function Jk(e,r,t){r&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)null!=r[i]&&fe(e,1054,$1(i,r[i],t))})}(n,e.SSF,t),function Zk(e,r){for(var t=0;t<16;++t)fe(e,224,Cc({numFmtId:0,style:!0},0,r));r.cellXfs.forEach(function(n){fe(e,224,Cc(n,0,r))})}(n,t),l&&fe(n,352,dr(!1));var h=n.end(),A=Ir();l&&fe(A,140,function Tm(e){return e||(e=J(4)),e.write_shift(2,1),e.write_shift(2,1),e}()),l&&Yr.length&&fe(A,235,function zk(){var e=J(82+8*Yr.length);e.write_shift(2,15),e.write_shift(2,61440),e.write_shift(4,74+8*Yr.length),e.write_shift(2,0),e.write_shift(2,61446),e.write_shift(4,16+8*Yr.length),e.write_shift(4,en),e.write_shift(4,Yr.length+1);for(var r=0,t=0;t<Yr.length;++t)r+=Yr[t]&&Yr[t][1]||0;return e.write_shift(4,r),e.write_shift(4,Yr.length),Yr.forEach(function(n){e.write_shift(4,n[0]),e.write_shift(4,n[2])}),e.write_shift(2,51),e.write_shift(2,61451),e.write_shift(4,18),e.write_shift(2,191),e.write_shift(4,524296),e.write_shift(2,385),e.write_shift(4,134217793),e.write_shift(2,448),e.write_shift(4,134217792),e.write_shift(2,64),e.write_shift(2,61726),e.write_shift(4,16),e.write_shift(4,134217741),e.write_shift(4,134217740),e.write_shift(4,134217751),e.write_shift(4,268435703),e}()),l&&t.Strings&&function jk(e,r,t,n){var i=n||(t||[]).length||0;if(i<=8224)return fe(e,r,t,i);var s=r;if(!isNaN(s)){for(var o=t.parts||[],l=0,g=0,u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;var h=e.next(4);for(h.write_shift(2,s),h.write_shift(2,u),e.push(t.slice(g,g+u)),g+=u;g<i;){for((h=e.next(4)).write_shift(2,60),u=0;u+(o[l]||8224)<=8224;)u+=o[l]||8224,l++;h.write_shift(2,u),e.push(t.slice(g,g+u)),g+=u}}}(A,252,function T1(e){var t=J(8);t.write_shift(4,e.Count),t.write_shift(4,e.Unique);for(var n=[],i=0;i<e.length;++i)n[i]=r1(e[i]);var s=jt([t].concat(n));return s.parts=[t.length].concat(n.map(function(o){return o.length})),s}(t.Strings)),fe(A,10);var C=A.end(),I=Ir(),m=0,_=0;for(_=0;_<e.SheetNames.length;++_)m+=(l?12:11)+(l?2:1)*e.SheetNames[_].length;var p=h.length+m+C.length;for(_=0;_<e.SheetNames.length;++_)fe(I,133,w1({pos:p,hs:(s[_]||{}).Hidden||0,dt:0,name:e.SheetNames[_]},t)),p+=r[_].length;var w=I.end();if(m!=w.length)throw new Error("BS8 "+m+" != "+w.length);var v=[];return h.length&&v.push(h),w.length&&v.push(w),C.length&&v.push(C),jt(v)}function kg(e,r){for(var t=0;t<=e.SheetNames.length;++t){var n=e.Sheets[e.SheetNames[t]];if(n&&n["!ref"]){var i=Ht(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost."),i.e.r>65535&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[t]+"' extends beyond row 65536.  Data may be lost.")}}var s=r||{};switch(s.biff||2){case 8:case 5:return function nw(e,r){var t=r||{},n=[];e&&!e.SSF&&(e.SSF=xt(Ve)),e&&e.SSF&&(jn(),pi(e.SSF),t.revssf=Hi(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),en=1,Yr=[],t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Wo(t),t.cellXfs=[],fn(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)n[n.length]=tw(i,t,e);return n.unshift(rw(e,n,t)),jt(n)}(e,r);case 4:case 3:case 2:return function Xk(e,r){for(var t=r||{},n=Ir(),i=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==t.sheet&&(i=s);if(0==i&&t.sheet&&e.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);fe(n,4==t.biff?1033:3==t.biff?521:9,Co(0,16,t)),((e.Workbook||{}).WBProps||{}).date1904&&fe(n,34,dr(!0)),t.cellXfs=[{numFmtId:0}],t._BIFF2FmtTable=["General"],t._Fonts=[];var o=Ir();return function Wk(e,r,t,n,i){var s=null!=r["!data"],o=Ct(r["!ref"]||"A1"),l="",g=[];if(o.e.c>255||o.e.r>16383){if(n.WTF)throw new Error("Range "+(r["!ref"]||"A1")+" exceeds format limit A1:IV16384");o.e.c=Math.min(o.e.c,255),o.e.r=Math.min(o.e.r,16383)}for(var u=(((i||{}).Workbook||{}).WBProps||{}).date1904,h=[],A=[],C=o.s.c;C<=o.e.c;++C)g[C]=rt(C);for(var I=o.s.r;I<=o.e.r;++I)for(s&&(h=r["!data"][I]||[]),l=ut(I),C=o.s.c;C<=o.e.c;++C){var m=s?h[C]:r[g[C]+l];m&&($k(e,m,I,C,n,u),m.c&&A.push([m.c,I,C]))}vg(e,A)}(o,e.Sheets[e.SheetNames[i]],0,t,e),t._BIFF2FmtTable.forEach(function(l){t.biff<=3?fe(n,30,function X1(e){var r=J(1+e.length);return r.write_shift(1,e.length),r.write_shift(e.length,e,"sbcs"),r}(l)):fe(n,1054,function z1(e){var r=J(3+e.length);return r.l+=2,r.write_shift(1,e.length),r.write_shift(e.length,e,"sbcs"),r}(l))}),t.cellXfs.forEach(function(l){switch(t.biff){case 2:fe(n,67,function em(e){var r=J(4);return r.l+=2,r.write_shift(1,e.numFmtId),r.l++,r}(l));break;case 3:fe(n,579,Ic(l));break;case 4:fe(n,1091,tm(l))}}),delete t._BIFF2FmtTable,delete t.cellXfs,delete t._Fonts,n.push(o.end()),fe(n,10),n.end()}(e,r)}throw new Error("invalid type "+s.bookType+" for BIFF")}function wg(e,r){var t=r||{},n=null!=t.dense?t.dense:Gt,i={};n&&(i["!data"]=[]);var s=(e=Ji(e,"\x3c!--","--\x3e")).match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var o=e.match(/<\/table/i),l=s.index,g=o&&o.index||e.length,u=Rp(e.slice(l,g),/(:?<tr[^<>]*>)/i,"<tr>"),h=-1,A=0,C=0,I=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},_=[];for(l=0;l<u.length;++l){var p=u[l].trim(),d=p.slice(0,3).toLowerCase();if("<tr"!=d){if("<td"==d||"<th"==d){var w=p.split(/<\/t[dh]>/i);for(g=0;g<w.length;++g){var v=w[g].trim();if(v.match(/<t[dh]/i)){for(var S=v,G=0;"<"==S.charAt(0)&&(G=S.indexOf(">"))>-1;)S=S.slice(G+1);for(var X=0;X<_.length;++X){var E=_[X];E.s.c==A&&E.s.r<h&&h<=E.e.r&&(A=E.e.c+1,X=-1)}var O=Me(v.slice(0,v.indexOf(">")));I=O.colspan?+O.colspan:1,((C=+O.rowspan)>1||I>1)&&_.push({s:{r:h,c:A},e:{r:h+(C||1)-1,c:A+I-1}});var L=O.t||O["data-t"]||"";if(!S.length){A+=I;continue}if(S=gl(S),m.s.r>h&&(m.s.r=h),m.e.r<h&&(m.e.r=h),m.s.c>A&&(m.s.c=A),m.e.c<A&&(m.e.c=A),!S.length){A+=I;continue}var W={t:"s",v:S};t.raw||!S.trim().length||"s"==L||("TRUE"===S?W={t:"b",v:!0}:"FALSE"===S?W={t:"b",v:!1}:isNaN(Lr(S))?isNaN(Yi(S).getDate())?35==S.charCodeAt(0)&&null!=or[S]&&(W.t="e",W.w=S,W.v=or[S]):(W={t:"d",v:Pt(S)},!1===t.UTC&&(W.v=$n(W.v)),t.cellDates||(W={t:"n",v:Ot(W.v)}),W.z=t.dateNF||Ve[14]):W={t:"n",v:Lr(S)}),!1!==W.cellText&&(W.w=S),n?(i["!data"][h]||(i["!data"][h]=[]),i["!data"][h][A]=W):i[ht({r:h,c:A})]=W,A+=I}}}}else{if(++h,t.sheetRows&&t.sheetRows<=h){--h;break}A=0}}return i["!ref"]=ot(m),_.length&&(i["!merges"]=_),i}function yg(e,r,t,n){for(var i=e["!merges"]||[],s=[],o={},l=null!=e["!data"],g=r.s.c;g<=r.e.c;++g){for(var u=0,h=0,A=0;A<i.length;++A)if(!(i[A].s.r>t||i[A].s.c>g||i[A].e.r<t||i[A].e.c<g)){if(i[A].s.r<t||i[A].s.c<g){u=-1;break}u=i[A].e.r-i[A].s.r+1,h=i[A].e.c-i[A].s.c+1;break}if(!(u<0)){var C=rt(g)+ut(t),I=l?(e["!data"][t]||[])[g]:e[C];I&&"n"==I.t&&null!=I.v&&!isFinite(I.v)&&(I=isNaN(I.v)?{t:"e",v:36,w:rr[36]}:{t:"e",v:7,w:rr[7]});var m=I&&null!=I.v&&(I.h||Ki(I.w||(gn(I),I.w)||""))||"";o={},u>1&&(o.rowspan=u),h>1&&(o.colspan=h),n.editable?m='<span contenteditable="true">'+m+"</span>":I&&(o["data-t"]=I&&I.t||"z",null!=I.v&&(o["data-v"]=Ki(I.v instanceof Date?I.v.toISOString():I.v)),null!=I.z&&(o["data-z"]=I.z),I.l&&"#"!=(I.l.Target||"#").charAt(0)&&(m='<a href="'+Ki(I.l.Target)+'">'+m+"</a>")),o.id=(n.id||"sjs")+"-"+C,s.push(pe("td",m,o))}}return"<tr>"+s.join("")+"</tr>"}var Tg='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Sg="</body></html>";function Eg(e,r){var t=r||{},i=null!=t.footer?t.footer:Sg,s=[null!=t.header?t.header:Tg],o=Ht(e["!ref"]||"A1");if(s.push(function bg(e,r,t){return[].join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}(0,0,t)),e["!ref"])for(var l=o.s.r;l<=o.e.r;++l)s.push(yg(e,o,l,t));return s.push("</table>"+i),s.join("")}function Fg(e,r,t){var n=r.rows;if(!n)throw"Unsupported origin when "+r.tagName+" is not a TABLE";var i=t||{},s=null!=e["!data"],o=0,l=0;if(null!=i.origin)if("number"==typeof i.origin)o=i.origin;else{var g="string"==typeof i.origin?Tt(i.origin):i.origin;o=g.r,l=g.c}var u=Math.min(i.sheetRows||1e7,n.length),h={s:{r:0,c:0},e:{r:o,c:l}};if(e["!ref"]){var A=Ht(e["!ref"]);h.s.r=Math.min(h.s.r,A.s.r),h.s.c=Math.min(h.s.c,A.s.c),h.e.r=Math.max(h.e.r,A.e.r),h.e.c=Math.max(h.e.c,A.e.c),-1==o&&(h.e.r=o=A.e.r+1)}var C=[],I=0,m=e["!rows"]||(e["!rows"]=[]),_=0,p=0,d=0,w=0,v=0,S=0;for(e["!cols"]||(e["!cols"]=[]);_<n.length&&p<u;++_){var G=n[_];if(Ng(G)){if(i.display)continue;m[p]={hidden:!0}}var X=G.cells;for(d=w=0;d<X.length;++d){var E=X[d];if(!i.display||!Ng(E)){var O=E.hasAttribute("data-v")?E.getAttribute("data-v"):E.hasAttribute("v")?E.getAttribute("v"):gl(E.innerHTML),L=E.getAttribute("data-z")||E.getAttribute("z");for(I=0;I<C.length;++I){var W=C[I];W.s.c==w+l&&W.s.r<p+o&&p+o<=W.e.r&&(w=W.e.c+1-l,I=-1)}S=+E.getAttribute("colspan")||1,((v=+E.getAttribute("rowspan")||1)>1||S>1)&&C.push({s:{r:p+o,c:w+l},e:{r:p+o+(v||1)-1,c:w+l+(S||1)-1}});var H={t:"s",v:O},Y=E.getAttribute("data-t")||E.getAttribute("t")||"";null!=O&&(0==O.length?H.t=Y||"z":i.raw||0==O.trim().length||"s"==Y||("e"==Y&&rr[+O]?H={t:"e",v:+O,w:rr[+O]}:"TRUE"===O?H={t:"b",v:!0}:"FALSE"===O?H={t:"b",v:!1}:isNaN(Lr(O))?isNaN(Yi(O).getDate())?35==O.charCodeAt(0)&&null!=or[O]&&(H={t:"e",v:or[O],w:O}):(H={t:"d",v:Pt(O)},i.UTC&&(H.v=Ka(H.v)),i.cellDates||(H={t:"n",v:Ot(H.v)}),H.z=i.dateNF||Ve[14]):H={t:"n",v:Lr(O)})),void 0===H.z&&null!=L&&(H.z=L);var ee="",Te=E.getElementsByTagName("A");if(Te&&Te.length)for(var le=0;le<Te.length&&(!Te[le].hasAttribute("href")||"#"==(ee=Te[le].getAttribute("href")).charAt(0));++le);ee&&"#"!=ee.charAt(0)&&"javascript:"!=ee.slice(0,11).toLowerCase()&&(H.l={Target:ee}),s?(e["!data"][p+o]||(e["!data"][p+o]=[]),e["!data"][p+o][w+l]=H):e[ht({c:w+l,r:p+o})]=H,h.e.c<w+l&&(h.e.c=w+l),w+=S}}++p}return C.length&&(e["!merges"]=(e["!merges"]||[]).concat(C)),h.e.r=Math.max(h.e.r,p-1+o),e["!ref"]=ot(h),p>=u&&(e["!fullref"]=ot((h.e.r=n.length-_+p-1+o,h))),e}function Dg(e,r){var n={};return(r||{}).dense&&(n["!data"]=[]),Fg(n,e,r)}function Ng(e){var r="",t=function sw(e){return e.ownerDocument.defaultView&&"function"==typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"==typeof getComputedStyle?getComputedStyle:null}(e);return t&&(r=t(e).getPropertyValue("display")),r||(r=e.style&&e.style.display),"none"===r}function ow(e){var r=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^<>]*\/>/g,"\t").replace(/<text:line-break\/>/g,"\n");return[pt(r.replace(/<[^<>]*>/g,""))]}function Pg(e,r,t){var n=t||{},i=Qa(e);zt.lastIndex=0,i=Ls(Ji(i,"\x3c!--","--\x3e"));for(var s,o,u,l="",g="",h=0,A=-1,I="";s=zt.exec(i);)switch(s[3]=s[3].replace(/_[\s\S]*$/,"")){case"number-style":case"currency-style":case"percentage-style":case"date-style":case"time-style":case"text-style":"/"===s[1]?("false"==o["truncate-on-overflow"]&&(l.match(/h/)?l=l.replace(/h+/,"[$&]"):l.match(/m/)?l=l.replace(/m+/,"[$&]"):l.match(/s/)&&(l=l.replace(/s+/,"[$&]"))),n[o.name]=l,l=""):"/"!==s[0].charAt(s[0].length-2)&&(l="",o=Me(s[0],!1));break;case"boolean-style":"/"===s[1]?(n[o.name]="General",l=""):"/"!==s[0].charAt(s[0].length-2)&&(l="",o=Me(s[0],!1));break;case"boolean":l+="General";break;case"text":"/"===s[1]?l+="%"==(I=i.slice(A,zt.lastIndex-s[0].length))&&"<number:percentage-style"==o[0]?"%":'"'+I.replace(/"/g,'""')+'"':"/"!==s[0].charAt(s[0].length-2)&&(A=zt.lastIndex);break;case"day":"short"===(u=Me(s[0],!1)).style?l+="d":l+="dd";break;case"day-of-week":switch((u=Me(s[0],!1)).style){case"short":default:l+="ddd";break;case"long":l+="dddd"}break;case"era":"short"===(u=Me(s[0],!1)).style?l+="ee":l+="eeee";break;case"hours":"short"===(u=Me(s[0],!1)).style?l+="h":l+="hh";break;case"minutes":"short"===(u=Me(s[0],!1)).style?l+="m":l+="mm";break;case"month":switch((u=Me(s[0],!1)).textual&&(l+="mm"),u.style){case"short":default:l+="m";break;case"long":l+="mm"}break;case"seconds":"short"===(u=Me(s[0],!1)).style?l+="s":l+="ss",u["decimal-places"]&&(l+="."+dt("0",+u["decimal-places"]));break;case"year":switch((u=Me(s[0],!1)).style){case"short":default:l+="yy";break;case"long":l+="yyyy"}break;case"am-pm":l+="AM/PM";break;case"week-of-year":case"quarter":console.error("Excel does not support ODS format token "+s[3]);break;case"fill-character":"/"===s[1]?l+='"'+(I=i.slice(A,zt.lastIndex-s[0].length)).replace(/"/g,'""')+'"*':"/"!==s[0].charAt(s[0].length-2)&&(A=zt.lastIndex);break;case"scientific-number":l+="0."+dt("0",+(u=Me(s[0],!1))["min-decimal-places"]||+u["decimal-places"]||2)+dt("?",+u["decimal-places"]-+u["min-decimal-places"]||0)+"E"+(kt(u["forced-exponent-sign"])?"+":"")+dt("0",+u["min-exponent-digits"]||2);break;case"fraction":l+=+(u=Me(s[0],!1))["min-integer-digits"]?dt("0",+u["min-integer-digits"]):"#",l+=" ",l+=dt("?",+u["min-numerator-digits"]||1),l+="/",l+=+u["denominator-value"]?u["denominator-value"]:dt("?",+u["min-denominator-digits"]||1);break;case"currency-symbol":"/"===s[1]?l+='"'+i.slice(A,zt.lastIndex-s[0].length).replace(/"/g,'""')+'"':"/"!==s[0].charAt(s[0].length-2)?A=zt.lastIndex:l+="$";break;case"text-properties":switch(((u=Me(s[0],!1)).color||"").toLowerCase().replace("#","")){case"ff0000":case"red":l="[Red]"+l}break;case"text-content":l+="@";break;case"map":u=Me(s[0],!1),"value()>=0"==pt(u.condition)?l=n[u["apply-style-name"]]+";"+l:console.error("ODS number format may be incorrect: "+u.condition);break;case"number":if("/"===s[1])break;g="",g+=dt("0",+(u=Me(s[0],!1))["min-integer-digits"]||1),kt(u.grouping)&&(g=dn(dt("#",Math.max(0,4-g.length))+g)),(+u["min-decimal-places"]||+u["decimal-places"])&&(g+="."),+u["min-decimal-places"]&&(g+=dt("0",+u["min-decimal-places"]||1)),+u["decimal-places"]-(+u["min-decimal-places"]||0)&&(g+=dt("0",+u["decimal-places"]-(+u["min-decimal-places"]||0))),l+=g;break;case"embedded-text":"/"===s[1]?0==h?l+='"'+i.slice(A,zt.lastIndex-s[0].length).replace(/"/g,'""')+'"':l=l.slice(0,h)+'"'+i.slice(A,zt.lastIndex-s[0].length).replace(/"/g,'""')+'"'+l.slice(h):"/"!==s[0].charAt(s[0].length-2)&&(A=zt.lastIndex,h=-+Me(s[0],!1).position||0)}return n}function Rg(e,r,t){var n=r||{};null!=Gt&&null==n.dense&&(n.dense=Gt);var o,l,g,A,C,i=Qa(e),s=[],h=0,I={},m=[],_={};n.dense&&(_["!data"]=[]);var p,d,w={value:""},v={},S="",G=0,E="",O=0,L=[],W=[],H=-1,Y=-1,ee={s:{r:1e6,c:1e7},e:{r:0,c:0}},Te=0,le=t||{},Pe={},ce=[],Re={},Xe=0,ue=0,Ke=[],re=1,he=1,Ce=[],Ue={Names:[],WBProps:{}},ve={},Ne=["",""],D=[],z={},j="",U=0,ae=!1,N=!1,De=0;for(zt.lastIndex=0,i=Ls(Ji(i,"\x3c!--","--\x3e"));p=zt.exec(i);)switch(p[3]=p[3].replace(/_[\s\S]*$/,"")){case"table":case"\u5de5\u4f5c\u8868":"/"===p[1]?(_["!ref"]=ee.e.c>=ee.s.c&&ee.e.r>=ee.s.r?ot(ee):"A1:A1",n.sheetRows>0&&n.sheetRows<=ee.e.r&&(_["!fullref"]=_["!ref"],ee.e.r=n.sheetRows-1,_["!ref"]=ot(ee)),ce.length&&(_["!merges"]=ce),Ke.length&&(_["!rows"]=Ke),A.name=A.\u540d\u79f0||A.name,typeof JSON<"u"&&JSON.stringify(A),m.push(A.name),I[A.name]=_,N=!1):"/"!==p[0].charAt(p[0].length-2)&&(A=Me(p[0],!1),H=Y=-1,ee.s.r=ee.s.c=1e7,ee.e.r=ee.e.c=0,_={},n.dense&&(_["!data"]=[]),ce=[],Ke=[],N=!0);break;case"table-row-group":"/"===p[1]?--Te:++Te;break;case"table-row":case"\u884c":if("/"===p[1]){H+=re,re=1;break}if((C=Me(p[0],!1)).\u884c\u53f7?H=C.\u884c\u53f7-1:-1==H&&(H=0),(re=+C["number-rows-repeated"]||1)<10)for(De=0;De<re;++De)Te>0&&(Ke[H+De]={level:Te});Y=-1;break;case"covered-table-cell":if("/"!==p[1])if(++Y,w=Me(p[0],!1),he=parseInt(w["number-columns-repeated"]||"1",10)||1,n.sheetStubs){for(;he-- >0;)n.dense?(_["!data"][H]||(_["!data"][H]=[]),_["!data"][H][Y]={t:"z"}):_[ht({r:H,c:Y})]={t:"z"},++Y;--Y}else Y+=he-1;S="",L=[];break;case"table-cell":case"\u6570\u636e":if("/"===p[0].charAt(p[0].length-2))++Y,w=Me(p[0],!1),he=parseInt(w["number-columns-repeated"]||"1",10)||1,d={t:"z",v:null},w.formula&&0!=n.cellFormula&&(d.f=eg(pt(w.formula))),w["style-name"]&&Pe[w["style-name"]]&&(d.z=Pe[w["style-name"]]),"string"==(w.\u6570\u636e\u7c7b\u578b||w["value-type"])&&(d.t="s",d.v=pt(w["string-value"]||""),n.dense?(_["!data"][H]||(_["!data"][H]=[]),_["!data"][H][Y]=d):_[rt(Y)+ut(H)]=d),Y+=he-1;else if("/"!==p[1]){S=E="",G=O=0,L=[],W=[],he=1;var we=re?H+re-1:H;if(++Y>ee.e.c&&(ee.e.c=Y),Y<ee.s.c&&(ee.s.c=Y),H<ee.s.r&&(ee.s.r=H),we>ee.e.r&&(ee.e.r=we),w=Me(p[0],!1),v=Vp(p[0],!0),D=[],z={},d={t:w.\u6570\u636e\u7c7b\u578b||w["value-type"],v:null},w["style-name"]&&Pe[w["style-name"]]&&(d.z=Pe[w["style-name"]]),n.cellFormula)if(w.formula&&(w.formula=pt(w.formula)),w["number-matrix-columns-spanned"]&&w["number-matrix-rows-spanned"]&&(Xe=parseInt(w["number-matrix-rows-spanned"],10)||0,ue=parseInt(w["number-matrix-columns-spanned"],10)||0,d.F=ot(Re={s:{r:H,c:Y},e:{r:H+Xe-1,c:Y+ue-1}}),Ce.push([Re,d.F])),w.formula)d.f=eg(w.formula);else for(De=0;De<Ce.length;++De)H>=Ce[De][0].s.r&&H<=Ce[De][0].e.r&&Y>=Ce[De][0].s.c&&Y<=Ce[De][0].e.c&&(d.F=Ce[De][1]);switch((w["number-columns-spanned"]||w["number-rows-spanned"])&&(Xe=parseInt(w["number-rows-spanned"]||"1",10)||1)*(ue=parseInt(w["number-columns-spanned"]||"1",10)||1)>1&&ce.push(Re={s:{r:H,c:Y},e:{r:H+Xe-1,c:Y+ue-1}}),w["number-columns-repeated"]&&(he=parseInt(w["number-columns-repeated"],10)),d.t){case"boolean":d.t="b",d.v=kt(w["boolean-value"])||+w["boolean-value"]>=1;break;case"float":d.t="n",d.v=parseFloat(w.value),n.cellDates&&d.z&&Mr(d.z)&&(d.v=xn(d.v+(Ue.WBProps.date1904?1462:0)),d.t="number"==typeof d.v?"n":"d");break;case"percentage":case"currency":d.t="n",d.v=parseFloat(w.value);break;case"date":d.t="d",d.v=Pt(w["date-value"],Ue.WBProps.date1904),n.cellDates||(d.t="n",d.v=Ot(d.v,Ue.WBProps.date1904)),d.z||(d.z="m/d/yy");break;case"time":d.t="n",d.v=wp(w["time-value"])/86400,n.cellDates&&(d.v=xn(d.v),d.t="number"==typeof d.v?"n":"d"),d.z||(d.z="HH:MM:SS");break;case"number":d.t="n",d.v=parseFloat(w.\u6570\u636e\u6570\u503c);break;default:if("string"!==d.t&&"text"!==d.t&&d.t)throw new Error("Unsupported value type "+d.t);d.t="s",null!=w["string-value"]&&(S=pt(w["string-value"]),L=[])}}else{if(ae=!1,"error"==v["calcext:value-type"]&&null!=or[S]&&(d.t="e",d.w=S,d.v=or[S]),"s"===d.t&&(d.v=S||"",L.length&&(d.R=L),ae=0==G),ve.Target&&(d.l=ve),D.length>0&&(d.c=D,D=[]),S&&!1!==n.cellText&&(d.w=S),ae&&(d.t="z",delete d.v),(!ae||n.sheetStubs)&&!(n.sheetRows&&n.sheetRows<=H))for(var ge=0;ge<re;++ge){if(he=parseInt(w["number-columns-repeated"]||"1",10),n.dense)for(_["!data"][H+ge]||(_["!data"][H+ge]=[]),_["!data"][H+ge][Y]=0==ge?d:xt(d);--he>0;)_["!data"][H+ge][Y+he]=xt(d);else for(_[ht({r:H+ge,c:Y})]=d;--he>0;)_[ht({r:H+ge,c:Y+he})]=xt(d);ee.e.c<=Y&&(ee.e.c=Y)}Y+=(he=parseInt(w["number-columns-repeated"]||"1",10))-1,he=0,d={},S="",L=[]}ve={};break;case"document":case"document-content":case"\u7535\u5b50\u8868\u683c\u6587\u6863":case"spreadsheet":case"\u4e3b\u4f53":case"scripts":case"styles":case"font-face-decls":case"master-styles":if("/"===p[1]){if((o=s.pop())[0]!==p[3])throw"Bad state: "+o}else"/"!==p[0].charAt(p[0].length-2)&&s.push([p[3],!0]);break;case"annotation":if("/"===p[1]){if((o=s.pop())[0]!==p[3])throw"Bad state: "+o;z.t=S,L.length&&(z.R=L),z.a=j,D.push(z),S=E,G=O,L=W}else if("/"!==p[0].charAt(p[0].length-2)){s.push([p[3],!1]);var He=Me(p[0],!0);He.display&&kt(He.display)||(D.hidden=!0),E=S,O=G,W=L,S="",G=0,L=[]}j="",U=0;break;case"creator":"/"===p[1]?j=i.slice(U,p.index):U=p.index+p[0].length;break;case"meta":case"\u5143\u6570\u636e":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if("/"===p[1]){if((o=s.pop())[0]!==p[3])throw"Bad state: "+o}else"/"!==p[0].charAt(p[0].length-2)&&s.push([p[3],!1]);S="",G=0,L=[];break;case"scientific-number":case"currency-symbol":case"fill-character":case"script":case"libraries":case"automatic-styles":case"default-style":case"page-layout":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":case"number":case"fraction":case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":case"boolean":case"text-content":case"text-properties":case"embedded-text":case"body":case"\u7535\u5b50\u8868\u683c":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":case"s":case"date":case"object":case"title":case"\u6807\u9898":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"filter-set-item":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;case"text-style":case"boolean-style":case"number-style":case"currency-style":case"percentage-style":case"date-style":case"time-style":if("/"===p[1]){var et=zt.lastIndex;Pg(i.slice(g,zt.lastIndex),0,le),zt.lastIndex=et}else"/"!==p[0].charAt(p[0].length-2)&&(g=zt.lastIndex-p[0].length);break;case"style":var Ee=Me(p[0],!1);"table-cell"==Ee.family&&le[Ee["data-style-name"]]&&(Pe[Ee.name]=le[Ee["data-style-name"]]);break;case"text":if("/>"===p[0].slice(-2))break;if("/"===p[1])switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":i.slice(h,p.index)}else h=p.index+p[0].length;break;case"named-range":Ne=So((l=Me(p[0],!1))["cell-range-address"]);var mt={Name:l.name,Ref:Ne[0]+"!"+Ne[1]};N&&(mt.Sheet=m.length),Ue.Names.push(mt);break;case"null-date":"1904-01-01"===(l=Me(p[0],!1))["date-value"]&&(Ue.WBProps.date1904=!0);break;case"p":case"\u6587\u672c\u4e32":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if("/"!==p[1]||w&&w["string-value"])"/>"==p[0].slice(-2)?S+="\n":(Me(p[0],!1),G=p.index+p[0].length);else{var _t=ow(i.slice(G,p.index));S=(S.length>0?S+"\n":"")+_t[0]}break;case"database-range":if("/"===p[1])break;try{I[(Ne=So(Me(p[0])["target-range-address"]))[0]]["!autofilter"]={ref:Ne[1]}}catch{}break;case"a":if("/"!==p[1]){if(!(ve=Me(p[0],!1)).href)break;ve.Target=pt(ve.href),delete ve.href,"#"==ve.Target.charAt(0)&&ve.Target.indexOf(".")>-1?(Ne=So(ve.Target.slice(1)),ve.Target="#"+Ne[0]+"!"+Ne[1]):ve.Target.match(/^\.\.[\\\/]/)&&(ve.Target=ve.Target.slice(3))}break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"\u8868:":case"\u5b57:":break;default:if(n.WTF)throw new Error(p)}}var Dt={Sheets:I,SheetNames:m,Workbook:Ue};return n.bookSheets&&delete Dt.Sheets,Dt}function Bg(e,r){var t=Rg(e,r);return t.bookType="fods",t}var lw=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),r="<office:document-styles "+Xn({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Bt+r}}();function cw(e,r){var t="number",n="",i={"style:name":r},s="",o=0;e:if((e=e.replace(/"[$]"/g,"$")).indexOf(";")>-1&&(console.error("Unsupported ODS Style Map exported.  Using first branch of "+e),e=e.slice(0,e.indexOf(";"))),"@"!=e){if(e.indexOf(/\$/)>-1&&(t="currency"),'"'==e[o]){for(s="";'"'!=e[++o]||'"'==e[++o];)s+=e[o];"*"==e[1+--o]?(o++,n+="<number:fill-character>"+st(s.replace(/""/g,'"'))+"</number:fill-character>"):n+="<number:text>"+st(s.replace(/""/g,'"'))+"</number:text>",e=e.slice(o+1),o=0}var l=e.match(/# (\?+)\/(\?+)/);if(l)n+=pe("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":l[1].length,"number:max-denominator-value":Math.max(+l[1].replace(/./g,"9"),+l[2].replace(/./g,"9"))});else if(l=e.match(/# (\?+)\/(\d+)/))n+=pe("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":l[1].length,"number:denominator-value":+l[2]});else if(l=e.match(/\b(\d+)(|\.\d+)%/))t="percentage",n+=pe("number:number",null,{"number:decimal-places":l[2]&&l.length-1||0,"number:min-decimal-places":l[2]&&l.length-1||0,"number:min-integer-digits":l[1].length})+"<number:text>%</number:text>";else{var g=!1;if(["y","m","d"].indexOf(e[0])>-1){t="date";t:for(;o<e.length;++o)switch(s=e[o].toLowerCase()){case"h":case"s":g=!0,--o;break t;case"m":r:for(var u=o+1;u<e.length;++u)switch(e[u]){case"y":case"d":break r;case"h":case"s":g=!0,--o;break t}case"y":case"d":for(;(e[++o]||"").toLowerCase()==s[0];)s+=s[0];switch(--o,s){case"y":case"yy":n+="<number:year/>";break;case"yyy":case"yyyy":n+='<number:year number:style="long"/>';break;case"mmmmm":console.error("ODS has no equivalent of format |mmmmm|");case"m":case"mm":case"mmm":case"mmmm":n+='<number:month number:style="'+(s.length%2?"short":"long")+'" number:textual="'+(s.length>=3?"true":"false")+'"/>';break;case"d":case"dd":n+='<number:day number:style="'+(s.length%2?"short":"long")+'"/>';break;case"ddd":case"dddd":n+='<number:day-of-week number:style="'+(s.length%2?"short":"long")+'"/>'}break;case'"':for(;'"'!=e[++o]||'"'==e[++o];)s+=e[o];--o,n+="<number:text>"+st(s.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"\\":n+="<number:text>"+st(s=e[++o])+"</number:text>";break;case"/":case":":n+="<number:text>"+st(s)+"</number:text>";break;default:console.error("unrecognized character "+s+" in ODF format "+e)}if(!g)break e;e=e.slice(o+1),o=0}if(e.match(/^\[?[hms]/))for("number"==t&&(t="time"),e.match(/\[/)&&(e=e.replace(/[\[\]]/g,""),i["number:truncate-on-overflow"]="false");o<e.length;++o)switch(s=e[o].toLowerCase()){case"h":case"m":case"s":for(;(e[++o]||"").toLowerCase()==s[0];)s+=s[0];switch(--o,s){case"h":case"hh":n+='<number:hours number:style="'+(s.length%2?"short":"long")+'"/>';break;case"m":case"mm":n+='<number:minutes number:style="'+(s.length%2?"short":"long")+'"/>';break;case"s":case"ss":if("."==e[o+1])do{s+=e[o+1],++o}while("0"==e[o+1]);n+='<number:seconds number:style="'+(s.match("ss")?"long":"short")+'"'+(s.match(/\./)?' number:decimal-places="'+(s.match(/0+/)||[""])[0].length+'"':"")+"/>"}break;case'"':for(;'"'!=e[++o]||'"'==e[++o];)s+=e[o];--o,n+="<number:text>"+st(s.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"/":case":":n+="<number:text>"+st(s)+"</number:text>";break;case"a":if("a/p"==e.slice(o,o+3).toLowerCase()){n+="<number:am-pm/>",o+=2;break}if("am/pm"==e.slice(o,o+5).toLowerCase()){n+="<number:am-pm/>",o+=4;break}default:console.error("unrecognized character "+s+" in ODF format "+e)}else{if(e.indexOf(/\$/)>-1&&(t="currency"),"$"==e[0]&&(n+='<number:currency-symbol number:language="en" number:country="US">$</number:currency-symbol>',e=e.slice(1),o=0),'"'==e[o=0]){for(;'"'!=e[++o]||'"'==e[++o];)s+=e[o];"*"==e[1+--o]?(o++,n+="<number:fill-character>"+st(s.replace(/""/g,'"'))+"</number:fill-character>"):n+="<number:text>"+st(s.replace(/""/g,'"'))+"</number:text>",e=e.slice(o+1),o=0}var h=e.match(/([#0][0#,]*)(\.[0#]*|)(E[+]?0*|)/i);if(h&&h[0]){var A=h[1].replace(/,/g,"");n+="<number:"+(h[3]?"scientific-":"")+'number number:min-integer-digits="'+(-1==A.indexOf("0")?"0":A.length-A.indexOf("0"))+'"'+(h[0].indexOf(",")>-1?' number:grouping="true"':"")+(h[2]&&' number:decimal-places="'+(h[2].length-1)+'"'||' number:decimal-places="0"')+(h[3]&&h[3].indexOf("+")>-1?' number:forced-exponent-sign="true"':"")+(h[3]?' number:min-exponent-digits="'+h[3].match(/0+/)[0].length+'"':"")+"></number:"+(h[3]?"scientific-":"")+"number>",o=h.index+h[0].length}else console.error("Could not find numeric part of "+e);if('"'==e[o]){for(s="";'"'!=e[++o]||'"'==e[++o];)s+=e[o];--o,n+="<number:text>"+st(s.replace(/""/g,'"'))+"</number:text>"}}}}else t="text",n="<number:text-content/>";return n?pe("number:"+t+"-style",n,i):(console.error("Could not generate ODS number format for |"+e+"|"),"")}function Mg(e,r,t){for(var n=[],i=0;i<e.length;++i){var s=e[i];s&&s.Sheet==(-1==t?null:t)&&n.push(s)}return n.length?"      <table:named-expressions>\n"+n.map(function(o){var l=(-1==t?"$":"")+tg(o.Ref);return"        "+pe("table:named-range",null,{"table:name":o.Name,"table:cell-range-address":l,"table:base-cell-address":l.replace(/[\.][^\.]*$/,".$A$1")})}).join("\n")+"\n      </table:named-expressions>\n":""}var Lg=function(){var e=function(i,s){return st(i).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,s?"<text:line-break/>":"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},r="          <table:table-cell />\n",t=function(i,s,o,l,g,u){var h=[];h.push('      <table:table table:name="'+st(s.SheetNames[o])+'" table:style-name="ta1">\n');var A=0,C=0,I=Ht(i["!ref"]||"A1"),m=i["!merges"]||[],_=0,p=null!=i["!data"];if(i["!cols"])for(C=0;C<=I.e.c;++C)h.push("        <table:table-column"+(i["!cols"][C]?' table:style-name="co'+i["!cols"][C].ods+'"':"")+"></table:table-column>\n");var w=i["!rows"]||[];for(A=0;A<I.s.r;++A)h.push("        <table:table-row"+(w[A]?' table:style-name="ro'+w[A].ods+'"':"")+"></table:table-row>\n");for(;A<=I.e.r;++A){for(h.push("        <table:table-row"+(w[A]?' table:style-name="ro'+w[A].ods+'"':"")+">\n"),C=0;C<I.s.c;++C)h.push(r);for(;C<=I.e.c;++C){var v=!1,S={},G="";for(_=0;_!=m.length;++_)if(!(m[_].s.c>C||m[_].s.r>A||m[_].e.c<C||m[_].e.r<A)){(m[_].s.c!=C||m[_].s.r!=A)&&(v=!0),S["table:number-columns-spanned"]=m[_].e.c-m[_].s.c+1,S["table:number-rows-spanned"]=m[_].e.r-m[_].s.r+1;break}if(v)h.push("          <table:covered-table-cell/>\n");else{var X=ht({r:A,c:C}),E=p?(i["!data"][A]||[])[C]:i[X];if(E&&E.f&&(S["table:formula"]=st(Xv(E.f)),E.F&&E.F.slice(0,X.length)==X)){var O=Ht(E.F);S["table:number-matrix-columns-spanned"]=O.e.c-O.s.c+1,S["table:number-matrix-rows-spanned"]=O.e.r-O.s.r+1}if(E){switch(E.t){case"b":G=E.v?"TRUE":"FALSE",S["office:value-type"]="boolean",S["office:boolean-value"]=E.v?"true":"false";break;case"n":isFinite(E.v)?(G=E.w||String(E.v||0),S["office:value-type"]="float",S["office:value"]=E.v||0):(isNaN(E.v)?(G="#NUM!",S["table:formula"]="of:=#NUM!"):(G="#DIV/0!",S["table:formula"]="of:="+(E.v<0?"-":"")+"1/0"),S["office:string-value"]="",S["office:value-type"]="string",S["calcext:value-type"]="error");break;case"s":case"str":G=null==E.v?"":E.v,S["office:value-type"]="string";break;case"d":G=E.w||Pt(E.v,u).toISOString(),S["office:value-type"]="date",S["office:date-value"]=Pt(E.v,u).toISOString(),S["table:style-name"]="ce1";break;default:h.push(r);continue}var L=e(G);if(E.l&&E.l.Target){var W=E.l.Target;"#"!=(W="#"==W.charAt(0)?"#"+tg(W.slice(1)):W).charAt(0)&&!W.match(/^\w+:/)&&(W="../"+W),L=pe("text:a",L,{"xlink:href":W.replace(/&/g,"&amp;")})}g[E.z]&&(S["table:style-name"]="ce"+g[E.z].slice(1));var H=pe("text:p",L,{});if(E.c){for(var Y="",ee="",Te={},le=0;le<E.c.length;++le)!Y&&E.c[le].a&&(Y=E.c[le].a),ee+="<text:p>"+e(E.c[le].t)+"</text:p>";E.c.hidden||(Te["office:display"]=!0),H=pe("office:annotation",ee,Te)+H}h.push("          "+pe("table:table-cell",H,S)+"\n")}else h.push(r)}}h.push("        </table:table-row>\n")}return(s.Workbook||{}).Names&&h.push(Mg(s.Workbook.Names,0,o)),h.push("      </table:table>\n"),h.join("")};return function(s,o){var l=[Bt],g=Xn({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=Xn({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});"fods"==o.bookType?(l.push("<office:document"+g+u+">\n"),l.push(Ul().replace(/<office:document-meta[^<>]*?>/,"").replace(/<\/office:document-meta>/,"")+"\n")):l.push("<office:document-content"+g+">\n");var h=function(i,s){i.push(" <office:automatic-styles>\n");var o=0;s.SheetNames.map(function(h){return s.Sheets[h]}).forEach(function(h){if(h&&h["!cols"])for(var A=0;A<h["!cols"].length;++A)if(h["!cols"][A]){var C=h["!cols"][A];if(null==C.width&&null==C.wpx&&null==C.wch)continue;Tn(C),C.ods=o;var I=h["!cols"][A].wpx+"px";i.push('  <style:style style:name="co'+o+'" style:family="table-column">\n'),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+I+'"/>\n'),i.push("  </style:style>\n"),++o}});var l=0;s.SheetNames.map(function(h){return s.Sheets[h]}).forEach(function(h){if(h&&h["!rows"])for(var A=0;A<h["!rows"].length;++A)if(h["!rows"][A]){h["!rows"][A].ods=l;var C=h["!rows"][A].hpx+"px";i.push('  <style:style style:name="ro'+l+'" style:family="table-row">\n'),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+C+'"/>\n'),i.push("  </style:style>\n"),++l}}),i.push('  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">\n'),i.push('   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>\n'),i.push("  </style:style>\n"),i.push('  <number:date-style style:name="N37" number:automatic-order="true">\n'),i.push('   <number:month number:style="long"/>\n'),i.push("   <number:text>/</number:text>\n"),i.push('   <number:day number:style="long"/>\n'),i.push("   <number:text>/</number:text>\n"),i.push("   <number:year/>\n"),i.push("  </number:date-style>\n");var g={},u=69;return s.SheetNames.map(function(h){return s.Sheets[h]}).forEach(function(h){if(h){var A=null!=h["!data"];if(h["!ref"])for(var C=Ht(h["!ref"]),I=0;I<=C.e.r;++I)for(var m=0;m<=C.e.c;++m){var _=A?(h["!data"][I]||[])[m]:h[ht({r:I,c:m})];if(_&&_.z&&"general"!=_.z.toLowerCase()&&!g[_.z]){var p=cw(_.z,"N"+u);p&&(g[_.z]="N"+u,++u,i.push(p+"\n"))}}}}),i.push('  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>\n'),Ft(g).forEach(function(h){i.push('<style:style style:name="ce'+g[h].slice(1)+'" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="'+g[h]+'"/>\n')}),i.push(" </office:automatic-styles>\n"),g}(l,s);l.push("  <office:body>\n"),l.push("    <office:spreadsheet>\n"),((s.Workbook||{}).WBProps||{}).date1904&&l.push('      <table:calculation-settings table:case-sensitive="false" table:search-criteria-must-apply-to-whole-cell="true" table:use-wildcards="true" table:use-regular-expressions="false" table:automatic-find-labels="false">\n        <table:null-date table:date-value="1904-01-01"/>\n      </table:calculation-settings>\n');for(var A=0;A!=s.SheetNames.length;++A)l.push(t(s.Sheets[s.SheetNames[A]],s,A,0,h,((s.Workbook||{}).WBProps||{}).date1904));return(s.Workbook||{}).Names&&l.push(Mg(s.Workbook.Names,0,-1)),l.push("    </office:spreadsheet>\n"),l.push("  </office:body>\n"),l.push("fods"==o.bookType?"</office:document>":"</office:document-content>"),l.join("")}}();function Ug(e,r){if("fods"==r.bookType)return Lg(e,r);var t=js(),n="",i=[],s=[];return at(t,n="mimetype","application/vnd.oasis.opendocument.spreadsheet"),at(t,n="content.xml",Lg(e,r)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),at(t,n="styles.xml",lw(e,r)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),at(t,n="meta.xml",Bt+Ul()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),at(t,n="manifest.rdf",function Bd(e){var r=[Bt];r.push('<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">\n');for(var t=0;t!=e.length;++t)r.push(Ll(e[t][0],e[t][1])),r.push(Od("",e[t][0]));return r.push(Ll("","Document","pkg")),r.push("</rdf:RDF>"),r.join("")}(s)),i.push([n,"application/rdf+xml"]),at(t,n="META-INF/manifest.xml",function Rd(e){var r=[Bt];r.push('<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">\n'),r.push('  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>\n');for(var t=0;t<e.length;++t)r.push('  <manifest:file-entry manifest:full-path="'+e[t][0]+'" manifest:media-type="'+e[t][1]+'"/>\n');return r.push("</manifest:manifest>"),r.join("")}(i)),t
/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */}var $t=function(){try{return typeof Uint8Array>"u"||typeof Uint8Array.prototype.subarray>"u"?"slice":typeof Buffer<"u"?typeof Buffer.prototype.subarray>"u"?"slice":("function"==typeof Buffer.from?Buffer.from([72,62]):new Buffer([72,62]))instanceof Uint8Array?"subarray":"slice":"subarray"}catch{return"slice"}}();function Sn(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function tn(e){return typeof TextDecoder<"u"?(new TextDecoder).decode(e):yt(sn(e))}function br(e){return typeof TextEncoder<"u"?(new TextEncoder).encode(e):wr(cn(e))}function Bn(e){for(var r=0,t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0;t<e.length;++t){var s=e[t],o=s.length;if(o<250)for(var l=0;l<o;++l)n[i++]=s[l];else n.set(s,i),i+=o}return n}function xa(e){return 16843009*((e=(858993459&(e-=e>>1&1431655765))+(e>>2&858993459))+(e>>4)&252645135)>>>24}function va(e,r){var t=r.l,n=127&e[t];e:if(e[t++]>=128&&(n|=(127&e[t])<<7,e[t++]<128||(n|=(127&e[t])<<14,e[t++]<128)||(n|=(127&e[t])<<21,e[t++]<128)||(n+=(127&e[t])*Math.pow(2,28),++t,e[t++]<128)||(n+=(127&e[t])*Math.pow(2,35),++t,e[t++]<128)||(n+=(127&e[t])*Math.pow(2,42),++t,e[t++]<128)))break e;return r.l=t,n}function je(e){var r=new Uint8Array(7);r[0]=127&e;var t=1;e:if(e>127){if(r[t-1]|=128,r[t]=e>>7&127,++t,e<=16383||(r[t-1]|=128,r[t]=e>>14&127,++t,e<=2097151)||(r[t-1]|=128,r[t]=e>>21&127,++t,e<=268435455)||(r[t-1]|=128,r[t]=e/256>>>21&127,++t,e<=34359738367)||(r[t-1]|=128,r[t]=e/65536>>>21&127,++t,e<=4398046511103))break e;r[t-1]|=128,r[t]=e/16777216>>>21&127,++t}return r[$t](0,t)}function Gg(e){for(var r={l:0},t=[];r.l<e.length;)t.push(va(e,r));return t}function jg(e){return Bn(e.map(function(r){return je(r)}))}function ct(e){var r=0,t=127&e[r];return e[r++]<128||(t|=(127&e[r])<<7,e[r++]<128)||(t|=(127&e[r])<<14,e[r++]<128)||(t|=(127&e[r])<<21,e[r++]<128)||(t|=(15&e[r])<<28),t}function me(e){for(var r=[],t={l:0};t.l<e.length;){var n=t.l,i=va(e,t),s=7&i;i=i/8|0;var o,l=t.l;switch(s){case 0:for(;e[l++]>=128;);o=e[$t](t.l,l),t.l=l;break;case 1:o=e[$t](l,l+8),t.l=l+8;break;case 2:var g=va(e,t);o=e[$t](t.l,t.l+g),t.l+=g;break;case 5:o=e[$t](l,l+4),t.l=l+4;break;default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var u={data:o,type:s};null==r[i]&&(r[i]=[]),r[i].push(u)}return r}function $e(e){var r=[];return e.forEach(function(t,n){0!=n&&t.forEach(function(i){i.data&&(r.push(je(8*n+i.type)),2==i.type&&r.push(je(i.data.length)),r.push(i.data))})}),Bn(r)}function Mn(e,r){return e?.map(function(t){return r(t.data)})||[]}function ka(e){for(var r,t=[],n={l:0};n.l<e.length;){var i=va(e,n),s=me(e[$t](n.l,n.l+i));n.l+=i;var o={id:ct(s[1][0].data),messages:[]};s[2].forEach(function(l){var g=me(l.data),u=ct(g[3][0].data);o.messages.push({meta:g,data:e[$t](n.l,n.l+u)}),n.l+=u}),null!=(r=s[3])&&r[0]&&(o.merge=ct(s[3][0].data)>>>0>0),t.push(o)}return t}function Fi(e){var r=[];return e.forEach(function(t){var n=[[],[{data:je(t.id),type:0}],[]];null!=t.merge&&(n[3]=[{data:je(+!!t.merge),type:0}]);var i=[];t.messages.forEach(function(o){i.push(o.data),o.meta[3]=[{type:0,data:je(o.data.length)}],n[2].push({data:$e(o.meta),type:2})});var s=$e(n);r.push(je(s.length)),r.push(s),i.forEach(function(o){return r.push(o)})}),Bn(r)}function uw(e,r){if(0!=e)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t={l:0},n=va(r,t),i=[],s=t.l;s<r.length;){var o=3&r[s];if(0!=o){var u=0,h=0;if(1==o?(h=4+(r[s]>>2&7),u=(224&r[s++])<<3,u|=r[s++]):(h=1+(r[s++]>>2),2==o?(u=r[s]|r[s+1]<<8,s+=2):(u=(r[s]|r[s+1]<<8|r[s+2]<<16|r[s+3]<<24)>>>0,s+=4)),0==u)throw new Error("Invalid offset 0");for(var A=i.length-1,C=u;A>=0&&C>=i[A].length;)C-=i[A].length,--A;if(A<0){if(0!=C)throw new Error("Invalid offset beyond length");C=i[A=0].length}if(h<C)i.push(i[A][$t](i[A].length-C,i[A].length-C+h));else{for(C>0&&(i.push(i[A][$t](i[A].length-C)),h-=C),++A;h>=i[A].length;)i.push(i[A]),h-=i[A].length,++A;h&&i.push(i[A][$t](0,h))}i.length>25&&(i=[Bn(i)])}else{var l=r[s++]>>2;if(l<60)++l;else{var g=l-59;l=r[s],g>1&&(l|=r[s+1]<<8),g>2&&(l|=r[s+2]<<16),g>3&&(l|=r[s+3]<<24),l>>>=0,l++,s+=g}i.push(r[$t](s,s+l)),s+=l}}for(var I=0,m=0;m<i.length;++m)I+=i[m].length;if(I!=n)throw new Error("Unexpected length: ".concat(I," != ").concat(n));return i}function wa(e){Array.isArray(e)&&(e=new Uint8Array(e));for(var r=[],t=0;t<e.length;){var n=e[t++],i=e[t]|e[t+1]<<8|e[t+2]<<16;r.push.apply(r,uw(n,e[$t](t+=3,t+i))),t+=i}if(t!==e.length)throw new Error("data is not a valid framed stream!");return 1==r.length?r[0]:Bn(r)}function Di(e){for(var r=[],t=0;t<e.length;){var n=Math.min(e.length-t,268435455),i=new Uint8Array(4);r.push(i);var s=je(n),o=s.length;r.push(s),n<=60?(o++,r.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,r.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,r.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,r.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,r.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),r.push(e[$t](t,t+n)),o+=n,i[0]=0,i[1]=255&o,i[2]=o>>8&255,i[3]=o>>16&255,t+=n}return Bn(r)}var hw=function(){return{sst:[],rsst:[],ofmt:[],nfmt:[],fmla:[],ferr:[],cmnt:[]}};function Vg(e,r,t,n,i){var s,o,l,g,h=r>>8,A=h>=5?i:n;e:if(t&(h>4?8:4)&&"n"==e.t&&7==(255&r)){var C=null!=(s=A[7])&&s[0]?ct(A[7][0].data):-1;if(-1==C)break e;var I=null!=(o=A[15])&&o[0]?ct(A[15][0].data):-1,m=null!=(l=A[16])&&l[0]?ct(A[16][0].data):-1,_=null!=(g=A[40])&&g[0]?ct(A[40][0].data):-1,p=e.v,d=p;t:if(_){if(0==p){I=m=2;break t}I=p>=604800?1:p>=86400?2:p>=3600?4:p>=60?8:p>=1?16:32,Math.floor(p)!=p?m=32:p%60?m=16:p%3600?m=8:p%86400?m=4:p%604800&&(m=2),m<I&&(m=I)}if(-1==I||-1==m)break e;var w=[],v=[];1==I&&(d=p/604800,1==m?v.push('d"d"'):p-=604800*(d|=0),w.push(d+(2==C?" week"+(1==d?"":"s"):1==C?"w":""))),I<=2&&m>=2&&(d=p/86400,m>2&&(p-=86400*(d|=0)),v.push('d"d"'),w.push(d+(2==C?" day"+(1==d?"":"s"):1==C?"d":""))),I<=4&&m>=4&&(d=p/3600,m>4&&(p-=3600*(d|=0)),v.push((I>=4?"[h]":"h")+'"h"'),w.push(d+(2==C?" hour"+(1==d?"":"s"):1==C?"h":""))),I<=8&&m>=8&&(d=p/60,m>8&&(p-=60*(d|=0)),v.push((I>=8?"[m]":"m")+'"m"'),w.push(0==C?(8==I&&8==m||d>=10?"":"0")+d:d+(2==C?" minute"+(1==d?"":"s"):1==C?"m":""))),I<=16&&m>=16&&(d=p,m>16&&(p-=d|=0),v.push((I>=16?"[s]":"s")+'"s"'),w.push(0==C?(16==m&&16==I||d>=10?"":"0")+d:d+(2==C?" second"+(1==d?"":"s"):1==C?"s":""))),m>=32&&(d=Math.round(1e3*p),I<32&&v.push('.000"ms"'),w.push(0==C?(d>=100?"":d>=10?"0":"00")+d:d+(2==C?" millisecond"+(1==d?"":"s"):1==C?"ms":""))),e.w=w.join(0==C?":":" "),e.z=v.join(0==C?'":"':" "),0==C&&(e.w=e.w.replace(/:(\d\d\d)$/,".$1"))}}function Lo(e,r){var t=new Uint8Array(32),n=Sn(t),i=12,s=0;switch(t[0]=5,e.t){case"n":if(e.z&&Mr(e.z)){t[1]=5,n.setFloat64(i,(xn(e.v+1462).getTime()-Date.UTC(2001,0,1))/1e3,!0),s|=4,i+=8;break}t[1]=2,function fw(e,r,t){var n=Math.floor(0==t?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-16,i=t/Math.pow(10,n-6176);e[r+15]|=n>>7,e[r+14]|=(127&n)<<1;for(var s=0;i>=1;++s,i/=256)e[r+s]=255&i;e[r+15]|=t>=0?0:128}(t,i,e.v),s|=1,i+=16;break;case"b":t[1]=6,n.setFloat64(i,e.v?1:0,!0),s|=2,i+=8;break;case"s":var o=null==e.v?"":String(e.v);if(e.l){var l=r.rsst.findIndex(function(u){var h;return u.v==o&&u.l==(null==(h=e.l)?void 0:h.Target)});-1==l&&(r.rsst[l=r.rsst.length]={v:o,l:e.l.Target}),t[1]=9,n.setUint32(i,l,!0),s|=16,i+=4}else{var g=r.sst.indexOf(o);-1==g&&(r.sst[g=r.sst.length]=o),t[1]=3,n.setUint32(i,g,!0),s|=8,i+=4}break;case"d":t[1]=5,n.setFloat64(i,(e.v.getTime()-Date.UTC(2001,0,1))/1e3,!0),s|=4,i+=8;break;case"z":t[1]=0;break;default:throw"unsupported cell type "+e.t}return e.c&&(r.cmnt.push(function _w(e){for(var r={a:"",t:"",replies:[]},t=0;t<e.length;++t)0==t?(r.a=e[t].a,r.t=e[t].t):r.replies.push({a:e[t].a,t:e[t].t});return r}(e.c)),n.setUint32(i,r.cmnt.length-1,!0),s|=524288,i+=4),n.setUint32(8,s,!0),t[$t](0,i)}function Uo(e,r){var t=new Uint8Array(32),n=Sn(t),i=12,s=0,o="";switch(t[0]=4,e.t){case"n":case"b":case"d":case"e":case"z":break;case"s":if(o=null==e.v?"":String(e.v),e.l){var l=r.rsst.findIndex(function(u){var h;return u.v==o&&u.l==(null==(h=e.l)?void 0:h.Target)});-1==l&&(r.rsst[l=r.rsst.length]={v:o,l:e.l.Target}),t[1]=9,n.setUint32(i,l,!0),s|=512,i+=4}break;default:throw"unsupported cell type "+e.t}switch(e.c&&(n.setUint32(i,r.cmnt.length-1,!0),s|=4096,i+=4),e.t){case"n":t[1]=2,n.setFloat64(i,e.v,!0),s|=32,i+=8;break;case"b":t[1]=6,n.setFloat64(i,e.v?1:0,!0),s|=32,i+=8;break;case"s":if(o=null==e.v?"":String(e.v),!e.l){var g=r.sst.indexOf(o);-1==g&&(r.sst[g=r.sst.length]=o),t[1]=3,n.setUint32(i,g,!0),s|=16,i+=4}break;case"d":t[1]=5,n.setFloat64(i,(e.v.getTime()-Date.UTC(2001,0,1))/1e3,!0),s|=64,i+=8;break;case"z":t[1]=0;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),t[$t](0,i)}function Aw(e,r,t){switch(e[0]){case 0:case 1:case 2:case 3:case 4:return function Cw(e,r,t,n){var i=Sn(e),s=i.getUint32(4,!0),o=-1,l=-1,g=-1,u=NaN,h=0,A=new Date(Date.UTC(2001,0,1)),C=t>1?12:8;2&s&&(g=i.getUint32(C,!0),C+=4),C+=4*xa(s&(t>1?3468:396)),512&s&&(o=i.getUint32(C,!0),C+=4),C+=4*xa(s&(t>1?12288:4096)),16&s&&(l=i.getUint32(C,!0),C+=4),32&s&&(u=i.getFloat64(C,!0),C+=8),64&s&&(A.setTime(A.getTime()+1e3*(h=i.getFloat64(C,!0))),C+=8),t>1&&255&(s=i.getUint32(8,!0)>>>16)&&(-1==g&&(g=i.getUint32(C,!0)),C+=4);var I,m=e[t>=4?1:2];switch(m){case 0:return;case 2:case 7:I={t:"n",v:u};break;case 3:I={t:"s",v:r.sst[l]};break;case 5:I=n?.cellDates?{t:"d",v:A}:{t:"n",v:h/86400+35430,z:Ve[14]};break;case 6:I={t:"b",v:u>0};break;case 8:I={t:"e",v:0};break;case 9:if(!(o>-1))throw new Error("Unsupported cell type ".concat(e[$t](0,4)));var _=r.rsst[o];I={t:"s",v:_.v},_.l&&(I.l={Target:_.l});break;default:throw new Error("Unsupported cell type ".concat(e[$t](0,4)))}return g>-1&&Vg(I,m|t<<8,s,r.ofmt[g],r.nfmt[g]),7==m&&(I.v/=86400),I}(e,r,e[0],t);case 5:return function Iw(e,r,t){var n=Sn(e),s=(n.getUint32(4,!0),n.getUint32(8,!0)),o=12,l=-1,g=-1,u=-1,h=NaN,A=NaN,C=0,I=new Date(Date.UTC(2001,0,1));1&s&&(h=function gw(e,r){for(var t=(127&e[r+15])<<7|e[r+14]>>1,n=1&e[r+14],i=r+13;i>=r;--i)n=256*n+e[i];return(128&e[r+15]?-n:n)*Math.pow(10,t-6176)}(e,o),o+=16),2&s&&(A=n.getFloat64(o,!0),o+=8),4&s&&(I.setTime(I.getTime()+1e3*(C=n.getFloat64(o,!0))),o+=8),8&s&&(g=n.getUint32(o,!0),o+=4),16&s&&(l=n.getUint32(o,!0),o+=4),o+=4*xa(480&s),512&s&&(n.getUint32(o,!0),o+=4),o+=4*xa(1024&s),2048&s&&(n.getUint32(o,!0),o+=4);var p,d=e[1];switch(d){case 0:p={t:"z"};break;case 2:case 10:p={t:"n",v:h};break;case 3:p={t:"s",v:r.sst[g]};break;case 5:p=t?.cellDates?{t:"d",v:I}:{t:"n",v:C/86400+35430,z:Ve[14]};break;case 6:p={t:"b",v:A>0};break;case 7:p={t:"n",v:A};break;case 8:p={t:"e",v:0};break;case 9:if(!(l>-1))throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&s," : ").concat(e[$t](0,4)));var w=r.rsst[l];p={t:"s",v:w.v},w.l&&(p.l={Target:w.l});break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&s," : ").concat(e[$t](0,4)))}if(o+=4*xa(4096&s),516096&s&&(-1==u&&(u=n.getUint32(o,!0)),o+=4),524288&s){var v=n.getUint32(o,!0);o+=4,r.cmnt[v]&&(p.c=function mw(e){var r=[];return r.push({t:e.t||"",a:e.a,T:e.replies&&e.replies.length>0}),e.replies&&e.replies.forEach(function(t){r.push({t:t.t||"",a:t.a,T:!0})}),r}(r.cmnt[v]))}return u>-1&&Vg(p,1280|d,s>>13,r.ofmt[u],r.nfmt[u]),7==d&&(p.v/=86400),p}(e,r,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function It(e){return ct(me(e)[1][0].data)}function vr(e){return $e([[],[{type:0,data:je(e)}]])}function kr(e,r){var t,n=null!=(t=e.messages[0].meta[5])&&t[0]?Gg(e.messages[0].meta[5][0].data):[];-1==n.indexOf(r)&&(n.push(r),e.messages[0].meta[5]=[{type:2,data:jg(n)}])}function bn(e,r){var t,n=null!=(t=e.messages[0].meta[5])&&t[0]?Gg(e.messages[0].meta[5][0].data):[];e.messages[0].meta[5]=[{type:2,data:jg(n.filter(function(i){return i!=r}))}]}function oi(e,r){var t=me(r.data),n=ct(t[1][0].data),s=[];return(t[3]||[]).forEach(function(o){var l,g,u=me(o.data);if(u[1]){var h=ct(u[1][0].data)>>>0;switch(n){case 1:s[h]=tn(u[3][0].data);break;case 8:var C=me(e[It(u[9][0].data)][0].data),I=e[It(C[1][0].data)][0],m=ct(I.meta[1][0].data);if(2001!=m)throw new Error("2000 unexpected reference to ".concat(m));var _=me(I.data),p={v:_[3].map(function(v){return tn(v.data)}).join("")};s[h]=p;e:if(null!=(l=_?.[11])&&l[0]){var d=null==(g=me(_[11][0].data))?void 0:g[1];if(!d)break e;d.forEach(function(v){var S,G,X,E=me(v.data);if(null!=(S=E[2])&&S[0]){var O=e[It(null==(G=E[2])?void 0:G[0].data)][0],L=ct(O.meta[1][0].data);switch(L){case 2032:var W=me(O.data);null!=(X=W?.[2])&&X[0]&&!p.l&&(p.l=tn(W[2][0].data));break;case 2039:break;default:console.log("unrecognized ObjectAttribute type ".concat(L))}}})}break;case 2:s[h]=me(u[6][0].data);break;case 3:s[h]=me(u[5][0].data);break;case 10:var w=e[It(u[10][0].data)][0];s[h]=$g(e,w.data);break;default:throw n}}}),s}function $g(e,r){var t,n,i,s,o,l,g,u,h,A,C={t:"",a:""},I=me(r);if(null!=(n=null==(t=I?.[1])?void 0:t[0])&&n.data&&(C.t=tn(null==(s=null==(i=I?.[1])?void 0:i[0])?void 0:s.data)||""),null!=(l=null==(o=I?.[3])?void 0:o[0])&&l.data){var _=me(e[It(null==(u=null==(g=I?.[3])?void 0:g[0])?void 0:u.data)][0].data);null!=(A=null==(h=_[1])?void 0:h[0])&&A.data&&(C.a=tn(_[1][0].data))}return I?.[4]&&(C.replies=[],I[4].forEach(function(p){var d=e[It(p.data)][0];C.replies.push($g(e,d.data))})),C}function vw(e,r,t){var n=me(r.data),i={"!ref":"A1"};t?.dense&&(i["!data"]=[]);var s=e[It(n[2][0].data)],o=ct(s[0].meta[1][0].data);if(6001!=o)throw new Error("6000 unexpected reference to ".concat(o));return function xw(e,r,t,n){var i,s,o,l,g,u,h,A,C,I,m,_,p,d,w=me(r.data),v={s:{r:0,c:0},e:{r:0,c:0}};if(v.e.r=(ct(w[6][0].data)>>>0)-1,v.e.r<0)throw new Error("Invalid row varint ".concat(w[6][0].data));if(v.e.c=(ct(w[7][0].data)>>>0)-1,v.e.c<0)throw new Error("Invalid col varint ".concat(w[7][0].data));t["!ref"]=ot(v);var S=null!=t["!data"],G=t,X=me(w[4][0].data),E=hw();null!=(i=X[4])&&i[0]&&(E.sst=oi(e,e[It(X[4][0].data)][0])),null!=(s=X[6])&&s[0]&&(E.fmla=oi(e,e[It(X[6][0].data)][0])),null!=(o=X[11])&&o[0]&&(E.ofmt=oi(e,e[It(X[11][0].data)][0])),null!=(l=X[12])&&l[0]&&(E.ferr=oi(e,e[It(X[12][0].data)][0])),null!=(g=X[17])&&g[0]&&(E.rsst=oi(e,e[It(X[17][0].data)][0])),null!=(u=X[19])&&u[0]&&(E.cmnt=oi(e,e[It(X[19][0].data)][0])),null!=(h=X[22])&&h[0]&&(E.nfmt=oi(e,e[It(X[22][0].data)][0]));var O=me(X[3][0].data),L=0;if(null==(A=X[9])||!A[0])throw"NUMBERS file missing row tree";if(me(X[9][0].data)[1].map(function(le){return me(le.data)}).forEach(function(le){L=ct(le[1][0].data);var Pe=ct(le[2][0].data),ce=O[1][Pe];if(!ce)throw"NUMBERS missing tile "+Pe;var Re=me(ce.data),Xe=e[It(Re[2][0].data)][0],ue=ct(Xe.meta[1][0].data);if(6002!=ue)throw new Error("6001 unexpected reference to ".concat(ue));var Ke=function dw(e,r){var t,n=me(r.data),i=-1;null!=(t=n?.[7])&&t[0]&&(i=ct(n[7][0].data)>>>0?1:0);var s=Mn(n[5],function(o){return function pw(e,r){var t,n,i,s,o,l,g,u,h,A,C,I,m,_,S,G,p=me(e),d=ct(p[1][0].data)>>>0,w=ct(p[2][0].data)>>>0,v=(null==(n=null==(t=p[8])?void 0:t[0])?void 0:n.data)&&ct(p[8][0].data)>0||!1;if(null!=(s=null==(i=p[7])?void 0:i[0])&&s.data&&0!=r)S=null==(l=null==(o=p[7])?void 0:o[0])?void 0:l.data,G=null==(u=null==(g=p[6])?void 0:g[0])?void 0:u.data;else{if(null==(A=null==(h=p[4])?void 0:h[0])||!A.data||1==r)throw"NUMBERS Tile missing ".concat(r," cell storage");S=null==(I=null==(C=p[4])?void 0:C[0])?void 0:I.data,G=null==(_=null==(m=p[3])?void 0:m[0])?void 0:_.data}for(var X=v?4:1,E=Sn(S),O=[],L=0;L<S.length/2;++L){var W=E.getUint16(2*L,!0);W<65535&&O.push([L,W])}if(O.length!=w)throw"Expected ".concat(w," cells, found ").concat(O.length);var H=[];for(L=0;L<O.length-1;++L)H[O[L][0]]=G[$t](O[L][1]*X,O[L+1][1]*X);return O.length>=1&&(H[O[O.length-1][0]]=G[$t](O[O.length-1][1]*X)),{R:d,cells:H}}(o,i)});return{nrows:ct(n[4][0].data)>>>0,data:s.reduce(function(o,l){return o[l.R]||(o[l.R]=[]),l.cells.forEach(function(g,u){if(o[l.R][u])throw new Error("Duplicate cell r=".concat(l.R," c=").concat(u));o[l.R][u]=g}),o},[])}}(0,Xe);Ke.data.forEach(function(re,he){re.forEach(function(Ce,Ue){var ve=Aw(Ce,E,n);ve&&(S?(G["!data"][L+he]||(G["!data"][L+he]=[]),G["!data"][L+he][Ue]=ve):t[rt(Ue)+ut(L+he)]=ve)})}),L+=Ke.nrows}),null!=(C=X[13])&&C[0]){var H=e[It(X[13][0].data)][0],Y=ct(H.meta[1][0].data);if(6144!=Y)throw new Error("Expected merge type 6144, found ".concat(Y));t["!merges"]=null==(I=me(H.data))?void 0:I[1].map(function(le){var Pe=me(le.data),ce=Sn(me(Pe[1][0].data)[1][0].data),Re=Sn(me(Pe[2][0].data)[1][0].data);return{s:{r:ce.getUint16(0,!0),c:ce.getUint16(2,!0)},e:{r:ce.getUint16(0,!0)+Re.getUint16(0,!0)-1,c:ce.getUint16(2,!0)+Re.getUint16(2,!0)-1}}})}if((null==(m=t["!merges"])||!m.length)&&null!=(_=w[47])&&_[0]){var ee=me(w[47][0].data);if(null!=(p=ee[2])&&p[0]){var Te=me(ee[2][0].data);null!=(d=Te[3])&&d[0]&&(t["!merges"]=Mn(Te[3],function(le){var Pe,ce,Re,Xe,ue,Ke=me(le),re=me(Ke[2][0].data),he=me(re[1][0].data);if(null!=(Pe=he[1])&&Pe[0]){var Ce=me(he[1][0].data);if(67==ct(Ce[1][0].data)){var ve=me(Ce[40][0].data);if(null!=(ce=ve[3])&&ce[0]&&null!=(Re=ve[4])&&Re[0]){var Ne=me(ve[3][0].data),D=me(ve[4][0].data),z=ct(Ne[1][0].data),j=null!=(Xe=Ne[2])&&Xe[0]?ct(Ne[2][0].data):z,U=ct(D[1][0].data);return{s:{r:U,c:z},e:{r:null!=(ue=D[2])&&ue[0]?ct(D[2][0].data):U,c:j}}}}}}).filter(function(le){return null!=le}))}}}(e,s[0],i,t),i}function Go(e,r){var t,n,i,s,o,l,g,u={},h=[];if(e.FullPaths.forEach(function(C){if(C.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(C){if(C.name.match(/\.iwa$/)&&0==C.content[0]){var I,m;try{I=wa(C.content)}catch(_){return console.log("?? "+C.content.length+" "+(_.message||_))}try{m=ka(I)}catch(_){return console.log("## "+(_.message||_))}m.forEach(function(_){u[_.id]=_.messages,h.push(_.id)})}}),!h.length)throw new Error("File has no messages");if(null!=(i=null==(n=null==(t=u?.[1])?void 0:t[0].meta)?void 0:n[1])&&i[0].data&&1e4==ct(u[1][0].meta[1][0].data))throw new Error("Pages documents are not supported");var A=(null==(g=null==(l=null==(o=null==(s=u?.[1])?void 0:s[0])?void 0:o.meta)?void 0:l[1])?void 0:g[0].data)&&1==ct(u[1][0].meta[1][0].data)&&u[1][0];if(A||h.forEach(function(C){u[C].forEach(function(I){if(1==ct(I.meta[1][0].data)>>>0){if(A)throw new Error("Document has multiple roots");A=I}})}),!A)throw new Error("Cannot find Document root");return function ww(e,r,t){var n,i=Qo();i.Workbook={WBProps:{date1904:!0}};var s=me(r.data);if(null!=(n=s[2])&&n[0])throw new Error("Keynote presentations are not supported");if(Mn(s[1],It).forEach(function(l){e[l].forEach(function(g){if(2==ct(g.meta[1][0].data)){var h=function kw(e,r,t){var n,i=me(r.data),s={name:null!=(n=i[1])&&n[0]?tn(i[1][0].data):"",sheets:[]};return Mn(i[2],It).forEach(function(l){e[l].forEach(function(g){6e3==ct(g.meta[1][0].data)&&s.sheets.push(vw(e,g,t))})}),s}(e,g,t);h.sheets.forEach(function(A,C){Ta(i,A,0==C?h.name:h.name+"_"+C,!0)})}})}),0==i.SheetNames.length)throw new Error("Empty NUMBERS file");return i.bookType="numbers",i}(u,A,r)}function yw(e,r,t){var n,i,s,o=[[],[{type:0,data:je(0)}],[{type:0,data:je(0)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},function(){return 255}))}],[{type:0,data:je(5)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},function(){return 255}))}],[{type:0,data:je(1)}]];if(null==(n=o[6])||!n[0]||null==(i=o[7])||!i[0])throw"Mutation only works on post-BNC storages!";var l=0;if(o[7][0].data.length<2*e.length){var g=new Uint8Array(2*e.length);g.set(o[7][0].data),o[7][0].data=g}if(o[4][0].data.length<2*e.length){var u=new Uint8Array(2*e.length);u.set(o[4][0].data),o[4][0].data=u}for(var h=Sn(o[7][0].data),A=0,C=[],I=Sn(o[4][0].data),m=0,_=[],p=t?4:1,d=0;d<e.length;++d)if(null!=e[d]&&("z"!=e[d].t||null!=(s=e[d].c)&&s.length)&&"e"!=e[d].t){var w,v;switch(h.setUint16(2*d,A/p,!0),I.setUint16(2*d,m/p,!0),e[d].t){case"d":if(e[d].v instanceof Date){w=Lo(e[d],r),v=Uo(e[d],r);break}w=Lo(e[d],r),v=Uo(e[d],r);break;case"s":case"n":case"b":case"z":w=Lo(e[d],r),v=Uo(e[d],r);break;default:throw new Error("Unsupported value "+e[d])}C.push(w),A+=w.length,_.push(v),m+=v.length,++l}else h.setUint16(2*d,65535,!0),I.setUint16(2*d,65535);for(o[2][0].data=je(l),o[5][0].data=je(5);d<o[7][0].data.length/2;++d)h.setUint16(2*d,65535,!0),I.setUint16(2*d,65535,!0);return o[6][0].data=Bn(C),o[3][0].data=Bn(_),o[8]=[{type:0,data:je(t?1:0)}],o}function jo(e,r){return{meta:[[],[{type:0,data:je(e)}]],data:r}}function hn(e,r){r.last||(r.last=927262);for(var t=r.last;t<2e6;++t)if(!r[t])return r[r.last=t]=e,t;throw new Error("Too many messages")}function xs(e,r,t){return $e([[],[{type:0,data:je(1)}],[],[{type:5,data:new Uint8Array(Float32Array.from([e/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([r/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([t/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([1]).buffer)}],[],[],[],[],[],[{type:0,data:je(1)}]])}function Wg(e){switch(e){case 0:return xs(99,222,171);case 1:return xs(162,197,240);case 2:return xs(255,189,189)}return xs(255*Math.random(),255*Math.random(),255*Math.random())}function St(e,r,t,n){var i=We.find(e,r[t].location);if(!i)throw"Could not find ".concat(r[t].location," in Numbers template");var s=ka(wa(i.content));n(s.find(function(l){return l.id==t}),s),i.content=Di(Fi(s)),i.size=i.content.length}function Cn(e,r,t){var n=We.find(e,r[t].location);if(!n)throw"Could not find ".concat(r[t].location," in Numbers template");return ka(wa(n.content)).find(function(o){return o.id==t})}function Vo(e,r,t){e[3].push({type:2,data:$e([[],[{type:0,data:je(r)}],[{type:2,data:br(t.replace(/-[\s\S]*$/,""))}],[{type:2,data:br(t)}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:je(0)}],[],[{type:0,data:je(0)}]])}),e[1]=[{type:0,data:je(Math.max(r+1,ct(e[1][0].data)))}]}function li(e,r,t,n,i,s){s||(s=hn({deps:[],location:"",type:r},i));var o="".concat(n,"-").concat(s,".iwa");i[s].location="Root Entry"+o,We.utils.cfb_add(e,o,Di(Fi([{id:s,messages:[jo(r,$e(t))]}])));var l=o.replace(/^[\/]/,"").replace(/^Index\//,"").replace(/\.iwa$/,"");return St(e,i,2,function(g){var u=me(g.messages[0].data);Vo(u,s||0,l),g.messages[0].data=$e(u)}),s}function Pr(e,r,t,n){var i=r[t].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,""),s=e[3].findIndex(function(l){var g,u,h=me(l.data);return null!=(g=h[3])&&g[0]?tn(h[3][0].data)==i:!(null==(u=h[2])||!u[0]||tn(h[2][0].data)!=i)}),o=me(e[3][s].data);o[6]||(o[6]=[]),(Array.isArray(n)?n:[n]).forEach(function(l){o[6].push({type:2,data:$e([[],[{type:0,data:je(l)}]])})}),e[3][s].data=$e(o)}var Xg=!0;function zg(e){return function(t){for(var n=0;n!=e.length;++n){var i=e[n];void 0===t[i[0]]&&(t[i[0]]=i[1]),"n"===i[2]&&(t[i[0]]=Number(t[i[0]]))}}}function $o(e){zg([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Wo(e){zg([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function Nw(e){return lt.WS.indexOf(e)>-1?"sheet":lt.CS&&e==lt.CS?"chart":lt.DS&&e==lt.DS?"dialog":lt.MS&&e==lt.MS?"macro":e&&e.length?e:"sheet"}function Ow(e,r,t,n,i,s,o,l,g,u,h,A){try{s[n]=na(Sr(e,t,!0),r);var I,C=Xt(e,r);switch(l){case"sheet":I=uk(C,r,i,g,s[n],u,h,A);break;case"chart":if(!(I=function hk(e,r,t,n,i,s,o,l){return".bin"===r.slice(-4)?function U3(e,r,t,n,i){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o=[],l=!1;return kn(e,function(u,h,A){switch(A){case 550:s["!rel"]=u;break;case 651:i.Sheets[t]||(i.Sheets[t]={}),u.name&&(i.Sheets[t].CodeName=u.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:o.push(A);break;case 38:o.pop();break;default:if(h.T>0)o.push(A);else if(h.T<0)o.pop();else if(!l||r.WTF)throw new Error("Unexpected record 0x"+A.toString(16))}},r),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}(e,n,t,i,s):function M3(e,r,t,n,i){if(!e)return e;n||(n={"!id":{}});var o,s={"!type":"chart","!drawel":null,"!rel":""},l=e.match(ng);return l&&Eo(l[0],0,i,t),(o=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=o[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}(e,0,t,i,s)}(C,r,i,g,s[n],u))||!I["!drawel"])break;var m=di(I["!drawel"].Target,r),_=ra(m),p=function jx(e,r){if(!e)return"??";var t=(e.match(/<c:chart [^<>]*r:id="([^<>"]*)"/)||["",""])[1];return r["!id"][t].Target}(Sr(e,m,!0),na(Sr(e,_,!0),m)),d=di(p,m),w=ra(d);I=function B3(e,r,t,n,i,s){var o=s||{"!type":"chart"};if(!e)return s;var l=0,g=0,u="A",h={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(Us(e,"<c:numCache>","</c:numCache>")||[]).forEach(function(A){var C=function O3(e){var n,r=[],t=e.match(/^<c:numCache>/);(e.match(/<c:pt idx="(\d*)"[^<>\/]*><c:v>([^<])<\/c:v><\/c:pt>/gm)||[]).forEach(function(s){var o=s.match(/<c:pt idx="(\d*)"[^<>\/]*><c:v>([^<]*)<\/c:v><\/c:pt>/);o&&(r[+o[1]]=t?+o[2]:o[2])});var i=pt((Wn(e,"c:formatCode")||["","General"])[1]);return(Us(e,"<c:f>","</c:f>")||[]).forEach(function(s){n=s.replace(/<[^<>]*>/g,"")}),[r,i,n]}(A);h.s.r=h.s.c=0,h.e.c=l,u=rt(l),C[0].forEach(function(I,m){o["!data"]?(o["!data"][m]||(o["!data"][m]=[]),o["!data"][m][l]={t:"n",v:I,z:C[1]}):o[u+ut(m)]={t:"n",v:I,z:C[1]},g=m}),h.e.r<g&&(h.e.r=g),++l}),l>0&&(o["!ref"]=ot(h)),o}(Sr(e,d,!0),0,0,na(Sr(e,w,!0),d),0,I);break;case"macro":I=function Ck(e,r){return r.slice(-4),{"!type":"macro"}}(0,r);break;case"dialog":I=function Ik(e,r){return r.slice(-4),{"!type":"dialog"}}(0,r);break;default:throw new Error("Unrecognized sheet type "+l)}o[n]=I;var v=[],S=[];s&&s[n]&&Ft(s[n]).forEach(function(G){var X="";if(s[n][G].Type==lt.CMNT){if(X=di(s[n][G].Target,r),!(v=function dk(e,r,t){return".bin"===r.slice(-4)?function Zx(e,r){var t=[],n=[],i={},s=!1;return kn(e,function(l,g,u){switch(u){case 632:n.push(l);break;case 635:i=l;break;case 637:i.t=l.t,i.h=l.h,i.r=l.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,r.sheetRows&&i.rfx&&r.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,t.push(i);break;case 3072:case 37:case 38:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!g.T&&(!s||r.WTF))throw new Error("Unexpected record 0x"+u.toString(16))}}),t}(e,t):function Wx(e,r){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],n=[],i=ir(e,"authors");i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(o){if(""!==o&&""!==o.trim()){var l=o.match(/<(?:\w+:)?author[^<>]*>(.*)/);l&&t.push(l[1])}});var s=ir(e,"commentList");return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(o){if(""!==o&&""!==o.trim()){var l=o.match(/<(?:\w+:)?comment[^<>]*>/);if(l){var g=Me(l[0]),u={author:g.authorId&&t[g.authorId]||"sheetjsghost",ref:g.ref,guid:g.guid},h=Tt(g.ref);if(!(r.sheetRows&&r.sheetRows<=h.r)){var A=ir(o,"text"),C=!!A&&!!A[1]&&mo(A[1])||{r:"",t:"",h:""};u.r=C.r,"<t></t>"==C.r&&(C.t=C.h=""),u.t=(C.t||"").replace(/\r\n/g,"\n").replace(/\r/g,"\n"),r.cellHTML&&(u.h=C.h),n.push(u)}}}}),n}(e,t)}(Xt(e,X,!0),X,g))||!v.length)return;Bc(I,v,!1)}s[n][G].Type==lt.TCMNT&&(X=di(s[n][G].Target,r),S=S.concat(function zx(e,r){var t=[],n=!1,i={},s=0;return e.replace(cr,function(l,g){var u=Me(l);switch(Xr(u[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<threadedComment":i={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":null!=i.t&&t.push(i);break;case"<text>":case"<text":s=g+l.length;break;case"</text>":i.t=e.slice(s,g).replace(/\r\n/g,"\n").replace(/\r/g,"\n");break;case"<mentions":case"<mentions>":case"<ext":n=!0;break;case"</mentions>":case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return l}),t}(Xt(e,X,!0),g)))}),S&&S.length&&Bc(I,S,!0,g.people||[]),function Rw(e,r,t,n,i,s,o,l){if(e&&e["!legdrawel"]){var u=Sr(t,di(e["!legdrawel"].Target,n),!0);u&&function Vx(e,r,t){var n=0;(K0(e,"shape")||[]).forEach(function(i){var s="",o=!0,l=-1,g=-1,u=-1;if("Note"===(i.replace(cr,function(A,C){var I=Me(A);switch(Xr(I[0])){case"<ClientData":I.ObjectType&&(s=I.ObjectType);break;case"<Visible":case"<Visible/>":o=!1;break;case"<Row":case"<Row>":case"<Column":case"<Column>":l=C+A.length;break;case"</Row>":g=+i.slice(l,C).trim();break;case"</Column>":u=+i.slice(l,C).trim()}return""}),s)){var h=ya(r,g>=0&&u>=0?ht({r:g,c:u}):t[n].ref);h.c&&(h.c.hidden=o),++n}})}(yt(u),e,l||[])}}(I,0,e,r,0,0,0,v)}catch(G){if(g.WTF)throw G}}function Jr(e){return"/"==e.charAt(0)?e.slice(1):e}function Hg(e,r){if(jn(),$o(r=r||{}),Wr(e,"META-INF/manifest.xml")||Wr(e,"objectdata.xml"))return function Og(e,r){r=r||{},Wr(e,"META-INF/manifest.xml")&&function Pd(e,r){for(var n,i,t=Qa(e);n=zt.exec(t);)switch(n[3]){case"manifest":break;case"file-entry":if("/"==(i=Me(n[0],!1)).path&&i.type!==Nd)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw n}}(Xt(e,"META-INF/manifest.xml"),r);var t=Sr(e,"styles.xml"),n=t&&Pg(yt(t)),i=Sr(e,"content.xml");if(!i)throw new Error("Missing content.xml in ODS / UOF file");var s=Rg(yt(i),r,n);return Wr(e,"meta.xml")&&(s.Props=Gl(Xt(e,"meta.xml"))),s.bookType="ods",s}(e,r);if(Wr(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(e.FileIndex)return Go(e,r);var t=We.utils.cfb_new();return el(e).forEach(function(le){at(t,le,q0(e,le))}),Go(t,r)}if(!Wr(e,"[Content_Types].xml")){if(Wr(e,"index.xml.gz"))throw new Error("Unsupported NUMBERS 08 file");if(Wr(e,"index.xml"))throw new Error("Unsupported NUMBERS 09 file");var n=We.find(e,"Index.zip");if(n)return delete(r=xt(r)).type,"string"==typeof n.content&&(r.type="binary"),typeof Bun<"u"&&Buffer.isBuffer(n.content)?Ln(new Uint8Array(n.content),r):Ln(n.content,r);throw new Error("Unsupported ZIP file")}var l,g,i=el(e),s=function Dd(e){var r={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};if(!e||!e.match)return r;var t={};if((e.match(cr)||[]).forEach(function(n){var i=Me(n);switch(i[0].replace(Gp,"<")){case"<?xml":break;case"<Types":r.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[i.Extension.toLowerCase()]=i.ContentType;break;case"<Override":void 0!==r[lo[i.ContentType]]&&r[lo[i.ContentType]].push(i.PartName)}}),r.xmlns!==Qt.CT)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=t,delete r.calcchains,r}(Sr(e,"[Content_Types].xml")),o=!1;if(0===s.workbooks.length&&Xt(e,g="xl/workbook.xml",!0)&&s.workbooks.push(g),0===s.workbooks.length){if(!Xt(e,g="xl/workbook.bin",!0))throw new Error("Could not find workbook");s.workbooks.push(g),o=!0}"bin"==s.workbooks[0].slice(-3)&&(o=!0);var u={},h={};if(!r.bookSheets&&!r.bookProps){if(Ia=[],s.sst)try{Ia=function pk(e,r,t){return".bin"===r.slice(-4)?function o_(e,r){var t=[],n=!1;return kn(e,function(s,o,l){switch(l){case 159:t.Count=s[0],t.Unique=s[1];break;case 19:t.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(!n||r.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),t}(e,t):function n_(e,r){var t=[],n="";if(!e)return t;var i=ir(e,"sst");if(i){n=i[1].replace(t_,"").split(r_);for(var s=0;s!=n.length;++s){var o=mo(n[s].trim(),r);null!=o&&(t[t.length]=o)}i=Me(i[0].slice(0,i[0].indexOf(">"))),t.Count=i.count,t.Unique=i.uniqueCount}return t}(e,t)}(Xt(e,Jr(s.sst)),s.sst,r)}catch(le){if(r.WTF)throw le}r.cellStyles&&s.themes.length&&(u=Rc(Sr(e,s.themes[0].replace(/^\//,""),!0)||"",r)),s.style&&(h=function Ak(e,r,t,n){return".bin"===r.slice(-4)?function ix(e,r,t){var n={NumberFmt:[]};for(var i in Ve)n.NumberFmt[i]=Ve[i];n.CellXf=[],n.Fonts=[];var s=[],o=!1;return kn(e,function(g,u,h){switch(h){case 44:n.NumberFmt[g[0]]=g[1],Nn(g[1],g[0]);break;case 43:n.Fonts.push(g),null!=g.color.theme&&r&&r.themeElements&&r.themeElements.clrScheme&&(g.color.rgb=hs(r.themeElements.clrScheme[g.color.theme].rgb,g.color.tint||0));break;case 1025:case 45:case 46:case 48:case 507:case 572:case 475:case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 47:617==s[s.length-1]&&n.CellXf.push(g);break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(h),o=!0;break;case 38:s.pop(),o=!1;break;default:if(u.T>0)s.push(h);else if(u.T<0)s.pop();else if(!o||t.WTF&&37!=s[s.length-1])throw new Error("Unexpected record 0x"+h.toString(16))}}),n}(e,t,n):X_(e,t,n)}(Xt(e,Jr(s.style)),s.style,u,r))}s.links.map(function(le){try{return na(Sr(e,ra(Jr(le))),le),function _k(e,r,t,n){return".bin"===t.slice(-4)?function Gx(e,r,t,n){if(!e)return e;var i=n||{},s=!1;kn(e,function(g,u,h){switch(h){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!u.T&&(!s||i.WTF))throw new Error("Unexpected record 0x"+h.toString(16))}},i)}(e,0,0,n):void 0}(Xt(e,Jr(le)),0,le,r)}catch{}});var A=function fk(e,r,t){return".bin"===r.slice(-4)?function rk(e,r){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;r||(r={}),r.biff=12;var s=[],o=[[]];return o.SheetNames=[],o.XTI=[],_a[16]={n:"BrtFRTArchID$",f:q3},kn(e,function(g,u,h){switch(h){case 156:o.SheetNames.push(g.name),t.Sheets.push(g);break;case 153:t.WBProps=g;break;case 39:null!=g.Sheet&&(r.SID=g.Sheet),g.Ref=g.Ptg?xr(g.Ptg,0,null,o,r):"#REF!",delete r.SID,delete g.Ptg,s.push(g);break;case 1036:case 361:case 2071:case 158:case 143:case 664:case 353:case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:case 16:break;case 357:case 358:case 355:case 667:o[0].length?o.push([h,g]):o[0]=[h,g],o[o.length-1].XTI=[];break;case 362:0===o.length&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(g),o.XTI=o.XTI.concat(g);break;case 35:case 37:n.push(h),i=!0;break;case 36:case 38:n.pop(),i=!1;break;default:if(!u.T&&(!i||r.WTF&&37!=n[n.length-1]&&35!=n[n.length-1]))throw new Error("Unexpected record 0x"+h.toString(16))}},r),lg(t),t.Names=s,t.supbooks=o,t}(e,t):function H3(e,r){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},o=0;if(e.replace(cr,function(g,u){var h=Me(g);switch(Xr(h[0])){case"<?xml":case"</workbook>":case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":case"<bookViews":case"<bookViews>":case"</bookViews>":case"</workbookView>":case"<sheets":case"<sheets>":case"</sheets>":case"</sheet>":case"<functionGroups":case"<functionGroups/>":case"<functionGroup":case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":case"<definedName/>":case"</calcPr>":case"<oleSize":case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":case"<customWorkbookView":case"</customWorkbookView>":case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":case"<smartTagPr":case"<smartTagPr/>":case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":case"<webPublishing":case"<webPublishing/>":case"<fileRecoveryPr":case"<fileRecoveryPr/>":case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":case"<ArchID":case"<revisionPtr":break;case"<workbook":g.match(z3)&&(i="xmlns"+g.match(/<(\w+):/)[1]),t.xmlns=h[i];break;case"<fileVersion":delete h[0],t.AppVersion=h;break;case"<workbookPr":case"<workbookPr/>":No.forEach(function(A){if(null!=h[A[0]])switch(A[2]){case"bool":t.WBProps[A[0]]=kt(h[A[0]]);break;case"int":t.WBProps[A[0]]=parseInt(h[A[0]],10);break;default:t.WBProps[A[0]]=h[A[0]]}}),h.codeName&&(t.WBProps.CodeName=yt(h.codeName));break;case"<workbookView":case"<workbookView/>":delete h[0],t.WBView.push(h);break;case"<sheet":switch(h.state){case"hidden":h.Hidden=1;break;case"veryHidden":h.Hidden=2;break;default:h.Hidden=0}delete h.state,h.name=pt(yt(h.name)),delete h[0],t.Sheets.push(h);break;case"<definedNames>":case"<definedNames":case"<ext":case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</definedNames>":case"</ext>":case"</AlternateContent>":n=!1;break;case"<definedName":(s={}).Name=yt(h.name),h.comment&&(s.Comment=h.comment),h.localSheetId&&(s.Sheet=+h.localSheetId),kt(h.hidden||"0")&&(s.Hidden=!0),o=u+g.length;break;case"</definedName>":s.Ref=pt(yt(e.slice(o,u))),t.Names.push(s);break;case"<calcPr":case"<calcPr/>":delete h[0],t.CalcPr=h;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+h[0]+" in workbook")}return g}),-1===zn.indexOf(t.xmlns))throw new Error("Unknown Namespace: "+t.xmlns);return lg(t),t}(e,t)}(Xt(e,Jr(s.workbooks[0])),s.workbooks[0],r),C={},I="";s.coreprops.length&&((I=Xt(e,Jr(s.coreprops[0]),!0))&&(C=Gl(I)),0!==s.extprops.length&&(I=Xt(e,Jr(s.extprops[0]),!0))&&function Md(e,r,t){var n={};r||(r={}),e=yt(e),ei.forEach(function(i){var s=(ir(e,i[0])||[])[1];switch(i[2]){case"string":s&&(r[i[1]]=pt(s));break;case"bool":r[i[1]]="true"===s;break;case"raw":var o=Wn(e,i[0]);o&&o.length>0&&(n[i[1]]=o[1])}}),n.HeadingPairs&&n.TitlesOfParts&&$l(n.HeadingPairs,n.TitlesOfParts,r,t)}(I,C,r));var m={};(!r.bookSheets||r.bookProps)&&0!==s.custprops.length&&(I=Sr(e,Jr(s.custprops[0]),!0))&&(m=function Ud(e,r){var t={},n="",i=e.match(Ld);if(i)for(var s=0;s!=i.length;++s){var o=i[s],l=Me(o);switch(Xr(l[0])){case"<?xml":case"<Properties":break;case"<property":n=pt(l.name);break;case"</property>":n=null;break;default:if(0===o.indexOf("<vt:")){var g=o.split(">"),u=g[0].slice(4),h=g[1];switch(u){case"lpstr":case"bstr":case"lpwstr":case"cy":case"error":t[n]=pt(h);break;case"bool":t[n]=kt(h);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[n]=parseInt(h,10);break;case"r4":case"r8":case"decimal":t[n]=parseFloat(h);break;case"filetime":case"date":t[n]=Pt(h);break;default:if("/"==u.slice(-1))break;r.WTF&&typeof console<"u"&&console.warn("Unexpected",o,u,g)}}else if("</"!==o.slice(0,2)&&r.WTF)throw new Error(o)}}return t}(I,r));var _={};if((r.bookSheets||r.bookProps)&&(A.Sheets?l=A.Sheets.map(function(Pe){return Pe.name}):C.Worksheets&&C.SheetNames.length>0&&(l=C.SheetNames),r.bookProps&&(_.Props=C,_.Custprops=m),r.bookSheets&&typeof l<"u"&&(_.SheetNames=l),r.bookSheets?_.SheetNames:r.bookProps))return _;l={};var p={};r.bookDeps&&s.calcchain&&(p=function mk(e,r,t){return".bin"===r.slice(-4)?function Ux(e){var n=[];return kn(e,function(o,l,g){if(63===g)n.push(o);else if(!l.T)throw new Error("Unexpected record 0x"+g.toString(16))}),n}(e):function Mx(e){var r=[];if(!e)return r;var t=1;return(e.match(cr)||[]).forEach(function(n){var i=Me(n);switch(i[0]){case"<?xml":case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?t=i.i:i.i=t,r.push(i)}}),r}(e)}(Xt(e,Jr(s.calcchain)),s.calcchain));var v,S,d=0,w={},G=A.Sheets;C.Worksheets=G.length,C.SheetNames=[];for(var X=0;X!=G.length;++X)C.SheetNames[X]=G[X].name;var E=o?"bin":"xml",O=s.workbooks[0].lastIndexOf("/"),L=(s.workbooks[0].slice(0,O+1)+"_rels/"+s.workbooks[0].slice(O+1)+".rels").replace(/^\//,"");Wr(e,L)||(L="xl/_rels/workbook."+E+".rels");var W=na(Sr(e,L,!0),L.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(r.xlmeta=function xk(e,r,t){return".bin"===r.slice(-4)?function Px(e,r,t){var n={Types:[],Cell:[],Value:[]},i=t||{},s=[],o=!1,l=2;return kn(e,function(g,u,h){switch(h){case 335:n.Types.push({name:g.name});break;case 51:g.forEach(function(A){1==l?n.Cell.push({type:n.Types[A[0]-1].name,index:A[1]}):0==l&&n.Value.push({type:n.Types[A[0]-1].name,index:A[1]})});break;case 337:l=g?1:0;break;case 338:l=2;break;case 35:s.push(h),o=!0;break;case 36:s.pop(),o=!1;break;default:if(!u.T&&(!o||i.WTF&&35!=s[s.length-1]))throw new Error("Unexpected record 0x"+h.toString(16))}}),n}(e,0,t):function Ox(e,r,t){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var o,i=!1,s=2;return e.replace(cr,function(l){var g=Me(l);switch(Xr(g[0])){case"<?xml":case"<metadata":case"</metadata>":case"<metadataTypes":case"</metadataTypes>":case"</metadataType>":case"</futureMetadata>":case"<bk>":case"</bk>":case"</rc>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<metadataType":n.Types.push({name:g.name});break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==g.name&&(o=n.Types[u]);break;case"<rc":1==s?n.Cell.push({type:n.Types[g.t-1].name,index:+g.v}):0==s&&n.Value.push({type:n.Types[g.t-1].name,index:+g.v});break;case"<cellMetadata":s=1;break;case"</cellMetadata>":case"</valueMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+g.i);break;default:if(!i&&t?.WTF)throw new Error("unrecognized "+g[0]+" in metadata")}return l}),n}(e,0,t)}(Xt(e,Jr(s.metadata[0])),s.metadata[0],r)),(s.people||[]).length>=1&&(r.people=function Hx(e,r){var t=[],n=!1;return e.replace(cr,function(s){var o=Me(s);switch(Xr(o[0])){case"<?xml":case"<personList":case"</personList>":case"</person>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<person":t.push({name:o.displayname,id:o.id});break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&r.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return s}),t}(Xt(e,Jr(s.people[0])),r)),W&&(W=function Pw(e,r){if(!e)return 0;try{e=r.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,Nw(e["!id"][n.id].Type)]})}catch{return null}return e&&0!==e.length?e:null}(W,A.Sheets));var H=Xt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(d=0;d!=C.Worksheets;++d){var Y="sheet";if(W&&W[d]?(v="xl/"+W[d][1].replace(/[\/]?xl\//,""),Wr(e,v)||(v=W[d][1]),Wr(e,v)||(v=L.replace(/_rels\/[\S\s]*$/,"")+W[d][1]),Y=W[d][2]):v=(v="xl/worksheets/sheet"+(d+1-H)+"."+E).replace(/sheet0\./,"sheet."),S=v.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&null!=r.sheets)switch(typeof r.sheets){case"number":if(d!=r.sheets)continue e;break;case"string":if(C.SheetNames[d].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var ee=!1,Te=0;Te!=r.sheets.length;++Te)"number"==typeof r.sheets[Te]&&r.sheets[Te]==d&&(ee=1),"string"==typeof r.sheets[Te]&&r.sheets[Te].toLowerCase()==C.SheetNames[d].toLowerCase()&&(ee=1);if(!ee)continue e}}Ow(e,v,S,C.SheetNames[d],d,w,l,Y,r,A,u,h)}return _={Directory:s,Workbook:A,Props:C,Custprops:m,Deps:p,Sheets:l,SheetNames:C.SheetNames,Strings:Ia,Styles:h,Themes:u,SSF:xt(Ve)},r&&r.bookFiles&&(e.files?(_.keys=i,_.files=e.files):(_.keys=[],_.files={},e.FullPaths.forEach(function(le,Pe){le=le.replace(/^Root Entry[\/]/,""),_.keys.push(le),_.files[le]=e.FileIndex[Pe]}))),r&&r.bookVBA&&(s.vba.length>0?_.vbaraw=Xt(e,Jr(s.vba[0]),!0):s.defaults&&s.defaults.bin===qx&&(_.vbaraw=Xt(e,"xl/vbaProject.bin",!0))),_.bookType=o?"xlsb":"xlsx",_}function Bw(e,r){var t=r||{},n="Workbook",i=We.find(e,n);try{if(!(i=We.find(e,n="/!DataSpaces/Version"))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(function f_(e){var r={};r.id=e.read_shift(0,"lpp4"),r.R=yn(e,4),r.U=yn(e,4),r.W=yn(e,4)}(i.content),!(i=We.find(e,n="/!DataSpaces/DataSpaceMap"))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=function h_(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(u_(e));return r}(i.content);if(1!==s.length||1!==s[0].comps.length||0!==s[0].comps[0].t||"StrongEncryptionDataSpace"!==s[0].name||"EncryptedPackage"!==s[0].comps[0].v)throw new Error("ECMA-376 Encrypted file bad "+n);if(!(i=We.find(e,n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace"))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=function C_(e){var r=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)r.push(e.read_shift(0,"lpp4"));return r}(i.content);if(1!=o.length||"StrongEncryptionTransform"!=o[0])throw new Error("ECMA-376 Encrypted file bad "+n);if(!(i=We.find(e,n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary"))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);!function A_(e){var r=function I_(e){var r={};return e.read_shift(4),e.l+=4,r.id=e.read_shift(0,"lpp4"),r.name=e.read_shift(0,"lpp4"),r.R=yn(e,4),r.U=yn(e,4),r.W=yn(e,4),r}(e);if(r.ename=e.read_shift(0,"8lpp4"),r.blksz=e.read_shift(4),r.cmode=e.read_shift(4),4!=e.read_shift(4))throw new Error("Bad !Primary record");return r}(i.content)}catch{}if(!(i=We.find(e,n="/EncryptionInfo"))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=function p_(e){var r=yn(e);switch(r.Minor){case 2:return[r.Minor,d_(e)];case 3:return[r.Minor,m_()];case 4:return[r.Minor,__(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}(i.content);if(!(i=We.find(e,n="/EncryptedPackage"))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(4==l[0]&&typeof decrypt_agile<"u")return decrypt_agile(l[1],i.content,t.password||"",t);if(2==l[0]&&typeof decrypt_std76<"u")return decrypt_std76(l[1],i.content,t.password||"",t);throw new Error("File is password-protected")}function Yg(e,r){e&&!e.SSF&&(e.SSF=xt(Ve)),e&&e.SSF&&(jn(),pi(e.SSF),r.revssf=Hi(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Aa?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var t="xml",n=r2.indexOf(r.bookType)>-1,i={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};Wo(r=r||{});var s=js(),o="",l=0;if(r.cellXfs=[],fn(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),at(s,o="docProps/core.xml",jl(e.Props,r)),i.coreprops.push(o),wt(r.rels,2,o,lt.CORE_PROPS),o="docProps/app.xml",!e.Props||!e.Props.SheetNames)if(e.Workbook&&e.Workbook.Sheets){for(var g=[],u=0;u<e.SheetNames.length;++u)2!=(e.Workbook.Sheets[u]||{}).Hidden&&g.push(e.SheetNames[u]);e.Props.SheetNames=g}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,at(s,o,Wl(e.Props)),i.extprops.push(o),wt(r.rels,3,o,lt.EXT_PROPS),e.Custprops!==e.Props&&Ft(e.Custprops||{}).length>0&&(at(s,o="docProps/custom.xml",Xl(e.Custprops)),i.custprops.push(o),wt(r.rels,4,o,lt.CUST_PROPS));var h=["SheetJ5"];for(r.tcid=0,l=1;l<=e.SheetNames.length;++l){var A={"!id":{}},C=e.Sheets[e.SheetNames[l-1]];if(at(s,o="xl/worksheets/sheet"+l+"."+t,_4(l-1,r,e,A)),i.sheets.push(o),wt(r.wbrels,-1,"worksheets/sheet"+l+"."+t,lt.WS[0]),C){var m=C["!comments"],_=!1,p="";if(m&&m.length>0){var d=!1;m.forEach(function(w){w[1].forEach(function(v){1==v.T&&(d=!0)})}),d&&(at(s,p="xl/threadedComments/threadedComment"+l+".xml",Mc(m,h,r)),i.threadedcomments.push(p),wt(A,-1,"../threadedComments/threadedComment"+l+".xml",lt.TCMNT)),at(s,p="xl/comments"+l+"."+t,Xx(m)),i.comments.push(p),wt(A,-1,"../comments"+l+"."+t,lt.CMNT),_=!0}C["!legacy"]&&_&&at(s,"xl/drawings/vmlDrawing"+l+".vml",Oc(l,C["!comments"])),delete C["!comments"],delete C["!legacy"]}A["!id"].rId1&&at(s,ra(o),wi(A))}return null!=r.Strings&&r.Strings.length>0&&(at(s,o="xl/sharedStrings."+t,function a_(e,r){if(!r.bookSST)return"";var t=[Bt];t[t.length]=pe("sst",null,{xmlns:zn[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(null!=e[n]){var i=e[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),"string"!=typeof i.t&&(i.t=String(i.t)),i.t.match(i_)&&(s+=' xml:space="preserve"'),s+=">"+st(i.t)+"</t>"),t[t.length]=s+="</si>"}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}(r.Strings,r)),i.strs.push(o),wt(r.wbrels,-1,"sharedStrings."+t,lt.SST)),at(s,o="xl/workbook."+t,function Y3(e){var r=[Bt];r[r.length]=pe("workbook",null,{xmlns:zn[0],"xmlns:r":Qt.r});var t=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(No.forEach(function(l){null!=e.Workbook.WBProps[l[0]]&&e.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=e.Workbook.WBProps[l[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),r[r.length]=pe("workbookPr",null,n);var i=e.Workbook&&e.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(r[r.length]="<bookViews>",s=0;s!=e.SheetNames.length&&i[s]&&i[s].Hidden;++s);s==e.SheetNames.length&&(s=0),r[r.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',r[r.length]="</bookViews>"}for(r[r.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var o={name:st(e.SheetNames[s].slice(0,31))};if(o.sheetId=""+(s+1),o["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden"}r[r.length]=pe("sheet",null,o)}return r[r.length]="</sheets>",t&&(r[r.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(l){var g={name:l.Name};l.Comment&&(g.comment=l.Comment),null!=l.Sheet&&(g.localSheetId=""+l.Sheet),l.Hidden&&(g.hidden="1"),l.Ref&&(r[r.length]=pe("definedName",st(l.Ref),g))}),r[r.length]="</definedNames>"),r.length>2&&(r[r.length]="</workbook>",r[1]=r[1].replace("/>",">")),r.join("")}(e)),i.workbooks.push(o),wt(r.rels,1,o,lt.WB),at(s,o="xl/theme/theme1.xml",wo(e.Themes,r)),i.themes.push(o),wt(r.wbrels,-1,"theme/theme1.xml",lt.THEME),at(s,o="xl/styles."+t,function z_(e,r){var n,t=[Bt,pe("styleSheet",null,{xmlns:zn[0],"xmlns:vt":Qt.vt})];return e.SSF&&null!=(n=function V_(e){var r=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var n=t[0];n<=t[1];++n)null!=e[n]&&(r[r.length]=pe("numFmt",null,{numFmtId:n,formatCode:st(e[n])}))}),1===r.length?"":(r[r.length]="</numFmts>",r[0]=pe("numFmts",null,{count:r.length-2}).replace("/>",">"),r.join(""))}(e.SSF))&&(t[t.length]=n),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=function W_(e){var r=[];return r[r.length]=pe("cellXfs",null),e.forEach(function(t){r[r.length]=pe("xf",null,t)}),r[r.length]="</cellXfs>",2===r.length?"":(r[0]=pe("cellXfs",null,{count:r.length-2}).replace("/>",">"),r.join(""))}(r.cellXfs))&&(t[t.length]=n),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}(e,r)),i.styles.push(o),wt(r.wbrels,-1,"styles."+t,lt.STY),e.vbaraw&&n&&(at(s,o="xl/vbaProject.bin",e.vbaraw),i.vba.push(o),wt(r.wbrels,-1,"vbaProject.bin",lt.VBA)),at(s,o="xl/metadata."+t,function Bx(){var e=[Bt];return e.push('<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">\n  <metadataTypes count="1">\n    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>\n  </metadataTypes>\n  <futureMetadata name="XLDAPR" count="1">\n    <bk>\n      <extLst>\n        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">\n          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>\n        </ext>\n      </extLst>\n    </bk>\n  </futureMetadata>\n  <cellMetadata count="1">\n    <bk>\n      <rc t="1" v="0"/>\n    </bk>\n  </cellMetadata>\n</metadata>'),e.join("")}()),i.metadata.push(o),wt(r.wbrels,-1,"metadata."+t,lt.XLMETA),h.length>1&&(at(s,o="xl/persons/person.xml",Lc(h)),i.people.push(o),wt(r.wbrels,-1,"persons/person.xml",lt.PEOPLE)),at(s,"[Content_Types].xml",Ml(i,r)),at(s,"_rels/.rels",wi(r.rels)),at(s,"xl/_rels/workbook.xml.rels",wi(r.wbrels)),delete r.revssf,delete r.ssf,s}function Xo(e,r){var t="";switch((r||{}).type||"base64"){case"buffer":case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=Br(e.slice(0,12));break;case"binary":t=e;break;default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function Jg(e,r){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return Ro(e.slice(t),r);default:break e}return Ti.to_workbook(e,r)}function zo(e,r,t,n){return n?(t.type="string",Ti.to_workbook(e,t)):Ti.to_workbook(r,t)}function Ln(e,r){Va();var t=r||{};if(t.codepage&&typeof gt>"u"&&console.error("Codepage tables are not loaded.  Non-ASCII characters may not give expected results"),typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Ln(new Uint8Array(e),((t=xt(t)).type="array",t));if(typeof Int8Array<"u"&&e instanceof Int8Array)return Ln(new Uint8Array(e.buffer,e.byteOffset,e.length),t);typeof Uint8Array<"u"&&e instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var i,n=e,s=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),Ei={},t.dateNF&&(Ei.dateNF=t.dateNF),t.type||(t.type=ft&&Buffer.isBuffer(e)?"buffer":"base64"),"file"==t.type&&(t.type=ft?"buffer":"binary",n=function _p(e){if(typeof _n<"u")return _n.readFileSync(e);if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var r=File(e);r.open("r"),r.encoding="binary";var t=r.read();return r.close(),t}catch(n){if(!n.message||-1==n.message.indexOf("onstruct"))throw n}throw new Error("Cannot access file "+e)}(e),typeof Uint8Array<"u"&&!ft&&(t.type="array")),"string"==t.type&&(s=!0,t.type="binary",t.codepage=65001,n=function Vw(e){return e.match(/[^\x00-\x7F]/)?cn(e):e}(e)),"array"==t.type&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),l=new Uint8Array(o);if(l.foo="bar",!l.foo)return(t=xt(t)).type="array",Ln(Ps(n),t)}switch((i=Xo(n,t))[0]){case 208:if(207===i[1]&&17===i[2]&&224===i[3]&&161===i[4]&&177===i[5]&&26===i[6]&&225===i[7])return function Lw(e,r){return We.find(e,"EncryptedPackage")?Bw(e,r):Oo(e,r)}(We.read(n,t),t);break;case 9:if(i[1]<=8)return Oo(n,t);break;case 60:return Ro(n,t);case 73:if(73===i[1]&&42===i[2]&&0===i[3])throw new Error("TIFF Image File is not a spreadsheet");if(68===i[1])return function Jm(e,r){var t=r||{},n=!!t.WTF;t.WTF=!0;try{var i=kc.to_workbook(e,t);return t.WTF=n,i}catch(s){if(t.WTF=n,-1==s.message.indexOf("SYLK bad record ID")&&n)throw s;return Ti.to_workbook(e,r)}}(n,t);break;case 84:if(65===i[1]&&66===i[2]&&76===i[3])return wc.to_workbook(n,t);break;case 80:return 75===i[1]&&i[2]<9&&i[3]<9?function Uw(e,r){var n=e,i=r||{};return i.type||(i.type=ft&&Buffer.isBuffer(e)?"buffer":"base64"),Hg(tl(n,i),i)}(n,t):zo(e,n,t,s);case 239:return 60===i[3]?Ro(n,t):zo(e,n,t,s);case 255:if(254===i[1])return function jw(e,r){var t=e;return"base64"==r.type&&(t=Br(t)),typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer&&(t=new Uint8Array(e)),t=typeof gt<"u"?gt.utils.decode(1200,t.slice(2),"str"):ft&&Buffer.isBuffer(e)?e.slice(2).toString("utf16le"):typeof Uint8Array<"u"&&t instanceof Uint8Array?typeof TextDecoder<"u"?new TextDecoder("utf-16le").decode(t.slice(2)):function VA(e){for(var r=[],t=0;t<e.length>>1;++t)r[t]=String.fromCharCode(e[2*t]+(e[2*t+1]<<8));return r.join("")}(t.slice(2)):y0(t.slice(2)),r.type="binary",Jg(t,r)}(n,t);if(0===i[1]&&2===i[2]&&0===i[3])return ii.to_workbook(n,t);break;case 0:if(0===i[1]&&(i[2]>=2&&0===i[3]||0===i[2]&&(8===i[3]||9===i[3])))return ii.to_workbook(n,t);break;case 3:case 131:case 139:case 140:return po.to_workbook(n,t);case 123:if(92===i[1]&&114===i[2]&&116===i[3])return function E_(e,r){var t=Pn(function b_(e,r){switch(r.type){case"base64":return us(Br(e),r);case"binary":return us(e,r);case"buffer":return us(ft&&Buffer.isBuffer(e)?e.toString("binary"):sn(e),r);case"array":return us(Vn(e),r)}throw new Error("Unrecognized type "+r.type)}(e,r),r);return t.bookType="rtf",t}(n,t);break;case 10:case 13:case 32:return function Gw(e,r){var t="",n=Xo(e,r);switch(r.type){case"base64":t=Br(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=Vn(e);break;default:throw new Error("Unrecognized type "+r.type)}return 239==n[0]&&187==n[1]&&191==n[2]&&(t=yt(t)),r.type="binary",Jg(t,r)}(n,t);case 137:if(80===i[1]&&78===i[2]&&71===i[3])throw new Error("PNG Image File is not a spreadsheet");break;case 8:if(231===i[1])throw new Error("Unsupported Multiplan 1.x file!");break;case 12:if(236===i[1])throw new Error("Unsupported Multiplan 2.x file!");if(237===i[1])throw new Error("Unsupported Multiplan 3.x file!")}return Ym.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?po.to_workbook(n,t):zo(e,n,t,s)}function Zg(e,r){switch(r.type){case"base64":case"binary":break;case"buffer":case"array":r.type="";break;case"file":return zi(r.file,We.write(e,{type:ft?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");default:throw new Error("Unrecognized type "+r.type)}return We.write(e,r)}function $w(e,r){switch(r.bookType){case"ods":return Ug(e,r);case"numbers":return function Sw(e,r){if(!r||!r.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=We.read(r.numbers,{type:"base64"}),n=function Tw(e){var r={},t=[];return e.FileIndex.map(function(n,i){return[n,e.FullPaths[i]]}).forEach(function(n){var i=n[0],s=n[1];2==i.type&&i.name.match(/\.iwa/)&&0==i.content[0]&&ka(wa(i.content)).forEach(function(o){t.push(o.id),r[o.id]={deps:[],location:s,type:ct(o.messages[0].meta[1][0].data)}})}),e.FileIndex.forEach(function(n){n.name.match(/\.iwa/)&&0==n.content[0]&&ka(wa(n.content)).forEach(function(i){i.messages.forEach(function(s){[5,6].forEach(function(o){s.meta[o]&&s.meta[o].forEach(function(l){r[i.id].deps.push(ct(l.data))})})})})}),r}(t),i=Cn(t,n,1);if(null==i)throw"Could not find message ".concat(1," in Numbers template");var s=Mn(me(i.messages[0].data)[1],It);if(s.length>1)throw new Error("Template NUMBERS file must have exactly one sheet");return e.SheetNames.forEach(function(o,l){l>=1&&(function Ew(e,r,t){var n=-1,i=-1,s={};St(e,r,1,function(g,u){var h=me(g.messages[0].data);n=It(me(g.messages[0].data)[1][0].data),i=hn({deps:[1],location:r[n].location,type:2},r),s[n]=i,kr(g,i),h[1].push({type:2,data:vr(i)});var A=Cn(e,r,n);A.id=i,r[1].location==r[i].location?u.push(A):St(e,r,i,function(C,I){return I.push(A)}),g.messages[0].data=$e(h)});var o=-1;St(e,r,i,function(g,u){for(var h=me(g.messages[0].data),A=3;A<=69;++A)delete h[A];var C=Mn(h[2],It);C.forEach(function(m){return bn(g,m)}),o=hn({deps:[i],location:r[C[0]].location,type:r[C[0]].type},r),kr(g,o),s[C[0]]=o,h[2]=[{type:2,data:vr(o)}];var I=Cn(e,r,C[0]);I.id=o,r[C[0]].location==r[i].location?u.push(I):(St(e,r,2,function(m){var _=me(m.messages[0].data);Pr(_,r,i,o),m.messages[0].data=$e(_)}),St(e,r,o,function(m,_){return _.push(I)})),g.messages[0].data=$e(h)});var l=-1;St(e,r,o,function(g,u){for(var h=me(g.messages[0].data),A=me(h[1][0].data),C=3;C<=69;++C)delete A[C];var I=It(A[2][0].data);A[2][0].data=vr(s[I]),h[1][0].data=$e(A);var m=It(h[2][0].data);bn(g,m),kr(g,l=hn({deps:[o],location:r[m].location,type:r[m].type},r)),s[m]=l,h[2][0].data=vr(l);var _=Cn(e,r,m);_.id=l,r[o].location==r[l].location?u.push(_):St(e,r,l,function(p,d){return d.push(_)}),g.messages[0].data=$e(h)}),St(e,r,l,function(g,u){var h,A,C=me(g.messages[0].data),m=tn(C[1][0].data).replace(/-[A-Z0-9]*/,"-".concat(("0000"+t.toString(16)).slice(-4)));if(C[1][0].data=br(m),[12,13,29,31,32,33,39,44,47,81,82,84].forEach(function(G){return delete C[G]}),C[45]){var p=It(me(C[45][0].data)[1][0].data);bn(g,p),delete C[45]}C[70]&&(null==(h=me(C[70][0].data)[2])||h.forEach(function(G){var X=me(G.data);[2,3].map(function(E){return X[E][0]}).forEach(function(E){var O=me(E.data);if(O[8]){var L=It(O[8][0].data);bn(g,L)}})}),delete C[70]),[46,30,34,35,36,38,48,49,60,61,62,63,64,71,72,73,74,75,85,86,87,88,89].forEach(function(G){if(C[G]){var X=It(C[G][0].data);delete C[G],bn(g,X)}});var w=me(C[4][0].data);[2,4,5,6,11,12,13,15,16,17,18,19,20,21,22].forEach(function(G){var X;if(null!=(X=w[G])&&X[0]){var E=It(w[G][0].data),O=hn({deps:[l],location:r[E].location,type:r[E].type},r);bn(g,E),kr(g,O),s[E]=O;var L=Cn(e,r,E);if(L.id=O,r[E].location==r[l].location)u.push(L);else{r[O].location=r[E].location.replace(E.toString(),O.toString()),r[O].location==r[E].location&&(r[O].location=r[O].location.replace(/\.iwa/,"-".concat(O,".iwa"))),We.utils.cfb_add(e,r[O].location,Di(Fi([L])));var W=r[O].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,"");St(e,r,2,function(H){var Y=me(H.messages[0].data);Vo(Y,O,W),Pr(Y,r,l,O),H.messages[0].data=$e(Y)})}w[G][0].data=vr(O)}});var v=me(w[1][0].data);null==(A=v[2])||A.forEach(function(G){var X=It(G.data),E=hn({deps:[l],location:r[X].location,type:r[X].type},r);bn(g,X),kr(g,E),s[X]=E;var O=Cn(e,r,X);if(O.id=E,r[X].location==r[l].location)u.push(O);else{r[E].location=r[X].location.replace(X.toString(),E.toString()),r[E].location==r[X].location&&(r[E].location=r[E].location.replace(/\.iwa/,"-".concat(E,".iwa"))),We.utils.cfb_add(e,r[E].location,Di(Fi([O])));var L=r[E].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,"");St(e,r,2,function(W){var H=me(W.messages[0].data);Vo(H,E,L),Pr(H,r,l,E),W.messages[0].data=$e(H)})}G.data=vr(E)}),w[1][0].data=$e(v);var S=me(w[3][0].data);S[1].forEach(function(G){var X=me(G.data),E=It(X[2][0].data),O=s[E];if(!s[E]){O=hn({deps:[l],location:"",type:r[E].type},r),r[O].location="Root Entry/Index/Tables/Tile-".concat(O,".iwa"),s[E]=O;var L=Cn(e,r,E);L.id=O,bn(g,E),kr(g,O),We.utils.cfb_add(e,"/Index/Tables/Tile-".concat(O,".iwa"),Di(Fi([L]))),St(e,r,2,function(W){var H=me(W.messages[0].data);H[3].push({type:2,data:$e([[],[{type:0,data:je(O)}],[{type:2,data:br("Tables/Tile")}],[{type:2,data:br("Tables/Tile-".concat(O))}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:je(0)}],[],[{type:0,data:je(0)}]])}),H[1]=[{type:0,data:je(Math.max(O+1,ct(H[1][0].data)))}],Pr(H,r,l,O),W.messages[0].data=$e(H)})}X[2][0].data=vr(O),G.data=$e(X)}),w[3][0].data=$e(S),C[4][0].data=$e(w),g.messages[0].data=$e(C)})}(t,n,l+1),i=Cn(t,n,1),s=Mn(me(i.messages[0].data)[1],It)),function Fw(e,r,t,n,i,s){var o=[];St(e,r,s,function(u){var h=me(u.messages[0].data);h[1]=[{type:2,data:br(n)}],o=Mn(h[2],It),u.messages[0].data=$e(h)});var g=It(me(Cn(e,r,o[0]).messages[0].data)[2][0].data);St(e,r,g,function(u,h){return function Dw(e,r,t,n,i,s){if(!t["!ref"])throw new Error("Cannot export empty sheet to NUMBERS");var o=Ht(t["!ref"]);o.s.r=o.s.c=0;var l=!1;o.e.c>999&&(l=!0,o.e.c=999),o.e.r>999999&&(l=!0,o.e.r=999999),l&&console.error("Truncating to ".concat(ot(o)));var g=[];if(t["!data"])g=t["!data"];else{for(var u=[],h=0;h<=o.e.c;++h)u[h]=rt(h);for(var A=0;A<=o.e.r;++A){g[A]=[];var C=""+(A+1);for(h=0;h<=o.e.c;++h){var I=t[u[h]+C];I&&(g[A][h]=I)}}}var m={cmnt:[{a:"~54ee77S~",t:"... the people who are crazy enough to think they can change the world, are the ones who do."}],ferr:[],fmla:[],nfmt:[],ofmt:[],rsst:[{v:"~54ee77S~",l:"https://sheetjs.com/"}],sst:["~Sh33tJ5~"]},_=me(n.messages[0].data);_[6][0].data=je(o.e.r+1),_[7][0].data=je(o.e.c+1),delete _[46];var p=me(_[4][0].data),d=It(me(p[1][0].data)[2][0].data);St(e,r,d,function(re,he){var Ce,Ue=me(re.messages[0].data);if(null!=(Ce=Ue?.[2])&&Ce[0])for(var ve=0;ve<g.length;++ve){var Ne=me(Ue[2][0].data);Ne[1][0].data=je(ve),Ne[4][0].data=je(g[ve].length),Ue[2][ve]={type:Ue[2][0].type,data:$e(Ne)}}re.messages[0].data=$e(Ue)});var w=It(p[2][0].data);St(e,r,w,function(re,he){for(var Ce=me(re.messages[0].data),Ue=0;Ue<=o.e.c;++Ue){var ve=me(Ce[2][0].data);ve[1][0].data=je(Ue),ve[4][0].data=je(o.e.r+1),Ce[2][Ue]={type:Ce[2][0].type,data:$e(ve)}}re.messages[0].data=$e(Ce)});var v=me(p[9][0].data);v[1]=[];var S=me(p[3][0].data),G=256;S[2]=[{type:0,data:je(G)}];var Ce,X=It(me(S[1][0].data)[2][0].data),E=(Ce=me(Cn(e,r,2).messages[0].data)[3].filter(function(Ue){return ct(me(Ue.data)[1][0].data)==X}),Ce?.length?ct(me(Ce[0].data)[12][0].data):0);We.utils.cfb_del(e,r[X].location),St(e,r,2,function(re){var he=me(re.messages[0].data);he[3]=he[3].filter(function(Ce){return ct(me(Ce.data)[1][0].data)!=X}),function bw(e,r,t,n){var i=r[t].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,""),s=e[3].findIndex(function(l){var g,u,h=me(l.data);return null!=(g=h[3])&&g[0]?tn(h[3][0].data)==i:!(null==(u=h[2])||!u[0]||tn(h[2][0].data)!=i)}),o=me(e[3][s].data);o[6]||(o[6]=[]),o[6]=o[6].filter(function(l){return ct(me(l.data)[1][0].data)!=n}),e[3][s].data=$e(o)}(he,r,s,X),re.messages[0].data=$e(he)}),bn(n,X),S[1]=[];for(var O=Math.ceil((o.e.r+1)/G),L=0;L<O;++L){var W=hn({deps:[],location:"",type:6002},r);r[W].location="Root Entry/Index/Tables/Tile-".concat(W,".iwa");for(var H=[[],[{type:0,data:je(0)}],[{type:0,data:je(Math.min(o.e.r+1,(L+1)*G))}],[{type:0,data:je(0)}],[{type:0,data:je(Math.min((L+1)*G,o.e.r+1)-L*G)}],[],[{type:0,data:je(5)}],[{type:0,data:je(1)}],[{type:0,data:je(Xg?1:0)}]],Y=L*G;Y<=Math.min(o.e.r,(L+1)*G-1);++Y){var ee=yw(g[Y],m,Xg);ee[1][0].data=je(Y-L*G),H[5].push({data:$e(ee),type:2})}S[1].push({type:2,data:$e([[],[{type:0,data:je(L)}],[{type:2,data:vr(W)}]])});var le=Di(Fi([{id:W,messages:[jo(6002,$e(H))]}]));We.utils.cfb_add(e,"/Index/Tables/Tile-".concat(W,".iwa"),le),St(e,r,2,function(re){var he=me(re.messages[0].data);he[3].push({type:2,data:$e([[],[{type:0,data:je(W)}],[{type:2,data:br("Tables/Tile")}],[{type:2,data:br("Tables/Tile-".concat(W))}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:je(0)}],[],[{type:0,data:je(E)}]])}),he[1]=[{type:0,data:je(Math.max(W+1,ct(he[1][0].data)))}],Pr(he,r,s,W),re.messages[0].data=$e(he)}),kr(n,W),v[1].push({type:2,data:$e([[],[{type:0,data:je(L*G)}],[{type:0,data:je(L)}]])})}if(p[3][0].data=$e(S),p[9][0].data=$e(v),p[10]=[{type:2,data:new Uint8Array([])}],t["!merges"]){var Pe=hn({type:6144,deps:[s],location:r[s].location},r);i.push({id:Pe,messages:[jo(6144,$e([[],t["!merges"].map(function(re){return{type:2,data:$e([[],[{type:2,data:$e([[],[{type:5,data:new Uint8Array(new Uint16Array([re.s.r,re.s.c]).buffer)}]])}],[{type:2,data:$e([[],[{type:5,data:new Uint8Array(new Uint16Array([re.e.r-re.s.r+1,re.e.c-re.s.c+1]).buffer)}]])}]])}})]))]}),p[13]=[{type:2,data:vr(Pe)}],St(e,r,2,function(re){var he=me(re.messages[0].data);Pr(he,r,s,Pe),re.messages[0].data=$e(he)}),kr(n,Pe)}else delete p[13];var ce=It(p[4][0].data);St(e,r,ce,function(re){var he=me(re.messages[0].data);he[3]=[],m.sst.forEach(function(Ce,Ue){0!=Ue&&he[3].push({type:2,data:$e([[],[{type:0,data:je(Ue)}],[{type:0,data:je(1)}],[{type:2,data:br(Ce)}]])})}),re.messages[0].data=$e(he)});var Re=It(p[17][0].data);if(St(e,r,Re,function(re){var he=me(re.messages[0].data);he[3]=[];var Ce=[904980,903835,903815,903845];m.rsst.forEach(function(Ue,ve){if(0!=ve){var Ne=[[],[{type:0,data:new Uint8Array([5])}],[],[{type:2,data:br(Ue.v)}]];Ne[10]=[{type:0,data:new Uint8Array([1])}],Ne[19]=[{type:2,data:new Uint8Array([10,6,8,0,18,2,101,110])}],Ne[5]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,155,149,55])}],Ne[2]=[{type:2,data:new Uint8Array([8,148,158,55])}],Ne[6]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}],Ne[7]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,135,149,55])}],Ne[8]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,165,149,55])}],Ne[14]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}],Ne[24]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}];var D=hn({deps:[],location:"",type:2001},r),z=[];if(Ue.l){var j=li(e,2032,[[],[],[{type:2,data:br(Ue.l)}]],"/Index/Tables/DataList",r);Ne[11]=[];var U=[[],[]];U[1]||(U[1]=[]),U[1].push({type:2,data:$e([[],[{type:0,data:je(0)}],[{type:2,data:vr(j)}]])}),Ne[11][0]={type:2,data:$e(U)},z.push(j)}li(e,2001,Ne,"/Index/Tables/DataList",r,D),St(e,r,D,function(N){Ce.forEach(function(De){return kr(N,De)}),z.forEach(function(De){return kr(N,De)})});var ae=li(e,6218,[[],[{type:2,data:vr(D)}],[],[{type:2,data:new Uint8Array([13,255,255,255,0,18,10,16,255,255,1,24,255,255,255,255,7])}]],"/Index/Tables/DataList",r);St(e,r,ae,function(N){return kr(N,D)}),he[3].push({type:2,data:$e([[],[{type:0,data:je(ve)}],[{type:0,data:je(1)}],[],[],[],[],[],[],[{type:2,data:vr(ae)}]])}),kr(re,ae),St(e,r,2,function(N){var De=me(N.messages[0].data);Pr(De,r,Re,ae),Pr(De,r,ae,D),Pr(De,r,D,z),Pr(De,r,D,Ce),N.messages[0].data=$e(De)})}}),re.messages[0].data=$e(he)}),m.cmnt.length>1){var Xe=It(p[19][0].data),ue={},Ke=0;St(e,r,Xe,function(re){var he=me(re.messages[0].data);he[3]=[],m.cmnt.forEach(function(Ce,Ue){if(0!=Ue){var ve=[];Ce.replies&&Ce.replies.forEach(function(z){ue[z.a||""]||(ue[z.a||""]=li(e,212,[[],[{type:2,data:br(z.a||"")}],[{type:2,data:Wg(++Ke)}],[],[{type:0,data:je(0)}]],"/Index/Tables/DataList",r));var j=ue[z.a||""],U=li(e,3056,[[],[{type:2,data:br(z.t||"")}],[{type:2,data:$e([[],[{type:1,data:new Uint8Array([0,0,0,128,116,109,182,65])}]])}],[{type:2,data:vr(j)}]],"/Index/Tables/DataList",r);St(e,r,U,function(ae){return kr(ae,j)}),ve.push(U),St(e,r,2,function(ae){var N=me(ae.messages[0].data);Pr(N,r,U,j),ae.messages[0].data=$e(N)})}),ue[Ce.a||""]||(ue[Ce.a||""]=li(e,212,[[],[{type:2,data:br(Ce.a||"")}],[{type:2,data:Wg(++Ke)}],[],[{type:0,data:je(0)}]],"/Index/Tables/DataList",r));var Ne=ue[Ce.a||""],D=li(e,3056,[[],[{type:2,data:br(Ce.t||"")}],[{type:2,data:$e([[],[{type:1,data:new Uint8Array([0,0,0,128,116,109,182,65])}]])}],[{type:2,data:vr(Ne)}],ve.map(function(z){return{type:2,data:vr(z)}}),[{type:2,data:$e([[],[{type:0,data:je(Ue)}],[{type:0,data:je(0)}]])}]],"/Index/Tables/DataList",r);St(e,r,D,function(z){kr(z,Ne),ve.forEach(function(j){return kr(z,j)})}),he[3].push({type:2,data:$e([[],[{type:0,data:je(Ue)}],[{type:0,data:je(1)}],[],[],[],[],[],[],[],[{type:2,data:vr(D)}]])}),kr(re,D),St(e,r,2,function(z){var j=me(z.messages[0].data);Pr(j,r,Xe,D),Pr(j,r,D,Ne),ve.length&&Pr(j,r,D,ve),z.messages[0].data=$e(j)})}}),he[2][0].data=je(m.cmnt.length+1),re.messages[0].data=$e(he)})}_[4][0].data=$e(p),n.messages[0].data=$e(_)}(e,r,t,u,h,g)})}(t,n,e.Sheets[o],o,0,s[l])}),t}(e,r);case"xlsb":return function Mw(e,r){e&&!e.SSF&&(e.SSF=xt(Ve)),e&&e.SSF&&(jn(),pi(e.SSF),r.revssf=Hi(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Aa?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var t="bin",i={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};Wo(r=r||{});var s=js(),o="",l=0;if(r.cellXfs=[],fn(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),at(s,o="docProps/core.xml",jl(e.Props,r)),i.coreprops.push(o),wt(r.rels,2,o,lt.CORE_PROPS),o="docProps/app.xml",!e.Props||!e.Props.SheetNames)if(e.Workbook&&e.Workbook.Sheets){for(var g=[],u=0;u<e.SheetNames.length;++u)2!=(e.Workbook.Sheets[u]||{}).Hidden&&g.push(e.SheetNames[u]);e.Props.SheetNames=g}else e.Props.SheetNames=e.SheetNames;e.Props.Worksheets=e.Props.SheetNames.length,at(s,o,Wl(e.Props)),i.extprops.push(o),wt(r.rels,3,o,lt.EXT_PROPS),e.Custprops!==e.Props&&Ft(e.Custprops||{}).length>0&&(at(s,o="docProps/custom.xml",Xl(e.Custprops)),i.custprops.push(o),wt(r.rels,4,o,lt.CUST_PROPS));var h=["SheetJ5"];for(r.tcid=0,l=1;l<=e.SheetNames.length;++l){var A={"!id":{}},C=e.Sheets[e.SheetNames[l-1]];if(at(s,o="xl/worksheets/sheet"+l+"."+t,R3(l-1,r,e,A)),i.sheets.push(o),wt(r.wbrels,-1,"worksheets/sheet"+l+"."+t,lt.WS[0]),C){var m=C["!comments"],_=!1,p="";if(m&&m.length>0){var d=!1;m.forEach(function(v){v[1].forEach(function(S){1==S.T&&(d=!0)})}),d&&(at(s,p="xl/threadedComments/threadedComment"+l+".xml",Mc(m,h,r)),i.threadedcomments.push(p),wt(A,-1,"../threadedComments/threadedComment"+l+".xml",lt.TCMNT)),at(s,p="xl/comments"+l+"."+t,Qx(m)),i.comments.push(p),wt(A,-1,"../comments"+l+"."+t,lt.CMNT),_=!0}C["!legacy"]&&_&&at(s,"xl/drawings/vmlDrawing"+l+".vml",Oc(l,C["!comments"])),delete C["!comments"],delete C["!legacy"]}A["!id"].rId1&&at(s,ra(o),wi(A))}return null!=r.Strings&&r.Strings.length>0&&(at(s,o="xl/sharedStrings."+t,function g_(e){var r=Ir();oe(r,159,function l_(e,r){return r||(r=J(8)),r.write_shift(4,e.Count),r.write_shift(4,e.Unique),r}(e));for(var t=0;t<e.length;++t)oe(r,19,c_(e[t]));return oe(r,160),r.end()}(r.Strings)),i.strs.push(o),wt(r.wbrels,-1,"sharedStrings."+t,lt.SST)),at(s,o="xl/workbook."+t,gk(e)),i.workbooks.push(o),wt(r.rels,1,o,lt.WB),at(s,o="xl/theme/theme1.xml",wo(e.Themes,r)),i.themes.push(o),wt(r.wbrels,-1,"theme/theme1.xml",lt.THEME),at(s,o="xl/styles."+t,Cx(e,r)),i.styles.push(o),wt(r.wbrels,-1,"styles."+t,lt.STY),e.vbaraw&&(at(s,o="xl/vbaProject.bin",e.vbaraw),i.vba.push(o),wt(r.wbrels,-1,"vbaProject.bin",lt.VBA)),at(s,o="xl/metadata."+t,function Rx(){var e=Ir();return oe(e,332),oe(e,334,Zr(1)),oe(e,335,function Sx(e){var r=J(12+2*e.name.length);return r.write_shift(4,e.flags),r.write_shift(4,e.version),tr(e.name,r),r.slice(0,r.l)}({name:"XLDAPR",version:12e4,flags:3496657072})),oe(e,336),oe(e,339,function Fx(e,r){var t=J(8+2*r.length);return t.write_shift(4,e),tr(r,t),t.slice(0,t.l)}(1,"XLDAPR")),oe(e,52),oe(e,35,Zr(514)),oe(e,4096,Zr(0)),oe(e,4097,Hr(1)),oe(e,36),oe(e,53),oe(e,340),oe(e,337,function Nx(e,r){var t=J(8);return t.write_shift(4,e),t.write_shift(4,r?1:0),t}(1,!0)),oe(e,51,function Ex(e){var r=J(4+8*e.length);r.write_shift(4,e.length);for(var t=0;t<e.length;++t)r.write_shift(4,e[t][0]),r.write_shift(4,e[t][1]);return r}([[1,0]])),oe(e,338),oe(e,333),e.end()}()),i.metadata.push(o),wt(r.wbrels,-1,"metadata."+t,lt.XLMETA),h.length>1&&(at(s,o="xl/persons/person.xml",Lc(h)),i.people.push(o),wt(r.wbrels,-1,"persons/person.xml",lt.PEOPLE)),at(s,"[Content_Types].xml",Ml(i,r)),at(s,"_rels/.rels",wi(r.rels)),at(s,"xl/_rels/workbook.bin.rels",wi(r.wbrels)),delete r.revssf,delete r.ssf,s}(e,r);default:return Yg(e,r)}}function In(e,r,t){t||(t="");var n=t+e;switch(r.type){case"base64":return Wa(cn(n));case"binary":return cn(n);case"string":return e;case"file":return zi(r.file,n,"utf8");case"buffer":return ft?an(n,"utf8"):typeof TextEncoder<"u"?(new TextEncoder).encode(n):In(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function vs(e,r){switch(r.type){case"string":case"base64":case"binary":for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return"base64"==r.type?Wa(t):"string"==r.type?yt(t):t;case"file":return zi(r.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+r.type)}}function ks(e,r){Va(),function gg(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");!function X3(e,r,t){e.forEach(function(n,i){cg(n);for(var s=0;s<i;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(t){var o=r&&r[i]&&r[i].CodeName||n;if(95==o.charCodeAt(0)&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}(e.SheetNames,e.Workbook&&e.Workbook.Sheets||[],!!e.vbaraw);for(var t=0;t<e.SheetNames.length;++t)zv(e.Sheets[e.SheetNames[t]],0,t);e.SheetNames.forEach(function(n,i){var s=e.Sheets[n];if(s&&s["!autofilter"]){var o;e.Workbook||(e.Workbook={}),e.Workbook.Names||(e.Workbook.Names=[]),e.Workbook.Names.forEach(function(g){"_xlnm._FilterDatabase"==g.Name&&g.Sheet==i&&(o=g)});var l=ea(n)+"!"+xi(s["!autofilter"].ref);o?o.Ref=l:e.Workbook.Names.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:l})}})}(e);var t=xt(r||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),"array"==t.type){t.type="binary";var n=ks(e,t);return t.type="array",$i(n)}var i=0;if(t.sheet&&(i="number"==typeof t.sheet?t.sheet:e.SheetNames.indexOf(t.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return In(function Pk(e,r){r||(r={}),e.SSF||(e.SSF=xt(Ve)),e.SSF&&(jn(),pi(e.SSF),r.revssf=Hi(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF,r.cellXfs=[],fn(r.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(function hg(e,r){var t=[];return e.Props&&t.push(function jd(e,r){var t=[];return Ft(fo).map(function(n){for(var i=0;i<wn.length;++i)if(wn[i][1]==n)return wn[i];for(i=0;i<ei.length;++i)if(ei[i][1]==n)return ei[i];throw n}).forEach(function(n){if(null!=e[n[1]]){var i=r&&r.Props&&null!=r.Props[n[1]]?r.Props[n[1]]:e[n[1]];"date"===n[2]&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"Z")),"number"==typeof i?i=String(i):!0===i||!1===i?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),t.push(gr(fo[n[1]]||n[1],i))}}),pe("DocumentProperties",t.join(""),{xmlns:qt.o})}(e.Props,r)),e.Custprops&&t.push(function Vd(e,r){var t=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return e&&Ft(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var o=0;o<wn.length;++o)if(s==wn[o][1])return;for(o=0;o<ei.length;++o)if(s==ei[o][1])return;for(o=0;o<t.length;++o)if(s==t[o])return;var l=e[s],g="string";"number"==typeof l?(g="float",l=String(l)):!0===l||!1===l?(g="boolean",l=l?"1":"0"):l=String(l),i.push(pe(al(s),l,{"dt:dt":g}))}}),r&&Ft(r).forEach(function(s){if(Object.prototype.hasOwnProperty.call(r,s)&&(!e||!Object.prototype.hasOwnProperty.call(e,s))){var o=r[s],l="string";"number"==typeof o?(l="float",o=String(o)):!0===o||!1===o?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),i.push(pe(al(s),o,{"dt:dt":l}))}}),"<"+n+' xmlns="'+qt.o+'">'+i.join("")+"</"+n+">"}(e.Props,e.Custprops)),t.join("")}(e,r)),t.push(function Cg(e){return(((e||{}).Workbook||{}).WBProps||{}).date1904?'<ExcelWorkbook xmlns="urn:schemas-microsoft-com:office:excel"><Date1904/></ExcelWorkbook>':""}(e)),t.push(""),t.push(function pg(e){if(!((e||{}).Workbook||{}).Names)return"";for(var r=e.Workbook.Names,t=[],n=0;n<r.length;++n){var i=r[n];null==i.Sheet&&(i.Name.match(/^_xlfn\./)||t.push(Ag(i)))}return pe("Names",t.join(""))}(e));for(var n=0;n<e.SheetNames.length;++n)t.push(pe("Worksheet",Nk(n,r,e),{"ss:Name":st(e.SheetNames[n])}));return t[2]=function Ig(e,r){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return r.cellXfs.forEach(function(n,i){var s=[];s.push(pe("NumberFormat",null,{"ss:Format":st(Ve[n.numFmtId])}));var o={"ss:ID":"s"+(21+i)};t.push(pe("Style",s.join(""),o))}),pe("Styles",t.join(""))}(0,r),Bt+pe("Workbook",t.join(""),{xmlns:qt.ss,"xmlns:o":qt.o,"xmlns:x":qt.x,"xmlns:ss":qt.ss,"xmlns:dt":qt.dt,"xmlns:html":qt.html})}(e,t),t);case"slk":case"sylk":return In(kc.from_sheet(e.Sheets[e.SheetNames[i]],t,e),t);case"htm":case"html":return In(Eg(e.Sheets[e.SheetNames[i]],t),t);case"txt":return function Hw(e,r){switch(r.type){case"base64":return function WA(e){for(var r="",t=0,n=0,i=0,s=0,o=0,l=0,g=0,u=0;u<e.length;)(t=e.charCodeAt(u++))>255&&(t=95),s=t>>2,(n=e.charCodeAt(u++))>255&&(n=95),o=(3&t)<<4|n>>4,(i=e.charCodeAt(u++))>255&&(i=95),l=(15&n)<<2|i>>6,g=63&i,isNaN(n)?l=g=64:isNaN(i)&&(g=64),r+=hr.charAt(s)+hr.charAt(o)+hr.charAt(l)+hr.charAt(g);return r}(e);case"binary":case"string":return e;case"file":return zi(r.file,e,"binary");case"buffer":return ft?an(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}(rf(e.Sheets[e.SheetNames[i]],t),t);case"csv":return In(Zo(e.Sheets[e.SheetNames[i]],t),t,"\ufeff");case"dif":return In(wc.from_sheet(e.Sheets[e.SheetNames[i]],t),t);case"dbf":return vs(po.from_sheet(e.Sheets[e.SheetNames[i]],t),t);case"prn":return In(Ti.from_sheet(e.Sheets[e.SheetNames[i]],t),t);case"rtf":return In(function F_(e){var t=["{\\rtf1\\ansi"];if(!e["!ref"])return t[0]+"}";for(var i,n=Ct(e["!ref"]),s=null!=e["!data"],o=[],l=n.s.r;l<=n.e.r;++l){t.push("\\trowd\\trautofit1");for(var g=n.s.c;g<=n.e.c;++g)t.push("\\cellx"+(g+1));for(t.push("\\pard\\intbl"),s&&(o=e["!data"][l]||[]),g=n.s.c;g<=n.e.c;++g){var u=ht({r:l,c:g});(i=s?o[g]:e[u])&&(null!=i.v||i.f&&!i.F)?(t.push(" "+(i.w||(gn(i),i.w)||"").replace(/[\r\n]/g,"\\par ")),t.push("\\cell")):t.push(" \\cell")}t.push("\\pard\\intbl\\row")}return t.join("")+"}"}(e.Sheets[e.SheetNames[i]]),t);case"eth":return In(yc.from_sheet(e.Sheets[e.SheetNames[i]],t),t);case"fods":return In(Ug(e,t),t);case"wk1":return vs(ii.sheet_to_wk1(e.Sheets[e.SheetNames[i]],t),t);case"wk3":return vs(ii.book_to_wk3(e,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),vs(kg(e,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),function zw(e,r){var t=r||{};return Zg(function Gk(e,r){var t=r||{},n=We.utils.cfb_new({root:"R"}),i="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":i="/Workbook",t.biff=8;break;case"biff5":i="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return We.utils.cfb_add(n,i,kg(e,t)),8==t.biff&&(e.Props||e.Custprops)&&function Uk(e,r){var o,t=[],n=[],i=[],s=0,l=H0(ao,"n"),g=H0(so,"n");if(e.Props)for(o=Ft(e.Props),s=0;s<o.length;++s)(Object.prototype.hasOwnProperty.call(l,o[s])?t:Object.prototype.hasOwnProperty.call(g,o[s])?n:i).push([o[s],e.Props[o[s]]]);if(e.Custprops)for(o=Ft(e.Custprops),s=0;s<o.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},o[s])||(Object.prototype.hasOwnProperty.call(l,o[s])?t:Object.prototype.hasOwnProperty.call(g,o[s])?n:i).push([o[s],e.Custprops[o[s]]]);var u=[];for(s=0;s<i.length;++s)Zl.indexOf(i[s][0])>-1||Vl.indexOf(i[s][0])>-1||null!=i[s][1]&&u.push(i[s]);n.length&&We.utils.cfb_add(r,"/\x05SummaryInformation",ec(n,ma.SI,g,so)),(t.length||u.length)&&We.utils.cfb_add(r,"/\x05DocumentSummaryInformation",ec(t,ma.DSI,l,ao,u.length?u:null,ma.UDI))}(e,n),8==t.biff&&e.vbaraw&&function t2(e,r){r.FullPaths.forEach(function(t,n){if(0!=n){var i=t.replace(/^[\/]*[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");"/"!==i.slice(-1)&&We.utils.cfb_add(e,i,r.FileIndex[n].content)}})}(n,We.read(e.vbaraw,{type:"string"==typeof e.vbaraw?"binary":"buffer"})),n}(e,t),t)}(e,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return function Ww(e,r){var t=xt(r||{});return function Qg(e,r){var t={},n=ft?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(r.compression&&(t.compression="DEFLATE"),r.password)t.type=n;else switch(r.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");case"buffer":case"file":t.type=n;break;default:throw new Error("Unrecognized type "+r.type)}var i=e.FullPaths?We.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!r.compression}):e.generate(t);if(typeof Deno<"u"&&"string"==typeof i){if("binary"==r.type||"base64"==r.type)return i;i=new Uint8Array($i(i))}return r.password&&typeof encrypt_agile<"u"?Zg(encrypt_agile(i,r.password),r):"file"===r.type?zi(r.file,i):"string"==r.type?yt(i):i}($w(e,t),t)}(e,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function qg(e,r,t,n,i,s,o){var l=ut(t),g=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,A=null!=e["!data"],C=1===i?[]:{};if(1!==i)if(Object.defineProperty)try{Object.defineProperty(C,"__rowNum__",{value:t,enumerable:!1})}catch{C.__rowNum__=t}else C.__rowNum__=t;if(!A||e["!data"][t])for(var I=r.s.c;I<=r.e.c;++I){var m=A?(e["!data"][t]||[])[I]:e[n[I]+l];if(null!=m&&void 0!==m.t){var _=m.v;switch(m.t){case"z":if(null==_)break;continue;case"e":_=0==_?null:void 0;break;case"s":case"b":case"n":if(!m.z||!Mr(m.z)||"number"==typeof(_=xn(_)))break;case"d":o&&(o.UTC||!1===o.raw)||(_=$n(new Date(_)));break;default:throw new Error("unrecognized type "+m.t)}if(null!=s[I]){if(null==_)if("e"==m.t&&null===_)C[s[I]]=null;else if(void 0!==g)C[s[I]]=g;else{if(!u||null!==_)continue;C[s[I]]=null}else C[s[I]]=("n"===m.t&&"boolean"==typeof o.rawNumbers?o.rawNumbers:u)?_:gn(m,_,o);null!=_&&(h=!1)}}else{if(void 0===g)continue;null!=s[I]&&(C[s[I]]=g)}}return{row:C,isempty:h}}function Ko(e,r){if(null==e||null==e["!ref"])return[];var t={t:"n",v:0},n=0,i=1,s=[],o=0,l="",g={s:{r:0,c:0},e:{r:0,c:0}},u=r||{},h=null!=u.range?u.range:e["!ref"];switch(1===u.header?n=1:"A"===u.header?n=2:Array.isArray(u.header)?n=3:null==u.header&&(n=0),typeof h){case"string":g=Ct(h);break;case"number":(g=Ct(e["!ref"])).s.r=h;break;default:g=h}n>0&&(i=0);var A=ut(g.s.r),C=[],I=[],m=0,_=0,p=null!=e["!data"],d=g.s.r,w=0,v={};p&&!e["!data"][d]&&(e["!data"][d]=[]);var S=u.skipHidden&&e["!cols"]||[],G=u.skipHidden&&e["!rows"]||[];for(w=g.s.c;w<=g.e.c;++w)if(!(S[w]||{}).hidden)switch(C[w]=rt(w),t=p?e["!data"][d][w]:e[C[w]+A],n){case 1:s[w]=w-g.s.c;break;case 2:s[w]=C[w];break;case 3:s[w]=u.header[w-g.s.c];break;default:if(null==t&&(t={w:"__EMPTY",t:"s"}),l=o=gn(t,null,u),_=v[o]||0){do{l=o+"_"+_++}while(v[l]);v[o]=_,v[l]=1}else v[o]=1;s[w]=l}for(d=g.s.r+i;d<=g.e.r;++d)if(!(G[d]||{}).hidden){var X=qg(e,g,d,C,n,s,u);(!1===X.isempty||(1===n?!1!==u.blankrows:u.blankrows))&&(I[m++]=X.row)}return I.length=m,I}var ef=/"/g;function tf(e,r,t,n,i,s,o,l,g){for(var u=!0,h=[],A="",C=ut(t),I=null!=e["!data"],m=I&&e["!data"][t]||[],_=r.s.c;_<=r.e.c;++_)if(n[_]){var p=I?m[_]:e[n[_]+C];if(null==p)A="";else if(null!=p.v){u=!1,A=""+(g.rawNumbers&&"n"==p.t?p.v:gn(p,null,g));for(var d=0,w=0;d!==A.length;++d)if((w=A.charCodeAt(d))===i||w===s||34===w||g.forceQuotes){A='"'+A.replace(ef,'""')+'"';break}"ID"==A&&0==l&&0==h.length&&(A='"ID"')}else null==p.f||p.F?A="":(u=!1,(A="="+p.f).indexOf(",")>=0&&(A='"'+A.replace(ef,'""')+'"'));h.push(A)}if(g.strip)for(;""===h[h.length-1];)--h.length;return!1===g.blankrows&&u?null:h.join(o)}function Zo(e,r){var t=[],n=r??{};if(null==e||null==e["!ref"])return"";for(var i=Ct(e["!ref"]),s=void 0!==n.FS?n.FS:",",o=s.charCodeAt(0),l=void 0!==n.RS?n.RS:"\n",g=l.charCodeAt(0),u="",h=[],A=n.skipHidden&&e["!cols"]||[],C=n.skipHidden&&e["!rows"]||[],I=i.s.c;I<=i.e.c;++I)(A[I]||{}).hidden||(h[I]=rt(I));for(var m=0,_=i.s.r;_<=i.e.r;++_)(C[_]||{}).hidden||null!=(u=tf(e,i,_,h,o,g,s,m,n))&&(u||!1!==n.blankrows)&&t.push((m++?l:"")+u);return t.join("")}function rf(e,r){r||(r={}),r.FS="\t",r.RS="\n";var t=Zo(e,r);return typeof gt>"u"||"string"==r.type?t:"\xff\xfe"+gt.utils.encode(1200,t,"str")}function nf(e,r,t){var n=t||{},i=e?null!=e["!data"]:n.dense;null!=Gt&&null==i&&(i=Gt);var s=+!n.skipHeader,o=e||{};!e&&i&&(o["!data"]=[]);var l=0,g=0;if(o&&null!=n.origin)if("number"==typeof n.origin)l=n.origin;else{var u="string"==typeof n.origin?Tt(n.origin):n.origin;l=u.r,g=u.c}var h={s:{c:0,r:0},e:{c:g,r:l+r.length-1+s}};if(o["!ref"]){var A=Ct(o["!ref"]);h.e.c=Math.max(h.e.c,A.e.c),h.e.r=Math.max(h.e.r,A.e.r),-1==l&&(h.e.r=(l=A.e.r+1)+r.length-1+s)}else-1==l&&(l=0,h.e.r=r.length-1+s);var C=n.header||[],I=0,m=[];r.forEach(function(p,d){i&&!o["!data"][l+d+s]&&(o["!data"][l+d+s]=[]),i&&(m=o["!data"][l+d+s]),Ft(p).forEach(function(w){-1==(I=C.indexOf(w))&&(C[I=C.length]=w);var v=p[w],S="z",G="",X=i?"":rt(g+I)+ut(l+d+s),E=i?m[g+I]:o[X];!v||"object"!=typeof v||v instanceof Date?("number"==typeof v?S="n":"boolean"==typeof v?S="b":"string"==typeof v?S="s":v instanceof Date?(S="d",n.UTC||(v=Ka(v)),n.cellDates||(S="n",v=Ot(v)),G=null!=E&&E.z&&Mr(E.z)?E.z:n.dateNF||Ve[14]):null===v&&n.nullError&&(S="e",v=0),E?(E.t=S,E.v=v,delete E.w,delete E.R,G&&(E.z=G)):i?m[g+I]=E={t:S,v}:o[X]=E={t:S,v},G&&(E.z=G)):i?m[g+I]=v:o[X]=v})}),h.e.c=Math.max(h.e.c,g+C.length-1);var _=ut(l);if(i&&!o["!data"][l]&&(o["!data"][l]=[]),s)for(I=0;I<C.length;++I)i?o["!data"][l][I+g]={t:"s",v:C[I]}:o[rt(I+g)+_]={t:"s",v:C[I]};return o["!ref"]=ot(h),o}function ya(e,r,t){if("string"==typeof r){if(null!=e["!data"]){var n=Tt(r);return e["!data"][n.r]||(e["!data"][n.r]=[]),e["!data"][n.r][n.c]||(e["!data"][n.r][n.c]={t:"z"})}return e[r]||(e[r]={t:"z"})}return ya(e,"number"!=typeof r?ht(r):rt(t||0)+ut(r))}function Qo(e,r){var t={SheetNames:[],Sheets:{}};return e&&Ta(t,e,r||"Sheet1"),t}function Ta(e,r,t,n){var i=1;if(!t)for(;i<=65535&&-1!=e.SheetNames.indexOf(t="Sheet"+i);++i,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(t)>=0&&t.length<32){var s=t.match(/\d+$/);i=s&&+s[0]||0;var o=s&&t.slice(0,s.index)||t;for(++i;i<=65535&&-1!=e.SheetNames.indexOf(t=o+i);++i);}if(cg(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=r,t}function af(e,r,t){return r?(e.l={Target:r},t&&(e.l.Tooltip=t)):delete e.l,e}var Ni={encode_col:rt,encode_row:ut,encode_cell:ht,encode_range:ot,decode_col:eo,decode_row:qs,split_cell:function od(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:Tt,decode_range:Ht,format_cell:gn,sheet_new:function ld(e){var r={};return(e||{}).dense&&(r["!data"]=[]),r},sheet_add_aoa:El,sheet_add_json:nf,sheet_add_dom:Fg,aoa_to_sheet:vi,json_to_sheet:function Zw(e,r){return nf(null,e,r)},table_to_sheet:Dg,table_to_book:function aw(e,r){return Pn(Dg(e,r),r)},sheet_to_csv:Zo,sheet_to_txt:rf,sheet_to_json:Ko,sheet_to_html:Eg,sheet_to_formulae:function Kw(e,r){var n,t="",i="";if(null==e||null==e["!ref"])return[];var g,s=Ct(e["!ref"]),o="",l=[],u=[],h=null!=e["!data"];for(g=s.s.c;g<=s.e.c;++g)l[g]=rt(g);for(var A=s.s.r;A<=s.e.r;++A)for(o=ut(A),g=s.s.c;g<=s.e.c;++g)if(t=l[g]+o,i="",void 0!==(n=h?(e["!data"][A]||[])[g]:e[t])){if(null!=n.F){if(t=n.F,!n.f)continue;i=n.f,-1==t.indexOf(":")&&(t=t+":"+t)}if(null!=n.f)i=n.f;else{if(r&&!1===r.values)continue;if("z"==n.t)continue;if("n"==n.t&&null!=n.v)i=""+n.v;else if("b"==n.t)i=n.v?"TRUE":"FALSE";else if(void 0!==n.w)i="'"+n.w;else{if(void 0===n.v)continue;i="s"==n.t?"'"+n.v:""+n.v}}u[u.length]=t+"="+i}return u},sheet_to_row_object_array:Ko,sheet_get_cell:ya,book_new:Qo,book_append_sheet:Ta,book_set_sheet_visibility:function qw(e,r,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=function Qw(e,r){if("number"==typeof r){if(r>=0&&e.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}if("string"==typeof r){var t=e.SheetNames.indexOf(r);if(t>-1)return t;throw new Error("Cannot find sheet name |"+r+"|")}throw new Error("Cannot find sheet |"+r+"|")}(e,r);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[n].Hidden=t},cell_set_number_format:function ey(e,r){return e.z=r,e},cell_set_hyperlink:af,cell_set_internal_link:function ty(e,r,t){return af(e,"#"+r,t)},cell_add_comment:function ry(e,r,t){e.c||(e.c=[]),e.c.push({t:r,a:t||"SheetJS"})},sheet_set_array_formula:function ny(e,r,t,n){for(var i="string"!=typeof r?r:Ct(r),s="string"==typeof r?r:ot(r),o=i.s.r;o<=i.e.r;++o)for(var l=i.s.c;l<=i.e.c;++l){var g=ya(e,o,l);g.t="n",g.F=s,delete g.v,o==i.s.r&&l==i.s.c&&(g.f=t,n&&(g.D=!0))}var u=Ht(e["!ref"]);return u.s.r>i.s.r&&(u.s.r=i.s.r),u.s.c>i.s.c&&(u.s.c=i.s.c),u.e.r<i.e.r&&(u.e.r=i.e.r),u.e.c<i.e.c&&(u.e.c=i.e.c),e["!ref"]=ot(u),e},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},gy=Fe(9350),fy=Fe(7707);let qo=(()=>{class e{static{this.ResponseSeparatorToken="###RESPONSE###"}static{this.ApplicationSettingsID="ApplicationSettingsID"}static{this.SettingsStoreName="Settings"}constructor(t){this.dbService=t,this.models={llama:{messages:[],model:"meta-llama/Llama-3.3-70B-Instruct-Turbo-Free",max_tokens:2048,temperature:.7,top_p:.7,top_k:50,repetition_penalty:1,stop:["<|eot_id|>","<|eom_id|>"],stream:!1},deepseek:{messages:[],model:"deepseek-ai/DeepSeek-R1-Distill-Llama-70B-free",max_tokens:8192,temperature:.7,top_p:.7,top_k:50,repetition_penalty:1,stop:["<\uff5cend\u2581of\u2581sentence\uff5c>"],stream:!1}},this.apiKey=new Fr.t(void 0),t.getByID(e.SettingsStoreName,e.ApplicationSettingsID).pipe((0,Le.W)(n=>Nt.w)).subscribe(n=>{const i=n?.data?.togetherApiKey;this.apiKey.next(i)})}infere(t,n){var i=this;return(0,Ui.A)(function*(){const s=yield function uy(e,r){const t="object"==typeof r;return new Promise((n,i)=>{const s=new fy.Ms({next:o=>{n(o),s.unsubscribe()},error:i,complete:()=>{t?n(r.defaultValue):i(new gy.G)}});e.subscribe(s)})}(i.apiKey);if(!s)throw Error("\u041d\u0435 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d \u043a\u043b\u044e\u0447 API \u0434\u043b\u044f Together.AI");const o=Object.assign({},i.models[t],{messages:n}),l={method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify(o)};return yield fetch("https://api.together.xyz/v1/chat/completions",l).then(u=>u.json()).then(u=>{let h,A=u?.choices?.[0]?.message?.content;if(A){const C=A.lastIndexOf("</think>");C>=0&&(A=A.substring(C+8));const I=A.lastIndexOf(e.ResponseSeparatorToken),m=A.substring(0,I).lastIndexOf(e.ResponseSeparatorToken,I);let _;A=A.substring(m+e.ResponseSeparatorToken.length,I);try{_=JSON.parse(A),h={success:!0,data:_}}catch{h={success:!1,error:"\u041d\u0435\u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u043c\u044b\u0439 \u0444\u043e\u0440\u043c\u0430\u0442 \u043e\u0442\u0432\u0435\u0442\u0430: "+A}}}else h={success:!1,error:"\u041d\u0435\u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u043c\u044b\u0439 \u0444\u043e\u0440\u043c\u0430\u0442 \u043e\u0442\u0432\u0435\u0442\u0430: "+JSON.stringify(u)};return h})})()}static{this.\u0275fac=function(n){return new(n||e)(a.KVO(Qe.MX))}}static{this.\u0275prov=a.jDH({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();const hy=["mask"],Cy=["*"],Iy=e=>({"p-blockui-document":e,"p-blockui p-component-overlay p-component-overlay-enter":!0}),Ay=()=>({display:"none"});function py(e,r){1&e&&a.eu8(0)}let dy=(()=>{class e{document;el;cd;config;renderer;platformId;target;autoZIndex=!0;baseZIndex=0;styleClass;get blocked(){return this._blocked}set blocked(t){this.mask&&this.mask.nativeElement?t?this.block():this.unblock():this._blocked=t}templates;mask;_blocked=!1;animationEndListener;contentTemplate;constructor(t,n,i,s,o,l){this.document=t,this.el=n,this.cd=i,this.config=s,this.renderer=o,this.platformId=l}ngAfterViewInit(){if(this._blocked&&this.block(),this.target&&!this.target.getBlockableElement)throw"Target of BlockUI must implement BlockableUI interface"}ngAfterContentInit(){this.templates.forEach(t=>{t.getType(),this.contentTemplate=t.template})}block(){(0,Oe.UE)(this.platformId)&&(this._blocked=!0,this.mask.nativeElement.style.display="flex",this.target?(this.target.getBlockableElement().appendChild(this.mask.nativeElement),this.target.getBlockableElement().style.position="relative"):(this.renderer.appendChild(this.document.body,this.mask.nativeElement),qe.D.blockBodyScroll()),this.autoZIndex&&pn.Q$.set("modal",this.mask.nativeElement,this.baseZIndex+this.config.zIndex.modal))}unblock(){(0,Oe.UE)(this.platformId)&&this.mask&&!this.animationEndListener&&(this.animationEndListener=this.renderer.listen(this.mask.nativeElement,"animationend",this.destroyModal.bind(this)),qe.D.addClass(this.mask.nativeElement,"p-component-overlay-leave"))}destroyModal(){this._blocked=!1,this.mask&&(0,Oe.UE)(this.platformId)&&(pn.Q$.clear(this.mask.nativeElement),qe.D.removeClass(this.mask.nativeElement,"p-component-overlay-leave"),this.renderer.removeChild(this.el.nativeElement,this.mask.nativeElement),qe.D.unblockBodyScroll()),this.unbindAnimationEndListener(),this.cd.markForCheck()}unbindAnimationEndListener(){this.animationEndListener&&this.mask&&(this.animationEndListener(),this.animationEndListener=null)}ngOnDestroy(){this.unblock(),this.destroyModal()}static \u0275fac=function(n){return new(n||e)(a.rXU(Oe.qQ),a.rXU(a.aKT),a.rXU(a.gRc),a.rXU(Ze.r1),a.rXU(a.sFG),a.rXU(a.Agw))};static \u0275cmp=a.VBU({type:e,selectors:[["p-blockUI"]],contentQueries:function(n,i,s){if(1&n&&a.wni(s,Ze.Ei,4),2&n){let o;a.mGM(o=a.lsd())&&(i.templates=o)}},viewQuery:function(n,i){if(1&n&&a.GBs(hy,5),2&n){let s;a.mGM(s=a.lsd())&&(i.mask=s.first)}},hostAttrs:[1,"p-element"],inputs:{target:"target",autoZIndex:[2,"autoZIndex","autoZIndex",a.L39],baseZIndex:[2,"baseZIndex","baseZIndex",a.Udg],styleClass:"styleClass",blocked:"blocked"},features:[a.GFd],ngContentSelectors:Cy,decls:4,vars:11,consts:[["mask",""],[3,"ngClass","ngStyle"],[4,"ngTemplateOutlet"]],template:function(n,i){1&n&&(a.NAR(),a.j41(0,"div",1,0),a.SdG(2),a.DNE(3,py,1,0,"ng-container",2),a.k0s()),2&n&&(a.HbH(i.styleClass),a.Y8G("ngClass",a.eq3(8,Iy,!i.target))("ngStyle",a.lJ4(10,Ay)),a.BMQ("aria-busy",i.blocked)("data-pc-name","blockui")("data-pc-section","root"),a.R7$(3),a.Y8G("ngTemplateOutlet",i.contentTemplate))},dependencies:[Oe.YU,Oe.T3,Oe.B3],styles:["@layer primeng{.p-blockui{position:absolute;top:0;left:0;width:100%;height:100%;background-color:transparent;transition-property:background-color;display:flex;align-items:center;justify-content:center}.p-blockui.p-component-overlay{position:absolute}.p-blockui-document.p-component-overlay{position:fixed}.p-blockui-leave.p-component-overlay{background-color:transparent}}\n"],encapsulation:2,changeDetection:0})}return e})(),my=(()=>{class e{static \u0275fac=function(n){return new(n||e)};static \u0275mod=a.$C({type:e});static \u0275inj=a.G2t({imports:[Oe.MD]})}return e})();var sf=Fe(491),of=Fe(9615),lf=Fe(6160),cf=Fe(6296);let _y=(()=>{class e{styleClass;style;strokeWidth="2";fill="none";animationDuration="2s";ariaLabel;static \u0275fac=function(n){return new(n||e)};static \u0275cmp=a.VBU({type:e,selectors:[["p-progressSpinner"]],hostAttrs:[1,"p-element"],inputs:{styleClass:"styleClass",style:"style",strokeWidth:"strokeWidth",fill:"fill",animationDuration:"animationDuration",ariaLabel:"ariaLabel"},decls:3,vars:11,consts:[["role","progressbar",1,"p-progress-spinner",3,"ngStyle","ngClass"],["viewBox","25 25 50 50",1,"p-progress-spinner-svg"],["cx","50","cy","50","r","20","stroke-miterlimit","10",1,"p-progress-spinner-circle"]],template:function(n,i){1&n&&(a.j41(0,"div",0),a.qSk(),a.j41(1,"svg",1),a.nrm(2,"circle",2),a.k0s()()),2&n&&(a.Y8G("ngStyle",i.style)("ngClass",i.styleClass),a.BMQ("aria-label",i.ariaLabel)("aria-busy",!0)("data-pc-name","progressspinner")("data-pc-section","root"),a.R7$(),a.xc7("animation-duration",i.animationDuration),a.BMQ("data-pc-section","root"),a.R7$(),a.BMQ("fill",i.fill)("stroke-width",i.strokeWidth))},dependencies:[Oe.YU,Oe.B3],styles:['@layer primeng{.p-progress-spinner{position:relative;margin:0 auto;width:100px;height:100px;display:inline-block}.p-progress-spinner:before{content:"";display:block;padding-top:100%}.p-progress-spinner-svg{animation:p-progress-spinner-rotate 2s linear infinite;height:100%;transform-origin:center center;width:100%;position:absolute;inset:0;margin:auto}.p-progress-spinner-circle{stroke-dasharray:89,200;stroke-dashoffset:0;stroke:#d62d20;animation:p-progress-spinner-dash 1.5s ease-in-out infinite,p-progress-spinner-color 6s ease-in-out infinite;stroke-linecap:round}}@keyframes p-progress-spinner-rotate{to{transform:rotate(360deg)}}@keyframes p-progress-spinner-dash{0%{stroke-dasharray:1,200;stroke-dashoffset:0}50%{stroke-dasharray:89,200;stroke-dashoffset:-35px}to{stroke-dasharray:89,200;stroke-dashoffset:-124px}}@keyframes p-progress-spinner-color{to,0%{stroke:#d62d20}40%{stroke:#0057e7}66%{stroke:#008744}80%,90%{stroke:#ffa700}}\n'],encapsulation:2,changeDetection:0})}return e})(),xy=(()=>{class e{static \u0275fac=function(n){return new(n||e)};static \u0275mod=a.$C({type:e});static \u0275inj=a.G2t({imports:[Oe.MD]})}return e})();function vy(e,r){if(1&e){const t=a.RV6();a.j41(0,"th")(1,"p-inputGroup")(2,"button",38),a.bIt("click",function(){const i=a.eBV(t).index,s=a.XpG(4);return a.Njj(s.nameColumn=i)}),a.k0s(),a.nrm(3,"input",39),a.j41(4,"button",40),a.bIt("click",function(){const i=a.eBV(t).index,s=a.XpG(4);return a.Njj(s.priceColumn=i)}),a.k0s()()()}if(2&e){const t=r.$implicit,n=r.index,i=a.XpG(4);a.R7$(2),a.Y8G("disabled",i.nameColumn==n),a.R7$(),a.Y8G("disabled",!0)("value",t),a.R7$(),a.Y8G("disabled",i.priceColumn==n)}}function ky(e,r){if(1&e&&(a.j41(0,"tr"),a.DNE(1,vy,5,4,"th",37),a.k0s()),2&e){const t=a.XpG(3);a.R7$(),a.Y8G("ngForOf",t.previewHeaderCells)}}function wy(e,r){1&e&&(a.nrm(0,"tr",41),a.nI1(1,"safeHtml")),2&e&&a.Y8G("innerHTML",a.bMT(1,1,r.$implicit),a.npT)}function yy(e,r){if(1&e&&(a.j41(0,"p-accordion")(1,"p-accordionTab",35)(2,"p-table",36),a.DNE(3,ky,2,1,"ng-template",32)(4,wy,2,3,"ng-template",33),a.k0s()()()),2&e){const t=a.XpG(2);a.R7$(2),a.Y8G("scrollable",!0)("value",t.previewRows)}}function Ty(e,r){if(1&e&&a.nrm(0,"p-sortIcon",46),2&e){const t=a.XpG().$implicit;a.Y8G("field",t.name)}}function Sy(e,r){if(1&e&&(a.qex(0),a.j41(1,"th",44),a.EFF(2),a.DNE(3,Ty,1,1,"p-sortIcon",45),a.k0s(),a.bVm()),2&e){const t=r.$implicit;a.R7$(),a.Y8G("pSortableColumnDisabled",t.isNameColumn)("pSortableColumn",t.name),a.R7$(),a.SpI(" ",t.name," "),a.R7$(),a.Y8G("ngIf",!t.isNameColumn)}}function by(e,r){if(1&e&&(a.qex(0),a.j41(1,"th"),a.nrm(2,"p-columnFilter",47),a.k0s(),a.bVm()),2&e){const t=r.$implicit;a.R7$(2),a.Y8G("field",t.name)("showButtons",!1)("type",t.isNameColumn?"text":"numeric")("useGrouping",!1)}}function Ey(e,r){if(1&e){const t=a.RV6();a.qex(0),a.j41(1,"tr")(2,"th",42)(3,"p-checkbox",43),a.bIt("onChange",function(i){a.eBV(t);const s=a.XpG(3);return a.Njj(s.toggleSelectedRows(i.checked))}),a.k0s()(),a.DNE(4,Sy,4,4,"ng-container",37),a.k0s(),a.j41(5,"tr"),a.DNE(6,by,3,4,"ng-container",37),a.k0s(),a.bVm()}if(2&e){const t=a.XpG().$implicit,n=a.XpG(2);a.R7$(3),a.Y8G("binary",!0)("ngModel",(null==n.selectedRows?null:n.selectedRows.length)==n.outputData.length),a.R7$(),a.Y8G("ngForOf",t),a.R7$(2),a.Y8G("ngForOf",t)}}function Fy(e,r){if(1&e&&a.DNE(0,Ey,7,4,"ng-container",8),2&e){const t=r.$implicit;a.Y8G("ngIf",null==t?null:t.length)}}function Dy(e,r){if(1&e&&(a.j41(0,"a",50),a.EFF(1),a.k0s()),2&e){const t=a.XpG().$implicit,n=a.XpG().$implicit,i=a.XpG(2);a.Mz_("href","https://www.ozon.ru/search/?from_global=true&text=",i.encodeURIComponent(n[t.name]),"",a.B4B),a.R7$(),a.SpI(" ",n[t.name]," ")}}function Ny(e,r){if(1&e&&(a.j41(0,"div"),a.EFF(1,"\u0412\u0435\u043d\u0434\u043e\u0440: "),a.j41(2,"a",50),a.EFF(3),a.k0s()()),2&e){const t=a.XpG(3).$implicit,n=a.XpG(2);a.R7$(2),a.Mz_("href","https://www.ozon.ru/search/?from_global=true&text=",n.encodeURIComponent(t.extendedNameData.v),"",a.B4B),a.R7$(),a.SpI(" ",t.extendedNameData.v," ")}}function Py(e,r){if(1&e&&(a.j41(0,"div"),a.EFF(1,"\u0422\u043e\u0432\u0430\u0440: "),a.j41(2,"a",50),a.EFF(3),a.k0s()()),2&e){const t=a.XpG(3).$implicit,n=a.XpG(2);a.R7$(2),a.Mz_("href","https://www.ozon.ru/search/?from_global=true&text=",n.encodeURIComponent(t.extendedNameData.n),"",a.B4B),a.R7$(),a.SpI(" ",t.extendedNameData.n," ")}}function Ry(e,r){if(1&e&&(a.j41(0,"div"),a.EFF(1,"\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f: "),a.j41(2,"a",50),a.EFF(3),a.k0s()()),2&e){const t=a.XpG(3).$implicit,n=a.XpG(2);a.R7$(2),a.Mz_("href","https://www.ozon.ru/search/?from_global=true&text=",n.encodeURIComponent(t.extendedNameData.c),"",a.B4B),a.R7$(),a.SpI(" ",t.extendedNameData.c," ")}}function Oy(e,r){if(1&e&&(a.qex(0),a.DNE(1,Ny,4,3,"div",8)(2,Py,4,3,"div",8)(3,Ry,4,3,"div",8),a.bVm()),2&e){const t=a.XpG(2).$implicit;a.R7$(),a.Y8G("ngIf",t.extendedNameData.v),a.R7$(),a.Y8G("ngIf",t.extendedNameData.n),a.R7$(),a.Y8G("ngIf",t.extendedNameData.c)}}function By(e,r){if(1&e&&(a.qex(0),a.EFF(1),a.bVm()),2&e){const t=a.XpG().$implicit,n=a.XpG().$implicit;a.R7$(),a.SpI(" ",n[t.name]," ")}}function My(e,r){if(1&e&&(a.j41(0,"td"),a.DNE(1,Dy,2,3,"a",49)(2,Oy,4,3,"ng-container",8)(3,By,2,1,"ng-container",8),a.k0s()),2&e){const t=r.$implicit,n=a.XpG().$implicit;a.R7$(),a.Y8G("ngIf",t.isNameColumn),a.R7$(),a.Y8G("ngIf",t.isNameColumn&&n.extendedNameData),a.R7$(),a.Y8G("ngIf",!t.isNameColumn)}}function Ly(e,r){if(1&e){const t=a.RV6();a.j41(0,"tr")(1,"td")(2,"p-checkbox",48),a.mxI("ngModelChange",function(i){a.eBV(t);const s=a.XpG(2);return a.DH7(s.selectedRows,i)||(s.selectedRows=i),a.Njj(i)}),a.k0s()(),a.DNE(3,My,4,3,"td",37),a.k0s()}if(2&e){const t=r.columns,n=r.rowIndex,i=a.XpG(2);a.R7$(2),a.R50("ngModel",i.selectedRows),a.Y8G("value",n),a.R7$(),a.Y8G("ngForOf",t)}}function Uy(e,r){if(1&e){const t=a.RV6();a.j41(0,"button",30),a.bIt("click",function(){a.eBV(t);const i=a.XpG(2);return a.Njj(i.exportFile())}),a.EFF(1,"\u042d\u043a\u0441\u043f\u043e\u0440\u0442 \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0445 "),a.k0s()}if(2&e){const t=a.XpG(2);a.Y8G("disabled",!(null!=t.selectedRows&&t.selectedRows.length))}}function Gy(e,r){if(1&e){const t=a.RV6();a.j41(0,"div",5),a.DNE(1,yy,5,2,"p-accordion",8),a.j41(2,"div",9)(3,"div",10)(4,"span",11)(5,"p-dropdown",12),a.bIt("onChange",function(){a.eBV(t);const i=a.XpG();return a.Njj(i.onSelectedSheetChange())}),a.mxI("ngModelChange",function(i){a.eBV(t);const s=a.XpG();return a.DH7(s.selectedSheet,i)||(s.selectedSheet=i),a.Njj(i)}),a.k0s(),a.j41(6,"label",13),a.EFF(7,"\u041b\u0438\u0441\u0442"),a.k0s()()(),a.j41(8,"div",10)(9,"span",11)(10,"p-dropdown",14),a.mxI("ngModelChange",function(i){a.eBV(t);const s=a.XpG();return a.DH7(s.nameColumn,i)||(s.nameColumn=i),a.Njj(i)}),a.k0s(),a.j41(11,"label",15),a.EFF(12,"\u041a\u043e\u043b\u043e\u043d\u043a\u0430 \u043d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u044f"),a.k0s()()(),a.j41(13,"div",10)(14,"span",11)(15,"p-dropdown",16),a.mxI("ngModelChange",function(i){a.eBV(t);const s=a.XpG();return a.DH7(s.priceColumn,i)||(s.priceColumn=i),a.Njj(i)}),a.k0s(),a.j41(16,"label",17),a.EFF(17,"\u041a\u043e\u043b\u043e\u043d\u043a\u0430 \u0446\u0435\u043d\u044b"),a.k0s()()(),a.j41(18,"div",10)(19,"span",11)(20,"p-multiSelect",18),a.mxI("ngModelChange",function(i){a.eBV(t);const s=a.XpG();return a.DH7(s.includedColumns,i)||(s.includedColumns=i),a.Njj(i)}),a.k0s(),a.j41(21,"label",19),a.EFF(22,"\u0412\u044b\u0432\u043e\u0434\u0438\u043c\u044b\u0435 \u043a\u043e\u043b\u043e\u043d\u043a\u0438"),a.k0s()()(),a.j41(23,"div",10)(24,"span",11)(25,"p-multiSelect",20),a.mxI("ngModelChange",function(i){a.eBV(t);const s=a.XpG();return a.DH7(s.selectedRatesOfReturn,i)||(s.selectedRatesOfReturn=i),a.Njj(i)}),a.k0s(),a.j41(26,"label",21),a.EFF(27,"\u0420\u0430\u0441\u0447\u0451\u0442\u043d\u044b\u0435 \u043d\u043e\u0440\u043c\u044b \u043f\u0440\u0438\u0431\u044b\u043b\u0438"),a.k0s()()(),a.j41(28,"div",10)(29,"span",11)(30,"p-inputNumber",22),a.mxI("ngModelChange",function(i){a.eBV(t);const s=a.XpG();return a.DH7(s.deliveryCost,i)||(s.deliveryCost=i),a.Njj(i)}),a.k0s(),a.j41(31,"label",23),a.EFF(32,"\u0414\u043e\u0441\u0442\u0430\u0432\u043a\u0430, \u20bd"),a.k0s()()(),a.j41(33,"div",10)(34,"span",11)(35,"p-inputNumber",24),a.mxI("ngModelChange",function(i){a.eBV(t);const s=a.XpG();return a.DH7(s.returnCost,i)||(s.returnCost=i),a.Njj(i)}),a.k0s(),a.j41(36,"label",25),a.EFF(37,"\u0412\u043e\u0437\u0432\u0440\u0430\u0442, \u20bd"),a.k0s()()(),a.j41(38,"div",10)(39,"span",11)(40,"p-inputNumber",26),a.mxI("ngModelChange",function(i){a.eBV(t);const s=a.XpG();return a.DH7(s.commissionPercent,i)||(s.commissionPercent=i),a.Njj(i)}),a.k0s(),a.j41(41,"label",27),a.EFF(42,"\u041a\u043e\u043c\u0438\u0441\u0441\u0438\u044f, %"),a.k0s()()(),a.j41(43,"div",10)(44,"span",11)(45,"p-inputNumber",28),a.mxI("ngModelChange",function(i){a.eBV(t);const s=a.XpG();return a.DH7(s.returnPercentage,i)||(s.returnPercentage=i),a.Njj(i)}),a.k0s(),a.j41(46,"label",29),a.EFF(47,"% \u0432\u043e\u0437\u0432\u0440\u0430\u0442\u043e\u0432"),a.k0s()()()(),a.j41(48,"button",30),a.bIt("click",function(){a.eBV(t);const i=a.XpG();return a.Njj(i.calculate())}),a.EFF(49,"\u0420\u0430\u0441\u0441\u0447\u0438\u0442\u0430\u0442\u044c "),a.k0s(),a.j41(50,"p-table",31),a.DNE(51,Fy,1,1,"ng-template",32)(52,Ly,4,3,"ng-template",33),a.k0s(),a.DNE(53,Uy,2,1,"button",34),a.k0s()}if(2&e){const t=a.XpG(),n=a.sdS(6);a.R7$(),a.Y8G("ngIf",null==t.previewHeaderCells?null:t.previewHeaderCells.length),a.R7$(4),a.R50("ngModel",t.selectedSheet),a.Y8G("disabled",!n.files.length)("options",t.sheets),a.R7$(5),a.R50("ngModel",t.nameColumn),a.Y8G("disabled",!t.availableColumns)("options",t.availableColumns),a.R7$(5),a.R50("ngModel",t.priceColumn),a.Y8G("disabled",!t.availableColumns)("options",t.availableColumns),a.R7$(5),a.R50("ngModel",t.includedColumns),a.Y8G("disabled",!t.availableColumns)("filter",!1)("options",t.availableColumns)("showClear",!0),a.R7$(5),a.R50("ngModel",t.selectedRatesOfReturn),a.Y8G("filter",!1)("options",t.ratesOfReturn)("showClear",!0),a.R7$(5),a.R50("ngModel",t.deliveryCost),a.Y8G("min",0)("useGrouping",!1)("showButtons",!0)("step",5)("maxFractionDigits",0),a.R7$(5),a.R50("ngModel",t.returnCost),a.Y8G("min",0)("useGrouping",!1)("showButtons",!0)("step",5)("maxFractionDigits",0),a.R7$(5),a.R50("ngModel",t.commissionPercent),a.Y8G("max",100)("min",0)("useGrouping",!1)("showButtons",!0)("step",.5)("minFractionDigits",1),a.R7$(5),a.R50("ngModel",t.returnPercentage),a.Y8G("min",0)("max",99)("useGrouping",!1)("showButtons",!0)("step",.5)("minFractionDigits",1),a.R7$(3),a.Y8G("disabled",!n.files.length||null==t.nameColumn||!t.selectedRatesOfReturn.length),a.R7$(2),a.Y8G("columns",t.outputFileColumns)("scrollable",!0)("value",t.outputData),a.R7$(3),a.Y8G("ngIf",null==t.outputData?null:t.outputData.length)}}const jy=[{path:"edit",component:xh},{path:"",component:kf},{path:"product-tree",component:kA},{path:"package-type/list",component:UA},{path:"summary",component:Eh},{path:"price-analyzer",component:(()=>{class e{static{this.nameColumnCaption="\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435"}constructor(t,n,i){this.togetherApi=t,this.messageService=n,this.includedColumns=void 0,this.availableColumns=void 0,this.selectedSheet=void 0,this.sheets=[],this.nameColumn=void 0,this.priceColumn=void 0,this.selectedRatesOfReturn=[20],this.ratesOfReturn=[0,5,10,15,20,25,30,35,40,45,50],this.deliveryCost=100,this.returnCost=150,this.commissionPercent=20,this.returnPercentage=5,this.outputFileColumns=void 0,this.outputData=void 0,this.selectedRows=[],this.encodeURIComponent=encodeURIComponent,this.window=window,this.blockUI=!1,i.setTitle("\u0410\u043d\u0430\u043b\u0438\u0437 \u043f\u0440\u0430\u0439-\u043b\u0438\u0441\u0442\u043e\u0432")}getColumnName(t){const n=[];let i=!1;do{const s=~~(t%26)+(i?-1:0);t=~~(t/26),i=!0,n.unshift(String.fromCharCode(65+s))}while(t>0);return n.join("")}getRateValueProvider(t){const n=this.deliveryCost+this.returnCost*this.returnPercentage/100,i=1-this.commissionPercent/100,s=1+t/100;return o=>~~Math.ceil((o[this.getColumnName(this.priceColumn)]*s+n)/i)}calculate(){var t=this;return(0,Ui.A)(function*(){t.blockUI=!0;const n=[];function i(A){return C=>C[A]||"-"}t.includedColumns?.forEach(A=>{if(A!==t.nameColumn&&A!==t.priceColumn){const C=t.getColumnName(A);n.push({name:C,valueProvider:i(C)})}});const s=t.getColumnName(t.priceColumn),o=t.getColumnName(t.nameColumn);n.push({isNameColumn:!0,name:e.nameColumnCaption,valueProvider:i(o)},{name:"\u0417\u0430\u043a\u0443\u043f\u043e\u0447\u043d\u0430\u044f \u0446\u0435\u043d\u0430",valueProvider:i(s)}),t.selectedRatesOfReturn.sort((A,C)=>Math.sign(A-C)).forEach(A=>{n.push({name:`\u0426\u0435\u043d\u0430 \u043f\u0440\u0438 \u043d\u043e\u0440\u043c\u0435 \u043f\u0440\u0438\u0431\u044b\u043b\u0438 ${A}%`,valueProvider:t.getRateValueProvider(A)})});const l=yield t.getData();t.outputData=l.map(A=>{let C=A[s];if(!C||"string"==typeof C&&(C=C.trim(),isNaN(C))||(C=+C,!C))return;C%1e-4&&(C=~~(1e4*C)/1e4);let I=A[o];return I&&(I=I.toString().trim(),I)?(A[s]=C,A[o]=I,n.reduce((_,p)=>(_[p.name]=p.valueProvider(A),_),{})):void 0}).filter(A=>!!A);const g=t.outputData.map(A=>A[e.nameColumnCaption]);t.outputFileColumns=n;const u='given a json array of price list entries give list of product names cleaned from count, size, dimensions and color,move vendor to separate attribute, try to detect best match for product category. Omit vendor and/or category attributes if they are null:\noutput format: [{"i": "source item index" "n": "cleaned product name", "v": "vendor if present", "c": "product category name in russian if detected"}]\ninput: '+JSON.stringify(g)+`\noutput: ${qo.ResponseSeparatorToken}<output json>${qo.ResponseSeparatorToken}\n`,h=yield t.togetherApi.infere("llama",[{role:"user",content:u}]);try{const A=h.data;if(!Array.isArray(A))throw Error("\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u0444\u043e\u0440\u043c\u0430\u0442 \u043e\u0442\u0432\u0435\u0442\u0430 \u043e\u0442 together: \u043e\u0436\u0438\u0434\u0430\u043b\u0441\u044f \u043c\u0430\u0441\u0441\u0438\u0432");A.forEach(C=>t.outputData[C.i].extendedNameData=C)}catch(A){console.error(A),t.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0441\u043f\u0438\u0441\u043a\u0430 \u0442\u043e\u0432\u0430\u0440\u043d\u044b\u0445 \u043d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0439",severity:"error",detail:A})}t.blockUI=!1})()}onFileSelect(t){var n=this;return(0,Ui.A)(function*(){n.fileName=t.files[0].name;let i=yield t.files[0].arrayBuffer();n.workbook=void 0,n.workbook=Ln(i),n.sheets=n.workbook.SheetNames,n.sheets.length?(n.selectedSheet=n.sheets[0],yield n.onSelectedSheetChange()):n.selectedSheet=void 0})()}onSelectedSheetChange(){var t=this;return(0,Ui.A)(function*(){null!=t.selectedSheet?t.extractExcelSheetInfo():(t.availableColumns=void 0,t.includedColumns=void 0)})()}exportFile(){const t=new Map,n=[],i=[];let s=1;const o=this.outputFileColumns.findIndex(C=>C.name==e.nameColumnCaption),l=this.getColumnName(o);this.selectedRows.forEach(C=>{const I=this.outputData[C];n.push(Object.assign({},I)),delete n[n.length-1].extendedNameData;let m=0;if(I.extendedNameData){if(I.extendedNameData.n){m++;const _={};_[e.nameColumnCaption]=I.extendedNameData.n,n.push(_)}if(I.extendedNameData.v){m++;const _={};_[e.nameColumnCaption]=I.extendedNameData.v,n.push(_)}if(I.extendedNameData.c){m++;const _={};_[e.nameColumnCaption]=I.extendedNameData.c,n.push(_)}this.outputFileColumns.forEach((_,p)=>{p!=o&&i.push({s:{r:s,c:p},e:{r:s+m,c:p}})})}s+=1+m}),n.forEach(C=>this.outputFileColumns.forEach((I,m)=>{t.has(m)||t.set(m,I.name.length),t.set(m,Math.max(t.get(m),C[I.name]?.toString().length))}));const g=[];for(let C=0;C<t.size;C++)g.push({wch:t.get(C)});const u=Ni.json_to_sheet(n);u["!merges"]=i;const h=Ni.book_new();Ni.book_append_sheet(h,u,"\u0420\u0430\u0441\u0447\u0451\u0442"),u["!cols"]=g;for(let C=0;C<n.length;C++)u[l+(C+2)].l={Target:"https://www.ozon.ru/search/?from_global=true&text="+encodeURIComponent(n[C][e.nameColumnCaption])};const A=this.fileName.split(".");A[A.length-2]+="-redicy",A[A.length-1]="xlsx",function Jo(e,r,t){var n=t||{};return n.type="file",n.file=r,function Yo(e){if(!e.bookType){var t=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(e.bookType=t.slice(1)),e.bookType={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"}[e.bookType]||e.bookType}}(n),ks(e,n)}(h,A.join("."),{compression:!0})}toggleSelectedRows(t){this.selectedRows=t?this.outputData.map((n,i)=>i):[]}onFileRemove(){this.workbook=void 0,this.selectedSheet=void 0,this.fileName=void 0,this.previewRows=void 0,this.previewHeaderCells=void 0,this.onSelectedSheetChange()}getData(){var t=this;return(0,Ui.A)(function*(){const n=(t.includedColumns||[]).concat([t.nameColumn,t.priceColumn]),i=Math.max(...t.includedColumns||[],t.nameColumn,t.priceColumn),s=new Set(n),o=t.workbook.Sheets[t.selectedSheet],l=[...Array(i+1).keys()].map((u,h)=>h).map(u=>s.has(u)?t.getColumnName(u):void 0);return Ni.sheet_to_json(o,{header:l,blankrows:!1,skipHidden:!0})})()}extractExcelSheetInfo(){const t=this.workbook.Sheets[this.selectedSheet],i=t["!ref"].split(":"),s=/([a-z]+)\d+$/i;let l,g,o=s.exec(i[0]);if(o?.length>1?(l=o[1],o=s.exec(i[1]),o?.length>1?g=o[1]:this.selectedSheet=void 0):this.selectedSheet=void 0,null==this.selectedSheet)alert("\u041d\u0435\u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u043c\u044b\u0439 \u0434\u0438\u0430\u043f\u0430\u0437\u043e\u043d, \u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0434\u0440\u0443\u0433\u043e\u0439 \u043b\u0438\u0441\u0442");else{const A=[],C=this.getColumnIndex(l),I=C+Math.min(this.getColumnIndex(g)-C,60);for(let X=C;X<=I;X++)A.push({index:X,text:this.getColumnName(X)});this.availableColumns=A;let m=Ni.sheet_to_html(t);this.previewHeaderCells=[];const _=/(<tr[^?]*?>)(.*?)<\/tr>/gs,p=/(<td.*?id="sjs-([^\d]+)\d+"[^>]*?>(.*?))<\/td>/gs;let d;const w=[],v=[];let S=0;for(_.lastIndex=0;(d=_.exec(m))&&v.length<=10;){let X,E=0;const O=[];let L=!1;for(p.lastIndex=0;(X=p.exec(d[2]))&&E<60;)v.length||w.push(X[2]),O.push(X[1]),X[3]&&(L=!0,E>S&&(S=E)),E++;L&&v.push(O)}const G=S+1;w.length>G&&(w.length=G,v.forEach(X=>X.length=G)),w.length&&(this.previewHeaderCells=w),v.length&&(this.previewRows=v.map(X=>X.join("")))}}getColumnIndex(t){let i=0;for(let s=0;s<t.length;s++)i*=26,i+=t.charCodeAt(s)-65+1;return i--,i}static{this.\u0275fac=function(n){return new(n||e)(a.rXU(qo),a.rXU(Ze.bg),a.rXU(Ut.hE))}}static{this.\u0275cmp=a.VBU({type:e,selectors:[["app-price-analyzer"]],decls:8,vars:4,consts:[["fileUpload",""],[3,"blocked"],[1,"card"],["animationDuration","1s","strokeWidth","8","styleClass","w-4rem h-4rem"],["header","\u0410\u043d\u0430\u043b\u0438\u0437 \u043f\u0440\u0430\u0439\u0441-\u043b\u0438\u0441\u0442\u043e\u0432"],[1,"m-2"],["accept",".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel","chooseIcon","pi pi-upload",3,"onRemove","onSelect","showCancelButton","showUploadButton"],["class","m-2",4,"ngIf"],[4,"ngIf"],[1,"formgrid","grid"],[1,"field","lg:col-4","md:col-6","sm:col-12","mt-5"],[1,"p-float-label"],["appendTo","body","inputId","sheet",3,"onChange","ngModelChange","ngModel","disabled","options"],["for","sheet"],["appendTo","body","inputId","nameColumn","optionLabel","text","optionValue","index",3,"ngModelChange","ngModel","disabled","options"],["for","nameColumn"],["appendTo","body","inputId","priceColumn","optionLabel","text","optionValue","index",3,"ngModelChange","ngModel","disabled","options"],["for","priceColumn"],["appendTo","body","inputId","includedColumns","optionLabel","text","optionValue","index",3,"ngModelChange","ngModel","disabled","filter","options","showClear"],["for","includedColumns"],["appendTo","body","inputId","ratesOfReturn",3,"ngModelChange","ngModel","filter","options","showClear"],["for","ratesOfReturn"],["inputId","deliveryCost",3,"ngModelChange","ngModel","min","useGrouping","showButtons","step","maxFractionDigits"],["for","deliveryCost"],["inputId","returnCost",3,"ngModelChange","ngModel","min","useGrouping","showButtons","step","maxFractionDigits"],["for","returnCost"],["inputId","commissionPercent",3,"ngModelChange","ngModel","max","min","useGrouping","showButtons","step","minFractionDigits"],["for","commissionPercent"],["inputId","returnPercentage",3,"ngModelChange","ngModel","min","max","useGrouping","showButtons","step","minFractionDigits"],["for","returnPercentage"],["pButton","",1,"mt-2","mb-5",3,"click","disabled"],[3,"columns","scrollable","value"],["pTemplate","header"],["pTemplate","body"],["class","mt-2 mb-5","pButton","",3,"disabled","click",4,"ngIf"],["header","\u041f\u0440\u0435\u0434\u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440"],["scrollHeight","350px","tableStyleClass","previewTable",3,"scrollable","value"],[4,"ngFor","ngForOf"],["icon","pi pi-pencil","pButton","","type","button",2,"width","20px","height","20px",3,"click","disabled"],["pInputText","","type","text",2,"width","40px","height","20px",3,"disabled","value"],["icon","pi pi-dollar","pButton","","type","button",2,"width","20px","height","20px",3,"click","disabled"],[3,"innerHTML"],["rowspan","2"],[3,"onChange","binary","ngModel"],[3,"pSortableColumnDisabled","pSortableColumn"],[3,"field",4,"ngIf"],[3,"field"],[3,"field","showButtons","type","useGrouping"],[3,"ngModelChange","ngModel","value"],["target","_blank",3,"href",4,"ngIf"],["target","_blank",3,"href"]],template:function(n,i){if(1&n){const s=a.RV6();a.j41(0,"p-blockUI",1)(1,"div",2),a.nrm(2,"p-progressSpinner",3),a.k0s()(),a.j41(3,"p-card",4)(4,"div",5)(5,"p-fileUpload",6,0),a.bIt("onRemove",function(){return a.eBV(s),a.Njj(i.onFileRemove())})("onSelect",function(l){return a.eBV(s),a.Njj(i.onFileSelect(l))}),a.k0s()(),a.DNE(7,Gy,54,50,"div",7),a.k0s()}2&n&&(a.Y8G("blocked",i.blockUI),a.R7$(5),a.Y8G("showCancelButton",!0)("showUploadButton",!1),a.R7$(2),a.Y8G("ngIf",i.workbook))},dependencies:[Bi.nD,Bi.gV,Ze.Ei,dy,Gr._f,sf.Z,Fa.Sc,Oe.Sq,Oe.bT,Pa.ms,of.N,nr.BC,nr.vS,lf.M,Ra.YI,Oi.S,cf.KF,_y,jr.XI,jr.Tg,jr.yc,jr.rl,h0],styles:["[_nghost-%COMP%]     .p-datatable .p-datatable-tbody>tr>td, [_nghost-%COMP%]     .p-datatable .p-datatable-thead>tr>th{border-collapse:collapse;border-width:1px}"]})}}return e})()}];let Vy=(()=>{class e{static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275mod=a.$C({type:e})}static{this.\u0275inj=a.G2t({imports:[Ye.iI.forChild(jy),Ye.iI]})}}return e})(),$y=(()=>{class e{static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275mod=a.$C({type:e})}static{this.\u0275inj=a.G2t({imports:[Oe.MD]})}}return e})(),Jy=(()=>{class e{static \u0275fac=function(n){return new(n||e)};static \u0275mod=a.$C({type:e});static \u0275inj=a.G2t({imports:[Oe.MD,Ze.Gg,Li.h,Ze.Gg,Li.h]})}return e})();var Ky=Fe(672),Zy=Fe(4602);let Qy=(()=>{class e{static{this.\u0275fac=function(n){return new(n||e)}}static{this.\u0275mod=a.$C({type:e})}static{this.\u0275inj=a.G2t({providers:[At.D.PurchaseBatchClient,At.D.ProductClient,At.D.PackageTypeClient,At.D.SalesChannelClient,At.D.PriceAnalyzerClient,it.X.PurchaseBatchClient,it.X.PackageTypeClient,Na],imports:[Bi.h6,Ri.$$,my,Gr.tm,ws.rO,sf.D,Fa.q4,Oe.MD,ys.P,Pa.kr,of.e,nr.YN,Zy.k,lf.I,Ra.O3,Oi.u,cf.iV,$y,xy,Vy,su,jr.bG,u0.$,hi.MB,hi.MB,Ma.S,bs,mA,Ky.AG,Jy]})}}return e})()},8839:(n0,fi,Fe)=>{Fe.d(fi,{b:()=>Nt,E:()=>Le});var Oe=Fe(8359);class Ye extends Oe.yU{constructor(a,it){super()}schedule(a,it=0){return this}}const Or={setInterval(At,a,...it){const{delegate:Qe}=Or;return Qe?.setInterval?Qe.setInterval(At,a,...it):setInterval(At,a,...it)},clearInterval(At){const{delegate:a}=Or;return(a?.clearInterval||clearInterval)(At)},delegate:void 0};var Fr=Fe(7908),ui=Fe(6129);class rn{constructor(a,it=rn.now){this.schedulerActionCtor=a,this.now=it}schedule(a,it=0,Qe){return new this.schedulerActionCtor(this,a).schedule(Qe,it)}}rn.now=ui.U.now;const Le=new class nn extends rn{constructor(a,it=rn.now){super(a,it),this.actions=[],this._active=!1}flush(a){const{actions:it}=this;if(this._active)return void it.push(a);let Qe;this._active=!0;do{if(Qe=a.execute(a.state,a.delay))break}while(a=it.shift());if(this._active=!1,Qe){for(;a=it.shift();)a.unsubscribe();throw Qe}}}(class Fn extends Ye{constructor(a,it){super(a,it),this.scheduler=a,this.work=it,this.pending=!1}schedule(a,it=0){var Qe;if(this.closed)return this;this.state=a;const Ze=this.id,Ut=this.scheduler;return null!=Ze&&(this.id=this.recycleAsyncId(Ut,Ze,it)),this.pending=!0,this.delay=it,this.id=null!==(Qe=this.id)&&void 0!==Qe?Qe:this.requestAsyncId(Ut,this.id,it),this}requestAsyncId(a,it,Qe=0){return Or.setInterval(a.flush.bind(a,this),Qe)}recycleAsyncId(a,it,Qe=0){if(null!=Qe&&this.delay===Qe&&!1===this.pending)return it;null!=it&&Or.clearInterval(it)}execute(a,it){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const Qe=this._execute(a,it);if(Qe)return Qe;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(a,it){let Ze,Qe=!1;try{this.work(a)}catch(Ut){Qe=!0,Ze=Ut||new Error("Scheduled action threw falsy error")}if(Qe)return this.unsubscribe(),Ze}unsubscribe(){if(!this.closed){const{id:a,scheduler:it}=this,{actions:Qe}=it;this.work=this.state=this.scheduler=null,this.pending=!1,(0,Fr.o)(Qe,this),null!=a&&(this.id=this.recycleAsyncId(it,a,null)),this.delay=null,super.unsubscribe()}}}),Nt=Le},935:(n0,fi,Fe)=>{Fe.d(fi,{$:()=>At,v:()=>Nt});var Oe=Fe(177),Ye=Fe(4438),Or=Fe(5779);const Fr=["*"];function Fn(a,it){if(1&a&&Ye.nrm(0,"span",5),2&a){const Qe=Ye.XpG(2);Ye.Y8G("ngClass",Qe.icon)}}function ui(a,it){if(1&a&&(Ye.qex(0),Ye.DNE(1,Fn,1,1,"span",4),Ye.bVm()),2&a){const Qe=Ye.XpG();Ye.R7$(),Ye.Y8G("ngIf",Qe.icon)}}function rn(a,it){}function nn(a,it){1&a&&Ye.DNE(0,rn,0,0,"ng-template")}function Le(a,it){if(1&a&&(Ye.j41(0,"span",6),Ye.DNE(1,nn,1,0,null,7),Ye.k0s()),2&a){const Qe=Ye.XpG();Ye.R7$(),Ye.Y8G("ngTemplateOutlet",Qe.iconTemplate)}}let Nt=(()=>{class a{cd;get style(){return this._style}set style(Qe){this._style=Qe,this.cd.markForCheck()}styleClass;severity;value;icon;rounded;templates;iconTemplate;_style;ngAfterContentInit(){this.templates?.forEach(Qe=>{"icon"===Qe.getType()&&(this.iconTemplate=Qe.template)})}constructor(Qe){this.cd=Qe}containerClass(){return{"p-tag p-component":!0,[`p-tag-${this.severity}`]:this.severity,"p-tag-rounded":this.rounded}}static \u0275fac=function(Ze){return new(Ze||a)(Ye.rXU(Ye.gRc))};static \u0275cmp=Ye.VBU({type:a,selectors:[["p-tag"]],contentQueries:function(Ze,Ut,Ri){if(1&Ze&&Ye.wni(Ri,Or.Ei,4),2&Ze){let Gr;Ye.mGM(Gr=Ye.lsd())&&(Ut.templates=Gr)}},hostAttrs:[1,"p-element"],inputs:{style:"style",styleClass:"styleClass",severity:"severity",value:"value",icon:"icon",rounded:[2,"rounded","rounded",Ye.L39]},features:[Ye.GFd],ngContentSelectors:Fr,decls:6,vars:7,consts:[[3,"ngClass","ngStyle"],[4,"ngIf"],["class","p-tag-icon",4,"ngIf"],[1,"p-tag-value"],["class","p-tag-icon",3,"ngClass",4,"ngIf"],[1,"p-tag-icon",3,"ngClass"],[1,"p-tag-icon"],[4,"ngTemplateOutlet"]],template:function(Ze,Ut){1&Ze&&(Ye.NAR(),Ye.j41(0,"span",0),Ye.SdG(1),Ye.DNE(2,ui,2,1,"ng-container",1)(3,Le,2,1,"span",2),Ye.j41(4,"span",3),Ye.EFF(5),Ye.k0s()()),2&Ze&&(Ye.HbH(Ut.styleClass),Ye.Y8G("ngClass",Ut.containerClass())("ngStyle",Ut.style),Ye.R7$(2),Ye.Y8G("ngIf",!Ut.iconTemplate),Ye.R7$(),Ye.Y8G("ngIf",Ut.iconTemplate),Ye.R7$(2),Ye.JRh(Ut.value))},dependencies:[Oe.YU,Oe.bT,Oe.T3,Oe.B3],styles:["@layer primeng{.p-tag{display:inline-flex;align-items:center;justify-content:center}.p-tag-icon,.p-tag-value,.p-tag-icon.pi{line-height:1.5}.p-tag.p-tag-rounded{border-radius:10rem}}\n"],encapsulation:2,changeDetection:0})}return a})(),At=(()=>{class a{static \u0275fac=function(Ze){return new(Ze||a)};static \u0275mod=Ye.$C({type:a});static \u0275inj=Ye.G2t({imports:[Oe.MD,Or.Gg,Or.Gg]})}return a})()}}]);