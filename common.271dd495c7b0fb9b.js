"use strict";(self.webpackChunkseller=self.webpackChunkseller||[]).push([[76],{6229:(b,v,n)=>{n.d(v,{c:()=>a,q:()=>i});var a=function(t){return t[t.ThisDay=0]="ThisDay",t[t.PreviousDay=1]="PreviousDay",t[t.Day=2]="Day",t[t.ThisWeek=3]="ThisWeek",t[t.PreviousWeek=4]="PreviousWeek",t[t.Week=5]="Week",t[t.ThisMonth=6]="ThisMonth",t[t.PreviousMonth=7]="PreviousMonth",t[t.Month=8]="Month",t[t.Custom=9]="Custom",t}(a||{});class i{static getDateRange(_,d){let s=new Date,o=null;switch(_){case a.ThisDay:s.setHours(0,0,0,0);break;case a.PreviousDay:s.setDate(s.getDate()-1),s.setHours(0,0,0,0),o=new Date(s);break;case a.Day:s.setDate(s.getDate()-1);break;case a.ThisWeek:s.setDate(s.getDate()-(s.getDay()?s.getDay()-1:6)),s.setHours(0,0,0,0);break;case a.PreviousWeek:o=new Date(s);const u=o.getDay()??7;o.setHours(0,0,0,0),o.setDate(o.getDate()-u),s=new Date(o),s.setDate(s.getDate()-6);break;case a.Week:s.setDate(s.getDate()-7);break;case a.ThisMonth:s.setHours(0,0,0,0),s.setDate(1);break;case a.PreviousMonth:s.setHours(0,0,0,0),s.setDate(1),o=new Date(s),o.setDate(o.getDate()-1),s.setMonth(s.getMonth()-1);break;case a.Month:s.setMonth(s.getMonth()-1);break;default:s=d?.[0],s=null==s?null:new Date(s.getFullYear(),s.getMonth(),s.getDate()),o=d?.[1],o=null==o?null:new Date(o.getFullYear(),o.getMonth(),o.getDate())}return[s,o]}}},6398:(b,v,n)=>{n.d(v,{O:()=>S});var a=n(2180),i=n(4153),t=n(6229),_=n(4412),d=n(6977),s=n(5964),o=n(9437),f=n(983),u=n(9820),c=n(4438),m=n(5779),C=n(4238),P=n(345);let S=(()=>{class T extends a.x{static{this.FilterID="OzonReturnListComponent"}constructor(h,y,D,r){super(r),this.ozonSalesOrderClient=h,this.messageService=y,this.dbService=D,this.maxProductCount=5,this.dateRangeType=t.c.Month,this.filterModel={},this.reportSubject=new _.t(null),this.loading=!1,this.chartOptions={maintainAspectRatio:!1,plugins:{tooltip:{callbacks:{label:function(g){let e=g.dataset.label;return g.dataset.labels&&(e=g.dataset.labels.join("\r\n")),e}}}},responsive:!0,scales:{x:{type:"time",time:{unit:"day",displayFormats:{day:"D.MM.yy"}}},y:{stepSize:1,suggestedMax:5,beginAtZero:!1}}},this.data=new _.t(void 0)}ngOnChanges(h){h.maxProductCount&&this.updateChart()}ngOnInit(){this.titleService.setTitle("\u0417\u0430\u043a\u0430\u0437\u044b Ozon"),this.reportSubject.pipe((0,d.Q)(this.destroyed)).pipe((0,s.p)(h=>!!h)).subscribe(h=>{const y=Object.assign({},h,{productPackageIDs:[]});this.dbService.update("filters",{id:T.FilterID,data:y}).pipe((0,o.W)(D=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0444\u0438\u043b\u044c\u0442\u0440\u0430",severity:"error",detail:D}),f.w))).subscribe(()=>{this.getReport(h)})}),this.data.pipe((0,d.Q)(this.destroyed)).subscribe(()=>this.updateChart()),this.dbService.getByID("filters",T.FilterID).subscribe(h=>{h&&h.data&&(this.filterModel=h.data),this.reportSubject.next(this.filterModel)})}getReport(h){let[y,D]=t.q.getDateRange(this.dateRangeType,this.dateRange);null!=D?D.setDate(D.getDate()+1):D=new Date,h.dateFrom=y,h.dateTo=D;const r=new i.D.FindOzonReturnsModel(h);this.loading=!0,this.ozonSalesOrderClient.getReturnReport(r).pipe((0,o.W)(g=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0437\u0430\u043a\u0430\u0437\u043e\u0432",severity:"error",detail:g}),this.loading=!1,f.w))).subscribe(g=>{this.loading=!1,this.data.next(g)})}updateChart(){const h=this.data.value;if(!h)return void(this.chartData=void 0);const D=this.filterModel.dateTo;let r=new Date(this.filterModel.dateFrom);r.setUTCHours(0,0,0,0);const g={};for(let l=0;r<=D;l++)g[r.toISOString()]=l,r.setDate(r.getDate()+1);const e=Object.keys(h).map(l=>{const E=[];for(const O in g)E.push({x:O,y:0});let M=0;return h[l].forEach(O=>{E[g[O.Date]].y=O.Quantity,M+=O.Quantity}),{label:l,data:E,tension:0,returnCount:M,labels:void 0}});this.chartData={datasets:e};const p=+this.maxProductCount;if(p&&e.length>p){e.sort((l,E)=>E.returnCount-l.returnCount);for(let l=0;l<e.length;l++)l==p?(e[p].label="\u041e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0435",e[p].labels=[e[l].label]):l>p&&(e[p].labels.push(e[l].label),e[l].data.forEach((E,M)=>{e[p].data[M].y+=E.y}))}e.forEach((l,E)=>{let M=-1,O=-1;l.data.forEach((I,W)=>{I.y&&(-1==M&&(M=W),O=W)}),l.data.splice(O+1),l.data.splice(0,M)}),e.splice(p+1)}static{this.\u0275fac=function(y){return new(y||T)(c.rXU(i.D.OzonSalesOrderClient),c.rXU(m.bg),c.rXU(C.MX),c.rXU(P.hE))}}static{this.\u0275cmp=c.VBU({type:T,selectors:[["app-ozon-return-list"]],inputs:{maxProductCount:"maxProductCount"},standalone:!0,features:[c.Vt3,c.OA$,c.aNF],decls:1,vars:2,consts:[["type","line",3,"data","options"]],template:function(y,D){1&y&&c.nrm(0,"p-chart",0),2&y&&c.Y8G("data",D.chartData)("options",D.chartOptions)},dependencies:[u.F,u.X]})}}return T})()},8805:(b,v,n)=>{n.d(v,{t:()=>f});var a=n(9437),i=n(983),t=n(4412),_=n(4153),d=n(4438),s=n(6557),o=n(5779);let f=(()=>{class u{importOzonWarehouses(){return this.warehouseCommandHandlerClient.importOzonWarehouses().pipe((0,a.W)(m=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0438\u043c\u043f\u043e\u0440\u0442\u0430 \u0441\u043a\u043b\u0430\u0434\u043e\u0432 \u041e\u0437\u043e\u043d",severity:"error",detail:m}),i.w)))}constructor(m,C,P){this.ozonWarehouseClient=m,this.warehouseCommandHandlerClient=C,this.messageService=P,this.warehouses=new t.t(null)}getWarehouses(){return this.ozonWarehouseClient.getOzonWarehouses(new _.D.FindOzonWarehousesModel({includeAliases:!0}))}getWarehouseClusters(){return this.ozonWarehouseClient.getOzonWarehouseClusters(new _.D.FindOzonWarehouseClustersModel({includeAliases:!1,includeWarehouses:!1}))}updateWarehouse(m){return this.warehouseCommandHandlerClient.updateOzonWarehouse(m)}static{this.\u0275fac=function(C){return new(C||u)(d.KVO(_.D.WarehouseClient),d.KVO(s.X.WarehouseClient),d.KVO(o.bg))}}static{this.\u0275prov=d.jDH({token:u,factory:u.\u0275fac,providedIn:"root"})}}return u})()},3294:(b,v,n)=>{n.d(v,{F:()=>_});var a=n(3669),i=n(9974),t=n(4360);function _(s,o=a.D){return s=s??d,(0,i.N)((f,u)=>{let c,m=!0;f.subscribe((0,t._)(u,C=>{const P=o(C);(m||!s(c,P))&&(m=!1,c=P,u.next(C))}))})}function d(s,o){return s===o}},6160:(b,v,n)=>{n.d(v,{I:()=>s,M:()=>d});var a=n(177),i=n(4438),t=n(5779);const _=["*"];let d=(()=>{class o{style;styleClass;static \u0275fac=function(c){return new(c||o)};static \u0275cmp=i.VBU({type:o,selectors:[["p-inputGroup"]],hostAttrs:[1,"p-element","p-inputgroup"],inputs:{style:"style",styleClass:"styleClass"},ngContentSelectors:_,decls:2,vars:3,consts:[[1,"p-inputgroup",3,"ngClass","ngStyle"]],template:function(c,m){1&c&&(i.NAR(),i.j41(0,"div",0),i.SdG(1),i.k0s()),2&c&&(i.Y8G("ngClass",m.styleClass)("ngStyle",m.style),i.BMQ("data-pc-name","inputgroup"))},dependencies:[a.YU,a.B3],encapsulation:2})}return o})(),s=(()=>{class o{static \u0275fac=function(c){return new(c||o)};static \u0275mod=i.$C({type:o});static \u0275inj=i.G2t({imports:[a.MD,t.Gg]})}return o})()},4602:(b,v,n)=>{n.d(v,{S:()=>d,k:()=>s});var a=n(177),i=n(4438),t=n(5779);const _=["*"];let d=(()=>{class o{style;styleClass;static \u0275fac=function(c){return new(c||o)};static \u0275cmp=i.VBU({type:o,selectors:[["p-inputGroupAddon"]],hostAttrs:[1,"p-element","p-inputgroup-addon"],inputs:{style:"style",styleClass:"styleClass"},ngContentSelectors:_,decls:2,vars:3,consts:[[3,"ngClass","ngStyle"]],template:function(c,m){1&c&&(i.NAR(),i.j41(0,"div",0),i.SdG(1),i.k0s()),2&c&&(i.Y8G("ngClass",m.styleClass)("ngStyle",m.style),i.BMQ("data-pc-name","inputgroupaddon"))},dependencies:[a.YU,a.B3],encapsulation:2})}return o})(),s=(()=>{class o{static \u0275fac=function(c){return new(c||o)};static \u0275mod=i.$C({type:o});static \u0275inj=i.G2t({imports:[a.MD,t.Gg]})}return o})()},3227:(b,v,n)=>{n.d(v,{F:()=>D,l:()=>y});var a=n(9969),i=n(177),t=n(4438),_=n(5779),d=n(1455),s=n(2016),o=n(4420);const f=(r,g)=>({showTransitionParams:r,hideTransitionParams:g}),u=r=>({value:"open",params:r}),c=()=>({styleClass:"p-scrolltop-icon"}),m=()=>({"font-size":"1rem",scale:"1.5"});function C(r,g){if(1&r&&t.nrm(0,"span",6),2&r){const e=t.XpG(3);t.HbH(e.icon),t.Y8G("ngClass","p-scrolltop-icon")}}function P(r,g){1&r&&t.nrm(0,"ChevronUpIcon",7),2&r&&t.Y8G("styleClass","p-scrolltop-icon")("ngStyle",t.lJ4(2,m))}function S(r,g){if(1&r&&(t.qex(0),t.DNE(1,C,1,3,"span",4)(2,P,1,3,"ChevronUpIcon",5),t.bVm()),2&r){const e=t.XpG(2);t.R7$(),t.Y8G("ngIf",e.icon),t.R7$(),t.Y8G("ngIf",!e.icon)}}function T(r,g){}function U(r,g){if(1&r&&t.DNE(0,T,0,0,"ng-template",8),2&r){const e=t.XpG(2);t.Y8G("ngIf",!e.icon)}}function h(r,g){if(1&r){const e=t.RV6();t.j41(0,"button",1),t.bIt("@animation.start",function(l){t.eBV(e);const E=t.XpG();return t.Njj(E.onEnter(l))})("@animation.done",function(l){t.eBV(e);const E=t.XpG();return t.Njj(E.onLeave(l))})("click",function(){t.eBV(e);const l=t.XpG();return t.Njj(l.onClick())}),t.DNE(1,S,3,2,"ng-container",2)(2,U,1,1,null,3),t.k0s()}if(2&r){const e=t.XpG();t.HbH(e.styleClass),t.Y8G("@animation",t.eq3(12,u,t.l_i(9,f,e.showTransitionOptions,e.hideTransitionOptions)))("ngClass",e.containerClass())("ngStyle",e.style),t.BMQ("aria-label",e.buttonAriaLabel),t.R7$(),t.Y8G("ngIf",!e.iconTemplate),t.R7$(),t.Y8G("ngTemplateOutlet",e.iconTemplate)("ngTemplateOutletContext",t.lJ4(14,c))}}let y=(()=>{class r{document;platformId;renderer;el;cd;config;styleClass;style;target="window";threshold=400;icon;behavior="smooth";showTransitionOptions=".15s";hideTransitionOptions=".15s";buttonAriaLabel;templates;iconTemplate;documentScrollListener;parentScrollListener;visible=!1;overlay;window;constructor(e,p,l,E,M,O){this.document=e,this.platformId=p,this.renderer=l,this.el=E,this.cd=M,this.config=O,this.window=this.document.defaultView}ngOnInit(){"window"===this.target?this.bindDocumentScrollListener():"parent"===this.target&&this.bindParentScrollListener()}ngAfterContentInit(){this.templates.forEach(e=>{"icon"===e.getType()&&(this.iconTemplate=e.template)})}onClick(){("window"===this.target?this.window:this.el.nativeElement.parentElement).scroll({top:0,behavior:this.behavior})}onEnter(e){switch(e.toState){case"open":this.overlay=e.element,o.Q$.set("overlay",this.overlay,this.config.zIndex.overlay);break;case"void":this.overlay=null}}onLeave(e){"void"===e.toState&&o.Q$.clear(e.element)}checkVisibility(e){this.visible=e>this.threshold,this.cd.markForCheck()}bindParentScrollListener(){(0,i.UE)(this.platformId)&&(this.parentScrollListener=this.renderer.listen(this.el.nativeElement.parentElement,"scroll",()=>{this.checkVisibility(this.el.nativeElement.parentElement.scrollTop)}))}bindDocumentScrollListener(){(0,i.UE)(this.platformId)&&(this.documentScrollListener=this.renderer.listen(this.window,"scroll",()=>{this.checkVisibility(d.D.getWindowScrollTop())}))}unbindParentScrollListener(){this.parentScrollListener&&(this.parentScrollListener(),this.parentScrollListener=null)}unbindDocumentScrollListener(){this.documentScrollListener&&(this.documentScrollListener(),this.documentScrollListener=null)}containerClass(){return{"p-scrolltop p-link p-component":!0,"p-scrolltop-sticky":"window"!==this.target}}ngOnDestroy(){"window"===this.target?this.unbindDocumentScrollListener():"parent"===this.target&&this.unbindParentScrollListener(),this.overlay&&(o.Q$.clear(this.overlay),this.overlay=null)}static \u0275fac=function(p){return new(p||r)(t.rXU(i.qQ),t.rXU(t.Agw),t.rXU(t.sFG),t.rXU(t.aKT),t.rXU(t.gRc),t.rXU(_.r1))};static \u0275cmp=t.VBU({type:r,selectors:[["p-scrollTop"]],contentQueries:function(p,l,E){if(1&p&&t.wni(E,_.Ei,4),2&p){let M;t.mGM(M=t.lsd())&&(l.templates=M)}},hostAttrs:[1,"p-element"],inputs:{styleClass:"styleClass",style:"style",target:"target",threshold:[2,"threshold","threshold",t.Udg],icon:"icon",behavior:"behavior",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",buttonAriaLabel:"buttonAriaLabel"},features:[t.GFd],decls:1,vars:1,consts:[["type","button",3,"ngClass","class","ngStyle","click",4,"ngIf"],["type","button",3,"click","ngClass","ngStyle"],[4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"class","ngClass",4,"ngIf"],[3,"styleClass","ngStyle",4,"ngIf"],[3,"ngClass"],[3,"styleClass","ngStyle"],[3,"ngIf"]],template:function(p,l){1&p&&t.DNE(0,h,3,15,"button",0),2&p&&t.Y8G("ngIf",l.visible)},dependencies:()=>[i.YU,i.bT,i.T3,i.B3,s.M],styles:["@layer primeng{.p-scrolltop{position:fixed;bottom:20px;right:20px;display:flex;align-items:center;justify-content:center}.p-scrolltop-sticky{position:sticky}.p-scrolltop-sticky.p-link{margin-left:auto}}\n"],encapsulation:2,data:{animation:[(0,a.hZ)("animation",[(0,a.wk)("void",(0,a.iF)({opacity:0})),(0,a.wk)("open",(0,a.iF)({opacity:1})),(0,a.kY)("void => open",(0,a.i0)("{{showTransitionParams}}")),(0,a.kY)("open => void",(0,a.i0)("{{hideTransitionParams}}"))])]},changeDetection:0})}return r})(),D=(()=>{class r{static \u0275fac=function(p){return new(p||r)};static \u0275mod=t.$C({type:r});static \u0275inj=t.G2t({imports:[i.MD,s.M,_.Gg,_.Gg]})}return r})()},5716:(b,v,n)=>{n.d(v,{E:()=>t,k:()=>_});var a=n(177),i=n(4438);let t=(()=>{class d{styleClass;style;shape="rectangle";animation="wave";borderRadius;size;width="100%";height="1rem";containerClass(){return{"p-skeleton p-component":!0,"p-skeleton-circle":"circle"===this.shape,"p-skeleton-none":"none"===this.animation}}get containerStyle(){return this.size?{...this.style,width:this.size,height:this.size,borderRadius:this.borderRadius}:{width:this.width,height:this.height,borderRadius:this.borderRadius,...this.style}}static \u0275fac=function(f){return new(f||d)};static \u0275cmp=i.VBU({type:d,selectors:[["p-skeleton"]],hostAttrs:[1,"p-element"],inputs:{styleClass:"styleClass",style:"style",shape:"shape",animation:"animation",borderRadius:"borderRadius",size:"size",width:"width",height:"height"},decls:1,vars:7,consts:[[3,"ngClass","ngStyle"]],template:function(f,u){1&f&&i.nrm(0,"div",0),2&f&&(i.HbH(u.styleClass),i.Y8G("ngClass",u.containerClass())("ngStyle",u.containerStyle),i.BMQ("data-pc-name","skeleton")("aria-hidden",!0)("data-pc-section","root"))},dependencies:[a.YU,a.B3],styles:['@layer primeng{.p-skeleton{position:relative;overflow:hidden}.p-skeleton:after{content:"";animation:p-skeleton-animation 1.2s infinite;height:100%;left:0;position:absolute;right:0;top:0;transform:translate(-100%);z-index:1}.p-skeleton.p-skeleton-circle{border-radius:50%}.p-skeleton-none:after{animation:none}}@keyframes p-skeleton-animation{0%{transform:translate(-100%)}to{transform:translate(100%)}}\n'],encapsulation:2,changeDetection:0})}return d})(),_=(()=>{class d{static \u0275fac=function(f){return new(f||d)};static \u0275mod=i.$C({type:d});static \u0275inj=i.G2t({imports:[a.MD]})}return d})()}}]);