"use strict";(self.webpackChunkseller=self.webpackChunkseller||[]).push([[76],{6229:(T,M,s)=>{s.d(M,{c:()=>a,q:()=>l});var a=function(t){return t[t.ThisDay=0]="ThisDay",t[t.PreviousDay=1]="PreviousDay",t[t.Day=2]="Day",t[t.ThisWeek=3]="ThisWeek",t[t.PreviousWeek=4]="PreviousWeek",t[t.Week=5]="Week",t[t.ThisMonth=6]="ThisMonth",t[t.PreviousMonth=7]="PreviousMonth",t[t.Month=8]="Month",t[t.Custom=9]="Custom",t}(a||{});class l{static getDateRange(p,c){let n=new Date,o=null;switch(p){case a.ThisDay:n.setHours(0,0,0,0);break;case a.PreviousDay:n.setDate(n.getDate()-1),n.setHours(0,0,0,0),o=new Date(n);break;case a.Day:n.setDate(n.getDate()-1);break;case a.ThisWeek:n.setDate(n.getDate()-(n.getDay()?n.getDay()-1:6)),n.setHours(0,0,0,0);break;case a.PreviousWeek:o=new Date(n);const h=o.getDay()??7;o.setHours(0,0,0,0),o.setDate(o.getDate()-h),n=new Date(o),n.setDate(n.getDate()-6);break;case a.Week:n.setDate(n.getDate()-7);break;case a.ThisMonth:n.setHours(0,0,0,0),n.setDate(1);break;case a.PreviousMonth:n.setHours(0,0,0,0),n.setDate(1),o=new Date(n),o.setDate(o.getDate()-1),n.setMonth(n.getMonth()-1);break;case a.Month:n.setMonth(n.getMonth()-1);break;default:n=c?.[0],n=null==n?null:new Date(n.getFullYear(),n.getMonth(),n.getDate()),o=c?.[1],o=null==o?null:new Date(o.getFullYear(),o.getMonth(),o.getDate())}return[n,o]}}},6398:(T,M,s)=>{s.d(M,{O:()=>S});var a=s(2180),l=s(4153),t=s(6229),p=s(4412),c=s(6977),n=s(5964),o=s(9437),m=s(983),h=s(9820),D=s(4438),v=s(5779),O=s(4238),b=s(345);let S=(()=>{class P extends a.x{static{this.FilterID="OzonReturnListComponent"}constructor(d,E,f,i){super(i),this.ozonSalesOrderClient=d,this.messageService=E,this.dbService=f,this.maxProductCount=5,this.dateRangeType=t.c.Month,this.filterModel={},this.reportSubject=new p.t(null),this.loading=!1,this.chartOptions={maintainAspectRatio:!1,plugins:{tooltip:{callbacks:{label:function(_){let e=_.dataset.label;return _.dataset.labels&&(e=_.dataset.labels.join("\r\n")),e}}}},responsive:!0,scales:{x:{type:"time",time:{unit:"day",displayFormats:{day:"D.MM.yy"}}},y:{stepSize:1,suggestedMax:5,beginAtZero:!1}}},this.data=new p.t(void 0)}ngOnChanges(d){d.maxProductCount&&this.updateChart()}ngOnInit(){this.titleService.setTitle("\u0417\u0430\u043a\u0430\u0437\u044b Ozon"),this.reportSubject.pipe((0,c.Q)(this.destroyed)).pipe((0,n.p)(d=>!!d)).subscribe(d=>{const E=Object.assign({},d,{productPackageIDs:[]});this.dbService.update("filters",{id:P.FilterID,data:E}).pipe((0,o.W)(f=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u044f \u0444\u0438\u043b\u044c\u0442\u0440\u0430",severity:"error",detail:f}),m.w))).subscribe(()=>{this.getReport(d)})}),this.data.pipe((0,c.Q)(this.destroyed)).subscribe(()=>this.updateChart()),this.dbService.getByID("filters",P.FilterID).subscribe(d=>{d&&d.data&&(this.filterModel=d.data),this.reportSubject.next(this.filterModel)})}getReport(d){let[E,f]=t.q.getDateRange(this.dateRangeType,this.dateRange);null!=f?f.setDate(f.getDate()+1):f=new Date,d.dateFrom=E,d.dateTo=f;const i=new l.D.FindOzonReturnsModel(d);this.loading=!0,this.ozonSalesOrderClient.getReturnReport(i).pipe((0,o.W)(_=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0437\u0430\u043a\u0430\u0437\u043e\u0432",severity:"error",detail:_}),this.loading=!1,m.w))).subscribe(_=>{this.loading=!1,this.data.next(_)})}updateChart(){const d=this.data.value;if(!d)return void(this.chartData=void 0);const f=this.filterModel.dateTo;let i=new Date(this.filterModel.dateFrom);i.setUTCHours(0,0,0,0);const _={};for(let r=0;i<=f;r++)_[i.toISOString()]=r,i.setDate(i.getDate()+1);const e=Object.keys(d).map(r=>{const g=[];for(const y in _)g.push({x:y,y:0});let C=0;return d[r].forEach(y=>{g[_[y.Date]].y=y.Quantity,C+=y.Quantity}),{label:r,data:g,tension:0,returnCount:C,labels:void 0}});this.chartData={datasets:e};const u=+this.maxProductCount;if(u&&e.length>u){e.sort((r,g)=>g.returnCount-r.returnCount);for(let r=0;r<e.length;r++)r==u?(e[u].label="\u041e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0435",e[u].labels=[e[r].label]):r>u&&(e[u].labels.push(e[r].label),e[r].data.forEach((g,C)=>{e[u].data[C].y+=g.y}))}e.forEach((r,g)=>{let C=-1,y=-1;r.data.forEach((I,W)=>{I.y&&(-1==C&&(C=W),y=W)}),r.data.splice(y+1),r.data.splice(0,C)}),e.splice(u+1)}static{this.\u0275fac=function(E){return new(E||P)(D.rXU(l.D.OzonSalesOrderClient),D.rXU(v.bg),D.rXU(O.MX),D.rXU(b.hE))}}static{this.\u0275cmp=D.VBU({type:P,selectors:[["app-ozon-return-list"]],inputs:{maxProductCount:"maxProductCount"},standalone:!0,features:[D.Vt3,D.OA$,D.aNF],decls:1,vars:2,consts:[["type","line",3,"data","options"]],template:function(E,f){1&E&&D.nrm(0,"p-chart",0),2&E&&D.Y8G("data",f.chartData)("options",f.chartOptions)},dependencies:[h.F,h.X]})}}return P})()},8805:(T,M,s)=>{s.d(M,{t:()=>m});var a=s(9437),l=s(983),t=s(4412),p=s(4153),c=s(4438),n=s(6557),o=s(5779);let m=(()=>{class h{importOzonWarehouses(){return this.warehouseCommandHandlerClient.importOzonWarehouses().pipe((0,a.W)(v=>(this.messageService.add({summary:"\u041e\u0448\u0438\u0431\u043a\u0430 \u0438\u043c\u043f\u043e\u0440\u0442\u0430 \u0441\u043a\u043b\u0430\u0434\u043e\u0432 \u041e\u0437\u043e\u043d",severity:"error",detail:v}),l.w)))}constructor(v,O,b){this.ozonWarehouseClient=v,this.warehouseCommandHandlerClient=O,this.messageService=b,this.warehouses=new t.t(null)}getWarehouses(){return this.ozonWarehouseClient.getOzonWarehouses(new p.D.FindOzonWarehousesModel({includeAliases:!0}))}getWarehouseClusters(){return this.ozonWarehouseClient.getOzonWarehouseClusters(new p.D.FindOzonWarehouseClustersModel({includeAliases:!1,includeWarehouses:!1}))}updateWarehouse(v){return this.warehouseCommandHandlerClient.updateOzonWarehouse(v)}static{this.\u0275fac=function(O){return new(O||h)(c.KVO(p.D.WarehouseClient),c.KVO(n.X.WarehouseClient),c.KVO(o.bg))}}static{this.\u0275prov=c.jDH({token:h,factory:h.\u0275fac,providedIn:"root"})}}return h})()},3294:(T,M,s)=>{s.d(M,{F:()=>p});var a=s(3669),l=s(9974),t=s(4360);function p(n,o=a.D){return n=n??c,(0,l.N)((m,h)=>{let D,v=!0;m.subscribe((0,t._)(h,O=>{const b=o(O);(v||!n(D,b))&&(v=!1,D=b,h.next(O))}))})}function c(n,o){return n===o}},3227:(T,M,s)=>{s.d(M,{F:()=>f,l:()=>E});var a=s(9969),l=s(177),t=s(4438),p=s(5779),c=s(1455),n=s(2016),o=s(4420);const m=(i,_)=>({showTransitionParams:i,hideTransitionParams:_}),h=i=>({value:"open",params:i}),D=()=>({styleClass:"p-scrolltop-icon"}),v=()=>({"font-size":"1rem",scale:"1.5"});function O(i,_){if(1&i&&t.nrm(0,"span",6),2&i){const e=t.XpG(3);t.HbH(e.icon),t.Y8G("ngClass","p-scrolltop-icon")}}function b(i,_){1&i&&t.nrm(0,"ChevronUpIcon",7),2&i&&t.Y8G("styleClass","p-scrolltop-icon")("ngStyle",t.lJ4(2,v))}function S(i,_){if(1&i&&(t.qex(0),t.DNE(1,O,1,3,"span",4)(2,b,1,3,"ChevronUpIcon",5),t.bVm()),2&i){const e=t.XpG(2);t.R7$(),t.Y8G("ngIf",e.icon),t.R7$(),t.Y8G("ngIf",!e.icon)}}function P(i,_){}function L(i,_){if(1&i&&t.DNE(0,P,0,0,"ng-template",8),2&i){const e=t.XpG(2);t.Y8G("ngIf",!e.icon)}}function d(i,_){if(1&i){const e=t.RV6();t.j41(0,"button",1),t.bIt("@animation.start",function(r){t.eBV(e);const g=t.XpG();return t.Njj(g.onEnter(r))})("@animation.done",function(r){t.eBV(e);const g=t.XpG();return t.Njj(g.onLeave(r))})("click",function(){t.eBV(e);const r=t.XpG();return t.Njj(r.onClick())}),t.DNE(1,S,3,2,"ng-container",2)(2,L,1,1,null,3),t.k0s()}if(2&i){const e=t.XpG();t.HbH(e.styleClass),t.Y8G("@animation",t.eq3(12,h,t.l_i(9,m,e.showTransitionOptions,e.hideTransitionOptions)))("ngClass",e.containerClass())("ngStyle",e.style),t.BMQ("aria-label",e.buttonAriaLabel),t.R7$(),t.Y8G("ngIf",!e.iconTemplate),t.R7$(),t.Y8G("ngTemplateOutlet",e.iconTemplate)("ngTemplateOutletContext",t.lJ4(14,D))}}let E=(()=>{class i{document;platformId;renderer;el;cd;config;styleClass;style;target="window";threshold=400;icon;behavior="smooth";showTransitionOptions=".15s";hideTransitionOptions=".15s";buttonAriaLabel;templates;iconTemplate;documentScrollListener;parentScrollListener;visible=!1;overlay;window;constructor(e,u,r,g,C,y){this.document=e,this.platformId=u,this.renderer=r,this.el=g,this.cd=C,this.config=y,this.window=this.document.defaultView}ngOnInit(){"window"===this.target?this.bindDocumentScrollListener():"parent"===this.target&&this.bindParentScrollListener()}ngAfterContentInit(){this.templates.forEach(e=>{"icon"===e.getType()&&(this.iconTemplate=e.template)})}onClick(){("window"===this.target?this.window:this.el.nativeElement.parentElement).scroll({top:0,behavior:this.behavior})}onEnter(e){switch(e.toState){case"open":this.overlay=e.element,o.Q$.set("overlay",this.overlay,this.config.zIndex.overlay);break;case"void":this.overlay=null}}onLeave(e){"void"===e.toState&&o.Q$.clear(e.element)}checkVisibility(e){this.visible=e>this.threshold,this.cd.markForCheck()}bindParentScrollListener(){(0,l.UE)(this.platformId)&&(this.parentScrollListener=this.renderer.listen(this.el.nativeElement.parentElement,"scroll",()=>{this.checkVisibility(this.el.nativeElement.parentElement.scrollTop)}))}bindDocumentScrollListener(){(0,l.UE)(this.platformId)&&(this.documentScrollListener=this.renderer.listen(this.window,"scroll",()=>{this.checkVisibility(c.D.getWindowScrollTop())}))}unbindParentScrollListener(){this.parentScrollListener&&(this.parentScrollListener(),this.parentScrollListener=null)}unbindDocumentScrollListener(){this.documentScrollListener&&(this.documentScrollListener(),this.documentScrollListener=null)}containerClass(){return{"p-scrolltop p-link p-component":!0,"p-scrolltop-sticky":"window"!==this.target}}ngOnDestroy(){"window"===this.target?this.unbindDocumentScrollListener():"parent"===this.target&&this.unbindParentScrollListener(),this.overlay&&(o.Q$.clear(this.overlay),this.overlay=null)}static \u0275fac=function(u){return new(u||i)(t.rXU(l.qQ),t.rXU(t.Agw),t.rXU(t.sFG),t.rXU(t.aKT),t.rXU(t.gRc),t.rXU(p.r1))};static \u0275cmp=t.VBU({type:i,selectors:[["p-scrollTop"]],contentQueries:function(u,r,g){if(1&u&&t.wni(g,p.Ei,4),2&u){let C;t.mGM(C=t.lsd())&&(r.templates=C)}},hostAttrs:[1,"p-element"],inputs:{styleClass:"styleClass",style:"style",target:"target",threshold:[2,"threshold","threshold",t.Udg],icon:"icon",behavior:"behavior",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",buttonAriaLabel:"buttonAriaLabel"},features:[t.GFd],decls:1,vars:1,consts:[["type","button",3,"ngClass","class","ngStyle","click",4,"ngIf"],["type","button",3,"click","ngClass","ngStyle"],[4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"class","ngClass",4,"ngIf"],[3,"styleClass","ngStyle",4,"ngIf"],[3,"ngClass"],[3,"styleClass","ngStyle"],[3,"ngIf"]],template:function(u,r){1&u&&t.DNE(0,d,3,15,"button",0),2&u&&t.Y8G("ngIf",r.visible)},dependencies:()=>[l.YU,l.bT,l.T3,l.B3,n.M],styles:["@layer primeng{.p-scrolltop{position:fixed;bottom:20px;right:20px;display:flex;align-items:center;justify-content:center}.p-scrolltop-sticky{position:sticky}.p-scrolltop-sticky.p-link{margin-left:auto}}\n"],encapsulation:2,data:{animation:[(0,a.hZ)("animation",[(0,a.wk)("void",(0,a.iF)({opacity:0})),(0,a.wk)("open",(0,a.iF)({opacity:1})),(0,a.kY)("void => open",(0,a.i0)("{{showTransitionParams}}")),(0,a.kY)("open => void",(0,a.i0)("{{hideTransitionParams}}"))])]},changeDetection:0})}return i})(),f=(()=>{class i{static \u0275fac=function(u){return new(u||i)};static \u0275mod=t.$C({type:i});static \u0275inj=t.G2t({imports:[l.MD,n.M,p.Gg,p.Gg]})}return i})()},5716:(T,M,s)=>{s.d(M,{E:()=>t,k:()=>p});var a=s(177),l=s(4438);let t=(()=>{class c{styleClass;style;shape="rectangle";animation="wave";borderRadius;size;width="100%";height="1rem";containerClass(){return{"p-skeleton p-component":!0,"p-skeleton-circle":"circle"===this.shape,"p-skeleton-none":"none"===this.animation}}get containerStyle(){return this.size?{...this.style,width:this.size,height:this.size,borderRadius:this.borderRadius}:{width:this.width,height:this.height,borderRadius:this.borderRadius,...this.style}}static \u0275fac=function(m){return new(m||c)};static \u0275cmp=l.VBU({type:c,selectors:[["p-skeleton"]],hostAttrs:[1,"p-element"],inputs:{styleClass:"styleClass",style:"style",shape:"shape",animation:"animation",borderRadius:"borderRadius",size:"size",width:"width",height:"height"},decls:1,vars:7,consts:[[3,"ngClass","ngStyle"]],template:function(m,h){1&m&&l.nrm(0,"div",0),2&m&&(l.HbH(h.styleClass),l.Y8G("ngClass",h.containerClass())("ngStyle",h.containerStyle),l.BMQ("data-pc-name","skeleton")("aria-hidden",!0)("data-pc-section","root"))},dependencies:[a.YU,a.B3],styles:['@layer primeng{.p-skeleton{position:relative;overflow:hidden}.p-skeleton:after{content:"";animation:p-skeleton-animation 1.2s infinite;height:100%;left:0;position:absolute;right:0;top:0;transform:translate(-100%);z-index:1}.p-skeleton.p-skeleton-circle{border-radius:50%}.p-skeleton-none:after{animation:none}}@keyframes p-skeleton-animation{0%{transform:translate(-100%)}to{transform:translate(100%)}}\n'],encapsulation:2,changeDetection:0})}return c})(),p=(()=>{class c{static \u0275fac=function(m){return new(m||c)};static \u0275mod=l.$C({type:c});static \u0275inj=l.G2t({imports:[a.MD]})}return c})()}}]);