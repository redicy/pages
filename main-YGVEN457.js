import{a as Kn,b as Xn,c as Qn,d as Yn,e as Do,f as Oo,g as Aa,h as ml,i as hl,j as dn,k as Hc,o as Dd}from"./chunk-VFLAHHQV.js";import{a as er,b as Pd,c as Od}from"./chunk-XHMUVXYE.js";import{A as Ia,B as Gr,C as kd,D as Zi,E as en,F as Fi,G as fl,H as Td,I as Ed,J as Id,K as Fd,L as Fa,M as Ad,N as Kr,O as fe,a as nd,b as od,c as ad,d as sd,e as Ta,f as ud,g as dd,h as nl,i as pd,j as fd,k as ol,l as xr,m as vr,n as Sn,o as bd,p as Jn,q as qn,r as Ei,s as Ii,t as Cd,u as wd,v as ul,w as dl,x as pl,y as Sd,z as Ea}from"./chunk-RVAIFJGO.js";import{a as cl,b as $c,c as gl}from"./chunk-GCFCFXSC.js";import{a as tl,b as Gn,d as Ur,e as Wr,f as rl,g as rd,h as jr,i as id,j as cd,k as ho,l as hd,n as al,o as sl,p as Yi,q as wn,r as ei,s as On,t as Po,u as yd}from"./chunk-JA7L7UN5.js";import{c as $n,d as qi,f as ki,g as mo,h as Qi,i as Wc,k as jc}from"./chunk-6QOQO26M.js";import{$ as Ku,$a as Dn,A as Io,Aa as cn,Ba as Xi,C as et,D as Wn,Da as Ao,E as Vu,Ea as Yu,F as zu,G as Zr,Ga as Zu,H as Xs,Ha as un,I as Js,Ia as ka,J as Sa,Ja as Ji,K as qs,L as jn,M as Fo,Ma as Qs,N as Uu,Na as Yt,O as Wu,Oa as Ys,P as ju,Pa as ed,Q as Hu,Qa as Zs,R as Ki,Ra as pi,Sa as It,T as $u,Ta as qr,U as Lc,Ua as ir,Va as el,Wa as td,X as Gu,Xa as Jt,Y as Nc,Ya as Zt,Za as Ge,_a as Er,a as Rc,ab as il,b as ct,bb as ld,c as Gs,cb as md,d as ut,db as gd,e as dt,f as Du,fb as _d,g as Tr,ga as Xr,h as Ou,ha as Jr,hb as ll,i as Bu,ia as Hn,ib as xd,j as Mu,ja as Xu,k as Ru,ka as Ju,kb as vd,lb as Ti,m as Lu,mb as Ht,na as qu,nb as nr,o as Nu,oa as Vc,p as Br,q as Mr,r as bt,ra as ps,u as zn,v as Rr,w as Un,wa as zc,xa as Uc,y as yn,ya as Qu,z as Ks,za as Cn}from"./chunk-2T6NNSQE.js";import{$b as Qt,A as Tc,Ab as g,Ac as Ze,B as du,Bb as d,Bc as _r,Ca as xu,Cb as u,Cc as Et,D as Ec,Db as Y,E as wr,Eb as Oc,Ec as Z,F as ge,Fb as Bc,G as pu,Gb as ds,H as Ic,Hb as Le,I as Ca,Ib as Ne,Ic as Mt,Jb as Tt,Jc as Yo,K as Xo,Kb as pe,L as Ws,Lb as $s,Lc as Au,Mc as kr,Nc as Pu,Ob as ee,Oc as Zo,Pb as h,Qa as Vn,Qb as Sr,R as Fc,Ra as Gt,Rb as gr,Sb as Ke,T as xi,Ta as p,Tb as Nt,U as Yr,Ub as Te,Uc as $e,V as us,Vb as Ee,Vc as Or,W as fu,Wb as wu,Xa as vu,Xb as Su,Y as Ni,Ya as xt,Yb as Dr,Z as Ye,Za as Pn,Zb as Vi,_ as mr,_b as ku,a as Pr,aa as wt,ab as bu,ac as _e,b as vn,ba as Pt,bb as Ac,bc as v,ca as we,cb as Pe,cc as he,da as mu,db as yu,dc as Ie,e as A1,ec as zi,f as P1,fc as Jo,g as ln,gc as Se,hb as He,hc as ke,ia as O,ib as hr,ic as Fe,j as ba,ja as B,jc as Tu,ka as $t,kb as Pc,kc as Eu,la as hu,lb as lt,lc as qo,m as bn,ma as gu,mb as Xt,mc as Qo,n as ur,nb as P,nc as Si,o as it,oc as Mc,pc as Dt,q as Sc,qa as zr,qc as Je,r as be,ra as _u,rb as Cu,rc as vt,s as xe,sc as di,t as ya,tc as fo,ub as Ue,v as cs,va as ht,vb as ft,vc as Iu,wb as mt,x as ne,xa as wa,xb as Dc,yb as js,yc as Fu,z as kc,zb as Hs}from"./chunk-TGGQRBPQ.js";var x1=A1((su,lu)=>{(function(t,r){typeof define=="function"&&define.amd?define([],r):typeof su<"u"?r():(r(),t.FileSaver={})})(su,function(){"use strict";function t(l,c){return typeof c>"u"?c={autoBom:!1}:typeof c!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),c={autoBom:!c}),c.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(l.type)?new Blob(["\uFEFF",l],{type:l.type}):l}function r(l,c,f){var m=new XMLHttpRequest;m.open("GET",l),m.responseType="blob",m.onload=function(){a(m.response,c,f)},m.onerror=function(){console.error("could not download file")},m.send()}function e(l){var c=new XMLHttpRequest;c.open("HEAD",l,!1);try{c.send()}catch{}return 200<=c.status&&299>=c.status}function n(l){try{l.dispatchEvent(new MouseEvent("click"))}catch{var c=document.createEvent("MouseEvents");c.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),l.dispatchEvent(c)}}var i=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof global=="object"&&global.global===global?global:void 0,o=i.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),a=i.saveAs||(typeof window!="object"||window!==i?function(){}:"download"in HTMLAnchorElement.prototype&&!o?function(l,c,f){var m=i.URL||i.webkitURL,C=document.createElement("a");c=c||l.name||"download",C.download=c,C.rel="noopener",typeof l=="string"?(C.href=l,C.origin===location.origin?n(C):e(C.href)?r(l,c,f):n(C,C.target="_blank")):(C.href=m.createObjectURL(l),setTimeout(function(){m.revokeObjectURL(C.href)},4e4),setTimeout(function(){n(C)},0))}:"msSaveOrOpenBlob"in navigator?function(l,c,f){if(c=c||l.name||"download",typeof l!="string")navigator.msSaveOrOpenBlob(t(l,f),c);else if(e(l))r(l,c,f);else{var m=document.createElement("a");m.href=l,m.target="_blank",setTimeout(function(){n(m)})}}:function(l,c,f,m){if(m=m||open("","_blank"),m&&(m.document.title=m.document.body.innerText="downloading..."),typeof l=="string")return r(l,c,f);var C=l.type==="application/octet-stream",y=/constructor/i.test(i.HTMLElement)||i.safari,k=/CriOS\/[\d]+/.test(navigator.userAgent);if((k||C&&y||o)&&typeof FileReader<"u"){var S=new FileReader;S.onloadend=function(){var A=S.result;A=k?A:A.replace(/^data:[^;]*;/,"data:attachment/file;"),m?m.location.href=A:location=A,m=null},S.readAsDataURL(l)}else{var M=i.URL||i.webkitURL,E=M.createObjectURL(l);m?m.location=E:location.href=E,m=null,setTimeout(function(){M.revokeObjectURL(E)},4e4)}});i.saveAs=a.saveAs=a,typeof lu<"u"&&(lu.exports=a)})});var go={};var hs=class{},O1=(()=>{class t{handle(e){return e.key}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ye({token:t,factory:t.\u0275fac})}return t})(),Da=class{},B1=(()=>{class t extends Da{compile(e,n){return e}compileTranslations(e,n){return e}static \u0275fac=(()=>{let e;return function(i){return(e||(e=ht(t)))(i||t)}})();static \u0275prov=Ye({token:t,factory:t.\u0275fac})}return t})(),Bo=class{},M1=(()=>{class t extends Bo{getTranslation(e){return be({})}static \u0275fac=(()=>{let e;return function(i){return(e||(e=ht(t)))(i||t)}})();static \u0275prov=Ye({token:t,factory:t.\u0275fac})}return t})();function ea(t){return typeof t<"u"&&t!==null}function Bd(t){return t!==void 0}function Pa(t){return ms(t)&&!ta(t)&&t!==null}function ms(t){return typeof t=="object"&&t!==null}function ta(t){return Array.isArray(t)}function Gc(t){return typeof t=="string"}function R1(t){return typeof t=="function"}function _l(t){if(ta(t))return t.map(r=>_l(r));if(Pa(t)){let r={};return Object.keys(t).forEach(e=>{r[e]=_l(t[e])}),r}else return t}function Jc(t,r){if(!ms(t))return _l(r);let e=_l(t);return ms(e)&&ms(r)&&Object.keys(r).forEach(n=>{Pa(r[n])?n in t?e[n]=Jc(t[n],r[n]):Object.assign(e,{[n]:r[n]}):Object.assign(e,{[n]:r[n]})}),e}function Md(t,r){let e=r.split(".");r="";do{r+=e.shift();let n=!e.length;if(ea(t)){if(Pa(t)&&Bd(t[r])&&(Pa(t[r])||ta(t[r])||n)){t=t[r],r="";continue}if(ta(t)){let i=parseInt(r,10);if(Bd(t[i])&&(Pa(t[i])||ta(t[i])||n)){t=t[i],r="";continue}}}if(n){t=void 0;continue}r+="."}while(e.length);return t}function L1(t,r,e){return Jc(t,N1(r,e))}function N1(t,r){return t.split(".").reduceRight((e,n)=>({[n]:e}),r)}var Oa=class{},V1=(()=>{class t extends Oa{templateMatcher=/{{\s?([^{}\s]*)\s?}}/g;interpolate(e,n){if(Gc(e))return this.interpolateString(e,n);if(R1(e))return this.interpolateFunction(e,n)}interpolateFunction(e,n){return e(n)}interpolateString(e,n){return n?e.replace(this.templateMatcher,(i,o)=>{let a=this.getInterpolationReplacement(n,o);return a!==void 0?a:i}):e}getInterpolationReplacement(e,n){return this.formatValue(Md(e,n))}formatValue(e){if(Gc(e))return e;if(typeof e=="number"||typeof e=="boolean")return e.toString();if(e===null)return"null";if(ta(e))return e.join(", ");if(ms(e))return typeof e.toString=="function"&&e.toString!==Object.prototype.toString?e.toString():JSON.stringify(e)}static \u0275fac=(()=>{let e;return function(i){return(e||(e=ht(t)))(i||t)}})();static \u0275prov=Ye({token:t,factory:t.\u0275fac})}return t})(),Kc=(()=>{class t{_onTranslationChange=new bn;_onLangChange=new bn;_onFallbackLangChange=new bn;fallbackLang=null;currentLang;translations={};languages=[];getTranslations(e){return this.translations[e]}setTranslations(e,n,i){this.translations[e]=i&&this.hasTranslationFor(e)?Jc(this.translations[e],n):n,this.addLanguages([e]),this._onTranslationChange.next({lang:e,translations:this.getTranslations(e)})}getLanguages(){return this.languages}getCurrentLang(){return this.currentLang}getFallbackLang(){return this.fallbackLang}setFallbackLang(e,n=!0){this.fallbackLang=e,n&&this._onFallbackLangChange.next({lang:e,translations:this.translations[e]})}setCurrentLang(e,n=!0){this.currentLang=e,n&&this._onLangChange.next({lang:e,translations:this.translations[e]})}get onTranslationChange(){return this._onTranslationChange.asObservable()}get onLangChange(){return this._onLangChange.asObservable()}get onFallbackLangChange(){return this._onFallbackLangChange.asObservable()}addLanguages(e){this.languages=Array.from(new Set([...this.languages,...e]))}hasTranslationFor(e){return typeof this.translations[e]<"u"}deleteTranslations(e){delete this.translations[e]}getTranslation(e){let n=this.getValue(this.currentLang,e);return n===void 0&&this.fallbackLang!=null&&this.fallbackLang!==this.currentLang&&(n=this.getValue(this.fallbackLang,e)),n}getValue(e,n){return Md(this.getTranslations(e),n)}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ye({token:t,factory:t.\u0275fac})}return t})(),Xc=new wt("TRANSLATE_CONFIG"),fs=t=>ya(t)?t:be(t);var Ba=(()=>{class t{loadingTranslations;pending=!1;_translationRequests={};lastUseLanguage=null;currentLoader=we(Bo);compiler=we(Da);parser=we(Oa);missingTranslationHandler=we(hs);store=we(Kc);extend=!1;get onTranslationChange(){return this.store.onTranslationChange}get onLangChange(){return this.store.onLangChange}get onFallbackLangChange(){return this.store.onFallbackLangChange}get onDefaultLangChange(){return this.store.onFallbackLangChange}constructor(){let e=Pr({extend:!1,fallbackLang:null},we(Xc,{optional:!0}));e.lang&&this.use(e.lang),e.fallbackLang&&this.setFallbackLang(e.fallbackLang),e.extend&&(this.extend=!0)}setFallbackLang(e){this.getFallbackLang()||this.store.setFallbackLang(e,!1);let n=this.loadOrExtendLanguage(e);return ya(n)?(n.pipe(Xo(1)).subscribe({next:()=>{this.store.setFallbackLang(e)},error:()=>{}}),n):(this.store.setFallbackLang(e),be(this.store.getTranslations(e)))}use(e){this.lastUseLanguage=e,this.getCurrentLang()||this.store.setCurrentLang(e,!1);let n=this.loadOrExtendLanguage(e);return ya(n)?(n.pipe(Xo(1)).subscribe({next:()=>{this.changeLang(e)},error:()=>{}}),n):(this.changeLang(e),be(this.store.getTranslations(e)))}loadOrExtendLanguage(e){if(!this.store.hasTranslationFor(e)||this.extend)return this._translationRequests[e]=this._translationRequests[e]||this.loadAndCompileTranslations(e),this._translationRequests[e]}changeLang(e){e===this.lastUseLanguage&&this.store.setCurrentLang(e)}getCurrentLang(){return this.store.getCurrentLang()}loadAndCompileTranslations(e){this.pending=!0;let n=this.currentLoader.getTranslation(e).pipe(Fc(1),Xo(1));return this.loadingTranslations=n.pipe(cs(i=>this.compiler.compileTranslations(i,e)),Fc(1),Xo(1)),this.loadingTranslations.subscribe({next:i=>{this.store.setTranslations(e,i,this.extend),this.pending=!1},error:i=>{this.pending=!1}}),n}setTranslation(e,n,i=!1){let o=this.compiler.compileTranslations(n,e);this.store.setTranslations(e,o,i||this.extend)}getLangs(){return this.store.getLanguages()}addLangs(e){this.store.addLanguages(e)}getParsedResultForKey(e,n){let i=this.getTextToInterpolate(e);if(ea(i))return this.runInterpolation(i,n);let o=this.missingTranslationHandler.handle(Pr({key:e,translateService:this},n!==void 0&&{interpolateParams:n}));return o!==void 0?o:e}getFallbackLang(){return this.store.getFallbackLang()}getTextToInterpolate(e){return this.store.getTranslation(e)}runInterpolation(e,n){if(ea(e))return ta(e)?this.runInterpolationOnArray(e,n):Pa(e)?this.runInterpolationOnDict(e,n):this.parser.interpolate(e,n)}runInterpolationOnArray(e,n){return e.map(i=>this.runInterpolation(i,n))}runInterpolationOnDict(e,n){let i={};for(let o in e){let a=this.runInterpolation(e[o],n);a!==void 0&&(i[o]=a)}return i}getParsedResult(e,n){return e instanceof Array?this.getParsedResultForArray(e,n):this.getParsedResultForKey(e,n)}getParsedResultForArray(e,n){let i={},o=!1;for(let l of e)i[l]=this.getParsedResultForKey(l,n),o=o||ya(i[l]);if(!o)return i;let a=e.map(l=>fs(i[l]));return du(a).pipe(cs(l=>{let c={};return l.forEach((f,m)=>{c[e[m]]=f}),c}))}get(e,n){if(!ea(e)||!e.length)throw new Error('Parameter "key" is required and cannot be empty');return this.pending?this.loadingTranslations.pipe(pu(()=>fs(this.getParsedResult(e,n)))):fs(this.getParsedResult(e,n))}getStreamOnTranslationChange(e,n){if(!ea(e)||!e.length)throw new Error('Parameter "key" is required and cannot be empty');return kc(Tc(()=>this.get(e,n)),this.onTranslationChange.pipe(xi(()=>{let i=this.getParsedResult(e,n);return fs(i)})))}stream(e,n){if(!ea(e)||!e.length)throw new Error('Parameter "key" required');return kc(Tc(()=>this.get(e,n)),this.onLangChange.pipe(xi(()=>{let i=this.getParsedResult(e,n);return fs(i)})))}instant(e,n){if(!ea(e)||e.length===0)throw new Error('Parameter "key" is required and cannot be empty');let i=this.getParsedResult(e,n);return ya(i)?Array.isArray(e)?e.reduce((o,a)=>(o[a]=a,o),{}):e:i}set(e,n,i=this.getCurrentLang()){this.store.setTranslations(i,L1(this.store.getTranslations(i),e,Gc(n)?this.compiler.compile(n,i):this.compiler.compileTranslations(n,i)),!1)}reloadLang(e){return this.resetLang(e),this.loadAndCompileTranslations(e)}resetLang(e){delete this._translationRequests[e],this.store.deleteTranslations(e)}static getBrowserLang(){if(typeof window>"u"||!window.navigator)return;let e=this.getBrowserCultureLang();return e?e.split(/[-_]/)[0]:void 0}static getBrowserCultureLang(){if(!(typeof window>"u"||typeof window.navigator>"u"))return window.navigator.languages?window.navigator.languages[0]:window.navigator.language||window.navigator.browserLanguage||window.navigator.userLanguage}getBrowserLang(){return t.getBrowserLang()}getBrowserCultureLang(){return t.getBrowserCultureLang()}get defaultLang(){return this.getFallbackLang()}get currentLang(){return this.store.getCurrentLang()}get langs(){return this.store.getLanguages()}setDefaultLang(e){return this.setFallbackLang(e)}getDefaultLang(){return this.getFallbackLang()}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ye({token:t,factory:t.\u0275fac})}return t})();function z1(t){return{provide:Bo,useClass:t}}function U1(t){return{provide:Da,useClass:t}}function W1(t){return{provide:Oa,useClass:t}}function j1(t){return{provide:hs,useClass:t}}function Rd(t={}){return H1(Pr({compiler:U1(B1),parser:W1(V1),loader:z1(M1),missingTranslationHandler:j1(O1)},t),!0)}function H1(t={},r){let e=[];t.loader&&e.push(t.loader),t.compiler&&e.push(t.compiler),t.parser&&e.push(t.parser),t.missingTranslationHandler&&e.push(t.missingTranslationHandler),r&&e.push(Kc),(t.useDefaultLang||t.defaultLanguage)&&(console.warn("The `useDefaultLang` and `defaultLanguage` options are deprecated. Please use `fallbackLang` instead."),t.useDefaultLang===!0&&t.defaultLanguage&&(t.fallbackLang=t.defaultLanguage));let n={fallbackLang:t.fallbackLang??null,lang:t.lang,extend:t.extend??!1};return e.push({provide:Xc,useValue:n}),e.push({provide:Ba,useClass:Ba,deps:[Kc,Bo,Da,Oa,hs,Xc]}),e}var Ld=(()=>{let r=class r{constructor(n,i,o){this.primengConfig=n,this.filterService=i,this.translationService=o}ngOnInit(){this.primengConfig.ripple.set(!0),this.filterService.register("intersects",(n,i)=>i==null||i.length==0?!0:n.some(o=>i.includes(o))),this.filterService.register("exclude",(n,i)=>i==null?!0:n!=i),this.translate("ru")}translate(n){this.translationService.use(n),this.translationService.get("primeng").subscribe(i=>this.primengConfig.setTranslation(i))}};r.\u0275fac=function(i){return new(i||r)(Pe(el),Pe(Qs),Pe(Ba))},r.\u0275cmp=He({type:r,selectors:[["app-root"]],decls:1,vars:0,template:function(i,o){i&1&&Y(0,"router-outlet")},dependencies:[Ki,qs],encapsulation:2});let t=r;return t})();var G1="@",K1=(()=>{class t{doc;delegate;zone;animationType;moduleImpl;_rendererFactoryPromise=null;scheduler=null;injector=we(hu);loadingSchedulerFn=we(X1,{optional:!0});_engine;constructor(e,n,i,o,a){this.doc=e,this.delegate=n,this.zone=i,this.animationType=o,this.moduleImpl=a}ngOnDestroy(){this._engine?.flush()}loadImpl(){let e=()=>this.moduleImpl??import("./chunk-BGFQBWAI.js").then(i=>i),n;return this.loadingSchedulerFn?n=this.loadingSchedulerFn(e):n=e(),n.catch(i=>{throw new fu(5300,!1)}).then(({\u0275createEngine:i,\u0275AnimationRendererFactory:o})=>{this._engine=i(this.animationType,this.doc);let a=new o(this.delegate,this._engine,this.zone);return this.delegate=a,a})}createRenderer(e,n){let i=this.delegate.createRenderer(e,n);if(i.\u0275type===0)return i;typeof i.throwOnSyntheticProps=="boolean"&&(i.throwOnSyntheticProps=!1);let o=new qc(i);return n?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(a=>{let l=a.createRenderer(e,n);o.use(l),this.scheduler??=this.injector.get(_u,null,{optional:!0}),this.scheduler?.notify(10)}).catch(a=>{o.use(i)}),o}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}componentReplaced(e){this._engine?.flush(),this.delegate.componentReplaced?.(e)}static \u0275fac=function(n){yu()};static \u0275prov=Ye({token:t,factory:t.\u0275fac})}return t})(),qc=class{delegate;replay=[];\u0275type=1;constructor(r){this.delegate=r}use(r){if(this.delegate=r,this.replay!==null){for(let e of this.replay)e(r);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(r,e){return this.delegate.createElement(r,e)}createComment(r){return this.delegate.createComment(r)}createText(r){return this.delegate.createText(r)}get destroyNode(){return this.delegate.destroyNode}appendChild(r,e){this.delegate.appendChild(r,e)}insertBefore(r,e,n,i){this.delegate.insertBefore(r,e,n,i)}removeChild(r,e,n,i){this.delegate.removeChild(r,e,n,i)}selectRootElement(r,e){return this.delegate.selectRootElement(r,e)}parentNode(r){return this.delegate.parentNode(r)}nextSibling(r){return this.delegate.nextSibling(r)}setAttribute(r,e,n,i){this.delegate.setAttribute(r,e,n,i)}removeAttribute(r,e,n){this.delegate.removeAttribute(r,e,n)}addClass(r,e){this.delegate.addClass(r,e)}removeClass(r,e){this.delegate.removeClass(r,e)}setStyle(r,e,n,i){this.delegate.setStyle(r,e,n,i)}removeStyle(r,e,n){this.delegate.removeStyle(r,e,n)}setProperty(r,e,n){this.shouldReplay(e)&&this.replay.push(i=>i.setProperty(r,e,n)),this.delegate.setProperty(r,e,n)}setValue(r,e){this.delegate.setValue(r,e)}listen(r,e,n,i){return this.shouldReplay(e)&&this.replay.push(o=>o.listen(r,e,n,i)),this.delegate.listen(r,e,n,i)}shouldReplay(r){return this.replay!==null&&r.startsWith(G1)}},X1=new wt("");function Nd(t="animations"){return vu("NgAsyncAnimations"),mu([{provide:bu,useFactory:(r,e,n)=>new K1(r,e,n,t),deps:[gu,Vu,Pn]},{provide:xu,useValue:t==="noop"?"NoopAnimations":"BrowserAnimations"}])}var J1={transitionDuration:"{transition.duration}"},q1={borderWidth:"0 0 1px 0",borderColor:"{content.border.color}"},Q1={color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{text.color}",activeHoverColor:"{text.color}",padding:"1.125rem",fontWeight:"600",borderRadius:"0",borderWidth:"0",borderColor:"{content.border.color}",background:"{content.background}",hoverBackground:"{content.background}",activeBackground:"{content.background}",activeHoverBackground:"{content.background}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"},toggleIcon:{color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{text.color}",activeHoverColor:"{text.color}"},first:{topBorderRadius:"{content.border.radius}",borderWidth:"0"},last:{bottomBorderRadius:"{content.border.radius}",activeBottomBorderRadius:"0"}},Y1={borderWidth:"0",borderColor:"{content.border.color}",background:"{content.background}",color:"{text.color}",padding:"0 1.125rem 1.125rem 1.125rem"},Vd={root:J1,panel:q1,header:Q1,content:Y1};var Z1={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}"},e_={background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},t_={padding:"{list.padding}",gap:"{list.gap}"},r_={focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}"},i_={background:"{list.option.group.background}",color:"{list.option.group.color}",fontWeight:"{list.option.group.font.weight}",padding:"{list.option.group.padding}"},n_={width:"2.5rem",sm:{width:"2rem"},lg:{width:"3rem"},borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.border.color}",activeBorderColor:"{form.field.border.color}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},o_={borderRadius:"{border.radius.sm}"},a_={padding:"{list.option.padding}"},s_={light:{chip:{focusBackground:"{surface.200}",focusColor:"{surface.800}"},dropdown:{background:"{surface.100}",hoverBackground:"{surface.200}",activeBackground:"{surface.300}",color:"{surface.600}",hoverColor:"{surface.700}",activeColor:"{surface.800}"}},dark:{chip:{focusBackground:"{surface.700}",focusColor:"{surface.0}"},dropdown:{background:"{surface.800}",hoverBackground:"{surface.700}",activeBackground:"{surface.600}",color:"{surface.300}",hoverColor:"{surface.200}",activeColor:"{surface.100}"}}},zd={root:Z1,overlay:e_,list:t_,option:r_,optionGroup:i_,dropdown:n_,chip:o_,emptyMessage:a_,colorScheme:s_};var l_={width:"2rem",height:"2rem",fontSize:"1rem",background:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}"},c_={size:"1rem"},u_={borderColor:"{content.background}",offset:"-0.75rem"},d_={width:"3rem",height:"3rem",fontSize:"1.5rem",icon:{size:"1.5rem"},group:{offset:"-1rem"}},p_={width:"4rem",height:"4rem",fontSize:"2rem",icon:{size:"2rem"},group:{offset:"-1.5rem"}},Ud={root:l_,icon:c_,group:u_,lg:d_,xl:p_};var f_={borderRadius:"{border.radius.md}",padding:"0 0.5rem",fontSize:"0.75rem",fontWeight:"700",minWidth:"1.5rem",height:"1.5rem"},m_={size:"0.5rem"},h_={fontSize:"0.625rem",minWidth:"1.25rem",height:"1.25rem"},g_={fontSize:"0.875rem",minWidth:"1.75rem",height:"1.75rem"},__={fontSize:"1rem",minWidth:"2rem",height:"2rem"},x_={light:{primary:{background:"{primary.color}",color:"{primary.contrast.color}"},secondary:{background:"{surface.100}",color:"{surface.600}"},success:{background:"{green.500}",color:"{surface.0}"},info:{background:"{sky.500}",color:"{surface.0}"},warn:{background:"{orange.500}",color:"{surface.0}"},danger:{background:"{red.500}",color:"{surface.0}"},contrast:{background:"{surface.950}",color:"{surface.0}"}},dark:{primary:{background:"{primary.color}",color:"{primary.contrast.color}"},secondary:{background:"{surface.800}",color:"{surface.300}"},success:{background:"{green.400}",color:"{green.950}"},info:{background:"{sky.400}",color:"{sky.950}"},warn:{background:"{orange.400}",color:"{orange.950}"},danger:{background:"{red.400}",color:"{red.950}"},contrast:{background:"{surface.0}",color:"{surface.950}"}}},Wd={root:f_,dot:m_,sm:h_,lg:g_,xl:__,colorScheme:x_};var v_={borderRadius:{none:"0",xs:"2px",sm:"4px",md:"6px",lg:"8px",xl:"12px"},emerald:{50:"#ecfdf5",100:"#d1fae5",200:"#a7f3d0",300:"#6ee7b7",400:"#34d399",500:"#10b981",600:"#059669",700:"#047857",800:"#065f46",900:"#064e3b",950:"#022c22"},green:{50:"#f0fdf4",100:"#dcfce7",200:"#bbf7d0",300:"#86efac",400:"#4ade80",500:"#22c55e",600:"#16a34a",700:"#15803d",800:"#166534",900:"#14532d",950:"#052e16"},lime:{50:"#f7fee7",100:"#ecfccb",200:"#d9f99d",300:"#bef264",400:"#a3e635",500:"#84cc16",600:"#65a30d",700:"#4d7c0f",800:"#3f6212",900:"#365314",950:"#1a2e05"},red:{50:"#fef2f2",100:"#fee2e2",200:"#fecaca",300:"#fca5a5",400:"#f87171",500:"#ef4444",600:"#dc2626",700:"#b91c1c",800:"#991b1b",900:"#7f1d1d",950:"#450a0a"},orange:{50:"#fff7ed",100:"#ffedd5",200:"#fed7aa",300:"#fdba74",400:"#fb923c",500:"#f97316",600:"#ea580c",700:"#c2410c",800:"#9a3412",900:"#7c2d12",950:"#431407"},amber:{50:"#fffbeb",100:"#fef3c7",200:"#fde68a",300:"#fcd34d",400:"#fbbf24",500:"#f59e0b",600:"#d97706",700:"#b45309",800:"#92400e",900:"#78350f",950:"#451a03"},yellow:{50:"#fefce8",100:"#fef9c3",200:"#fef08a",300:"#fde047",400:"#facc15",500:"#eab308",600:"#ca8a04",700:"#a16207",800:"#854d0e",900:"#713f12",950:"#422006"},teal:{50:"#f0fdfa",100:"#ccfbf1",200:"#99f6e4",300:"#5eead4",400:"#2dd4bf",500:"#14b8a6",600:"#0d9488",700:"#0f766e",800:"#115e59",900:"#134e4a",950:"#042f2e"},cyan:{50:"#ecfeff",100:"#cffafe",200:"#a5f3fc",300:"#67e8f9",400:"#22d3ee",500:"#06b6d4",600:"#0891b2",700:"#0e7490",800:"#155e75",900:"#164e63",950:"#083344"},sky:{50:"#f0f9ff",100:"#e0f2fe",200:"#bae6fd",300:"#7dd3fc",400:"#38bdf8",500:"#0ea5e9",600:"#0284c7",700:"#0369a1",800:"#075985",900:"#0c4a6e",950:"#082f49"},blue:{50:"#eff6ff",100:"#dbeafe",200:"#bfdbfe",300:"#93c5fd",400:"#60a5fa",500:"#3b82f6",600:"#2563eb",700:"#1d4ed8",800:"#1e40af",900:"#1e3a8a",950:"#172554"},indigo:{50:"#eef2ff",100:"#e0e7ff",200:"#c7d2fe",300:"#a5b4fc",400:"#818cf8",500:"#6366f1",600:"#4f46e5",700:"#4338ca",800:"#3730a3",900:"#312e81",950:"#1e1b4b"},violet:{50:"#f5f3ff",100:"#ede9fe",200:"#ddd6fe",300:"#c4b5fd",400:"#a78bfa",500:"#8b5cf6",600:"#7c3aed",700:"#6d28d9",800:"#5b21b6",900:"#4c1d95",950:"#2e1065"},purple:{50:"#faf5ff",100:"#f3e8ff",200:"#e9d5ff",300:"#d8b4fe",400:"#c084fc",500:"#a855f7",600:"#9333ea",700:"#7e22ce",800:"#6b21a8",900:"#581c87",950:"#3b0764"},fuchsia:{50:"#fdf4ff",100:"#fae8ff",200:"#f5d0fe",300:"#f0abfc",400:"#e879f9",500:"#d946ef",600:"#c026d3",700:"#a21caf",800:"#86198f",900:"#701a75",950:"#4a044e"},pink:{50:"#fdf2f8",100:"#fce7f3",200:"#fbcfe8",300:"#f9a8d4",400:"#f472b6",500:"#ec4899",600:"#db2777",700:"#be185d",800:"#9d174d",900:"#831843",950:"#500724"},rose:{50:"#fff1f2",100:"#ffe4e6",200:"#fecdd3",300:"#fda4af",400:"#fb7185",500:"#f43f5e",600:"#e11d48",700:"#be123c",800:"#9f1239",900:"#881337",950:"#4c0519"},slate:{50:"#f8fafc",100:"#f1f5f9",200:"#e2e8f0",300:"#cbd5e1",400:"#94a3b8",500:"#64748b",600:"#475569",700:"#334155",800:"#1e293b",900:"#0f172a",950:"#020617"},gray:{50:"#f9fafb",100:"#f3f4f6",200:"#e5e7eb",300:"#d1d5db",400:"#9ca3af",500:"#6b7280",600:"#4b5563",700:"#374151",800:"#1f2937",900:"#111827",950:"#030712"},zinc:{50:"#fafafa",100:"#f4f4f5",200:"#e4e4e7",300:"#d4d4d8",400:"#a1a1aa",500:"#71717a",600:"#52525b",700:"#3f3f46",800:"#27272a",900:"#18181b",950:"#09090b"},neutral:{50:"#fafafa",100:"#f5f5f5",200:"#e5e5e5",300:"#d4d4d4",400:"#a3a3a3",500:"#737373",600:"#525252",700:"#404040",800:"#262626",900:"#171717",950:"#0a0a0a"},stone:{50:"#fafaf9",100:"#f5f5f4",200:"#e7e5e4",300:"#d6d3d1",400:"#a8a29e",500:"#78716c",600:"#57534e",700:"#44403c",800:"#292524",900:"#1c1917",950:"#0c0a09"}},b_={transitionDuration:"0.2s",focusRing:{width:"1px",style:"solid",color:"{primary.color}",offset:"2px",shadow:"none"},disabledOpacity:"0.6",iconSize:"1rem",anchorGutter:"2px",primary:{50:"{emerald.50}",100:"{emerald.100}",200:"{emerald.200}",300:"{emerald.300}",400:"{emerald.400}",500:"{emerald.500}",600:"{emerald.600}",700:"{emerald.700}",800:"{emerald.800}",900:"{emerald.900}",950:"{emerald.950}"},formField:{paddingX:"0.75rem",paddingY:"0.5rem",sm:{fontSize:"0.875rem",paddingX:"0.625rem",paddingY:"0.375rem"},lg:{fontSize:"1.125rem",paddingX:"0.875rem",paddingY:"0.625rem"},borderRadius:"{border.radius.md}",focusRing:{width:"0",style:"none",color:"transparent",offset:"0",shadow:"none"},transitionDuration:"{transition.duration}"},list:{padding:"0.25rem 0.25rem",gap:"2px",header:{padding:"0.5rem 1rem 0.25rem 1rem"},option:{padding:"0.5rem 0.75rem",borderRadius:"{border.radius.sm}"},optionGroup:{padding:"0.5rem 0.75rem",fontWeight:"600"}},content:{borderRadius:"{border.radius.md}"},mask:{transitionDuration:"0.15s"},navigation:{list:{padding:"0.25rem 0.25rem",gap:"2px"},item:{padding:"0.5rem 0.75rem",borderRadius:"{border.radius.sm}",gap:"0.5rem"},submenuLabel:{padding:"0.5rem 0.75rem",fontWeight:"600"},submenuIcon:{size:"0.875rem"}},overlay:{select:{borderRadius:"{border.radius.md}",shadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1)"},popover:{borderRadius:"{border.radius.md}",padding:"0.75rem",shadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1)"},modal:{borderRadius:"{border.radius.xl}",padding:"1.25rem",shadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1)"},navigation:{shadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1)"}},colorScheme:{light:{surface:{0:"#ffffff",50:"{slate.50}",100:"{slate.100}",200:"{slate.200}",300:"{slate.300}",400:"{slate.400}",500:"{slate.500}",600:"{slate.600}",700:"{slate.700}",800:"{slate.800}",900:"{slate.900}",950:"{slate.950}"},primary:{color:"{primary.500}",contrastColor:"#ffffff",hoverColor:"{primary.600}",activeColor:"{primary.700}"},highlight:{background:"{primary.50}",focusBackground:"{primary.100}",color:"{primary.700}",focusColor:"{primary.800}"},mask:{background:"rgba(0,0,0,0.4)",color:"{surface.200}"},formField:{background:"{surface.0}",disabledBackground:"{surface.200}",filledBackground:"{surface.50}",filledHoverBackground:"{surface.50}",filledFocusBackground:"{surface.50}",borderColor:"{surface.300}",hoverBorderColor:"{surface.400}",focusBorderColor:"{primary.color}",invalidBorderColor:"{red.400}",color:"{surface.700}",disabledColor:"{surface.500}",placeholderColor:"{surface.500}",invalidPlaceholderColor:"{red.600}",floatLabelColor:"{surface.500}",floatLabelFocusColor:"{primary.600}",floatLabelActiveColor:"{surface.500}",floatLabelInvalidColor:"{form.field.invalid.placeholder.color}",iconColor:"{surface.400}",shadow:"0 0 #0000, 0 0 #0000, 0 1px 2px 0 rgba(18, 18, 23, 0.05)"},text:{color:"{surface.700}",hoverColor:"{surface.800}",mutedColor:"{surface.500}",hoverMutedColor:"{surface.600}"},content:{background:"{surface.0}",hoverBackground:"{surface.100}",borderColor:"{surface.200}",color:"{text.color}",hoverColor:"{text.hover.color}"},overlay:{select:{background:"{surface.0}",borderColor:"{surface.200}",color:"{text.color}"},popover:{background:"{surface.0}",borderColor:"{surface.200}",color:"{text.color}"},modal:{background:"{surface.0}",borderColor:"{surface.200}",color:"{text.color}"}},list:{option:{focusBackground:"{surface.100}",selectedBackground:"{highlight.background}",selectedFocusBackground:"{highlight.focus.background}",color:"{text.color}",focusColor:"{text.hover.color}",selectedColor:"{highlight.color}",selectedFocusColor:"{highlight.focus.color}",icon:{color:"{surface.400}",focusColor:"{surface.500}"}},optionGroup:{background:"transparent",color:"{text.muted.color}"}},navigation:{item:{focusBackground:"{surface.100}",activeBackground:"{surface.100}",color:"{text.color}",focusColor:"{text.hover.color}",activeColor:"{text.hover.color}",icon:{color:"{surface.400}",focusColor:"{surface.500}",activeColor:"{surface.500}"}},submenuLabel:{background:"transparent",color:"{text.muted.color}"},submenuIcon:{color:"{surface.400}",focusColor:"{surface.500}",activeColor:"{surface.500}"}}},dark:{surface:{0:"#ffffff",50:"{zinc.50}",100:"{zinc.100}",200:"{zinc.200}",300:"{zinc.300}",400:"{zinc.400}",500:"{zinc.500}",600:"{zinc.600}",700:"{zinc.700}",800:"{zinc.800}",900:"{zinc.900}",950:"{zinc.950}"},primary:{color:"{primary.400}",contrastColor:"{surface.900}",hoverColor:"{primary.300}",activeColor:"{primary.200}"},highlight:{background:"color-mix(in srgb, {primary.400}, transparent 84%)",focusBackground:"color-mix(in srgb, {primary.400}, transparent 76%)",color:"rgba(255,255,255,.87)",focusColor:"rgba(255,255,255,.87)"},mask:{background:"rgba(0,0,0,0.6)",color:"{surface.200}"},formField:{background:"{surface.950}",disabledBackground:"{surface.700}",filledBackground:"{surface.800}",filledHoverBackground:"{surface.800}",filledFocusBackground:"{surface.800}",borderColor:"{surface.600}",hoverBorderColor:"{surface.500}",focusBorderColor:"{primary.color}",invalidBorderColor:"{red.300}",color:"{surface.0}",disabledColor:"{surface.400}",placeholderColor:"{surface.400}",invalidPlaceholderColor:"{red.400}",floatLabelColor:"{surface.400}",floatLabelFocusColor:"{primary.color}",floatLabelActiveColor:"{surface.400}",floatLabelInvalidColor:"{form.field.invalid.placeholder.color}",iconColor:"{surface.400}",shadow:"0 0 #0000, 0 0 #0000, 0 1px 2px 0 rgba(18, 18, 23, 0.05)"},text:{color:"{surface.0}",hoverColor:"{surface.0}",mutedColor:"{surface.400}",hoverMutedColor:"{surface.300}"},content:{background:"{surface.900}",hoverBackground:"{surface.800}",borderColor:"{surface.700}",color:"{text.color}",hoverColor:"{text.hover.color}"},overlay:{select:{background:"{surface.900}",borderColor:"{surface.700}",color:"{text.color}"},popover:{background:"{surface.900}",borderColor:"{surface.700}",color:"{text.color}"},modal:{background:"{surface.900}",borderColor:"{surface.700}",color:"{text.color}"}},list:{option:{focusBackground:"{surface.800}",selectedBackground:"{highlight.background}",selectedFocusBackground:"{highlight.focus.background}",color:"{text.color}",focusColor:"{text.hover.color}",selectedColor:"{highlight.color}",selectedFocusColor:"{highlight.focus.color}",icon:{color:"{surface.500}",focusColor:"{surface.400}"}},optionGroup:{background:"transparent",color:"{text.muted.color}"}},navigation:{item:{focusBackground:"{surface.800}",activeBackground:"{surface.800}",color:"{text.color}",focusColor:"{text.hover.color}",activeColor:"{text.hover.color}",icon:{color:"{surface.500}",focusColor:"{surface.400}",activeColor:"{surface.400}"}},submenuLabel:{background:"transparent",color:"{text.muted.color}"},submenuIcon:{color:"{surface.500}",focusColor:"{surface.400}",activeColor:"{surface.400}"}}}}},jd={primitive:v_,semantic:b_};var y_={borderRadius:"{content.border.radius}"},Hd={root:y_};var C_={padding:"1rem",background:"{content.background}",gap:"0.5rem",transitionDuration:"{transition.duration}"},w_={color:"{text.muted.color}",hoverColor:"{text.color}",borderRadius:"{content.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",hoverColor:"{navigation.item.icon.focus.color}"},focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},S_={color:"{navigation.item.icon.color}"},$d={root:C_,item:w_,separator:S_};var k_={borderRadius:"{form.field.border.radius}",roundedBorderRadius:"2rem",gap:"0.5rem",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",iconOnlyWidth:"2.5rem",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}",iconOnlyWidth:"2rem"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}",iconOnlyWidth:"3rem"},label:{fontWeight:"500"},raisedShadow:"0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12)",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",offset:"{focus.ring.offset}"},badgeSize:"1rem",transitionDuration:"{form.field.transition.duration}"},T_={light:{root:{primary:{background:"{primary.color}",hoverBackground:"{primary.hover.color}",activeBackground:"{primary.active.color}",borderColor:"{primary.color}",hoverBorderColor:"{primary.hover.color}",activeBorderColor:"{primary.active.color}",color:"{primary.contrast.color}",hoverColor:"{primary.contrast.color}",activeColor:"{primary.contrast.color}",focusRing:{color:"{primary.color}",shadow:"none"}},secondary:{background:"{surface.100}",hoverBackground:"{surface.200}",activeBackground:"{surface.300}",borderColor:"{surface.100}",hoverBorderColor:"{surface.200}",activeBorderColor:"{surface.300}",color:"{surface.600}",hoverColor:"{surface.700}",activeColor:"{surface.800}",focusRing:{color:"{surface.600}",shadow:"none"}},info:{background:"{sky.500}",hoverBackground:"{sky.600}",activeBackground:"{sky.700}",borderColor:"{sky.500}",hoverBorderColor:"{sky.600}",activeBorderColor:"{sky.700}",color:"#ffffff",hoverColor:"#ffffff",activeColor:"#ffffff",focusRing:{color:"{sky.500}",shadow:"none"}},success:{background:"{green.500}",hoverBackground:"{green.600}",activeBackground:"{green.700}",borderColor:"{green.500}",hoverBorderColor:"{green.600}",activeBorderColor:"{green.700}",color:"#ffffff",hoverColor:"#ffffff",activeColor:"#ffffff",focusRing:{color:"{green.500}",shadow:"none"}},warn:{background:"{orange.500}",hoverBackground:"{orange.600}",activeBackground:"{orange.700}",borderColor:"{orange.500}",hoverBorderColor:"{orange.600}",activeBorderColor:"{orange.700}",color:"#ffffff",hoverColor:"#ffffff",activeColor:"#ffffff",focusRing:{color:"{orange.500}",shadow:"none"}},help:{background:"{purple.500}",hoverBackground:"{purple.600}",activeBackground:"{purple.700}",borderColor:"{purple.500}",hoverBorderColor:"{purple.600}",activeBorderColor:"{purple.700}",color:"#ffffff",hoverColor:"#ffffff",activeColor:"#ffffff",focusRing:{color:"{purple.500}",shadow:"none"}},danger:{background:"{red.500}",hoverBackground:"{red.600}",activeBackground:"{red.700}",borderColor:"{red.500}",hoverBorderColor:"{red.600}",activeBorderColor:"{red.700}",color:"#ffffff",hoverColor:"#ffffff",activeColor:"#ffffff",focusRing:{color:"{red.500}",shadow:"none"}},contrast:{background:"{surface.950}",hoverBackground:"{surface.900}",activeBackground:"{surface.800}",borderColor:"{surface.950}",hoverBorderColor:"{surface.900}",activeBorderColor:"{surface.800}",color:"{surface.0}",hoverColor:"{surface.0}",activeColor:"{surface.0}",focusRing:{color:"{surface.950}",shadow:"none"}}},outlined:{primary:{hoverBackground:"{primary.50}",activeBackground:"{primary.100}",borderColor:"{primary.200}",color:"{primary.color}"},secondary:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",borderColor:"{surface.200}",color:"{surface.500}"},success:{hoverBackground:"{green.50}",activeBackground:"{green.100}",borderColor:"{green.200}",color:"{green.500}"},info:{hoverBackground:"{sky.50}",activeBackground:"{sky.100}",borderColor:"{sky.200}",color:"{sky.500}"},warn:{hoverBackground:"{orange.50}",activeBackground:"{orange.100}",borderColor:"{orange.200}",color:"{orange.500}"},help:{hoverBackground:"{purple.50}",activeBackground:"{purple.100}",borderColor:"{purple.200}",color:"{purple.500}"},danger:{hoverBackground:"{red.50}",activeBackground:"{red.100}",borderColor:"{red.200}",color:"{red.500}"},contrast:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",borderColor:"{surface.700}",color:"{surface.950}"},plain:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",borderColor:"{surface.200}",color:"{surface.700}"}},text:{primary:{hoverBackground:"{primary.50}",activeBackground:"{primary.100}",color:"{primary.color}"},secondary:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",color:"{surface.500}"},success:{hoverBackground:"{green.50}",activeBackground:"{green.100}",color:"{green.500}"},info:{hoverBackground:"{sky.50}",activeBackground:"{sky.100}",color:"{sky.500}"},warn:{hoverBackground:"{orange.50}",activeBackground:"{orange.100}",color:"{orange.500}"},help:{hoverBackground:"{purple.50}",activeBackground:"{purple.100}",color:"{purple.500}"},danger:{hoverBackground:"{red.50}",activeBackground:"{red.100}",color:"{red.500}"},contrast:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",color:"{surface.950}"},plain:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",color:"{surface.700}"}},link:{color:"{primary.color}",hoverColor:"{primary.color}",activeColor:"{primary.color}"}},dark:{root:{primary:{background:"{primary.color}",hoverBackground:"{primary.hover.color}",activeBackground:"{primary.active.color}",borderColor:"{primary.color}",hoverBorderColor:"{primary.hover.color}",activeBorderColor:"{primary.active.color}",color:"{primary.contrast.color}",hoverColor:"{primary.contrast.color}",activeColor:"{primary.contrast.color}",focusRing:{color:"{primary.color}",shadow:"none"}},secondary:{background:"{surface.800}",hoverBackground:"{surface.700}",activeBackground:"{surface.600}",borderColor:"{surface.800}",hoverBorderColor:"{surface.700}",activeBorderColor:"{surface.600}",color:"{surface.300}",hoverColor:"{surface.200}",activeColor:"{surface.100}",focusRing:{color:"{surface.300}",shadow:"none"}},info:{background:"{sky.400}",hoverBackground:"{sky.300}",activeBackground:"{sky.200}",borderColor:"{sky.400}",hoverBorderColor:"{sky.300}",activeBorderColor:"{sky.200}",color:"{sky.950}",hoverColor:"{sky.950}",activeColor:"{sky.950}",focusRing:{color:"{sky.400}",shadow:"none"}},success:{background:"{green.400}",hoverBackground:"{green.300}",activeBackground:"{green.200}",borderColor:"{green.400}",hoverBorderColor:"{green.300}",activeBorderColor:"{green.200}",color:"{green.950}",hoverColor:"{green.950}",activeColor:"{green.950}",focusRing:{color:"{green.400}",shadow:"none"}},warn:{background:"{orange.400}",hoverBackground:"{orange.300}",activeBackground:"{orange.200}",borderColor:"{orange.400}",hoverBorderColor:"{orange.300}",activeBorderColor:"{orange.200}",color:"{orange.950}",hoverColor:"{orange.950}",activeColor:"{orange.950}",focusRing:{color:"{orange.400}",shadow:"none"}},help:{background:"{purple.400}",hoverBackground:"{purple.300}",activeBackground:"{purple.200}",borderColor:"{purple.400}",hoverBorderColor:"{purple.300}",activeBorderColor:"{purple.200}",color:"{purple.950}",hoverColor:"{purple.950}",activeColor:"{purple.950}",focusRing:{color:"{purple.400}",shadow:"none"}},danger:{background:"{red.400}",hoverBackground:"{red.300}",activeBackground:"{red.200}",borderColor:"{red.400}",hoverBorderColor:"{red.300}",activeBorderColor:"{red.200}",color:"{red.950}",hoverColor:"{red.950}",activeColor:"{red.950}",focusRing:{color:"{red.400}",shadow:"none"}},contrast:{background:"{surface.0}",hoverBackground:"{surface.100}",activeBackground:"{surface.200}",borderColor:"{surface.0}",hoverBorderColor:"{surface.100}",activeBorderColor:"{surface.200}",color:"{surface.950}",hoverColor:"{surface.950}",activeColor:"{surface.950}",focusRing:{color:"{surface.0}",shadow:"none"}}},outlined:{primary:{hoverBackground:"color-mix(in srgb, {primary.color}, transparent 96%)",activeBackground:"color-mix(in srgb, {primary.color}, transparent 84%)",borderColor:"{primary.700}",color:"{primary.color}"},secondary:{hoverBackground:"rgba(255,255,255,0.04)",activeBackground:"rgba(255,255,255,0.16)",borderColor:"{surface.700}",color:"{surface.400}"},success:{hoverBackground:"color-mix(in srgb, {green.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {green.400}, transparent 84%)",borderColor:"{green.700}",color:"{green.400}"},info:{hoverBackground:"color-mix(in srgb, {sky.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {sky.400}, transparent 84%)",borderColor:"{sky.700}",color:"{sky.400}"},warn:{hoverBackground:"color-mix(in srgb, {orange.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {orange.400}, transparent 84%)",borderColor:"{orange.700}",color:"{orange.400}"},help:{hoverBackground:"color-mix(in srgb, {purple.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {purple.400}, transparent 84%)",borderColor:"{purple.700}",color:"{purple.400}"},danger:{hoverBackground:"color-mix(in srgb, {red.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {red.400}, transparent 84%)",borderColor:"{red.700}",color:"{red.400}"},contrast:{hoverBackground:"{surface.800}",activeBackground:"{surface.700}",borderColor:"{surface.500}",color:"{surface.0}"},plain:{hoverBackground:"{surface.800}",activeBackground:"{surface.700}",borderColor:"{surface.600}",color:"{surface.0}"}},text:{primary:{hoverBackground:"color-mix(in srgb, {primary.color}, transparent 96%)",activeBackground:"color-mix(in srgb, {primary.color}, transparent 84%)",color:"{primary.color}"},secondary:{hoverBackground:"{surface.800}",activeBackground:"{surface.700}",color:"{surface.400}"},success:{hoverBackground:"color-mix(in srgb, {green.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {green.400}, transparent 84%)",color:"{green.400}"},info:{hoverBackground:"color-mix(in srgb, {sky.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {sky.400}, transparent 84%)",color:"{sky.400}"},warn:{hoverBackground:"color-mix(in srgb, {orange.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {orange.400}, transparent 84%)",color:"{orange.400}"},help:{hoverBackground:"color-mix(in srgb, {purple.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {purple.400}, transparent 84%)",color:"{purple.400}"},danger:{hoverBackground:"color-mix(in srgb, {red.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {red.400}, transparent 84%)",color:"{red.400}"},contrast:{hoverBackground:"{surface.800}",activeBackground:"{surface.700}",color:"{surface.0}"},plain:{hoverBackground:"{surface.800}",activeBackground:"{surface.700}",color:"{surface.0}"}},link:{color:"{primary.color}",hoverColor:"{primary.color}",activeColor:"{primary.color}"}}},Gd={root:k_,colorScheme:T_};var E_={background:"{content.background}",borderRadius:"{border.radius.xl}",color:"{content.color}",shadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px -1px rgba(0, 0, 0, 0.1)"},I_={padding:"1.25rem",gap:"0.5rem"},F_={gap:"0.5rem"},A_={fontSize:"1.25rem",fontWeight:"500"},P_={color:"{text.muted.color}"},Kd={root:E_,body:I_,caption:F_,title:A_,subtitle:P_};var D_={transitionDuration:"{transition.duration}"},O_={gap:"0.25rem"},B_={padding:"1rem",gap:"0.5rem"},M_={width:"2rem",height:"0.5rem",borderRadius:"{content.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},R_={light:{indicator:{background:"{surface.200}",hoverBackground:"{surface.300}",activeBackground:"{primary.color}"}},dark:{indicator:{background:"{surface.700}",hoverBackground:"{surface.600}",activeBackground:"{primary.color}"}}},Xd={root:D_,content:O_,indicatorList:B_,indicator:M_,colorScheme:R_};var L_={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}},N_={width:"2.5rem",color:"{form.field.icon.color}"},V_={background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},z_={padding:"{list.padding}",gap:"{list.gap}",mobileIndent:"1rem"},U_={focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}",icon:{color:"{list.option.icon.color}",focusColor:"{list.option.icon.focus.color}",size:"0.875rem"}},W_={color:"{form.field.icon.color}"},Jd={root:L_,dropdown:N_,overlay:V_,list:z_,option:U_,clearIcon:W_};var j_={borderRadius:"{border.radius.sm}",width:"1.25rem",height:"1.25rem",background:"{form.field.background}",checkedBackground:"{primary.color}",checkedHoverBackground:"{primary.hover.color}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.border.color}",checkedBorderColor:"{primary.color}",checkedHoverBorderColor:"{primary.hover.color}",checkedFocusBorderColor:"{primary.color}",checkedDisabledBorderColor:"{form.field.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",shadow:"{form.field.shadow}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{width:"1rem",height:"1rem"},lg:{width:"1.5rem",height:"1.5rem"}},H_={size:"0.875rem",color:"{form.field.color}",checkedColor:"{primary.contrast.color}",checkedHoverColor:"{primary.contrast.color}",disabledColor:"{form.field.disabled.color}",sm:{size:"0.75rem"},lg:{size:"1rem"}},qd={root:j_,icon:H_};var $_={borderRadius:"16px",paddingX:"0.75rem",paddingY:"0.5rem",gap:"0.5rem",transitionDuration:"{transition.duration}"},G_={width:"2rem",height:"2rem"},K_={size:"1rem"},X_={size:"1rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"}},J_={light:{root:{background:"{surface.100}",color:"{surface.800}"},icon:{color:"{surface.800}"},removeIcon:{color:"{surface.800}"}},dark:{root:{background:"{surface.800}",color:"{surface.0}"},icon:{color:"{surface.0}"},removeIcon:{color:"{surface.0}"}}},Qd={root:$_,image:G_,icon:K_,removeIcon:X_,colorScheme:J_};var q_={transitionDuration:"{transition.duration}"},Q_={width:"1.5rem",height:"1.5rem",borderRadius:"{form.field.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},Y_={shadow:"{overlay.popover.shadow}",borderRadius:"{overlay.popover.borderRadius}"},Z_={light:{panel:{background:"{surface.800}",borderColor:"{surface.900}"},handle:{color:"{surface.0}"}},dark:{panel:{background:"{surface.900}",borderColor:"{surface.700}"},handle:{color:"{surface.0}"}}},Yd={root:q_,preview:Q_,panel:Y_,colorScheme:Z_};var ex={size:"2rem",color:"{overlay.modal.color}"},tx={gap:"1rem"},Zd={icon:ex,content:tx};var rx={background:"{overlay.popover.background}",borderColor:"{overlay.popover.border.color}",color:"{overlay.popover.color}",borderRadius:"{overlay.popover.border.radius}",shadow:"{overlay.popover.shadow}",gutter:"10px",arrowOffset:"1.25rem"},ix={padding:"{overlay.popover.padding}",gap:"1rem"},nx={size:"1.5rem",color:"{overlay.popover.color}"},ox={gap:"0.5rem",padding:"0 {overlay.popover.padding} {overlay.popover.padding} {overlay.popover.padding}"},ep={root:rx,content:ix,icon:nx,footer:ox};var ax={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}",shadow:"{overlay.navigation.shadow}",transitionDuration:"{transition.duration}"},sx={padding:"{navigation.list.padding}",gap:"{navigation.list.gap}"},lx={focusBackground:"{navigation.item.focus.background}",activeBackground:"{navigation.item.active.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",activeColor:"{navigation.item.active.color}",padding:"{navigation.item.padding}",borderRadius:"{navigation.item.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}",activeColor:"{navigation.item.icon.active.color}"}},cx={mobileIndent:"1rem"},ux={size:"{navigation.submenu.icon.size}",color:"{navigation.submenu.icon.color}",focusColor:"{navigation.submenu.icon.focus.color}",activeColor:"{navigation.submenu.icon.active.color}"},dx={borderColor:"{content.border.color}"},tp={root:ax,list:sx,item:lx,submenu:cx,submenuIcon:ux,separator:dx};var px={transitionDuration:"{transition.duration}"},fx={background:"{content.background}",borderColor:"{datatable.border.color}",color:"{content.color}",borderWidth:"0 0 1px 0",padding:"0.75rem 1rem",sm:{padding:"0.375rem 0.5rem"},lg:{padding:"1rem 1.25rem"}},mx={background:"{content.background}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",borderColor:"{datatable.border.color}",color:"{content.color}",hoverColor:"{content.hover.color}",selectedColor:"{highlight.color}",gap:"0.5rem",padding:"0.75rem 1rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"},sm:{padding:"0.375rem 0.5rem"},lg:{padding:"1rem 1.25rem"}},hx={fontWeight:"600"},gx={background:"{content.background}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",color:"{content.color}",hoverColor:"{content.hover.color}",selectedColor:"{highlight.color}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"}},_x={borderColor:"{datatable.border.color}",padding:"0.75rem 1rem",sm:{padding:"0.375rem 0.5rem"},lg:{padding:"1rem 1.25rem"}},xx={background:"{content.background}",borderColor:"{datatable.border.color}",color:"{content.color}",padding:"0.75rem 1rem",sm:{padding:"0.375rem 0.5rem"},lg:{padding:"1rem 1.25rem"}},vx={fontWeight:"600"},bx={background:"{content.background}",borderColor:"{datatable.border.color}",color:"{content.color}",borderWidth:"0 0 1px 0",padding:"0.75rem 1rem",sm:{padding:"0.375rem 0.5rem"},lg:{padding:"1rem 1.25rem"}},yx={color:"{primary.color}"},Cx={width:"0.5rem"},wx={width:"1px",color:"{primary.color}"},Sx={color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",size:"0.875rem"},kx={size:"2rem"},Tx={hoverBackground:"{content.hover.background}",selectedHoverBackground:"{content.background}",color:"{text.muted.color}",hoverColor:"{text.color}",selectedHoverColor:"{primary.color}",size:"1.75rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},Ex={inlineGap:"0.5rem",overlaySelect:{background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},overlayPopover:{background:"{overlay.popover.background}",borderColor:"{overlay.popover.border.color}",borderRadius:"{overlay.popover.border.radius}",color:"{overlay.popover.color}",shadow:"{overlay.popover.shadow}",padding:"{overlay.popover.padding}",gap:"0.5rem"},rule:{borderColor:"{content.border.color}"},constraintList:{padding:"{list.padding}",gap:"{list.gap}"},constraint:{focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",separator:{borderColor:"{content.border.color}"},padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}"}},Ix={borderColor:"{datatable.border.color}",borderWidth:"0 0 1px 0"},Fx={borderColor:"{datatable.border.color}",borderWidth:"0 0 1px 0"},Ax={light:{root:{borderColor:"{content.border.color}"},row:{stripedBackground:"{surface.50}"},bodyCell:{selectedBorderColor:"{primary.100}"}},dark:{root:{borderColor:"{surface.800}"},row:{stripedBackground:"{surface.950}"},bodyCell:{selectedBorderColor:"{primary.900}"}}},rp={root:px,header:fx,headerCell:mx,columnTitle:hx,row:gx,bodyCell:_x,footerCell:xx,columnFooter:vx,footer:bx,dropPoint:yx,columnResizer:Cx,resizeIndicator:wx,sortIcon:Sx,loadingIcon:kx,rowToggleButton:Tx,filter:Ex,paginatorTop:Ix,paginatorBottom:Fx,colorScheme:Ax};var Px={borderColor:"transparent",borderWidth:"0",borderRadius:"0",padding:"0"},Dx={background:"{content.background}",color:"{content.color}",borderColor:"{content.border.color}",borderWidth:"0 0 1px 0",padding:"0.75rem 1rem",borderRadius:"0"},Ox={background:"{content.background}",color:"{content.color}",borderColor:"transparent",borderWidth:"0",padding:"0",borderRadius:"0"},Bx={background:"{content.background}",color:"{content.color}",borderColor:"{content.border.color}",borderWidth:"1px 0 0 0",padding:"0.75rem 1rem",borderRadius:"0"},Mx={borderColor:"{content.border.color}",borderWidth:"0 0 1px 0"},Rx={borderColor:"{content.border.color}",borderWidth:"1px 0 0 0"},ip={root:Px,header:Dx,content:Ox,footer:Bx,paginatorTop:Mx,paginatorBottom:Rx};var Lx={transitionDuration:"{transition.duration}"},Nx={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}",shadow:"{overlay.popover.shadow}",padding:"{overlay.popover.padding}"},Vx={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",padding:"0 0 0.5rem 0"},zx={gap:"0.5rem",fontWeight:"500"},Ux={width:"2.5rem",sm:{width:"2rem"},lg:{width:"3rem"},borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.border.color}",activeBorderColor:"{form.field.border.color}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},Wx={color:"{form.field.icon.color}"},jx={hoverBackground:"{content.hover.background}",color:"{content.color}",hoverColor:"{content.hover.color}",padding:"0.25rem 0.5rem",borderRadius:"{content.border.radius}"},Hx={hoverBackground:"{content.hover.background}",color:"{content.color}",hoverColor:"{content.hover.color}",padding:"0.25rem 0.5rem",borderRadius:"{content.border.radius}"},$x={borderColor:"{content.border.color}",gap:"{overlay.popover.padding}"},Gx={margin:"0.5rem 0 0 0"},Kx={padding:"0.25rem",fontWeight:"500",color:"{content.color}"},Xx={hoverBackground:"{content.hover.background}",selectedBackground:"{primary.color}",rangeSelectedBackground:"{highlight.background}",color:"{content.color}",hoverColor:"{content.hover.color}",selectedColor:"{primary.contrast.color}",rangeSelectedColor:"{highlight.color}",width:"2rem",height:"2rem",borderRadius:"50%",padding:"0.25rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},Jx={margin:"0.5rem 0 0 0"},qx={padding:"0.375rem",borderRadius:"{content.border.radius}"},Qx={margin:"0.5rem 0 0 0"},Yx={padding:"0.375rem",borderRadius:"{content.border.radius}"},Zx={padding:"0.5rem 0 0 0",borderColor:"{content.border.color}"},ev={padding:"0.5rem 0 0 0",borderColor:"{content.border.color}",gap:"0.5rem",buttonGap:"0.25rem"},tv={light:{dropdown:{background:"{surface.100}",hoverBackground:"{surface.200}",activeBackground:"{surface.300}",color:"{surface.600}",hoverColor:"{surface.700}",activeColor:"{surface.800}"},today:{background:"{surface.200}",color:"{surface.900}"}},dark:{dropdown:{background:"{surface.800}",hoverBackground:"{surface.700}",activeBackground:"{surface.600}",color:"{surface.300}",hoverColor:"{surface.200}",activeColor:"{surface.100}"},today:{background:"{surface.700}",color:"{surface.0}"}}},np={root:Lx,panel:Nx,header:Vx,title:zx,dropdown:Ux,inputIcon:Wx,selectMonth:jx,selectYear:Hx,group:$x,dayView:Gx,weekDay:Kx,date:Xx,monthView:Jx,month:qx,yearView:Qx,year:Yx,buttonbar:Zx,timePicker:ev,colorScheme:tv};var rv={background:"{overlay.modal.background}",borderColor:"{overlay.modal.border.color}",color:"{overlay.modal.color}",borderRadius:"{overlay.modal.border.radius}",shadow:"{overlay.modal.shadow}"},iv={padding:"{overlay.modal.padding}",gap:"0.5rem"},nv={fontSize:"1.25rem",fontWeight:"600"},ov={padding:"0 {overlay.modal.padding} {overlay.modal.padding} {overlay.modal.padding}"},av={padding:"0 {overlay.modal.padding} {overlay.modal.padding} {overlay.modal.padding}",gap:"0.5rem"},op={root:rv,header:iv,title:nv,content:ov,footer:av};var sv={borderColor:"{content.border.color}"},lv={background:"{content.background}",color:"{text.color}"},cv={margin:"1rem 0",padding:"0 1rem",content:{padding:"0 0.5rem"}},uv={margin:"0 1rem",padding:"0.5rem 0",content:{padding:"0.5rem 0"}},ap={root:sv,content:lv,horizontal:cv,vertical:uv};var dv={background:"rgba(255, 255, 255, 0.1)",borderColor:"rgba(255, 255, 255, 0.2)",padding:"0.5rem",borderRadius:"{border.radius.xl}"},pv={borderRadius:"{content.border.radius}",padding:"0.5rem",size:"3rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},sp={root:dv,item:pv};var fv={background:"{overlay.modal.background}",borderColor:"{overlay.modal.border.color}",color:"{overlay.modal.color}",shadow:"{overlay.modal.shadow}"},mv={padding:"{overlay.modal.padding}"},hv={fontSize:"1.5rem",fontWeight:"600"},gv={padding:"0 {overlay.modal.padding} {overlay.modal.padding} {overlay.modal.padding}"},_v={padding:"{overlay.modal.padding}"},lp={root:fv,header:mv,title:hv,content:gv,footer:_v};var xv={background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}"},vv={color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{primary.color}"},bv={background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}",padding:"{list.padding}"},yv={focusBackground:"{list.option.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}"},Cv={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}"},cp={toolbar:xv,toolbarItem:vv,overlay:bv,overlayOption:yv,content:Cv};var wv={background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",color:"{content.color}",padding:"0 1.125rem 1.125rem 1.125rem",transitionDuration:"{transition.duration}"},Sv={background:"{content.background}",hoverBackground:"{content.hover.background}",color:"{content.color}",hoverColor:"{content.hover.color}",borderRadius:"{content.border.radius}",borderWidth:"1px",borderColor:"transparent",padding:"0.5rem 0.75rem",gap:"0.5rem",fontWeight:"600",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},kv={color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}"},Tv={padding:"0"},up={root:wv,legend:Sv,toggleIcon:kv,content:Tv};var Ev={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}",transitionDuration:"{transition.duration}"},Iv={background:"transparent",color:"{text.color}",padding:"1.125rem",borderColor:"unset",borderWidth:"0",borderRadius:"0",gap:"0.5rem"},Fv={highlightBorderColor:"{primary.color}",padding:"0 1.125rem 1.125rem 1.125rem",gap:"1rem"},Av={padding:"1rem",gap:"1rem",borderColor:"{content.border.color}",info:{gap:"0.5rem"}},Pv={gap:"0.5rem"},Dv={height:"0.25rem"},Ov={gap:"0.5rem"},dp={root:Ev,header:Iv,content:Fv,file:Av,fileList:Pv,progressbar:Dv,basic:Ov};var Bv={color:"{form.field.float.label.color}",focusColor:"{form.field.float.label.focus.color}",activeColor:"{form.field.float.label.active.color}",invalidColor:"{form.field.float.label.invalid.color}",transitionDuration:"0.2s",positionX:"{form.field.padding.x}",positionY:"{form.field.padding.y}",fontWeight:"500",active:{fontSize:"0.75rem",fontWeight:"400"}},Mv={active:{top:"-1.25rem"}},Rv={input:{paddingTop:"1.5rem",paddingBottom:"{form.field.padding.y}"},active:{top:"{form.field.padding.y}"}},Lv={borderRadius:"{border.radius.xs}",active:{background:"{form.field.background}",padding:"0 0.125rem"}},pp={root:Bv,over:Mv,in:Rv,on:Lv};var Nv={borderWidth:"1px",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",transitionDuration:"{transition.duration}"},Vv={background:"rgba(255, 255, 255, 0.1)",hoverBackground:"rgba(255, 255, 255, 0.2)",color:"{surface.100}",hoverColor:"{surface.0}",size:"3rem",gutter:"0.5rem",prev:{borderRadius:"50%"},next:{borderRadius:"50%"},focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},zv={size:"1.5rem"},Uv={background:"{content.background}",padding:"1rem 0.25rem"},Wv={size:"2rem",borderRadius:"{content.border.radius}",gutter:"0.5rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},jv={size:"1rem"},Hv={background:"rgba(0, 0, 0, 0.5)",color:"{surface.100}",padding:"1rem"},$v={gap:"0.5rem",padding:"1rem"},Gv={width:"1rem",height:"1rem",activeBackground:"{primary.color}",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},Kv={background:"rgba(0, 0, 0, 0.5)"},Xv={background:"rgba(255, 255, 255, 0.4)",hoverBackground:"rgba(255, 255, 255, 0.6)",activeBackground:"rgba(255, 255, 255, 0.9)"},Jv={size:"3rem",gutter:"0.5rem",background:"rgba(255, 255, 255, 0.1)",hoverBackground:"rgba(255, 255, 255, 0.2)",color:"{surface.50}",hoverColor:"{surface.0}",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},qv={size:"1.5rem"},Qv={light:{thumbnailNavButton:{hoverBackground:"{surface.100}",color:"{surface.600}",hoverColor:"{surface.700}"},indicatorButton:{background:"{surface.200}",hoverBackground:"{surface.300}"}},dark:{thumbnailNavButton:{hoverBackground:"{surface.700}",color:"{surface.400}",hoverColor:"{surface.0}"},indicatorButton:{background:"{surface.700}",hoverBackground:"{surface.600}"}}},fp={root:Nv,navButton:Vv,navIcon:zv,thumbnailsContent:Uv,thumbnailNavButton:Wv,thumbnailNavButtonIcon:jv,caption:Hv,indicatorList:$v,indicatorButton:Gv,insetIndicatorList:Kv,insetIndicatorButton:Xv,closeButton:Jv,closeButtonIcon:qv,colorScheme:Qv};var Yv={color:"{form.field.icon.color}"},mp={icon:Yv};var Zv={color:"{form.field.float.label.color}",focusColor:"{form.field.float.label.focus.color}",invalidColor:"{form.field.float.label.invalid.color}",transitionDuration:"0.2s",positionX:"{form.field.padding.x}",top:"{form.field.padding.y}",fontSize:"0.75rem",fontWeight:"400"},e4={paddingTop:"1.5rem",paddingBottom:"{form.field.padding.y}"},hp={root:Zv,input:e4};var t4={transitionDuration:"{transition.duration}"},r4={icon:{size:"1.5rem"},mask:{background:"{mask.background}",color:"{mask.color}"}},i4={position:{left:"auto",right:"1rem",top:"1rem",bottom:"auto"},blur:"8px",background:"rgba(255,255,255,0.1)",borderColor:"rgba(255,255,255,0.2)",borderWidth:"1px",borderRadius:"30px",padding:".5rem",gap:"0.5rem"},n4={hoverBackground:"rgba(255,255,255,0.1)",color:"{surface.50}",hoverColor:"{surface.0}",size:"3rem",iconSize:"1.5rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},gp={root:t4,preview:r4,toolbar:i4,action:n4};var o4={size:"15px",hoverSize:"30px",background:"rgba(255,255,255,0.3)",hoverBackground:"rgba(255,255,255,0.3)",borderColor:"unset",hoverBorderColor:"unset",borderWidth:"0",borderRadius:"50%",transitionDuration:"{transition.duration}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"rgba(255,255,255,0.3)",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},_p={handle:o4};var a4={padding:"{form.field.padding.y} {form.field.padding.x}",borderRadius:"{content.border.radius}",gap:"0.5rem"},s4={fontWeight:"500"},l4={size:"1rem"},c4={light:{info:{background:"color-mix(in srgb, {blue.50}, transparent 5%)",borderColor:"{blue.200}",color:"{blue.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)"},success:{background:"color-mix(in srgb, {green.50}, transparent 5%)",borderColor:"{green.200}",color:"{green.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)"},warn:{background:"color-mix(in srgb,{yellow.50}, transparent 5%)",borderColor:"{yellow.200}",color:"{yellow.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)"},error:{background:"color-mix(in srgb, {red.50}, transparent 5%)",borderColor:"{red.200}",color:"{red.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)"},secondary:{background:"{surface.100}",borderColor:"{surface.200}",color:"{surface.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)"},contrast:{background:"{surface.900}",borderColor:"{surface.950}",color:"{surface.50}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)"}},dark:{info:{background:"color-mix(in srgb, {blue.500}, transparent 84%)",borderColor:"color-mix(in srgb, {blue.700}, transparent 64%)",color:"{blue.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)"},success:{background:"color-mix(in srgb, {green.500}, transparent 84%)",borderColor:"color-mix(in srgb, {green.700}, transparent 64%)",color:"{green.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)"},warn:{background:"color-mix(in srgb, {yellow.500}, transparent 84%)",borderColor:"color-mix(in srgb, {yellow.700}, transparent 64%)",color:"{yellow.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)"},error:{background:"color-mix(in srgb, {red.500}, transparent 84%)",borderColor:"color-mix(in srgb, {red.700}, transparent 64%)",color:"{red.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)"},secondary:{background:"{surface.800}",borderColor:"{surface.700}",color:"{surface.300}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)"},contrast:{background:"{surface.0}",borderColor:"{surface.100}",color:"{surface.950}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)"}}},xp={root:a4,text:s4,icon:l4,colorScheme:c4};var u4={padding:"{form.field.padding.y} {form.field.padding.x}",borderRadius:"{content.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},transitionDuration:"{transition.duration}"},d4={hoverBackground:"{content.hover.background}",hoverColor:"{content.hover.color}"},vp={root:u4,display:d4};var p4={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}"},f4={borderRadius:"{border.radius.sm}"},m4={light:{chip:{focusBackground:"{surface.200}",color:"{surface.800}"}},dark:{chip:{focusBackground:"{surface.700}",color:"{surface.0}"}}},bp={root:p4,chip:f4,colorScheme:m4};var h4={background:"{form.field.background}",borderColor:"{form.field.border.color}",color:"{form.field.icon.color}",borderRadius:"{form.field.border.radius}",padding:"0.5rem",minWidth:"2.5rem"},yp={addon:h4};var g4={transitionDuration:"{transition.duration}"},_4={width:"2.5rem",borderRadius:"{form.field.border.radius}",verticalPadding:"{form.field.padding.y}"},x4={light:{button:{background:"transparent",hoverBackground:"{surface.100}",activeBackground:"{surface.200}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.border.color}",activeBorderColor:"{form.field.border.color}",color:"{surface.400}",hoverColor:"{surface.500}",activeColor:"{surface.600}"}},dark:{button:{background:"transparent",hoverBackground:"{surface.800}",activeBackground:"{surface.700}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.border.color}",activeBorderColor:"{form.field.border.color}",color:"{surface.400}",hoverColor:"{surface.300}",activeColor:"{surface.200}"}}},Cp={root:g4,button:_4,colorScheme:x4};var v4={gap:"0.5rem"},b4={width:"2.5rem",sm:{width:"2rem"},lg:{width:"3rem"}},wp={root:v4,input:b4};var y4={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}},Sp={root:y4};var C4={transitionDuration:"{transition.duration}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},w4={background:"{primary.color}"},S4={background:"{content.border.color}"},k4={color:"{text.muted.color}"},kp={root:C4,value:w4,range:S4,text:k4};var T4={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",borderColor:"{form.field.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",shadow:"{form.field.shadow}",borderRadius:"{form.field.border.radius}",transitionDuration:"{form.field.transition.duration}"},E4={padding:"{list.padding}",gap:"{list.gap}",header:{padding:"{list.header.padding}"}},I4={focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}"},F4={background:"{list.option.group.background}",color:"{list.option.group.color}",fontWeight:"{list.option.group.font.weight}",padding:"{list.option.group.padding}"},A4={color:"{list.option.color}",gutterStart:"-0.375rem",gutterEnd:"0.375rem"},P4={padding:"{list.option.padding}"},D4={light:{option:{stripedBackground:"{surface.50}"}},dark:{option:{stripedBackground:"{surface.900}"}}},Tp={root:T4,list:E4,option:I4,optionGroup:F4,checkmark:A4,emptyMessage:P4,colorScheme:D4};var O4={background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",color:"{content.color}",gap:"0.5rem",verticalOrientation:{padding:"{navigation.list.padding}",gap:"{navigation.list.gap}"},horizontalOrientation:{padding:"0.5rem 0.75rem",gap:"0.5rem"},transitionDuration:"{transition.duration}"},B4={borderRadius:"{content.border.radius}",padding:"{navigation.item.padding}"},M4={focusBackground:"{navigation.item.focus.background}",activeBackground:"{navigation.item.active.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",activeColor:"{navigation.item.active.color}",padding:"{navigation.item.padding}",borderRadius:"{navigation.item.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}",activeColor:"{navigation.item.icon.active.color}"}},R4={padding:"0",background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",color:"{content.color}",shadow:"{overlay.navigation.shadow}",gap:"0.5rem"},L4={padding:"{navigation.list.padding}",gap:"{navigation.list.gap}"},N4={padding:"{navigation.submenu.label.padding}",fontWeight:"{navigation.submenu.label.font.weight}",background:"{navigation.submenu.label.background}",color:"{navigation.submenu.label.color}"},V4={size:"{navigation.submenu.icon.size}",color:"{navigation.submenu.icon.color}",focusColor:"{navigation.submenu.icon.focus.color}",activeColor:"{navigation.submenu.icon.active.color}"},z4={borderColor:"{content.border.color}"},U4={borderRadius:"50%",size:"1.75rem",color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",hoverBackground:"{content.hover.background}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},Ep={root:O4,baseItem:B4,item:M4,overlay:R4,submenu:L4,submenuLabel:N4,submenuIcon:V4,separator:z4,mobileButton:U4};var W4={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}",shadow:"{overlay.navigation.shadow}",transitionDuration:"{transition.duration}"},j4={padding:"{navigation.list.padding}",gap:"{navigation.list.gap}"},H4={focusBackground:"{navigation.item.focus.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",padding:"{navigation.item.padding}",borderRadius:"{navigation.item.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}"}},$4={padding:"{navigation.submenu.label.padding}",fontWeight:"{navigation.submenu.label.font.weight}",background:"{navigation.submenu.label.background}",color:"{navigation.submenu.label.color}"},G4={borderColor:"{content.border.color}"},Ip={root:W4,list:j4,item:H4,submenuLabel:$4,separator:G4};var K4={background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",color:"{content.color}",gap:"0.5rem",padding:"0.5rem 0.75rem",transitionDuration:"{transition.duration}"},X4={borderRadius:"{content.border.radius}",padding:"{navigation.item.padding}"},J4={focusBackground:"{navigation.item.focus.background}",activeBackground:"{navigation.item.active.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",activeColor:"{navigation.item.active.color}",padding:"{navigation.item.padding}",borderRadius:"{navigation.item.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}",activeColor:"{navigation.item.icon.active.color}"}},q4={padding:"{navigation.list.padding}",gap:"{navigation.list.gap}",background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",shadow:"{overlay.navigation.shadow}",mobileIndent:"1rem",icon:{size:"{navigation.submenu.icon.size}",color:"{navigation.submenu.icon.color}",focusColor:"{navigation.submenu.icon.focus.color}",activeColor:"{navigation.submenu.icon.active.color}"}},Q4={borderColor:"{content.border.color}"},Y4={borderRadius:"50%",size:"1.75rem",color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",hoverBackground:"{content.hover.background}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},Fp={root:K4,baseItem:X4,item:J4,submenu:q4,separator:Q4,mobileButton:Y4};var Z4={borderRadius:"{content.border.radius}",borderWidth:"1px",transitionDuration:"{transition.duration}"},e2={padding:"0.5rem 0.75rem",gap:"0.5rem",sm:{padding:"0.375rem 0.625rem"},lg:{padding:"0.625rem 0.875rem"}},t2={fontSize:"1rem",fontWeight:"500",sm:{fontSize:"0.875rem"},lg:{fontSize:"1.125rem"}},r2={size:"1.125rem",sm:{size:"1rem"},lg:{size:"1.25rem"}},i2={width:"1.75rem",height:"1.75rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",offset:"{focus.ring.offset}"}},n2={size:"1rem",sm:{size:"0.875rem"},lg:{size:"1.125rem"}},o2={root:{borderWidth:"1px"}},a2={content:{padding:"0"}},s2={light:{info:{background:"color-mix(in srgb, {blue.50}, transparent 5%)",borderColor:"{blue.200}",color:"{blue.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)",closeButton:{hoverBackground:"{blue.100}",focusRing:{color:"{blue.600}",shadow:"none"}},outlined:{color:"{blue.600}",borderColor:"{blue.600}"},simple:{color:"{blue.600}"}},success:{background:"color-mix(in srgb, {green.50}, transparent 5%)",borderColor:"{green.200}",color:"{green.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)",closeButton:{hoverBackground:"{green.100}",focusRing:{color:"{green.600}",shadow:"none"}},outlined:{color:"{green.600}",borderColor:"{green.600}"},simple:{color:"{green.600}"}},warn:{background:"color-mix(in srgb,{yellow.50}, transparent 5%)",borderColor:"{yellow.200}",color:"{yellow.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)",closeButton:{hoverBackground:"{yellow.100}",focusRing:{color:"{yellow.600}",shadow:"none"}},outlined:{color:"{yellow.600}",borderColor:"{yellow.600}"},simple:{color:"{yellow.600}"}},error:{background:"color-mix(in srgb, {red.50}, transparent 5%)",borderColor:"{red.200}",color:"{red.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)",closeButton:{hoverBackground:"{red.100}",focusRing:{color:"{red.600}",shadow:"none"}},outlined:{color:"{red.600}",borderColor:"{red.600}"},simple:{color:"{red.600}"}},secondary:{background:"{surface.100}",borderColor:"{surface.200}",color:"{surface.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)",closeButton:{hoverBackground:"{surface.200}",focusRing:{color:"{surface.600}",shadow:"none"}},outlined:{color:"{surface.500}",borderColor:"{surface.500}"},simple:{color:"{surface.500}"}},contrast:{background:"{surface.900}",borderColor:"{surface.950}",color:"{surface.50}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)",closeButton:{hoverBackground:"{surface.800}",focusRing:{color:"{surface.50}",shadow:"none"}},outlined:{color:"{surface.950}",borderColor:"{surface.950}"},simple:{color:"{surface.950}"}}},dark:{info:{background:"color-mix(in srgb, {blue.500}, transparent 84%)",borderColor:"color-mix(in srgb, {blue.700}, transparent 64%)",color:"{blue.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{blue.500}",shadow:"none"}},outlined:{color:"{blue.500}",borderColor:"{blue.500}"},simple:{color:"{blue.500}"}},success:{background:"color-mix(in srgb, {green.500}, transparent 84%)",borderColor:"color-mix(in srgb, {green.700}, transparent 64%)",color:"{green.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{green.500}",shadow:"none"}},outlined:{color:"{green.500}",borderColor:"{green.500}"},simple:{color:"{green.500}"}},warn:{background:"color-mix(in srgb, {yellow.500}, transparent 84%)",borderColor:"color-mix(in srgb, {yellow.700}, transparent 64%)",color:"{yellow.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{yellow.500}",shadow:"none"}},outlined:{color:"{yellow.500}",borderColor:"{yellow.500}"},simple:{color:"{yellow.500}"}},error:{background:"color-mix(in srgb, {red.500}, transparent 84%)",borderColor:"color-mix(in srgb, {red.700}, transparent 64%)",color:"{red.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{red.500}",shadow:"none"}},outlined:{color:"{red.500}",borderColor:"{red.500}"},simple:{color:"{red.500}"}},secondary:{background:"{surface.800}",borderColor:"{surface.700}",color:"{surface.300}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)",closeButton:{hoverBackground:"{surface.700}",focusRing:{color:"{surface.300}",shadow:"none"}},outlined:{color:"{surface.400}",borderColor:"{surface.400}"},simple:{color:"{surface.400}"}},contrast:{background:"{surface.0}",borderColor:"{surface.100}",color:"{surface.950}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)",closeButton:{hoverBackground:"{surface.100}",focusRing:{color:"{surface.950}",shadow:"none"}},outlined:{color:"{surface.0}",borderColor:"{surface.0}"},simple:{color:"{surface.0}"}}}},Ap={root:Z4,content:e2,text:t2,icon:r2,closeButton:i2,closeIcon:n2,outlined:o2,simple:a2,colorScheme:s2};var l2={borderRadius:"{content.border.radius}",gap:"1rem"},c2={background:"{content.border.color}",size:"0.5rem"},u2={gap:"0.5rem"},d2={size:"0.5rem"},p2={size:"1rem"},f2={verticalGap:"0.5rem",horizontalGap:"1rem"},Pp={root:l2,meters:c2,label:u2,labelMarker:d2,labelIcon:p2,labelList:f2};var m2={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}},h2={width:"2.5rem",color:"{form.field.icon.color}"},g2={background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},_2={padding:"{list.padding}",gap:"{list.gap}",header:{padding:"{list.header.padding}"}},x2={focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}",gap:"0.5rem"},v2={background:"{list.option.group.background}",color:"{list.option.group.color}",fontWeight:"{list.option.group.font.weight}",padding:"{list.option.group.padding}"},b2={color:"{form.field.icon.color}"},y2={borderRadius:"{border.radius.sm}"},C2={padding:"{list.option.padding}"},Dp={root:m2,dropdown:h2,overlay:g2,list:_2,option:x2,optionGroup:v2,chip:y2,clearIcon:b2,emptyMessage:C2};var w2={gap:"1.125rem"},S2={gap:"0.5rem"},Op={root:w2,controls:S2};var k2={gutter:"0.75rem",transitionDuration:"{transition.duration}"},T2={background:"{content.background}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",borderColor:"{content.border.color}",color:"{content.color}",selectedColor:"{highlight.color}",hoverColor:"{content.hover.color}",padding:"0.75rem 1rem",toggleablePadding:"0.75rem 1rem 1.25rem 1rem",borderRadius:"{content.border.radius}"},E2={background:"{content.background}",hoverBackground:"{content.hover.background}",borderColor:"{content.border.color}",color:"{text.muted.color}",hoverColor:"{text.color}",size:"1.5rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},I2={color:"{content.border.color}",borderRadius:"{content.border.radius}",height:"24px"},Bp={root:k2,node:T2,nodeToggleButton:E2,connector:I2};var F2={outline:{width:"2px",color:"{content.background}"}},Mp={root:F2};var A2={padding:"0.5rem 1rem",gap:"0.25rem",borderRadius:"{content.border.radius}",background:"{content.background}",color:"{content.color}",transitionDuration:"{transition.duration}"},P2={background:"transparent",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",selectedColor:"{highlight.color}",width:"2.5rem",height:"2.5rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},D2={color:"{text.muted.color}"},O2={maxWidth:"2.5rem"},Rp={root:A2,navButton:P2,currentPageReport:D2,jumpToPageInput:O2};var B2={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}"},M2={background:"transparent",color:"{text.color}",padding:"1.125rem",borderColor:"{content.border.color}",borderWidth:"0",borderRadius:"0"},R2={padding:"0.375rem 1.125rem"},L2={fontWeight:"600"},N2={padding:"0 1.125rem 1.125rem 1.125rem"},V2={padding:"0 1.125rem 1.125rem 1.125rem"},Lp={root:B2,header:M2,toggleableHeader:R2,title:L2,content:N2,footer:V2};var z2={gap:"0.5rem",transitionDuration:"{transition.duration}"},U2={background:"{content.background}",borderColor:"{content.border.color}",borderWidth:"1px",color:"{content.color}",padding:"0.25rem 0.25rem",borderRadius:"{content.border.radius}",first:{borderWidth:"1px",topBorderRadius:"{content.border.radius}"},last:{borderWidth:"1px",bottomBorderRadius:"{content.border.radius}"}},W2={focusBackground:"{navigation.item.focus.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",gap:"0.5rem",padding:"{navigation.item.padding}",borderRadius:"{content.border.radius}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}"}},j2={indent:"1rem"},H2={color:"{navigation.submenu.icon.color}",focusColor:"{navigation.submenu.icon.focus.color}"},Np={root:z2,panel:U2,item:W2,submenu:j2,submenuIcon:H2};var $2={background:"{content.border.color}",borderRadius:"{content.border.radius}",height:".75rem"},G2={color:"{form.field.icon.color}"},K2={background:"{overlay.popover.background}",borderColor:"{overlay.popover.border.color}",borderRadius:"{overlay.popover.border.radius}",color:"{overlay.popover.color}",padding:"{overlay.popover.padding}",shadow:"{overlay.popover.shadow}"},X2={gap:"0.5rem"},J2={light:{strength:{weakBackground:"{red.500}",mediumBackground:"{amber.500}",strongBackground:"{green.500}"}},dark:{strength:{weakBackground:"{red.400}",mediumBackground:"{amber.400}",strongBackground:"{green.400}"}}},Vp={meter:$2,icon:G2,overlay:K2,content:X2,colorScheme:J2};var q2={gap:"1.125rem"},Q2={gap:"0.5rem"},zp={root:q2,controls:Q2};var Y2={background:"{overlay.popover.background}",borderColor:"{overlay.popover.border.color}",color:"{overlay.popover.color}",borderRadius:"{overlay.popover.border.radius}",shadow:"{overlay.popover.shadow}",gutter:"10px",arrowOffset:"1.25rem"},Z2={padding:"{overlay.popover.padding}"},Up={root:Y2,content:Z2};var eb={background:"{content.border.color}",borderRadius:"{content.border.radius}",height:"1.25rem"},tb={background:"{primary.color}"},rb={color:"{primary.contrast.color}",fontSize:"0.75rem",fontWeight:"600"},Wp={root:eb,value:tb,label:rb};var ib={light:{root:{colorOne:"{red.500}",colorTwo:"{blue.500}",colorThree:"{green.500}",colorFour:"{yellow.500}"}},dark:{root:{colorOne:"{red.400}",colorTwo:"{blue.400}",colorThree:"{green.400}",colorFour:"{yellow.400}"}}},jp={colorScheme:ib};var nb={width:"1.25rem",height:"1.25rem",background:"{form.field.background}",checkedBackground:"{primary.color}",checkedHoverBackground:"{primary.hover.color}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.border.color}",checkedBorderColor:"{primary.color}",checkedHoverBorderColor:"{primary.hover.color}",checkedFocusBorderColor:"{primary.color}",checkedDisabledBorderColor:"{form.field.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",shadow:"{form.field.shadow}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{width:"1rem",height:"1rem"},lg:{width:"1.5rem",height:"1.5rem"}},ob={size:"0.75rem",checkedColor:"{primary.contrast.color}",checkedHoverColor:"{primary.contrast.color}",disabledColor:"{form.field.disabled.color}",sm:{size:"0.5rem"},lg:{size:"1rem"}},Hp={root:nb,icon:ob};var ab={gap:"0.25rem",transitionDuration:"{transition.duration}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},sb={size:"1rem",color:"{text.muted.color}",hoverColor:"{primary.color}",activeColor:"{primary.color}"},$p={root:ab,icon:sb};var lb={light:{root:{background:"rgba(0,0,0,0.1)"}},dark:{root:{background:"rgba(255,255,255,0.3)"}}},Gp={colorScheme:lb};var cb={transitionDuration:"{transition.duration}"},ub={size:"9px",borderRadius:"{border.radius.sm}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},db={light:{bar:{background:"{surface.100}"}},dark:{bar:{background:"{surface.800}"}}},Kp={root:cb,bar:ub,colorScheme:db};var pb={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}},fb={width:"2.5rem",color:"{form.field.icon.color}"},mb={background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},hb={padding:"{list.padding}",gap:"{list.gap}",header:{padding:"{list.header.padding}"}},gb={focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}"},_b={background:"{list.option.group.background}",color:"{list.option.group.color}",fontWeight:"{list.option.group.font.weight}",padding:"{list.option.group.padding}"},xb={color:"{form.field.icon.color}"},vb={color:"{list.option.color}",gutterStart:"-0.375rem",gutterEnd:"0.375rem"},bb={padding:"{list.option.padding}"},Xp={root:pb,dropdown:fb,overlay:mb,list:hb,option:gb,optionGroup:_b,clearIcon:xb,checkmark:vb,emptyMessage:bb};var yb={borderRadius:"{form.field.border.radius}"},Cb={light:{root:{invalidBorderColor:"{form.field.invalid.border.color}"}},dark:{root:{invalidBorderColor:"{form.field.invalid.border.color}"}}},Jp={root:yb,colorScheme:Cb};var wb={borderRadius:"{content.border.radius}"},Sb={light:{root:{background:"{surface.200}",animationBackground:"rgba(255,255,255,0.4)"}},dark:{root:{background:"rgba(255, 255, 255, 0.06)",animationBackground:"rgba(255, 255, 255, 0.04)"}}},qp={root:wb,colorScheme:Sb};var kb={transitionDuration:"{transition.duration}"},Tb={background:"{content.border.color}",borderRadius:"{content.border.radius}",size:"3px"},Eb={background:"{primary.color}"},Ib={width:"20px",height:"20px",borderRadius:"50%",background:"{content.border.color}",hoverBackground:"{content.border.color}",content:{borderRadius:"50%",hoverBackground:"{content.background}",width:"16px",height:"16px",shadow:"0px 0.5px 0px 0px rgba(0, 0, 0, 0.08), 0px 1px 1px 0px rgba(0, 0, 0, 0.14)"},focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},Fb={light:{handle:{content:{background:"{surface.0}"}}},dark:{handle:{content:{background:"{surface.950}"}}}},Qp={root:kb,track:Tb,range:Eb,handle:Ib,colorScheme:Fb};var Ab={gap:"0.5rem",transitionDuration:"{transition.duration}"},Yp={root:Ab};var Pb={borderRadius:"{form.field.border.radius}",roundedBorderRadius:"2rem",raisedShadow:"0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12)"},Zp={root:Pb};var Db={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",transitionDuration:"{transition.duration}"},Ob={background:"{content.border.color}"},Bb={size:"24px",background:"transparent",borderRadius:"{content.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},ef={root:Db,gutter:Ob,handle:Bb};var Mb={transitionDuration:"{transition.duration}"},Rb={background:"{content.border.color}",activeBackground:"{primary.color}",margin:"0 0 0 1.625rem",size:"2px"},Lb={padding:"0.5rem",gap:"1rem"},Nb={padding:"0",borderRadius:"{content.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},gap:"0.5rem"},Vb={color:"{text.muted.color}",activeColor:"{primary.color}",fontWeight:"500"},zb={background:"{content.background}",activeBackground:"{content.background}",borderColor:"{content.border.color}",activeBorderColor:"{content.border.color}",color:"{text.muted.color}",activeColor:"{primary.color}",size:"2rem",fontSize:"1.143rem",fontWeight:"500",borderRadius:"50%",shadow:"0px 0.5px 0px 0px rgba(0, 0, 0, 0.06), 0px 1px 1px 0px rgba(0, 0, 0, 0.12)"},Ub={padding:"0.875rem 0.5rem 1.125rem 0.5rem"},Wb={background:"{content.background}",color:"{content.color}",padding:"0",indent:"1rem"},tf={root:Mb,separator:Rb,step:Lb,stepHeader:Nb,stepTitle:Vb,stepNumber:zb,steppanels:Ub,steppanel:Wb};var jb={transitionDuration:"{transition.duration}"},Hb={background:"{content.border.color}"},$b={borderRadius:"{content.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},gap:"0.5rem"},Gb={color:"{text.muted.color}",activeColor:"{primary.color}",fontWeight:"500"},Kb={background:"{content.background}",activeBackground:"{content.background}",borderColor:"{content.border.color}",activeBorderColor:"{content.border.color}",color:"{text.muted.color}",activeColor:"{primary.color}",size:"2rem",fontSize:"1.143rem",fontWeight:"500",borderRadius:"50%",shadow:"0px 0.5px 0px 0px rgba(0, 0, 0, 0.06), 0px 1px 1px 0px rgba(0, 0, 0, 0.12)"},rf={root:jb,separator:Hb,itemLink:$b,itemLabel:Gb,itemNumber:Kb};var Xb={transitionDuration:"{transition.duration}"},Jb={borderWidth:"0 0 1px 0",background:"{content.background}",borderColor:"{content.border.color}"},qb={background:"transparent",hoverBackground:"transparent",activeBackground:"transparent",borderWidth:"0 0 1px 0",borderColor:"{content.border.color}",hoverBorderColor:"{content.border.color}",activeBorderColor:"{primary.color}",color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{primary.color}",padding:"1rem 1.125rem",fontWeight:"600",margin:"0 0 -1px 0",gap:"0.5rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},Qb={color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{primary.color}"},Yb={height:"1px",bottom:"-1px",background:"{primary.color}"},nf={root:Xb,tablist:Jb,item:qb,itemIcon:Qb,activeBar:Yb};var Zb={transitionDuration:"{transition.duration}"},ey={borderWidth:"0 0 1px 0",background:"{content.background}",borderColor:"{content.border.color}"},ty={background:"transparent",hoverBackground:"transparent",activeBackground:"transparent",borderWidth:"0 0 1px 0",borderColor:"{content.border.color}",hoverBorderColor:"{content.border.color}",activeBorderColor:"{primary.color}",color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{primary.color}",padding:"1rem 1.125rem",fontWeight:"600",margin:"0 0 -1px 0",gap:"0.5rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"}},ry={background:"{content.background}",color:"{content.color}",padding:"0.875rem 1.125rem 1.125rem 1.125rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"inset {focus.ring.shadow}"}},iy={background:"{content.background}",color:"{text.muted.color}",hoverColor:"{text.color}",width:"2.5rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"}},ny={height:"1px",bottom:"-1px",background:"{primary.color}"},oy={light:{navButton:{shadow:"0px 0px 10px 50px rgba(255, 255, 255, 0.6)"}},dark:{navButton:{shadow:"0px 0px 10px 50px color-mix(in srgb, {content.background}, transparent 50%)"}}},of={root:Zb,tablist:ey,tab:ty,tabpanel:ry,navButton:iy,activeBar:ny,colorScheme:oy};var ay={transitionDuration:"{transition.duration}"},sy={background:"{content.background}",borderColor:"{content.border.color}"},ly={borderColor:"{content.border.color}",activeBorderColor:"{primary.color}",color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{primary.color}"},cy={background:"{content.background}",color:"{content.color}"},uy={background:"{content.background}",color:"{text.muted.color}",hoverColor:"{text.color}"},dy={light:{navButton:{shadow:"0px 0px 10px 50px rgba(255, 255, 255, 0.6)"}},dark:{navButton:{shadow:"0px 0px 10px 50px color-mix(in srgb, {content.background}, transparent 50%)"}}},af={root:ay,tabList:sy,tab:ly,tabPanel:cy,navButton:uy,colorScheme:dy};var py={fontSize:"0.875rem",fontWeight:"700",padding:"0.25rem 0.5rem",gap:"0.25rem",borderRadius:"{content.border.radius}",roundedBorderRadius:"{border.radius.xl}"},fy={size:"0.75rem"},my={light:{primary:{background:"{primary.100}",color:"{primary.700}"},secondary:{background:"{surface.100}",color:"{surface.600}"},success:{background:"{green.100}",color:"{green.700}"},info:{background:"{sky.100}",color:"{sky.700}"},warn:{background:"{orange.100}",color:"{orange.700}"},danger:{background:"{red.100}",color:"{red.700}"},contrast:{background:"{surface.950}",color:"{surface.0}"}},dark:{primary:{background:"color-mix(in srgb, {primary.500}, transparent 84%)",color:"{primary.300}"},secondary:{background:"{surface.800}",color:"{surface.300}"},success:{background:"color-mix(in srgb, {green.500}, transparent 84%)",color:"{green.300}"},info:{background:"color-mix(in srgb, {sky.500}, transparent 84%)",color:"{sky.300}"},warn:{background:"color-mix(in srgb, {orange.500}, transparent 84%)",color:"{orange.300}"},danger:{background:"color-mix(in srgb, {red.500}, transparent 84%)",color:"{red.300}"},contrast:{background:"{surface.0}",color:"{surface.950}"}}},sf={root:py,icon:fy,colorScheme:my};var hy={background:"{form.field.background}",borderColor:"{form.field.border.color}",color:"{form.field.color}",height:"18rem",padding:"{form.field.padding.y} {form.field.padding.x}",borderRadius:"{form.field.border.radius}"},gy={gap:"0.25rem"},_y={margin:"2px 0"},lf={root:hy,prompt:gy,commandResponse:_y};var xy={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}},cf={root:xy};var vy={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}",shadow:"{overlay.navigation.shadow}",transitionDuration:"{transition.duration}"},by={padding:"{navigation.list.padding}",gap:"{navigation.list.gap}"},yy={focusBackground:"{navigation.item.focus.background}",activeBackground:"{navigation.item.active.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",activeColor:"{navigation.item.active.color}",padding:"{navigation.item.padding}",borderRadius:"{navigation.item.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}",activeColor:"{navigation.item.icon.active.color}"}},Cy={mobileIndent:"1rem"},wy={size:"{navigation.submenu.icon.size}",color:"{navigation.submenu.icon.color}",focusColor:"{navigation.submenu.icon.focus.color}",activeColor:"{navigation.submenu.icon.active.color}"},Sy={borderColor:"{content.border.color}"},uf={root:vy,list:by,item:yy,submenu:Cy,submenuIcon:wy,separator:Sy};var ky={minHeight:"5rem"},Ty={eventContent:{padding:"1rem 0"}},Ey={eventContent:{padding:"0 1rem"}},Iy={size:"1.125rem",borderRadius:"50%",borderWidth:"2px",background:"{content.background}",borderColor:"{content.border.color}",content:{borderRadius:"50%",size:"0.375rem",background:"{primary.color}",insetShadow:"0px 0.5px 0px 0px rgba(0, 0, 0, 0.06), 0px 1px 1px 0px rgba(0, 0, 0, 0.12)"}},Fy={color:"{content.border.color}",size:"2px"},df={event:ky,horizontal:Ty,vertical:Ey,eventMarker:Iy,eventConnector:Fy};var Ay={width:"25rem",borderRadius:"{content.border.radius}",borderWidth:"1px",transitionDuration:"{transition.duration}"},Py={size:"1.125rem"},Dy={padding:"{overlay.popover.padding}",gap:"0.5rem"},Oy={gap:"0.5rem"},By={fontWeight:"500",fontSize:"1rem"},My={fontWeight:"500",fontSize:"0.875rem"},Ry={width:"1.75rem",height:"1.75rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",offset:"{focus.ring.offset}"}},Ly={size:"1rem"},Ny={light:{root:{blur:"1.5px"},info:{background:"color-mix(in srgb, {blue.50}, transparent 5%)",borderColor:"{blue.200}",color:"{blue.600}",detailColor:"{surface.700}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)",closeButton:{hoverBackground:"{blue.100}",focusRing:{color:"{blue.600}",shadow:"none"}}},success:{background:"color-mix(in srgb, {green.50}, transparent 5%)",borderColor:"{green.200}",color:"{green.600}",detailColor:"{surface.700}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)",closeButton:{hoverBackground:"{green.100}",focusRing:{color:"{green.600}",shadow:"none"}}},warn:{background:"color-mix(in srgb,{yellow.50}, transparent 5%)",borderColor:"{yellow.200}",color:"{yellow.600}",detailColor:"{surface.700}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)",closeButton:{hoverBackground:"{yellow.100}",focusRing:{color:"{yellow.600}",shadow:"none"}}},error:{background:"color-mix(in srgb, {red.50}, transparent 5%)",borderColor:"{red.200}",color:"{red.600}",detailColor:"{surface.700}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)",closeButton:{hoverBackground:"{red.100}",focusRing:{color:"{red.600}",shadow:"none"}}},secondary:{background:"{surface.100}",borderColor:"{surface.200}",color:"{surface.600}",detailColor:"{surface.700}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)",closeButton:{hoverBackground:"{surface.200}",focusRing:{color:"{surface.600}",shadow:"none"}}},contrast:{background:"{surface.900}",borderColor:"{surface.950}",color:"{surface.50}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)",closeButton:{hoverBackground:"{surface.800}",focusRing:{color:"{surface.50}",shadow:"none"}}}},dark:{root:{blur:"10px"},info:{background:"color-mix(in srgb, {blue.500}, transparent 84%)",borderColor:"color-mix(in srgb, {blue.700}, transparent 64%)",color:"{blue.500}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{blue.500}",shadow:"none"}}},success:{background:"color-mix(in srgb, {green.500}, transparent 84%)",borderColor:"color-mix(in srgb, {green.700}, transparent 64%)",color:"{green.500}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{green.500}",shadow:"none"}}},warn:{background:"color-mix(in srgb, {yellow.500}, transparent 84%)",borderColor:"color-mix(in srgb, {yellow.700}, transparent 64%)",color:"{yellow.500}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{yellow.500}",shadow:"none"}}},error:{background:"color-mix(in srgb, {red.500}, transparent 84%)",borderColor:"color-mix(in srgb, {red.700}, transparent 64%)",color:"{red.500}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{red.500}",shadow:"none"}}},secondary:{background:"{surface.800}",borderColor:"{surface.700}",color:"{surface.300}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)",closeButton:{hoverBackground:"{surface.700}",focusRing:{color:"{surface.300}",shadow:"none"}}},contrast:{background:"{surface.0}",borderColor:"{surface.100}",color:"{surface.950}",detailColor:"{surface.950}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)",closeButton:{hoverBackground:"{surface.100}",focusRing:{color:"{surface.950}",shadow:"none"}}}}},pf={root:Ay,icon:Py,content:Dy,text:Oy,summary:By,detail:My,closeButton:Ry,closeIcon:Ly,colorScheme:Ny};var Vy={padding:"0.25rem",borderRadius:"{content.border.radius}",gap:"0.5rem",fontWeight:"500",disabledBackground:"{form.field.disabled.background}",disabledBorderColor:"{form.field.disabled.background}",disabledColor:"{form.field.disabled.color}",invalidBorderColor:"{form.field.invalid.border.color}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",padding:"0.25rem"},lg:{fontSize:"{form.field.lg.font.size}",padding:"0.25rem"}},zy={disabledColor:"{form.field.disabled.color}"},Uy={padding:"0.25rem 0.75rem",borderRadius:"{content.border.radius}",checkedShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.02), 0px 1px 2px 0px rgba(0, 0, 0, 0.04)",sm:{padding:"0.25rem 0.75rem"},lg:{padding:"0.25rem 0.75rem"}},Wy={light:{root:{background:"{surface.100}",checkedBackground:"{surface.100}",hoverBackground:"{surface.100}",borderColor:"{surface.100}",color:"{surface.500}",hoverColor:"{surface.700}",checkedColor:"{surface.900}",checkedBorderColor:"{surface.100}"},content:{checkedBackground:"{surface.0}"},icon:{color:"{surface.500}",hoverColor:"{surface.700}",checkedColor:"{surface.900}"}},dark:{root:{background:"{surface.950}",checkedBackground:"{surface.950}",hoverBackground:"{surface.950}",borderColor:"{surface.950}",color:"{surface.400}",hoverColor:"{surface.300}",checkedColor:"{surface.0}",checkedBorderColor:"{surface.950}"},content:{checkedBackground:"{surface.800}"},icon:{color:"{surface.400}",hoverColor:"{surface.300}",checkedColor:"{surface.0}"}}},ff={root:Vy,icon:zy,content:Uy,colorScheme:Wy};var jy={width:"2.5rem",height:"1.5rem",borderRadius:"30px",gap:"0.25rem",shadow:"{form.field.shadow}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},borderWidth:"1px",borderColor:"transparent",hoverBorderColor:"transparent",checkedBorderColor:"transparent",checkedHoverBorderColor:"transparent",invalidBorderColor:"{form.field.invalid.border.color}",transitionDuration:"{form.field.transition.duration}",slideDuration:"0.2s"},Hy={borderRadius:"50%",size:"1rem"},$y={light:{root:{background:"{surface.300}",disabledBackground:"{form.field.disabled.background}",hoverBackground:"{surface.400}",checkedBackground:"{primary.color}",checkedHoverBackground:"{primary.hover.color}"},handle:{background:"{surface.0}",disabledBackground:"{form.field.disabled.color}",hoverBackground:"{surface.0}",checkedBackground:"{surface.0}",checkedHoverBackground:"{surface.0}",color:"{text.muted.color}",hoverColor:"{text.color}",checkedColor:"{primary.color}",checkedHoverColor:"{primary.hover.color}"}},dark:{root:{background:"{surface.700}",disabledBackground:"{surface.600}",hoverBackground:"{surface.600}",checkedBackground:"{primary.color}",checkedHoverBackground:"{primary.hover.color}"},handle:{background:"{surface.400}",disabledBackground:"{surface.900}",hoverBackground:"{surface.300}",checkedBackground:"{surface.900}",checkedHoverBackground:"{surface.900}",color:"{surface.900}",hoverColor:"{surface.800}",checkedColor:"{primary.color}",checkedHoverColor:"{primary.hover.color}"}}},mf={root:jy,handle:Hy,colorScheme:$y};var Gy={background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",color:"{content.color}",gap:"0.5rem",padding:"0.75rem"},hf={root:Gy};var Ky={maxWidth:"12.5rem",gutter:"0.25rem",shadow:"{overlay.popover.shadow}",padding:"0.5rem 0.75rem",borderRadius:"{overlay.popover.border.radius}"},Xy={light:{root:{background:"{surface.700}",color:"{surface.0}"}},dark:{root:{background:"{surface.700}",color:"{surface.0}"}}},gf={root:Ky,colorScheme:Xy};var Jy={background:"{content.background}",color:"{content.color}",padding:"1rem",gap:"2px",indent:"1rem",transitionDuration:"{transition.duration}"},qy={padding:"0.25rem 0.5rem",borderRadius:"{content.border.radius}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",color:"{text.color}",hoverColor:"{text.hover.color}",selectedColor:"{highlight.color}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"},gap:"0.25rem"},Qy={color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",selectedColor:"{highlight.color}"},Yy={borderRadius:"50%",size:"1.75rem",hoverBackground:"{content.hover.background}",selectedHoverBackground:"{content.background}",color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",selectedHoverColor:"{primary.color}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},Zy={size:"2rem"},eC={margin:"0 0 0.5rem 0"},_f={root:Jy,node:qy,nodeIcon:Qy,nodeToggleButton:Yy,loadingIcon:Zy,filter:eC};var tC={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}},rC={width:"2.5rem",color:"{form.field.icon.color}"},iC={background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},nC={padding:"{list.padding}"},oC={padding:"{list.option.padding}"},aC={borderRadius:"{border.radius.sm}"},sC={color:"{form.field.icon.color}"},xf={root:tC,dropdown:rC,overlay:iC,tree:nC,emptyMessage:oC,chip:aC,clearIcon:sC};var lC={transitionDuration:"{transition.duration}"},cC={background:"{content.background}",borderColor:"{treetable.border.color}",color:"{content.color}",borderWidth:"0 0 1px 0",padding:"0.75rem 1rem"},uC={background:"{content.background}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",borderColor:"{treetable.border.color}",color:"{content.color}",hoverColor:"{content.hover.color}",selectedColor:"{highlight.color}",gap:"0.5rem",padding:"0.75rem 1rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"}},dC={fontWeight:"600"},pC={background:"{content.background}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",color:"{content.color}",hoverColor:"{content.hover.color}",selectedColor:"{highlight.color}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"}},fC={borderColor:"{treetable.border.color}",padding:"0.75rem 1rem",gap:"0.5rem"},mC={background:"{content.background}",borderColor:"{treetable.border.color}",color:"{content.color}",padding:"0.75rem 1rem"},hC={fontWeight:"600"},gC={background:"{content.background}",borderColor:"{treetable.border.color}",color:"{content.color}",borderWidth:"0 0 1px 0",padding:"0.75rem 1rem"},_C={width:"0.5rem"},xC={width:"1px",color:"{primary.color}"},vC={color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",size:"0.875rem"},bC={size:"2rem"},yC={hoverBackground:"{content.hover.background}",selectedHoverBackground:"{content.background}",color:"{text.muted.color}",hoverColor:"{text.color}",selectedHoverColor:"{primary.color}",size:"1.75rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},CC={borderColor:"{content.border.color}",borderWidth:"0 0 1px 0"},wC={borderColor:"{content.border.color}",borderWidth:"0 0 1px 0"},SC={light:{root:{borderColor:"{content.border.color}"},bodyCell:{selectedBorderColor:"{primary.100}"}},dark:{root:{borderColor:"{surface.800}"},bodyCell:{selectedBorderColor:"{primary.900}"}}},vf={root:lC,header:cC,headerCell:uC,columnTitle:dC,row:pC,bodyCell:fC,footerCell:mC,columnFooter:hC,footer:gC,columnResizer:_C,resizeIndicator:xC,sortIcon:vC,loadingIcon:bC,nodeToggleButton:yC,paginatorTop:CC,paginatorBottom:wC,colorScheme:SC};var kC={mask:{background:"{content.background}",color:"{text.muted.color}"},icon:{size:"2rem"}},bf={loader:kC};var TC=Object.defineProperty,EC=Object.defineProperties,IC=Object.getOwnPropertyDescriptors,yf=Object.getOwnPropertySymbols,FC=Object.prototype.hasOwnProperty,AC=Object.prototype.propertyIsEnumerable,Cf=(t,r,e)=>r in t?TC(t,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[r]=e,wf,Sf=(wf=((t,r)=>{for(var e in r||(r={}))FC.call(r,e)&&Cf(t,e,r[e]);if(yf)for(var e of yf(r))AC.call(r,e)&&Cf(t,e,r[e]);return t})({},jd),EC(wf,IC({components:{accordion:Vd,autocomplete:zd,avatar:Ud,badge:Wd,blockui:Hd,breadcrumb:$d,button:Gd,card:Kd,carousel:Xd,cascadeselect:Jd,checkbox:qd,chip:Qd,colorpicker:Yd,confirmdialog:Zd,confirmpopup:ep,contextmenu:tp,datatable:rp,dataview:ip,datepicker:np,dialog:op,divider:ap,dock:sp,drawer:lp,editor:cp,fieldset:up,fileupload:dp,floatlabel:pp,galleria:fp,iconfield:mp,iftalabel:hp,image:gp,imagecompare:_p,inlinemessage:xp,inplace:vp,inputchips:bp,inputgroup:yp,inputnumber:Cp,inputotp:wp,inputtext:Sp,knob:kp,listbox:Tp,megamenu:Ep,menu:Ip,menubar:Fp,message:Ap,metergroup:Pp,multiselect:Dp,orderlist:Op,organizationchart:Bp,overlaybadge:Mp,paginator:Rp,panel:Lp,panelmenu:Np,password:Vp,picklist:zp,popover:Up,progressbar:Wp,progressspinner:jp,radiobutton:Hp,rating:$p,ripple:Gp,scrollpanel:Kp,select:Xp,selectbutton:Jp,skeleton:qp,slider:Qp,speeddial:Yp,splitbutton:Zp,splitter:ef,stepper:tf,steps:rf,tabmenu:nf,tabs:of,tabview:af,tag:sf,terminal:lf,textarea:cf,tieredmenu:uf,timeline:df,toast:pf,togglebutton:ff,toggleswitch:mf,toolbar:hf,tooltip:gf,tree:_f,treeselect:xf,treetable:vf,virtualscroller:bf}})));var Qc=()=>["/"],kf=(()=>{let r=class r{};r.\u0275fac=function(i){return new(i||r)},r.\u0275cmp=He({type:r,selectors:[["app-notfound"]],decls:35,vars:6,consts:[[1,"bg-surface-50","dark:bg-surface-950","flex","items-center","justify-center","min-h-screen","min-w-[100vw]","overflow-hidden"],[1,"flex","flex-col","items-center","justify-center"],["src","assets/seller/images/notfound/logo-blue.svg","alt","Sakai logo",1,"mb-8","w-24","shrink-0"],[2,"border-radius","56px","padding","0.3rem","background","linear-gradient(180deg, rgba(33, 150, 243, 0.4) 10%, rgba(33, 150, 243, 0) 30%)"],[1,"w-full","bg-surface-0","dark:bg-surface-900","py-20","px-8","sm:px-20","flex","flex-col","items-center",2,"border-radius","53px"],[1,"text-blue-500","font-bold","text-3xl"],[1,"text-surface-900","dark:text-surface-0","font-bold","text-3xl","lg:text-5xl","mb-2"],[1,"text-surface-600","dark:text-surface-200","mb-8"],[1,"w-full","flex","items-center","py-8","border-surface-300","dark:border-surface-500","border-b",3,"routerLink"],[1,"flex","justify-center","items-center","bg-cyan-400","rounded-border",2,"height","3.5rem","width","3.5rem"],[1,"text-surface-50","dark:text-surface-800","pi","pi-fw","pi-table","text-2xl"],[1,"ml-6","flex","flex-col"],[1,"text-surface-900","dark:text-surface-0","lg:text-xl","font-medium","mb-0","block"],[1,"text-surface-600","dark:text-surface-200","lg:text-xl"],[1,"flex","justify-center","items-center","bg-orange-400","rounded-border",2,"height","3.5rem","width","3.5rem"],[1,"pi","pi-fw","pi-question-circle","text-surface-50","dark:text-surface-800","text-2xl"],[1,"text-surface-900","dark:text-surface-0","lg:text-xl","font-medium","mb-0"],[1,"w-full","flex","items-center","mb-8","py-8","border-surface-300","dark:border-surface-500","border-b",3,"routerLink"],[1,"flex","justify-center","items-center","bg-indigo-400","rounded-border",2,"height","3.5rem","width","3.5rem"],[1,"pi","pi-fw","pi-unlock","text-surface-50","dark:text-surface-800","text-2xl"]],template:function(i,o){i&1&&(d(0,"div",0)(1,"div",1),Y(2,"img",2),d(3,"div",3)(4,"div",4)(5,"span",5),v(6,"404"),u(),d(7,"h1",6),v(8,"Not Found"),u(),d(9,"div",7),v(10,"Requested resource is not available."),u(),d(11,"a",8)(12,"span",9),Y(13,"i",10),u(),d(14,"span",11)(15,"span",12),v(16,"Frequently Asked Questions"),u(),d(17,"span",13),v(18,"Ultricies mi quis hendrerit dolor."),u()()(),d(19,"a",8)(20,"span",14),Y(21,"i",15),u(),d(22,"span",11)(23,"span",16),v(24,"Solution Center"),u(),d(25,"span",13),v(26,"Phasellus faucibus scelerisque eleifend."),u()()(),d(27,"a",17)(28,"span",18),Y(29,"i",19),u(),d(30,"span",11)(31,"span",16),v(32,"Permission Manager"),u(),d(33,"span",13),v(34,"Accumsan in nisl nisi scelerisque"),u()()()()()()()),i&2&&(p(11),g("routerLink",Je(3,Qc)),p(8),g("routerLink",Je(4,Qc)),p(8),g("routerLink",Je(5,Qc)))},dependencies:[Ki,Fo],encapsulation:2});let t=r;return t})();var Tf=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=hr({type:t});static \u0275inj=mr({})}return t})();var xo=(()=>{let r=class r{constructor(){this._config={preset:"Aura",primary:"emerald",surface:null,darkTheme:!1,menuMode:"static"},this._state={staticMenuDesktopInactive:!1,overlayMenuActive:!1,configSidebarVisible:!1,staticMenuMobileActive:!1,menuHoverActive:!1},this.layoutConfig=zr(this._config),this.layoutState=zr(this._state),this.configUpdate=new bn,this.overlayOpen=new bn,this.menuSource=new bn,this.resetSource=new bn,this.menuSource$=this.menuSource.asObservable(),this.resetSource$=this.resetSource.asObservable(),this.configUpdate$=this.configUpdate.asObservable(),this.overlayOpen$=this.overlayOpen.asObservable(),this.theme=Mt(()=>this.layoutConfig()?.darkTheme?"light":"dark"),this.isSidebarActive=Mt(()=>this.layoutState().overlayMenuActive||this.layoutState().staticMenuMobileActive),this.isDarkTheme=Mt(()=>this.layoutConfig().darkTheme),this.getPrimary=Mt(()=>this.layoutConfig().primary),this.getSurface=Mt(()=>this.layoutConfig().surface),this.isOverlay=Mt(()=>this.layoutConfig().menuMode==="overlay"),this.transitionComplete=zr(!1),this.initialized=!1,Yo(()=>{this.layoutConfig()&&this.onConfigUpdate()}),Yo(()=>{let n=this.layoutConfig();if(!this.initialized||!n){this.initialized=!0;return}this.handleDarkModeTransition(n)})}handleDarkModeTransition(n){document.startViewTransition?this.startViewTransition(n):(this.toggleDarkMode(n),this.onTransitionEnd())}startViewTransition(n){document.startViewTransition(()=>{this.toggleDarkMode(n)}).ready.then(()=>{this.onTransitionEnd()}).catch(()=>{})}toggleDarkMode(n){(n||this.layoutConfig()).darkTheme?document.documentElement.classList.add("app-dark"):document.documentElement.classList.remove("app-dark")}onTransitionEnd(){this.transitionComplete.set(!0),setTimeout(()=>{this.transitionComplete.set(!1)})}onMenuToggle(){this.isOverlay()&&(this.layoutState.update(n=>vn(Pr({},n),{overlayMenuActive:!this.layoutState().overlayMenuActive})),this.layoutState().overlayMenuActive&&this.overlayOpen.next(null)),this.isDesktop()?this.layoutState.update(n=>vn(Pr({},n),{staticMenuDesktopInactive:!this.layoutState().staticMenuDesktopInactive})):(this.layoutState.update(n=>vn(Pr({},n),{staticMenuMobileActive:!this.layoutState().staticMenuMobileActive})),this.layoutState().staticMenuMobileActive&&this.overlayOpen.next(null))}toggleProfileSidebar(){this.layoutState.update(n=>vn(Pr({},n),{configSidebarVisible:!this.layoutState().configSidebarVisible}))}isDesktop(){return window.innerWidth>991}isMobile(){return!this.isDesktop()}onConfigUpdate(){this._config=Pr({},this.layoutConfig()),this.configUpdate.next(this.layoutConfig())}onMenuStateChange(n){this.menuSource.next(n)}reset(){this.resetSource.next(!0)}};r.\u0275fac=function(i){return new(i||r)},r.\u0275prov=Ye({token:r,factory:r.\u0275fac,providedIn:"root"});let t=r;return t})();var PC=["data-p-icon","upload"],Ef=(()=>{class t extends ld{pathId;onInit(){this.pathId="url(#"+un()+")"}static \u0275fac=(()=>{let e;return function(i){return(e||(e=ht(t)))(i||t)}})();static \u0275cmp=He({type:t,selectors:[["","data-p-icon","upload"]],features:[lt],attrs:PC,decls:5,vars:2,consts:[["fill-rule","evenodd","clip-rule","evenodd","d","M6.58942 9.82197C6.70165 9.93405 6.85328 9.99793 7.012 10C7.17071 9.99793 7.32234 9.93405 7.43458 9.82197C7.54681 9.7099 7.61079 9.55849 7.61286 9.4V2.04798L9.79204 4.22402C9.84752 4.28011 9.91365 4.32457 9.98657 4.35479C10.0595 4.38502 10.1377 4.40039 10.2167 4.40002C10.2956 4.40039 10.3738 4.38502 10.4467 4.35479C10.5197 4.32457 10.5858 4.28011 10.6413 4.22402C10.7538 4.11152 10.817 3.95902 10.817 3.80002C10.817 3.64102 10.7538 3.48852 10.6413 3.37602L7.45127 0.190618C7.44656 0.185584 7.44176 0.180622 7.43687 0.175736C7.32419 0.063214 7.17136 0 7.012 0C6.85264 0 6.69981 0.063214 6.58712 0.175736C6.58181 0.181045 6.5766 0.186443 6.5715 0.191927L3.38282 3.37602C3.27669 3.48976 3.2189 3.6402 3.22165 3.79564C3.2244 3.95108 3.28746 4.09939 3.39755 4.20932C3.50764 4.31925 3.65616 4.38222 3.81182 4.38496C3.96749 4.3877 4.11814 4.33001 4.23204 4.22402L6.41113 2.04807V9.4C6.41321 9.55849 6.47718 9.7099 6.58942 9.82197ZM11.9952 14H2.02883C1.751 13.9887 1.47813 13.9228 1.22584 13.8061C0.973545 13.6894 0.746779 13.5241 0.558517 13.3197C0.370254 13.1154 0.22419 12.876 0.128681 12.6152C0.0331723 12.3545 -0.00990605 12.0775 0.0019109 11.8V9.40005C0.0019109 9.24092 0.065216 9.08831 0.1779 8.97579C0.290584 8.86326 0.443416 8.80005 0.602775 8.80005C0.762134 8.80005 0.914966 8.86326 1.02765 8.97579C1.14033 9.08831 1.20364 9.24092 1.20364 9.40005V11.8C1.18295 12.0376 1.25463 12.274 1.40379 12.4602C1.55296 12.6463 1.76817 12.7681 2.00479 12.8H11.9952C12.2318 12.7681 12.447 12.6463 12.5962 12.4602C12.7453 12.274 12.817 12.0376 12.7963 11.8V9.40005C12.7963 9.24092 12.8596 9.08831 12.9723 8.97579C13.085 8.86326 13.2378 8.80005 13.3972 8.80005C13.5565 8.80005 13.7094 8.86326 13.8221 8.97579C13.9347 9.08831 13.998 9.24092 13.998 9.40005V11.8C14.022 12.3563 13.8251 12.8996 13.45 13.3116C13.0749 13.7236 12.552 13.971 11.9952 14Z","fill","currentColor"],[3,"id"],["width","14","height","14","fill","white"]],template:function(n,i){n&1&&($t(),Oc(0,"g"),ds(1,"path",0),Bc(),Oc(2,"defs")(3,"clipPath",1),ds(4,"rect",2),Bc()()),n&2&&(Ue("clip-path",i.pathId),p(3),$s("id",i.pathId))},encapsulation:2})}return t})();var DC=(t,r)=>({"pi ":!0,"pi-moon":t,"pi-sun":r}),OC=()=>({width:"30rem"}),e0=(()=>{let r=class r{constructor(n,i,o){this.layoutService=n,this.messageService=i,this.dbService=o,this.applicationSettings={togetherApiKey:void 0},o.getByID(r.SettingsStoreName,r.ApplicationSettingsID).subscribe(a=>{a?.data&&Object.assign(this.applicationSettings,a.data)})}openSettingsDialog(){this.showSettingsDialog=!0}saveApplicationSettings(){let n={id:r.ApplicationSettingsID,data:this.applicationSettings};console.log(n),this.dbService.update(r.SettingsStoreName,n).pipe(ge(i=>(this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430 \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u044F \u043D\u0430\u0441\u0442\u0440\u043E\u0435\u043A",severity:"error",detail:i}),it))).subscribe(()=>{this.showSettingsDialog=!1,this.messageService.add({summary:"\u041E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u0435 \u043D\u0430\u0441\u0442\u0440\u043E\u0435\u043A",severity:"success",detail:"\u041D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0438 \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u044B"})})}toggleDarkMode(){this.layoutService.layoutConfig.update(n=>vn(Pr({},n),{darkTheme:!n.darkTheme}))}};r.ApplicationSettingsID="ApplicationSettingsID",r.SettingsStoreName="Settings",r.\u0275fac=function(i){return new(i||r)(Pe(xo),Pe(Yt),Pe(Sn))},r.\u0275cmp=He({type:r,selectors:[["app-topbar"]],decls:28,vars:10,consts:[["topbarmenubutton",""],[1,"layout-topbar"],[1,"layout-topbar-logo-container"],[1,"layout-menu-button","layout-topbar-action",3,"click"],[1,"pi","pi-bars"],["routerLink","/",1,"layout-topbar-logo"],["src","assets/layout/images/logo.png"],[1,"layout-topbar-actions"],[1,"layout-config-menu"],["type","button",1,"layout-topbar-action",3,"click"],[3,"ngClass"],[1,"p-link","layout-topbar-action",3,"click"],[1,"pi","pi-user"],[1,"pi","pi-cog"],["header","\u041D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0438",3,"visibleChange","modal","visible"],[1,"flex","items-center","gap-4","mb-8"],["for","togetherApiKey",1,"font-semibold","w-40","whitespace-nowrap"],["pInputText","","id","togetherApiKey","type","password","autocomplete","off",1,"flex-auto",3,"ngModelChange","ngModel"],[1,"flex","justify-end","gap-2"],["label","Cancel","severity","secondary",3,"onClick"],["label","Save",3,"onClick"]],template:function(i,o){if(i&1){let a=pe();Y(0,"p-toast"),d(1,"div",1)(2,"div",2)(3,"button",3),ee("click",function(){return O(a),B(o.layoutService.onMenuToggle())}),Y(4,"i",4),u(),d(5,"a",5),Y(6,"img",6),d(7,"span"),v(8,"REDICY"),u()()(),d(9,"div",7)(10,"div",8)(11,"button",9),ee("click",function(){return O(a),B(o.toggleDarkMode())}),Y(12,"i",10),u()(),d(13,"button",11,0),ee("click",function(){return O(a),B(o.layoutService.toggleProfileSidebar())}),Y(15,"i",12),u(),d(16,"button",11),ee("click",function(){return O(a),B(o.openSettingsDialog())}),Y(17,"i",13),d(18,"span"),v(19,"\u041D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0438"),u()()()(),d(20,"p-dialog",14),Fe("visibleChange",function(c){return O(a),ke(o.showSettingsDialog,c)||(o.showSettingsDialog=c),B(c)}),d(21,"div",15)(22,"label",16),v(23,"Together.AI api key"),u(),d(24,"input",17),Fe("ngModelChange",function(c){return O(a),ke(o.applicationSettings.togetherApiKey,c)||(o.applicationSettings.togetherApiKey=c),B(c)}),u()(),d(25,"div",18)(26,"p-button",19),ee("onClick",function(){return O(a),B(o.showSettingsDialog=!1)}),u(),d(27,"p-button",20),ee("onClick",function(){return O(a),B(o.saveApplicationSettings())}),u()()()}i&2&&(p(12),g("ngClass",di(6,DC,o.layoutService.isDarkTheme(),!o.layoutService.isDarkTheme())),p(8),Qt(Je(9,OC)),g("modal",!0),Se("visible",o.showSettingsDialog),p(4),Se("ngModel",o.applicationSettings.togetherApiKey))},dependencies:[nr,Ht,et,Br,Xn,Kn,jr,Gn,Ur,Wr,wn,Yi,Ki,Fo,Tf,vr,xr],encapsulation:2});let t=r;return t})();var BC=["app-menuitem",""],MC=()=>({paths:"exact",queryParams:"ignored",matrixParams:"ignored",fragment:"ignored"});function RC(t,r){if(t&1&&(d(0,"div",4),v(1),u()),t&2){let e=h();p(),he(e.item.label)}}function LC(t,r){t&1&&Y(0,"i",9)}function NC(t,r){if(t&1){let e=pe();d(0,"a",5),ee("click",function(i){O(e);let o=h();return B(o.itemClick(i))}),Y(1,"i",6),d(2,"span",7),v(3),u(),P(4,LC,1,0,"i",8),u()}if(t&2){let e=h();g("ngClass",e.item.styleClass),Ue("href",e.item.url,Gt)("target",e.item.target),p(),g("ngClass",e.item.icon),p(2),he(e.item.label),p(),g("ngIf",e.item.items)}}function VC(t,r){t&1&&Y(0,"i",9)}function zC(t,r){if(t&1){let e=pe();d(0,"a",10),ee("click",function(i){O(e);let o=h();return B(o.itemClick(i))}),Y(1,"i",6),d(2,"span",7),v(3),u(),P(4,VC,1,0,"i",8),u()}if(t&2){let e=h();g("ngClass",e.item.styleClass)("routerLink",e.item.routerLink)("routerLinkActiveOptions",e.item.routerLinkActiveOptions||Je(14,MC))("fragment",e.item.fragment)("queryParamsHandling",e.item.queryParamsHandling)("preserveFragment",e.item.preserveFragment)("skipLocationChange",e.item.skipLocationChange)("replaceUrl",e.item.replaceUrl)("state",e.item.state)("queryParams",e.item.queryParams),Ue("target",e.item.target),p(),g("ngClass",e.item.icon),p(2),he(e.item.label),p(),g("ngIf",e.item.items)}}function UC(t,r){if(t&1&&Y(0,"li",12),t&2){let e=r.$implicit,n=r.index,i=h(2);_e(e.badgeClass),g("item",e)("index",n)("parentKey",i.key)}}function WC(t,r){if(t&1&&(d(0,"ul"),P(1,UC,1,5,"ng-template",11),u()),t&2){let e=h();g("@children",e.submenuAnimation),p(),g("ngForOf",e.item.items)}}var Ff=(()=>{let r=class r{constructor(n,i){this.router=n,this.layoutService=i,this.active=!1,this.key="",this.menuSourceSubscription=this.layoutService.menuSource$.subscribe(o=>{Promise.resolve(null).then(()=>{o.routeEvent?this.active=!!(o.key===this.key||o.key.startsWith(this.key+"-")):o.key!==this.key&&!o.key.startsWith(this.key+"-")&&(this.active=!1)})}),this.menuResetSubscription=this.layoutService.resetSource$.subscribe(()=>{this.active=!1}),this.router.events.pipe(wr(o=>o instanceof Js)).subscribe(o=>{this.item.routerLink&&this.updateActiveStateFromRoute()})}ngOnInit(){this.key=this.parentKey?this.parentKey+"-"+this.index:String(this.index),this.item.routerLink&&this.updateActiveStateFromRoute()}updateActiveStateFromRoute(){this.router.isActive(this.item.routerLink[0],{paths:"exact",queryParams:"ignored",matrixParams:"ignored",fragment:"ignored"})&&this.layoutService.onMenuStateChange({key:this.key,routeEvent:!0})}itemClick(n){if(this.item.disabled){n.preventDefault();return}this.item.command&&this.item.command({originalEvent:n,item:this.item}),this.item.items&&(this.active=!this.active),this.layoutService.onMenuStateChange({key:this.key})}get submenuAnimation(){return this.root||this.active?"expanded":"collapsed"}get activeClass(){return this.active&&!this.root}ngOnDestroy(){this.menuSourceSubscription&&this.menuSourceSubscription.unsubscribe(),this.menuResetSubscription&&this.menuResetSubscription.unsubscribe()}};r.\u0275fac=function(i){return new(i||r)(Pe(jn),Pe(xo))},r.\u0275cmp=He({type:r,selectors:[["","app-menuitem",""]],hostVars:4,hostBindings:function(i,o){i&2&&ku("layout-root-menuitem",o.root)("active-menuitem",o.activeClass)},inputs:{item:"item",index:"index",root:"root",parentKey:"parentKey"},features:[Dt([xo])],attrs:BC,decls:5,vars:4,consts:[["class","layout-menuitem-root-text",4,"ngIf"],["tabindex","0","pRipple","",3,"ngClass","click",4,"ngIf"],["routerLinkActive","active-route","tabindex","0","pRipple","",3,"ngClass","routerLink","routerLinkActiveOptions","fragment","queryParamsHandling","preserveFragment","skipLocationChange","replaceUrl","state","queryParams","click",4,"ngIf"],[4,"ngIf"],[1,"layout-menuitem-root-text"],["tabindex","0","pRipple","",3,"click","ngClass"],[1,"layout-menuitem-icon",3,"ngClass"],[1,"layout-menuitem-text"],["class","pi pi-fw pi-angle-down layout-submenu-toggler",4,"ngIf"],[1,"pi","pi-fw","pi-angle-down","layout-submenu-toggler"],["routerLinkActive","active-route","tabindex","0","pRipple","",3,"click","ngClass","routerLink","routerLinkActiveOptions","fragment","queryParamsHandling","preserveFragment","skipLocationChange","replaceUrl","state","queryParams"],["ngFor","",3,"ngForOf"],["app-menuitem","",3,"item","index","parentKey"]],template:function(i,o){i&1&&(Le(0),P(1,RC,2,1,"div",0)(2,NC,5,6,"a",1)(3,zC,5,15,"a",2)(4,WC,2,2,"ul",3),Ne()),i&2&&(p(),g("ngIf",o.root&&o.item.visible!==!1),p(),g("ngIf",(!o.item.routerLink||o.item.items)&&o.item.visible!==!1),p(),g("ngIf",o.item.routerLink&&!o.item.items&&o.item.visible!==!1),p(),g("ngIf",o.item.items&&o.item.visible!==!1))},dependencies:[r,et,Br,Mr,bt,Ki,Fo,Uu,il,Dn],encapsulation:2,data:{animation:[$n("children",[mo("collapsed",ki({height:"0"})),mo("expanded",ki({height:"*"})),Qi("collapsed <=> expanded",qi("400ms cubic-bezier(0.86, 0, 0.07, 1)"))])]}});let t=r;return t})();function jC(t,r){if(t&1&&Y(0,"li",4),t&2){let e=h(),n=e.$implicit,i=e.index;g("item",n)("index",i)("root",!0)}}function HC(t,r){t&1&&Y(0,"li",5)}function $C(t,r){if(t&1&&(Le(0),P(1,jC,1,3,"li",2)(2,HC,1,0,"li",3),Ne()),t&2){let e=r.$implicit;p(),g("ngIf",!e.separator),p(),g("ngIf",e.separator)}}var Af=(()=>{let r=class r{constructor(){this.model=[]}ngOnInit(){this.model=[{label:"\u0421\u0435\u043B\u043B\u0435\u0440",items:[{label:"\u041E\u0431\u0437\u043E\u0440",icon:"pi pi-fw pi-cog",routerLink:["/"]},{label:"\u0417\u0430\u043A\u0430\u0437\u044B \u043D\u0430 \u041E\u0437\u043E\u043D",icon:"pi pi-fw pi-shopping-cart",routerLink:["/ozon/salesOrders"]},{label:"\u0412\u043E\u0437\u0432\u0440\u0430\u0442\u044B \u043D\u0430 \u041E\u0437\u043E\u043D",icon:"pi pi-fw pi-shopping-cart",routerLink:["/ozon/returns"]},{label:"\u0420\u0435\u0434\u0430\u043A\u0442\u043E\u0440 \u043A\u0430\u0440\u0442\u0438\u043D\u043E\u043A",icon:"pi pi-fw pi-image",routerLink:["product","image-editor","editor"]},{label:"\u0410\u043D\u0438\u043C\u0430\u0442\u043E\u0440 \u043A\u0430\u0440\u0442\u0438\u043D\u043E\u043A",icon:"pi pi-fw pi-video",routerLink:["product","animator"]},{label:"\u0422\u043E\u0432\u0430\u0440\u044B",icon:"pi pi-fw pi-gift",routerLink:["product","list"]},{label:"\u0417\u0430\u043A\u0443\u043F\u043A\u0438",icon:"pi pi-fw pi-percentage",items:[{label:"\u0420\u0435\u0434\u0430\u043A\u0442\u043E\u0440 \u0437\u0430\u043A\u0443\u043F\u043E\u043A",icon:"pi pi-fw pi-pencil",routerLink:["purchase","edit"]},{label:"\u0421\u043F\u0438\u0441\u043E\u043A \u0437\u0430\u043A\u0443\u043F\u043E\u043A",icon:"pi pi-fw pi-list",routerLink:["purchase"]},{label:"\u0414\u0435\u0440\u0435\u0432\u043E \u0442\u043E\u0432\u0430\u0440\u043E\u0432",icon:"pi pi-fw pi-sitemap",routerLink:["purchase","product-tree"]},{label:"\u0423\u043F\u0430\u043A\u043E\u0432\u043A\u0430 \u0442\u043E\u0432\u0430\u0440\u043E\u0432",icon:"pi pi-fw pi-box",routerLink:["purchase","package-type","list"]},{label:"\u0410\u043D\u0430\u043B\u0438\u0437 \u043F\u0440\u0430\u0439\u0441-\u043B\u0438\u0441\u0442\u043E\u0432",icon:"pi pi-fw pi-dollar",routerLink:["purchase","price-analyzer"]}]}]},{label:"\u041F\u043E\u0434\u0431\u043E\u0440 \u0430\u0440\u0442\u0438\u043A\u0443\u043B\u043E\u0432",items:[{label:"\u041A\u043B\u044E\u0447\u0435\u0432\u044B\u0435 \u0441\u043B\u043E\u0432\u0430",routerLink:["/search-term"]},{label:"\u041E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u0435 \u0434\u0430\u043D\u043D\u044B\u0445",routerLink:["/search-term/update"]}]},{label:"\u041E\u0442\u0433\u0440\u0443\u0437\u043A\u0438",icon:"pi pi-fw pi-building",items:[{label:"\u041E\u0442\u0433\u0440\u0443\u0437\u043A\u0438",icon:"pi pi-fw pi-building",routerLink:["/shipment/"]}]},{label:"\u041E\u0437\u043E\u043D",items:[{label:"\u0422\u043E\u0432\u0430\u0440\u044B \u043D\u0430 \u041E\u0437\u043E\u043D",routerLink:["/ozon/product"]},{label:"\u0410\u043A\u0446\u0438\u0438 \u043D\u0430 \u041E\u0437\u043E\u043D",routerLink:["/ozon/action"]},{label:"\u0414\u0435\u0444\u0438\u0446\u0438\u0442 \u043E\u0441\u0442\u0430\u0442\u043A\u043E\u0432",routerLink:["/ozon/stock-starvation-report"]},{label:"\u041F\u043E\u0441\u0442\u0430\u0432\u043A\u0438",routerLink:["/ozon/supplyOrder"]},{label:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044F \u043F\u043E\u0441\u0442\u0430\u0432\u043E\u043A",routerLink:["/ozon/supplyRegistrationTask"]},{label:"\u0422\u0440\u0430\u043D\u0437\u0430\u043A\u0446\u0438\u0438 \u041E\u0437\u043E\u043D",routerLink:["/ozon/transaction"]},{label:"\u0421\u0432\u0435\u0440\u043A\u0430 \u041E\u0437\u043E\u043D",routerLink:["/ozon/reconciliation"]},{label:"\u0421\u043A\u043B\u0430\u0434\u044B \u041E\u0437\u043E\u043D",icon:"pi pi-fw pi-building",routerLink:["/ozon/warehouse/list"]}]}]}};r.\u0275fac=function(i){return new(i||r)},r.\u0275cmp=He({type:r,selectors:[["app-menu"]],decls:2,vars:1,consts:[[1,"layout-menu"],[4,"ngFor","ngForOf"],["app-menuitem","",3,"item","index","root",4,"ngIf"],["class","menu-separator",4,"ngIf"],["app-menuitem","",3,"item","index","root"],[1,"menu-separator"]],template:function(i,o){i&1&&(d(0,"ul",0),P(1,$C,3,2,"ng-container",1),u()),i&2&&(p(),g("ngForOf",o.model))},dependencies:[et,Mr,bt,Ff,Ki],encapsulation:2});let t=r;return t})();var t0=(()=>{let r=class r{constructor(n){this.el=n}};r.\u0275fac=function(i){return new(i||r)(Pe(wa))},r.\u0275cmp=He({type:r,selectors:[["app-sidebar"]],decls:2,vars:0,consts:[[1,"layout-sidebar"]],template:function(i,o){i&1&&(d(0,"div",0),Y(1,"app-menu"),u())},dependencies:[Af],encapsulation:2});let t=r;return t})();var Pf=(()=>{let r=class r{};r.\u0275fac=function(i){return new(i||r)},r.\u0275cmp=He({type:r,selectors:[["app-footer"]],decls:1,vars:0,consts:[[1,"layout-footer"]],template:function(i,o){i&1&&ds(0,"div",0)},encapsulation:2});let t=r;return t})();var Df=(()=>{let r=class r{constructor(n,i,o){this.layoutService=n,this.renderer=i,this.router=o,this.overlayMenuOpenSubscription=this.layoutService.overlayOpen$.subscribe(()=>{this.menuOutsideClickListener||(this.menuOutsideClickListener=this.renderer.listen("document","click",a=>{this.isOutsideClicked(a)&&this.hideMenu()})),this.layoutService.layoutState().staticMenuMobileActive&&this.blockBodyScroll()}),this.router.events.pipe(wr(a=>a instanceof Js)).subscribe(()=>{this.hideMenu()})}isOutsideClicked(n){let i=document.querySelector(".layout-sidebar"),o=document.querySelector(".layout-menu-button"),a=n.target;return!(i?.isSameNode(a)||i?.contains(a)||o?.isSameNode(a)||o?.contains(a))}hideMenu(){this.layoutService.layoutState.update(n=>vn(Pr({},n),{overlayMenuActive:!1,staticMenuMobileActive:!1,menuHoverActive:!1})),this.menuOutsideClickListener&&(this.menuOutsideClickListener(),this.menuOutsideClickListener=null),this.unblockBodyScroll()}blockBodyScroll(){document.body.classList?document.body.classList.add("blocked-scroll"):document.body.className+=" blocked-scroll"}unblockBodyScroll(){document.body.classList?document.body.classList.remove("blocked-scroll"):document.body.className=document.body.className.replace(new RegExp("(^|\\b)"+"blocked-scroll".split(" ").join("|")+"(\\b|$)","gi")," ")}get containerClass(){return{"layout-overlay":this.layoutService.layoutConfig().menuMode==="overlay","layout-static":this.layoutService.layoutConfig().menuMode==="static","layout-static-inactive":this.layoutService.layoutState().staticMenuDesktopInactive&&this.layoutService.layoutConfig().menuMode==="static","layout-overlay-active":this.layoutService.layoutState().overlayMenuActive,"layout-mobile-active":this.layoutService.layoutState().staticMenuMobileActive}}ngOnDestroy(){this.overlayMenuOpenSubscription&&this.overlayMenuOpenSubscription.unsubscribe(),this.menuOutsideClickListener&&this.menuOutsideClickListener()}};r.\u0275fac=function(i){return new(i||r)(Pe(xo),Pe(Ac),Pe(jn))},r.\u0275cmp=He({type:r,selectors:[["app-layout"]],viewQuery:function(i,o){if(i&1&&(Nt(t0,5),Nt(e0,5)),i&2){let a;Te(a=Ee())&&(o.appSidebar=a.first),Te(a=Ee())&&(o.appTopBar=a.first)}},decls:8,vars:1,consts:[[1,"layout-wrapper",3,"ngClass"],[1,"layout-main-container"],[1,"layout-main"],[1,"layout-mask","animate-fadein"]],template:function(i,o){i&1&&(d(0,"div",0),Y(1,"app-topbar")(2,"app-sidebar"),d(3,"div",1)(4,"div",2),Y(5,"router-outlet"),u(),Y(6,"app-footer"),u(),Y(7,"div",3),u()),i&2&&g("ngClass",o.containerClass)},dependencies:[et,Br,e0,t0,Ki,qs,Pf],encapsulation:2});let t=r;return t})();var ra=()=>{let t=we(cl),r=we(jn);return t.isLoggedIn||r.createUrlTree(["auth","login"])};var Of=`
    .p-message {
        border-radius: dt('message.border.radius');
        outline-width: dt('message.border.width');
        outline-style: solid;
    }

    .p-message-content {
        display: flex;
        align-items: center;
        padding: dt('message.content.padding');
        gap: dt('message.content.gap');
        height: 100%;
    }

    .p-message-icon {
        flex-shrink: 0;
    }

    .p-message-close-button {
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
        margin-inline-start: auto;
        overflow: hidden;
        position: relative;
        width: dt('message.close.button.width');
        height: dt('message.close.button.height');
        border-radius: dt('message.close.button.border.radius');
        background: transparent;
        transition:
            background dt('message.transition.duration'),
            color dt('message.transition.duration'),
            outline-color dt('message.transition.duration'),
            box-shadow dt('message.transition.duration'),
            opacity 0.3s;
        outline-color: transparent;
        color: inherit;
        padding: 0;
        border: none;
        cursor: pointer;
        user-select: none;
    }

    .p-message-close-icon {
        font-size: dt('message.close.icon.size');
        width: dt('message.close.icon.size');
        height: dt('message.close.icon.size');
    }

    .p-message-close-button:focus-visible {
        outline-width: dt('message.close.button.focus.ring.width');
        outline-style: dt('message.close.button.focus.ring.style');
        outline-offset: dt('message.close.button.focus.ring.offset');
    }

    .p-message-info {
        background: dt('message.info.background');
        outline-color: dt('message.info.border.color');
        color: dt('message.info.color');
        box-shadow: dt('message.info.shadow');
    }

    .p-message-info .p-message-close-button:focus-visible {
        outline-color: dt('message.info.close.button.focus.ring.color');
        box-shadow: dt('message.info.close.button.focus.ring.shadow');
    }

    .p-message-info .p-message-close-button:hover {
        background: dt('message.info.close.button.hover.background');
    }

    .p-message-info.p-message-outlined {
        color: dt('message.info.outlined.color');
        outline-color: dt('message.info.outlined.border.color');
    }

    .p-message-info.p-message-simple {
        color: dt('message.info.simple.color');
    }

    .p-message-success {
        background: dt('message.success.background');
        outline-color: dt('message.success.border.color');
        color: dt('message.success.color');
        box-shadow: dt('message.success.shadow');
    }

    .p-message-success .p-message-close-button:focus-visible {
        outline-color: dt('message.success.close.button.focus.ring.color');
        box-shadow: dt('message.success.close.button.focus.ring.shadow');
    }

    .p-message-success .p-message-close-button:hover {
        background: dt('message.success.close.button.hover.background');
    }

    .p-message-success.p-message-outlined {
        color: dt('message.success.outlined.color');
        outline-color: dt('message.success.outlined.border.color');
    }

    .p-message-success.p-message-simple {
        color: dt('message.success.simple.color');
    }

    .p-message-warn {
        background: dt('message.warn.background');
        outline-color: dt('message.warn.border.color');
        color: dt('message.warn.color');
        box-shadow: dt('message.warn.shadow');
    }

    .p-message-warn .p-message-close-button:focus-visible {
        outline-color: dt('message.warn.close.button.focus.ring.color');
        box-shadow: dt('message.warn.close.button.focus.ring.shadow');
    }

    .p-message-warn .p-message-close-button:hover {
        background: dt('message.warn.close.button.hover.background');
    }

    .p-message-warn.p-message-outlined {
        color: dt('message.warn.outlined.color');
        outline-color: dt('message.warn.outlined.border.color');
    }

    .p-message-warn.p-message-simple {
        color: dt('message.warn.simple.color');
    }

    .p-message-error {
        background: dt('message.error.background');
        outline-color: dt('message.error.border.color');
        color: dt('message.error.color');
        box-shadow: dt('message.error.shadow');
    }

    .p-message-error .p-message-close-button:focus-visible {
        outline-color: dt('message.error.close.button.focus.ring.color');
        box-shadow: dt('message.error.close.button.focus.ring.shadow');
    }

    .p-message-error .p-message-close-button:hover {
        background: dt('message.error.close.button.hover.background');
    }

    .p-message-error.p-message-outlined {
        color: dt('message.error.outlined.color');
        outline-color: dt('message.error.outlined.border.color');
    }

    .p-message-error.p-message-simple {
        color: dt('message.error.simple.color');
    }

    .p-message-secondary {
        background: dt('message.secondary.background');
        outline-color: dt('message.secondary.border.color');
        color: dt('message.secondary.color');
        box-shadow: dt('message.secondary.shadow');
    }

    .p-message-secondary .p-message-close-button:focus-visible {
        outline-color: dt('message.secondary.close.button.focus.ring.color');
        box-shadow: dt('message.secondary.close.button.focus.ring.shadow');
    }

    .p-message-secondary .p-message-close-button:hover {
        background: dt('message.secondary.close.button.hover.background');
    }

    .p-message-secondary.p-message-outlined {
        color: dt('message.secondary.outlined.color');
        outline-color: dt('message.secondary.outlined.border.color');
    }

    .p-message-secondary.p-message-simple {
        color: dt('message.secondary.simple.color');
    }

    .p-message-contrast {
        background: dt('message.contrast.background');
        outline-color: dt('message.contrast.border.color');
        color: dt('message.contrast.color');
        box-shadow: dt('message.contrast.shadow');
    }

    .p-message-contrast .p-message-close-button:focus-visible {
        outline-color: dt('message.contrast.close.button.focus.ring.color');
        box-shadow: dt('message.contrast.close.button.focus.ring.shadow');
    }

    .p-message-contrast .p-message-close-button:hover {
        background: dt('message.contrast.close.button.hover.background');
    }

    .p-message-contrast.p-message-outlined {
        color: dt('message.contrast.outlined.color');
        outline-color: dt('message.contrast.outlined.border.color');
    }

    .p-message-contrast.p-message-simple {
        color: dt('message.contrast.simple.color');
    }

    .p-message-text {
        font-size: dt('message.text.font.size');
        font-weight: dt('message.text.font.weight');
    }

    .p-message-icon {
        font-size: dt('message.icon.size');
        width: dt('message.icon.size');
        height: dt('message.icon.size');
    }

    .p-message-enter-from {
        opacity: 0;
    }

    .p-message-enter-active {
        transition: opacity 0.3s;
    }

    .p-message.p-message-leave-from {
        max-height: 1000px;
    }

    .p-message.p-message-leave-to {
        max-height: 0;
        opacity: 0;
        margin: 0;
    }

    .p-message-leave-active {
        overflow: hidden;
        transition:
            max-height 0.45s cubic-bezier(0, 1, 0, 1),
            opacity 0.3s,
            margin 0.3s;
    }

    .p-message-leave-active .p-message-close-button {
        opacity: 0;
    }

    .p-message-sm .p-message-content {
        padding: dt('message.content.sm.padding');
    }

    .p-message-sm .p-message-text {
        font-size: dt('message.text.sm.font.size');
    }

    .p-message-sm .p-message-icon {
        font-size: dt('message.icon.sm.size');
        width: dt('message.icon.sm.size');
        height: dt('message.icon.sm.size');
    }

    .p-message-sm .p-message-close-icon {
        font-size: dt('message.close.icon.sm.size');
        width: dt('message.close.icon.sm.size');
        height: dt('message.close.icon.sm.size');
    }

    .p-message-lg .p-message-content {
        padding: dt('message.content.lg.padding');
    }

    .p-message-lg .p-message-text {
        font-size: dt('message.text.lg.font.size');
    }

    .p-message-lg .p-message-icon {
        font-size: dt('message.icon.lg.size');
        width: dt('message.icon.lg.size');
        height: dt('message.icon.lg.size');
    }

    .p-message-lg .p-message-close-icon {
        font-size: dt('message.close.icon.lg.size');
        width: dt('message.close.icon.lg.size');
        height: dt('message.close.icon.lg.size');
    }

    .p-message-outlined {
        background: transparent;
        outline-width: dt('message.outlined.border.width');
    }

    .p-message-simple {
        background: transparent;
        outline-color: transparent;
        box-shadow: none;
    }

    .p-message-simple .p-message-content {
        padding: dt('message.simple.content.padding');
    }

    .p-message-outlined .p-message-close-button:hover,
    .p-message-simple .p-message-close-button:hover {
        background: transparent;
    }
`;var GC=["container"],KC=["icon"],XC=["closeicon"],JC=["*"],qC=(t,r)=>({showTransitionParams:t,hideTransitionParams:r}),QC=t=>({value:"visible()",params:t}),YC=t=>({closeCallback:t});function ZC(t,r){t&1&&Tt(0)}function e3(t,r){if(t&1&&P(0,ZC,1,0,"ng-container",4),t&2){let e=h(2);g("ngTemplateOutlet",e.iconTemplate||e._iconTemplate)}}function t3(t,r){if(t&1&&Y(0,"i",2),t&2){let e=h(2);_e(e.cn(e.cx("icon"),e.icon)),g("pBind",e.ptm("icon"))}}function r3(t,r){t&1&&Tt(0)}function i3(t,r){if(t&1&&P(0,r3,1,0,"ng-container",5),t&2){let e=h(2);g("ngTemplateOutlet",e.containerTemplate||e._containerTemplate)("ngTemplateOutletContext",vt(2,YC,e.closeCallback))}}function n3(t,r){if(t&1&&Y(0,"span",9),t&2){let e=h(4);g("pBind",e.ptm("text"))("ngClass",e.cx("text"))("innerHTML",e.text,Vn)}}function o3(t,r){if(t&1&&(d(0,"div"),P(1,n3,1,3,"span",8),u()),t&2){let e=h(3);p(),g("ngIf",!e.escape)}}function a3(t,r){if(t&1&&(d(0,"span",7),v(1),u()),t&2){let e=h(4);g("pBind",e.ptm("text"))("ngClass",e.cx("text")),p(),he(e.text)}}function s3(t,r){if(t&1&&P(0,a3,2,3,"span",10),t&2){let e=h(3);g("ngIf",e.escape&&e.text)}}function l3(t,r){if(t&1&&(P(0,o3,2,1,"div",6)(1,s3,1,1,"ng-template",null,0,Z),d(3,"span",7),gr(4),u()),t&2){let e=Dr(2),n=h(2);g("ngIf",!n.escape)("ngIfElse",e),p(3),g("pBind",n.ptm("text"))("ngClass",n.cx("text"))}}function c3(t,r){if(t&1&&Y(0,"i",7),t&2){let e=h(3);_e(e.cn(e.cx("closeIcon"),e.closeIcon)),g("pBind",e.ptm("closeIcon"))("ngClass",e.closeIcon)}}function u3(t,r){t&1&&Tt(0)}function d3(t,r){if(t&1&&P(0,u3,1,0,"ng-container",4),t&2){let e=h(3);g("ngTemplateOutlet",e.closeIconTemplate||e._closeIconTemplate)}}function p3(t,r){if(t&1&&($t(),Y(0,"svg",14)),t&2){let e=h(3);_e(e.cx("closeIcon")),g("pBind",e.ptm("closeIcon"))}}function f3(t,r){if(t&1){let e=pe();d(0,"button",11),ee("click",function(i){O(e);let o=h(2);return B(o.close(i))}),ft(1,c3,1,4,"i",12),ft(2,d3,1,1,"ng-container"),ft(3,p3,1,3,":svg:svg",13),u()}if(t&2){let e=h(2);_e(e.cx("closeButton")),g("pBind",e.ptm("closeButton")),Ue("aria-label",e.closeAriaLabel),p(),mt(e.closeIcon?1:-1),p(),mt(e.closeIconTemplate||e._closeIconTemplate?2:-1),p(),mt(!e.closeIconTemplate&&!e._closeIconTemplate&&!e.closeIcon?3:-1)}}function m3(t,r){if(t&1&&(d(0,"div",2)(1,"div",2),ft(2,e3,1,1,"ng-container"),ft(3,t3,1,3,"i",1),ft(4,i3,1,4,"ng-container")(5,l3,5,4),ft(6,f3,4,7,"button",3),u()()),t&2){let e=h();_e(e.cn(e.cx("root"),e.styleClass)),g("pBind",e.ptm("root"))("@messageAnimation",vt(16,QC,di(13,qC,e.showTransitionOptions,e.hideTransitionOptions))),Ue("aria-live","polite")("role","alert"),p(),_e(e.cx("content")),g("pBind",e.ptm("content")),p(),mt(e.iconTemplate||e._iconTemplate?2:-1),p(),mt(e.icon?3:-1),p(),mt(e.containerTemplate||e._containerTemplate?4:5),p(2),mt(e.closable?6:-1)}}var h3={root:({instance:t})=>["p-message p-component p-message-"+t.severity,"p-message-"+t.variant,{"p-message-sm":t.size==="small","p-message-lg":t.size==="large"}],content:"p-message-content",icon:"p-message-icon",text:"p-message-text",closeButton:"p-message-close-button",closeIcon:"p-message-close-icon"},Bf=(()=>{class t extends ir{name="message";style=Of;classes=h3;static \u0275fac=(()=>{let e;return function(i){return(e||(e=ht(t)))(i||t)}})();static \u0275prov=Ye({token:t,factory:t.\u0275fac})}return t})();var Mf=new wt("MESSAGE_INSTANCE"),Rf=(()=>{class t extends Zt{_componentStyle=we(Bf);bindDirectiveInstance=we(Ge,{self:!0});$pcMessage=we(Mf,{optional:!0,skipSelf:!0})??void 0;onAfterViewChecked(){this.bindDirectiveInstance.setAttrs(this.ptm("host"))}severity="info";text;escape=!0;style;styleClass;closable=!1;icon;closeIcon;life;showTransitionOptions="300ms ease-out";hideTransitionOptions="200ms cubic-bezier(0.86, 0, 0.07, 1)";size;variant;onClose=new xt;get closeAriaLabel(){return this.config.translation.aria?this.config.translation.aria.close:void 0}visible=zr(!0);containerTemplate;iconTemplate;closeIconTemplate;templates;_containerTemplate;_iconTemplate;_closeIconTemplate;closeCallback=e=>{this.close(e)};onInit(){this.life&&setTimeout(()=>{this.visible.set(!1)},this.life)}onAfterContentInit(){this.templates?.forEach(e=>{switch(e.getType()){case"container":this._containerTemplate=e.template;break;case"icon":this._iconTemplate=e.template;break;case"closeicon":this._closeIconTemplate=e.template;break}})}close(e){this.visible.set(!1),this.onClose.emit({originalEvent:e})}static \u0275fac=(()=>{let e;return function(i){return(e||(e=ht(t)))(i||t)}})();static \u0275cmp=He({type:t,selectors:[["p-message"]],contentQueries:function(n,i,o){if(n&1&&(Ke(o,GC,4),Ke(o,KC,4),Ke(o,XC,4),Ke(o,pi,4)),n&2){let a;Te(a=Ee())&&(i.containerTemplate=a.first),Te(a=Ee())&&(i.iconTemplate=a.first),Te(a=Ee())&&(i.closeIconTemplate=a.first),Te(a=Ee())&&(i.templates=a)}},inputs:{severity:"severity",text:"text",escape:[2,"escape","escape",$e],style:"style",styleClass:"styleClass",closable:[2,"closable","closable",$e],icon:"icon",closeIcon:"closeIcon",life:"life",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",size:"size",variant:"variant"},outputs:{onClose:"onClose"},features:[Dt([Bf,{provide:Mf,useExisting:t},{provide:Jt,useExisting:t}]),Xt([Ge]),lt],ngContentSelectors:JC,decls:1,vars:1,consts:[["escapeOut",""],[3,"pBind","class"],[3,"pBind"],["pRipple","","type","button",3,"pBind","class"],[4,"ngTemplateOutlet"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[4,"ngIf","ngIfElse"],[3,"pBind","ngClass"],[3,"pBind","ngClass","innerHTML",4,"ngIf"],[3,"pBind","ngClass","innerHTML"],[3,"pBind","ngClass",4,"ngIf"],["pRipple","","type","button",3,"click","pBind"],[3,"pBind","class","ngClass"],["data-p-icon","times",3,"pBind","class"],["data-p-icon","times",3,"pBind"]],template:function(n,i){n&1&&(Sr(),ft(0,m3,7,18,"div",1)),n&2&&mt(i.visible()?0:-1)},dependencies:[et,Br,bt,Rr,ho,Dn,It,Ge],encapsulation:2,data:{animation:[$n("messageAnimation",[Qi(":enter",[ki({opacity:0,transform:"translateY(-25%)"}),qi("{{showTransitionParams}}")]),Qi(":leave",[qi("{{hideTransitionParams}}",ki({height:0,marginTop:0,marginBottom:0,marginLeft:0,marginRight:0,opacity:0}))])])]},changeDetection:0})}return t})();var Lf=`
    .p-progressbar {
        display: block;
        position: relative;
        overflow: hidden;
        height: dt('progressbar.height');
        background: dt('progressbar.background');
        border-radius: dt('progressbar.border.radius');
    }

    .p-progressbar-value {
        margin: 0;
        background: dt('progressbar.value.background');
    }

    .p-progressbar-label {
        color: dt('progressbar.label.color');
        font-size: dt('progressbar.label.font.size');
        font-weight: dt('progressbar.label.font.weight');
    }

    .p-progressbar-determinate .p-progressbar-value {
        height: 100%;
        width: 0%;
        position: absolute;
        display: none;
        display: flex;
        align-items: center;
        justify-content: center;
        overflow: hidden;
        transition: width 1s ease-in-out;
    }

    .p-progressbar-determinate .p-progressbar-label {
        display: inline-flex;
    }

    .p-progressbar-indeterminate .p-progressbar-value::before {
        content: '';
        position: absolute;
        background: inherit;
        inset-block-start: 0;
        inset-inline-start: 0;
        inset-block-end: 0;
        will-change: inset-inline-start, inset-inline-end;
        animation: p-progressbar-indeterminate-anim 2.1s cubic-bezier(0.65, 0.815, 0.735, 0.395) infinite;
    }

    .p-progressbar-indeterminate .p-progressbar-value::after {
        content: '';
        position: absolute;
        background: inherit;
        inset-block-start: 0;
        inset-inline-start: 0;
        inset-block-end: 0;
        will-change: inset-inline-start, inset-inline-end;
        animation: p-progressbar-indeterminate-anim-short 2.1s cubic-bezier(0.165, 0.84, 0.44, 1) infinite;
        animation-delay: 1.15s;
    }

    @keyframes p-progressbar-indeterminate-anim {
        0% {
            inset-inline-start: -35%;
            inset-inline-end: 100%;
        }
        60% {
            inset-inline-start: 100%;
            inset-inline-end: -90%;
        }
        100% {
            inset-inline-start: 100%;
            inset-inline-end: -90%;
        }
    }
    @-webkit-keyframes p-progressbar-indeterminate-anim {
        0% {
            inset-inline-start: -35%;
            inset-inline-end: 100%;
        }
        60% {
            inset-inline-start: 100%;
            inset-inline-end: -90%;
        }
        100% {
            inset-inline-start: 100%;
            inset-inline-end: -90%;
        }
    }

    @keyframes p-progressbar-indeterminate-anim-short {
        0% {
            inset-inline-start: -200%;
            inset-inline-end: 100%;
        }
        60% {
            inset-inline-start: 107%;
            inset-inline-end: -8%;
        }
        100% {
            inset-inline-start: 107%;
            inset-inline-end: -8%;
        }
    }
    @-webkit-keyframes p-progressbar-indeterminate-anim-short {
        0% {
            inset-inline-start: -200%;
            inset-inline-end: 100%;
        }
        60% {
            inset-inline-start: 107%;
            inset-inline-end: -8%;
        }
        100% {
            inset-inline-start: 107%;
            inset-inline-end: -8%;
        }
    }
`;var g3=["content"],_3=t=>({$implicit:t});function x3(t,r){if(t&1&&(d(0,"div"),v(1),u()),t&2){let e=h(2);Vi("display",e.value!=null&&e.value!==0?"flex":"none"),p(),zi("",e.value,"",e.unit)}}function v3(t,r){t&1&&Tt(0)}function b3(t,r){if(t&1&&(d(0,"div",2)(1,"div",2),P(2,x3,2,4,"div",3)(3,v3,1,0,"ng-container",4),u()()),t&2){let e=h();_e(e.cn(e.cx("value"),e.valueStyleClass)),Vi("width",e.value+"%")("display","flex")("background",e.color),g("pBind",e.ptm("value")),p(),_e(e.cx("label")),g("pBind",e.ptm("label")),p(),g("ngIf",e.showValue&&!e.contentTemplate&&!e._contentTemplate),p(),g("ngTemplateOutlet",e.contentTemplate||e._contentTemplate)("ngTemplateOutletContext",vt(15,_3,e.value))}}function y3(t,r){if(t&1&&Y(0,"div",2),t&2){let e=h();_e(e.cn(e.cx("value"),e.valueStyleClass)),Vi("background",e.color),g("pBind",e.ptm("value"))}}var C3={root:({instance:t})=>["p-progressbar p-component",{"p-progressbar-determinate":t.mode=="determinate","p-progressbar-indeterminate":t.mode=="indeterminate"}],value:"p-progressbar-value",label:"p-progressbar-label"},Nf=(()=>{class t extends ir{name="progressbar";style=Lf;classes=C3;static \u0275fac=(()=>{let e;return function(i){return(e||(e=ht(t)))(i||t)}})();static \u0275prov=Ye({token:t,factory:t.\u0275fac})}return t})();var Vf=new wt("PROGRESSBAR_INSTANCE"),zf=(()=>{class t extends Zt{$pcProgressBar=we(Vf,{optional:!0,skipSelf:!0})??void 0;bindDirectiveInstance=we(Ge,{self:!0});value;showValue=!0;styleClass;valueStyleClass;unit="%";mode="determinate";color;contentTemplate;onAfterViewChecked(){this.bindDirectiveInstance.setAttrs(this.ptms(["host","root"]))}_componentStyle=we(Nf);templates;_contentTemplate;onAfterContentInit(){this.templates?.forEach(e=>{switch(e.getType()){case"content":this._contentTemplate=e.template;break;default:this._contentTemplate=e.template}})}static \u0275fac=(()=>{let e;return function(i){return(e||(e=ht(t)))(i||t)}})();static \u0275cmp=He({type:t,selectors:[["p-progressBar"],["p-progressbar"],["p-progress-bar"]],contentQueries:function(n,i,o){if(n&1&&(Ke(o,g3,4),Ke(o,pi,4)),n&2){let a;Te(a=Ee())&&(i.contentTemplate=a.first),Te(a=Ee())&&(i.templates=a)}},hostVars:6,hostBindings:function(n,i){n&2&&(Ue("aria-valuemin",0)("aria-valuenow",i.value)("aria-valuemax",100)("aria-level",i.value+i.unit),_e(i.cn(i.cx("root"),i.styleClass)))},inputs:{value:[2,"value","value",Or],showValue:[2,"showValue","showValue",$e],styleClass:"styleClass",valueStyleClass:"valueStyleClass",unit:"unit",mode:"mode",color:"color"},features:[Dt([Nf,{provide:Vf,useExisting:t},{provide:Jt,useExisting:t}]),Xt([Ge]),lt],decls:2,vars:2,consts:[[3,"class","pBind","width","display","background",4,"ngIf"],[3,"class","pBind","background",4,"ngIf"],[3,"pBind"],[3,"display",4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(n,i){n&1&&P(0,b3,4,17,"div",0)(1,y3,1,5,"div",1),n&2&&(g("ngIf",i.mode==="determinate"),p(),g("ngIf",i.mode==="indeterminate"))},dependencies:[et,bt,Rr,It,Ge],encapsulation:2,changeDetection:0})}return t})();var Uf=`
    .p-fileupload input[type='file'] {
        display: none;
    }

    .p-fileupload-advanced {
        border: 1px solid dt('fileupload.border.color');
        border-radius: dt('fileupload.border.radius');
        background: dt('fileupload.background');
        color: dt('fileupload.color');
    }

    .p-fileupload-header {
        display: flex;
        align-items: center;
        padding: dt('fileupload.header.padding');
        background: dt('fileupload.header.background');
        color: dt('fileupload.header.color');
        border-style: solid;
        border-width: dt('fileupload.header.border.width');
        border-color: dt('fileupload.header.border.color');
        border-radius: dt('fileupload.header.border.radius');
        gap: dt('fileupload.header.gap');
    }

    .p-fileupload-content {
        border: 1px solid transparent;
        display: flex;
        flex-direction: column;
        gap: dt('fileupload.content.gap');
        transition: border-color dt('fileupload.transition.duration');
        padding: dt('fileupload.content.padding');
    }

    .p-fileupload-content .p-progressbar {
        width: 100%;
        height: dt('fileupload.progressbar.height');
    }

    .p-fileupload-file-list {
        display: flex;
        flex-direction: column;
        gap: dt('fileupload.filelist.gap');
    }

    .p-fileupload-file {
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        padding: dt('fileupload.file.padding');
        border-block-end: 1px solid dt('fileupload.file.border.color');
        gap: dt('fileupload.file.gap');
    }

    .p-fileupload-file:last-child {
        border-block-end: 0;
    }

    .p-fileupload-file-info {
        display: flex;
        flex-direction: column;
        gap: dt('fileupload.file.info.gap');
    }

    .p-fileupload-file-thumbnail {
        flex-shrink: 0;
    }

    .p-fileupload-file-actions {
        margin-inline-start: auto;
    }

    .p-fileupload-highlight {
        border: 1px dashed dt('fileupload.content.highlight.border.color');
    }

    .p-fileupload-basic .p-message {
        margin-block-end: dt('fileupload.basic.gap');
    }

    .p-fileupload-basic-content {
        display: flex;
        flex-wrap: wrap;
        align-items: center;
        gap: dt('fileupload.basic.gap');
    }
`;var w3=["pFileContent",""],S3=(t,r,e)=>({class:t,file:r,index:e}),k3=(t,r)=>(r==null?null:r.name)+"-"+t;function T3(t,r){}function E3(t,r){t&1&&P(0,T3,0,0,"ng-template")}function I3(t,r){if(t&1&&P(0,E3,1,0,null,7),t&2){let e=h().class,n=h(),i=n.$implicit,o=n.$index,a=h();g("ngTemplateOutlet",a.fileRemoveIconTemplate())("ngTemplateOutletContext",fo(2,S3,e,i,o))}}function F3(t,r){if(t&1&&($t(),Y(0,"svg",8)),t&2){let e=h().class;_e(e),Ue("aria-hidden",!0)}}function A3(t,r){if(t&1&&ft(0,I3,1,6)(1,F3,1,3,":svg:svg",6),t&2){let e=h(2);mt(e.fileRemoveIconTemplate()?0:1)}}function P3(t,r){if(t&1){let e=pe();d(0,"div",2),Y(1,"img",3),d(2,"div",2)(3,"div",2),v(4),u(),d(5,"span",2),v(6),u()(),Y(7,"p-badge",4),d(8,"div",2)(9,"p-button",5),ee("onClick",function(i){let o=O(e).$index,a=h();return B(a.onRemoveClick(i,o))}),P(10,A3,2,1,"ng-template",null,0,Z),u()()()}if(t&2){let e=r.$implicit,n=h();_e(n.cx("file")),g("pBind",n.$pcFileUpload.ptm("file")),p(),_e(n.cx("fileThumbnail")),g("src",e.objectURL,Gt)("width",n.previewWidth())("pBind",n.$pcFileUpload.ptm("fileThumbnail")),Ue("alt",e.name),p(),_e(n.cx("fileInfo")),g("pBind",n.$pcFileUpload.ptm("fileInfo")),p(),_e(n.cx("fileName")),g("pBind",n.$pcFileUpload.ptm("fileName")),p(),he(e.name),p(),_e(n.cx("fileSize")),g("pBind",n.$pcFileUpload.ptm("fileSize")),p(),he(n.formatSize(e.size)),p(),_e(n.cx("pcFileBadge")),g("value",n.badgeValue())("severity",n.badgeSeverity())("pt",n.$pcFileUpload.ptm("pcFileBadge")),p(),_e(n.cx("fileActions")),g("pBind",n.$pcFileUpload.ptm("fileActions")),p(),g("styleClass",n.cx("pcFileRemoveButton"))("pt",n.$pcFileUpload.ptm("pcFileRemoveButton"))}}var D3=["file"],O3=["header"],Wf=["content"],B3=["toolbar"],M3=["chooseicon"],R3=["filelabel"],L3=["uploadicon"],N3=["cancelicon"],V3=["empty"],z3=["advancedfileinput"],U3=["basicfileinput"],W3=(t,r,e,n,i)=>({$implicit:t,uploadedFiles:r,chooseCallback:e,clearCallback:n,uploadCallback:i}),j3=(t,r,e,n,i,o,a,l)=>({$implicit:t,uploadedFiles:r,chooseCallback:e,clearCallback:n,removeUploadedFileCallback:i,removeFileCallback:o,progress:a,messages:l}),H3=t=>({$implicit:t});function $3(t,r){if(t&1&&Y(0,"span",8),t&2){let e,n=h(4);_e(n.chooseIcon),g("pBind",(e=n.ptm("pcChooseButton"))==null?null:e.icon),Ue("aria-label",!0)}}function G3(t,r){if(t&1&&($t(),Y(0,"svg",17)),t&2){let e,n=h(5);g("pBind",(e=n.ptm("pcChooseButton"))==null?null:e.icon),Ue("aria-label",!0)}}function K3(t,r){}function X3(t,r){t&1&&P(0,K3,0,0,"ng-template")}function J3(t,r){if(t&1&&(d(0,"span",8),P(1,X3,1,0,null,11),u()),t&2){let e,n=h(5);g("pBind",(e=n.ptm("pcChooseButton"))==null?null:e.icon),Ue("aria-label",!0),p(),g("ngTemplateOutlet",n.chooseIconTemplate||n._chooseIconTemplate)}}function q3(t,r){if(t&1&&(Le(0),P(1,G3,1,2,"svg",15)(2,J3,2,3,"span",16),Ne()),t&2){let e=h(4);p(),g("ngIf",!e.chooseIconTemplate&&!e._chooseIconTemplate),p(),g("ngIf",e.chooseIconTemplate||e._chooseIconTemplate)}}function Q3(t,r){if(t&1&&P(0,$3,1,4,"span",5)(1,q3,3,2,"ng-container",9),t&2){let e=h(3);g("ngIf",e.chooseIcon),p(),g("ngIf",!e.chooseIcon)}}function Y3(t,r){if(t&1&&Y(0,"span",20),t&2){let e,n=h(5);g("ngClass",n.uploadIcon)("pBind",(e=n.ptm("pcUploadButton"))==null?null:e.icon),Ue("aria-hidden",!0)}}function Z3(t,r){if(t&1&&($t(),Y(0,"svg",22)),t&2){let e,n=h(6);g("pBind",(e=n.ptm("pcUploadButton"))==null?null:e.icon)}}function ew(t,r){}function tw(t,r){t&1&&P(0,ew,0,0,"ng-template")}function rw(t,r){if(t&1&&(d(0,"span",8),P(1,tw,1,0,null,11),u()),t&2){let e,n=h(6);g("pBind",(e=n.ptm("pcUploadButton"))==null?null:e.icon),Ue("aria-hidden",!0),p(),g("ngTemplateOutlet",n.uploadIconTemplate||n._uploadIconTemplate)}}function iw(t,r){if(t&1&&(Le(0),P(1,Z3,1,1,"svg",21)(2,rw,2,3,"span",16),Ne()),t&2){let e=h(5);p(),g("ngIf",!e.uploadIconTemplate&&!e._uploadIconTemplate),p(),g("ngIf",e.uploadIconTemplate||e._uploadIconTemplate)}}function nw(t,r){if(t&1&&P(0,Y3,1,3,"span",19)(1,iw,3,2,"ng-container",9),t&2){let e=h(4);g("ngIf",e.uploadIcon),p(),g("ngIf",!e.uploadIcon)}}function ow(t,r){if(t&1){let e=pe();d(0,"p-button",18),ee("onClick",function(){O(e);let i=h(3);return B(i.upload())}),P(1,nw,2,2,"ng-template",null,2,Z),u()}if(t&2){let e=h(3);g("label",e.uploadButtonLabel)("disabled",!e.hasFiles()||e.isFileLimitExceeded())("styleClass",e.cn(e.cx("pcUploadButton"),e.uploadStyleClass))("buttonProps",e.uploadButtonProps)("pt",e.ptm("pcUploadButton"))}}function aw(t,r){if(t&1&&Y(0,"span",24),t&2){let e=h(5);g("ngClass",e.cancelIcon)}}function sw(t,r){t&1&&($t(),Y(0,"svg",26)),t&2&&Ue("aria-hidden",!0)}function lw(t,r){}function cw(t,r){t&1&&P(0,lw,0,0,"ng-template")}function uw(t,r){if(t&1&&(d(0,"span"),P(1,cw,1,0,null,11),u()),t&2){let e=h(6);Ue("aria-hidden",!0),p(),g("ngTemplateOutlet",e.cancelIconTemplate||e._cancelIconTemplate)}}function dw(t,r){if(t&1&&(Le(0),P(1,sw,1,1,"svg",25)(2,uw,2,2,"span",9),Ne()),t&2){let e=h(5);p(),g("ngIf",!e.cancelIconTemplate&&!e._cancelIconTemplate),p(),g("ngIf",e.cancelIconTemplate||e._cancelIconTemplate)}}function pw(t,r){if(t&1&&P(0,aw,1,1,"span",23)(1,dw,3,2,"ng-container",9),t&2){let e=h(4);g("ngIf",e.cancelIcon),p(),g("ngIf",!e.cancelIcon)}}function fw(t,r){if(t&1){let e=pe();d(0,"p-button",18),ee("onClick",function(){O(e);let i=h(3);return B(i.clear())}),P(1,pw,2,2,"ng-template",null,2,Z),u()}if(t&2){let e=h(3);g("label",e.cancelButtonLabel)("disabled",!e.hasFiles()||e.uploading)("styleClass",e.cn(e.cx("pcCancelButton"),e.cancelStyleClass))("buttonProps",e.cancelButtonProps)("pt",e.ptm("pcCancelButton"))}}function mw(t,r){if(t&1){let e=pe();Le(0),d(1,"p-button",13),ee("focus",function(){O(e);let i=h(2);return B(i.onFocus())})("blur",function(){O(e);let i=h(2);return B(i.onBlur())})("onClick",function(){O(e);let i=h(2);return B(i.choose())})("keydown.enter",function(){O(e);let i=h(2);return B(i.choose())}),d(2,"input",7,0),ee("change",function(i){O(e);let o=h(2);return B(o.onFileSelect(i))}),u(),P(4,Q3,2,2,"ng-template",null,2,Z),u(),P(6,ow,3,5,"p-button",14)(7,fw,3,5,"p-button",14),Ne()}if(t&2){let e=h(2);p(),g("styleClass",e.cn(e.cx("pcChooseButton"),e.chooseStyleClass))("disabled",e.disabled||e.isChooseDisabled())("label",e.chooseButtonLabel)("buttonProps",e.chooseButtonProps)("pt",e.ptm("pcChooseButton")),p(),g("multiple",e.multiple)("accept",e.accept)("disabled",e.disabled||e.isChooseDisabled())("pBind",e.ptm("input")),Ue("aria-label",e.browseFilesLabel)("title",""),p(4),g("ngIf",!e.auto&&e.showUploadButton),p(),g("ngIf",!e.auto&&e.showCancelButton)}}function hw(t,r){t&1&&Tt(0)}function gw(t,r){t&1&&Tt(0)}function _w(t,r){t&1&&Tt(0)}function xw(t,r){if(t&1&&P(0,_w,1,0,"ng-container",10),t&2){let e=h(2);g("ngTemplateOutlet",e.contentTemplate||e._contentTemplate)("ngTemplateOutletContext",Fu(2,j3,e.files,e.uploadedFiles,e.choose.bind(e),e.clear.bind(e),e.removeUploadedFile.bind(e),e.remove.bind(e),e.progress,e.msgs))}}function vw(t,r){if(t&1&&Y(0,"p-progressbar",30),t&2){let e=h(3);g("value",e.progress)("showValue",!1)("pt",e.ptm("pcProgressBar"))}}function bw(t,r){if(t&1&&Y(0,"p-message",28),t&2){let e=r.$implicit,n=h(3);g("severity",e.severity)("text",e.text)("pt",n.ptm("pcMessage"))}}function yw(t,r){}function Cw(t,r){if(t&1){let e=pe();d(0,"div",33),ee("onRemove",function(i){O(e);let o=h(4);return B(o.onRemoveClick(i))}),u()}if(t&2){let e=h(4);g("files",e.files)("badgeValue",e.pendingLabel)("previewWidth",e.previewWidth)("fileRemoveIconTemplate",e.cancelIconTemplate||e._cancelIconTemplate)}}function ww(t,r){if(t&1&&(d(0,"div",8),P(1,yw,0,0,"ng-template",31),ft(2,Cw,1,4,"div",32),u()),t&2){let e=h(3);_e(e.cx("fileList")),g("pBind",e.ptm("fileList")),p(),g("ngForOf",e.files)("ngForTemplate",e.fileTemplate||e._fileTemplate),p(),mt(!e.fileTemplate&&!e._fileTemplate?2:-1)}}function Sw(t,r){}function kw(t,r){if(t&1){let e=pe();d(0,"div",35),ee("onRemove",function(i){O(e);let o=h(4);return B(o.onRemoveUploadedFileClick(i))}),u()}if(t&2){let e=h(4);g("files",e.uploadedFiles)("badgeValue",e.completedLabel())("previewWidth",e.previewWidth)("fileRemoveIconTemplate",e.cancelIconTemplate||e._cancelIconTemplate)}}function Tw(t,r){if(t&1&&(d(0,"div",8),P(1,Sw,0,0,"ng-template",31),ft(2,kw,1,4,"div",34),u()),t&2){let e=h(3);_e(e.cx("fileList")),g("pBind",e.ptm("fileList")),p(),g("ngForOf",e.uploadedFiles)("ngForTemplate",e.fileTemplate||e._fileTemplate),p(),mt(!e.fileTemplate&&!e._fileTemplate?2:-1)}}function Ew(t,r){if(t&1&&(P(0,vw,1,3,"p-progressbar",27),js(1,bw,1,3,"p-message",28,Dc),ft(3,ww,3,6,"div",29),ft(4,Tw,3,6,"div",29)),t&2){let e=h(2);g("ngIf",e.hasFiles()),p(),Hs(e.msgs),p(2),mt(e.hasFiles()?3:-1),p(),mt(e.hasUploadedFiles()?4:-1)}}function Iw(t,r){if(t&1&&Tt(0,8),t&2){let e=h(3);g("pBind",e.ptm("empty"))}}function Fw(t,r){if(t&1&&P(0,Iw,1,1,"ng-container",36),t&2){let e=h(2);g("ngTemplateOutlet",e.emptyTemplate||e._emptyTemplate)}}function Aw(t,r){if(t&1){let e=pe();d(0,"div",6)(1,"input",7,0),ee("change",function(i){O(e);let o=h();return B(o.onFileSelect(i))}),u(),d(3,"div",8),P(4,mw,8,13,"ng-container",9)(5,hw,1,0,"ng-container",10)(6,gw,1,0,"ng-container",11),u(),d(7,"div",12,1),ee("dragenter",function(i){O(e);let o=h();return B(o.onDragEnter(i))})("dragleave",function(i){O(e);let o=h();return B(o.onDragLeave(i))})("drop",function(i){O(e);let o=h();return B(o.onDrop(i))}),ft(9,xw,1,11,"ng-container")(10,Ew,5,3),ft(11,Fw,1,1,"ng-container",8),u()()}if(t&2){let e=h();_e(e.cn(e.cx("root"),e.styleClass)),g("ngStyle",e.style)("pBind",e.ptm("root")),p(),Vi("display","none"),g("multiple",e.multiple)("accept",e.accept)("disabled",e.disabled||e.isChooseDisabled())("pBind",e.ptm("input")),Ue("aria-label",e.browseFilesLabel)("title",""),p(2),_e(e.cx("header")),g("pBind",e.ptm("header")),p(),g("ngIf",!e.headerTemplate&&!e._headerTemplate),p(),g("ngTemplateOutlet",e.headerTemplate||e._headerTemplate)("ngTemplateOutletContext",Iu(24,W3,e.files,e.uploadedFiles,e.choose.bind(e),e.clear.bind(e),e.upload.bind(e))),p(),g("ngTemplateOutlet",e.toolbarTemplate||e._toolbarTemplate),p(),_e(e.cx("content")),g("pBind",e.ptm("content")),p(2),mt(e.contentTemplate||e._contentTemplate?9:10),p(2),mt((e.emptyTemplate||e._emptyTemplate)&&!e.hasFiles()&&!e.hasUploadedFiles()?11:-1)}}function Pw(t,r){if(t&1&&Y(0,"p-message",28),t&2){let e=r.$implicit,n=h(2);g("severity",e.severity)("text",e.text)("pt",n.ptm("pcMessage"))}}function Dw(t,r){if(t&1&&Y(0,"span",40),t&2){let e,n=h(4);g("ngClass",n.uploadIcon)("pBind",(e=n.ptm("pcChooseButton"))==null?null:e.icon)}}function Ow(t,r){if(t&1&&($t(),Y(0,"svg",22)),t&2){let e,n=h(5);_e("p-button-icon p-button-icon-left"),g("pBind",(e=n.ptm("pcChooseButton"))==null?null:e.icon)}}function Bw(t,r){}function Mw(t,r){t&1&&P(0,Bw,0,0,"ng-template")}function Rw(t,r){if(t&1&&(d(0,"span",43),P(1,Mw,1,0,null,11),u()),t&2){let e,n=h(5);g("pBind",(e=n.ptm("pcChooseButton"))==null?null:e.icon),p(),g("ngTemplateOutlet",n._uploadIconTemplate||n.uploadIconTemplate)}}function Lw(t,r){if(t&1&&(Le(0),P(1,Ow,1,3,"svg",41)(2,Rw,2,2,"span",42),Ne()),t&2){let e=h(4);p(),g("ngIf",!e.uploadIconTemplate&&!e._uploadIconTemplate),p(),g("ngIf",e._uploadIconTemplate||e.uploadIconTemplate)}}function Nw(t,r){if(t&1&&P(0,Dw,1,2,"span",39)(1,Lw,3,2,"ng-container",9),t&2){let e=h(3);g("ngIf",e.uploadIcon),p(),g("ngIf",!e.uploadIcon)}}function Vw(t,r){if(t&1&&Y(0,"span",45),t&2){let e,n=h(4);g("ngClass",n.chooseIcon)("pBind",(e=n.ptm("pcChooseButton"))==null?null:e.icon)}}function zw(t,r){if(t&1&&($t(),Y(0,"svg",17)),t&2){let e,n=h(5);g("pBind",(e=n.ptm("pcChooseButton"))==null?null:e.icon)}}function Uw(t,r){}function Ww(t,r){t&1&&P(0,Uw,0,0,"ng-template")}function jw(t,r){if(t&1&&(Le(0),P(1,zw,1,1,"svg",15)(2,Ww,1,0,null,11),Ne()),t&2){let e=h(4);p(),g("ngIf",!e.chooseIconTemplate&&!e._chooseIconTemplate),p(),g("ngTemplateOutlet",e.chooseIconTemplate||e._chooseIconTemplate)}}function Hw(t,r){if(t&1&&P(0,Vw,1,2,"span",44)(1,jw,3,2,"ng-container",9),t&2){let e=h(3);g("ngIf",e.chooseIcon),p(),g("ngIf",!e.chooseIcon)}}function $w(t,r){if(t&1&&ft(0,Nw,2,2)(1,Hw,2,2),t&2){let e=h(2);mt(e.hasFiles()&&!e.auto?0:1)}}function Gw(t,r){if(t&1&&(d(0,"span"),v(1),u()),t&2){let e=h(3);p(),Ie(" ",e.basicFileChosenLabel()," ")}}function Kw(t,r){t&1&&Tt(0)}function Xw(t,r){if(t&1&&P(0,Kw,1,0,"ng-container",10),t&2){let e=h(3);g("ngTemplateOutlet",e.fileLabelTemplate||e._fileLabelTemplate)("ngTemplateOutletContext",vt(2,H3,e.files))}}function Jw(t,r){if(t&1&&ft(0,Gw,2,1,"span")(1,Xw,1,4,"ng-container"),t&2){let e=h(2);mt(!e.fileLabelTemplate&&!e._fileLabelTemplate?0:1)}}function qw(t,r){if(t&1){let e=pe();d(0,"div",8),js(1,Pw,1,3,"p-message",28,Dc),d(3,"div",8)(4,"p-button",37),ee("onClick",function(){O(e);let i=h();return B(i.onBasicUploaderClick())})("keydown",function(i){O(e);let o=h();return B(o.onBasicKeydown(i))}),P(5,$w,2,1,"ng-template",null,2,Z),d(7,"input",38,3),ee("change",function(i){O(e);let o=h();return B(o.onFileSelect(i))})("focus",function(){O(e);let i=h();return B(i.onFocus())})("blur",function(){O(e);let i=h();return B(i.onBlur())}),u()(),ft(9,Jw,2,1),u()()}if(t&2){let e=h();_e(e.cn(e.cx("root"),e.styleClass)),g("pBind",e.ptm("root")),p(),Hs(e.msgs),p(2),_e(e.cx("basicContent")),g("pBind",e.ptm("basicContent")),p(),Qt(e.style),g("styleClass",e.cn(e.cx("pcChooseButton"),e.chooseStyleClass))("disabled",e.disabled)("label",e.chooseButtonLabel)("buttonProps",e.chooseButtonProps)("pt",e.ptm("pcChooseButton")),p(3),g("accept",e.accept)("multiple",e.multiple)("disabled",e.disabled)("pBind",e.ptm("input")),Ue("aria-label",e.browseFilesLabel),p(2),mt(e.auto?-1:9)}}var Qw={root:({instance:t})=>`p-fileupload p-fileupload-${t.mode} p-component`,header:"p-fileupload-header",pcChooseButton:"p-fileupload-choose-button",pcUploadButton:"p-fileupload-upload-button",pcCancelButton:"p-fileupload-cancel-button",content:"p-fileupload-content",fileList:"p-fileupload-file-list",file:"p-fileupload-file",fileThumbnail:"p-fileupload-file-thumbnail",fileInfo:"p-fileupload-file-info",fileName:"p-fileupload-file-name",fileSize:"p-fileupload-file-size",pcFileBadge:"p-fileupload-file-badge",fileActions:"p-fileupload-file-actions",pcFileRemoveButton:"p-fileupload-file-remove-button",basicContent:"p-fileupload-basic-content"},vl=(()=>{class t extends ir{name="fileupload";style=Uf;classes=Qw;static \u0275fac=(()=>{let e;return function(i){return(e||(e=ht(t)))(i||t)}})();static \u0275prov=Ye({token:t,factory:t.\u0275fac})}return t})();var jf=new wt("FILEUPLOAD_INSTANCE"),Yw=(()=>{class t extends Zt{_componentStyle=we(vl);$pcFileUpload=we(jf);onRemove=Au();files=kr();badgeSeverity=kr("warn");badgeValue=kr();previewWidth=kr(50);fileRemoveIconTemplate=kr();onRemoveClick(e,n){this.onRemove.emit({event:e,index:n})}formatSize(e){let o=this.config.getTranslation(qr.FILE_SIZE_TYPES);if(e===0)return`0 ${o[0]}`;let a=Math.floor(Math.log(e)/Math.log(1024));return`${(e/Math.pow(1024,a)).toFixed(3)} ${o[a]}`}static \u0275fac=(()=>{let e;return function(i){return(e||(e=ht(t)))(i||t)}})();static \u0275cmp=He({type:t,selectors:[["","pFileContent",""]],inputs:{files:[1,"files"],badgeSeverity:[1,"badgeSeverity"],badgeValue:[1,"badgeValue"],previewWidth:[1,"previewWidth"],fileRemoveIconTemplate:[1,"fileRemoveIconTemplate"]},outputs:{onRemove:"onRemove"},features:[Dt([vl]),lt],attrs:w3,decls:2,vars:0,consts:[["icon",""],[3,"class","pBind"],[3,"pBind"],["role","presentation",3,"src","width","pBind"],[3,"value","severity","pt"],["text","","rounded","","severity","danger",3,"onClick","styleClass","pt"],["data-p-icon","times",3,"class"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["data-p-icon","times"]],template:function(n,i){n&1&&js(0,P3,12,30,"div",1,k3),n&2&&Hs(i.files())},dependencies:[et,Rr,xd,Ht,ho,Ge],encapsulation:2,changeDetection:0})}return t})(),_s=(()=>{class t extends Zt{bindDirectiveInstance=we(Ge,{self:!0});onAfterViewChecked(){this.bindDirectiveInstance.setAttrs(this.ptm("host"))}name;url;method="post";multiple;accept;disabled;auto;withCredentials;maxFileSize;invalidFileSizeMessageSummary="{0}: Invalid file size, ";invalidFileSizeMessageDetail="maximum upload size is {0}.";invalidFileTypeMessageSummary="{0}: Invalid file type, ";invalidFileTypeMessageDetail="allowed file types: {0}.";invalidFileLimitMessageDetail="limit is {0} at most.";invalidFileLimitMessageSummary="Maximum number of files exceeded, ";style;styleClass;previewWidth=50;chooseLabel;uploadLabel;cancelLabel;chooseIcon;uploadIcon;cancelIcon;showUploadButton=!0;showCancelButton=!0;mode="advanced";headers;customUpload;fileLimit;uploadStyleClass;cancelStyleClass;removeStyleClass;chooseStyleClass;chooseButtonProps;uploadButtonProps={severity:"secondary"};cancelButtonProps={severity:"secondary"};onBeforeUpload=new xt;onSend=new xt;onUpload=new xt;onError=new xt;onClear=new xt;onRemove=new xt;onSelect=new xt;onProgress=new xt;uploadHandler=new xt;onImageError=new xt;onRemoveUploadedFile=new xt;fileTemplate;headerTemplate;contentTemplate;toolbarTemplate;chooseIconTemplate;fileLabelTemplate;uploadIconTemplate;cancelIconTemplate;emptyTemplate;advancedFileInput;basicFileInput;content;set files(e){this._files=[];for(let n=0;n<e.length;n++){let i=e[n];this.validate(i)&&(this.isImage(i)&&(i.objectURL=this.sanitizer.bypassSecurityTrustUrl(window.URL.createObjectURL(e[n]))),this._files.push(e[n]))}}get files(){return this._files}get basicButtonLabel(){return this.auto||!this.hasFiles()?this.chooseLabel:this.uploadLabel??this.files[0].name}_files=[];progress=0;dragHighlight;msgs;uploadedFileCount=0;focus;uploading;duplicateIEEvent;translationSubscription;dragOverListener;uploadedFiles=[];sanitizer=we(Xs);zone=we(Pn);http=we(Tr);_componentStyle=we(vl);onInit(){this.translationSubscription=this.config.translationObserver.subscribe(()=>{this.cd.markForCheck()})}onAfterViewInit(){Wn(this.platformId)&&this.mode==="advanced"&&this.zone.runOutsideAngular(()=>{this.content&&(this.dragOverListener=this.renderer.listen(this.content.nativeElement,"dragover",this.onDragOver.bind(this)))})}_headerTemplate;_contentTemplate;_toolbarTemplate;_chooseIconTemplate;_uploadIconTemplate;_cancelIconTemplate;_emptyTemplate;_fileTemplate;_fileLabelTemplate;templates;onAfterContentInit(){this.templates?.forEach(e=>{switch(e.getType()){case"header":this._headerTemplate=e.template;break;case"file":this._fileTemplate=e.template;break;case"content":this._contentTemplate=e.template;break;case"toolbar":this._toolbarTemplate=e.template;break;case"chooseicon":this._chooseIconTemplate=e.template;break;case"uploadicon":this._uploadIconTemplate=e.template;break;case"cancelicon":this._cancelIconTemplate=e.template;break;case"empty":this._emptyTemplate=e.template;break;case"filelabel":this._fileLabelTemplate=e.template;break;default:this._fileTemplate=e.template;break}})}basicFileChosenLabel(){return this.auto?this.chooseButtonLabel:this.hasFiles()?this.files&&this.files.length===1?this.files[0].name:this.config.getTranslation("fileChosenMessage")?.replace("{0}",this.files.length):this.config.getTranslation("noFileChosenMessage")||""}completedLabel(){return this.config.getTranslation("completed")||""}getTranslation(e){return this.config.getTranslation(e)}choose(){this.advancedFileInput?.nativeElement.click()}onFileSelect(e){if(e.type!=="drop"&&this.isIE11()&&this.duplicateIEEvent){this.duplicateIEEvent=!1;return}this.multiple||(this.files=[]),this.msgs=[],this.files=this.files||[];let n=e.dataTransfer?e.dataTransfer.files:e.target.files;for(let i=0;i<n.length;i++){let o=n[i];this.isFileSelected(o)||this.validate(o)&&(this.isImage(o)&&(o.objectURL=this.sanitizer.bypassSecurityTrustUrl(window.URL.createObjectURL(n[i]))),this.files.push(n[i]))}this.onSelect.emit({originalEvent:e,files:n,currentFiles:this.files}),this.checkFileLimit(n),this.hasFiles()&&this.auto&&(this.mode!=="advanced"||!this.isFileLimitExceeded())&&this.upload(),e.type!=="drop"&&this.isIE11()?this.clearIEInput():this.clearInputElement()}isFileSelected(e){for(let n of this.files)if(n.name+n.type+n.size===e.name+e.type+e.size)return!0;return!1}isIE11(){if(Wn(this.platformId))return!!this.document.defaultView.MSInputMethodContext&&!!this.document.documentMode}validate(e){if(this.msgs=this.msgs||[],this.accept&&!this.isFileTypeValid(e)){let n=`${this.invalidFileTypeMessageSummary.replace("{0}",e.name)} ${this.invalidFileTypeMessageDetail.replace("{0}",this.accept)}`;return this.msgs.push({severity:"error",text:n}),!1}if(this.maxFileSize&&e.size>this.maxFileSize){let n=`${this.invalidFileSizeMessageSummary.replace("{0}",e.name)} ${this.invalidFileSizeMessageDetail.replace("{0}",this.formatSize(this.maxFileSize))}`;return this.msgs.push({severity:"error",text:n}),!1}return!0}isFileTypeValid(e){let n=this.accept?.split(",").map(i=>i.trim());for(let i of n)if(this.isWildcard(i)?this.getTypeClass(e.type)===this.getTypeClass(i):e.type==i||this.getFileExtension(e).toLowerCase()===i.toLowerCase())return!0;return!1}getTypeClass(e){return e.substring(0,e.indexOf("/"))}isWildcard(e){return e.indexOf("*")!==-1}getFileExtension(e){return"."+e.name.split(".").pop()}isImage(e){return/^image\//.test(e.type)}onImageLoad(e){window.URL.revokeObjectURL(e.src)}uploader(){if(this.customUpload)this.fileLimit&&(this.uploadedFileCount+=this.files.length),this.uploadHandler.emit({files:this.files}),this.cd.markForCheck();else{this.uploading=!0,this.msgs=[];let e=new FormData;this.onBeforeUpload.emit({formData:e});for(let n=0;n<this.files.length;n++)e.append(this.name,this.files[n],this.files[n].name);this.http.request(this.method,this.url,{body:e,headers:this.headers,reportProgress:!0,observe:"events",withCredentials:this.withCredentials}).subscribe(n=>{switch(n.type){case Gs.Sent:this.onSend.emit({originalEvent:n,formData:e});break;case Gs.Response:this.uploading=!1,this.progress=0,n.status>=200&&n.status<300?(this.fileLimit&&(this.uploadedFileCount+=this.files.length),this.onUpload.emit({originalEvent:n,files:this.files})):this.onError.emit({files:this.files}),this.uploadedFiles=[...this.uploadedFiles,...this.files],this.clear();break;case Gs.UploadProgress:{n.loaded&&(this.progress=Math.round(n.loaded*100/n.total)),this.onProgress.emit({originalEvent:n,progress:this.progress});break}}this.cd.markForCheck()},n=>{this.uploading=!1,this.onError.emit({files:this.files,error:n})})}}onRemoveClick(e){let{event:n,index:i}=e;this.hasFiles()&&this.remove(n,i)}onRemoveUploadedFileClick(e){let{index:n}=e;this.hasUploadedFiles()&&this.removeUploadedFile(n)}clear(){this.files=[],this.onClear.emit(),this.clearInputElement(),this.msgs=[],this.cd.markForCheck()}remove(e,n){this.clearInputElement(),this.onRemove.emit({originalEvent:e,file:this.files[n]}),this.files.splice(n,1),this.checkFileLimit(this.files)}removeUploadedFile(e){let n=this.uploadedFiles.splice(e,1)[0];this.uploadedFiles=[...this.uploadedFiles],this.onRemoveUploadedFile.emit({file:n,files:this.uploadedFiles})}isFileLimitExceeded(){let n=this.auto?this.files.length:this.files.length+this.uploadedFileCount;return this.fileLimit&&this.fileLimit<=n&&this.focus&&(this.focus=!1),this.fileLimit&&this.fileLimit<n}isChooseDisabled(){return this.auto?this.fileLimit&&this.fileLimit<=this.files.length:this.fileLimit&&this.fileLimit<=this.files.length+this.uploadedFileCount}checkFileLimit(e){this.msgs??=[];let n=this.msgs.length>0&&this.fileLimit&&this.fileLimit<e.length;if(this.isFileLimitExceeded()||n){let i=`${this.invalidFileLimitMessageSummary.replace("{0}",this.fileLimit.toString())} ${this.invalidFileLimitMessageDetail.replace("{0}",this.fileLimit.toString())}`;this.msgs.push({severity:"error",text:i})}else this.msgs=this.msgs.filter(i=>!i.text.includes(this.invalidFileLimitMessageSummary))}clearInputElement(){this.advancedFileInput&&this.advancedFileInput.nativeElement&&(this.advancedFileInput.nativeElement.value=""),this.basicFileInput&&this.basicFileInput.nativeElement&&(this.basicFileInput.nativeElement.value="")}clearIEInput(){this.advancedFileInput&&this.advancedFileInput.nativeElement&&(this.duplicateIEEvent=!0,this.advancedFileInput.nativeElement.value="")}hasFiles(){return this.files&&this.files.length>0}hasUploadedFiles(){return this.uploadedFiles&&this.uploadedFiles.length>0}onDragEnter(e){this.disabled||(e.stopPropagation(),e.preventDefault())}onDragOver(e){this.disabled||($u(this.content?.nativeElement,"p-fileupload-highlight"),this.dragHighlight=!0,e.stopPropagation(),e.preventDefault())}onDragLeave(e){this.disabled||Lc(this.content?.nativeElement,"p-fileupload-highlight")}onDrop(e){if(!this.disabled){Lc(this.content?.nativeElement,"p-fileupload-highlight"),e.stopPropagation(),e.preventDefault();let n=e.dataTransfer?e.dataTransfer.files:e.target.files;(this.multiple||n&&n.length===1)&&this.onFileSelect(e)}}onFocus(){this.focus=!0}onBlur(){this.focus=!1}formatSize(e){let o=this.getTranslation(qr.FILE_SIZE_TYPES);if(e===0)return`0 ${o[0]}`;let a=Math.floor(Math.log(e)/Math.log(1024));return`${(e/Math.pow(1024,a)).toFixed(3)} ${o[a]}`}upload(){this.hasFiles()&&this.uploader()}onBasicUploaderClick(){this.basicFileInput?.nativeElement.click()}onBasicKeydown(e){switch(e.code){case"Space":case"Enter":this.onBasicUploaderClick(),e.preventDefault();break}}imageError(e){this.onImageError.emit(e)}getBlockableElement(){return this.el.nativeElement.children[0]}get chooseButtonLabel(){return this.chooseLabel||this.config.getTranslation(qr.CHOOSE)}get uploadButtonLabel(){return this.uploadLabel||this.config.getTranslation(qr.UPLOAD)}get cancelButtonLabel(){return this.cancelLabel||this.config.getTranslation(qr.CANCEL)}get browseFilesLabel(){return this.config.getTranslation(qr.ARIA)[qr.BROWSE_FILES]}get pendingLabel(){return this.config.getTranslation(qr.PENDING)}onDestroy(){this.content&&this.content.nativeElement&&this.dragOverListener&&(this.dragOverListener(),this.dragOverListener=null),this.translationSubscription&&this.translationSubscription.unsubscribe()}static \u0275fac=(()=>{let e;return function(i){return(e||(e=ht(t)))(i||t)}})();static \u0275cmp=He({type:t,selectors:[["p-fileupload"],["p-fileUpload"]],contentQueries:function(n,i,o){if(n&1&&(Ke(o,D3,4),Ke(o,O3,4),Ke(o,Wf,4),Ke(o,B3,4),Ke(o,M3,4),Ke(o,R3,4),Ke(o,L3,4),Ke(o,N3,4),Ke(o,V3,4),Ke(o,pi,4)),n&2){let a;Te(a=Ee())&&(i.fileTemplate=a.first),Te(a=Ee())&&(i.headerTemplate=a.first),Te(a=Ee())&&(i.contentTemplate=a.first),Te(a=Ee())&&(i.toolbarTemplate=a.first),Te(a=Ee())&&(i.chooseIconTemplate=a.first),Te(a=Ee())&&(i.fileLabelTemplate=a.first),Te(a=Ee())&&(i.uploadIconTemplate=a.first),Te(a=Ee())&&(i.cancelIconTemplate=a.first),Te(a=Ee())&&(i.emptyTemplate=a.first),Te(a=Ee())&&(i.templates=a)}},viewQuery:function(n,i){if(n&1&&(Nt(z3,5),Nt(U3,5),Nt(Wf,5)),n&2){let o;Te(o=Ee())&&(i.advancedFileInput=o.first),Te(o=Ee())&&(i.basicFileInput=o.first),Te(o=Ee())&&(i.content=o.first)}},inputs:{name:"name",url:"url",method:"method",multiple:[2,"multiple","multiple",$e],accept:"accept",disabled:[2,"disabled","disabled",$e],auto:[2,"auto","auto",$e],withCredentials:[2,"withCredentials","withCredentials",$e],maxFileSize:[2,"maxFileSize","maxFileSize",Or],invalidFileSizeMessageSummary:"invalidFileSizeMessageSummary",invalidFileSizeMessageDetail:"invalidFileSizeMessageDetail",invalidFileTypeMessageSummary:"invalidFileTypeMessageSummary",invalidFileTypeMessageDetail:"invalidFileTypeMessageDetail",invalidFileLimitMessageDetail:"invalidFileLimitMessageDetail",invalidFileLimitMessageSummary:"invalidFileLimitMessageSummary",style:"style",styleClass:"styleClass",previewWidth:[2,"previewWidth","previewWidth",Or],chooseLabel:"chooseLabel",uploadLabel:"uploadLabel",cancelLabel:"cancelLabel",chooseIcon:"chooseIcon",uploadIcon:"uploadIcon",cancelIcon:"cancelIcon",showUploadButton:[2,"showUploadButton","showUploadButton",$e],showCancelButton:[2,"showCancelButton","showCancelButton",$e],mode:"mode",headers:"headers",customUpload:[2,"customUpload","customUpload",$e],fileLimit:[2,"fileLimit","fileLimit",e=>Or(e,void 0)],uploadStyleClass:"uploadStyleClass",cancelStyleClass:"cancelStyleClass",removeStyleClass:"removeStyleClass",chooseStyleClass:"chooseStyleClass",chooseButtonProps:"chooseButtonProps",uploadButtonProps:"uploadButtonProps",cancelButtonProps:"cancelButtonProps",files:"files"},outputs:{onBeforeUpload:"onBeforeUpload",onSend:"onSend",onUpload:"onUpload",onError:"onError",onClear:"onClear",onRemove:"onRemove",onSelect:"onSelect",onProgress:"onProgress",uploadHandler:"uploadHandler",onImageError:"onImageError",onRemoveUploadedFile:"onRemoveUploadedFile"},features:[Dt([vl,{provide:jf,useExisting:t},{provide:Jt,useExisting:t}]),Xt([Ge]),lt],decls:2,vars:2,consts:[["advancedfileinput",""],["content",""],["icon",""],["basicfileinput",""],[3,"class","ngStyle","pBind",4,"ngIf"],[3,"class","pBind",4,"ngIf"],[3,"ngStyle","pBind"],["type","file",3,"change","multiple","accept","disabled","pBind"],[3,"pBind"],[4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[4,"ngTemplateOutlet"],[3,"dragenter","dragleave","drop","pBind"],[3,"focus","blur","onClick","keydown.enter","styleClass","disabled","label","buttonProps","pt"],[3,"label","disabled","styleClass","buttonProps","pt","onClick",4,"ngIf"],["data-p-icon","plus",3,"pBind",4,"ngIf"],[3,"pBind",4,"ngIf"],["data-p-icon","plus",3,"pBind"],[3,"onClick","label","disabled","styleClass","buttonProps","pt"],[3,"ngClass","pBind",4,"ngIf"],[3,"ngClass","pBind"],["data-p-icon","upload",3,"pBind",4,"ngIf"],["data-p-icon","upload",3,"pBind"],[3,"ngClass",4,"ngIf"],[3,"ngClass"],["data-p-icon","times",4,"ngIf"],["data-p-icon","times"],[3,"value","showValue","pt",4,"ngIf"],[3,"severity","text","pt"],[3,"class","pBind"],[3,"value","showValue","pt"],["ngFor","",3,"ngForOf","ngForTemplate"],["pFileContent","",3,"files","badgeValue","previewWidth","fileRemoveIconTemplate"],["pFileContent","",3,"onRemove","files","badgeValue","previewWidth","fileRemoveIconTemplate"],["pFileContent","","badgeSeverity","success",3,"files","badgeValue","previewWidth","fileRemoveIconTemplate"],["pFileContent","","badgeSeverity","success",3,"onRemove","files","badgeValue","previewWidth","fileRemoveIconTemplate"],[3,"pBind",4,"ngTemplateOutlet"],[3,"onClick","keydown","styleClass","disabled","label","buttonProps","pt"],["type","file",3,"change","focus","blur","accept","multiple","disabled","pBind"],["class","p-button-icon p-button-icon-left",3,"ngClass","pBind",4,"ngIf"],[1,"p-button-icon","p-button-icon-left",3,"ngClass","pBind"],["data-p-icon","upload",3,"class","pBind",4,"ngIf"],["class","p-button-icon p-button-icon-left",3,"pBind",4,"ngIf"],[1,"p-button-icon","p-button-icon-left",3,"pBind"],["class","p-button-icon p-button-icon-left pi",3,"ngClass","pBind",4,"ngIf"],[1,"p-button-icon","p-button-icon-left","pi",3,"ngClass","pBind"]],template:function(n,i){n&1&&P(0,Aw,12,30,"div",4)(1,qw,10,19,"div",5),n&2&&(g("ngIf",i.mode==="advanced"),p(),g("ngIf",i.mode==="basic"))},dependencies:[et,Br,Mr,bt,Rr,zn,Ht,zf,Rf,pd,Ef,ho,It,Yw,Ge],encapsulation:2,changeDetection:0})}return t})(),bl=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=hr({type:t});static \u0275inj=mr({imports:[_s,It,It]})}return t})();var xs=()=>({width:"100%"}),vs=()=>({"max-height":"150px"});function Zw(t,r){}function eS(t,r){}function tS(t,r){t&1&&P(0,eS,0,0,"ng-template",null,1,Z)}function rS(t,r){}function iS(t,r){}function nS(t,r){t&1&&P(0,iS,0,0,"ng-template",null,1,Z)}function oS(t,r){if(t&1&&(d(0,"a",10),v(1,"\u0421\u043A\u0430\u0447\u0430\u0442\u044C \u0434\u0430\u0442\u0430\u0441\u0435\u0442"),u()),t&2){let e=h();g("href",e.dataset,Gt)("download",e.activeImage.name+".json")}}function aS(t,r){}function sS(t,r){if(t&1){let e=pe();d(0,"div",18)(1,"p-button",19),ee("click",function(){let i=O(e).$implicit,o=h(2);return B(o.undoField(i))}),u(),d(2,"p-fileupload",20),ee("onSelect",function(i){O(e);let o=h(2);return B(o.onImageSelected(o.activeImage,o.activeImageField.name,i))}),P(3,aS,0,0,"ng-template",null,0,Z),u(),Y(5,"img",21),d(6,"div"),v(7),u()()}if(t&2){let e=r.$implicit,n=h(2);p(),g("disabled",n.checkFieldUnchanged(n.activeImage,e)),p(),g("showUploadButton",!1)("showCancelButton",!1),p(3),g("src",n.activeImage.values[e.name],Gt),p(2),he(e.name)}}function lS(t,r){if(t&1){let e=pe();d(0,"div",18)(1,"p-button",19),ee("click",function(){let i=O(e).$implicit,o=h(2);return B(o.undoField(i))}),u(),d(2,"p-colorPicker",22),Fe("ngModelChange",function(i){let o=O(e).$implicit,a=h(2);return ke(a.activeImage.values[o.name],i)||(a.activeImage.values[o.name]=i),B(i)}),ee("onChange",function(i){let o=O(e).$implicit,a=h(2);return B(a.onColorFieldUpdated(a.activeImage,o.name,i))}),u(),d(3,"div"),v(4),u()()}if(t&2){let e=r.$implicit,n=h(2);p(),g("disabled",n.checkFieldUnchanged(n.activeImage,e)),p(),Se("ngModel",n.activeImage.values[e.name]),p(2),he(e.name)}}function cS(t,r){if(t&1){let e=pe();d(0,"div",18)(1,"p-button",19),ee("click",function(){let i=O(e).$implicit,o=h(2);return B(o.undoField(i))}),u(),d(2,"p-checkbox",23),Fe("ngModelChange",function(i){let o=O(e).$implicit,a=h(2);return ke(a.activeImage.values[o.name],i)||(a.activeImage.values[o.name]=i),B(i)}),ee("onChange",function(){O(e);let i=h(2);return B(i.onImageUpdate(i.activeImage))}),u(),d(3,"div"),v(4),u()()}if(t&2){let e=r.$implicit,n=h(2);p(),g("disabled",n.checkFieldUnchanged(n.activeImage,e)),p(),Se("ngModel",n.activeImage.values[e.name]),g("name",e.name),p(2),he(e.name)}}function uS(t,r){if(t&1&&Y(0,"img",24),t&2){let e=r.$implicit;g("src",e.png,Gt)}}function dS(t,r){if(t&1&&(d(0,"div",25),Y(1,"img",26),u()),t&2){let e=r.$implicit;p(),g("src",e.png,Gt)}}function pS(t,r){if(t&1){let e=pe();d(0,"p-button",27),ee("click",function(){let i=O(e).$implicit,o=h(2);return B(o.undoField(i))}),u(),d(1,"input",28),Fe("ngModelChange",function(i){let o=O(e).$implicit,a=h(2);return ke(a.activeImage.values[o.name],i)||(a.activeImage.values[o.name]=i),B(i)}),ee("change",function(){O(e);let i=h(2);return B(i.onImageUpdate(i.activeImage))}),u()}if(t&2){let e=r.$implicit,n=h(2);g("disabled",n.checkFieldUnchanged(n.activeImage,e)),p(),Se("ngModel",n.activeImage.values[e.name]),g("placeholder",e.name)}}function fS(t,r){if(t&1){let e=pe();d(0,"div",29)(1,"label",30),v(2),u(),d(3,"div",31)(4,"p-button",27),ee("click",function(){let i=O(e).$implicit,o=h(2);return B(o.undoField(i))}),u(),d(5,"p-inputNumber",32),Fe("ngModelChange",function(i){let o=O(e).$implicit,a=h(2);return ke(a.activeImage.values[o.name],i)||(a.activeImage.values[o.name]=i),B(i)}),ee("onInput",function(){O(e);let i=h(2);return B(i.onImageUpdate(i.activeImage))}),u()()()}if(t&2){let e=r.$implicit,n=h(2);p(),g("htmlFor",e.name),p(),he(e.name),p(2),g("disabled",n.checkFieldUnchanged(n.activeImage,e)),p(),g("inputId",e.name)("showButtons",!0)("maxFractionDigits",1),Se("ngModel",n.activeImage.values[e.name]),g("placeholder",e.name)}}function mS(t,r){if(t&1){let e=pe();d(0,"table",11)(1,"tbody",12)(2,"tr")(3,"td",13)(4,"h5"),v(5,"\u041A\u0430\u0440\u0442\u0438\u043D\u043A\u0438"),u(),d(6,"p-listbox",14),Fe("ngModelChange",function(i){O(e);let o=h();return ke(o.activeImageField,i)||(o.activeImageField=i),B(i)}),P(7,sS,8,5,"ng-template",null,2,Z),u(),d(9,"h5"),v(10,"\u0426\u0432\u0435\u0442\u0430"),u(),d(11,"p-listbox",14),Fe("ngModelChange",function(i){O(e);let o=h();return ke(o.activeColorField,i)||(o.activeColorField=i),B(i)}),P(12,lS,5,3,"ng-template",null,2,Z),u(),d(14,"h5"),v(15,"\u0412\u0438\u0434\u0438\u043C\u043E\u0441\u0442\u044C"),u(),d(16,"p-listbox",14),Fe("ngModelChange",function(i){O(e);let o=h();return ke(o.activeVisibilityField,i)||(o.activeVisibilityField=i),B(i)}),P(17,cS,5,4,"ng-template",null,2,Z),u()(),d(19,"td")(20,"h2"),v(21),u(),d(22,"a",15),v(23,"\u0421\u043A\u0430\u0447\u0430\u0442\u044C \u043A\u0430\u0440\u0442\u0438\u043D\u043A\u0443"),u(),d(24,"p-galleria",16),Fe("valueChange",function(i){O(e);let o=h();return ke(o.images,i)||(o.images=i),B(i)})("activeIndexChange",function(i){O(e);let o=h();return ke(o.activeImageIndex,i)||(o.activeImageIndex=i),B(i)}),P(25,uS,1,1,"ng-template",null,2,Z)(27,dS,2,1,"ng-template",null,3,Z),u()(),d(29,"td",13)(30,"h5"),v(31,"\u0422\u0435\u043A\u0441\u0442\u044B"),u(),d(32,"p-listbox",14),Fe("ngModelChange",function(i){O(e);let o=h();return ke(o.activeTextField,i)||(o.activeTextField=i),B(i)}),P(33,pS,2,3,"ng-template",null,2,Z),u(),d(35,"h5"),v(36,"\u0420\u0430\u0437\u043C\u0435\u0440\u044B"),u(),d(37,"div",17)(38,"p-listbox",14),Fe("ngModelChange",function(i){O(e);let o=h();return ke(o.activeNumberField,i)||(o.activeNumberField=i),B(i)}),P(39,fS,6,8,"ng-template",null,2,Z),u()()()()()()}if(t&2){let e=h();p(6),Qt(Je(34,xs)),g("options",e.activeImage.imageFields),Se("ngModel",e.activeImageField),g("listStyle",Je(35,vs)),p(5),Qt(Je(36,xs)),g("options",e.activeImage.colorFields),Se("ngModel",e.activeColorField),g("listStyle",Je(37,vs)),p(5),Qt(Je(38,xs)),g("options",e.activeImage.visibilityFields),Se("ngModel",e.activeVisibilityField),g("listStyle",Je(39,vs)),p(5),he(e.activeImage.name),p(),g("href",e.activeImage.png,Gt)("download",e.activeImage.name+".png"),p(2),Se("value",e.images),g("numVisible",5)("showItemNavigatorsOnHover",!0)("showItemNavigators",!0)("circular",!0),Se("activeIndex",e.activeImageIndex),p(8),Qt(Je(40,xs)),g("options",e.activeImage.textFields),Se("ngModel",e.activeTextField),g("listStyle",Je(41,vs)),p(6),Qt(Je(42,xs)),g("options",e.activeImage.numberFields),Se("ngModel",e.activeNumberField),g("listStyle",Je(43,vs))}}var rn=(function(t){return t[t.Image=0]="Image",t[t.Text=1]="Text",t[t.Number=2]="Number",t[t.Color=3]="Color",t[t.Visible=4]="Visible",t})(rn||{}),yl=class{replaceImageTokens(){this._template&&this._svg.querySelectorAll("*").forEach(r=>{for(let e=0;e<r.attributes.length;e++){let n=r.attributes.item(e);if(n.prefix=="redicy"){let i=/(.+):(text|image|number|color|visible|_content)/gi.exec(n.value);if(i){let o=i[1],a=this.values[o];n.localName=="_content"?r.innerHTML=a:r.setAttribute(n.localName,a)}}}})}svgToPng(){let e=new Blob([this._svg.documentElement.outerHTML],{type:"image/svg+xml;charset=utf-8"}),n=URL.createObjectURL(e),i=new Image;i.onload=()=>{let o=document.createElement("canvas");o.style.width=i.width+"px",o.style.height=i.height+"px",o.width=Math.ceil(i.width*3.125),o.height=Math.ceil(i.height*3.125);let a=o.getContext("2d");a.scale(3.125,3.125),a.drawImage(i,0,0),this._png=o.toDataURL("image/png")},i.src=n}get png(){return this._png}update(){this.replaceImageTokens(),this.svgToPng()}set template(r){if(r!=this._template){this._template=r,this._svg=r.svg.cloneNode(!0);for(let e of r.tokens)this.values[e.name]=e.defaultValue}}get visibilityFields(){return this.getFields(rn.Visible)}get imageFields(){return this.getFields(rn.Image)}get textFields(){return this.getFields(rn.Text)}get colorFields(){return this.getFields(rn.Color)}get numberFields(){return this.getFields(rn.Number)}getFields(r){return this._template?.tokens.filter(e=>e.type==r)}toJSON(){let r=Object.keys(this.values).filter(e=>{let n=this._template.tokens.find(i=>i.name==e);return this.values[e]!=n.defaultValue}).reduce((e,n)=>(e[n]=this.values[n],e),{});return{name:this.name,values:r,template:{templateContent:this._template.templateContent,filename:this._template.fileName}}}},$f=(()=>{let r=class r{constructor(){this.images=[],this.templateFiles=[],this.tokenTypes=rn}addImage(){let n=new yl;n.values={},n.name="Card_"+this.images.length,n.template=this.templateFiles[0],this.images=[...this.images,n],this.onImageUpdate(n),this.activeImageIndex=this.images.length-1}checkFieldUnchanged(n,i){return n.values[i.name]==i.defaultValue}get activeImage(){return this.activeImageIndex==null?null:this.images[this.activeImageIndex]}onImageUpdate(n){n.update(),this.updateDatasetJson()}updateDatasetJson(){let i="data:application/json;base64,"+btoa(encodeURIComponent(JSON.stringify(this.images)).replace(/%([0-9A-F]{2})/g,(o,a)=>String.fromCharCode(parseInt(a,16))));this.dataset=i}onDatasetSelected(n){let i=new FileReader;i.onload=o=>{let a=o.target.result,l=JSON.parse(a);this.activeImageIndex=-1;for(let c=0;c<l.length;c++){let f=l[c].template,m=f;this.parseTemplate(f.templateContent,m),l[c].template=m;let C=new yl;C.name=l[c].name,C.values=[],C.template=m;for(let y of Object.keys(l[c].values))C.values[y]=l[c].values[y];C.update(),l[c]=C}this.images=l,this.activeImageIndex=0},i.readAsText(n.currentFiles[0])}onTemplatesSelected(n){this.images=[];let i=[];for(let o of n.currentFiles){let a={templateContent:"",tokens:[],fileName:o.name,png:"",svg:null};this.loadTemplate(o,a),i.push(a)}this.templateFiles=i,this.images=[]}onImageSelected(n,i,o){if(o.currentFiles.length>0){let a=o.currentFiles[0],l=new FileReader;l.onload=()=>{n.values[i]=l.result,this.onImageUpdate(n)},l.readAsDataURL(a)}}undoField(n){this.activeImage.values[n.name]=n.defaultValue,this.onImageUpdate(this.activeImage)}onColorFieldUpdated(n,i,o){this.onImageUpdate(n)}parseTemplate(n,i){i.templateContent=n,i.svg=new DOMParser().parseFromString(n,"text/xml");let o=new Blob([n],{type:"image/svg+xml;charset=utf-8"});i.png=URL.createObjectURL(o);let a=new Map;i.svg.querySelectorAll("*").forEach(l=>{for(let c=0;c<l.attributes.length;c++){let f=l.attributes.item(c),m=l.attributes.getNamedItemNS("",f.localName),C=/(.+):(text|image|number|color|visible|_content)(:min=(?<min>\d+))?(:max=(?<max>\d+))?/gi.exec(f.value);if(f.prefix=="redicy"&&C){let y=C[1],k=C[2],S,M=m?.value;switch(k){case"image":S=rn.Image;break;case"number":S=rn.Number;break;case"color":S=rn.Color;break;case"visible":S=rn.Visible,M=M??"normal";break;default:S=rn.Text;break}let E,A=C.groups.min===void 0?void 0:parseInt(C.groups.min),x=C.groups.max===void 0?void 0:parseInt(C.groups.max);f.localName=="_content"?E={name:y,type:S,minValue:A,maxValue:x,defaultValue:l.innerHTML}:E={name:y,type:S,minValue:A,maxValue:x,defaultValue:M},E&&a.set(y,E)}}}),i.tokens=[...a.values()]}loadTemplate(n,i){let o=new FileReader;o.onload=a=>{this.parseTemplate(a.target.result,i)},o.readAsText(n)}getTokenTypeImage(n){let i="pi-pi-align-justify";switch(n){case rn.Image:i="pi-image";break;case rn.Number:i="pi-sort-numeric-up";break}return`pi ${i}`}imageTemplateChanged(n,i){this.onImageUpdate(n)}};r.\u0275fac=function(i){return new(i||r)},r.\u0275cmp=He({type:r,selectors:[["app-product-image-editor"]],decls:11,vars:9,consts:[["file",""],["content",""],["item",""],["thumbnail",""],["multiple","true","chooseLabel","\u0412\u044B\u0431\u0440\u0430\u0442\u044C \u0448\u0430\u0431\u043B\u043E\u043D\u044B","accept","image/svg+xml",3,"onSelect","showUploadButton","showCancelButton"],[4,"ngIf"],["chooseLabel","\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0434\u0430\u0442\u0430\u0441\u0435\u0442","accept","application/json",3,"onSelect","showUploadButton","showCancelButton"],["styleClass","m-4","label","\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043A\u0430\u0440\u0442\u0438\u043D\u043A\u0443","icon","pi-add",3,"click","disabled"],["class","p-button",3,"href","download",4,"ngIf"],["width","100%","class","text-center",4,"ngIf"],[1,"p-button",3,"href","download"],["width","100%",1,"text-center"],[1,"align-top"],["width","20%"],[3,"ngModelChange","options","ngModel","listStyle"],[3,"href","download"],[3,"valueChange","activeIndexChange","value","numVisible","showItemNavigatorsOnHover","showItemNavigators","circular","activeIndex"],[1,"card"],[1,"flex","items-center","gap-2"],["styleClass","p-button-sm p-colorpicker-preview p-button-icon-only","icon","pi pi-undo",3,"click","disabled"],["chooseLabel"," ","chooseIcon","pi pi-file-edit","chooseStyleClass","p-button-sm p-button-icon-only","styleClass","flex","accept","image/*",3,"onSelect","showUploadButton","showCancelButton"],[2,"max-width","40px","max-height","40px","width","100%",3,"src"],["appendTo","body",3,"ngModelChange","onChange","ngModel"],["binary","true","trueValue","normal","falseValue","none",3,"ngModelChange","onChange","ngModel","name"],[2,"width","100%","max-width","500px","display","block",3,"src"],[1,"grid","grid-cols-12","gap-4","grid-nogutter","justify-center"],[2,"max-height","50px","max-width","50px",3,"src"],["size","small","icon","pi pi-undo",3,"click","disabled"],["type","text","pInputText","",1,"p-inputtext-sm",3,"ngModelChange","change","ngModel","placeholder"],[1,"flex","flex-col","gap-2"],[3,"htmlFor"],[1,"p-inputgroup"],[3,"ngModelChange","onInput","inputId","showButtons","maxFractionDigits","ngModel","placeholder"]],template:function(i,o){if(i&1){let a=pe();d(0,"p-fileupload",4),ee("onSelect",function(c){return O(a),B(o.onTemplatesSelected(c))}),P(1,Zw,0,0,"ng-template",null,0,Z)(3,tS,2,0,null,5),u(),d(4,"p-fileupload",6),ee("onSelect",function(c){return O(a),B(o.onDatasetSelected(c))}),P(5,rS,0,0,"ng-template",null,0,Z)(7,nS,2,0,null,5),u(),d(8,"p-button",7),ee("click",function(){return O(a),B(o.addImage())}),u(),P(9,oS,2,2,"a",8)(10,mS,41,44,"table",9)}i&2&&(g("showUploadButton",!1)("showCancelButton",!1),p(3),g("ngIf",!1),p(),g("showUploadButton",!1)("showCancelButton",!1),p(3),g("ngIf",!1),p(),g("disabled",!o.templateFiles.length),p(),g("ngIf",!!o.dataset),p(),g("ngIf",o.activeImage))},dependencies:[nr,Ht,et,bt,bl,_s],styles:[".p-fileupload .p-fileupload-content{display:none}"]});let t=r;return t})();var Gf=`
    .p-confirmdialog .p-dialog-content {
        display: flex;
        align-items: center;
        gap: dt('confirmdialog.content.gap');
    }

    .p-confirmdialog-icon {
        color: dt('confirmdialog.icon.color');
        font-size: dt('confirmdialog.icon.size');
        width: dt('confirmdialog.icon.size');
        height: dt('confirmdialog.icon.size');
    }
`;var hS=["header"],gS=["footer"],_S=["rejecticon"],xS=["accepticon"],vS=["message"],bS=["icon"],yS=["headless"],CS=[[["p-footer"]]],wS=["p-footer"],SS=(t,r,e)=>({$implicit:t,onAccept:r,onReject:e}),kS=t=>({$implicit:t});function TS(t,r){t&1&&Tt(0)}function ES(t,r){if(t&1&&P(0,TS,1,0,"ng-container",7),t&2){let e=h(2);g("ngTemplateOutlet",e.headlessTemplate||e._headlessTemplate)("ngTemplateOutletContext",fo(2,SS,e.confirmation,e.onAccept.bind(e),e.onReject.bind(e)))}}function IS(t,r){t&1&&P(0,ES,1,6,"ng-template",null,2,Z)}function FS(t,r){t&1&&Tt(0)}function AS(t,r){if(t&1&&P(0,FS,1,0,"ng-container",8),t&2){let e=h(3);g("ngTemplateOutlet",e.headerTemplate||e._headerTemplate)}}function PS(t,r){t&1&&P(0,AS,1,1,"ng-template",null,4,Z)}function DS(t,r){}function OS(t,r){t&1&&P(0,DS,0,0,"ng-template")}function BS(t,r){if(t&1&&P(0,OS,1,0,null,8),t&2){let e=h(3);g("ngTemplateOutlet",e.iconTemplate||e._iconTemplate)}}function MS(t,r){if(t&1&&Y(0,"i",12),t&2){let e=h(4);_e(e.option("icon")),g("ngClass",e.cx("icon"))("pBind",e.ptm("icon"))}}function RS(t,r){if(t&1&&P(0,MS,1,4,"i",11),t&2){let e=h(3);g("ngIf",e.option("icon"))}}function LS(t,r){}function NS(t,r){t&1&&P(0,LS,0,0,"ng-template")}function VS(t,r){if(t&1&&P(0,NS,1,0,null,7),t&2){let e=h(3);g("ngTemplateOutlet",e.messageTemplate||e._messageTemplate)("ngTemplateOutletContext",vt(2,kS,e.confirmation))}}function zS(t,r){if(t&1&&Y(0,"span",13),t&2){let e=h(3);_e(e.cx("message")),g("pBind",e.ptm("message"))("innerHTML",e.option("message"),Vn)}}function US(t,r){if(t&1&&(ft(0,BS,1,1)(1,RS,1,1,"i",9),ft(2,VS,1,4)(3,zS,1,4,"span",10)),t&2){let e=h(2);mt(e.iconTemplate||e._iconTemplate?0:!e.iconTemplate&&!e._iconTemplate&&!e._messageTemplate&&!e.messageTemplate?1:-1),p(2),mt(e.messageTemplate||e._messageTemplate?2:3)}}function WS(t,r){if(t&1&&(ft(0,PS,2,0),P(1,US,4,2,"ng-template",null,3,Z)),t&2){let e=h();mt(e.headerTemplate||e._headerTemplate?0:-1)}}function jS(t,r){t&1&&Tt(0)}function HS(t,r){if(t&1&&(gr(0),P(1,jS,1,0,"ng-container",8)),t&2){let e=h(2);p(),g("ngTemplateOutlet",e.footerTemplate||e._footerTemplate)}}function $S(t,r){if(t&1&&Y(0,"i",18),t&2){let e=h(6);_e(e.option("rejectIcon")),g("pBind",e.ptm("pcRejectButton").icon)}}function GS(t,r){if(t&1&&P(0,$S,1,3,"i",17),t&2){let e=h(5);g("ngIf",e.option("rejectIcon"))}}function KS(t,r){}function XS(t,r){t&1&&P(0,KS,0,0,"ng-template")}function JS(t,r){if(t&1&&(ft(0,GS,1,1,"i",16),P(1,XS,1,0,null,8)),t&2){let e=h(4);mt(e.rejectIcon&&!e.rejectIconTemplate&&!e._rejectIconTemplate?0:-1),p(),g("ngTemplateOutlet",e.rejectIconTemplate||e._rejectIconTemplate)}}function qS(t,r){if(t&1){let e=pe();d(0,"p-button",15),ee("onClick",function(){O(e);let i=h(3);return B(i.onReject())}),P(1,JS,2,2,"ng-template",null,5,Z),u()}if(t&2){let e=h(3);g("pt",e.ptm("pcRejectButton"))("label",e.rejectButtonLabel)("styleClass",e.getButtonStyleClass("pcRejectButton","rejectButtonStyleClass"))("ariaLabel",e.option("rejectButtonProps","ariaLabel"))("buttonProps",e.getRejectButtonProps())}}function QS(t,r){if(t&1&&Y(0,"i",18),t&2){let e=h(6);_e(e.option("acceptIcon")),g("pBind",e.ptm("pcAcceptButton").icon)}}function YS(t,r){if(t&1&&P(0,QS,1,3,"i",17),t&2){let e=h(5);g("ngIf",e.option("acceptIcon"))}}function ZS(t,r){}function ek(t,r){t&1&&P(0,ZS,0,0,"ng-template")}function tk(t,r){if(t&1&&(ft(0,YS,1,1,"i",16),P(1,ek,1,0,null,8)),t&2){let e=h(4);mt(e.acceptIcon&&!e._acceptIconTemplate&&!e.acceptIconTemplate?0:-1),p(),g("ngTemplateOutlet",e.acceptIconTemplate||e._acceptIconTemplate)}}function rk(t,r){if(t&1){let e=pe();d(0,"p-button",15),ee("onClick",function(){O(e);let i=h(3);return B(i.onAccept())}),P(1,tk,2,2,"ng-template",null,5,Z),u()}if(t&2){let e=h(3);g("pt",e.ptm("pcAcceptButton"))("label",e.acceptButtonLabel)("styleClass",e.getButtonStyleClass("pcAcceptButton","acceptButtonStyleClass"))("ariaLabel",e.option("acceptButtonProps","ariaLabel"))("buttonProps",e.getAcceptButtonProps())}}function ik(t,r){if(t&1&&P(0,qS,3,5,"p-button",14)(1,rk,3,5,"p-button",14),t&2){let e=h(2);g("ngIf",e.option("rejectVisible")),p(),g("ngIf",e.option("acceptVisible"))}}function nk(t,r){if(t&1&&(ft(0,HS,2,1),ft(1,ik,2,2)),t&2){let e=h();mt(e.footerTemplate||e._footerTemplate?0:-1),p(),mt(!e.footerTemplate&&!e._footerTemplate?1:-1)}}var ok={root:"p-confirmdialog",icon:"p-confirmdialog-icon",message:"p-confirmdialog-message",pcRejectButton:"p-confirmdialog-reject-button",pcAcceptButton:"p-confirmdialog-accept-button"},Kf=(()=>{class t extends ir{name="confirmdialog";style=Gf;classes=ok;static \u0275fac=(()=>{let e;return function(i){return(e||(e=ht(t)))(i||t)}})();static \u0275prov=Ye({token:t,factory:t.\u0275fac})}return t})();var Xf=new wt("CONFIRMDIALOG_INSTANCE"),ak=Wc([ki({transform:"{{transform}}",opacity:0}),qi("{{transition}}",ki({transform:"none",opacity:1}))]),sk=Wc([qi("{{transition}}",ki({transform:"{{transform}}",opacity:0}))]),ia=(()=>{class t extends Zt{confirmationService;zone;$pcConfirmDialog=we(Xf,{optional:!0,skipSelf:!0})??void 0;bindDirectiveInstance=we(Ge,{self:!0});onAfterViewChecked(){this.bindDirectiveInstance.setAttrs(this.ptm("host"))}header;icon;message;get style(){return this._style}set style(e){this._style=e,this.cd.markForCheck()}styleClass;maskStyleClass;acceptIcon;acceptLabel;closeAriaLabel;acceptAriaLabel;acceptVisible=!0;rejectIcon;rejectLabel;rejectAriaLabel;rejectVisible=!0;acceptButtonStyleClass;rejectButtonStyleClass;closeOnEscape=!0;dismissableMask;blockScroll=!0;rtl=!1;closable=!0;appendTo="body";key;autoZIndex=!0;baseZIndex=0;transitionOptions="150ms cubic-bezier(0, 0, 0.2, 1)";focusTrap=!0;defaultFocus="accept";breakpoints;modal=!0;get visible(){return this._visible}set visible(e){this._visible=e,this._visible&&!this.maskVisible&&(this.maskVisible=!0),this.cd.markForCheck()}get position(){return this._position}set position(e){switch(this._position=e,e){case"topleft":case"bottomleft":case"left":this.transformOptions="translate3d(-100%, 0px, 0px)";break;case"topright":case"bottomright":case"right":this.transformOptions="translate3d(100%, 0px, 0px)";break;case"bottom":this.transformOptions="translate3d(0px, 100%, 0px)";break;case"top":this.transformOptions="translate3d(0px, -100%, 0px)";break;default:this.transformOptions="scale(0.7)";break}}draggable=!0;onHide=new xt;footer;_componentStyle=we(Kf);headerTemplate;footerTemplate;rejectIconTemplate;acceptIconTemplate;messageTemplate;iconTemplate;headlessTemplate;templates;_headerTemplate;_footerTemplate;_rejectIconTemplate;_acceptIconTemplate;_messageTemplate;_iconTemplate;_headlessTemplate;confirmation;_visible;_style;maskVisible;dialog;wrapper;contentContainer;subscription;preWidth;_position="center";transformOptions="scale(0.7)";styleElement;id=un("pn_id_");ariaLabelledBy=this.getAriaLabelledBy();translationSubscription;constructor(e,n){super(),this.confirmationService=e,this.zone=n,this.subscription=this.confirmationService.requireConfirmation$.subscribe(i=>{if(!i){this.hide();return}i.key===this.key&&(this.confirmation=i,Object.keys(i).forEach(a=>{this[a]=i[a]}),this.confirmation.accept&&(this.confirmation.acceptEvent=new xt,this.confirmation.acceptEvent.subscribe(this.confirmation.accept)),this.confirmation.reject&&(this.confirmation.rejectEvent=new xt,this.confirmation.rejectEvent.subscribe(this.confirmation.reject)),this.visible=!0)})}onInit(){this.breakpoints&&this.createStyle(),this.translationSubscription=this.config.translationObserver.subscribe(()=>{this.visible&&this.cd.markForCheck()})}onAfterContentInit(){this.templates?.forEach(e=>{switch(e.getType()){case"header":this._headerTemplate=e.template;break;case"footer":this._footerTemplate=e.template;break;case"message":this._messageTemplate=e.template;break;case"icon":this._iconTemplate=e.template;break;case"rejecticon":this._rejectIconTemplate=e.template;break;case"accepticon":this._acceptIconTemplate=e.template;break;case"headless":this._headlessTemplate=e.template;break}})}getAriaLabelledBy(){return this.header!==null?un("pn_id_")+"_header":null}option(e,n){let i=this;if(i.hasOwnProperty(e))return n?i[n]:i[e]}getButtonStyleClass(e,n){let i=this.cx(e),o=this.option(n);return[i,o].filter(Boolean).join(" ")}getElementToFocus(){if(this.dialog?.el?.nativeElement)switch(this.option("defaultFocus")){case"accept":return Xr(this.dialog.el.nativeElement,".p-confirm-dialog-accept");case"reject":return Xr(this.dialog.el.nativeElement,".p-confirm-dialog-reject");case"close":return Xr(this.dialog.el.nativeElement,".p-dialog-header-close");case"none":return null;default:return Xr(this.dialog.el.nativeElement,".p-confirm-dialog-accept")}}createStyle(){if(!this.styleElement){this.styleElement=this.document.createElement("style"),this.styleElement.type="text/css",zc(this.styleElement,"nonce",this.config?.csp()?.nonce),this.document.head.appendChild(this.styleElement);let e="";for(let n in this.breakpoints)e+=`
                    @media screen and (max-width: ${n}) {
                        .p-dialog[${this.id}] {
                            width: ${this.breakpoints[n]} !important;
                        }
                    }
                `;this.styleElement.innerHTML=e,zc(this.styleElement,"nonce",this.config?.csp()?.nonce)}}close(){this.confirmation?.rejectEvent&&this.confirmation.rejectEvent.emit(ka.CANCEL),this.hide(ka.CANCEL)}hide(e){this.onHide.emit(e),this.visible=!1,this.unsubscribeConfirmationEvents(),this.confirmation=null}destroyStyle(){this.styleElement&&(this.document.head.removeChild(this.styleElement),this.styleElement=null)}onDestroy(){this.subscription.unsubscribe(),this.unsubscribeConfirmationEvents(),this.translationSubscription&&this.translationSubscription.unsubscribe(),this.destroyStyle()}onVisibleChange(e){e?this.visible=e:this.close()}onAccept(){this.confirmation&&this.confirmation.acceptEvent&&this.confirmation.acceptEvent.emit(),this.hide(ka.ACCEPT)}onReject(){this.confirmation&&this.confirmation.rejectEvent&&this.confirmation.rejectEvent.emit(ka.REJECT),this.hide(ka.REJECT)}unsubscribeConfirmationEvents(){this.confirmation&&(this.confirmation.acceptEvent?.unsubscribe(),this.confirmation.rejectEvent?.unsubscribe())}get acceptButtonLabel(){return this.option("acceptLabel")||this.getAcceptButtonProps()?.label||this.config.getTranslation(qr.ACCEPT)}get rejectButtonLabel(){return this.option("rejectLabel")||this.getRejectButtonProps()?.label||this.config.getTranslation(qr.REJECT)}getAcceptButtonProps(){return this.option("acceptButtonProps")}getRejectButtonProps(){return this.option("rejectButtonProps")}static \u0275fac=function(n){return new(n||t)(Pe(Ji),Pe(Pn))};static \u0275cmp=He({type:t,selectors:[["p-confirmDialog"],["p-confirmdialog"],["p-confirm-dialog"]],contentQueries:function(n,i,o){if(n&1&&(Ke(o,Zs,5),Ke(o,hS,4),Ke(o,gS,4),Ke(o,_S,4),Ke(o,xS,4),Ke(o,vS,4),Ke(o,bS,4),Ke(o,yS,4),Ke(o,pi,4)),n&2){let a;Te(a=Ee())&&(i.footer=a.first),Te(a=Ee())&&(i.headerTemplate=a.first),Te(a=Ee())&&(i.footerTemplate=a.first),Te(a=Ee())&&(i.rejectIconTemplate=a.first),Te(a=Ee())&&(i.acceptIconTemplate=a.first),Te(a=Ee())&&(i.messageTemplate=a.first),Te(a=Ee())&&(i.iconTemplate=a.first),Te(a=Ee())&&(i.headlessTemplate=a.first),Te(a=Ee())&&(i.templates=a)}},inputs:{header:"header",icon:"icon",message:"message",style:"style",styleClass:"styleClass",maskStyleClass:"maskStyleClass",acceptIcon:"acceptIcon",acceptLabel:"acceptLabel",closeAriaLabel:"closeAriaLabel",acceptAriaLabel:"acceptAriaLabel",acceptVisible:[2,"acceptVisible","acceptVisible",$e],rejectIcon:"rejectIcon",rejectLabel:"rejectLabel",rejectAriaLabel:"rejectAriaLabel",rejectVisible:[2,"rejectVisible","rejectVisible",$e],acceptButtonStyleClass:"acceptButtonStyleClass",rejectButtonStyleClass:"rejectButtonStyleClass",closeOnEscape:[2,"closeOnEscape","closeOnEscape",$e],dismissableMask:[2,"dismissableMask","dismissableMask",$e],blockScroll:[2,"blockScroll","blockScroll",$e],rtl:[2,"rtl","rtl",$e],closable:[2,"closable","closable",$e],appendTo:"appendTo",key:"key",autoZIndex:[2,"autoZIndex","autoZIndex",$e],baseZIndex:[2,"baseZIndex","baseZIndex",Or],transitionOptions:"transitionOptions",focusTrap:[2,"focusTrap","focusTrap",$e],defaultFocus:"defaultFocus",breakpoints:"breakpoints",modal:[2,"modal","modal",$e],visible:"visible",position:"position",draggable:[2,"draggable","draggable",$e]},outputs:{onHide:"onHide"},features:[Dt([Kf,{provide:Xf,useExisting:t},{provide:Jt,useExisting:t}]),Xt([Ge]),lt],ngContentSelectors:wS,decls:6,vars:18,consts:[["dialog",""],["footer",""],["headless",""],["content",""],["header",""],["icon",""],["role","alertdialog",3,"visibleChange","pt","visible","closable","styleClass","modal","header","closeOnEscape","blockScroll","appendTo","position","dismissableMask","draggable","baseZIndex","autoZIndex","maskStyleClass"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[4,"ngTemplateOutlet"],[3,"ngClass","class","pBind"],[3,"class","pBind","innerHTML"],[3,"ngClass","class","pBind",4,"ngIf"],[3,"ngClass","pBind"],[3,"pBind","innerHTML"],[3,"pt","label","styleClass","ariaLabel","buttonProps","onClick",4,"ngIf"],[3,"onClick","pt","label","styleClass","ariaLabel","buttonProps"],[3,"class","pBind"],[3,"class","pBind",4,"ngIf"],[3,"pBind"]],template:function(n,i){if(n&1){let o=pe();Sr(CS),d(0,"p-dialog",6,0),ee("visibleChange",function(l){return O(o),B(i.onVisibleChange(l))}),ft(2,IS,2,0)(3,WS,3,1),P(4,nk,2,2,"ng-template",null,1,Z),u()}n&2&&(Qt(i.style),g("pt",i.pt)("visible",i.visible)("closable",i.option("closable"))("styleClass",i.cn(i.cx("root"),i.styleClass))("modal",i.option("modal"))("header",i.option("header"))("closeOnEscape",i.option("closeOnEscape"))("blockScroll",i.option("blockScroll"))("appendTo",i.option("appendTo"))("position",i.position)("dismissableMask",i.dismissableMask)("draggable",i.draggable)("baseZIndex",i.baseZIndex)("autoZIndex",i.autoZIndex)("maskStyleClass",i.cn(i.cx("mask"),i.maskStyleClass)),p(2),mt(i.headlessTemplate||i._headlessTemplate?2:3))},dependencies:[et,Br,bt,Rr,Ht,Kn,It,Ge],encapsulation:2,data:{animation:[$n("animation",[Qi("void => visible",[jc(ak)]),Qi("visible => void",[jc(sk)])])]},changeDetection:0})}return t})(),Ma=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=hr({type:t});static \u0275inj=mr({imports:[ia,It,It]})}return t})();var Jf=`
    .p-inputgroup,
    .p-inputgroup .p-iconfield,
    .p-inputgroup .p-floatlabel,
    .p-inputgroup .p-iftalabel {
        display: flex;
        align-items: stretch;
        width: 100%;
    }

    .p-inputgroup .p-inputtext,
    .p-inputgroup .p-inputwrapper {
        flex: 1 1 auto;
        width: 1%;
    }

    .p-inputgroupaddon {
        display: flex;
        align-items: center;
        justify-content: center;
        padding: dt('inputgroup.addon.padding');
        background: dt('inputgroup.addon.background');
        color: dt('inputgroup.addon.color');
        border-block-start: 1px solid dt('inputgroup.addon.border.color');
        border-block-end: 1px solid dt('inputgroup.addon.border.color');
        min-width: dt('inputgroup.addon.min.width');
    }

    .p-inputgroupaddon:first-child,
    .p-inputgroupaddon + .p-inputgroupaddon {
        border-inline-start: 1px solid dt('inputgroup.addon.border.color');
    }

    .p-inputgroupaddon:last-child {
        border-inline-end: 1px solid dt('inputgroup.addon.border.color');
    }

    .p-inputgroupaddon:has(.p-button) {
        padding: 0;
        overflow: hidden;
    }

    .p-inputgroupaddon .p-button {
        border-radius: 0;
    }

    .p-inputgroup > .p-component,
    .p-inputgroup > .p-inputwrapper > .p-component,
    .p-inputgroup > .p-iconfield > .p-component,
    .p-inputgroup > .p-floatlabel > .p-component,
    .p-inputgroup > .p-floatlabel > .p-inputwrapper > .p-component,
    .p-inputgroup > .p-iftalabel > .p-component,
    .p-inputgroup > .p-iftalabel > .p-inputwrapper > .p-component {
        border-radius: 0;
        margin: 0;
    }

    .p-inputgroupaddon:first-child,
    .p-inputgroup > .p-component:first-child,
    .p-inputgroup > .p-inputwrapper:first-child > .p-component,
    .p-inputgroup > .p-iconfield:first-child > .p-component,
    .p-inputgroup > .p-floatlabel:first-child > .p-component,
    .p-inputgroup > .p-floatlabel:first-child > .p-inputwrapper > .p-component,
    .p-inputgroup > .p-iftalabel:first-child > .p-component,
    .p-inputgroup > .p-iftalabel:first-child > .p-inputwrapper > .p-component {
        border-start-start-radius: dt('inputgroup.addon.border.radius');
        border-end-start-radius: dt('inputgroup.addon.border.radius');
    }

    .p-inputgroupaddon:last-child,
    .p-inputgroup > .p-component:last-child,
    .p-inputgroup > .p-inputwrapper:last-child > .p-component,
    .p-inputgroup > .p-iconfield:last-child > .p-component,
    .p-inputgroup > .p-floatlabel:last-child > .p-component,
    .p-inputgroup > .p-floatlabel:last-child > .p-inputwrapper > .p-component,
    .p-inputgroup > .p-iftalabel:last-child > .p-component,
    .p-inputgroup > .p-iftalabel:last-child > .p-inputwrapper > .p-component {
        border-start-end-radius: dt('inputgroup.addon.border.radius');
        border-end-end-radius: dt('inputgroup.addon.border.radius');
    }

    .p-inputgroup .p-component:focus,
    .p-inputgroup .p-component.p-focus,
    .p-inputgroup .p-inputwrapper-focus,
    .p-inputgroup .p-component:focus ~ label,
    .p-inputgroup .p-component.p-focus ~ label,
    .p-inputgroup .p-inputwrapper-focus ~ label {
        z-index: 1;
    }

    .p-inputgroup > .p-button:not(.p-button-icon-only) {
        width: auto;
    }

    .p-inputgroup .p-iconfield + .p-iconfield .p-inputtext {
        border-inline-start: 0;
    }
`;var lk=["*"],ck=`
    ${Jf}

    /*For PrimeNG*/

    .p-inputgroup > .p-component,
    .p-inputgroup > .p-inputwrapper > .p-component,
    .p-inputgroup:first-child > p-button > .p-button,
    .p-inputgroup > .p-floatlabel > .p-component,
    .p-inputgroup > .p-floatlabel > .p-inputwrapper > .p-component,
    .p-inputgroup > .p-iftalabel > .p-component,
    .p-inputgroup > .p-iftalabel > .p-inputwrapper > .p-component {
        border-radius: 0;
        margin: 0;
    }

    .p-inputgroup p-button:first-child,
    .p-inputgroup p-button:last-child {
        display: inline-flex;
    }

    .p-inputgroup:has(> p-button:first-child) .p-button {
        border-start-start-radius: dt('inputgroup.addon.border.radius');
        border-end-start-radius: dt('inputgroup.addon.border.radius');
    }

    .p-inputgroup:has(> p-button:last-child) .p-button {
        border-start-end-radius: dt('inputgroup.addon.border.radius');
        border-end-end-radius: dt('inputgroup.addon.border.radius');
    }

    .p-inputgroup > p-inputmask > .p-inputtext {
        width: 100%;
    }
`,uk={root:({instance:t})=>["p-inputgroup",{"p-inputgroup-fluid":t.fluid}]},qf=(()=>{class t extends ir{name="inputgroup";style=ck;classes=uk;static \u0275fac=(()=>{let e;return function(i){return(e||(e=ht(t)))(i||t)}})();static \u0275prov=Ye({token:t,factory:t.\u0275fac})}return t})();var Qf=new wt("INPUTGROUP_INSTANCE"),na=(()=>{class t extends Zt{_componentStyle=we(qf);$pcInputGroup=we(Qf,{optional:!0,skipSelf:!0})??void 0;bindDirectiveInstance=we(Ge,{self:!0});onAfterViewChecked(){this.bindDirectiveInstance.setAttrs(this.ptms(["host","root"]))}styleClass;static \u0275fac=(()=>{let e;return function(i){return(e||(e=ht(t)))(i||t)}})();static \u0275cmp=He({type:t,selectors:[["p-inputgroup"],["p-inputGroup"],["p-input-group"]],hostVars:2,hostBindings:function(n,i){n&2&&_e(i.cn(i.cx("root"),i.styleClass))},inputs:{styleClass:"styleClass"},features:[Dt([qf,{provide:Qf,useExisting:t},{provide:Jt,useExisting:t}]),Xt([Ge]),lt],ngContentSelectors:lk,decls:1,vars:0,template:function(n,i){n&1&&(Sr(),gr(0))},dependencies:[Er],encapsulation:2})}return t})(),Ra=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=hr({type:t});static \u0275inj=mr({imports:[na,It,It]})}return t})();var dk=["*"],pk={root:"p-inputgroupaddon"},Yf=(()=>{class t extends ir{name="inputgroupaddon";classes=pk;static \u0275fac=(()=>{let e;return function(i){return(e||(e=ht(t)))(i||t)}})();static \u0275prov=Ye({token:t,factory:t.\u0275fac})}return t})(),Zf=new wt("INPUTGROUPADDON_INSTANCE"),oa=(()=>{class t extends Zt{_componentStyle=we(Yf);$pcInputGroupAddon=we(Zf,{optional:!0,skipSelf:!0})??void 0;bindDirectiveInstance=we(Ge,{self:!0});onAfterViewChecked(){this.bindDirectiveInstance.setAttrs(this.ptms(["host","root"]))}style;styleClass;get hostStyle(){return this.style}static \u0275fac=(()=>{let e;return function(i){return(e||(e=ht(t)))(i||t)}})();static \u0275cmp=He({type:t,selectors:[["p-inputgroup-addon"],["p-inputGroupAddon"]],hostVars:4,hostBindings:function(n,i){n&2&&(Qt(i.hostStyle),_e(i.cn(i.cx("root"),i.styleClass)))},inputs:{style:"style",styleClass:"styleClass"},features:[Dt([Yf,{provide:Zf,useExisting:t},{provide:Jt,useExisting:t}]),Xt([Ge]),lt],ngContentSelectors:dk,decls:1,vars:0,template:function(n,i){n&1&&(Sr(),gr(0))},dependencies:[Er],encapsulation:2})}return t})(),La=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=hr({type:t});static \u0275inj=mr({imports:[oa,It,It]})}return t})();var em=(()=>{let r=class r{constructor(n,i){this.productService=n,this.productCommandHandler=i}findProducts(n){return this.productService.findProducts(n)}findProductPackages(n){return this.productService.findProductPackages(n)}updateProductPackage(n){return this.productCommandHandler.updateProductPackage(n)}updateProduct(n){return this.productCommandHandler.updateProduct(n)}removeProductPackage(n){return this.productCommandHandler.removeProductPackage(n)}removeProduct(n){return this.productCommandHandler.removeProduct(n)}addProductPackage(n){return this.productCommandHandler.addProductPackage(n)}addProduct(n){return this.productCommandHandler.addProduct(n)}};r.\u0275fac=function(i){return new(i||r)(Pt(fe.ProductClient),Pt(er.ProductClient))},r.\u0275prov=Ye({token:r,factory:r.\u0275fac,providedIn:"root"});let t=r;return t})();var mk=()=>["name"],hk=()=>[10,25,50],gk=()=>({"min-width":"75rem"}),_k=t=>({width:t});function xk(t,r){t&1&&(d(0,"tr")(1,"th",12),v(2," \u041A\u043E\u0434 "),Y(3,"p-sortIcon",13),u(),d(4,"th",14),v(5," \u041D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435 "),Y(6,"p-sortIcon",15),u(),d(7,"th"),v(8,"\u0413\u0430\u0431\u0430\u0440\u0438\u0442\u044B"),u(),d(9,"th"),v(10,"\u041C\u0438\u043D\u0438\u043C\u0430\u043B\u044C\u043D\u044B\u0439 \u043E\u0441\u0442\u0430\u0442\u043E\u043A \u043D\u0430 \u0441\u043A\u043B\u0430\u0434\u0435"),u(),d(11,"th"),v(12,"\u041E\u0441\u0442\u0430\u0442\u043E\u043A \u043D\u0430 \u0441\u0432\u043E\u0451\u043C \u0441\u043A\u043B\u0430\u0434\u0435"),u(),Y(13,"th")(14,"th"),u(),d(15,"tr")(16,"th"),Y(17,"p-columnFilter",16),u(),d(18,"th"),Y(19,"p-columnFilter",17),u(),Y(20,"th")(21,"th")(22,"th")(23,"th")(24,"th"),u())}function vk(t,r){if(t&1){let e=pe();d(0,"p-button",25),ee("click",function(){O(e);let i=h().$implicit,o=h();return o.showScanner=!0,B(o.selectedProduct=i)}),u()}}function bk(t,r){if(t&1){let e=pe();d(0,"input",26),Fe("ngModelChange",function(i){O(e);let o=h().$implicit;return ke(o.name,i)||(o.name=i),B(i)}),u()}if(t&2){let e=h().$implicit;Se("ngModel",e.name)}}function yk(t,r){if(t&1&&v(0),t&2){let e=h().$implicit;Ie(" ",e.name," ")}}function Ck(t,r){if(t&1){let e=pe();d(0,"p-inputgroup")(1,"p-inputgroup-addon"),v(2,"\u0428"),u(),d(3,"p-inputnumber",27),Fe("ngModelChange",function(i){O(e);let o=h().$implicit;return ke(o.widthMM,i)||(o.widthMM=i),B(i)}),u(),d(4,"p-inputgroup-addon"),v(5,"\u043C\u043C"),u()(),d(6,"p-inputgroup")(7,"p-inputgroup-addon"),v(8,"\u0412"),u(),d(9,"p-inputnumber",28),Fe("ngModelChange",function(i){O(e);let o=h().$implicit;return ke(o.heightMM,i)||(o.heightMM=i),B(i)}),u(),d(10,"p-inputgroup-addon"),v(11,"\u043C\u043C"),u()(),d(12,"p-inputgroup")(13,"p-inputgroup-addon"),v(14,"\u0413"),u(),d(15,"p-inputnumber",29),Fe("ngModelChange",function(i){O(e);let o=h().$implicit;return ke(o.depthMM,i)||(o.depthMM=i),B(i)}),u(),d(16,"p-inputgroup-addon"),v(17,"\u043C\u043C"),u()(),d(18,"p-inputgroup")(19,"p-inputgroup-addon"),v(20,"\u0412\u0435\u0441"),u(),d(21,"p-inputnumber",30),Fe("ngModelChange",function(i){O(e);let o=h().$implicit;return ke(o.weightG,i)||(o.weightG=i),B(i)}),u(),d(22,"p-inputgroup-addon"),v(23,"\u0433"),u()()}if(t&2){let e=h().$implicit;p(3),Se("ngModel",e.widthMM),p(6),Se("ngModel",e.heightMM),p(6),Se("ngModel",e.depthMM),p(6),Se("ngModel",e.weightG)}}function wk(t,r){if(t&1&&(d(0,"div",31),v(1),u(),d(2,"div"),v(3),u()),t&2){let e=h().$implicit;p(),Jo(" ",e.widthMM??0," x ",e.heightMM??0," x ",e.depthMM??0," "),p(2),Ie("",e.weightG??0,"\u0433")}}function Sk(t,r){if(t&1){let e=pe();d(0,"input",26),Fe("ngModelChange",function(i){O(e);let o=h().$implicit;return ke(o.minimumWarehouseStock,i)||(o.minimumWarehouseStock=i),B(i)}),u()}if(t&2){let e=h().$implicit;Se("ngModel",e.minimumWarehouseStock)}}function kk(t,r){if(t&1&&v(0),t&2){let e=h().$implicit;Ie(" ",e.minimumWarehouseStock??0," ")}}function Tk(t,r){if(t&1){let e=pe();d(0,"input",26),Fe("ngModelChange",function(i){O(e);let o=h().$implicit;return ke(o.stockAmount,i)||(o.stockAmount=i),B(i)}),u()}if(t&2){let e=h().$implicit;Se("ngModel",e.stockAmount)}}function Ek(t,r){if(t&1&&v(0),t&2){let e=h().$implicit;Ie(" ",e.stockAmount??0," ")}}function Ik(t,r){if(t&1){let e=pe();d(0,"p-button",32),ee("click",function(){O(e);let i=h().$implicit,o=h(),a=Dr(7);return B(o.onProductEditInit(a,i))}),u()}}function Fk(t,r){if(t&1){let e=pe();d(0,"p-button",33),ee("click",function(){O(e);let i=h().$implicit,o=h(),a=Dr(7);return B(o.onProductEditSave(a,i))}),u()}}function Ak(t,r){if(t&1){let e=pe();d(0,"p-button",34),ee("click",function(){O(e);let i=h(2);return B(i.onProductEditCancel())}),u()}}function Pk(t,r){if(t&1){let e=pe();d(0,"p-button",35),ee("click",function(i){O(e);let o=h().$implicit,a=h();return B(a.confirmProductRemoval(i,o))}),u()}}function Dk(t,r){if(t&1&&Y(0,"button",36),t&2){let e=h(),n=e.expanded,i=e.$implicit;g("icon",n?"pi pi-chevron-down":"pi pi-chevron-right")("pRowToggler",i)}}function Ok(t,r){if(t&1&&(d(0,"tr",18)(1,"td"),v(2),P(3,vk,1,0,"p-button",19),u(),d(4,"td")(5,"p-cellEditor"),P(6,bk,1,1,"ng-template",null,5,Z)(8,yk,1,1,"ng-template",null,6,Z),u()(),d(10,"td")(11,"p-cellEditor"),P(12,Ck,24,4,"ng-template",null,5,Z)(14,wk,4,4,"ng-template",null,6,Z),u()(),d(16,"td")(17,"p-cellEditor"),P(18,Sk,1,1,"ng-template",null,5,Z)(20,kk,1,1,"ng-template",null,6,Z),u()(),d(22,"td")(23,"p-cellEditor"),P(24,Tk,1,1,"ng-template",null,5,Z)(26,Ek,1,1,"ng-template",null,6,Z),u()(),d(28,"td"),P(29,Ik,1,0,"p-button",20)(30,Fk,1,0,"p-button",21)(31,Ak,1,0,"p-button",22)(32,Pk,1,0,"p-button",23),u(),d(33,"td"),P(34,Dk,1,2,"button",24),u()()),t&2){let e=r.editing,n=r.$implicit,i=h();g("pEditableRow",n),p(2),Ie(" ",n.iD," "),p(),g("ngIf",e),p(26),g("ngIf",!e),p(),g("ngIf",e),p(),g("ngIf",e),p(),g("ngIf",!i.editMode),p(2),g("ngIf",n.iD)}}function Bk(t,r){t&1&&(d(0,"tr")(1,"th"),v(2,"\u041A\u043E\u0434"),u(),d(3,"th"),v(4," \u041D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435 "),u(),d(5,"th"),v(6," \u0413\u0430\u0431\u0430\u0440\u0438\u0442\u044B (\u0431\u0440\u0443\u0442\u0442\u043E) "),u(),d(7,"th"),v(8,"\u041C\u0438\u043D\u0438\u043C\u0430\u043B\u044C\u043D\u044B\u0439 \u0437\u0430\u043F\u0430\u0441, \u0448\u0442"),u(),d(9,"th"),v(10,"\u041F\u043E\u0434\u0433\u043E\u0442\u043E\u0432\u043A\u0430 \u043F\u043E\u0441\u0442\u0430\u0432\u043A\u0438, \u0434\u043D\u0435\u0439"),u(),d(11,"th"),v(12,"\u0422\u043E\u0432\u0430\u0440\u043E\u0432 \u0432 \u0444\u0430\u0441\u043E\u0432\u043A\u0435"),u(),Y(13,"th"),u())}function Mk(t,r){if(t&1){let e=pe();d(0,"input",26),Fe("ngModelChange",function(i){O(e);let o=h().$implicit;return ke(o.name,i)||(o.name=i),B(i)}),u()}if(t&2){let e=h().$implicit;Se("ngModel",e.name)}}function Rk(t,r){if(t&1&&v(0),t&2){let e=h().$implicit;Ie(" ",e.name," ")}}function Lk(t,r){if(t&1){let e=pe();d(0,"p-inputgroup")(1,"p-inputgroup-addon"),v(2,"\u0428"),u(),d(3,"p-inputnumber",41),Fe("ngModelChange",function(i){O(e);let o=h().$implicit;return ke(o.widthMM,i)||(o.widthMM=i),B(i)}),u(),d(4,"p-inputgroup-addon"),v(5,"\u043C\u043C"),u()(),d(6,"p-inputgroup")(7,"p-inputgroup-addon"),v(8,"\u0412"),u(),d(9,"p-inputnumber",28),Fe("ngModelChange",function(i){O(e);let o=h().$implicit;return ke(o.heightMM,i)||(o.heightMM=i),B(i)}),u(),d(10,"p-inputgroup-addon"),v(11,"\u043C\u043C"),u()(),d(12,"p-inputgroup")(13,"p-inputgroup-addon"),v(14,"\u0413"),u(),d(15,"p-inputnumber",29),Fe("ngModelChange",function(i){O(e);let o=h().$implicit;return ke(o.depthMM,i)||(o.depthMM=i),B(i)}),u(),d(16,"p-inputgroup-addon"),v(17,"\u043C\u043C"),u()(),d(18,"p-inputgroup")(19,"p-inputgroup-addon"),v(20,"\u0412\u0435\u0441"),u(),d(21,"p-inputnumber",30),Fe("ngModelChange",function(i){O(e);let o=h().$implicit;return ke(o.weightG,i)||(o.weightG=i),B(i)}),u(),d(22,"p-inputgroup-addon"),v(23,"\u0433"),u()()}if(t&2){let e=h().$implicit;p(3),Se("ngModel",e.widthMM),p(6),Se("ngModel",e.heightMM),p(6),Se("ngModel",e.depthMM),p(6),Se("ngModel",e.weightG)}}function Nk(t,r){if(t&1&&(d(0,"div",31),v(1),u(),d(2,"div"),v(3),u()),t&2){let e=h().$implicit;p(),Jo(" ",e.widthMM??0," x ",e.heightMM??0," x ",e.depthMM??0," "),p(2),Ie("",e.weightG??0,"\u0433")}}function Vk(t,r){if(t&1){let e=pe();d(0,"input",26),Fe("ngModelChange",function(i){O(e);let o=h().$implicit;return ke(o.minimumWarehouseStock,i)||(o.minimumWarehouseStock=i),B(i)}),u()}if(t&2){let e=h().$implicit;Se("ngModel",e.minimumWarehouseStock)}}function zk(t,r){if(t&1&&v(0),t&2){let e=h().$implicit;Ie(" ",e.minimumWarehouseStock," ")}}function Uk(t,r){if(t&1){let e=pe();d(0,"input",26),Fe("ngModelChange",function(i){O(e);let o=h().$implicit;return ke(o.supplyPreparationTimeInDays,i)||(o.supplyPreparationTimeInDays=i),B(i)}),u()}if(t&2){let e=h().$implicit;Se("ngModel",e.supplyPreparationTimeInDays)}}function Wk(t,r){if(t&1&&v(0),t&2){let e=h().$implicit;Ie(" ",e.supplyPreparationTimeInDays," ")}}function jk(t,r){if(t&1){let e=pe();d(0,"p-inputnumber",42),Fe("ngModelChange",function(i){O(e);let o=h().$implicit;return ke(o.productCount,i)||(o.productCount=i),B(i)}),u()}if(t&2){let e=h().$implicit;Se("ngModel",e.productCount),g("useGrouping",!1)}}function Hk(t,r){if(t&1&&v(0),t&2){let e=h().$implicit;Ie(" ",e.productCount," ")}}function $k(t,r){if(t&1){let e=pe();d(0,"p-button",32),ee("click",function(){O(e);let i=h(),o=i.$implicit,a=i.rowIndex;h();let l=Dr(1),c=h(2);return B(c.onPackageEditInit(l,o,a))}),u()}}function Gk(t,r){if(t&1){let e=pe();d(0,"p-button",43),ee("click",function(){O(e);let i=h().$implicit,o=h(3);return B(o.onPackageEditSave(i))}),u()}}function Kk(t,r){if(t&1){let e=pe();d(0,"p-button",34),ee("click",function(){O(e);let i=h().rowIndex;h();let o=Dr(1),a=h(2);return B(a.onPackageEditCancel(o,i))}),u()}}function Xk(t,r){if(t&1){let e=pe();d(0,"tr",18)(1,"td"),v(2),u(),d(3,"td")(4,"p-cellEditor"),P(5,Mk,1,1,"ng-template",null,5,Z)(7,Rk,1,1,"ng-template",null,6,Z),u()(),d(9,"td")(10,"p-cellEditor"),P(11,Lk,24,4,"ng-template",null,5,Z)(13,Nk,4,4,"ng-template",null,6,Z),u()(),d(15,"td")(16,"p-cellEditor"),P(17,Vk,1,1,"ng-template",null,5,Z)(19,zk,1,1,"ng-template",null,6,Z),u()(),d(21,"td")(22,"p-cellEditor"),P(23,Uk,1,1,"ng-template",null,5,Z)(25,Wk,1,1,"ng-template",null,6,Z),u()(),d(27,"td")(28,"p-cellEditor"),P(29,jk,1,2,"ng-template",null,5,Z)(31,Hk,1,1,"ng-template",null,6,Z),u()(),d(33,"td"),P(34,$k,1,0,"p-button",20)(35,Gk,1,0,"p-button",40)(36,Kk,1,0,"p-button",22),d(37,"p-button",35),ee("click",function(i){let o=O(e).$implicit,a=h(2).$implicit,l=h();return B(l.confirmProductPackageRemoval(i,o,a))}),u()()()}if(t&2){let e=r.$implicit,n=r.editing;g("pEditableRow",e),p(2),he(e.iD),p(32),g("ngIf",!n),p(),g("ngIf",n),p(),g("ngIf",n)}}function Jk(t,r){if(t&1&&(d(0,"p-table",39,7),P(2,Bk,14,0,"ng-template",null,1,Z)(4,Xk,38,5,"ng-template",null,2,Z),u()),t&2){let e=h().$implicit;g("value",e.packages)}}function qk(t,r){if(t&1){let e=pe();d(0,"tr")(1,"td",37)(2,"button",10),ee("click",function(){let i=O(e).$implicit,o=h();return B(o.addPackage(o.packageTable,i))}),v(3,"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0444\u0430\u0441\u043E\u0432\u043A\u0443"),u(),P(4,Jk,6,1,"p-table",38),u()()}if(t&2){let e=r.$implicit;p(4),g("ngIf",e.packages==null?null:e.packages.length)}}function Qk(t,r){if(t&1&&(d(0,"td"),Y(1,"p-skeleton",46),u()),t&2){let e=r.$implicit,n=r.even;p(),g("ngStyle",vt(1,_k,n?e.field==="year"?"30%":"40%":"60%"))}}function Yk(t,r){if(t&1&&(d(0,"tr",44),P(1,Qk,2,3,"td",45),u()),t&2){let e=r.columns;p(),g("ngForOf",e)}}var tm=(()=>{let r=class r extends ei{constructor(n,i,o,a){super(a),this.productService=n,this.messageService=i,this.confirmationService=o,this.totalRecords=0,this.newProductName="",this.editMode=!1}ngOnInit(){this.titleService.setTitle("\u0423\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u0435 \u0442\u043E\u0432\u0430\u0440\u0430\u043C\u0438")}findProducts(n){this.productService.findProducts(n).pipe(ge(i=>(this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430",severity:"error",detail:i}),it))).subscribe(i=>{this.data=i.items,this.totalRecords=i.totalCount})}onDataLazyLoad(n){let i=new fe.FindProductsModel({offset:n.first,count:n.rows});if(this.fillFilterModel(i,n.filters),n.sortField){switch(n.sortField){case"name":i.orderField=fe.FindProductsModelSortField.Name;break;case"iD":i.orderField=fe.FindProductsModelSortField.ID;break}i.orderAscending=n.sortOrder>0}this.findProducts(i)}fillFilterModel(n,i){n.name=i.name?.value;let o=+i.iD?.value;n.iD=o>0?o:null}onProductEditInit(n,i){let o=this.editingProduct;this.editMode=!0;let a=i;a._edit={},Object.assign(a._edit,i,{_edit:void 0}),this.editingProduct=Pr({},i),o&&o!=i&&(n.cancelRowEdit(o),this.onProductEditCancel(o))}onProductEditSave(n,i){let o=i;i.iD===0?this.productService.addProduct(i).pipe(ge(a=>(this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430 \u0434\u043E\u0431\u0430\u0432\u043B\u0435\u043D\u0438\u044F \u0442\u043E\u0432\u0430\u0440\u0430",severity:"error",detail:a}),it))).subscribe(a=>{i.iD=a,this.messageService.add({summary:"\u0422\u043E\u0432\u0430\u0440 \u0434\u043E\u0431\u0430\u0432\u043B\u0435\u043D",severity:"success"})}):this.productService.updateProduct(i).pipe(ge(a=>(this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430 \u0434\u043E\u0431\u0430\u0432\u043B\u0435\u043D\u0438\u044F \u0442\u043E\u0432\u0430\u0440\u0430",severity:"error",detail:a}),it))).subscribe(()=>{this.messageService.add({summary:"\u0422\u043E\u0432\u0430\u0440 \u043E\u0431\u043D\u043E\u0432\u043B\u0451\u043D",severity:"success"}),n.cancelRowEdit(o),o._edit=void 0,this.editMode=!1})}onProductEditCancel(n){n&&(n.iD||this.data.splice(this.data.findIndex(i=>i==n),1),n._edit=void 0)}onPackageEditInit(n,i,o){this.editingPackageIndex!==void 0&&this.editingPackageIndex!=o&&(n.cancelRowEdit(this.editingPackage),this.onPackageEditCancel(n,this.editingPackageIndex)),this.editingPackageIndex=o,this.editingPackage=Pr({},i)}onPackageEditSave(n){n.iD===0?this.productService.addProductPackage(n).pipe(ge(i=>(this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430 \u0434\u043E\u0431\u0430\u0432\u043B\u0435\u043D\u0438\u044F \u0444\u0430\u0441\u043E\u0432\u043A\u0438 \u0442\u043E\u0432\u0430\u0440\u0430",severity:"error",detail:i}),it))).subscribe(i=>{n.iD=i.iD,this.messageService.add({summary:"\u0424\u0430\u0441\u043E\u0432\u043A\u0430 \u0442\u043E\u0432\u0430\u0440\u0430 \u0434\u043E\u0431\u0430\u0432\u043B\u0435\u043D\u0430",severity:"success"})}):this.productService.updateProductPackage(n).pipe(ge(i=>(this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430 \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u044F \u0444\u0430\u0441\u043E\u0432\u043A\u0438 \u0442\u043E\u0432\u0430\u0440\u0430",severity:"error",detail:i}),it))).subscribe(()=>{this.messageService.add({summary:"\u0424\u0430\u0441\u043E\u0432\u043A\u0430 \u0442\u043E\u0432\u0430\u0440\u0430 \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0430",severity:"success"})})}onPackageEditCancel(n,i){n.value[i]=this.editingPackage,this.editingPackageIndex=void 0}addPackage(n,i){i.packages??=[];let o=new fe.ProductPackage({iD:0,productCount:1,name:i.name,productID:i.iD,supplyPreparationTimeInDays:0,minimumWarehouseStock:0,product:null});i.packages.push(o),n.initRowEdit(o)}addProduct(n){let i=new fe.Product({iD:0,categoryID:1,name:this.newProductName,stockAmount:0,category:null,packages:[]});this.data.unshift(i),this.onProductEditInit(n,i),n.initRowEdit(i)}confirmProductRemoval(n,i){this.confirmationService.confirm({target:n.target,message:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0442\u043E\u0432\u0430\u0440?",header:"\u041F\u043E\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043D\u0438\u0435 \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u044F",icon:"pi pi-exclamation-triangle text-red-500",rejectIcon:"none",rejectButtonStyleClass:"p-button-text",defaultFocus:"none",accept:()=>{this.removeProduct(i)}})}removeProduct(n){this.productService.removeProduct(n.iD).pipe(ge(i=>(this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430 \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u044F \u0442\u043E\u0432\u0430\u0440\u0430",severity:"error",detail:i}),it))).subscribe(()=>{let i=this.data.indexOf(n);this.data.splice(i,1),this.messageService.add({summary:"\u0422\u043E\u0432\u0430\u0440 \u0443\u0434\u0430\u043B\u0451\u043D",severity:"success"})})}confirmProductPackageRemoval(n,i,o){this.confirmationService.confirm({target:n.target,message:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0444\u0430\u0441\u043E\u0432\u043A\u0443 \u0442\u043E\u0432\u0430\u0440\u0430??",header:"\u041F\u043E\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043D\u0438\u0435 \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u044F",icon:"pi pi-exclamation-triangle",acceptIcon:"none",rejectIcon:"none",rejectButtonStyleClass:"p-button-text",accept:()=>{this.removeProductPackage(i,o)}})}removeProductPackage(n,i){this.productService.removeProductPackage(n.iD).pipe(ge(o=>(this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430 \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u044F \u0444\u0430\u0441\u043E\u0432\u043A\u0438",severity:"error",detail:o}),it))).subscribe(()=>{let o=i.packages.indexOf(n);i.packages.splice(o,1),this.messageService.add({summary:"\u0424\u0430\u0441\u043E\u0432\u043A\u0430 \u0443\u0434\u0430\u043B\u0435\u043D\u0430",severity:"success"})})}};r.\u0275fac=function(i){return new(i||r)(Pe(em),Pe(Yt),Pe(Ji),Pe(Zr))},r.\u0275cmp=He({type:r,selectors:[["app-product-list"]],features:[Dt([Ji]),lt],decls:16,vars:14,consts:[["productTable",""],["header",""],["body",""],["expandedrow",""],["loadingbody",""],["input",""],["output",""],["packageTable",""],[1,"flex"],["pInputText","","placeholder","\u041D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435","type","text",3,"ngModelChange","ngModel"],["pButton","",3,"click"],["dataKey","iD","editMode","row","sortField","name",3,"onLazyLoad","globalFilterFields","lazy","loading","paginator","rowsPerPageOptions","rows","sortOrder","tableStyle","totalRecords","value"],["pSortableColumn","iD"],["field","iD"],["pSortableColumn","name"],["field","name"],["field","iD","type","text"],["field","name","type","text"],[3,"pEditableRow"],["icon","pi pi-dollar",3,"click",4,"ngIf"],["icon","pi pi-pencil","pInitEditableRow","","pRipple","","type","button",3,"click",4,"ngIf"],["icon","pi pi-check","pRipple","","type","button",3,"click",4,"ngIf"],["icon","pi pi-times","pCancelEditableRow","","pRipple","","type","button",3,"click",4,"ngIf"],["icon","pi pi-trash","pRipple","","styleClass","p-button-danger","type","button",3,"click",4,"ngIf"],["class","p-button-text p-button-rounded p-button-plain","pButton","","pRipple","","type","button",3,"icon","pRowToggler",4,"ngIf"],["icon","pi pi-dollar",3,"click"],["pInputText","","type","text",3,"ngModelChange","ngModel"],["name","widthMM","placeholder","\u0428\u0438\u0440\u0438\u043D\u0430",3,"ngModelChange","ngModel"],["placeholder","\u0412\u044B\u0441\u043E\u0442\u0430",3,"ngModelChange","ngModel"],["placeholder","\u0413\u043B\u0443\u0431\u0438\u043D\u0430",3,"ngModelChange","ngModel"],["placeholder","\u0412\u0435\u0441",3,"ngModelChange","ngModel"],[1,"flex","whitespace-nowrap"],["icon","pi pi-pencil","pInitEditableRow","","pRipple","","type","button",3,"click"],["icon","pi pi-check","pRipple","","type","button",3,"click"],["icon","pi pi-times","pCancelEditableRow","","pRipple","","type","button",3,"click"],["icon","pi pi-trash","pRipple","","styleClass","p-button-danger","type","button",3,"click"],["pButton","","pRipple","","type","button",1,"p-button-text","p-button-rounded","p-button-plain",3,"icon","pRowToggler"],["colspan","6"],["dataKey","iD","editMode","row",3,"value",4,"ngIf"],["dataKey","iD","editMode","row",3,"value"],["icon","pi pi-check","pRipple","","pSaveEditableRow","","type","button",3,"click",4,"ngIf"],["placeholder","\u0428\u0438\u0440\u0438\u043D\u0430",3,"ngModelChange","ngModel"],["type","text",3,"ngModelChange","ngModel","useGrouping"],["icon","pi pi-check","pRipple","","pSaveEditableRow","","type","button",3,"click"],[2,"height","46px"],[4,"ngFor","ngForOf"],[3,"ngStyle"]],template:function(i,o){if(i&1){let a=pe();Y(0,"p-toast")(1,"p-confirmDialog"),d(2,"div",8)(3,"input",9),Fe("ngModelChange",function(c){return O(a),ke(o.newProductName,c)||(o.newProductName=c),B(c)}),u(),d(4,"button",10),ee("click",function(){O(a);let c=Dr(7);return B(o.addProduct(c))}),v(5,"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0442\u043E\u0432\u0430\u0440"),u()(),d(6,"p-table",11,0),ee("onLazyLoad",function(c){return O(a),B(o.onDataLazyLoad(c))}),P(8,xk,25,0,"ng-template",null,1,Z)(10,Ok,35,8,"ng-template",null,2,Z)(12,qk,5,1,"ng-template",null,3,Z)(14,Yk,2,1,"ng-template",null,4,Z),u()}i&2&&(p(3),Se("ngModel",o.newProductName),p(3),g("globalFilterFields",Je(11,mk))("lazy",!0)("loading",o.loading)("paginator",!0)("rowsPerPageOptions",Je(12,hk))("rows",10)("sortOrder",1)("tableStyle",Je(13,gk))("totalRecords",o.totalRecords)("value",o.data))},dependencies:[nr,Ti,Ht,et,Mr,bt,zn,Ma,ia,jr,Gn,Ur,Wr,La,oa,Ra,na,Ii,Ei,wn,Yi,Kr,Gr,Zi,Fi,Fa,en,Td,Ed,Id,Fd,Ad,vr,xr],encapsulation:2});let t=r;return t})();function Zk(t,r){}function eT(t,r){}function tT(t,r){t&1&&P(0,eT,0,0,"ng-template",null,1,Z)}function rT(t,r){if(t&1&&($t(),Le(0),Y(1,"image"),Ne()),t&2){let e=r.$implicit,n=r.index,i=h(3);p(),Ue("href",e.image)("x",n*i.width)("width",i.width)("height",i.height)}}function iT(t,r){if(t&1&&($t(),d(0,"svg",25),Y(1,"animate",26),P(2,rT,2,4,"ng-container",27),Y(3,"image"),u()),t&2){let e=r.ngIf,n=h(2);p(),Ue("values",e.values)("keyTimes",e.keyTimes.join(";"))("dur",n.duration)("repeatCount",n.recording?"1":"indefinite"),p(),g("ngForOf",n.images),p(),Ue("href",n.images[0].image)("x",n.images.length*n.width)("width",n.width)("height",n.height)}}function nT(t,r){if(t&1&&(d(0,"div",23),P(1,iT,4,9,"svg",24),u()),t&2){let e=h();p(),g("ngIf",e.getAnimation())}}var rm=(()=>{let r=class r{constructor(n){this.messageService=n,this.width=300,this.height=300,this.frameRate=30,this.animationDuration=1,this.exposureDuration=3,this.recording=!1,this.recordButtonEnabled=!1,this.showVideo=!1}get duration(){return this.images?.length>0?this.images?.length*(this.exposureDuration+this.animationDuration)+this.exposureDuration:0}getAnimation(){let n=[],i=[0],o=this.duration,a=this.exposureDuration/o,l=this.animationDuration/o,c=0;return this.images.forEach((f,m)=>{let y=`${m*this.width} 0 ${this.width} ${this.height}`;n.push(y),n.push(y),c+=a,i.push(Math.round(c*1e3)/1e3),c+=l,i.push(Math.round(c*1e3)/1e3)}),n.push(`${this.images.length*this.width} 0 ${this.width} ${this.height}`),n.push(`${this.images.length*this.width} 0 ${this.width} ${this.height}`),i.push(1),{values:n.join(";"),keyTimes:i}}readImageContent(n,i){let o=new FileReader;o.onload=a=>{i(a.target.result)},o.readAsDataURL(n)}onImagesSelected(n){let i=[],o=!1;for(let a of n.currentFiles){let l={fileName:a.name,image:""};this.readImageContent(a,c=>{if(l.image=c,!o){o=!0;let f=new Image;f.onload=()=>{this.width=f.width,this.height=f.height},f.src=c}}),i.push(l)}this.recordButtonEnabled=!!i.length,this.images=i}delay(n){return new Promise(i=>setTimeout(i,n))}generateVideo(){return ln(this,null,function*(){})}removeAnimation(n){n.querySelectorAll("animate").forEach(i=>i.parentNode.removeChild(i))}traverse(n,i){let o=!1,a=(l,c)=>`${l.x.toFixed(c)} ${l.y.toFixed(c)} ${l.width.toFixed(c)} ${l.height.toFixed(c)}`;for(let l in i)if(i[l]?.animVal)switch(i[l][Symbol.toStringTag]){case"SVGAnimatedRect":{let c=a(i[l].baseVal,0),f=a(n[l].animVal,0);c!=f&&(o=!0,i.setAttribute(l,f))}break;case"SVGAnimatedString":{let c=i[l].baseVal,f=n[l].animVal;c!=f&&(o=!0,i.setAttribute(l,f))}break;default:break}for(let l=0,c=0;l<i.children.length;l++,c++){for(;l<n.children.length&&n.children[l].nodeName=="animate";)l++;o||=this.traverse(n.children[l],i.children[c])}return o}};r.\u0275fac=function(i){return new(i||r)(Pe(Yt))},r.\u0275cmp=He({type:r,selectors:[["app-product-image-animator"]],decls:35,vars:23,consts:[["file",""],["content",""],["multiple","true","chooseLabel","\u0412\u044B\u0431\u0440\u0430\u0442\u044C \u043A\u0430\u0440\u0442\u0438\u043D\u043A\u0438","accept","image/*",3,"onSelect","showUploadButton","disabled","showCancelButton"],[4,"ngIf"],[1,"card","flex","flex-wrap","gap-4","p-fluid"],[1,"flex-auto"],["for","width",1,"mb-2","block","font-bold"],["inputId","width",3,"ngModelChange","ngModel","disabled"],["for","height",1,"mb-2","block","font-bold"],["inputId","height",3,"ngModelChange","ngModel","disabled"],["for","animationDuration",1,"mb-2","block","font-bold"],["inputId","animationDuration",3,"ngModelChange","ngModel","step","maxFractionDigits","disabled"],["for","exposureDuration",1,"mb-2","block","font-bold"],["inputId","exposureDuration",3,"ngModelChange","ngModel","step","maxFractionDigits","disabled"],["for","frameRate",1,"mb-2","block","font-bold"],["inputId","frameRate",3,"ngModelChange","ngModel","disabled"],["for","duration",1,"mb-2","block","font-bold"],["inputId","duration",3,"ngModel","maxFractionDigits","disabled"],[1,"card"],["label","\u0421\u0433\u0435\u043D\u0435\u0440\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u0432\u0438\u0434\u0435\u043E",3,"click","disabled"],[1,"flex"],["style","max-width: 300px",4,"ngIf"],["id","video"],[2,"max-width","300px"],["id","preview","xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","version","1.1",4,"ngIf"],["id","preview","xmlns","http://www.w3.org/2000/svg","width","100%","height","100%","version","1.1"],["attributeName","viewBox","begin","0s"],[4,"ngFor","ngForOf"]],template:function(i,o){if(i&1){let a=pe();Y(0,"p-toast"),d(1,"p-fileupload",2),ee("onSelect",function(c){return O(a),B(o.onImagesSelected(c))}),P(2,Zk,0,0,"ng-template",null,0,Z)(4,tT,2,0,null,3),u(),d(5,"div",4)(6,"div",5)(7,"label",6),v(8,"\u0428\u0438\u0440\u0438\u043D\u0430"),u(),d(9,"p-inputnumber",7),Fe("ngModelChange",function(c){return O(a),ke(o.width,c)||(o.width=c),B(c)}),u()(),d(10,"div",5)(11,"label",8),v(12,"\u0412\u044B\u0441\u043E\u0442\u0430"),u(),d(13,"p-inputnumber",9),Fe("ngModelChange",function(c){return O(a),ke(o.height,c)||(o.height=c),B(c)}),u()(),d(14,"div",5)(15,"label",10),v(16,"\u0414\u043B\u0438\u0442\u0435\u043B\u044C\u043D\u043E\u0441\u0442\u044C \u0430\u043D\u0438\u043C\u0430\u0446\u0438\u0438"),u(),d(17,"p-inputnumber",11),Fe("ngModelChange",function(c){return O(a),ke(o.animationDuration,c)||(o.animationDuration=c),B(c)}),u()(),d(18,"div",5)(19,"label",12),v(20,"\u0414\u043B\u0438\u0442\u0435\u043B\u044C\u043D\u043E\u0441\u0442\u044C \u043F\u043E\u043A\u0430\u0437\u0430"),u(),d(21,"p-inputnumber",13),Fe("ngModelChange",function(c){return O(a),ke(o.exposureDuration,c)||(o.exposureDuration=c),B(c)}),u()(),d(22,"div",5)(23,"label",14),v(24,"Fps"),u(),d(25,"p-inputnumber",15),Fe("ngModelChange",function(c){return O(a),ke(o.frameRate,c)||(o.frameRate=c),B(c)}),u()(),d(26,"div",5)(27,"label",16),v(28,"\u0414\u043B\u0438\u0442\u0435\u043B\u044C\u043D\u043E\u0441\u0442\u044C \u0440\u043E\u043B\u0438\u043A\u0430"),u(),Y(29,"p-inputnumber",17),u()(),d(30,"div",18)(31,"p-button",19),ee("click",function(){return O(a),B(o.generateVideo())}),u(),d(32,"div",20),P(33,nT,2,1,"div",21),Y(34,"div",22),u()()}i&2&&(p(),g("showUploadButton",!1)("disabled",o.recording)("showCancelButton",!1),p(3),g("ngIf",!1),p(5),Se("ngModel",o.width),g("disabled",!o.recordButtonEnabled),p(4),Se("ngModel",o.height),g("disabled",!o.recordButtonEnabled),p(4),Se("ngModel",o.animationDuration),g("step",.1)("maxFractionDigits",2)("disabled",!o.recordButtonEnabled),p(4),Se("ngModel",o.exposureDuration),g("step",.1)("maxFractionDigits",2)("disabled",!o.recordButtonEnabled),p(4),Se("ngModel",o.frameRate),g("disabled",!o.recordButtonEnabled),p(4),g("ngModel",o.duration)("maxFractionDigits",2)("disabled",!0),p(2),g("disabled",!o.recordButtonEnabled),p(2),g("ngIf",o.images))},dependencies:[nr,Ht,et,Mr,bt,bl,_s,jr,Ur,Wr,Ii,Ei,wn,vr,xr],encapsulation:2});let t=r;return t})();var im=`
    .p-chip {
        display: inline-flex;
        align-items: center;
        background: dt('chip.background');
        color: dt('chip.color');
        border-radius: dt('chip.border.radius');
        padding-block: dt('chip.padding.y');
        padding-inline: dt('chip.padding.x');
        gap: dt('chip.gap');
    }

    .p-chip-icon {
        color: dt('chip.icon.color');
        font-size: dt('chip.icon.font.size');
        width: dt('chip.icon.size');
        height: dt('chip.icon.size');
    }

    .p-chip-image {
        border-radius: 50%;
        width: dt('chip.image.width');
        height: dt('chip.image.height');
        margin-inline-start: calc(-1 * dt('chip.padding.y'));
    }

    .p-chip:has(.p-chip-remove-icon) {
        padding-inline-end: dt('chip.padding.y');
    }

    .p-chip:has(.p-chip-image) {
        padding-block-start: calc(dt('chip.padding.y') / 2);
        padding-block-end: calc(dt('chip.padding.y') / 2);
    }

    .p-chip-remove-icon {
        cursor: pointer;
        font-size: dt('chip.remove.icon.size');
        width: dt('chip.remove.icon.size');
        height: dt('chip.remove.icon.size');
        color: dt('chip.remove.icon.color');
        border-radius: 50%;
        transition:
            outline-color dt('chip.transition.duration'),
            box-shadow dt('chip.transition.duration');
        outline-color: transparent;
    }

    .p-chip-remove-icon:focus-visible {
        box-shadow: dt('chip.remove.icon.focus.ring.shadow');
        outline: dt('chip.remove.icon.focus.ring.width') dt('chip.remove.icon.focus.ring.style') dt('chip.remove.icon.focus.ring.color');
        outline-offset: dt('chip.remove.icon.focus.ring.offset');
    }
`;var oT=["removeicon"],aT=["*"];function sT(t,r){if(t&1){let e=pe();d(0,"img",4),ee("error",function(i){O(e);let o=h();return B(o.imageError(i))}),u()}if(t&2){let e=h();_e(e.cx("image")),g("pBind",e.ptm("image"))("src",e.image,Gt)("alt",e.alt)}}function lT(t,r){if(t&1&&Y(0,"span",6),t&2){let e=h(2);_e(e.icon),g("pBind",e.ptm("icon"))("ngClass",e.cx("icon"))}}function cT(t,r){if(t&1&&P(0,lT,1,4,"span",5),t&2){let e=h();g("ngIf",e.icon)}}function uT(t,r){if(t&1&&(d(0,"div",7),v(1),u()),t&2){let e=h();_e(e.cx("label")),g("pBind",e.ptm("label")),p(),he(e.label)}}function dT(t,r){if(t&1){let e=pe();d(0,"span",11),ee("click",function(i){O(e);let o=h(3);return B(o.close(i))})("keydown",function(i){O(e);let o=h(3);return B(o.onKeydown(i))}),u()}if(t&2){let e=h(3);_e(e.removeIcon),g("pBind",e.ptm("removeIcon"))("ngClass",e.cx("removeIcon")),Ue("tabindex",e.disabled?-1:0)("aria-label",e.removeAriaLabel)}}function pT(t,r){if(t&1){let e=pe();$t(),d(0,"svg",12),ee("click",function(i){O(e);let o=h(3);return B(o.close(i))})("keydown",function(i){O(e);let o=h(3);return B(o.onKeydown(i))}),u()}if(t&2){let e=h(3);_e(e.cx("removeIcon")),g("pBind",e.ptm("removeIcon")),Ue("tabindex",e.disabled?-1:0)("aria-label",e.removeAriaLabel)}}function fT(t,r){if(t&1&&(Le(0),P(1,dT,1,6,"span",9)(2,pT,1,5,"svg",10),Ne()),t&2){let e=h(2);p(),g("ngIf",e.removeIcon),p(),g("ngIf",!e.removeIcon)}}function mT(t,r){}function hT(t,r){t&1&&P(0,mT,0,0,"ng-template")}function gT(t,r){if(t&1){let e=pe();d(0,"span",13),ee("click",function(i){O(e);let o=h(2);return B(o.close(i))})("keydown",function(i){O(e);let o=h(2);return B(o.onKeydown(i))}),P(1,hT,1,0,null,14),u()}if(t&2){let e=h(2);_e(e.cx("removeIcon")),g("pBind",e.ptm("removeIcon")),Ue("tabindex",e.disabled?-1:0)("aria-label",e.removeAriaLabel),p(),g("ngTemplateOutlet",e.removeIconTemplate||e._removeIconTemplate)}}function _T(t,r){if(t&1&&(Le(0),P(1,fT,3,2,"ng-container",3)(2,gT,2,6,"span",8),Ne()),t&2){let e=h();p(),g("ngIf",!e.removeIconTemplate&&!e._removeIconTemplate),p(),g("ngIf",e.removeIconTemplate||e._removeIconTemplate)}}var xT={root:({instance:t})=>["p-chip p-component",{"p-disabled":t.disabled}],image:"p-chip-image",icon:"p-chip-icon",label:"p-chip-label",removeIcon:"p-chip-remove-icon"},nm=(()=>{class t extends ir{name="chip";style=im;classes=xT;static \u0275fac=(()=>{let e;return function(i){return(e||(e=ht(t)))(i||t)}})();static \u0275prov=Ye({token:t,factory:t.\u0275fac})}return t})();var om=new wt("CHIP_INSTANCE"),Cl=(()=>{class t extends Zt{$pcChip=we(om,{optional:!0,skipSelf:!0})??void 0;bindDirectiveInstance=we(Ge,{self:!0});onAfterViewChecked(){this.bindDirectiveInstance.setAttrs(this.ptms(["host","root"]))}label;icon;image;alt;styleClass;disabled=!1;removable=!1;removeIcon;onRemove=new xt;onImageError=new xt;visible=!0;get removeAriaLabel(){return this.config.getTranslation(qr.ARIA).removeLabel}get chipProps(){return this._chipProps}set chipProps(e){this._chipProps=e,e&&typeof e=="object"&&Object.entries(e).forEach(([n,i])=>this[`_${n}`]!==i&&(this[`_${n}`]=i))}_chipProps;_componentStyle=we(nm);removeIconTemplate;templates;_removeIconTemplate;onAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"removeicon":this._removeIconTemplate=e.template;break;default:this._removeIconTemplate=e.template;break}})}onChanges(e){if(e.chipProps&&e.chipProps.currentValue){let{currentValue:n}=e.chipProps;n.label!==void 0&&(this.label=n.label),n.icon!==void 0&&(this.icon=n.icon),n.image!==void 0&&(this.image=n.image),n.alt!==void 0&&(this.alt=n.alt),n.styleClass!==void 0&&(this.styleClass=n.styleClass),n.removable!==void 0&&(this.removable=n.removable),n.removeIcon!==void 0&&(this.removeIcon=n.removeIcon)}}close(e){this.visible=!1,this.onRemove.emit(e)}onKeydown(e){(e.key==="Enter"||e.key==="Backspace")&&this.close(e)}imageError(e){this.onImageError.emit(e)}static \u0275fac=(()=>{let e;return function(i){return(e||(e=ht(t)))(i||t)}})();static \u0275cmp=He({type:t,selectors:[["p-chip"]],contentQueries:function(n,i,o){if(n&1&&(Ke(o,oT,4),Ke(o,pi,4)),n&2){let a;Te(a=Ee())&&(i.removeIconTemplate=a.first),Te(a=Ee())&&(i.templates=a)}},hostVars:5,hostBindings:function(n,i){n&2&&(Ue("aria-label",i.label),_e(i.cn(i.cx("root"),i.styleClass)),Vi("display",!i.visible&&"none"))},inputs:{label:"label",icon:"icon",image:"image",alt:"alt",styleClass:"styleClass",disabled:[2,"disabled","disabled",$e],removable:[2,"removable","removable",$e],removeIcon:"removeIcon",chipProps:"chipProps"},outputs:{onRemove:"onRemove",onImageError:"onImageError"},features:[Dt([nm,{provide:om,useExisting:t},{provide:Jt,useExisting:t}]),Xt([Ge]),lt],ngContentSelectors:aT,decls:6,vars:4,consts:[["iconTemplate",""],[3,"pBind","class","src","alt","error",4,"ngIf","ngIfElse"],[3,"pBind","class",4,"ngIf"],[4,"ngIf"],[3,"error","pBind","src","alt"],[3,"pBind","class","ngClass",4,"ngIf"],[3,"pBind","ngClass"],[3,"pBind"],["role","button",3,"pBind","class","click","keydown",4,"ngIf"],["role","button",3,"pBind","class","ngClass","click","keydown",4,"ngIf"],["data-p-icon","times-circle","role","button",3,"pBind","class","click","keydown",4,"ngIf"],["role","button",3,"click","keydown","pBind","ngClass"],["data-p-icon","times-circle","role","button",3,"click","keydown","pBind"],["role","button",3,"click","keydown","pBind"],[4,"ngTemplateOutlet"]],template:function(n,i){if(n&1&&(Sr(),gr(0),P(1,sT,1,5,"img",1)(2,cT,1,1,"ng-template",null,0,Z)(4,uT,2,4,"div",2)(5,_T,3,2,"ng-container",3)),n&2){let o=Dr(3);p(),g("ngIf",i.image)("ngIfElse",o),p(3),g("ngIf",i.label),p(),g("ngIf",i.removable)}},dependencies:[et,Br,bt,Rr,ol,It,Ge],encapsulation:2,changeDetection:0})}return t})();var am=`
    .p-autocomplete {
        display: inline-flex;
    }

    .p-autocomplete-loader {
        position: absolute;
        top: 50%;
        margin-top: -0.5rem;
        inset-inline-end: dt('autocomplete.padding.x');
    }

    .p-autocomplete:has(.p-autocomplete-dropdown) .p-autocomplete-loader {
        inset-inline-end: calc(dt('autocomplete.dropdown.width') + dt('autocomplete.padding.x'));
    }

    .p-autocomplete:has(.p-autocomplete-dropdown) .p-autocomplete-input {
        flex: 1 1 auto;
        width: 1%;
    }

    .p-autocomplete:has(.p-autocomplete-dropdown) .p-autocomplete-input,
    .p-autocomplete:has(.p-autocomplete-dropdown) .p-autocomplete-input-multiple {
        border-start-end-radius: 0;
        border-end-end-radius: 0;
    }

    .p-autocomplete-dropdown {
        cursor: pointer;
        display: inline-flex;
        user-select: none;
        align-items: center;
        justify-content: center;
        overflow: hidden;
        position: relative;
        width: dt('autocomplete.dropdown.width');
        border-start-end-radius: dt('autocomplete.dropdown.border.radius');
        border-end-end-radius: dt('autocomplete.dropdown.border.radius');
        background: dt('autocomplete.dropdown.background');
        border: 1px solid dt('autocomplete.dropdown.border.color');
        border-inline-start: 0 none;
        color: dt('autocomplete.dropdown.color');
        transition:
            background dt('autocomplete.transition.duration'),
            color dt('autocomplete.transition.duration'),
            border-color dt('autocomplete.transition.duration'),
            outline-color dt('autocomplete.transition.duration'),
            box-shadow dt('autocomplete.transition.duration');
        outline-color: transparent;
    }

    .p-autocomplete-dropdown:not(:disabled):hover {
        background: dt('autocomplete.dropdown.hover.background');
        border-color: dt('autocomplete.dropdown.hover.border.color');
        color: dt('autocomplete.dropdown.hover.color');
    }

    .p-autocomplete-dropdown:not(:disabled):active {
        background: dt('autocomplete.dropdown.active.background');
        border-color: dt('autocomplete.dropdown.active.border.color');
        color: dt('autocomplete.dropdown.active.color');
    }

    .p-autocomplete-dropdown:focus-visible {
        box-shadow: dt('autocomplete.dropdown.focus.ring.shadow');
        outline: dt('autocomplete.dropdown.focus.ring.width') dt('autocomplete.dropdown.focus.ring.style') dt('autocomplete.dropdown.focus.ring.color');
        outline-offset: dt('autocomplete.dropdown.focus.ring.offset');
    }

    .p-autocomplete-overlay {
        position: absolute;
        top: 0;
        left: 0;
        background: dt('autocomplete.overlay.background');
        color: dt('autocomplete.overlay.color');
        border: 1px solid dt('autocomplete.overlay.border.color');
        border-radius: dt('autocomplete.overlay.border.radius');
        box-shadow: dt('autocomplete.overlay.shadow');
        min-width: 100%;
    }

    .p-autocomplete-list-container {
        overflow: auto;
    }

    .p-autocomplete-list {
        margin: 0;
        list-style-type: none;
        display: flex;
        flex-direction: column;
        gap: dt('autocomplete.list.gap');
        padding: dt('autocomplete.list.padding');
    }

    .p-autocomplete-option {
        cursor: pointer;
        white-space: nowrap;
        position: relative;
        overflow: hidden;
        display: flex;
        align-items: center;
        padding: dt('autocomplete.option.padding');
        border: 0 none;
        color: dt('autocomplete.option.color');
        background: transparent;
        transition:
            background dt('autocomplete.transition.duration'),
            color dt('autocomplete.transition.duration'),
            border-color dt('autocomplete.transition.duration');
        border-radius: dt('autocomplete.option.border.radius');
    }

    .p-autocomplete-option:not(.p-autocomplete-option-selected):not(.p-disabled).p-focus {
        background: dt('autocomplete.option.focus.background');
        color: dt('autocomplete.option.focus.color');
    }

    .p-autocomplete-option-selected {
        background: dt('autocomplete.option.selected.background');
        color: dt('autocomplete.option.selected.color');
    }

    .p-autocomplete-option-selected.p-focus {
        background: dt('autocomplete.option.selected.focus.background');
        color: dt('autocomplete.option.selected.focus.color');
    }

    .p-autocomplete-option-group {
        margin: 0;
        padding: dt('autocomplete.option.group.padding');
        color: dt('autocomplete.option.group.color');
        background: dt('autocomplete.option.group.background');
        font-weight: dt('autocomplete.option.group.font.weight');
    }

    .p-autocomplete-input-multiple {
        margin: 0;
        list-style-type: none;
        cursor: text;
        overflow: hidden;
        display: flex;
        align-items: center;
        flex-wrap: wrap;
        padding: calc(dt('autocomplete.padding.y') / 2) dt('autocomplete.padding.x');
        gap: calc(dt('autocomplete.padding.y') / 2);
        color: dt('autocomplete.color');
        background: dt('autocomplete.background');
        border: 1px solid dt('autocomplete.border.color');
        border-radius: dt('autocomplete.border.radius');
        width: 100%;
        transition:
            background dt('autocomplete.transition.duration'),
            color dt('autocomplete.transition.duration'),
            border-color dt('autocomplete.transition.duration'),
            outline-color dt('autocomplete.transition.duration'),
            box-shadow dt('autocomplete.transition.duration');
        outline-color: transparent;
        box-shadow: dt('autocomplete.shadow');
    }

    .p-autocomplete-input-multiple.p-disabled {
        opacity: 1;
        background: dt('inputtext.disabled.background');
        color: dt('inputtext.disabled.color');
    }

    .p-autocomplete-input-multiple:not(.p-disabled):hover {
        border-color: dt('autocomplete.hover.border.color');
    }

    .p-autocomplete.p-focus .p-autocomplete-input-multiple:not(.p-disabled) {
        border-color: dt('autocomplete.focus.border.color');
        box-shadow: dt('autocomplete.focus.ring.shadow');
        outline: dt('autocomplete.focus.ring.width') dt('autocomplete.focus.ring.style') dt('autocomplete.focus.ring.color');
        outline-offset: dt('autocomplete.focus.ring.offset');
    }

    .p-autocomplete.p-invalid .p-autocomplete-input-multiple {
        border-color: dt('autocomplete.invalid.border.color');
    }

    .p-variant-filled.p-autocomplete-input-multiple {
        background: dt('autocomplete.filled.background');
    }

    .p-autocomplete-input-multiple.p-variant-filled:not(.p-disabled):hover {
        background: dt('autocomplete.filled.hover.background');
    }

    .p-autocomplete.p-focus .p-autocomplete-input-multiple.p-variant-filled:not(.p-disabled) {
        background: dt('autocomplete.filled.focus.background');
    }

    .p-autocomplete-chip.p-chip {
        padding-block-start: calc(dt('autocomplete.padding.y') / 2);
        padding-block-end: calc(dt('autocomplete.padding.y') / 2);
        border-radius: dt('autocomplete.chip.border.radius');
    }

    .p-autocomplete-input-multiple:has(.p-autocomplete-chip) {
        padding-inline-start: calc(dt('autocomplete.padding.y') / 2);
        padding-inline-end: calc(dt('autocomplete.padding.y') / 2);
    }

    .p-autocomplete-chip-item.p-focus .p-autocomplete-chip {
        background: dt('autocomplete.chip.focus.background');
        color: dt('autocomplete.chip.focus.color');
    }

    .p-autocomplete-input-chip {
        flex: 1 1 auto;
        display: inline-flex;
        padding-block-start: calc(dt('autocomplete.padding.y') / 2);
        padding-block-end: calc(dt('autocomplete.padding.y') / 2);
    }

    .p-autocomplete-input-chip input {
        border: 0 none;
        outline: 0 none;
        background: transparent;
        margin: 0;
        padding: 0;
        box-shadow: none;
        border-radius: 0;
        width: 100%;
        font-family: inherit;
        font-feature-settings: inherit;
        font-size: 1rem;
        color: inherit;
    }

    .p-autocomplete-input-chip input::placeholder {
        color: dt('autocomplete.placeholder.color');
    }

    .p-autocomplete.p-invalid .p-autocomplete-input-chip input::placeholder {
        color: dt('autocomplete.invalid.placeholder.color');
    }

    .p-autocomplete-empty-message {
        padding: dt('autocomplete.empty.message.padding');
    }

    .p-autocomplete-fluid {
        display: flex;
    }

    .p-autocomplete-fluid:has(.p-autocomplete-dropdown) .p-autocomplete-input {
        width: 1%;
    }

    .p-autocomplete:has(.p-inputtext-sm) .p-autocomplete-dropdown {
        width: dt('autocomplete.dropdown.sm.width');
    }

    .p-autocomplete:has(.p-inputtext-sm) .p-autocomplete-dropdown .p-icon {
        font-size: dt('form.field.sm.font.size');
        width: dt('form.field.sm.font.size');
        height: dt('form.field.sm.font.size');
    }

    .p-autocomplete:has(.p-inputtext-lg) .p-autocomplete-dropdown {
        width: dt('autocomplete.dropdown.lg.width');
    }

    .p-autocomplete:has(.p-inputtext-lg) .p-autocomplete-dropdown .p-icon {
        font-size: dt('form.field.lg.font.size');
        width: dt('form.field.lg.font.size');
        height: dt('form.field.lg.font.size');
    }

    .p-autocomplete-clear-icon {
        position: absolute;
        top: 50%;
        margin-top: -0.5rem;
        cursor: pointer;
        color: dt('form.field.icon.color');
        inset-inline-end: dt('autocomplete.padding.x');
    }

    .p-autocomplete:has(.p-autocomplete-dropdown) .p-autocomplete-clear-icon {
        inset-inline-end: calc(dt('autocomplete.padding.x') + dt('autocomplete.dropdown.width'));
    }

    .p-autocomplete:has(.p-autocomplete-clear-icon) .p-autocomplete-input {
        padding-inline-end: calc((dt('form.field.padding.x') * 2) + dt('icon.size'));
    }

    .p-inputgroup .p-autocomplete-dropdown {
        border-radius: 0;
    }

    .p-inputgroup > .p-autocomplete:last-child:has(.p-autocomplete-dropdown) > .p-autocomplete-input {
        border-start-end-radius: 0;
        border-end-end-radius: 0;
    }

    .p-inputgroup > .p-autocomplete:last-child .p-autocomplete-dropdown {
        border-start-end-radius: dt('autocomplete.dropdown.border.radius');
        border-end-end-radius: dt('autocomplete.dropdown.border.radius');
    }
`;var vT=["item"],bT=["empty"],yT=["header"],CT=["footer"],wT=["selecteditem"],ST=["group"],kT=["loader"],TT=["removeicon"],ET=["loadingicon"],IT=["clearicon"],FT=["dropdownicon"],AT=["focusInput"],PT=["multiIn"],DT=["multiContainer"],OT=["ddBtn"],BT=["items"],MT=["scroller"],RT=["overlay"],LT=t=>({i:t}),cm=t=>({$implicit:t}),NT=(t,r,e)=>({removeCallback:t,index:r,class:e}),wl=t=>({height:t}),um=(t,r)=>({$implicit:t,options:r}),VT=t=>({options:t}),zT=()=>({}),UT=(t,r,e)=>({option:t,i:r,scrollerOptions:e}),WT=(t,r)=>({$implicit:t,index:r});function jT(t,r){if(t&1){let e=pe();d(0,"input",18,2),ee("input",function(i){O(e);let o=h();return B(o.onInput(i))})("keydown",function(i){O(e);let o=h();return B(o.onKeyDown(i))})("change",function(i){O(e);let o=h();return B(o.onInputChange(i))})("focus",function(i){O(e);let o=h();return B(o.onInputFocus(i))})("blur",function(i){O(e);let o=h();return B(o.onInputBlur(i))})("paste",function(i){O(e);let o=h();return B(o.onInputPaste(i))})("keyup",function(i){O(e);let o=h();return B(o.onInputKeyUp(i))}),u()}if(t&2){let e=h();_e(e.cn(e.cx("pcInputText"),e.inputStyleClass)),g("pAutoFocus",e.autofocus)("pt",e.ptm("pcInputText"))("ngStyle",e.inputStyle)("variant",e.$variant())("invalid",e.invalid())("pSize",e.size())("fluid",e.hasFluid),Ue("type",e.type)("value",e.inputValue())("id",e.inputId)("autocomplete",e.autocomplete)("placeholder",e.placeholder)("name",e.name())("minlength",e.minlength())("min",e.min())("max",e.max())("pattern",e.pattern())("size",e.inputSize())("maxlength",e.maxlength())("tabindex",e.$disabled()?-1:e.tabindex)("required",e.required()?"":void 0)("readonly",e.readonly?"":void 0)("disabled",e.$disabled()?"":void 0)("aria-label",e.ariaLabel)("aria-labelledby",e.ariaLabelledBy)("aria-required",e.required())("aria-expanded",e.overlayVisible??!1)("aria-controls",e.overlayVisible?e.id+"_list":null)("aria-activedescendant",e.focused?e.focusedOptionId:void 0)}}function HT(t,r){if(t&1){let e=pe();$t(),d(0,"svg",21),ee("click",function(){O(e);let i=h(2);return B(i.clear())}),u()}if(t&2){let e=h(2);_e(e.cx("clearIcon")),g("pBind",e.ptm("clearIcon")),Ue("aria-hidden",!0)}}function $T(t,r){}function GT(t,r){t&1&&P(0,$T,0,0,"ng-template")}function KT(t,r){if(t&1){let e=pe();d(0,"span",22),ee("click",function(){O(e);let i=h(2);return B(i.clear())}),P(1,GT,1,0,null,23),u()}if(t&2){let e=h(2);_e(e.cx("clearIcon")),g("pBind",e.ptm("clearIcon")),Ue("aria-hidden",!0),p(),g("ngTemplateOutlet",e.clearIconTemplate||e._clearIconTemplate)}}function XT(t,r){if(t&1&&(Le(0),P(1,HT,1,4,"svg",19)(2,KT,2,5,"span",20),Ne()),t&2){let e=h();p(),g("ngIf",!e.clearIconTemplate&&!e._clearIconTemplate),p(),g("ngIf",e.clearIconTemplate||e._clearIconTemplate)}}function JT(t,r){t&1&&Tt(0)}function qT(t,r){if(t&1){let e=pe();d(0,"span",22),ee("click",function(i){O(e);let o=h(2).index,a=h(2);return B(!a.readonly&&!a.$disabled()?a.removeOption(i,o):"")}),$t(),Y(1,"svg",31),u()}if(t&2){let e=h(4);_e(e.cx("chipIcon")),g("pBind",e.ptm("chipIcon")),p(),_e(e.cx("chipIcon")),Ue("aria-hidden",!0)}}function QT(t,r){}function YT(t,r){t&1&&P(0,QT,0,0,"ng-template")}function ZT(t,r){if(t&1&&(d(0,"span",32),P(1,YT,1,0,null,29),u()),t&2){let e=h(2).index,n=h(2);g("pBind",n.ptm("chipIcon")),Ue("aria-hidden",!0),p(),g("ngTemplateOutlet",n.removeIconTemplate||n._removeIconTemplate)("ngTemplateOutletContext",fo(4,NT,n.removeOption.bind(n),e,n.cx("chipIcon")))}}function eE(t,r){if(t&1&&P(0,qT,2,6,"span",20)(1,ZT,2,8,"span",30),t&2){let e=h(3);g("ngIf",!e.removeIconTemplate&&!e._removeIconTemplate),p(),g("ngIf",e.removeIconTemplate||e._removeIconTemplate)}}function tE(t,r){if(t&1){let e=pe();d(0,"li",26,5)(2,"p-chip",28),ee("onRemove",function(i){let o=O(e).index,a=h(2);return B(a.readonly?"":a.removeOption(i,o))}),P(3,JT,1,0,"ng-container",29)(4,eE,2,2,"ng-template",null,6,Z),u()()}if(t&2){let e=r.$implicit,n=r.index,i=h(2);_e(i.cx("chipItem",vt(16,LT,n))),g("pBind",i.ptm("chipItem")),Ue("id",i.id+"_multiple_option_"+n)("aria-label",i.getOptionLabel(e))("aria-setsize",i.modelValue().length)("aria-posinset",n+1)("aria-selected",!0),p(2),_e(i.cx("pcChip")),g("pt",i.ptm("pcChip"))("label",!i.selectedItemTemplate&&!i._selectedItemTemplate&&i.getOptionLabel(e))("disabled",i.$disabled())("removable",!0),p(),g("ngTemplateOutlet",i.selectedItemTemplate||i._selectedItemTemplate)("ngTemplateOutletContext",vt(18,cm,e))}}function rE(t,r){if(t&1){let e=pe();d(0,"ul",24,3),ee("focus",function(i){O(e);let o=h();return B(o.onMultipleContainerFocus(i))})("blur",function(i){O(e);let o=h();return B(o.onMultipleContainerBlur(i))})("keydown",function(i){O(e);let o=h();return B(o.onMultipleContainerKeyDown(i))}),P(2,tE,6,20,"li",25),d(3,"li",26)(4,"input",27,4),ee("input",function(i){O(e);let o=h();return B(o.onInput(i))})("keydown",function(i){O(e);let o=h();return B(o.onKeyDown(i))})("change",function(i){O(e);let o=h();return B(o.onInputChange(i))})("focus",function(i){O(e);let o=h();return B(o.onInputFocus(i))})("blur",function(i){O(e);let o=h();return B(o.onInputBlur(i))})("paste",function(i){O(e);let o=h();return B(o.onInputPaste(i))})("keyup",function(i){O(e);let o=h();return B(o.onInputKeyUp(i))}),u()()()}if(t&2){let e=h();_e(e.cx("inputMultiple")),g("pBind",e.ptm("inputMultiple"))("tabindex",-1),Ue("aria-orientation","horizontal")("aria-activedescendant",e.focused?e.focusedMultipleOptionId:void 0),p(2),g("ngForOf",e.modelValue()),p(),_e(e.cx("inputChip")),g("pBind",e.ptm("inputChip")),p(),_e(e.cx("pcInputText")),g("pAutoFocus",e.autofocus)("pBind",e.ptm("input"))("ngStyle",e.inputStyle),Ue("type",e.type)("id",e.inputId)("autocomplete",e.autocomplete)("name",e.name())("minlength",e.minlength())("maxlength",e.maxlength())("size",e.size())("min",e.min())("max",e.max())("pattern",e.pattern())("placeholder",e.$filled()?null:e.placeholder)("tabindex",e.$disabled()?-1:e.tabindex)("required",e.required()?"":void 0)("readonly",e.readonly?"":void 0)("disabled",e.$disabled()?"":void 0)("aria-label",e.ariaLabel)("aria-labelledby",e.ariaLabelledBy)("aria-required",e.required())("aria-expanded",e.overlayVisible??!1)("aria-controls",e.overlayVisible?e.id+"_list":null)("aria-activedescendant",e.focused?e.focusedOptionId:void 0)}}function iE(t,r){if(t&1&&($t(),Y(0,"svg",35)),t&2){let e=h(2);_e(e.cx("loader")),g("pBind",e.ptm("loader"))("spin",!0),Ue("aria-hidden",!0)}}function nE(t,r){}function oE(t,r){t&1&&P(0,nE,0,0,"ng-template")}function aE(t,r){if(t&1&&(d(0,"span",32),P(1,oE,1,0,null,23),u()),t&2){let e=h(2);_e(e.cx("loader")),g("pBind",e.ptm("loader")),Ue("aria-hidden",!0),p(),g("ngTemplateOutlet",e.loadingIconTemplate||e._loadingIconTemplate)}}function sE(t,r){if(t&1&&(Le(0),P(1,iE,1,5,"svg",33)(2,aE,2,5,"span",34),Ne()),t&2){let e=h();p(),g("ngIf",!e.loadingIconTemplate&&!e._loadingIconTemplate),p(),g("ngIf",e.loadingIconTemplate||e._loadingIconTemplate)}}function lE(t,r){if(t&1&&Y(0,"span",38),t&2){let e=h(2);g("ngClass",e.dropdownIcon),Ue("aria-hidden",!0)}}function cE(t,r){if(t&1&&($t(),Y(0,"svg",40)),t&2){let e=h(3);g("pBind",e.ptm("dropdown"))}}function uE(t,r){}function dE(t,r){t&1&&P(0,uE,0,0,"ng-template")}function pE(t,r){if(t&1&&(Le(0),P(1,cE,1,1,"svg",39)(2,dE,1,0,null,23),Ne()),t&2){let e=h(2);p(),g("ngIf",!e.dropdownIconTemplate&&!e._dropdownIconTemplate),p(),g("ngTemplateOutlet",e.dropdownIconTemplate||e._dropdownIconTemplate)}}function fE(t,r){if(t&1){let e=pe();d(0,"button",36,7),ee("click",function(i){O(e);let o=h();return B(o.handleDropdownClick(i))}),P(2,lE,1,2,"span",37)(3,pE,3,2,"ng-container",14),u()}if(t&2){let e=h();_e(e.cx("dropdown")),g("pBind",e.ptm("dropdown"))("disabled",e.$disabled()),Ue("aria-label",e.dropdownAriaLabel)("tabindex",e.tabindex),p(2),g("ngIf",e.dropdownIcon),p(),g("ngIf",!e.dropdownIcon)}}function mE(t,r){t&1&&Tt(0)}function hE(t,r){t&1&&Tt(0)}function gE(t,r){if(t&1&&P(0,hE,1,0,"ng-container",29),t&2){let e=r.$implicit,n=r.options;h(2);let i=Dr(6);g("ngTemplateOutlet",i)("ngTemplateOutletContext",di(2,um,e,n))}}function _E(t,r){t&1&&Tt(0)}function xE(t,r){if(t&1&&P(0,_E,1,0,"ng-container",29),t&2){let e=r.options,n=h(4);g("ngTemplateOutlet",n.loaderTemplate||n._loaderTemplate)("ngTemplateOutletContext",vt(2,VT,e))}}function vE(t,r){t&1&&(Le(0),P(1,xE,1,4,"ng-template",null,10,Z),Ne())}function bE(t,r){if(t&1){let e=pe();d(0,"p-scroller",44,9),ee("onLazyLoad",function(i){O(e);let o=h(2);return B(o.onLazyLoad.emit(i))}),P(2,gE,1,5,"ng-template",null,1,Z)(4,vE,3,0,"ng-container",14),u()}if(t&2){let e=h(2);Qt(vt(9,wl,e.scrollHeight)),g("pt",e.ptm("virtualScroller"))("items",e.visibleOptions())("itemSize",e.virtualScrollItemSize)("autoSize",!0)("lazy",e.lazy)("options",e.virtualScrollOptions),p(4),g("ngIf",e.loaderTemplate||e._loaderTemplate)}}function yE(t,r){t&1&&Tt(0)}function CE(t,r){if(t&1&&(Le(0),P(1,yE,1,0,"ng-container",29),Ne()),t&2){h();let e=Dr(6),n=h();p(),g("ngTemplateOutlet",e)("ngTemplateOutletContext",di(3,um,n.visibleOptions(),Je(2,zT)))}}function wE(t,r){if(t&1&&(d(0,"span"),v(1),u()),t&2){let e=h(2).$implicit,n=h(3);p(),he(n.getOptionGroupLabel(e.optionGroup))}}function SE(t,r){t&1&&Tt(0)}function kE(t,r){if(t&1&&(Le(0),d(1,"li",48),P(2,wE,2,1,"span",14)(3,SE,1,0,"ng-container",29),u(),Ne()),t&2){let e=h(),n=e.$implicit,i=e.index,o=h().options,a=h(2);p(),_e(a.cx("optionGroup")),g("pBind",a.ptm("optionGroup"))("ngStyle",vt(8,wl,o.itemSize+"px")),Ue("id",a.id+"_"+a.getOptionIndex(i,o)),p(),g("ngIf",!a.groupTemplate),p(),g("ngTemplateOutlet",a.groupTemplate)("ngTemplateOutletContext",vt(10,cm,n.optionGroup))}}function TE(t,r){if(t&1&&(d(0,"span"),v(1),u()),t&2){let e=h(2).$implicit,n=h(3);p(),he(n.getOptionLabel(e))}}function EE(t,r){t&1&&Tt(0)}function IE(t,r){if(t&1){let e=pe();Le(0),d(1,"li",49),ee("click",function(i){O(e);let o=h().$implicit,a=h(3);return B(a.onOptionSelect(i,o))})("mouseenter",function(i){O(e);let o=h().index,a=h().options,l=h(2);return B(l.onOptionMouseEnter(i,l.getOptionIndex(o,a)))}),P(2,TE,2,1,"span",14)(3,EE,1,0,"ng-container",29),u(),Ne()}if(t&2){let e=h(),n=e.$implicit,i=e.index,o=h().options,a=h(2);p(),_e(a.cx("option",fo(14,UT,n,i,o))),g("pBind",a.getPTOptions(n,o,i,"option"))("ngStyle",vt(18,wl,o.itemSize+"px")),Ue("id",a.id+"_"+a.getOptionIndex(i,o))("aria-label",a.getOptionLabel(n))("aria-selected",a.isSelected(n))("aria-disabled",a.isOptionDisabled(n))("data-p-focused",a.focusedOptionIndex()===a.getOptionIndex(i,o))("aria-setsize",a.ariaSetSize)("aria-posinset",a.getAriaPosInset(a.getOptionIndex(i,o))),p(),g("ngIf",!a.itemTemplate&&!a._itemTemplate),p(),g("ngTemplateOutlet",a.itemTemplate||a._itemTemplate)("ngTemplateOutletContext",di(20,WT,n,o.getOptions?o.getOptions(i):i))}}function FE(t,r){if(t&1&&P(0,kE,4,12,"ng-container",14)(1,IE,4,23,"ng-container",14),t&2){let e=r.$implicit,n=h(3);g("ngIf",n.isOptionGroup(e)),p(),g("ngIf",!n.isOptionGroup(e))}}function AE(t,r){if(t&1&&(Le(0),v(1),Ne()),t&2){let e=h(4);p(),Ie(" ",e.searchResultMessageText," ")}}function PE(t,r){t&1&&Tt(0,null,12)}function DE(t,r){if(t&1&&(d(0,"li",48),P(1,AE,2,1,"ng-container",50)(2,PE,2,0,"ng-container",23),u()),t&2){let e=h().options,n=h(2);_e(n.cx("emptyMessage")),g("pBind",n.ptm("emptyMessage"))("ngStyle",vt(7,wl,e.itemSize+"px")),p(),g("ngIf",!n.emptyTemplate&&!n._emptyTemplate)("ngIfElse",n.empty),p(),g("ngTemplateOutlet",n.emptyTemplate||n._emptyTemplate)}}function OE(t,r){if(t&1&&(d(0,"ul",45,11),P(2,FE,2,2,"ng-template",46)(3,DE,3,9,"li",47),u()),t&2){let e=r.$implicit,n=r.options,i=h(2);Qt(n.contentStyle),_e(i.cn(i.cx("list"),n.contentStyleClass)),g("pBind",i.ptm("list")),Ue("id",i.id+"_list")("aria-label",i.listLabel),p(2),g("ngForOf",e),p(),g("ngIf",!e||e&&e.length===0&&i.showEmptyMessage)}}function BE(t,r){t&1&&Tt(0)}function ME(t,r){if(t&1&&(d(0,"div",41),P(1,mE,1,0,"ng-container",23),d(2,"div",32),P(3,bE,5,11,"p-scroller",42)(4,CE,2,6,"ng-container",14),u(),P(5,OE,4,9,"ng-template",null,8,Z)(7,BE,1,0,"ng-container",23),u(),d(8,"span",43),v(9),u()),t&2){let e=h();_e(e.cn(e.cx("overlay"),e.panelStyleClass)),g("pBind",e.ptm("overlay"))("ngStyle",e.panelStyle),p(),g("ngTemplateOutlet",e.headerTemplate||e._headerTemplate),p(),_e(e.cx("listContainer")),Vi("max-height",e.virtualScroll?"auto":e.scrollHeight),g("pBind",e.ptm("listContainer")),p(),g("ngIf",e.virtualScroll),p(),g("ngIf",!e.virtualScroll),p(3),g("ngTemplateOutlet",e.footerTemplate||e._footerTemplate),p(2),Ie(" ",e.selectedMessageText," ")}}var RE=`
    ${am}

    /* For PrimeNG */
    p-autoComplete.ng-invalid.ng-dirty .p-autocomplete-input,
    p-autoComplete.ng-invalid.ng-dirty .p-autocomplete-input-multiple,
    p-auto-complete.ng-invalid.ng-dirty .p-autocomplete-input,
    p-auto-complete.ng-invalid.ng-dirty .p-autocomplete-input-multiple p-autocomplete.ng-invalid.ng-dirty .p-autocomplete-input,
    p-autocomplete.ng-invalid.ng-dirty .p-autocomplete-input-multiple {
        border-color: dt('autocomplete.invalid.border.color');
    }

    p-autoComplete.ng-invalid.ng-dirty .p-autocomplete-input:enabled:focus,
    p-autoComplete.ng-invalid.ng-dirty:not(.p-disabled).p-focus .p-autocomplete-input-multiple,
    p-auto-complete.ng-invalid.ng-dirty .p-autocomplete-input:enabled:focus,
    p-auto-complete.ng-invalid.ng-dirty:not(.p-disabled).p-focus .p-autocomplete-input-multiple,
    p-autocomplete.ng-invalid.ng-dirty .p-autocomplete-input:enabled:focus,
    p-autocomplete.ng-invalid.ng-dirty:not(.p-disabled).p-focus .p-autocomplete-input-multiple {
        border-color: dt('autocomplete.focus.border.color');
    }

    p-autoComplete.ng-invalid.ng-dirty .p-autocomplete-input-chip input::placeholder,
    p-auto-complete.ng-invalid.ng-dirty .p-autocomplete-input-chip input::placeholder,
    p-autocomplete.ng-invalid.ng-dirty .p-autocomplete-input-chip input::placeholder {
        color: dt('autocomplete.invalid.placeholder.color');
    }

    p-autoComplete.ng-invalid.ng-dirty .p-autocomplete-input::placeholder,
    p-auto-complete.ng-invalid.ng-dirty .p-autocomplete-input::placeholder,
    p-autocomplete.ng-invalid.ng-dirty .p-autocomplete-input::placeholder {
        color: dt('autocomplete.invalid.placeholder.color');
    }
`,LE={root:{position:"relative"}},NE={root:({instance:t})=>["p-autocomplete p-component p-inputwrapper",{"p-invalid":t.invalid(),"p-focus":t.focused,"p-inputwrapper-filled":t.$filled(),"p-inputwrapper-focus":t.focused&&!t.$disabled()||t.autofocus||t.overlayVisible,"p-autocomplete-open":t.overlayVisible,"p-autocomplete-clearable":t.showClear&&!t.$disabled(),"p-autocomplete-fluid":t.hasFluid}],pcInputText:"p-autocomplete-input",inputMultiple:({instance:t})=>["p-autocomplete-input-multiple",{"p-disabled":t.$disabled(),"p-variant-filled":t.$variant()==="filled"}],chipItem:({instance:t,i:r})=>["p-autocomplete-chip-item",{"p-focus":t.focusedMultipleOptionIndex()===r}],pcChip:"p-autocomplete-chip",chipIcon:"p-autocomplete-chip-icon",inputChip:"p-autocomplete-input-chip",loader:"p-autocomplete-loader",dropdown:"p-autocomplete-dropdown",overlay:({instance:t})=>["p-autocomplete-overlay p-component-overlay p-component",{"p-input-filled":t.$variant()==="filled","p-ripple-disabled":t.config.ripple()===!1}],listContainer:"p-autocomplete-list-container",list:"p-autocomplete-list",optionGroup:"p-autocomplete-option-group",option:({instance:t,option:r,i:e,scrollerOptions:n})=>({"p-autocomplete-option":!0,"p-autocomplete-option-selected":t.isSelected(r),"p-focus":t.focusedOptionIndex()===t.getOptionIndex(e,n),"p-disabled":t.isOptionDisabled(r)}),emptyMessage:"p-autocomplete-empty-message",clearIcon:"p-autocomplete-clear-icon"},sm=(()=>{class t extends ir{name="autocomplete";style=RE;classes=NE;inlineStyles=LE;static \u0275fac=(()=>{let e;return function(i){return(e||(e=ht(t)))(i||t)}})();static \u0275prov=Ye({token:t,factory:t.\u0275fac})}return t})();var lm=new wt("AUTOCOMPLETE_INSTANCE"),VE={provide:tl,useExisting:Ni(()=>Sl),multi:!0},Sl=(()=>{class t extends yd{overlayService;zone;$pcAutoComplete=we(lm,{optional:!0,skipSelf:!0})??void 0;bindDirectiveInstance=we(Ge,{self:!0});minLength=1;minQueryLength;delay=300;panelStyle;styleClass;panelStyleClass;inputStyle;inputId;inputStyleClass;placeholder;readonly;scrollHeight="200px";lazy=!1;virtualScroll;virtualScrollItemSize;virtualScrollOptions;autoHighlight;forceSelection;type="text";autoZIndex=!0;baseZIndex=0;ariaLabel;dropdownAriaLabel;ariaLabelledBy;dropdownIcon;unique=!0;group;completeOnFocus=!1;showClear=!1;dropdown;showEmptyMessage=!0;dropdownMode="blank";multiple;addOnTab=!1;tabindex;dataKey;emptyMessage;showTransitionOptions=".12s cubic-bezier(0, 0, 0.2, 1)";hideTransitionOptions=".1s linear";autofocus;autocomplete="off";optionGroupChildren="items";optionGroupLabel="label";overlayOptions;get suggestions(){return this._suggestions()}set suggestions(e){this._suggestions.set(e),this.handleSuggestionsChange()}optionLabel;optionValue;id;searchMessage;emptySelectionMessage;selectionMessage;autoOptionFocus=!1;selectOnFocus;searchLocale;optionDisabled;focusOnHover=!0;typeahead=!0;addOnBlur=!1;separator;appendTo=kr(void 0);completeMethod=new xt;onSelect=new xt;onUnselect=new xt;onAdd=new xt;onFocus=new xt;onBlur=new xt;onDropdownClick=new xt;onClear=new xt;onInputKeydown=new xt;onKeyUp=new xt;onShow=new xt;onHide=new xt;onLazyLoad=new xt;inputEL;multiInputEl;multiContainerEL;dropdownButton;itemsViewChild;scroller;overlayViewChild;itemsWrapper;itemTemplate;emptyTemplate;headerTemplate;footerTemplate;selectedItemTemplate;groupTemplate;loaderTemplate;removeIconTemplate;loadingIconTemplate;clearIconTemplate;dropdownIconTemplate;onHostClick(e){this.onContainerClick(e)}value;_suggestions=zr(null);timeout;overlayVisible;suggestionsUpdated;highlightOption;highlightOptionChanged;focused=!1;loading;scrollHandler;listId;searchTimeout;dirty=!1;_itemTemplate;_groupTemplate;_selectedItemTemplate;_headerTemplate;_emptyTemplate;_footerTemplate;_loaderTemplate;_removeIconTemplate;_loadingIconTemplate;_clearIconTemplate;_dropdownIconTemplate;focusedMultipleOptionIndex=zr(-1);focusedOptionIndex=zr(-1);_componentStyle=we(sm);$appendTo=Mt(()=>this.appendTo()||this.config.overlayAppendTo());visibleOptions=Mt(()=>this.group?this.flatOptions(this._suggestions()):this._suggestions()||[]);inputValue=Mt(()=>{let e=this.modelValue(),n=this.optionValueSelected?(this.suggestions||[]).find(i=>Xi(i,e,this.equalityKey())):e;if(Cn(e))if(typeof e=="object"||this.optionValueSelected){let i=this.getOptionLabel(n);return i??e}else return e;else return""});get focusedMultipleOptionId(){return this.focusedMultipleOptionIndex()!==-1?`${this.id}_multiple_option_${this.focusedMultipleOptionIndex()}`:null}get focusedOptionId(){return this.focusedOptionIndex()!==-1?`${this.id}_${this.focusedOptionIndex()}`:null}get searchResultMessageText(){return Cn(this.visibleOptions())&&this.overlayVisible?this.searchMessageText.replaceAll("{0}",this.visibleOptions().length):this.emptySearchMessageText}get searchMessageText(){return this.searchMessage||this.config.translation.searchMessage||""}get emptySearchMessageText(){return this.emptyMessage||this.config.translation.emptySearchMessage||""}get selectionMessageText(){return this.selectionMessage||this.config.translation.selectionMessage||""}get emptySelectionMessageText(){return this.emptySelectionMessage||this.config.translation.emptySelectionMessage||""}get selectedMessageText(){return this.hasSelectedOption()?this.selectionMessageText.replaceAll("{0}",this.multiple?this.modelValue()?.length:"1"):this.emptySelectionMessageText}get ariaSetSize(){return this.visibleOptions().filter(e=>!this.isOptionGroup(e)).length}get listLabel(){return this.config.getTranslation(qr.ARIA).listLabel}get virtualScrollerDisabled(){return!this.virtualScroll}get optionValueSelected(){return typeof this.modelValue()=="string"&&this.optionValue}chipItemClass(e){return this._componentStyle.classes.chipItem({instance:this,i:e})}constructor(e,n){super(),this.overlayService=e,this.zone=n}onInit(){this.id=this.id||un("pn_id_"),this.cd.detectChanges()}templates;onAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"item":this._itemTemplate=e.template;break;case"group":this._groupTemplate=e.template;break;case"selecteditem":this._selectedItemTemplate=e.template;break;case"selectedItem":this._selectedItemTemplate=e.template;break;case"header":this._headerTemplate=e.template;break;case"empty":this._emptyTemplate=e.template;break;case"footer":this._footerTemplate=e.template;break;case"loader":this._loaderTemplate=e.template;break;case"removetokenicon":this._removeIconTemplate=e.template;break;case"loadingicon":this._loadingIconTemplate=e.template;break;case"clearicon":this._clearIconTemplate=e.template;break;case"dropdownicon":this._dropdownIconTemplate=e.template;break;default:this._itemTemplate=e.template;break}})}onAfterViewChecked(){this.bindDirectiveInstance.setAttrs(this.ptms(["host","root"])),this.suggestionsUpdated&&this.overlayViewChild&&this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.overlayViewChild&&this.overlayViewChild.alignOverlay()},1),this.suggestionsUpdated=!1})}handleSuggestionsChange(){if(this.loading){this._suggestions()?.length>0||this.showEmptyMessage||this.emptyTemplate?this.show():this.hide();let e=this.overlayVisible&&this.autoOptionFocus?this.findFirstFocusedOptionIndex():-1;this.focusedOptionIndex.set(e),this.suggestionsUpdated=!0,this.loading=!1,this.cd.markForCheck()}}flatOptions(e){return(e||[]).reduce((n,i,o)=>{n.push({optionGroup:i,group:!0,index:o});let a=this.getOptionGroupChildren(i);return a&&a.forEach(l=>n.push(l)),n},[])}isOptionGroup(e){return this.optionGroupLabel&&e.optionGroup&&e.group}findFirstOptionIndex(){return this.visibleOptions().findIndex(e=>this.isValidOption(e))}findLastOptionIndex(){return Ao(this.visibleOptions(),e=>this.isValidOption(e))}findFirstFocusedOptionIndex(){let e=this.findSelectedOptionIndex();return e<0?this.findFirstOptionIndex():e}findLastFocusedOptionIndex(){let e=this.findSelectedOptionIndex();return e<0?this.findLastOptionIndex():e}findSelectedOptionIndex(){return this.hasSelectedOption()?this.visibleOptions().findIndex(e=>this.isValidSelectedOption(e)):-1}findNextOptionIndex(e){let n=e<this.visibleOptions().length-1?this.visibleOptions().slice(e+1).findIndex(i=>this.isValidOption(i)):-1;return n>-1?n+e+1:e}findPrevOptionIndex(e){let n=e>0?Ao(this.visibleOptions().slice(0,e),i=>this.isValidOption(i)):-1;return n>-1?n:e}isValidSelectedOption(e){return this.isValidOption(e)&&this.isSelected(e)}isValidOption(e){return e&&!(this.isOptionDisabled(e)||this.isOptionGroup(e))}isOptionDisabled(e){return this.optionDisabled?cn(e,this.optionDisabled):!1}isSelected(e){return this.multiple?this.unique?this.modelValue()?.some(n=>Xi(n,e,this.equalityKey())):!1:Xi(this.modelValue(),e,this.equalityKey())}isOptionMatched(e,n){return this.isValidOption(e)&&this.getOptionLabel(e).toLocaleLowerCase(this.searchLocale)===n.toLocaleLowerCase(this.searchLocale)}isInputClicked(e){return e.target===this.inputEL?.nativeElement}isDropdownClicked(e){return this.dropdownButton?.nativeElement?e.target===this.dropdownButton.nativeElement||this.dropdownButton.nativeElement.contains(e.target):!1}equalityKey(){return this.optionValue?void 0:this.dataKey}onContainerClick(e){this.$disabled()||this.loading||this.isInputClicked(e)||this.isDropdownClicked(e)||(!this.overlayViewChild||!this.overlayViewChild.overlayViewChild?.nativeElement.contains(e.target))&&Jr(this.inputEL?.nativeElement)}handleDropdownClick(e){let n;this.overlayVisible?this.hide(!0):(Jr(this.inputEL?.nativeElement),n=this.inputEL?.nativeElement?.value,this.dropdownMode==="blank"?this.search(e,"","dropdown"):this.dropdownMode==="current"&&this.search(e,n,"dropdown")),this.onDropdownClick.emit({originalEvent:e,query:n})}onInput(e){if(this.typeahead){let n=this.minQueryLength||this.minLength;this.searchTimeout&&clearTimeout(this.searchTimeout);let i=e.target.value;this.maxlength()!==null&&(i=i.split("").slice(0,this.maxlength()).join("")),!this.multiple&&!this.forceSelection&&this.updateModel(i),i.length===0&&!this.multiple?(this.onClear.emit(),setTimeout(()=>{this.hide()},this.delay/2)):i.length>=n?(this.focusedOptionIndex.set(-1),this.searchTimeout=setTimeout(()=>{this.search(e,i,"input")},this.delay)):this.hide()}}onInputChange(e){if(this.forceSelection){let n=!1;if(this.visibleOptions()){let i=this.visibleOptions().find(o=>this.isOptionMatched(o,this.inputEL?.nativeElement?.value||""));i!==void 0&&(n=!0,!this.isSelected(i)&&this.onOptionSelect(e,i))}n||(this.inputEL?.nativeElement&&(this.inputEL.nativeElement.value=""),!this.multiple&&this.updateModel(null))}}onInputFocus(e){if(this.$disabled())return;!this.dirty&&this.completeOnFocus&&this.search(e,e.target.value,"focus"),this.dirty=!0,this.focused=!0;let n=this.focusedOptionIndex()!==-1?this.focusedOptionIndex():this.overlayVisible&&this.autoOptionFocus?this.findFirstFocusedOptionIndex():-1;this.focusedOptionIndex.set(n),this.overlayVisible&&this.scrollInView(this.focusedOptionIndex()),this.onFocus.emit(e)}onMultipleContainerFocus(e){this.$disabled()||(this.focused=!0)}onMultipleContainerBlur(e){this.focusedMultipleOptionIndex.set(-1),this.focused=!1}onMultipleContainerKeyDown(e){if(this.$disabled()){e.preventDefault();return}switch(e.code){case"ArrowLeft":this.onArrowLeftKeyOnMultiple(e);break;case"ArrowRight":this.onArrowRightKeyOnMultiple(e);break;case"Backspace":this.onBackspaceKeyOnMultiple(e);break;default:break}}onInputBlur(e){if(this.dirty=!1,this.focused=!1,this.focusedOptionIndex.set(-1),this.addOnBlur&&this.multiple&&!this.typeahead){let n=(this.multiInputEl?.nativeElement?.value||e.target.value||"").trim();n&&!this.isSelected(n)&&(this.updateModel([...this.modelValue()||[],n]),this.onAdd.emit({originalEvent:e,value:n}),this.multiInputEl?.nativeElement?this.multiInputEl.nativeElement.value="":e.target.value="")}this.onModelTouched(),this.onBlur.emit(e)}onInputPaste(e){if(this.separator&&this.multiple&&!this.typeahead){let n=(e.clipboardData||window.clipboardData)?.getData("Text");if(n){let i=n.split(this.separator),o=[...this.modelValue()||[]];if(i.forEach(a=>{let l=a.trim();l&&!this.isSelected(l)&&o.push(l)}),o.length>(this.modelValue()||[]).length){let a=o.slice((this.modelValue()||[]).length);this.updateModel(o),a.forEach(l=>{this.onAdd.emit({originalEvent:e,value:l})}),this.multiInputEl?.nativeElement?this.multiInputEl.nativeElement.value="":e.target.value="",e.preventDefault()}}}else this.onKeyDown(e)}onInputKeyUp(e){this.onKeyUp.emit(e)}onKeyDown(e){if(this.$disabled()){e.preventDefault();return}switch(this.onInputKeydown.emit(e),e.code){case"ArrowDown":this.onArrowDownKey(e);break;case"ArrowUp":this.onArrowUpKey(e);break;case"ArrowLeft":this.onArrowLeftKey(e);break;case"ArrowRight":this.onArrowRightKey(e);break;case"Home":this.onHomeKey(e);break;case"End":this.onEndKey(e);break;case"PageDown":this.onPageDownKey(e);break;case"PageUp":this.onPageUpKey(e);break;case"Enter":case"NumpadEnter":this.onEnterKey(e);break;case"Escape":this.onEscapeKey(e);break;case"Tab":this.onTabKey(e);break;case"Backspace":this.onBackspaceKey(e);break;case"ShiftLeft":case"ShiftRight":break;default:this.handleSeparatorKey(e);break}}handleSeparatorKey(e){if(this.separator&&this.multiple&&!this.typeahead&&(this.separator===e.key||typeof this.separator=="string"&&e.key===this.separator||this.separator instanceof RegExp&&e.key.match(this.separator))){let n=(this.multiInputEl?.nativeElement?.value||e.target.value||"").trim();n&&!this.isSelected(n)&&(this.updateModel([...this.modelValue()||[],n]),this.onAdd.emit({originalEvent:e,value:n}),this.multiInputEl?.nativeElement?this.multiInputEl.nativeElement.value="":e.target.value="",e.preventDefault())}}onArrowDownKey(e){if(!this.overlayVisible)return;let n=this.focusedOptionIndex()!==-1?this.findNextOptionIndex(this.focusedOptionIndex()):this.findFirstFocusedOptionIndex();this.changeFocusedOptionIndex(e,n),e.preventDefault(),e.stopPropagation()}onArrowUpKey(e){if(this.overlayVisible)if(e.altKey)this.focusedOptionIndex()!==-1&&this.onOptionSelect(e,this.visibleOptions()[this.focusedOptionIndex()]),this.overlayVisible&&this.hide(),e.preventDefault();else{let n=this.focusedOptionIndex()!==-1?this.findPrevOptionIndex(this.focusedOptionIndex()):this.findLastFocusedOptionIndex();this.changeFocusedOptionIndex(e,n),e.preventDefault(),e.stopPropagation()}}onArrowLeftKey(e){let n=e.currentTarget;this.focusedOptionIndex.set(-1),this.multiple&&(Uc(n.value)&&this.hasSelectedOption()?(Jr(this.multiContainerEL?.nativeElement),this.focusedMultipleOptionIndex.set(this.modelValue().length)):e.stopPropagation())}onArrowRightKey(e){this.focusedOptionIndex.set(-1),this.multiple&&e.stopPropagation()}onHomeKey(e){let{currentTarget:n}=e,i=n.value.length;n.setSelectionRange(0,e.shiftKey?i:0),this.focusedOptionIndex.set(-1),e.preventDefault()}onEndKey(e){let{currentTarget:n}=e,i=n.value.length;n.setSelectionRange(e.shiftKey?0:i,i),this.focusedOptionIndex.set(-1),e.preventDefault()}onPageDownKey(e){this.scrollInView(this.visibleOptions().length-1),e.preventDefault()}onPageUpKey(e){this.scrollInView(0),e.preventDefault()}onEnterKey(e){if(!this.typeahead&&!this.forceSelection&&this.multiple){let n=e.target.value?.trim();n&&!this.isSelected(n)&&(this.updateModel([...this.modelValue()||[],n]),this.inputEL?.nativeElement&&(this.inputEL.nativeElement.value=""))}if(this.overlayVisible)this.focusedOptionIndex()!==-1&&this.onOptionSelect(e,this.visibleOptions()[this.focusedOptionIndex()]),this.hide();else return;e.preventDefault()}onEscapeKey(e){this.overlayVisible&&this.hide(!0),e.preventDefault()}onTabKey(e){if(this.focusedOptionIndex()!==-1){this.onOptionSelect(e,this.visibleOptions()[this.focusedOptionIndex()]);return}if(this.multiple&&!this.typeahead){let n=(this.multiInputEl?.nativeElement?.value||this.inputEL?.nativeElement?.value||"").trim();if(this.addOnTab&&n&&!this.isSelected(n)){this.updateModel([...this.modelValue()||[],n]),this.onAdd.emit({originalEvent:e,value:n}),this.multiInputEl?.nativeElement?this.multiInputEl.nativeElement.value="":this.inputEL?.nativeElement&&(this.inputEL.nativeElement.value=""),this.updateInputValue(),e.preventDefault(),this.overlayVisible&&this.hide();return}}this.overlayVisible&&this.hide()}onBackspaceKey(e){if(this.multiple){if(Cn(this.modelValue())&&!this.inputEL?.nativeElement?.value){let n=this.modelValue()[this.modelValue().length-1],i=this.modelValue().slice(0,-1);this.updateModel(i),this.onUnselect.emit({originalEvent:e,value:n})}e.stopPropagation()}}onArrowLeftKeyOnMultiple(e){let n=this.focusedMultipleOptionIndex()<1?0:this.focusedMultipleOptionIndex()-1;this.focusedMultipleOptionIndex.set(n)}onArrowRightKeyOnMultiple(e){let n=this.focusedMultipleOptionIndex();n++,this.focusedMultipleOptionIndex.set(n),n>this.modelValue().length-1&&(this.focusedMultipleOptionIndex.set(-1),Jr(this.inputEL?.nativeElement))}onBackspaceKeyOnMultiple(e){this.focusedMultipleOptionIndex()!==-1&&this.removeOption(e,this.focusedMultipleOptionIndex())}onOptionSelect(e,n,i=!0){this.multiple?(this.inputEL?.nativeElement&&(this.inputEL.nativeElement.value=""),this.isSelected(n)||this.updateModel([...this.modelValue()||[],n])):this.updateModel(n),this.onSelect.emit({originalEvent:e,value:n}),i&&this.hide(!0)}onOptionMouseEnter(e,n){this.focusOnHover&&this.changeFocusedOptionIndex(e,n)}search(e,n,i){n!=null&&(i==="input"&&n.trim().length===0||(this.loading=!0,this.completeMethod.emit({originalEvent:e,query:n})))}removeOption(e,n){e.stopPropagation();let i=this.modelValue()[n],o=this.modelValue().filter((a,l)=>l!==n);this.updateModel(o),this.onUnselect.emit({originalEvent:e,value:i}),Jr(this.inputEL?.nativeElement)}updateModel(e){let n=this.multiple?e.map(i=>this.getOptionValue(i)):this.getOptionValue(e);this.value=n,this.writeModelValue(e),this.onModelChange(n),this.updateInputValue(),this.cd.markForCheck()}updateInputValue(){this.inputEL&&this.inputEL.nativeElement&&(this.multiple?this.inputEL.nativeElement.value="":this.inputEL.nativeElement.value=this.inputValue())}autoUpdateModel(){if((this.selectOnFocus||this.autoHighlight)&&this.autoOptionFocus&&!this.hasSelectedOption()){let e=this.findFirstFocusedOptionIndex();this.focusedOptionIndex.set(e),this.onOptionSelect(null,this.visibleOptions()[this.focusedOptionIndex()],!1)}}scrollInView(e=-1){let n=e!==-1?`${this.id}_${e}`:this.focusedOptionId;if(this.itemsViewChild&&this.itemsViewChild.nativeElement){let i=Xr(this.itemsViewChild.nativeElement,`li[id="${n}"]`);i?i.scrollIntoView&&i.scrollIntoView({block:"nearest",inline:"nearest"}):this.virtualScrollerDisabled||setTimeout(()=>{this.virtualScroll&&this.scroller?.scrollToIndex(e!==-1?e:this.focusedOptionIndex())},0)}}changeFocusedOptionIndex(e,n){this.focusedOptionIndex()!==n&&(this.focusedOptionIndex.set(n),this.scrollInView(),this.selectOnFocus&&this.onOptionSelect(e,this.visibleOptions()[n],!1))}show(e=!1){this.dirty=!0,this.overlayVisible=!0;let n=this.focusedOptionIndex()!==-1?this.focusedOptionIndex():this.autoOptionFocus?this.findFirstFocusedOptionIndex():-1;this.focusedOptionIndex.set(n),e&&Jr(this.inputEL?.nativeElement),e&&Jr(this.inputEL?.nativeElement),this.onShow.emit(),this.cd.markForCheck()}hide(e=!1){let n=()=>{this.dirty=e,this.overlayVisible=!1,this.focusedOptionIndex.set(-1),e&&Jr(this.inputEL?.nativeElement),this.onHide.emit(),this.cd.markForCheck()};setTimeout(()=>{n()},0)}clear(){this.updateModel(null),this.inputEL?.nativeElement&&(this.inputEL.nativeElement.value=""),this.onClear.emit()}hasSelectedOption(){return Cn(this.modelValue())}getAriaPosInset(e){return(this.optionGroupLabel?e-this.visibleOptions().slice(0,e).filter(n=>this.isOptionGroup(n)).length:e)+1}getOptionLabel(e){return this.optionLabel?cn(e,this.optionLabel):e&&e.label!=null?e.label:e}getOptionValue(e){return this.optionValue?cn(e,this.optionValue):e&&e.value!=null?e.value:e}getOptionIndex(e,n){return this.virtualScrollerDisabled?e:n&&n.getItemOptions(e).index}getOptionGroupLabel(e){return this.optionGroupLabel?cn(e,this.optionGroupLabel):e&&e.label!=null?e.label:e}getOptionGroupChildren(e){return this.optionGroupChildren?cn(e,this.optionGroupChildren):e.items}getPTOptions(e,n,i,o){return this.ptm(o,{context:{option:e,index:this.getOptionIndex(i,n),selected:this.isSelected(e),focused:this.focusedOptionIndex()===this.getOptionIndex(i,n),disabled:this.isOptionDisabled(e)}})}onOverlayAnimationStart(e){if(e.toState==="visible"&&(this.itemsWrapper=Xr(this.overlayViewChild.overlayViewChild?.nativeElement,this.virtualScroll?".p-scroller":".p-autocomplete-panel"),this.virtualScroll&&(this.scroller?.setContentEl(this.itemsViewChild?.nativeElement),this.scroller?.viewInit()),this.visibleOptions()&&this.visibleOptions().length))if(this.virtualScroll){let n=this.modelValue()?this.focusedOptionIndex():-1;n!==-1&&this.scroller?.scrollToIndex(n)}else{let n=Xr(this.itemsWrapper,".p-autocomplete-item.p-highlight");n&&n.scrollIntoView({block:"nearest",inline:"center"})}}writeControlValue(e,n){let i=this.multiple?this.visibleOptions().filter(o=>e?.some(a=>Xi(a,o,this.equalityKey()))):this.visibleOptions().find(o=>Xi(e,o,this.equalityKey()));this.value=e,n(Uc(i)?e:i),this.updateInputValue(),this.cd.markForCheck()}onDestroy(){this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null)}static \u0275fac=function(n){return new(n||t)(Pe(Ys),Pe(Pn))};static \u0275cmp=He({type:t,selectors:[["p-autoComplete"],["p-autocomplete"],["p-auto-complete"]],contentQueries:function(n,i,o){if(n&1&&(Ke(o,vT,5),Ke(o,bT,5),Ke(o,yT,5),Ke(o,CT,5),Ke(o,wT,5),Ke(o,ST,5),Ke(o,kT,5),Ke(o,TT,5),Ke(o,ET,5),Ke(o,IT,5),Ke(o,FT,5),Ke(o,pi,4)),n&2){let a;Te(a=Ee())&&(i.itemTemplate=a.first),Te(a=Ee())&&(i.emptyTemplate=a.first),Te(a=Ee())&&(i.headerTemplate=a.first),Te(a=Ee())&&(i.footerTemplate=a.first),Te(a=Ee())&&(i.selectedItemTemplate=a.first),Te(a=Ee())&&(i.groupTemplate=a.first),Te(a=Ee())&&(i.loaderTemplate=a.first),Te(a=Ee())&&(i.removeIconTemplate=a.first),Te(a=Ee())&&(i.loadingIconTemplate=a.first),Te(a=Ee())&&(i.clearIconTemplate=a.first),Te(a=Ee())&&(i.dropdownIconTemplate=a.first),Te(a=Ee())&&(i.templates=a)}},viewQuery:function(n,i){if(n&1&&(Nt(AT,5),Nt(PT,5),Nt(DT,5),Nt(OT,5),Nt(BT,5),Nt(MT,5),Nt(RT,5)),n&2){let o;Te(o=Ee())&&(i.inputEL=o.first),Te(o=Ee())&&(i.multiInputEl=o.first),Te(o=Ee())&&(i.multiContainerEL=o.first),Te(o=Ee())&&(i.dropdownButton=o.first),Te(o=Ee())&&(i.itemsViewChild=o.first),Te(o=Ee())&&(i.scroller=o.first),Te(o=Ee())&&(i.overlayViewChild=o.first)}},hostVars:4,hostBindings:function(n,i){n&1&&ee("click",function(a){return i.onHostClick(a)}),n&2&&(Qt(i.sx("root")),_e(i.cn(i.cx("root"),i.styleClass)))},inputs:{minLength:[2,"minLength","minLength",Or],minQueryLength:[2,"minQueryLength","minQueryLength",Or],delay:[2,"delay","delay",Or],panelStyle:"panelStyle",styleClass:"styleClass",panelStyleClass:"panelStyleClass",inputStyle:"inputStyle",inputId:"inputId",inputStyleClass:"inputStyleClass",placeholder:"placeholder",readonly:[2,"readonly","readonly",$e],scrollHeight:"scrollHeight",lazy:[2,"lazy","lazy",$e],virtualScroll:[2,"virtualScroll","virtualScroll",$e],virtualScrollItemSize:[2,"virtualScrollItemSize","virtualScrollItemSize",Or],virtualScrollOptions:"virtualScrollOptions",autoHighlight:[2,"autoHighlight","autoHighlight",$e],forceSelection:[2,"forceSelection","forceSelection",$e],type:"type",autoZIndex:[2,"autoZIndex","autoZIndex",$e],baseZIndex:[2,"baseZIndex","baseZIndex",Or],ariaLabel:"ariaLabel",dropdownAriaLabel:"dropdownAriaLabel",ariaLabelledBy:"ariaLabelledBy",dropdownIcon:"dropdownIcon",unique:[2,"unique","unique",$e],group:[2,"group","group",$e],completeOnFocus:[2,"completeOnFocus","completeOnFocus",$e],showClear:[2,"showClear","showClear",$e],dropdown:[2,"dropdown","dropdown",$e],showEmptyMessage:[2,"showEmptyMessage","showEmptyMessage",$e],dropdownMode:"dropdownMode",multiple:[2,"multiple","multiple",$e],addOnTab:[2,"addOnTab","addOnTab",$e],tabindex:[2,"tabindex","tabindex",Or],dataKey:"dataKey",emptyMessage:"emptyMessage",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",autofocus:[2,"autofocus","autofocus",$e],autocomplete:"autocomplete",optionGroupChildren:"optionGroupChildren",optionGroupLabel:"optionGroupLabel",overlayOptions:"overlayOptions",suggestions:"suggestions",optionLabel:"optionLabel",optionValue:"optionValue",id:"id",searchMessage:"searchMessage",emptySelectionMessage:"emptySelectionMessage",selectionMessage:"selectionMessage",autoOptionFocus:[2,"autoOptionFocus","autoOptionFocus",$e],selectOnFocus:[2,"selectOnFocus","selectOnFocus",$e],searchLocale:[2,"searchLocale","searchLocale",$e],optionDisabled:"optionDisabled",focusOnHover:[2,"focusOnHover","focusOnHover",$e],typeahead:[2,"typeahead","typeahead",$e],addOnBlur:[2,"addOnBlur","addOnBlur",$e],separator:"separator",appendTo:[1,"appendTo"]},outputs:{completeMethod:"completeMethod",onSelect:"onSelect",onUnselect:"onUnselect",onAdd:"onAdd",onFocus:"onFocus",onBlur:"onBlur",onDropdownClick:"onDropdownClick",onClear:"onClear",onInputKeydown:"onInputKeydown",onKeyUp:"onKeyUp",onShow:"onShow",onHide:"onHide",onLazyLoad:"onLazyLoad"},features:[Dt([VE,sm,{provide:lm,useExisting:t},{provide:Jt,useExisting:t}]),Xt([Ge]),lt],decls:9,vars:13,consts:[["overlay",""],["content",""],["focusInput",""],["multiContainer",""],["focusInput","","multiIn",""],["token",""],["removeicon",""],["ddBtn",""],["buildInItems",""],["scroller",""],["loader",""],["items",""],["empty",""],["pInputText","","aria-autocomplete","list","role","combobox",3,"pAutoFocus","pt","class","ngStyle","variant","invalid","pSize","fluid","input","keydown","change","focus","blur","paste","keyup",4,"ngIf"],[4,"ngIf"],["role","listbox",3,"pBind","class","tabindex","focus","blur","keydown",4,"ngIf"],["type","button","pRipple","",3,"pBind","class","disabled","click",4,"ngIf"],[3,"visibleChange","onAnimationStart","onHide","pt","hostAttrSelector","visible","options","target","appendTo","showTransitionOptions","hideTransitionOptions"],["pInputText","","aria-autocomplete","list","role","combobox",3,"input","keydown","change","focus","blur","paste","keyup","pAutoFocus","pt","ngStyle","variant","invalid","pSize","fluid"],["data-p-icon","times",3,"pBind","class","click",4,"ngIf"],[3,"pBind","class","click",4,"ngIf"],["data-p-icon","times",3,"click","pBind"],[3,"click","pBind"],[4,"ngTemplateOutlet"],["role","listbox",3,"focus","blur","keydown","pBind","tabindex"],["role","option",3,"pBind","class",4,"ngFor","ngForOf"],["role","option",3,"pBind"],["role","combobox","aria-autocomplete","list",3,"input","keydown","change","focus","blur","paste","keyup","pAutoFocus","pBind","ngStyle"],[3,"onRemove","pt","label","disabled","removable"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"pBind",4,"ngIf"],["data-p-icon","times-circle"],[3,"pBind"],["data-p-icon","spinner",3,"pBind","class","spin",4,"ngIf"],[3,"pBind","class",4,"ngIf"],["data-p-icon","spinner",3,"pBind","spin"],["type","button","pRipple","",3,"click","pBind","disabled"],[3,"ngClass",4,"ngIf"],[3,"ngClass"],["data-p-icon","chevron-down",3,"pBind",4,"ngIf"],["data-p-icon","chevron-down",3,"pBind"],[3,"pBind","ngStyle"],[3,"pt","items","style","itemSize","autoSize","lazy","options","onLazyLoad",4,"ngIf"],["role","status","aria-live","polite",1,"p-hidden-accessible"],[3,"onLazyLoad","pt","items","itemSize","autoSize","lazy","options"],["role","listbox",3,"pBind"],["ngFor","",3,"ngForOf"],["role","option",3,"pBind","class","ngStyle",4,"ngIf"],["role","option",3,"pBind","ngStyle"],["pRipple","","role","option",3,"click","mouseenter","pBind","ngStyle"],[4,"ngIf","ngIfElse"]],template:function(n,i){if(n&1){let o=pe();P(0,jT,2,31,"input",13)(1,XT,3,2,"ng-container",14)(2,rE,7,36,"ul",15)(3,sE,3,2,"ng-container",14)(4,fE,4,8,"button",16),d(5,"p-overlay",17,0),Fe("visibleChange",function(l){return O(o),ke(i.overlayVisible,l)||(i.overlayVisible=l),B(l)}),ee("onAnimationStart",function(l){return O(o),B(i.onOverlayAnimationStart(l))})("onHide",function(){return O(o),B(i.hide())}),P(7,ME,10,14,"ng-template",null,1,Z),u()}n&2&&(g("ngIf",!i.multiple),p(),g("ngIf",i.$filled()&&!i.$disabled()&&i.showClear&&!i.loading),p(),g("ngIf",i.multiple),p(),g("ngIf",i.loading),p(),g("ngIf",i.dropdown),p(),g("pt",i.ptm("pcOverlay"))("hostAttrSelector",i.$attrSelector),Se("visible",i.overlayVisible),g("options",i.overlayOptions)("target","@parent")("appendTo",i.$appendTo())("showTransitionOptions",i.showTransitionOptions)("hideTransitionOptions",i.hideTransitionOptions))},dependencies:[et,Br,Mr,bt,Rr,zn,ul,Yi,Dn,dl,ll,ol,md,Ta,Cl,It,ho,Er,Ge],encapsulation:2,changeDetection:0})}return t})(),dm=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=hr({type:t});static \u0275inj=mr({imports:[Sl,It,It]})}return t})();var pm=`
    .p-tabs {
        display: flex;
        flex-direction: column;
    }

    .p-tablist {
        display: flex;
        position: relative;
        overflow: hidden;
        background: dt('tabs.tablist.background');
    }

    .p-tablist-viewport {
        overflow-x: auto;
        overflow-y: hidden;
        scroll-behavior: smooth;
        scrollbar-width: none;
        overscroll-behavior: contain auto;
    }

    .p-tablist-viewport::-webkit-scrollbar {
        display: none;
    }

    .p-tablist-tab-list {
        position: relative;
        display: flex;
        border-style: solid;
        border-color: dt('tabs.tablist.border.color');
        border-width: dt('tabs.tablist.border.width');
    }

    .p-tablist-content {
        flex-grow: 1;
    }

    .p-tablist-nav-button {
        all: unset;
        position: absolute !important;
        flex-shrink: 0;
        inset-block-start: 0;
        z-index: 2;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        background: dt('tabs.nav.button.background');
        color: dt('tabs.nav.button.color');
        width: dt('tabs.nav.button.width');
        transition:
            color dt('tabs.transition.duration'),
            outline-color dt('tabs.transition.duration'),
            box-shadow dt('tabs.transition.duration');
        box-shadow: dt('tabs.nav.button.shadow');
        outline-color: transparent;
        cursor: pointer;
    }

    .p-tablist-nav-button:focus-visible {
        z-index: 1;
        box-shadow: dt('tabs.nav.button.focus.ring.shadow');
        outline: dt('tabs.nav.button.focus.ring.width') dt('tabs.nav.button.focus.ring.style') dt('tabs.nav.button.focus.ring.color');
        outline-offset: dt('tabs.nav.button.focus.ring.offset');
    }

    .p-tablist-nav-button:hover {
        color: dt('tabs.nav.button.hover.color');
    }

    .p-tablist-prev-button {
        inset-inline-start: 0;
    }

    .p-tablist-next-button {
        inset-inline-end: 0;
    }

    .p-tablist-prev-button:dir(rtl),
    .p-tablist-next-button:dir(rtl) {
        transform: rotate(180deg);
    }

    .p-tab {
        flex-shrink: 0;
        cursor: pointer;
        user-select: none;
        position: relative;
        border-style: solid;
        white-space: nowrap;
        gap: dt('tabs.tab.gap');
        background: dt('tabs.tab.background');
        border-width: dt('tabs.tab.border.width');
        border-color: dt('tabs.tab.border.color');
        color: dt('tabs.tab.color');
        padding: dt('tabs.tab.padding');
        font-weight: dt('tabs.tab.font.weight');
        transition:
            background dt('tabs.transition.duration'),
            border-color dt('tabs.transition.duration'),
            color dt('tabs.transition.duration'),
            outline-color dt('tabs.transition.duration'),
            box-shadow dt('tabs.transition.duration');
        margin: dt('tabs.tab.margin');
        outline-color: transparent;
    }

    .p-tab:not(.p-disabled):focus-visible {
        z-index: 1;
        box-shadow: dt('tabs.tab.focus.ring.shadow');
        outline: dt('tabs.tab.focus.ring.width') dt('tabs.tab.focus.ring.style') dt('tabs.tab.focus.ring.color');
        outline-offset: dt('tabs.tab.focus.ring.offset');
    }

    .p-tab:not(.p-tab-active):not(.p-disabled):hover {
        background: dt('tabs.tab.hover.background');
        border-color: dt('tabs.tab.hover.border.color');
        color: dt('tabs.tab.hover.color');
    }

    .p-tab-active {
        background: dt('tabs.tab.active.background');
        border-color: dt('tabs.tab.active.border.color');
        color: dt('tabs.tab.active.color');
    }

    .p-tabpanels {
        background: dt('tabs.tabpanel.background');
        color: dt('tabs.tabpanel.color');
        padding: dt('tabs.tabpanel.padding');
        outline: 0 none;
    }

    .p-tabpanel:focus-visible {
        box-shadow: dt('tabs.tabpanel.focus.ring.shadow');
        outline: dt('tabs.tabpanel.focus.ring.width') dt('tabs.tabpanel.focus.ring.style') dt('tabs.tabpanel.focus.ring.color');
        outline-offset: dt('tabs.tabpanel.focus.ring.offset');
    }

    .p-tablist-active-bar {
        z-index: 1;
        display: block;
        position: absolute;
        inset-block-end: dt('tabs.active.bar.bottom');
        height: dt('tabs.active.bar.height');
        background: dt('tabs.active.bar.background');
        transition: 250ms cubic-bezier(0.35, 0, 0.25, 1);
    }
`;var UE=["previcon"],WE=["nexticon"],wm=["content"],jE=["prevButton"],HE=["nextButton"],$E=["inkbar"],GE=["tabs"],bs=["*"];function KE(t,r){t&1&&Tt(0)}function XE(t,r){if(t&1&&P(0,KE,1,0,"ng-container",11),t&2){let e=h(2);g("ngTemplateOutlet",e.prevIconTemplate||e._prevIconTemplate)}}function JE(t,r){t&1&&($t(),Y(0,"svg",10))}function qE(t,r){if(t&1){let e=pe();d(0,"button",9,3),ee("click",function(){O(e);let i=h();return B(i.onPrevButtonClick())}),ft(2,XE,1,1,"ng-container")(3,JE,1,0,":svg:svg",10),u()}if(t&2){let e=h();_e(e.cx("prevButton")),g("pBind",e.ptm("prevButton")),Ue("aria-label",e.prevButtonAriaLabel)("tabindex",e.tabindex())("data-pc-group-section","navigator"),p(2),mt(e.prevIconTemplate||e._prevIconTemplate?2:3)}}function QE(t,r){t&1&&Tt(0)}function YE(t,r){if(t&1&&P(0,QE,1,0,"ng-container",11),t&2){let e=h(2);g("ngTemplateOutlet",e.nextIconTemplate||e._nextIconTemplate)}}function ZE(t,r){t&1&&($t(),Y(0,"svg",12))}function eI(t,r){if(t&1){let e=pe();d(0,"button",9,4),ee("click",function(){O(e);let i=h();return B(i.onNextButtonClick())}),ft(2,YE,1,1,"ng-container")(3,ZE,1,0,":svg:svg",12),u()}if(t&2){let e=h();_e(e.cx("nextButton")),g("pBind",e.ptm("nextButton")),Ue("aria-label",e.nextButtonAriaLabel)("tabindex",e.tabindex())("data-pc-group-section","navigator"),p(2),mt(e.nextIconTemplate||e._nextIconTemplate?2:3)}}function tI(t,r){t&1&&gr(0)}function rI(t,r){t&1&&Tt(0)}function iI(t,r){if(t&1&&P(0,rI,1,0,"ng-container",1),t&2){let e=h(),n=Dr(1);g("ngTemplateOutlet",e.content()?e.content():n)}}var nI={root:({instance:t})=>["p-tabs p-component",{"p-tabs-scrollable":t.scrollable()}]},fm=(()=>{class t extends ir{name="tabs";style=pm;classes=nI;static \u0275fac=(()=>{let e;return function(i){return(e||(e=ht(t)))(i||t)}})();static \u0275prov=Ye({token:t,factory:t.\u0275fac})}return t})();var oI={root:({instance:t})=>["p-tab",{"p-tab-active":t.active(),"p-disabled":t.disabled()}]},mm=(()=>{class t extends ir{name="tab";classes=oI;static \u0275fac=(()=>{let e;return function(i){return(e||(e=ht(t)))(i||t)}})();static \u0275prov=Ye({token:t,factory:t.\u0275fac})}return t})();var aI={root:"p-tablist",content:"p-tablist-content p-tablist-viewport",tabList:"p-tablist-tab-list",activeBar:"p-tablist-active-bar",prevButton:"p-tablist-prev-button p-tablist-nav-button",nextButton:"p-tablist-next-button p-tablist-nav-button"},hm=(()=>{class t extends ir{name="tablist";classes=aI;static \u0275fac=(()=>{let e;return function(i){return(e||(e=ht(t)))(i||t)}})();static \u0275prov=Ye({token:t,factory:t.\u0275fac})}return t})();var gm=new wt("TABLIST_INSTANCE"),kl=(()=>{class t extends Zt{$pcTabList=we(gm,{optional:!0,skipSelf:!0})??void 0;bindDirectiveInstance=we(Ge,{self:!0});onAfterViewChecked(){this.bindDirectiveInstance.setAttrs(this.ptms(["host","root"]))}prevIconTemplate;nextIconTemplate;templates;content;prevButton;nextButton;inkbar;tabs;pcTabs=we(Ni(()=>Na));isPrevButtonEnabled=zr(!1);isNextButtonEnabled=zr(!1);resizeObserver;showNavigators=Mt(()=>this.pcTabs.showNavigators());tabindex=Mt(()=>this.pcTabs.tabindex());scrollable=Mt(()=>this.pcTabs.scrollable());_componentStyle=we(hm);constructor(){super(),Yo(()=>{this.pcTabs.value(),Wn(this.platformId)&&setTimeout(()=>{this.updateInkBar()})})}get prevButtonAriaLabel(){return this.config?.translation?.aria?.previous}get nextButtonAriaLabel(){return this.config?.translation?.aria?.next}onAfterViewInit(){this.showNavigators()&&Wn(this.platformId)&&(this.updateButtonState(),this.bindResizeObserver())}_prevIconTemplate;_nextIconTemplate;onAfterContentInit(){this.templates?.forEach(e=>{switch(e.getType()){case"previcon":this._prevIconTemplate=e.template;break;case"nexticon":this._nextIconTemplate=e.template;break}})}onDestroy(){this.unbindResizeObserver()}onScroll(e){this.showNavigators()&&this.updateButtonState(),e.preventDefault()}onPrevButtonClick(){let e=this.content.nativeElement,n=ps(e),i=Math.abs(e.scrollLeft)-n,o=i<=0?0:i;e.scrollLeft=Nc(e)?-1*o:o}onNextButtonClick(){let e=this.content.nativeElement,n=ps(e)-this.getVisibleButtonWidths(),i=e.scrollLeft+n,o=e.scrollWidth-n,a=i>=o?o:i;e.scrollLeft=Nc(e)?-1*a:a}updateButtonState(){let e=this.content?.nativeElement,n=this.el?.nativeElement,{scrollWidth:i,offsetWidth:o}=e,a=Math.abs(e.scrollLeft),l=ps(e);this.isPrevButtonEnabled.set(a!==0),this.isNextButtonEnabled.set(n.offsetWidth>=o&&Math.abs(a-i+l)>1)}updateInkBar(){let e=this.content?.nativeElement,n=this.inkbar?.nativeElement,i=this.tabs?.nativeElement,o=Xr(e,'[data-pc-name="tab"][data-p-active="true"]');n&&(n.style.width=Ku(o)+"px",n.style.left=Vc(o).left-Vc(i).left+"px")}getVisibleButtonWidths(){let e=this.prevButton?.nativeElement,n=this.nextButton?.nativeElement;return[e,n].reduce((i,o)=>o?i+ps(o):i,0)}bindResizeObserver(){this.resizeObserver=new ResizeObserver(()=>this.updateButtonState()),this.resizeObserver.observe(this.el.nativeElement)}unbindResizeObserver(){this.resizeObserver&&(this.resizeObserver.unobserve(this.el.nativeElement),this.resizeObserver=null)}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=He({type:t,selectors:[["p-tablist"]],contentQueries:function(n,i,o){if(n&1&&(Ke(o,UE,4),Ke(o,WE,4),Ke(o,pi,4)),n&2){let a;Te(a=Ee())&&(i.prevIconTemplate=a.first),Te(a=Ee())&&(i.nextIconTemplate=a.first),Te(a=Ee())&&(i.templates=a)}},viewQuery:function(n,i){if(n&1&&(Nt(wm,5),Nt(jE,5),Nt(HE,5),Nt($E,5),Nt(GE,5)),n&2){let o;Te(o=Ee())&&(i.content=o.first),Te(o=Ee())&&(i.prevButton=o.first),Te(o=Ee())&&(i.nextButton=o.first),Te(o=Ee())&&(i.inkbar=o.first),Te(o=Ee())&&(i.tabs=o.first)}},hostVars:2,hostBindings:function(n,i){n&2&&_e(i.cx("root"))},features:[Dt([hm,{provide:gm,useExisting:t},{provide:Jt,useExisting:t}]),Xt([Ge]),lt],ngContentSelectors:bs,decls:9,vars:11,consts:[["content",""],["tabs",""],["inkbar",""],["prevButton",""],["nextButton",""],["type","button","pRipple","",3,"pBind","class"],[3,"scroll","pBind"],["role","tablist",3,"pBind"],["role","presentation",3,"pBind"],["type","button","pRipple","",3,"click","pBind"],["data-p-icon","chevron-left"],[4,"ngTemplateOutlet"],["data-p-icon","chevron-right"]],template:function(n,i){if(n&1){let o=pe();Sr(),ft(0,qE,4,7,"button",5),d(1,"div",6,0),ee("scroll",function(l){return O(o),B(i.onScroll(l))}),d(3,"div",7,1),gr(5),Y(6,"span",8,2),u()(),ft(8,eI,4,7,"button",5)}n&2&&(mt(i.showNavigators()&&i.isPrevButtonEnabled()?0:-1),p(),_e(i.cx("content")),g("pBind",i.ptm("content")),p(2),_e(i.cx("tabList")),g("pBind",i.ptm("tabList")),p(3),_e(i.cx("activeBar")),g("pBind",i.ptm("activeBar")),p(2),mt(i.showNavigators()&&i.isNextButtonEnabled()?8:-1))},dependencies:[et,Rr,ud,dd,il,Dn,It,Er,Ge],encapsulation:2,changeDetection:0})}return t})(),_m=new wt("TAB_INSTANCE"),o0=(()=>{class t extends Zt{$pcTab=we(_m,{optional:!0,skipSelf:!0})??void 0;bindDirectiveInstance=we(Ge,{self:!0});onAfterViewChecked(){this.bindDirectiveInstance.setAttrs(this.ptms(["host","root"]))}value=Zo();disabled=kr(!1,{transform:$e});pcTabs=we(Ni(()=>Na));pcTabList=we(Ni(()=>kl));el=we(wa);_componentStyle=we(mm);ripple=Mt(()=>this.config.ripple());id=Mt(()=>`${this.pcTabs.id()}_tab_${this.value()}`);ariaControls=Mt(()=>`${this.pcTabs.id()}_tabpanel_${this.value()}`);active=Mt(()=>Xi(this.pcTabs.value(),this.value()));tabindex=Mt(()=>this.disabled()?-1:this.active()?this.pcTabs.tabindex():-1);mutationObserver;onFocus(e){this.disabled()||this.pcTabs.selectOnFocus()&&this.changeActiveValue()}onClick(e){this.disabled()||this.changeActiveValue()}onKeyDown(e){switch(e.code){case"ArrowRight":this.onArrowRightKey(e);break;case"ArrowLeft":this.onArrowLeftKey(e);break;case"Home":this.onHomeKey(e);break;case"End":this.onEndKey(e);break;case"PageDown":this.onPageDownKey(e);break;case"PageUp":this.onPageUpKey(e);break;case"Enter":case"NumpadEnter":case"Space":this.onEnterKey(e);break;default:break}e.stopPropagation()}onAfterViewInit(){this.bindMutationObserver()}onArrowRightKey(e){let n=this.findNextTab(e.currentTarget);n?this.changeFocusedTab(e,n):this.onHomeKey(e),e.preventDefault()}onArrowLeftKey(e){let n=this.findPrevTab(e.currentTarget);n?this.changeFocusedTab(e,n):this.onEndKey(e),e.preventDefault()}onHomeKey(e){let n=this.findFirstTab();this.changeFocusedTab(e,n),e.preventDefault()}onEndKey(e){let n=this.findLastTab();this.changeFocusedTab(e,n),e.preventDefault()}onPageDownKey(e){this.scrollInView(this.findLastTab()),e.preventDefault()}onPageUpKey(e){this.scrollInView(this.findFirstTab()),e.preventDefault()}onEnterKey(e){this.disabled()||this.changeActiveValue(),e.preventDefault()}findNextTab(e,n=!1){let i=n?e:e.nextElementSibling;return i?Hn(i,"data-p-disabled")||Hn(i,"data-pc-section")==="activebar"?this.findNextTab(i):i:null}findPrevTab(e,n=!1){let i=n?e:e.previousElementSibling;return i?Hn(i,"data-p-disabled")||Hn(i,"data-pc-section")==="activebar"?this.findPrevTab(i):i:null}findFirstTab(){return this.findNextTab(this.pcTabList?.tabs?.nativeElement?.firstElementChild,!0)}findLastTab(){return this.findPrevTab(this.pcTabList?.tabs?.nativeElement?.lastElementChild,!0)}changeActiveValue(){this.pcTabs.updateValue(this.value())}changeFocusedTab(e,n){Jr(n),this.scrollInView(n)}scrollInView(e){e?.scrollIntoView?.({block:"nearest"})}bindMutationObserver(){Wn(this.platformId)&&(this.mutationObserver=new MutationObserver(e=>{e.forEach(()=>{this.active()&&this.pcTabList?.updateInkBar()})}),this.mutationObserver.observe(this.el.nativeElement,{childList:!0,characterData:!0,subtree:!0}))}unbindMutationObserver(){this.mutationObserver?.disconnect()}onDestroy(){this.mutationObserver&&this.unbindMutationObserver()}static \u0275fac=(()=>{let e;return function(i){return(e||(e=ht(t)))(i||t)}})();static \u0275cmp=He({type:t,selectors:[["p-tab"]],hostVars:10,hostBindings:function(n,i){n&1&&ee("focus",function(a){return i.onFocus(a)})("click",function(a){return i.onClick(a)})("keydown",function(a){return i.onKeyDown(a)}),n&2&&(Ue("id",i.id())("aria-controls",i.ariaControls())("role","tab")("aria-selected",i.active())("aria-disabled",i.disabled())("data-p-disabled",i.disabled())("data-p-active",i.active())("tabindex",i.tabindex()),_e(i.cx("root")))},inputs:{value:[1,"value"],disabled:[1,"disabled"]},outputs:{value:"valueChange"},features:[Dt([mm,{provide:_m,useExisting:t},{provide:Jt,useExisting:t}]),Xt([Dn,Ge]),lt],ngContentSelectors:bs,decls:1,vars:0,template:function(n,i){n&1&&(Sr(),gr(0))},dependencies:[et,It,Er],encapsulation:2,changeDetection:0})}return t})(),sI={root:({instance:t})=>["p-tabpanel",{"p-tabpanel-active":t.active()}]},xm=(()=>{class t extends ir{name="tabpanel";classes=sI;static \u0275fac=(()=>{let e;return function(i){return(e||(e=ht(t)))(i||t)}})();static \u0275prov=Ye({token:t,factory:t.\u0275fac})}return t})();var vm=new wt("TABPANEL_INSTANCE"),a0=(()=>{class t extends Zt{$pcTabPanel=we(vm,{optional:!0,skipSelf:!0})??void 0;bindDirectiveInstance=we(Ge,{self:!0});pcTabs=we(Ni(()=>Na));onAfterViewChecked(){this.bindDirectiveInstance.setAttrs(this.ptms(["host","root"]))}lazy=kr(!1,{transform:$e});value=Zo(void 0);content=Pu("content");id=Mt(()=>`${this.pcTabs.id()}_tabpanel_${this.value()}`);ariaLabelledby=Mt(()=>`${this.pcTabs.id()}_tab_${this.value()}`);active=Mt(()=>Xi(this.pcTabs.value(),this.value()));isLazyEnabled=Mt(()=>this.pcTabs.lazy()||this.lazy());hasBeenRendered=!1;shouldRender=Mt(()=>!this.isLazyEnabled()||this.hasBeenRendered?!0:this.active()?(this.hasBeenRendered=!0,!0):!1);_componentStyle=we(xm);static \u0275fac=(()=>{let e;return function(i){return(e||(e=ht(t)))(i||t)}})();static \u0275cmp=He({type:t,selectors:[["p-tabpanel"]],contentQueries:function(n,i,o){n&1&&wu(o,i.content,wm,5),n&2&&Su()},hostVars:7,hostBindings:function(n,i){n&2&&($s("hidden",!i.active()),Ue("id",i.id())("role","tabpanel")("aria-labelledby",i.ariaLabelledby())("data-p-active",i.active()),_e(i.cx("root")))},inputs:{lazy:[1,"lazy"],value:[1,"value"]},outputs:{value:"valueChange"},features:[Dt([xm,{provide:vm,useExisting:t},{provide:Jt,useExisting:t}]),Xt([Ge]),lt],ngContentSelectors:bs,decls:3,vars:1,consts:[["defaultContent",""],[4,"ngTemplateOutlet"]],template:function(n,i){n&1&&(Sr(),P(0,tI,1,0,"ng-template",null,0,Z),ft(2,iI,1,1,"ng-container")),n&2&&(p(2),mt(i.shouldRender()?2:-1))},dependencies:[Rr,Er],encapsulation:2,changeDetection:0})}return t})(),lI={root:"p-tabpanels"},bm=(()=>{class t extends ir{name="tabpanels";classes=lI;static \u0275fac=(()=>{let e;return function(i){return(e||(e=ht(t)))(i||t)}})();static \u0275prov=Ye({token:t,factory:t.\u0275fac})}return t})();var ym=new wt("TABPANELS_INSTANCE"),s0=(()=>{class t extends Zt{$pcTabPanels=we(ym,{optional:!0,skipSelf:!0})??void 0;bindDirectiveInstance=we(Ge,{self:!0});_componentStyle=we(bm);onAfterViewChecked(){this.bindDirectiveInstance.setAttrs(this.ptms(["host","root"]))}static \u0275fac=(()=>{let e;return function(i){return(e||(e=ht(t)))(i||t)}})();static \u0275cmp=He({type:t,selectors:[["p-tabpanels"]],hostVars:3,hostBindings:function(n,i){n&2&&(Ue("role","presentation"),_e(i.cx("root")))},features:[Dt([bm,{provide:ym,useExisting:t},{provide:Jt,useExisting:t}]),Xt([Ge]),lt],ngContentSelectors:bs,decls:1,vars:0,template:function(n,i){n&1&&(Sr(),gr(0))},dependencies:[et,Er],encapsulation:2,changeDetection:0})}return t})(),Cm=new wt("TABS_INSTANCE"),Na=(()=>{class t extends Zt{$pcTabs=we(Cm,{optional:!0,skipSelf:!0})??void 0;bindDirectiveInstance=we(Ge,{self:!0});onAfterViewChecked(){this.bindDirectiveInstance.setAttrs(this.ptms(["host","root"]))}value=Zo(void 0);scrollable=kr(!1,{transform:$e});lazy=kr(!1,{transform:$e});selectOnFocus=kr(!1,{transform:$e});showNavigators=kr(!0,{transform:$e});tabindex=kr(0,{transform:Or});id=zr(un("pn_id_"));_componentStyle=we(fm);updateValue(e){this.value.update(()=>e)}static \u0275fac=(()=>{let e;return function(i){return(e||(e=ht(t)))(i||t)}})();static \u0275cmp=He({type:t,selectors:[["p-tabs"]],hostVars:3,hostBindings:function(n,i){n&2&&(Ue("id",i.id()),_e(i.cx("root")))},inputs:{value:[1,"value"],scrollable:[1,"scrollable"],lazy:[1,"lazy"],selectOnFocus:[1,"selectOnFocus"],showNavigators:[1,"showNavigators"],tabindex:[1,"tabindex"]},outputs:{value:"valueChange"},features:[Dt([fm,{provide:Cm,useExisting:t},{provide:Jt,useExisting:t}]),Xt([Ge]),lt],ngContentSelectors:bs,decls:1,vars:0,template:function(n,i){n&1&&(Sr(),gr(0))},dependencies:[et,Er],encapsulation:2,changeDetection:0})}return t})(),Sm=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=hr({type:t});static \u0275inj=mr({imports:[Na,s0,a0,kl,o0,Er,Er]})}return t})();var km=`
    .p-floatlabel {
        display: block;
        position: relative;
    }

    .p-floatlabel label {
        position: absolute;
        pointer-events: none;
        top: 50%;
        transform: translateY(-50%);
        transition-property: all;
        transition-timing-function: ease;
        line-height: 1;
        font-weight: dt('floatlabel.font.weight');
        inset-inline-start: dt('floatlabel.position.x');
        color: dt('floatlabel.color');
        transition-duration: dt('floatlabel.transition.duration');
    }

    .p-floatlabel:has(.p-textarea) label {
        top: dt('floatlabel.position.y');
        transform: translateY(0);
    }

    .p-floatlabel:has(.p-inputicon:first-child) label {
        inset-inline-start: calc((dt('form.field.padding.x') * 2) + dt('icon.size'));
    }

    .p-floatlabel:has(input:focus) label,
    .p-floatlabel:has(input.p-filled) label,
    .p-floatlabel:has(input:-webkit-autofill) label,
    .p-floatlabel:has(textarea:focus) label,
    .p-floatlabel:has(textarea.p-filled) label,
    .p-floatlabel:has(.p-inputwrapper-focus) label,
    .p-floatlabel:has(.p-inputwrapper-filled) label,
    .p-floatlabel:has(input[placeholder]) label,
    .p-floatlabel:has(textarea[placeholder]) label {
        top: dt('floatlabel.over.active.top');
        transform: translateY(0);
        font-size: dt('floatlabel.active.font.size');
        font-weight: dt('floatlabel.active.font.weight');
    }

    .p-floatlabel:has(input.p-filled) label,
    .p-floatlabel:has(textarea.p-filled) label,
    .p-floatlabel:has(.p-inputwrapper-filled) label {
        color: dt('floatlabel.active.color');
    }

    .p-floatlabel:has(input:focus) label,
    .p-floatlabel:has(input:-webkit-autofill) label,
    .p-floatlabel:has(textarea:focus) label,
    .p-floatlabel:has(.p-inputwrapper-focus) label {
        color: dt('floatlabel.focus.color');
    }

    .p-floatlabel-in .p-inputtext,
    .p-floatlabel-in .p-textarea,
    .p-floatlabel-in .p-select-label,
    .p-floatlabel-in .p-multiselect-label,
    .p-floatlabel-in .p-multiselect-label:has(.p-chip),
    .p-floatlabel-in .p-autocomplete-input-multiple,
    .p-floatlabel-in .p-cascadeselect-label,
    .p-floatlabel-in .p-treeselect-label {
        padding-block-start: dt('floatlabel.in.input.padding.top');
        padding-block-end: dt('floatlabel.in.input.padding.bottom');
    }

    .p-floatlabel-in:has(input:focus) label,
    .p-floatlabel-in:has(input.p-filled) label,
    .p-floatlabel-in:has(input:-webkit-autofill) label,
    .p-floatlabel-in:has(textarea:focus) label,
    .p-floatlabel-in:has(textarea.p-filled) label,
    .p-floatlabel-in:has(.p-inputwrapper-focus) label,
    .p-floatlabel-in:has(.p-inputwrapper-filled) label,
    .p-floatlabel-in:has(input[placeholder]) label,
    .p-floatlabel-in:has(textarea[placeholder]) label {
        top: dt('floatlabel.in.active.top');
    }

    .p-floatlabel-on:has(input:focus) label,
    .p-floatlabel-on:has(input.p-filled) label,
    .p-floatlabel-on:has(input:-webkit-autofill) label,
    .p-floatlabel-on:has(textarea:focus) label,
    .p-floatlabel-on:has(textarea.p-filled) label,
    .p-floatlabel-on:has(.p-inputwrapper-focus) label,
    .p-floatlabel-on:has(.p-inputwrapper-filled) label,
    .p-floatlabel-on:has(input[placeholder]) label,
    .p-floatlabel-on:has(textarea[placeholder]) label {
        top: 0;
        transform: translateY(-50%);
        border-radius: dt('floatlabel.on.border.radius');
        background: dt('floatlabel.on.active.background');
        padding: dt('floatlabel.on.active.padding');
    }

    .p-floatlabel:has([class^='p-'][class$='-fluid']) {
        width: 100%;
    }

    .p-floatlabel:has(.p-invalid) label {
        color: dt('floatlabel.invalid.color');
    }
`;var uI=["*"],dI=`
    ${km}

    /* For PrimeNG */
    .p-floatlabel:has(.ng-invalid.ng-dirty) label {
        color: dt('floatlabel.invalid.color');
    }
`,pI={root:({instance:t})=>["p-floatlabel",{"p-floatlabel-over":t.variant==="over","p-floatlabel-on":t.variant==="on","p-floatlabel-in":t.variant==="in"}]},Tm=(()=>{class t extends ir{name="floatlabel";style=dI;classes=pI;static \u0275fac=(()=>{let e;return function(i){return(e||(e=ht(t)))(i||t)}})();static \u0275prov=Ye({token:t,factory:t.\u0275fac})}return t})();var Em=new wt("FLOATLABEL_INSTANCE"),bo=(()=>{class t extends Zt{_componentStyle=we(Tm);$pcFloatLabel=we(Em,{optional:!0,skipSelf:!0})??void 0;bindDirectiveInstance=we(Ge,{self:!0});onAfterViewChecked(){this.bindDirectiveInstance.setAttrs(this.ptms(["host","root"]))}variant="over";static \u0275fac=(()=>{let e;return function(i){return(e||(e=ht(t)))(i||t)}})();static \u0275cmp=He({type:t,selectors:[["p-floatlabel"],["p-floatLabel"],["p-float-label"]],hostVars:2,hostBindings:function(n,i){n&2&&_e(i.cx("root"))},inputs:{variant:"variant"},features:[Dt([Tm,{provide:Em,useExisting:t},{provide:Jt,useExisting:t}]),Xt([Ge]),lt],ngContentSelectors:uI,decls:1,vars:0,template:function(n,i){n&1&&(Sr(),gr(0))},dependencies:[et,It,Er],encapsulation:2,changeDetection:0})}return t})(),Ro=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=hr({type:t});static \u0275inj=mr({imports:[bo,It,It]})}return t})();var Im=`
    .p-accordionpanel {
        display: flex;
        flex-direction: column;
        border-style: solid;
        border-width: dt('accordion.panel.border.width');
        border-color: dt('accordion.panel.border.color');
    }

    .p-accordionheader {
        all: unset;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: dt('accordion.header.padding');
        color: dt('accordion.header.color');
        background: dt('accordion.header.background');
        border-style: solid;
        border-width: dt('accordion.header.border.width');
        border-color: dt('accordion.header.border.color');
        font-weight: dt('accordion.header.font.weight');
        border-radius: dt('accordion.header.border.radius');
        transition:
            background dt('accordion.transition.duration'),
            color dt('accordion.transition.duration'),
            outline-color dt('accordion.transition.duration'),
            box-shadow dt('accordion.transition.duration');
        outline-color: transparent;
    }

    .p-accordionpanel:first-child > .p-accordionheader {
        border-width: dt('accordion.header.first.border.width');
        border-start-start-radius: dt('accordion.header.first.top.border.radius');
        border-start-end-radius: dt('accordion.header.first.top.border.radius');
    }

    .p-accordionpanel:last-child > .p-accordionheader {
        border-end-start-radius: dt('accordion.header.last.bottom.border.radius');
        border-end-end-radius: dt('accordion.header.last.bottom.border.radius');
    }

    .p-accordionpanel:last-child.p-accordionpanel-active > .p-accordionheader {
        border-end-start-radius: dt('accordion.header.last.active.bottom.border.radius');
        border-end-end-radius: dt('accordion.header.last.active.bottom.border.radius');
    }

    .p-accordionheader-toggle-icon {
        color: dt('accordion.header.toggle.icon.color');
    }

    .p-accordionpanel:not(.p-disabled) .p-accordionheader:focus-visible {
        box-shadow: dt('accordion.header.focus.ring.shadow');
        outline: dt('accordion.header.focus.ring.width') dt('accordion.header.focus.ring.style') dt('accordion.header.focus.ring.color');
        outline-offset: dt('accordion.header.focus.ring.offset');
    }

    .p-accordionpanel:not(.p-accordionpanel-active):not(.p-disabled) > .p-accordionheader:hover {
        background: dt('accordion.header.hover.background');
        color: dt('accordion.header.hover.color');
    }

    .p-accordionpanel:not(.p-accordionpanel-active):not(.p-disabled) .p-accordionheader:hover .p-accordionheader-toggle-icon {
        color: dt('accordion.header.toggle.icon.hover.color');
    }

    .p-accordionpanel:not(.p-disabled).p-accordionpanel-active > .p-accordionheader {
        background: dt('accordion.header.active.background');
        color: dt('accordion.header.active.color');
    }

    .p-accordionpanel:not(.p-disabled).p-accordionpanel-active > .p-accordionheader .p-accordionheader-toggle-icon {
        color: dt('accordion.header.toggle.icon.active.color');
    }

    .p-accordionpanel:not(.p-disabled).p-accordionpanel-active > .p-accordionheader:hover {
        background: dt('accordion.header.active.hover.background');
        color: dt('accordion.header.active.hover.color');
    }

    .p-accordionpanel:not(.p-disabled).p-accordionpanel-active > .p-accordionheader:hover .p-accordionheader-toggle-icon {
        color: dt('accordion.header.toggle.icon.active.hover.color');
    }

    .p-accordioncontent-content {
        border-style: solid;
        border-width: dt('accordion.content.border.width');
        border-color: dt('accordion.content.border.color');
        background-color: dt('accordion.content.background');
        color: dt('accordion.content.color');
        padding: dt('accordion.content.padding');
    }
`;var El=["*"],fI=["toggleicon"],mI=t=>({active:t});function hI(t,r){}function gI(t,r){t&1&&P(0,hI,0,0,"ng-template")}function _I(t,r){if(t&1&&P(0,gI,1,0,null,0),t&2){let e=h();g("ngTemplateOutlet",e.toggleicon)("ngTemplateOutletContext",vt(2,mI,e.active()))}}function xI(t,r){if(t&1&&Y(0,"span",4),t&2){let e=h(3);_e(e.cn(e.cx("toggleicon"),e.pcAccordion.collapseIcon)),g("pBind",e.ptm("toggleicon")),Ue("aria-hidden",!0)}}function vI(t,r){if(t&1&&($t(),Y(0,"svg",5)),t&2){let e=h(3);_e(e.cx("toggleicon")),g("pBind",e.ptm("toggleicon")),Ue("aria-hidden",!0)}}function bI(t,r){if(t&1&&(Le(0),P(1,xI,1,4,"span",2)(2,vI,1,4,"svg",3),Ne()),t&2){let e=h(2);p(),g("ngIf",e.pcAccordion.collapseIcon),p(),g("ngIf",!e.pcAccordion.collapseIcon)}}function yI(t,r){if(t&1&&Y(0,"span",4),t&2){let e=h(3);_e(e.cn(e.cx("toggleicon"),e.pcAccordion.expandIcon)),g("pBind",e.ptm("toggleicon")),Ue("aria-hidden",!0)}}function CI(t,r){if(t&1&&($t(),Y(0,"svg",7)),t&2){let e=h(3);g("pBind",e.ptm("toggleicon")),Ue("aria-hidden",!0)}}function wI(t,r){if(t&1&&(Le(0),P(1,yI,1,4,"span",2)(2,CI,1,2,"svg",6),Ne()),t&2){let e=h(2);p(),g("ngIf",e.pcAccordion.expandIcon),p(),g("ngIf",!e.pcAccordion.expandIcon)}}function SI(t,r){if(t&1&&P(0,bI,3,2,"ng-container",1)(1,wI,3,2,"ng-container",1),t&2){let e=h();g("ngIf",e.active()),p(),g("ngIf",!e.active())}}var Fm=t=>({transitionParams:t}),kI=t=>({value:"visible",params:t}),TI=t=>({value:"hidden",params:t}),EI=`
    ${Im}

    /*For PrimeNG*/
    .p-accordionpanel:not(.p-accordionpanel-active) > .p-accordioncontent,
    .p-accordioncontent-content.ng-animating {
        overflow: hidden;
    }

    .p-accordionheader-toggle-icon.icon-start {
        order: -1;
    }

    .p-accordionheader:has(.p-accordionheader-toggle-icon.icon-start) {
        justify-content: flex-start;
        gap: dt('accordion.header.padding');
    }

    .p-accordioncontent.ng-animating {
        overflow: hidden;
    }

    .p-accordionheader.p-ripple {
        overflow: hidden;
        position: relative;
    }
`,II={root:"p-accordion p-component",panel:({instance:t})=>["p-accordionpanel",{"p-accordionpanel-active":t.active(),"p-disabled":t.disabled()}],header:"p-accordionheader",toggleicon:"p-accordionheader-toggle-icon",contentContainer:"p-accordioncontent",content:"p-accordioncontent-content"},Lo=(()=>{class t extends ir{name="accordion";style=EI;classes=II;static \u0275fac=(()=>{let e;return function(i){return(e||(e=ht(t)))(i||t)}})();static \u0275prov=Ye({token:t,factory:t.\u0275fac})}return t})();var Am=new wt("ACCORDION_PANEL_INSTANCE"),Pm=new wt("ACCORDION_HEADER_INSTANCE"),Dm=new wt("ACCORDION_CONTENT_INSTANCE"),Om=new wt("ACCORDION_INSTANCE"),ys=(()=>{class t extends Zt{$pcAccordionPanel=we(Am,{optional:!0,skipSelf:!0})??void 0;bindDirectiveInstance=we(Ge,{self:!0});onAfterViewChecked(){this.bindDirectiveInstance.setAttrs(this.ptm("root"))}pcAccordion=we(Ni(()=>No));value=Zo(void 0);disabled=kr(!1,{transform:e=>sl(e)});active=Mt(()=>this.pcAccordion.multiple()?this.valueEquals(this.pcAccordion.value(),this.value()):this.pcAccordion.value()===this.value());valueEquals(e,n){return Array.isArray(e)?e.includes(n):e===n}_componentStyle=we(Lo);static \u0275fac=(()=>{let e;return function(i){return(e||(e=ht(t)))(i||t)}})();static \u0275cmp=He({type:t,selectors:[["p-accordion-panel"],["p-accordionpanel"]],hostVars:4,hostBindings:function(n,i){n&2&&(Ue("data-p-disabled",i.disabled())("data-p-active",i.active()),_e(i.cx("panel")))},inputs:{value:[1,"value"],disabled:[1,"disabled"]},outputs:{value:"valueChange"},features:[Dt([Lo,{provide:Am,useExisting:t},{provide:Jt,useExisting:t}]),Xt([Ge]),lt],ngContentSelectors:El,decls:1,vars:0,template:function(n,i){n&1&&(Sr(),gr(0))},dependencies:[et,Er],encapsulation:2,changeDetection:0})}return t})(),l0=(()=>{class t extends Zt{$pcAccordionHeader=we(Pm,{optional:!0,skipSelf:!0})??void 0;bindDirectiveInstance=we(Ge,{self:!0});onAfterViewChecked(){this.bindDirectiveInstance.setAttrs(this.ptm("root"))}pcAccordion=we(Ni(()=>No));pcAccordionPanel=we(Ni(()=>ys));id=Mt(()=>`${this.pcAccordion.id()}_accordionheader_${this.pcAccordionPanel.value()}`);active=Mt(()=>this.pcAccordionPanel.active());disabled=Mt(()=>this.pcAccordionPanel.disabled());ariaControls=Mt(()=>`${this.pcAccordion.id()}_accordioncontent_${this.pcAccordionPanel.value()}`);toggleicon;onClick(e){if(this.disabled())return;let n=this.active();this.changeActiveValue();let i=this.active(),o=this.pcAccordionPanel.value();!n&&i?this.pcAccordion.onOpen.emit({originalEvent:e,index:o}):n&&!i&&this.pcAccordion.onClose.emit({originalEvent:e,index:o})}onFocus(){!this.disabled()&&this.pcAccordion.selectOnFocus()&&this.changeActiveValue()}onKeydown(e){switch(e.code){case"ArrowDown":this.arrowDownKey(e);break;case"ArrowUp":this.arrowUpKey(e);break;case"Home":this.onHomeKey(e);break;case"End":this.onEndKey(e);break;case"Enter":case"Space":case"NumpadEnter":this.onEnterKey(e);break;default:break}}_componentStyle=we(Lo);changeActiveValue(){this.pcAccordion.updateValue(this.pcAccordionPanel.value())}findPanel(e){return e?.closest('[data-pc-name="accordionpanel"]')}findHeader(e){return Xr(e,'[data-pc-name="accordionheader"]')}findNextPanel(e,n=!1){let i=n?e:e.nextElementSibling;return i?Hn(i,"data-p-disabled")?this.findNextPanel(i):this.findHeader(i):null}findPrevPanel(e,n=!1){let i=n?e:e.previousElementSibling;return i?Hn(i,"data-p-disabled")?this.findPrevPanel(i):this.findHeader(i):null}findFirstPanel(){return this.findNextPanel(this.pcAccordion.el.nativeElement.firstElementChild,!0)}findLastPanel(){return this.findPrevPanel(this.pcAccordion.el.nativeElement.lastElementChild,!0)}changeFocusedPanel(e,n){Jr(n)}arrowDownKey(e){let n=this.findNextPanel(this.findPanel(e.currentTarget));n?this.changeFocusedPanel(e,n):this.onHomeKey(e),e.preventDefault()}arrowUpKey(e){let n=this.findPrevPanel(this.findPanel(e.currentTarget));n?this.changeFocusedPanel(e,n):this.onEndKey(e),e.preventDefault()}onHomeKey(e){let n=this.findFirstPanel();this.changeFocusedPanel(e,n),e.preventDefault()}onEndKey(e){let n=this.findLastPanel();this.changeFocusedPanel(e,n),e.preventDefault()}onEnterKey(e){this.disabled()||this.changeActiveValue(),e.preventDefault()}static \u0275fac=(()=>{let e;return function(i){return(e||(e=ht(t)))(i||t)}})();static \u0275cmp=He({type:t,selectors:[["p-accordion-header"],["p-accordionheader"]],contentQueries:function(n,i,o){if(n&1&&Ke(o,fI,5),n&2){let a;Te(a=Ee())&&(i.toggleicon=a.first)}},hostVars:12,hostBindings:function(n,i){n&1&&ee("click",function(a){return i.onClick(a)})("focus",function(a){return i.onFocus(a)})("keydown",function(a){return i.onKeydown(a)}),n&2&&(Ue("id",i.id())("aria-expanded",i.active())("aria-controls",i.ariaControls())("aria-disabled",i.disabled())("role","button")("tabindex",i.disabled()?"-1":"0")("data-p-active",i.active())("data-p-disabled",i.disabled()),_e(i.cx("header")),Vi("user-select","none"))},features:[Dt([Lo,{provide:Pm,useExisting:t},{provide:Jt,useExisting:t}]),Xt([Dn,Ge]),lt],ngContentSelectors:El,decls:3,vars:1,consts:[[4,"ngTemplateOutlet","ngTemplateOutletContext"],[4,"ngIf"],[3,"class","pBind",4,"ngIf"],["data-p-icon","chevron-up",3,"class","pBind",4,"ngIf"],[3,"pBind"],["data-p-icon","chevron-up",3,"pBind"],["data-p-icon","chevron-down",3,"pBind",4,"ngIf"],["data-p-icon","chevron-down",3,"pBind"]],template:function(n,i){n&1&&(Sr(),gr(0),ft(1,_I,1,4)(2,SI,2,2)),n&2&&(p(),mt(i.toggleicon?1:2))},dependencies:[et,bt,Rr,Ta,nl,Er,Ge],encapsulation:2,changeDetection:0})}return t})(),c0=(()=>{class t extends Zt{$pcAccordionContent=we(Dm,{optional:!0,skipSelf:!0})??void 0;bindDirectiveInstance=we(Ge,{self:!0});onAfterViewChecked(){this.bindDirectiveInstance.setAttrs(this.ptm("root"))}pcAccordion=we(Ni(()=>No));pcAccordionPanel=we(Ni(()=>ys));active=Mt(()=>this.pcAccordionPanel.active());ariaLabelledby=Mt(()=>`${this.pcAccordion.id()}_accordionheader_${this.pcAccordionPanel.value()}`);id=Mt(()=>`${this.pcAccordion.id()}_accordioncontent_${this.pcAccordionPanel.value()}`);_componentStyle=we(Lo);ptParams=Mt(()=>({context:this.active()}));static \u0275fac=(()=>{let e;return function(i){return(e||(e=ht(t)))(i||t)}})();static \u0275cmp=He({type:t,selectors:[["p-accordion-content"],["p-accordioncontent"]],hostVars:6,hostBindings:function(n,i){n&2&&(Ue("id",i.id())("role","region")("data-p-active",i.active())("aria-labelledby",i.ariaLabelledby()),_e(i.cx("contentContainer")))},features:[Dt([Lo,{provide:Dm,useExisting:t},{provide:Jt,useExisting:t}]),Xt([Ge]),lt],ngContentSelectors:El,decls:2,vars:12,consts:[[3,"pBind"]],template:function(n,i){n&1&&(Sr(),d(0,"div",0),gr(1),u()),n&2&&(_e(i.cx("content")),g("@content",i.active()?vt(6,kI,vt(4,Fm,i.pcAccordion.transitionOptions)):vt(10,TI,vt(8,Fm,i.pcAccordion.transitionOptions)))("pBind",i.ptm("content",i.ptParams())))},dependencies:[et,Er,Ge],encapsulation:2,data:{animation:[$n("content",[mo("hidden",ki({height:"0",paddingBlockStart:"0",paddingBlockEnd:"0",borderBlockStartWidth:"0",borderBlockEndWidth:"0",visibility:"hidden"})),mo("visible",ki({height:"*"})),Qi("visible <=> hidden",[qi("{{transitionParams}}")]),Qi("void => *",qi(0))])]},changeDetection:0})}return t})(),No=(()=>{class t extends Zt{$pcAccordion=we(Om,{optional:!0,skipSelf:!0})??void 0;bindDirectiveInstance=we(Ge,{self:!0});onAfterViewChecked(){this.bindDirectiveInstance.setAttrs(this.ptm("root"))}value=Zo(void 0);multiple=kr(!1,{transform:e=>sl(e)});styleClass;expandIcon;collapseIcon;selectOnFocus=kr(!1,{transform:e=>sl(e)});transitionOptions="400ms cubic-bezier(0.86, 0, 0.07, 1)";onClose=new xt;onOpen=new xt;id=zr(un("pn_id_"));_componentStyle=we(Lo);onKeydown(e){switch(e.code){case"ArrowDown":this.onTabArrowDownKey(e);break;case"ArrowUp":this.onTabArrowUpKey(e);break;case"Home":e.shiftKey||this.onTabHomeKey(e);break;case"End":e.shiftKey||this.onTabEndKey(e);break}}onTabArrowDownKey(e){let n=this.findNextHeaderAction(e.target.parentElement);n?this.changeFocusedTab(n):this.onTabHomeKey(e),e.preventDefault()}onTabArrowUpKey(e){let n=this.findPrevHeaderAction(e.target.parentElement);n?this.changeFocusedTab(n):this.onTabEndKey(e),e.preventDefault()}onTabHomeKey(e){let n=this.findFirstHeaderAction();this.changeFocusedTab(n),e.preventDefault()}changeFocusedTab(e){e&&Jr(e)}findNextHeaderAction(e,n=!1){let i=n?e:e.nextElementSibling,o=Xr(i,'[data-pc-section="accordionheader"]');return o?Hn(o,"data-p-disabled")?this.findNextHeaderAction(o.parentElement):Xr(o.parentElement,'[data-pc-section="accordionheader"]'):null}findPrevHeaderAction(e,n=!1){let i=n?e:e.previousElementSibling,o=Xr(i,'[data-pc-section="accordionheader"]');return o?Hn(o,"data-p-disabled")?this.findPrevHeaderAction(o.parentElement):Xr(o.parentElement,'[data-pc-section="accordionheader"]'):null}findFirstHeaderAction(){let e=this.el.nativeElement.firstElementChild;return this.findNextHeaderAction(e,!0)}findLastHeaderAction(){let e=this.el.nativeElement.lastElementChild;return this.findPrevHeaderAction(e,!0)}onTabEndKey(e){let n=this.findLastHeaderAction();this.changeFocusedTab(n),e.preventDefault()}getBlockableElement(){return this.el.nativeElement.children[0]}updateValue(e){let n=this.value();if(this.multiple()){let i=Array.isArray(n)?[...n]:[],o=i.indexOf(e);o!==-1?i.splice(o,1):i.push(e),this.value.set(i)}else n===e?this.value.set(void 0):this.value.set(e)}static \u0275fac=(()=>{let e;return function(i){return(e||(e=ht(t)))(i||t)}})();static \u0275cmp=He({type:t,selectors:[["p-accordion"]],hostVars:2,hostBindings:function(n,i){n&1&&ee("keydown",function(a){return i.onKeydown(a)}),n&2&&_e(i.cn(i.cx("root"),i.styleClass))},inputs:{value:[1,"value"],multiple:[1,"multiple"],styleClass:"styleClass",expandIcon:"expandIcon",collapseIcon:"collapseIcon",selectOnFocus:[1,"selectOnFocus"],transitionOptions:"transitionOptions"},outputs:{value:"valueChange",onClose:"onClose",onOpen:"onOpen"},features:[Dt([Lo,{provide:Om,useExisting:t},{provide:Jt,useExisting:t}]),Xt([Ge]),lt],ngContentSelectors:El,decls:1,vars:0,template:function(n,i){n&1&&(Sr(),gr(0))},dependencies:[et,It,Er],encapsulation:2,changeDetection:0})}return t})(),Il=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=hr({type:t});static \u0275inj=mr({imports:[No,It,ys,l0,c0,Er,It,Er]})}return t})();var Mm=(()=>{let r=class r{constructor(n){this.sanitizer=n}transform(n){return this.sanitizer.bypassSecurityTrustHtml(n)}};r.\u0275fac=function(i){return new(i||r)(Pe(Xs,16))},r.\u0275pipe=Pc({name:"safeHtml",type:r,pure:!0});let t=r;return t})();var Fl=(()=>{let r=class r{constructor(n,i,o,a){this.packageTypeClient=n,this.packageTypeCommandHandlerClient=i,this.messageService=o,this.purchaseClient=a,this.packageTypes=new ur([]),this.packageTypeClient.getPackageTypes().pipe(ge(l=>(this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0438 \u0441\u043F\u0438\u0441\u043A\u0430 \u0442\u0438\u043F\u043E\u0432 \u0443\u043F\u0430\u043A\u043E\u0432\u043A\u0438",severity:"error",detail:l}),it))).subscribe(l=>{this.packageTypes.next(l)})}getBatch(n){return this.purchaseClient.getPurchaseBatch(n)}getSalesPlanSelfCost(n,i,o){let a=this.getSalesItemCosts(n),l=+i.returnCost*+i.returnPercentage/100,c=i.amount?+i.marketingBudget/i.amount:0,f=i.amount?Math.ceil(+i.deliveryCost*100/+i.amount)/100:0;return o.price+a+l+f+c}getPackageTypes(){return this.packageTypes.value}getPackageType(n){return this.packageTypes.value.find(i=>i.iD==n)}getSalesItemCosts(n){let i=0;for(let o of n.salesItemPackages)i+=Math.ceil(o.pricePerUom*o.amount*100)/100;return i+=n.packagingPrice,i=Math.ceil(i*100)/100,i}getSalesPlanCommission(n){return Math.ceil(+n.commissionMultiplier*+n.price)/100+ +n.commissionAddition}calcPlans(){this.purchaseClient.calcSalesPlans().pipe(ge(n=>(this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0438 \u0441\u043F\u0438\u0441\u043A\u0430 \u0442\u0438\u043F\u043E\u0432 \u0443\u043F\u0430\u043A\u043E\u0432\u043A\u0438",severity:"error",detail:n}),it))).subscribe(()=>{this.messageService.add({summary:"\u0423\u0441\u043F\u0435\u0445",severity:"success",detail:"\u041F\u0435\u0440\u0435\u0440\u0430\u0441\u0447\u0451\u0442 \u043F\u043B\u0430\u043D\u043E\u0432 \u043F\u0440\u043E\u0434\u0430\u0436 \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0437\u0430\u0432\u0435\u0440\u0448\u0451\u043D"})})}getSalesPlansSummaries(n){return this.purchaseClient.getSalesPlansSummaries(n)}addPackageType(n){return this.packageTypeCommandHandlerClient.addPackageType(n)}updatePackageType(n){return this.packageTypeCommandHandlerClient.updatePackageType(n).pipe(us(()=>{this.packageTypes.next(this.packageTypes.value.map(i=>i.iD==n.iD?n:i))}))}removePackageType(n){return this.packageTypeCommandHandlerClient.removePackageType(n).pipe(us(()=>{this.packageTypes.next(this.packageTypes.value.filter(i=>i.iD!=n))}))}};r.\u0275fac=function(i){return new(i||r)(Pt(fe.PackageTypeClient),Pt(er.PackageTypeClient),Pt(Yt),Pt(fe.PurchaseBatchClient))},r.\u0275prov=Ye({token:r,factory:r.\u0275fac,providedIn:"root"});let t=r;return t})();var FI=["productPackageDropdown"],AI=["packageTypeDropdown"],PI=["salesChannelDropdown"],DI=["productAutocomplete"],OI=(t,r)=>({profitRate:20,cost:t,commission:r}),BI=(t,r)=>({cost:t,commission:r}),MI=()=>[0,10,20],RI=()=>({width:"50vw"});function LI(t,r){t&1&&(d(0,"tr"),Y(1,"th",29),d(2,"th",29),v(3,"ID"),u(),d(4,"th"),v(5,"\u041D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435"),u(),d(6,"th",29),v(7,"\u041A\u043E\u043B\u0438\u0447\u0435\u0441\u0442\u0432\u043E"),u(),d(8,"th",29),v(9,"\u0417\u0430\u043A\u0443\u043F\u043E\u0447\u043D\u0430\u044F \u0446\u0435\u043D\u0430"),u()())}function NI(t,r){if(t&1){let e=pe();d(0,"p-inputnumber",33),Fe("ngModelChange",function(i){O(e);let o=h().$implicit;return ke(o.count,i)||(o.count=i),B(i)}),u()}if(t&2){let e=h().$implicit;Se("ngModel",e.count),g("min",0)("required",!0)("useGrouping",!1)}}function VI(t,r){if(t&1&&v(0),t&2){let e=h().$implicit;Ie(" ",e.count," ")}}function zI(t,r){if(t&1){let e=pe();d(0,"p-inputnumber",34),Fe("ngModelChange",function(i){O(e);let o=h().$implicit;return ke(o.price,i)||(o.price=i),B(i)}),u()}if(t&2){let e=h().$implicit;Se("ngModel",e.price),g("maxFractionDigits",2)("min",0)("required",!0)("useGrouping",!1)}}function UI(t,r){if(t&1&&v(0),t&2){let e=h().$implicit;Ie(" ",e.price," ")}}function WI(t,r){if(t&1){let e=pe();d(0,"tr")(1,"td")(2,"p-button",30),ee("click",function(){let i=O(e).rowIndex,o=h(3);return B(o.removeItem(o.calculation.items,i))}),u()(),d(3,"td"),v(4),u(),d(5,"td"),v(6),u(),d(7,"td",31)(8,"p-cellEditor"),P(9,NI,1,4,"ng-template",null,7,Z)(11,VI,1,1,"ng-template",null,8,Z),u()(),d(13,"td",32)(14,"p-cellEditor"),P(15,zI,1,5,"ng-template",null,7,Z)(17,UI,1,1,"ng-template",null,8,Z),u()()()}if(t&2){let e=r.$implicit;p(4),he(e.productID),p(2),he(e.product.name),p(),g("pEditableColumn",e.count),p(6),g("pEditableColumn",e.price)}}function jI(t,r){if(t&1&&(d(0,"tr")(1,"td",35),v(2,"\u0418\u0442\u043E\u0433\u043E:"),u(),d(3,"td",36),v(4),u(),d(5,"td",36),v(6),u()()),t&2){let e=h(3);p(4),Ie(" ",e.calculationTotalProductCount," "),p(2),Ie(" ",e.calculationTotalSum," ")}}function HI(t,r){if(t&1&&(d(0,"p-table",28),P(1,LI,10,0,"ng-template",null,4,Z)(3,WI,19,4,"ng-template",null,5,Z)(5,jI,7,2,"ng-template",null,6,Z),u()),t&2){let e=h(2);g("value",e.calculation.items)}}function $I(t,r){if(t&1&&(d(0,"div",37)(1,"div"),v(2),u()()),t&2){let e=r.$implicit;p(2),zi("",e.iD,": ",e.name)}}function GI(t,r){t&1&&v(0,"\u041F\u043E\u0438\u0441\u043A \u0442\u043E\u0432\u0430\u0440\u0430")}function KI(t,r){if(t&1&&(d(0,"div",37)(1,"div"),v(2),u()()),t&2){let e=r.$implicit;p(2),zi("",e.iD,": ",e.name)}}function XI(t,r){t&1&&v(0,"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0430\u0440\u0442\u0438\u043A\u0443\u043B")}function JI(t,r){t&1&&(d(0,"tr")(1,"th"),v(2,"\u0422\u0438\u043F \u0443\u043F\u0430\u043A\u043E\u0432\u043A\u0438"),u(),d(3,"th"),v(4,"\u041A\u043E\u043B\u0438\u0447\u0435\u0441\u0442\u0432\u043E"),u(),d(5,"th"),v(6,"\u0426\u0435\u043D\u0430 \u0443\u043F\u0430\u043A\u043E\u0432\u043A\u0438"),u(),d(7,"th"),v(8,"\u0421\u0443\u043C\u043C\u0430"),u()())}function qI(t,r){if(t&1&&(d(0,"tr")(1,"td",35),v(2,"\u0418\u0442\u043E\u0433\u043E:"),u(),d(3,"td",36),v(4),u()()),t&2){let e=h(2).$implicit,n=h(3);p(4),he(n.getPackagePrice(e))}}function QI(t,r){if(t&1&&(d(0,"span"),v(1),u()),t&2){let e=r.ngIf;p(),Ie(" ",e.name," ")}}function YI(t,r){if(t&1){let e=pe();d(0,"p-inputgroup")(1,"p-inputnumber",55),Fe("ngModelChange",function(i){O(e);let o=h(2).$implicit;return ke(o.amount,i)||(o.amount=i),B(i)}),u(),d(2,"p-inputgroup-addon"),Y(3,"span",56),Ze(4,"safeHtml"),u()()}if(t&2){let e=h().ngIf,n=h().$implicit,i=h(5);p(),Se("ngModel",n.amount),g("maxFractionDigits",e.decimalPlaces)("minFractionDigits",e.decimalPlaces)("min",0)("showButtons",!0)("step",1/i.Math.pow(10,e.decimalPlaces))("useGrouping",!1),p(2),g("innerHtml",_r(4,8,i.getUnitOfMeasure(e.unitOfMeasure)),Vn)}}function ZI(t,r){if(t&1&&(Le(0),v(1),Y(2,"span",57),Ze(3,"safeHtml"),Ne()),t&2){let e=h().ngIf,n=h().$implicit,i=h(5);p(),Ie(" ",n.amount),p(),g("innerHtml",_r(3,2,i.getUnitOfMeasure(e.unitOfMeasure)),Vn)}}function e5(t,r){t&1&&(d(0,"p-cellEditor"),P(1,YI,5,10,"ng-template",null,7,Z)(3,ZI,4,4,"ng-template",null,8,Z),u())}function t5(t,r){if(t&1){let e=pe();d(0,"p-inputgroup")(1,"p-inputNumber",58),Fe("ngModelChange",function(i){O(e);let o=h().$implicit;return ke(o.pricePerUom,i)||(o.pricePerUom=i),B(i)}),u(),d(2,"p-inputgroup-addon"),Y(3,"span",57),Ze(4,"safeHtml"),u()()}if(t&2){let e=h().$implicit,n=h(5);p(),Se("ngModel",e.pricePerUom),g("maxFractionDigits",2)("minFractionDigits",0)("min",0)("showButtons",!0)("step",1)("useGrouping",!1),p(2),g("innerHtml",_r(4,8,"\u20BD/"+n.getUnitOfMeasureByPackageTypeID(e.packageTypeID)),Vn)}}function r5(t,r){if(t&1&&(v(0),Y(1,"span",57)),t&2){let e=h().$implicit,n=h(5);Ie(" ",e.pricePerUom,"\u20BD/"),p(),g("innerHtml",n.getUnitOfMeasureByPackageTypeID(e.packageTypeID),Vn)}}function i5(t,r){if(t&1){let e=pe();d(0,"tr")(1,"td")(2,"p-button",52),ee("click",function(){let i=O(e).rowIndex,o=h(2).$implicit,a=h(3);return B(a.removeItem(o.salesItemPackages,i))}),u(),P(3,QI,2,1,"span",27),u(),d(4,"td",53),P(5,e5,5,0,"p-cellEditor",27),u(),d(6,"td",54)(7,"p-cellEditor"),P(8,t5,5,10,"ng-template",null,7,Z)(10,r5,2,2,"ng-template",null,8,Z),u()(),d(12,"td",36),v(13),Ze(14,"number"),u()()}if(t&2){let e=r.$implicit,n=h(5);p(3),g("ngIf",n.getPackageType(e.packageTypeID)),p(),g("pEditableColumn",e.amount),p(),g("ngIf",n.getPackageType(e.packageTypeID)),p(),g("pEditableColumn",e.pricePerUom),p(7),Ie(" ",Et(14,5,e.pricePerUom*e.amount,"1.2-2"),"\u20BD ")}}function n5(t,r){if(t&1&&(d(0,"p-table",28),P(1,JI,9,0,"ng-template",null,4,Z)(3,qI,5,1,"ng-template",null,6,Z)(5,i5,15,8,"ng-template",null,5,Z),u()),t&2){let e=h().$implicit;g("value",e.salesItemPackages)}}function o5(t,r){if(t&1&&(d(0,"div",37),Y(1,"div",59),Ze(2,"safeHtml"),u()),t&2){let e=r.$implicit,n=h(4);p(),g("innerHTML",_r(2,1,e.name+" ("+((e.prices==null||e.prices[0]==null?null:e.prices[0].price)??"-")+" \u20BD/"+n.getUnitOfMeasure(e.unitOfMeasure)+")"),Vn)}}function a5(t,r){if(t&1&&(d(0,"div",37)(1,"div"),v(2),u()()),t&2){let e=r.$implicit;p(2),he(e.name)}}function s5(t,r){t&1&&v(0,"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043F\u043B\u0430\u043D \u043F\u0440\u043E\u0434\u0430\u0436 ")}function l5(t,r){t&1&&(d(0,"tr")(1,"th"),v(2,"\u041A\u0430\u043D\u0430\u043B"),u(),d(3,"th",36),v(4,"\u0426\u0435\u043D\u0430"),u(),d(5,"th",36),v(6,"\u0421\u0435\u0431\u0435\u0441"),u(),d(7,"th",36),v(8,"\u041E\u0442\u0433\u0440\u0443\u0437\u043A\u0430"),u(),d(9,"th",36),v(10,"\u0420\u0435\u043A\u043B\u0430\u043C\u0430, \u20BD/\u043F\u043B\u0430\u043D"),u(),d(11,"th"),v(12,"\u041A\u043E\u043B-\u0432\u043E"),u(),d(13,"th",36),v(14,"\u041A\u043E\u043C\u0438\u0441\u0441\u0438\u044F"),u(),d(15,"th",36),v(16,"\u0412\u043E\u0437\u0432\u0440\u0430\u0442\u044B"),u(),Y(17,"th"),u())}function c5(t,r){if(t&1){let e=pe();d(0,"p-inputgroup")(1,"p-inputnumber",72),Fe("ngModelChange",function(i){O(e);let o=h(2).$implicit;return ke(o.price,i)||(o.price=i),B(i)}),u(),d(2,"p-inputgroup-addon"),v(3,"\u20BD"),u()()}if(t&2){let e=h(2).$implicit;p(),Se("ngModel",e.price),g("maxFractionDigits",2)("minFractionDigits",0)("min",0)("required",!0)("showButtons",!0)("step",1)("useGrouping",!1)}}function u5(t,r){if(t&1&&(d(0,"p-tag",73),v(1),Ze(2,"number"),Ze(3,"number"),u()),t&2){let e=h(2).ngIf,n=h().$implicit;g("severity",n.price<e.commission+e.cost?"danger":(n.price-(e.commission+e.cost))/e.cost>e.profitRate/100?"success":"info"),p(),zi(" ",Et(2,3,n.price-(e.commission+e.cost),"1.2-2"),"\u20BD/",Et(3,6,(n.price-(e.commission+e.cost))/e.cost*100,"1.0-2"),"% ")}}function d5(t,r){if(t&1&&(d(0,"div"),v(1),u(),ft(2,u5,4,9,"p-tag",73)),t&2){let e=h().ngIf,n=h().$implicit;p(),Ie(" ",n.price,"\u20BD "),p(),mt(e.cost&&n.price?2:-1)}}function p5(t,r){if(t&1){let e=pe();d(0,"p-inputgroup")(1,"p-inputnumber",74),Fe("ngModelChange",function(i){O(e);let o=h(2).$implicit;return ke(o.deliveryCost,i)||(o.deliveryCost=i),B(i)}),u(),d(2,"p-inputgroup-addon"),v(3,"\u20BD"),u()()}if(t&2){let e=h(2).$implicit;p(),Se("ngModel",e.deliveryCost),g("maxFractionDigits",2)("minFractionDigits",0)("min",0)("required",!0)("showButtons",!0)("step",50)("useGrouping",!1)}}function f5(t,r){if(t&1&&(d(0,"div",75),v(1),u()),t&2){let e=h(2).$implicit;p(),Ie(" ",e.deliveryCost,"\u20BD ")}}function m5(t,r){if(t&1){let e=pe();d(0,"p-inputgroup")(1,"p-inputnumber",72),Fe("ngModelChange",function(i){O(e);let o=h(2).$implicit;return ke(o.marketingBudget,i)||(o.marketingBudget=i),B(i)}),u(),d(2,"p-inputgroup-addon"),v(3,"\u20BD"),u()()}if(t&2){let e=h(2).$implicit;p(),Se("ngModel",e.marketingBudget),g("maxFractionDigits",2)("minFractionDigits",0)("min",0)("required",!0)("showButtons",!0)("step",100)("useGrouping",!1)}}function h5(t,r){if(t&1&&v(0),t&2){let e=h(2).$implicit;Ie(" ",e.marketingBudget," ")}}function g5(t,r){if(t&1){let e=pe();d(0,"p-inputgroup")(1,"p-inputnumber",76),Fe("ngModelChange",function(i){O(e);let o=h(2).$implicit;return ke(o.amount,i)||(o.amount=i),B(i)}),u(),d(2,"p-inputgroup-addon"),v(3,"\u0448\u0442"),u()()}if(t&2){let e=h(2).$implicit;p(),Se("ngModel",e.amount),g("min",0)("required",!0)("showButtons",!0)("step",10)("useGrouping",!1)}}function _5(t,r){if(t&1&&v(0),t&2){let e=h(2).$implicit;Ie(" ",e.amount,"\u0448\u0442 ")}}function x5(t,r){if(t&1){let e=pe();d(0,"p-inputgroup")(1,"p-inputnumber",72),Fe("ngModelChange",function(i){O(e);let o=h(2).$implicit;return ke(o.commissionMultiplier,i)||(o.commissionMultiplier=i),B(i)}),u(),d(2,"p-inputgroup-addon"),v(3,"%"),u()()}if(t&2){let e=h(2).$implicit;p(),Se("ngModel",e.commissionMultiplier),g("maxFractionDigits",1)("minFractionDigits",1)("min",0)("required",!0)("showButtons",!0)("step",.5)("useGrouping",!1)}}function v5(t,r){if(t&1&&(d(0,"div",77),v(1),u()),t&2){let e=h(2).$implicit;p(),Ie(" ",e.commissionMultiplier,"% ")}}function b5(t,r){if(t&1){let e=pe();d(0,"p-inputgroup")(1,"p-inputnumber",72),Fe("ngModelChange",function(i){O(e);let o=h(2).$implicit;return ke(o.returnPercentage,i)||(o.returnPercentage=i),B(i)}),u(),d(2,"p-inputgroup-addon"),v(3,"%"),u()()}if(t&2){let e=h(2).$implicit;p(),Se("ngModel",e.returnPercentage),g("maxFractionDigits",1)("minFractionDigits",1)("min",0)("required",!0)("showButtons",!0)("step",.5)("useGrouping",!1)}}function y5(t,r){if(t&1&&v(0),t&2){let e=h(2).$implicit;Ie(" ",e.returnPercentage,"% ")}}function C5(t,r){if(t&1){let e=pe();d(0,"tr")(1,"td",63)(2,"div"),v(3),u()(),d(4,"td",64)(5,"p-cellEditor"),P(6,c5,4,8,"ng-template",null,7,Z)(8,d5,3,2,"ng-template",null,8,Z),u()(),d(10,"td",65)(11,"div",66),v(12),Ze(13,"number"),u()(),d(14,"td",67)(15,"p-cellEditor"),P(16,p5,4,8,"ng-template",null,7,Z)(18,f5,2,1,"ng-template",null,8,Z),u()(),d(20,"td",68)(21,"p-cellEditor"),P(22,m5,4,8,"ng-template",null,7,Z)(24,h5,1,1,"ng-template",null,8,Z),u()(),d(26,"td",69)(27,"p-cellEditor"),P(28,g5,4,6,"ng-template",null,7,Z)(30,_5,1,1,"ng-template",null,8,Z),u()(),d(32,"td",70)(33,"p-cellEditor"),P(34,x5,4,8,"ng-template",null,7,Z)(36,v5,2,1,"ng-template",null,8,Z),u()(),d(38,"td",71)(39,"p-cellEditor"),P(40,b5,4,8,"ng-template",null,7,Z)(42,y5,1,1,"ng-template",null,8,Z),u()(),d(44,"td",63)(45,"p-button",30),ee("click",function(){O(e);let i=h().rowIndex,o=h().$implicit,a=h(3);return B(a.removeItem(o.salesPlans,i))}),u()()()}if(t&2){let e=r.ngIf,n=h().$implicit;p(3),Ie(" ",n.salesChannel==null?null:n.salesChannel.name," "),p(),g("pEditableColumn",n.price),p(8),Ie(" ",Et(13,7,e.commission+e.cost,"1.2-2"),"\u20BD "),p(8),g("pEditableColumn",n.marketingBudget),p(6),g("pEditableColumn",n.amount),p(6),g("pEditableColumn",n.commissionMultiplier),p(6),g("pEditableColumn",n.returnPercentage)}}function w5(t,r){if(t&1){let e=pe();d(0,"p-datepicker",78),Fe("ngModelChange",function(i){O(e);let o=h().$implicit;return ke(o.deliveryDate,i)||(o.deliveryDate=i),B(i)}),u()}if(t&2){let e=h().$implicit;Se("ngModel",e.deliveryDate),g("readonlyInput",!0)}}function S5(t,r){if(t&1&&(v(0),Ze(1,"date")),t&2){let e=h().$implicit;Ie(" ",Et(1,1,e.deliveryDate,"dd.MM.yyyy")," ")}}function k5(t,r){if(t&1){let e=pe();d(0,"p-inputgroup")(1,"p-inputnumber",72),Fe("ngModelChange",function(i){O(e);let o=h().$implicit;return ke(o.commissionAddition,i)||(o.commissionAddition=i),B(i)}),u(),d(2,"p-inputgroup-addon"),v(3,"\u20BD"),u()()}if(t&2){let e=h().$implicit,n=qo(0);p(),Se("ngModel",e.commissionAddition),g("maxFractionDigits",2)("minFractionDigits",2)("min",n.price)("required",!0)("showButtons",!0)("step",5)("useGrouping",!1)}}function T5(t,r){if(t&1&&(d(0,"div",79),v(1),u()),t&2){let e=h().$implicit;p(),Ie(" ",e.commissionAddition,"\u20BD ")}}function E5(t,r){if(t&1){let e=pe();d(0,"p-inputgroup")(1,"p-inputnumber",72),Fe("ngModelChange",function(i){O(e);let o=h().$implicit;return ke(o.returnCost,i)||(o.returnCost=i),B(i)}),u(),d(2,"p-inputgroup-addon"),v(3,"\u20BD"),u()()}if(t&2){let e=h().$implicit,n=h(4);p(),Se("ngModel",e.returnCost),g("maxFractionDigits",2)("minFractionDigits",2)("min",n.getBackwardLogisticPrice(e))("required",!0)("showButtons",!0)("step",5)("useGrouping",!1)}}function I5(t,r){if(t&1&&v(0),t&2){let e=h().$implicit;Ie(" ",e.returnCost,"\u20BD ")}}function F5(t,r){if(t&1){let e=pe();d(0,"span",83),ee("click",function(){let i=O(e).ngIf,o=h(3).$implicit;return B(o.price=i)}),v(1),Ze(2,"number"),u()}if(t&2){let e=r.ngIf,n=h().$implicit;g("pTooltip","\u041E\u0442\u043F\u0443\u0441\u043A\u043D\u0430\u044F \u0446\u0435\u043D\u0430 \u0434\u043B\u044F \u043F\u0440\u0438\u0431\u044B\u043B\u0438 "+n+"%"),p(),zi(" ",Et(2,3,e,"1.2-2"),"\u20BD \u0434\u043B\u044F ",n,"% ")}}function A5(t,r){if(t&1&&(d(0,"div"),P(1,F5,3,6,"span",82),u()),t&2){let e=r.$implicit,n=h().ngIf,i=h().$implicit,o=h(4);p(),g("ngIf",o.Math.ceil((n.cost*(1+e/100)+i.commissionAddition)*100/(1-i.commissionMultiplier/100))/100)}}function P5(t,r){if(t&1&&(v(0," x "),d(1,"span",87),v(2),u()),t&2){h(5);let e=qo(0);p(2),he(e.multiplier)}}function D5(t,r){if(t&1&&(v(0," + "),d(1,"span",88),v(2),u()),t&2){h(5);let e=qo(0);p(2),he(e.addition)}}function O5(t,r){if(t&1&&(v(0," + "),d(1,"span",89),v(2),u(),v(3," x "),d(4,"span",90),v(5),u()),t&2){let e=h(5).$implicit,n=qo(0);p(2),he(e.price),p(3),he(n.priceMultiplier)}}function B5(t,r){if(t&1&&(d(0,"span",86),v(1),u(),ft(2,P5,3,1),ft(3,D5,3,1),ft(4,O5,6,2),v(5," = ")),t&2){h(4);let e=qo(0);p(),he(e.baseCost),p(),mt(e.multiplier!=1?2:-1),p(),mt(e.addition!=0?3:-1),p(),mt(e.priceMultiplier?4:-1)}}function M5(t,r){if(t&1&&(d(0,"div"),ft(1,B5,6,4),d(2,"span",85),v(3),u()()),t&2){h(3);let e=qo(0);p(),mt(e.multiplier!=1||e.addition!=0||e.priceMultiplier!=0?1:-1),p(2),Ie("",e.price,"\u20BD")}}function R5(t,r){if(t&1){let e=pe();d(0,"p-select",84),Fe("ngModelChange",function(i){O(e);let o=h(2).$implicit;return ke(o.selectedLogisticCoefficient,i)||(o.selectedLogisticCoefficient=i),B(i)}),ee("onChange",function(){O(e);let i=h(2).$implicit,o=h(4);return B(o.updateReturnCost(i))}),u(),ft(1,M5,4,2,"div")}if(t&2){let e=h(2).$implicit;Se("ngModel",e.selectedLogisticCoefficient),g("options",e.salesChannel==null?null:e.salesChannel.logisticCoefficients),p(),mt(e.selectedLogisticCoefficient?1:-1)}}function L5(t,r){if(t&1&&(d(0,"tr")(1,"td"),P(2,A5,2,1,"div",26),u(),Y(3,"td")(4,"td"),d(5,"td",36),ft(6,R5,2,3),u(),d(7,"td",36)(8,"div",80),v(9),u(),d(10,"div",81),v(11),u()()()),t&2){let e=h().$implicit,n=h(4);p(2),g("ngForOf",Je(4,MI)),p(4),mt(!(e.salesChannel==null||e.salesChannel.logisticCoefficients==null)&&e.salesChannel.logisticCoefficients.length?6:-1),p(3),Ie(" ",e.salesChannel==null?null:e.salesChannel.CancelledSaleHandlingPrice,"\u20BD "),p(2),Ie(" ",n.getBackwardLogisticPrice(e),"\u20BD ")}}function N5(t,r){if(t&1&&(Tu(0),P(1,C5,46,10,"tr",27),d(2,"tr")(3,"td",60)(4,"p-cellEditor"),P(5,w5,1,2,"ng-template",null,7,Z)(7,S5,2,4,"ng-template",null,8,Z),u()(),d(9,"td",61)(10,"p-cellEditor"),P(11,k5,4,8,"ng-template",null,7,Z)(13,T5,2,1,"ng-template",null,8,Z),u()(),d(15,"td",62)(16,"p-cellEditor"),P(17,E5,4,8,"ng-template",null,7,Z)(19,I5,1,1,"ng-template",null,8,Z),u()()(),P(21,L5,12,5,"tr",27)),t&2){let e=r.$implicit,n=h().$implicit,i=h().$implicit,o=h(2);Eu(o.getLogisticPrice(e)),p(),g("ngIf",di(5,OI,o.getSelfCost(n,e,i),o.getCommission(e))),p(8),g("pEditableColumn",e.commissionAddition),p(6),g("pEditableColumn",e.returnCost),p(6),g("ngIf",di(8,BI,o.getSelfCost(n,e,i),o.getCommission(e)))}}function V5(t,r){if(t&1){let e=pe();Le(0),d(1,"p-accordion-panel",38)(2,"p-accordion-header"),v(3),u(),d(4,"p-accordion-content")(5,"div",39)(6,"p-button",40),ee("click",function(){let i=O(e).index,o=h().$implicit,a=h(2);return B(a.removeItem(o.salesItems,i))}),u(),d(7,"h5"),v(8,"\u041E\u0444\u043E\u0440\u043C\u043B\u0435\u043D\u0438\u0435 \u0443\u043F\u0430\u043A\u043E\u0432\u043A\u0438"),u(),d(9,"div",41)(10,"div",42)(11,"p-floatlabel",43)(12,"input",44),Fe("ngModelChange",function(i){let o=O(e).$implicit;return ke(o.name,i)||(o.name=i),B(i)}),u(),d(13,"label",45),v(14,"\u041D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435"),u()()(),d(15,"div",42)(16,"p-inputgroup")(17,"p-floatlabel",43)(18,"p-inputnumber",46),ee("onInput",function(){let i=O(e).$implicit,o=h(3);return B(o.onVolumeUpdated(i))}),Fe("ngModelChange",function(i){let o=O(e).$implicit;return ke(o.volume,i)||(o.volume=i),B(i)}),u(),d(19,"label",47),v(20,"\u041E\u0431\u044A\u0451\u043C"),u()(),d(21,"p-inputgroup-addon"),v(22,"\u043B"),u()()(),d(23,"div",42)(24,"p-inputgroup")(25,"p-floatlabel",43)(26,"p-inputnumber",48),Fe("ngModelChange",function(i){let o=O(e).$implicit;return ke(o.packagingPrice,i)||(o.packagingPrice=i),B(i)}),u(),d(27,"label",49),v(28,"\u0421\u0442\u043E\u0438\u043C\u043E\u0441\u0442\u044C \u0444\u0430\u0441\u043E\u0432\u043A\u0438"),u()(),d(29,"p-inputgroup-addon"),v(30,"\u20BD"),u()()()(),P(31,n5,7,1,"p-table",23),d(32,"p-select",50,9),ee("onChange",function(i){let o=O(e).$implicit,a=h(3);return B(a.addSalesItemPackage(o,i.value))}),P(34,o5,3,3,"ng-template",null,1,Z),u()(),d(36,"div",39)(37,"p-select",51,10),Ze(39,"async"),ee("onChange",function(i){let o=O(e).$implicit,a=h(3);return B(a.addSalesPlan(o,i.value))}),P(40,a5,3,1,"ng-template",null,1,Z)(42,s5,1,0,"ng-template",null,2,Z),u(),d(44,"p-table",28),P(45,l5,18,0,"ng-template",null,4,Z)(47,N5,22,11,"ng-template",null,5,Z),u()()()(),Ne()}if(t&2){let e=r.$implicit,n=h(3);p(3),Jo(" \u0410\u0440\u0442\u0438\u043A\u0443\u043B: ",e.productPackage.iD,", ",e.productPackage.productCount,"\u0448\u0442, ",e.name," "),p(9),Se("ngModel",e.name),p(6),Se("ngModel",e.volume),g("maxFractionDigits",1)("minFractionDigits",0)("min",.1)("showButtons",!0)("step",.1)("useGrouping",!1),p(8),Se("ngModel",e.packagingPrice),g("maxFractionDigits",2)("minFractionDigits",0)("showButtons",!0)("step",1)("useGrouping",!1),p(5),g("ngIf",e.salesItemPackages==null?null:e.salesItemPackages.length),p(),g("options",n.getAvailablePackageTypes(e)),p(5),g("autoDisplayFirst",!1)("options",_r(39,22,n.salesChannels)),p(7),g("value",e.salesPlans)}}function z5(t,r){if(t&1&&(Le(0),P(1,V5,49,24,"ng-container",26),Ne()),t&2){let e=r.$implicit;p(),g("ngForOf",e.salesItems)}}function U5(t,r){if(t&1){let e=pe();Le(0),d(1,"p-dialog",91),Fe("visibleChange",function(i){O(e);let o=h(2);return ke(o.duplicateProductDialogVisible,i)||(o.duplicateProductDialogVisible=i),B(i)}),d(2,"p",92),v(3),u()(),Ne()}if(t&2){let e=h(2);p(),Qt(Je(7,RI)),Se("visible",e.duplicateProductDialogVisible),g("draggable",!1)("modal",!0)("resizable",!1),p(2),Ie(" ",e.addedProduct.name," ")}}function W5(t,r){if(t&1){let e=pe();d(0,"div",12)(1,"h5"),v(2,"\u0420\u0430\u0441\u0447\u0451\u0442 \u0434\u043E\u0445\u043E\u0434\u043D\u043E\u0441\u0442\u0438 \u043F\u043E \u0430\u0440\u0442\u0438\u043A\u0443\u043B\u0443"),u(),d(3,"p-floatlabel")(4,"input",13),Fe("ngModelChange",function(i){O(e);let o=h();return ke(o.calculation.name,i)||(o.calculation.name=i),B(i)}),u(),d(5,"label",14),v(6,"\u041D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435 \u0440\u0430\u0441\u0447\u0451\u0442\u0430"),u()(),d(7,"p-floatlabel")(8,"p-datepicker",15),Fe("ngModelChange",function(i){O(e);let o=h();return ke(o.calculation.date,i)||(o.calculation.date=i),B(i)}),u(),d(9,"label",16),v(10,"\u0414\u0430\u0442\u0430 \u0437\u0430\u043A\u0443\u043F\u043A\u0438"),u()(),d(11,"div",17)(12,"p-button",18),ee("click",function(){O(e);let i=h();return B(i.savePurchaseBatch())}),u()(),d(13,"p-tabs",19)(14,"p-tablist")(15,"p-tab",19),Y(16,"i",20),d(17,"span"),v(18,"\u0417\u0430\u043A\u0443\u043F\u043A\u0430"),u()(),d(19,"p-tab",21),Y(20,"i",22),d(21,"span"),v(22,"\u0422\u0438\u043F\u043E\u0444\u043E\u0440\u043C\u0430\u0442\u044B"),u()()(),d(23,"p-tabpanels")(24,"p-tabpanel",19)(25,"p-card"),P(26,HI,7,1,"p-table",23),d(27,"p-autoComplete",24,0),Ze(29,"async"),ee("completeMethod",function(i){O(e);let o=h();return B(o.findProductsByName(i))})("onSelect",function(i){O(e);let o=h();return B(o.addProduct(i))}),P(30,$I,3,2,"ng-template",null,1,Z)(32,GI,1,0,"ng-template",null,2,Z),u()()(),d(34,"p-tabpanel",21)(35,"p-card")(36,"p-select",25,3),ee("onChange",function(i){O(e);let o=h();return B(o.addSalesItem(i.value))}),Fe("ngModelChange",function(i){O(e);let o=h();return ke(o.selectedProductPackage,i)||(o.selectedProductPackage=i),B(i)}),P(38,KI,3,2,"ng-template",null,1,Z)(40,XI,1,0,"ng-template",null,2,Z),u(),d(42,"p-accordion"),P(43,z5,2,1,"ng-container",26),u()()()()(),P(44,U5,4,8,"ng-container",27),u()}if(t&2){let e=h();p(4),Se("ngModel",e.calculation.name),p(4),Se("ngModel",e.calculation.date),g("readonlyInput",!0),p(18),g("ngIf",e.calculation.items.length),p(),g("minLength",3)("suggestions",_r(29,10,e.products)),p(9),Se("ngModel",e.selectedProductPackage),g("options",e.batchPackages),p(7),g("ngForOf",e.calculation.items),p(),g("ngIf",e.addedProduct)}}var Nm=(()=>{let r=class r extends ei{constructor(n,i,o,a,l,c,f,m){super(m),this.route=n,this.productClient=i,this.purchaseBatchCommandHandlerClient=o,this.salesChannelClient=a,this.messageService=l,this.purchaseService=c,this.router=f,this.productSearchSubject=new bn,this.purchaseBatchIDSubject=new bn,this.batchPackages=[],this.products=new ur([]),this.salesChannels=new ur([]),this.Math=Math,this.loading=!1}get duplicateProductDialogVisible(){return!!this.addedProduct}set duplicateProductDialogVisible(n){n||(this.addedProduct=null)}get calculationTotalProductCount(){return this.calculation.items.reduce((n,i)=>Math.round(n+i.count),0)}get calculationTotalSum(){return this.calculation.items.reduce((n,i)=>Math.round(n+i.price*i.count),0)}ngOnInit(){this.titleService.setTitle("\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u0435 \u0437\u0430\u043A\u0443\u043F\u043A\u0438"),this.purchaseBatchIDSubject.pipe(Yr(this.destroyed)).pipe(xi(i=>this.purchaseService.getBatch(i).pipe(ge(o=>(this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0438 \u0437\u0430\u043A\u0443\u043F\u043A\u0438",severity:"error",detail:o}),it))))).subscribe(i=>{this.batchPackages=i.items.map(o=>o.product.packages).flat(),i.items.forEach(o=>{let a=o.product.packages.reduce((l,c)=>(l.set(c.iD,c),l),new Map);o.salesItems.forEach(l=>{let c={productPackage:a.get(l.productPackageID)};Object.assign(l,c);let f=this.salesChannels.getValue();l.salesPlans.forEach(m=>{let C=f.find(y=>y.iD==m.salesChannelID);if(C){let y=m.salesChannel?.logisticCoefficients;Object.assign(m,{salesChannel:C,selectedLogisticCoefficient:y?.length?y[y.length-1]:null,baseLogisticCost:this.getBaseLogisticCost(l.volume,C.logisticPrices),baseBackwardLogisticCost:this.getBaseLogisticCost(l.volume,C.backwardLogisticPrices)})}})})}),this.calculation=i,this.titleService.setTitle(`\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u0435 \u0437\u0430\u043A\u0443\u043F\u043A\u0438 - ${i.name}`)}),this.productSearchSubject.pipe(Yr(this.destroyed)).pipe(xi(i=>this.productClient.findProducts(new fe.FindProductsModel({count:10,offset:0,name:i,excludedIDs:this.calculation.items.map(o=>o.productID)})).pipe(ge(o=>(this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u043E\u0438\u0441\u043A\u0430 \u0442\u043E\u0432\u0430\u0440\u043E\u0432",severity:"error",detail:o}),it))))).subscribe(i=>{this.products.next(i.items)}),this.salesChannelClient.getSalesChannels().pipe(ge(i=>(this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0438 \u0441\u043F\u0438\u0441\u043A\u0430 \u043A\u0430\u043D\u0430\u043B\u043E\u0432 \u043F\u0440\u043E\u0434\u0430\u0436",severity:"error",detail:i}),it))).subscribe(i=>{let o=i.map(a=>{let l=a.logisticCoefficients.sort((f,m)=>f.priority-m.priority||f.name.localeCompare(m.name));return a.logisticPrices.sort((f,m)=>m.maxVolume-f.maxVolume),a.backwardLogisticPrices.sort((f,m)=>m.maxVolume-f.maxVolume),Object.assign(a,{logisticCoefficients:l})});this.salesChannels.next(o)});let n=+this.route.snapshot.paramMap.get("id");n>0&&n!=this.calculation?.iD?this.purchaseBatchIDSubject.next(n):this.calculation=new fe.PurchaseBatch({date:new Date,status:fe.PurchaseBatchStatus.Unknown,items:[],name:"\u041D\u043E\u0432\u0430\u044F \u0437\u0430\u043A\u0443\u043F\u043A\u0430",iD:0})}addSalesPlan(n,i){if(i){n.salesPlans||(n.salesPlans=[]);let o=this.getSalesItemProductPackage(n),a=this.getProductPackageBatchItem(o),l={salesItem:null,salesItemID:n.iD,iD:0,salesPerMonth:0,salesChannel:i,salesChannelID:i.iD,commissionAddition:0,commissionMultiplier:0,returnPercentage:0,returnCost:0,amount:0,marketingBudget:0,deliveryCost:0,deliveryDate:new Date,status:fe.SalesPlanStatus.InProcess,price:a.price+n.packagingPrice+this.getPackagePrice(n),baseLogisticCost:this.getBaseLogisticCost(n.volume,i.logisticPrices),baseBackwardLogisticCost:this.getBaseLogisticCost(n.volume,i.backwardLogisticPrices),selectedLogisticCoefficient:null},c=new fe.SalesPlan(l);n.salesPlans.push(c),this.salesChannelDropdown.clear(null)}}getSalesItemProductPackage(n){return this.getProductPackageBatchItem(n.productPackage).product.packages.find(a=>a.iD==n.productPackageID)}getProductPackageBatchItem(n){return this.calculation.items.find(o=>o.productID==n.productID)}addSalesItem(n){if(n){let i=this.getProductPackageBatchItem(n),o=this.createNewSalesItem(n,i);i.salesItems.push(o),this.productPackageDropdown.clear()}}removeItem(n,i){n.splice(i,1)}getAvailablePackageTypes(n){let i=[],o=new Set(n.salesItemPackages.map(l=>l.packageTypeID)),a=this.purchaseService.getPackageTypes();for(let l of a)o.has(l.iD)||i.push(l);return i}addSalesItemPackage(n,i){i&&(n.salesItemPackages.push(new fe.SalesItemPackage({packageTypeID:i.iD,amount:0,pricePerUom:i.prices?.[0]?.price??0,salesItemID:n.iD})),this.packageTypeDropdown.clear(null))}getSelfCost(n,i,o){return this.purchaseService.getSalesPlanSelfCost(n,i,o)}getCommission(n){return this.purchaseService.getSalesPlanCommission(n)}getPackagePrice(n){return this.purchaseService.getSalesItemCosts(n)}getPackageType(n){return this.purchaseService.getPackageType(n)}findProductsByName(n){n.query.trim().length>2&&this.productSearchSubject.next(n.query)}addProduct(n){let i=n.value;if(i){this.productAutocomplete.clear();let o=this.calculation.items.find(a=>a.productID==i.iD);if(this.selectedProduct=null,o)this.addedProduct=i;else{let a=new fe.PurchaseBatchItem({productID:i.iD,count:0,product:i,purchaseBatchID:this.calculation.iD,price:0,salesItems:[],iD:0});this.calculation.items.push(a),this.batchPackages.push(...i.packages)}}}savePurchaseBatch(){this.loading=!0,this.purchaseBatchCommandHandlerClient.updatePurchaseBatch(this.calculation).pipe(ge(n=>(this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430 \u0441\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u0438\u044F \u0437\u0430\u043A\u0443\u043F\u043A\u0438",severity:"error",detail:n}),this.loading=!1,it))).subscribe(n=>{this.calculation.iD||this.router.navigate(["purchase","edit",{id:n}]),this.purchaseService.getBatch(n).pipe(ge(i=>(this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0438 \u0437\u0430\u043A\u0443\u043F\u043A\u0438",severity:"error",detail:i}),this.loading=!1,it))).subscribe(i=>{this.calculation=i,this.loading=!1,this.messageService.add({summary:"\u0423\u0441\u043F\u0435\u0445",severity:"success",detail:"\u0421\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u0438\u0435 \u0437\u0430\u043A\u0443\u043F\u043A\u0438 \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043D\u043E"})})})}getUnitOfMeasureByPackageTypeID(n){let o=this.purchaseService.getPackageTypes().find(a=>a.iD==n);return o?this.getUnitOfMeasure(o.unitOfMeasure):"?"}getUnitOfMeasure(n){let i;switch(n){case fe.UnitOfMeasure.Piece:i="\u0448\u0442";break;case fe.UnitOfMeasure.SquareMeter:i="\u043C&sup2;";break;default:i="";break}return i}onVolumeUpdated(n){n.salesPlans.forEach(i=>{i.baseLogisticCost=this.getBaseLogisticCost(n.volume,i.salesChannel.logisticPrices),i.baseBackwardLogisticCost=this.getBaseLogisticCost(n.volume,i.salesChannel.backwardLogisticPrices)})}createNewSalesItem(n,i){return new fe.SalesItem({packagingPrice:0,volume:1,salesItemPackages:[],salesPlans:[],iD:0,name:"\u0441\u0442\u0430\u043D\u0434\u0430\u0440\u0442\u043D\u0430\u044F \u0443\u043F\u0430\u043A\u043E\u0432\u043A\u0430",productPackageID:n.iD,productPackage:n,purchaseBatchItemID:i.iD})}getBaseLogisticCost(n,i){if(n<=0)return 0;let o=0,a,l=n;if(i?.length)for(let c=0;c<=i.length;c++){let f=c==i.length?void 0:i[c],m=l-(f?.maxVolume??0);if(a&&(m>0||f==null)&&(o+=Math.ceil(a.additive?m:l)*(a.pricePerUnit??0)+(a.basePrice??0),!a?.additive))break;l>f.maxVolume&&(l=f?.maxVolume??0),a=f}return o}getLogisticPrice(n){let i=n.baseLogisticCost??0,o=n.selectedLogisticCoefficient?.salesPriceMultiplier??0,a=n.selectedLogisticCoefficient?.logisticPriceMultiplier??1,l=n.selectedLogisticCoefficient?.logisticPriceAddition??0;return{price:Math.floor((i*a+l+n.price*o)*100)/100,addition:l,multiplier:a,priceMultiplier:o,baseCost:i}}getBackwardLogisticPrice(n){let i=n.baseBackwardLogisticCost??0,o=n.selectedLogisticCoefficient?.salesPriceMultiplier??0,a=n.selectedLogisticCoefficient?.logisticPriceMultiplier??1,l=n.selectedLogisticCoefficient?.logisticPriceAddition??0,c=n.salesChannel?.cancelledSaleHandlingPrice??0;return Math.floor((i*a+l+c+n.price*o)*100)/100}updateReturnCost(n){n.returnCost=(n.salesChannel?.cancelledSaleHandlingPrice??0)+this.getBackwardLogisticPrice(n)}};r.\u0275fac=function(i){return new(i||r)(Pe(Sa),Pe(fe.ProductClient),Pe(er.PurchaseBatchClient),Pe(fe.SalesChannelClient),Pe(Yt),Pe(Fl),Pe(jn),Pe(Zr))},r.\u0275cmp=He({type:r,selectors:[["app-purchase-editor"]],viewQuery:function(i,o){if(i&1&&(Nt(FI,5),Nt(AI,5),Nt(PI,5),Nt(DI,5)),i&2){let a;Te(a=Ee())&&(o.productPackageDropdown=a.first),Te(a=Ee())&&(o.packageTypeDropdown=a.first),Te(a=Ee())&&(o.salesChannelDropdown=a.first),Te(a=Ee())&&(o.productAutocomplete=a.first)}},features:[lt],decls:2,vars:1,consts:[["productAutocomplete",""],["item",""],["selectedItem",""],["productPackageDropdown",""],["header",""],["body",""],["footer",""],["input",""],["output",""],["packageTypeDropdown",""],["salesChannelDropdown",""],["class","card",4,"ngIf"],[1,"card"],["id","productName","pInputText","","type","text",1,"w-full","md:w-[30rem]","mb-8","p-4",3,"ngModelChange","ngModel"],["for","productName",1,"font-bold"],["dateFormat","dd.mm.yy","input","date","placeholder","\u0414\u0430\u0442\u0430 \u0437\u0430\u043A\u0443\u043F\u043A\u0438",3,"ngModelChange","ngModel","readonlyInput"],["dateFormat","dd.mm.yy","for","date",1,"font-bold"],[1,"mt-4"],["icon","pi pi-save","label","\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C",3,"click"],["value","0"],[1,"pi","pi-shopping-cart","pi-fw"],["value","1"],[1,"pi","pi-box","pi-fw"],[3,"value",4,"ngIf"],["styleClass","mt-2","field","name","placeholder","\u041F\u043E\u0438\u0441\u043A \u0442\u043E\u0432\u0430\u0440\u0430","styleClass","mb-4",3,"completeMethod","onSelect","minLength","suggestions"],["appendTo","body","optionGroupChildren","product.packages","placeholder","\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0430\u0440\u0442\u0438\u043A\u0443\u043B","styleClass","m-4",3,"onChange","ngModelChange","ngModel","options"],[4,"ngFor","ngForOf"],[4,"ngIf"],[3,"value"],["width","10%"],["icon","pi pi-trash",3,"click"],["pEditableColumnField","count",1,"text-right",3,"pEditableColumn"],["pEditableColumnField","price",1,"text-right",3,"pEditableColumn"],[3,"ngModelChange","ngModel","min","required","useGrouping"],[3,"ngModelChange","ngModel","maxFractionDigits","min","required","useGrouping"],["colspan","3",1,"text-right"],[1,"text-right"],[1,"flex","items-center","gap-2"],["transitionOptions","50ms"],[1,"card","m-2"],["icon","pi pi-trash","label","\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0442\u0438\u043F\u043E\u0444\u043E\u0440\u043C\u0430\u0442","styleClass","mb-4",3,"click"],[1,"grid","grid-cols-3","grid-rows-1","gap-4"],[1,"xs:grid-cols-12"],["variant","on"],["inputId","name","maxlength","100","pInputText","",3,"ngModelChange","ngModel"],["for","name"],["inputId","volume",3,"onInput","ngModelChange","ngModel","maxFractionDigits","minFractionDigits","min","showButtons","step","useGrouping"],["for","volume"],["inputId","packagingPrice",3,"ngModelChange","ngModel","maxFractionDigits","minFractionDigits","showButtons","step","useGrouping"],["for","packagingPrice"],["appendTo","body","optionLabel","name","placeholder","\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043E\u0444\u043E\u0440\u043C\u043B\u0435\u043D\u0438\u0435","styleClass","m-4",3,"onChange","options"],["appendTo","body","optionLabel","\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043F\u043B\u0430\u043D \u043F\u0440\u043E\u0434\u0430\u0436","placeholder","\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043F\u043B\u0430\u043D \u043F\u0440\u043E\u0434\u0430\u0436","styleClass","m-4",3,"onChange","autoDisplayFirst","options"],["icon","pi pi-trash","styleClass","p-button-sm",3,"click"],["pEditableColumnField","amount",1,"text-right",3,"pEditableColumn"],["pEditableColumnField","pricePerUom",1,"text-right",3,"pEditableColumn"],[3,"ngModelChange","ngModel","maxFractionDigits","minFractionDigits","min","showButtons","step","useGrouping"],[1,"p-inputgroup-addon",3,"innerHtml"],[3,"innerHtml"],["emptyValue","empty",3,"ngModelChange","ngModel","maxFractionDigits","minFractionDigits","min","showButtons","step","useGrouping"],[3,"innerHTML"],["pEditableColumn","",1,"text-right"],["pEditableColumnField","commissionAddition",1,"text-right",3,"pEditableColumn"],["pEditableColumnField","returnCost",1,"text-right",3,"pEditableColumn"],["rowspan","3"],["pEditableColumnField","price","rowspan","2",1,"text-right",3,"pEditableColumn"],["rowspan","2",1,"text-right"],["pTooltip","\u0421\u0435\u0431\u0435\u0441\u0442\u043E\u0438\u043C\u043E\u0441\u0442\u044C \u043F\u0440\u0438 \u0442\u0435\u043A\u0443\u0449\u0435\u0439 \u043E\u0442\u043F\u0443\u0441\u043A\u043D\u043E\u0439 \u0446\u0435\u043D\u0435"],["pEditableColumn",""],["pEditableColumnField","marketingBudget","rowspan","3",1,"text-right",3,"pEditableColumn"],["pEditableColumnField","amount","rowspan","3",1,"text-right",3,"pEditableColumn"],["pEditableColumnField","commissionMultiplier",1,"text-right",3,"pEditableColumn"],["pEditableColumnField","returnPercentage",1,"text-right",3,"pEditableColumn"],[3,"ngModelChange","ngModel","maxFractionDigits","minFractionDigits","min","required","showButtons","step","useGrouping"],[3,"severity"],["inputId","deliveryCost",3,"ngModelChange","ngModel","maxFractionDigits","minFractionDigits","min","required","showButtons","step","useGrouping"],["pTooltip","\u0417\u0430\u0442\u0440\u0430\u0442\u044B \u043D\u0430 \u0434\u043E\u0441\u0442\u0430\u0432\u043A\u0443 \u043F\u0430\u0440\u0442\u0438\u0438 \u0434\u043E \u0442\u043E\u0447\u043A\u0438 \u0440\u0435\u0430\u043B\u0438\u0437\u0430\u0446\u0438\u0438 (\u0434\u043E\u0441\u0442\u0430\u0432\u043A\u0430 \u0434\u043E \u0442\u0440\u0430\u043D\u0437\u0438\u0442\u043D\u043E\u0433\u043E \u0441\u043A\u043B\u0430\u0434\u0430, \u043A\u0440\u043E\u0441\u0441-\u0434\u043E\u043A\u0438\u043D\u0433 \u0438 \u0442.\u043F.)",1,"text-right"],[3,"ngModelChange","ngModel","min","required","showButtons","step","useGrouping"],["pTooltip","\u0421\u0443\u043C\u043C\u0430 \u0432\u0441\u0435\u0445 \u043F\u0440\u043E\u0446\u0435\u043D\u0442\u043D\u044B\u0445 \u043A\u043E\u043C\u0438\u0441\u0441\u0438\u0439 (\u043A\u043E\u043C\u0438\u0441\u0441\u0438\u044F \u043A\u0430\u043D\u0430\u043B\u0430 \u043F\u0440\u043E\u0434\u0430\u0436, \u044D\u043A\u0432\u0430\u0439\u0440\u0438\u043D\u0433 \u0438 \u0442.\u043F.)"],["appendTo","body","dateFormat","dd.mm.yy","input","date","placeholder","\u0414\u0430\u0442\u0430 \u043E\u0442\u0433\u0440\u0443\u0437\u043A\u0438",3,"ngModelChange","ngModel","readonlyInput"],["pTooltip","\u0421\u0443\u043C\u043C\u0430 \u0432\u0441\u0435\u0445 \u0444\u0438\u043A\u0441\u0438\u0440\u043E\u0432\u0430\u043D\u043D\u044B\u0445 \u043A\u043E\u043C\u0438\u0441\u0441\u0438\u0439 (\u0434\u043E\u0441\u0442\u0430\u0432\u043A\u0430 \u0434\u043E \u043F\u043E\u043A\u0443\u043F\u0430\u0442\u0435\u043B\u044F, \u041F\u0412\u0417 \u0438 \u0442.\u043F.)"],["pTooltip","\u0421\u0442\u043E\u0438\u043C\u043E\u0441\u0442\u044C \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0438 \u043E\u0442\u043C\u0435\u043D\u044B",1,"cursor-pointer"],["pTooltip","\u0421\u0442\u043E\u0438\u043C\u043E\u0441\u0442\u044C \u043E\u0431\u0440\u0430\u0442\u043D\u043E\u0439 \u043B\u043E\u0433\u0438\u0441\u0442\u0438\u043A\u0438",1,"cursor-pointer"],["class","p-tag p-danger cursor-pointer",3,"pTooltip","click",4,"ngIf"],[1,"p-tag","p-danger","cursor-pointer",3,"click","pTooltip"],["appendTo","body","optionLabel","name","placeholder","\u041A\u043E\u044D\u0444\u0444\u0438\u0446\u0438\u0435\u043D\u0442 \u043B\u043E\u0433\u0438\u0441\u0442\u0438\u043A\u0438",3,"ngModelChange","onChange","ngModel","options"],["pTooltip","\u041F\u043E\u043B\u043D\u0430\u044F \u0441\u0442\u043E\u0438\u043C\u043E\u0441\u0442\u044C \u043B\u043E\u0433\u0438\u0441\u0442\u0438\u043A\u0438",1,"cursor-pointer"],["pTooltip","\u0411\u0430\u0437\u043E\u0432\u0430\u044F \u0446\u0435\u043D\u0430 \u043B\u043E\u0433\u0438\u0441\u0442\u0438\u043A\u0438",1,"cursor-pointer"],["pTooltip","\u041C\u043D\u043E\u0436\u0438\u0442\u0435\u043B\u044C \u043B\u043E\u0433\u0438\u0441\u0442\u0438\u043A\u0438",1,"cursor-pointer"],["pTooltip","\u041F\u0440\u0438\u0431\u0430\u0432\u043A\u0430 \u043B\u043E\u0433\u0438\u0441\u0442\u0438\u043A\u0438",1,"cursor-pointer"],["pTooltip","\u0426\u0435\u043D\u0430 \u0442\u043E\u0432\u0430\u0440\u0430",1,"cursor-pointer"],["pTooltip","\u041C\u043D\u043E\u0436\u0438\u0442\u0435\u043B\u044C \u0446\u0435\u043D\u044B",1,"cursor-pointer"],["header","\u041E\u0448\u0438\u0431\u043A\u0430",3,"visibleChange","visible","draggable","modal","resizable"],[1,"m-0"]],template:function(i,o){i&1&&(Y(0,"p-toast"),P(1,W5,45,12,"div",11)),i&2&&(p(),g("ngIf",o.calculation))},dependencies:[Il,No,ys,l0,c0,dm,Sl,nr,Ht,Yn,Qn,et,Mr,bt,qn,Jn,Xn,Kn,Ro,bo,jr,Gn,Ur,rl,rd,Wr,Ra,na,La,oa,Ii,Ei,wn,Yi,Ia,Ea,Kr,Gr,fl,Fa,Sm,Na,s0,a0,kl,o0,Oo,Do,vr,xr,Sd,pl,Un,Io,yn,Mm],encapsulation:2});let t=r;return t})();var j5=["productPackageAutocomplete"],H5=()=>["/purchase/edit"],$5=()=>[10,25,50],G5=()=>({"min-width":"75rem"}),Vm=t=>({id:t}),K5=t=>["summary",t],X5=t=>["edit",t];function J5(t,r){if(t&1&&(d(0,"div"),v(1),u()),t&2){let e=r.$implicit;p(),zi("",e.iD,": ",e.name)}}function q5(t,r){if(t&1&&(d(0,"div"),v(1),u()),t&2){let e=r.$implicit;p(),zi("",e.iD,": ",e.name)}}function Q5(t,r){if(t&1&&(d(0,"div"),v(1),u()),t&2){let e=r.$implicit;p(),zi("",e.iD,": ",e.name)}}function Y5(t,r){if(t&1){let e=pe();d(0,"tr")(1,"th")(2,"button",11),ee("click",function(){O(e);let i=h(2);return B(i.toggleCheckedBatches())}),u()(),d(3,"th"),v(4," \u041D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435 "),u(),d(5,"th"),v(6,"\u0414\u0430\u0442\u0430"),u(),d(7,"th"),v(8,"\u0421\u0442\u0430\u0442\u0443\u0441"),u(),d(9,"th"),v(10,"\u0422\u043E\u0432\u0430\u0440\u044B"),u(),Y(11,"th"),u(),d(12,"tr"),Y(13,"th"),d(14,"th")(15,"input",12),Ze(16,"async"),ee("ngModelChange",function(i){O(e);let o=h(2);return B(o.batchNameFilterSubject.next(i))}),u()(),Y(17,"th")(18,"th"),d(19,"th")(20,"p-autoComplete",13,2),ee("completeMethod",function(i){O(e);let o=h(2);return B(o.findBatchProductsByName(i))})("onSelect",function(i){O(e);let o=h(2);return B(o.addProductFilter(i))})("onUnselect",function(i){O(e);let o=h(2);return B(o.removeProductFilter(i))})("onBlur",function(){O(e);let i=h(2);return B(i.updateProductFilter())})("onClear",function(){O(e);let i=h(2);return B(i.clearProductFilter())}),P(22,J5,2,2,"ng-template",null,3,Z)(24,q5,2,2,"ng-template",null,4,Z)(26,Q5,2,2,"ng-template",null,5,Z),u()(),Y(28,"th"),u()}if(t&2){let e=h(2);p(2),g("icon",e.allBatchesChecked==null?"pi pi-question":e.allBatchesChecked?"pi pi-check":"pi pi-minus")("rounded",!0)("text",!0),p(13),g("ngModel",_r(16,9,e.batchNameFilterSubject)),p(5),g("group",!0)("minLength",3)("multiple",!0)("showClear",!0)("suggestions",e.batchProducts)}}function Z5(t,r){if(t&1&&(d(0,"li"),v(1),u()),t&2){let e=r.$implicit;p(),Ie(" ",e.value.name," ")}}function eF(t,r){if(t&1){let e=pe();d(0,"tr")(1,"td")(2,"p-checkbox",14),ee("click",function(){O(e);let i=h(2);return B(i.changeBatchCheckedState())}),Fe("ngModelChange",function(i){O(e);let o=h(2);return ke(o.checkedBatches,i)||(o.checkedBatches=i),B(i)}),u()(),d(3,"td"),v(4),u(),d(5,"td"),v(6),Ze(7,"date"),u(),d(8,"td"),v(9),u(),d(10,"td")(11,"ul"),P(12,Z5,2,1,"li",15),Ze(13,"keyvalue"),u()(),d(14,"td"),Y(15,"p-button",16)(16,"p-button",17),u()()}if(t&2){let e=r.$implicit,n=h(2);p(2),Se("ngModel",n.checkedBatches),g("value",e.iD),p(2),he(e.name),p(2),he(Et(7,8,e.date,"y-MM-dd")),p(3),he(e.status),p(3),g("ngForOf",_r(13,11,e.products)),p(3),g("routerLink",vt(15,K5,vt(13,Vm,e.iD))),p(),g("routerLink",vt(19,X5,vt(17,Vm,e.iD)))}}function tF(t,r){if(t&1){let e=pe();d(0,"p-table",10),ee("onPage",function(i){O(e);let o=h();return B(o.pageChange(i))}),P(1,Y5,29,11,"ng-template",null,0,Z)(3,eF,17,21,"ng-template",null,1,Z),u()}if(t&2){let e=h();g("lazy",!0)("loading",e.loading)("paginator",!0)("rowsPerPageOptions",Je(8,$5))("rows",e.filterModel.count)("tableStyle",Je(9,G5))("totalRecords",e.totalRecords)("value",e.data)}}var zm=(()=>{let r=class r extends ei{constructor(n,i,o,a,l){super(l),this.productBatchService=n,this.purchaseBatchCommandHandlerClient=i,this.dbService=o,this.messageService=a,this.data=[],this.loading=!0,this.totalRecords=0,this.findModelSubject=new ur(null),this.checkedBatches=[],this.allBatchesChecked=!1,this.filterModel={offset:0,count:10},this.batchProducts=[],this.batchNameFilterSubject=new ur(null),this.productPackageIDs=[]}ngOnInit(){this.titleService.setTitle("\u0423\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u0435 \u0437\u0430\u043A\u0443\u043F\u043A\u0430\u043C\u0438"),this.batchNameFilterSubject.pipe(wr(n=>!!n&&n.length>=3)).pipe(Ws()).pipe(Ca(500)).subscribe(n=>{this.filterModel.name=n,this.findBatches()}),this.findModelSubject.pipe(wr(n=>!!n)).pipe(xi(n=>{let o=Object.assign({},n,{offset:0,name:void 0,article:void 0,dateFrom:void 0,dateTo:void 0,productPackageIDs:[]}),a={id:r.FilterID,data:o};return this.dbService.update("filters",a).pipe(ge(l=>(this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430 \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u044F \u043D\u0430\u0441\u0442\u0440\u043E\u0435\u043A",severity:"error",detail:l}),it))).subscribe(),this.productBatchService.findPurchaseBatches(new fe.FindPurchaseBatchesModel(n)).pipe(ge(l=>(this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0438 \u0441\u043F\u0438\u0441\u043A\u0430 \u0437\u0430\u043A\u0443\u043F\u043E\u043A",severity:"error",detail:l}),this.loading=!1,it)))})).subscribe(n=>{this.checkedBatches=[],this.allBatchesChecked=!1,this.totalRecords=n.totalCount,this.data=n.items.map(i=>{let o=i;return o.products=i.items.reduce((a,l)=>l.salesItems.reduce((c,f)=>c.set(f.productPackageID,f.productPackage),a),new Map),o}),this.loading=!1}),this.dbService.getByID("filters",r.FilterID).subscribe(n=>{let i={count:50,offset:0,excludeCandidates:!1,includeProduct:!0,excludeDeleted:!0};n?.data&&Object.assign(i,n.data),this.filterModel=i,this.findModelSubject.next(this.filterModel)})}pageChange(n){(this.filterModel.count!=n.rows||this.filterModel.offset!=n.first)&&(this.filterModel.offset=n.first,this.filterModel.count=n.rows,this.findModelSubject.next(this.filterModel))}removeCheckedBatches(){this.checkedBatches.length&&this.purchaseBatchCommandHandlerClient.deletePurchaseBatches(this.checkedBatches).pipe(ge(n=>(this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430 \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u044F \u0437\u0430\u043A\u0443\u043F\u043E\u043A",severity:"error",detail:n}),this.loading=!1,it))).subscribe(()=>{this.checkedBatches=[],this.messageService.add({summary:"\u0417\u0430\u043A\u0443\u043F\u043A\u0438 \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0443\u0434\u0430\u043B\u0435\u043D\u044B",severity:"success"}),this.loading=!1,this.findBatches()})}findBatches(n=void 0){n===void 0&&(n=this.filterModel,n.productPackageIDs=[...this.productPackageIDs]),this.findModelSubject.next(new fe.FindPurchaseBatchesModel(n))}toggleCheckedBatches(){let n=this.allBatchesChecked===!1;this.allBatchesChecked=n,n?this.checkedBatches=this.data.map(i=>i.iD):this.checkedBatches=[]}changeBatchCheckedState(){this.allBatchesChecked=this.checkedBatches.length?this.checkedBatches.length==this.data.length?!0:null:!1}findBatchProductsByName(n){this.productBatchService.findPurchaseBatchProductPackages(new fe.FindPurchaseBatchProductPackagesModel({name:n.query,count:10})).pipe(ge(i=>(this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u043E\u043B\u0443\u0447\u0435\u043D\u0438\u044F \u0441\u043F\u0438\u0441\u043A\u0430 \u0442\u043E\u0432\u0430\u0440\u043E\u0432",severity:"error",detail:i}),it))).subscribe(i=>{this.batchProducts=i})}removeProductFilter(n){let i=n.value;if(i){let o=new Set(this.productPackageIDs);o.delete(i.iD),this.productPackageIDs=[...o]}}addProductFilter(n){let i=n.value;if(i){let o=new Set(this.productPackageIDs);o.add(i.iD),this.productPackageIDs=[...o]}}clearProductFilter(){this.productPackageIDs=[],this.findBatches()}updateProductFilter(){this.findBatches()}};r.FilterID="PurchaseListComponent",r.\u0275fac=function(i){return new(i||r)(Pe(fe.PurchaseBatchClient),Pe(er.PurchaseBatchClient),Pe(Sn),Pe(Yt),Pe(Zr))},r.\u0275cmp=He({type:r,selectors:[["app-purchase-list"]],viewQuery:function(i,o){if(i&1&&Nt(j5,5),i&2){let a;Te(a=Ee())&&(o.productPackageAutocomplete=a.first)}},features:[lt],decls:9,vars:4,consts:[["header",""],["body",""],["productPackageAutocomplete",""],["group",""],["selectedItem",""],["item",""],[1,"flex","gap-2"],[3,"routerLink"],["severity","danger",3,"click","disabled"],["dataKey","iD",3,"lazy","loading","paginator","rowsPerPageOptions","rows","tableStyle","totalRecords","value","onPage",4,"ngIf"],["dataKey","iD",3,"onPage","lazy","loading","paginator","rowsPerPageOptions","rows","tableStyle","totalRecords","value"],["pButton","","size","small",3,"click","icon","rounded","text"],["pInputText","",3,"ngModelChange","ngModel"],["attachTo","body","optionGroupChildren","packages","placeholder","\u041F\u043E\u0438\u0441\u043A \u0442\u043E\u0432\u0430\u0440\u0430","styleClass","mb-4",3,"completeMethod","onSelect","onUnselect","onBlur","onClear","group","minLength","multiple","showClear","suggestions"],["name","batches","styleClass","ml-4",3,"click","ngModelChange","ngModel","value"],[4,"ngFor","ngForOf"],["icon","pi pi-dollar",3,"routerLink"],["icon","pi pi-pencil",3,"routerLink"]],template:function(i,o){i&1&&(Y(0,"p-toast"),d(1,"h1"),v(2,"\u0417\u0430\u043A\u0443\u043F\u043A\u0438"),u(),d(3,"div",6)(4,"p-button",7),v(5,"\u041D\u043E\u0432\u0430\u044F"),u(),d(6,"p-button",8),ee("click",function(){return o.removeCheckedBatches()}),v(7,"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0432\u044B\u0431\u0440\u0430\u043D\u043D\u044B\u0435 "),u()(),P(8,tF,5,10,"p-table",9)),i&2&&(p(4),g("routerLink",Je(3,H5)),p(2),g("disabled",!(o.checkedBatches!=null&&o.checkedBatches.length)),p(2),g("ngIf",o.data))},dependencies:[nr,Ti,Ht,et,Mr,bt,Ki,Fo,Kr,Gr,vr,xr,Un,yn,Ks],encapsulation:2});let t=r;return t})();var Dl;(function(t){t.REDICY_API_BASE_URL=new wt("REDICY_API_BASE_URL");let r=(()=>{let s=class s{constructor(_,T){this.jsonParseReviver=void 0,this.http=_,this.baseUrl=T??"/"}findShipments(_){let T=this.baseUrl+"/v1/Shipment/FindShipments";T=T.replace(/[?&]$/,"");let X={body:JSON.stringify(_),observe:"response",responseType:"blob",headers:new ct({"Content-Type":"application/json",Accept:"application/json"})};return this.http.request("post",T,X).pipe(ne(w=>this.processFindShipments(w))).pipe(ge(w=>{if(w instanceof ut)try{return this.processFindShipments(w)}catch(ue){return xe(ue)}else return xe(w)}))}processFindShipments(_){let T=_.status,H=_ instanceof dt?_.body:_.error instanceof Blob?_.error:void 0,X={};if(_.headers)for(let w of _.headers.keys())X[w]=_.headers.get(w);return T===200?ze(H).pipe(ne(w=>{let ue=null,Xe=w===""?null:JSON.parse(w,this.jsonParseReviver);return ue=an.fromJS(Xe),be(ue)})):T!==200&&T!==204?ze(H).pipe(ne(w=>yt("An unexpected server error occurred.",T,w,X))):be(null)}updateShipments(){let _=this.baseUrl+"/v1/Shipment/UpdateShipments";_=_.replace(/[?&]$/,"");let T={observe:"response",responseType:"blob",headers:new ct({})};return this.http.request("post",_,T).pipe(ne(H=>this.processUpdateShipments(H))).pipe(ge(H=>{if(H instanceof ut)try{return this.processUpdateShipments(H)}catch(X){return xe(X)}else return xe(H)}))}processUpdateShipments(_){let T=_.status,H=_ instanceof dt?_.body:_.error instanceof Blob?_.error:void 0,X={};if(_.headers)for(let w of _.headers.keys())X[w]=_.headers.get(w);return T===200?ze(H).pipe(ne(w=>be(null))):T!==200&&T!==204?ze(H).pipe(ne(w=>yt("An unexpected server error occurred.",T,w,X))):be(null)}};s.\u0275fac=function(T){return new(T||s)(Pt(Tr),Pt(t.REDICY_API_BASE_URL,8))},s.\u0275prov=Ye({token:s,factory:s.\u0275fac});let D=s;return D})();t.ShipmentClient=r;let e=(()=>{let s=class s{constructor(_,T){this.jsonParseReviver=void 0,this.http=_,this.baseUrl=T??"/"}getLatestSalesInfo(){let _=this.baseUrl+"/v1/Dashboard/GetLatestSalesInfo";_=_.replace(/[?&]$/,"");let T={observe:"response",responseType:"blob",headers:new ct({Accept:"application/json"})};return this.http.request("get",_,T).pipe(ne(H=>this.processGetLatestSalesInfo(H))).pipe(ge(H=>{if(H instanceof ut)try{return this.processGetLatestSalesInfo(H)}catch(X){return xe(X)}else return xe(H)}))}processGetLatestSalesInfo(_){let T=_.status,H=_ instanceof dt?_.body:_.error instanceof Blob?_.error:void 0,X={};if(_.headers)for(let w of _.headers.keys())X[w]=_.headers.get(w);return T===200?ze(H).pipe(ne(w=>{let ue=null,Xe=w===""?null:JSON.parse(w,this.jsonParseReviver);return ue=k.fromJS(Xe),be(ue)})):T!==200&&T!==204?ze(H).pipe(ne(w=>yt("An unexpected server error occurred.",T,w,X))):be(null)}};s.\u0275fac=function(T){return new(T||s)(Pt(Tr),Pt(t.REDICY_API_BASE_URL,8))},s.\u0275prov=Ye({token:s,factory:s.\u0275fac});let D=s;return D})();t.DashboardClient=e;let n=(()=>{let s=class s{constructor(_,T){this.jsonParseReviver=void 0,this.http=_,this.baseUrl=T??"/"}createVideoBatch(){let _=this.baseUrl+"/v1/ImageTool/CreateVideoBatch";_=_.replace(/[?&]$/,"");let T={observe:"response",responseType:"blob",headers:new ct({Accept:"application/json"})};return this.http.request("get",_,T).pipe(ne(H=>this.processCreateVideoBatch(H))).pipe(ge(H=>{if(H instanceof ut)try{return this.processCreateVideoBatch(H)}catch(X){return xe(X)}else return xe(H)}))}processCreateVideoBatch(_){let T=_.status,H=_ instanceof dt?_.body:_.error instanceof Blob?_.error:void 0,X={};if(_.headers)for(let w of _.headers.keys())X[w]=_.headers.get(w);return T===200?ze(H).pipe(ne(w=>{let ue=null,Xe=w===""?null:JSON.parse(w,this.jsonParseReviver);return ue=Xe!==void 0?Xe:null,be(ue)})):T!==200&&T!==204?ze(H).pipe(ne(w=>yt("An unexpected server error occurred.",T,w,X))):be(null)}finishBatch(_,T){let H=this.baseUrl+"/v1/ImageTool/FinishBatch?";if(_==null)throw new Error("The parameter 'batchID' must be defined and cannot be null.");if(H+="batchID="+encodeURIComponent(""+_)+"&",T==null)throw new Error("The parameter 'frameRate' must be defined and cannot be null.");H+="frameRate="+encodeURIComponent(""+T)+"&",H=H.replace(/[?&]$/,"");let X={observe:"response",responseType:"blob",headers:new ct({Accept:"application/json"})};return this.http.request("get",H,X).pipe(ne(w=>this.processFinishBatch(w))).pipe(ge(w=>{if(w instanceof ut)try{return this.processFinishBatch(w)}catch(ue){return xe(ue)}else return xe(w)}))}processFinishBatch(_){let T=_.status,H=_ instanceof dt?_.body:_.error instanceof Blob?_.error:void 0,X={};if(_.headers)for(let w of _.headers.keys())X[w]=_.headers.get(w);if(T===200||T===206){let w=_.headers?_.headers.get("content-disposition"):void 0,ue=w?/filename\*=(?:(\\?['"])(.*?)\1|(?:[^\s]+'.*?')?([^;\n]*))/g.exec(w):void 0,Xe=ue&&ue.length>1?ue[3]||ue[2]:void 0;return Xe?Xe=decodeURIComponent(Xe):(ue=w?/filename="?([^"]*?)"?(;|$)/g.exec(w):void 0,Xe=ue&&ue.length>1?ue[1]:void 0),be({fileName:Xe,data:H,status:T,headers:X})}else if(T!==200&&T!==204)return ze(H).pipe(ne(w=>yt("An unexpected server error occurred.",T,w,X)));return be(null)}uploadBatchImage(_,T){let H=this.baseUrl+"/v1/ImageTool/UploadBatchImage?";if(_==null)throw new Error("The parameter 'batchID' must be defined and cannot be null.");H+="batchID="+encodeURIComponent(""+_)+"&",H=H.replace(/[?&]$/,"");let X=new FormData;if(T==null)throw new Error("The parameter 'files' cannot be null.");T.forEach(ue=>X.append("files",ue.data,ue.fileName?ue.fileName:"files"));let w={body:X,observe:"response",responseType:"blob",headers:new ct({})};return this.http.request("post",H,w).pipe(ne(ue=>this.processUploadBatchImage(ue))).pipe(ge(ue=>{if(ue instanceof ut)try{return this.processUploadBatchImage(ue)}catch(Xe){return xe(Xe)}else return xe(ue)}))}processUploadBatchImage(_){let T=_.status,H=_ instanceof dt?_.body:_.error instanceof Blob?_.error:void 0,X={};if(_.headers)for(let w of _.headers.keys())X[w]=_.headers.get(w);return T===204?ze(H).pipe(ne(w=>be(null))):T!==200&&T!==204?ze(H).pipe(ne(w=>yt("An unexpected server error occurred.",T,w,X))):be(null)}};s.\u0275fac=function(T){return new(T||s)(Pt(Tr),Pt(t.REDICY_API_BASE_URL,8))},s.\u0275prov=Ye({token:s,factory:s.\u0275fac});let D=s;return D})();t.ImageToolClient=n;let i=(()=>{let s=class s{constructor(_,T){this.jsonParseReviver=void 0,this.http=_,this.baseUrl=T??"/"}importProducts(){let _=this.baseUrl+"/v1/Ozon/ImportProducts";_=_.replace(/[?&]$/,"");let T={observe:"response",responseType:"blob",headers:new ct({})};return this.http.request("get",_,T).pipe(ne(H=>this.processImportProducts(H))).pipe(ge(H=>{if(H instanceof ut)try{return this.processImportProducts(H)}catch(X){return xe(X)}else return xe(H)}))}processImportProducts(_){let T=_.status,H=_ instanceof dt?_.body:_.error instanceof Blob?_.error:void 0,X={};if(_.headers)for(let w of _.headers.keys())X[w]=_.headers.get(w);return T===204?ze(H).pipe(ne(w=>be(null))):T!==200&&T!==204?ze(H).pipe(ne(w=>yt("An unexpected server error occurred.",T,w,X))):be(null)}importTransactions(_,T){let H=this.baseUrl+"/v1/Ozon/ImportTransactions?";if(_===void 0)throw new Error("The parameter 'dateFrom' must be defined.");if(_!==null&&(H+="dateFrom="+encodeURIComponent(_?""+_.toISOString():"")+"&"),T===void 0)throw new Error("The parameter 'dateTo' must be defined.");T!==null&&(H+="dateTo="+encodeURIComponent(T?""+T.toISOString():"")+"&"),H=H.replace(/[?&]$/,"");let X={observe:"response",responseType:"blob",headers:new ct({})};return this.http.request("get",H,X).pipe(ne(w=>this.processImportTransactions(w))).pipe(ge(w=>{if(w instanceof ut)try{return this.processImportTransactions(w)}catch(ue){return xe(ue)}else return xe(w)}))}processImportTransactions(_){let T=_.status,H=_ instanceof dt?_.body:_.error instanceof Blob?_.error:void 0,X={};if(_.headers)for(let w of _.headers.keys())X[w]=_.headers.get(w);return T===204?ze(H).pipe(ne(w=>be(null))):T!==200&&T!==204?ze(H).pipe(ne(w=>yt("An unexpected server error occurred.",T,w,X))):be(null)}importWarehouses(){let _=this.baseUrl+"/v1/Ozon/ImportWarehouses";_=_.replace(/[?&]$/,"");let T={observe:"response",responseType:"blob",headers:new ct({})};return this.http.request("get",_,T).pipe(ne(H=>this.processImportWarehouses(H))).pipe(ge(H=>{if(H instanceof ut)try{return this.processImportWarehouses(H)}catch(X){return xe(X)}else return xe(H)}))}processImportWarehouses(_){let T=_.status,H=_ instanceof dt?_.body:_.error instanceof Blob?_.error:void 0,X={};if(_.headers)for(let w of _.headers.keys())X[w]=_.headers.get(w);return T===204?ze(H).pipe(ne(w=>be(null))):T!==200&&T!==204?ze(H).pipe(ne(w=>yt("An unexpected server error occurred.",T,w,X))):be(null)}importSellerApiOzonWarehouses(_){let T=this.baseUrl+"/v1/Ozon/ImportSellerApiOzonWarehouses";T=T.replace(/[?&]$/,"");let X={body:JSON.stringify(_),observe:"response",responseType:"blob",headers:new ct({"Content-Type":"application/json"})};return this.http.request("post",T,X).pipe(ne(w=>this.processImportSellerApiOzonWarehouses(w))).pipe(ge(w=>{if(w instanceof ut)try{return this.processImportSellerApiOzonWarehouses(w)}catch(ue){return xe(ue)}else return xe(w)}))}processImportSellerApiOzonWarehouses(_){let T=_.status,H=_ instanceof dt?_.body:_.error instanceof Blob?_.error:void 0,X={};if(_.headers)for(let w of _.headers.keys())X[w]=_.headers.get(w);return T===200?ze(H).pipe(ne(w=>be(null))):T!==200&&T!==204?ze(H).pipe(ne(w=>yt("An unexpected server error occurred.",T,w,X))):be(null)}getOzonLocalizationIndex(_,T){let H=this.baseUrl+"/v1/Ozon/GetOzonLocalizationIndex?";if(_===null)throw new Error("The parameter 'from' cannot be null.");if(_!==void 0&&(H+="from="+encodeURIComponent(_?""+_.toISOString():"")+"&"),T===null)throw new Error("The parameter 'to' cannot be null.");T!==void 0&&(H+="to="+encodeURIComponent(T?""+T.toISOString():"")+"&"),H=H.replace(/[?&]$/,"");let X={observe:"response",responseType:"blob",headers:new ct({Accept:"application/json"})};return this.http.request("get",H,X).pipe(ne(w=>this.processGetOzonLocalizationIndex(w))).pipe(ge(w=>{if(w instanceof ut)try{return this.processGetOzonLocalizationIndex(w)}catch(ue){return xe(ue)}else return xe(w)}))}processGetOzonLocalizationIndex(_){let T=_.status,H=_ instanceof dt?_.body:_.error instanceof Blob?_.error:void 0,X={};if(_.headers)for(let w of _.headers.keys())X[w]=_.headers.get(w);return T===200?ze(H).pipe(ne(w=>{let ue=null,Xe=w===""?null:JSON.parse(w,this.jsonParseReviver);return ue=Xe!==void 0?Xe:null,be(ue)})):T!==200&&T!==204?ze(H).pipe(ne(w=>yt("An unexpected server error occurred.",T,w,X))):be(null)}importProductStocks(){let _=this.baseUrl+"/v1/Ozon/ImportProductStocks";_=_.replace(/[?&]$/,"");let T={observe:"response",responseType:"blob",headers:new ct({})};return this.http.request("get",_,T).pipe(ne(H=>this.processImportProductStocks(H))).pipe(ge(H=>{if(H instanceof ut)try{return this.processImportProductStocks(H)}catch(X){return xe(X)}else return xe(H)}))}processImportProductStocks(_){let T=_.status,H=_ instanceof dt?_.body:_.error instanceof Blob?_.error:void 0,X={};if(_.headers)for(let w of _.headers.keys())X[w]=_.headers.get(w);return T===204?ze(H).pipe(ne(w=>be(null))):T!==200&&T!==204?ze(H).pipe(ne(w=>yt("An unexpected server error occurred.",T,w,X))):be(null)}importOzonPostings(_,T){let H=this.baseUrl+"/v1/Ozon/ImportOzonPostings?";if(_===void 0)throw new Error("The parameter 'dateFrom' must be defined.");if(_!==null&&(H+="dateFrom="+encodeURIComponent(_?""+_.toISOString():"")+"&"),T===void 0)throw new Error("The parameter 'dateTo' must be defined.");T!==null&&(H+="dateTo="+encodeURIComponent(T?""+T.toISOString():"")+"&"),H=H.replace(/[?&]$/,"");let X={observe:"response",responseType:"blob",headers:new ct({})};return this.http.request("post",H,X).pipe(ne(w=>this.processImportOzonPostings(w))).pipe(ge(w=>{if(w instanceof ut)try{return this.processImportOzonPostings(w)}catch(ue){return xe(ue)}else return xe(w)}))}processImportOzonPostings(_){let T=_.status,H=_ instanceof dt?_.body:_.error instanceof Blob?_.error:void 0,X={};if(_.headers)for(let w of _.headers.keys())X[w]=_.headers.get(w);return T===204?ze(H).pipe(ne(w=>be(null))):T!==200&&T!==204?ze(H).pipe(ne(w=>yt("An unexpected server error occurred.",T,w,X))):be(null)}importOzonSupplyOrders(){let _=this.baseUrl+"/v1/Ozon/ImportOzonSupplyOrders";_=_.replace(/[?&]$/,"");let T={observe:"response",responseType:"blob",headers:new ct({})};return this.http.request("post",_,T).pipe(ne(H=>this.processImportOzonSupplyOrders(H))).pipe(ge(H=>{if(H instanceof ut)try{return this.processImportOzonSupplyOrders(H)}catch(X){return xe(X)}else return xe(H)}))}processImportOzonSupplyOrders(_){let T=_.status,H=_ instanceof dt?_.body:_.error instanceof Blob?_.error:void 0,X={};if(_.headers)for(let w of _.headers.keys())X[w]=_.headers.get(w);return T===204?ze(H).pipe(ne(w=>be(null))):T!==200&&T!==204?ze(H).pipe(ne(w=>yt("An unexpected server error occurred.",T,w,X))):be(null)}findOzonOrders(_){let T=this.baseUrl+"/v1/Ozon/FindOzonOrders";T=T.replace(/[?&]$/,"");let X={body:JSON.stringify(_),observe:"response",responseType:"blob",headers:new ct({"Content-Type":"application/json",Accept:"application/json"})};return this.http.request("post",T,X).pipe(ne(w=>this.processFindOzonOrders(w))).pipe(ge(w=>{if(w instanceof ut)try{return this.processFindOzonOrders(w)}catch(ue){return xe(ue)}else return xe(w)}))}processFindOzonOrders(_){let T=_.status,H=_ instanceof dt?_.body:_.error instanceof Blob?_.error:void 0,X={};if(_.headers)for(let w of _.headers.keys())X[w]=_.headers.get(w);return T===200?ze(H).pipe(ne(w=>{let ue=null,Xe=w===""?null:JSON.parse(w,this.jsonParseReviver);if(Array.isArray(Xe)){ue=[];for(let Li of Xe)ue.push(M.fromJS(Li))}else ue=null;return be(ue)})):T!==200&&T!==204?ze(H).pipe(ne(w=>yt("An unexpected server error occurred.",T,w,X))):be(null)}findOzonSupplyOrders(_){let T=this.baseUrl+"/v1/Ozon/FindOzonSupplyOrders";T=T.replace(/[?&]$/,"");let X={body:JSON.stringify(_),observe:"response",responseType:"blob",headers:new ct({"Content-Type":"application/json",Accept:"application/json"})};return this.http.request("post",T,X).pipe(ne(w=>this.processFindOzonSupplyOrders(w))).pipe(ge(w=>{if(w instanceof ut)try{return this.processFindOzonSupplyOrders(w)}catch(ue){return xe(ue)}else return xe(w)}))}processFindOzonSupplyOrders(_){let T=_.status,H=_ instanceof dt?_.body:_.error instanceof Blob?_.error:void 0,X={};if(_.headers)for(let w of _.headers.keys())X[w]=_.headers.get(w);return T===200?ze(H).pipe(ne(w=>{let ue=null,Xe=w===""?null:JSON.parse(w,this.jsonParseReviver);return ue=_t.fromJS(Xe),be(ue)})):T!==200&&T!==204?ze(H).pipe(ne(w=>yt("An unexpected server error occurred.",T,w,X))):be(null)}updateOzonSupplyOrderCrossDockWarehouse(_,T){let H=this.baseUrl+"/v1/Ozon/UpdateOzonSupplyOrderCrossDockWarehouse?";if(_===null)throw new Error("The parameter 'supplyOrderID' cannot be null.");if(_!==void 0&&(H+="supplyOrderID="+encodeURIComponent(""+_)+"&"),T===null)throw new Error("The parameter 'warehouseID' cannot be null.");T!==void 0&&(H+="warehouseID="+encodeURIComponent(""+T)+"&"),H=H.replace(/[?&]$/,"");let X={observe:"response",responseType:"blob",headers:new ct({})};return this.http.request("post",H,X).pipe(ne(w=>this.processUpdateOzonSupplyOrderCrossDockWarehouse(w))).pipe(ge(w=>{if(w instanceof ut)try{return this.processUpdateOzonSupplyOrderCrossDockWarehouse(w)}catch(ue){return xe(ue)}else return xe(w)}))}processUpdateOzonSupplyOrderCrossDockWarehouse(_){let T=_.status,H=_ instanceof dt?_.body:_.error instanceof Blob?_.error:void 0,X={};if(_.headers)for(let w of _.headers.keys())X[w]=_.headers.get(w);return T===200?ze(H).pipe(ne(w=>be(null))):T!==200&&T!==204?ze(H).pipe(ne(w=>yt("An unexpected server error occurred.",T,w,X))):be(null)}findOzonProducts(_){let T=this.baseUrl+"/v1/Ozon/FindOzonProducts";T=T.replace(/[?&]$/,"");let X={body:JSON.stringify(_),observe:"response",responseType:"blob",headers:new ct({"Content-Type":"application/json",Accept:"application/json"})};return this.http.request("post",T,X).pipe(ne(w=>this.processFindOzonProducts(w))).pipe(ge(w=>{if(w instanceof ut)try{return this.processFindOzonProducts(w)}catch(ue){return xe(ue)}else return xe(w)}))}processFindOzonProducts(_){let T=_.status,H=_ instanceof dt?_.body:_.error instanceof Blob?_.error:void 0,X={};if(_.headers)for(let w of _.headers.keys())X[w]=_.headers.get(w);return T===200?ze(H).pipe(ne(w=>{let ue=null,Xe=w===""?null:JSON.parse(w,this.jsonParseReviver);return ue=Cr.fromJS(Xe),be(ue)})):T!==200&&T!==204?ze(H).pipe(ne(w=>yt("An unexpected server error occurred.",T,w,X))):be(null)}findOzonOperations(_){let T=this.baseUrl+"/v1/Ozon/FindOzonOperations";T=T.replace(/[?&]$/,"");let X={body:JSON.stringify(_),observe:"response",responseType:"blob",headers:new ct({"Content-Type":"application/json",Accept:"application/json"})};return this.http.request("post",T,X).pipe(ne(w=>this.processFindOzonOperations(w))).pipe(ge(w=>{if(w instanceof ut)try{return this.processFindOzonOperations(w)}catch(ue){return xe(ue)}else return xe(w)}))}processFindOzonOperations(_){let T=_.status,H=_ instanceof dt?_.body:_.error instanceof Blob?_.error:void 0,X={};if(_.headers)for(let w of _.headers.keys())X[w]=_.headers.get(w);return T===200?ze(H).pipe(ne(w=>{let ue=null,Xe=w===""?null:JSON.parse(w,this.jsonParseReviver);return ue=At.fromJS(Xe),be(ue)})):T!==200&&T!==204?ze(H).pipe(ne(w=>yt("An unexpected server error occurred.",T,w,X))):be(null)}removeOzonProduct(_){let T=this.baseUrl+"/v1/Ozon/RemoveOzonProduct";T=T.replace(/[?&]$/,"");let X={body:JSON.stringify(_),observe:"response",responseType:"blob",headers:new ct({"Content-Type":"application/json"})};return this.http.request("delete",T,X).pipe(ne(w=>this.processRemoveOzonProduct(w))).pipe(ge(w=>{if(w instanceof ut)try{return this.processRemoveOzonProduct(w)}catch(ue){return xe(ue)}else return xe(w)}))}processRemoveOzonProduct(_){let T=_.status,H=_ instanceof dt?_.body:_.error instanceof Blob?_.error:void 0,X={};if(_.headers)for(let w of _.headers.keys())X[w]=_.headers.get(w);return T===204?ze(H).pipe(ne(w=>be(null))):T!==200&&T!==204?ze(H).pipe(ne(w=>yt("An unexpected server error occurred.",T,w,X))):be(null)}};s.\u0275fac=function(T){return new(T||s)(Pt(Tr),Pt(t.REDICY_API_BASE_URL,8))},s.\u0275prov=Ye({token:s,factory:s.\u0275fac});let D=s;return D})();t.OzonClient=i;let o=(()=>{let s=class s{constructor(_,T){this.jsonParseReviver=void 0,this.http=_,this.baseUrl=T??"/"}getOzonStockStarvationReport(_,T,H,X,w,ue){let Xe=this.baseUrl+"/v1/Report/GetOzonStockStarvationReport?";if(_==null)throw new Error("The parameter 'salesAnalysisInDays' must be defined and cannot be null.");if(Xe+="salesAnalysisInDays="+encodeURIComponent(""+_)+"&",T==null)throw new Error("The parameter 'notificationPeriodInDays' must be defined and cannot be null.");if(Xe+="notificationPeriodInDays="+encodeURIComponent(""+T)+"&",H!=null&&(Xe+="date="+encodeURIComponent(H?""+H.toISOString():"")+"&"),X===null)throw new Error("The parameter 'respectMinimalStock' cannot be null.");if(X!==void 0&&(Xe+="respectMinimalStock="+encodeURIComponent(""+X)+"&"),w===null)throw new Error("The parameter 'respectSupplyPreparationPeriod' cannot be null.");if(w!==void 0&&(Xe+="respectSupplyPreparationPeriod="+encodeURIComponent(""+w)+"&"),ue===null)throw new Error("The parameter 'respectActiveSupplyOrders' cannot be null.");ue!==void 0&&(Xe+="respectActiveSupplyOrders="+encodeURIComponent(""+ue)+"&"),Xe=Xe.replace(/[?&]$/,"");let Li={observe:"response",responseType:"blob",headers:new ct({Accept:"application/json"})};return this.http.request("get",Xe,Li).pipe(ne(Go=>this.processGetOzonStockStarvationReport(Go))).pipe(ge(Go=>{if(Go instanceof ut)try{return this.processGetOzonStockStarvationReport(Go)}catch(as){return xe(as)}else return xe(Go)}))}processGetOzonStockStarvationReport(_){let T=_.status,H=_ instanceof dt?_.body:_.error instanceof Blob?_.error:void 0,X={};if(_.headers)for(let w of _.headers.keys())X[w]=_.headers.get(w);return T===200?ze(H).pipe(ne(w=>{let ue=null,Xe=w===""?null:JSON.parse(w,this.jsonParseReviver);if(Array.isArray(Xe)){ue=[];for(let Li of Xe)ue.push(y.fromJS(Li))}else ue=null;return be(ue)})):T!==200&&T!==204?ze(H).pipe(ne(w=>yt("An unexpected server error occurred.",T,w,X))):be(null)}};s.\u0275fac=function(T){return new(T||s)(Pt(Tr),Pt(t.REDICY_API_BASE_URL,8))},s.\u0275prov=Ye({token:s,factory:s.\u0275fac});let D=s;return D})();t.ReportClient=o;let a=(()=>{let s=class s{constructor(_,T){this.jsonParseReviver=void 0,this.http=_,this.baseUrl=T??"/"}getPackageTypesWithLatestPrices(){let _=this.baseUrl+"/v1/PackageType/GetPackageTypesWithLatestPrices";_=_.replace(/[?&]$/,"");let T={observe:"response",responseType:"blob",headers:new ct({Accept:"application/json"})};return this.http.request("get",_,T).pipe(ne(H=>this.processGetPackageTypesWithLatestPrices(H))).pipe(ge(H=>{if(H instanceof ut)try{return this.processGetPackageTypesWithLatestPrices(H)}catch(X){return xe(X)}else return xe(H)}))}processGetPackageTypesWithLatestPrices(_){let T=_.status,H=_ instanceof dt?_.body:_.error instanceof Blob?_.error:void 0,X={};if(_.headers)for(let w of _.headers.keys())X[w]=_.headers.get(w);return T===200?ze(H).pipe(ne(w=>{let ue=null,Xe=w===""?null:JSON.parse(w,this.jsonParseReviver);if(Array.isArray(Xe)){ue=[];for(let Li of Xe)ue.push(Rt.fromJS(Li))}else ue=null;return be(ue)})):T!==200&&T!==204?ze(H).pipe(ne(w=>yt("An unexpected server error occurred.",T,w,X))):be(null)}addPackageType(_){let T=this.baseUrl+"/v1/PackageType/AddPackageType";T=T.replace(/[?&]$/,"");let X={body:JSON.stringify(_),observe:"response",responseType:"blob",headers:new ct({"Content-Type":"application/json",Accept:"application/json"})};return this.http.request("post",T,X).pipe(ne(w=>this.processAddPackageType(w))).pipe(ge(w=>{if(w instanceof ut)try{return this.processAddPackageType(w)}catch(ue){return xe(ue)}else return xe(w)}))}processAddPackageType(_){let T=_.status,H=_ instanceof dt?_.body:_.error instanceof Blob?_.error:void 0,X={};if(_.headers)for(let w of _.headers.keys())X[w]=_.headers.get(w);return T===200?ze(H).pipe(ne(w=>{let ue=null,Xe=w===""?null:JSON.parse(w,this.jsonParseReviver);return ue=re.fromJS(Xe),be(ue)})):T!==200&&T!==204?ze(H).pipe(ne(w=>yt("An unexpected server error occurred.",T,w,X))):be(null)}updatePackageType(_){let T=this.baseUrl+"/v1/PackageType/UpdatePackageType";T=T.replace(/[?&]$/,"");let X={body:JSON.stringify(_),observe:"response",responseType:"blob",headers:new ct({"Content-Type":"application/json"})};return this.http.request("post",T,X).pipe(ne(w=>this.processUpdatePackageType(w))).pipe(ge(w=>{if(w instanceof ut)try{return this.processUpdatePackageType(w)}catch(ue){return xe(ue)}else return xe(w)}))}processUpdatePackageType(_){let T=_.status,H=_ instanceof dt?_.body:_.error instanceof Blob?_.error:void 0,X={};if(_.headers)for(let w of _.headers.keys())X[w]=_.headers.get(w);return T===204?ze(H).pipe(ne(w=>be(null))):T!==200&&T!==204?ze(H).pipe(ne(w=>yt("An unexpected server error occurred.",T,w,X))):be(null)}removePackageType(_){let T=this.baseUrl+"/v1/PackageType/RemovePackageType?";if(_==null)throw new Error("The parameter 'model' must be defined and cannot be null.");T+="model="+encodeURIComponent(""+_)+"&",T=T.replace(/[?&]$/,"");let H={observe:"response",responseType:"blob",headers:new ct({})};return this.http.request("delete",T,H).pipe(ne(X=>this.processRemovePackageType(X))).pipe(ge(X=>{if(X instanceof ut)try{return this.processRemovePackageType(X)}catch(w){return xe(w)}else return xe(X)}))}processRemovePackageType(_){let T=_.status,H=_ instanceof dt?_.body:_.error instanceof Blob?_.error:void 0,X={};if(_.headers)for(let w of _.headers.keys())X[w]=_.headers.get(w);return T===204?ze(H).pipe(ne(w=>be(null))):T!==200&&T!==204?ze(H).pipe(ne(w=>yt("An unexpected server error occurred.",T,w,X))):be(null)}};s.\u0275fac=function(T){return new(T||s)(Pt(Tr),Pt(t.REDICY_API_BASE_URL,8))},s.\u0275prov=Ye({token:s,factory:s.\u0275fac});let D=s;return D})();t.PackageTypeClient=a;let l=(()=>{let s=class s{constructor(_,T){this.jsonParseReviver=void 0,this.http=_,this.baseUrl=T??"/"}findProducts(_){let T=this.baseUrl+"/v1/Product/FindProducts";T=T.replace(/[?&]$/,"");let X={body:JSON.stringify(_),observe:"response",responseType:"blob",headers:new ct({"Content-Type":"application/json",Accept:"application/json"})};return this.http.request("post",T,X).pipe(ne(w=>this.processFindProducts(w))).pipe(ge(w=>{if(w instanceof ut)try{return this.processFindProducts(w)}catch(ue){return xe(ue)}else return xe(w)}))}processFindProducts(_){let T=_.status,H=_ instanceof dt?_.body:_.error instanceof Blob?_.error:void 0,X={};if(_.headers)for(let w of _.headers.keys())X[w]=_.headers.get(w);return T===200?ze(H).pipe(ne(w=>{let ue=null,Xe=w===""?null:JSON.parse(w,this.jsonParseReviver);return ue=J.fromJS(Xe),be(ue)})):T!==200&&T!==204?ze(H).pipe(ne(w=>yt("An unexpected server error occurred.",T,w,X))):be(null)}findProductPackages(_){let T=this.baseUrl+"/v1/Product/FindProductPackages";T=T.replace(/[?&]$/,"");let X={body:JSON.stringify(_),observe:"response",responseType:"blob",headers:new ct({"Content-Type":"application/json",Accept:"application/json"})};return this.http.request("post",T,X).pipe(ne(w=>this.processFindProductPackages(w))).pipe(ge(w=>{if(w instanceof ut)try{return this.processFindProductPackages(w)}catch(ue){return xe(ue)}else return xe(w)}))}processFindProductPackages(_){let T=_.status,H=_ instanceof dt?_.body:_.error instanceof Blob?_.error:void 0,X={};if(_.headers)for(let w of _.headers.keys())X[w]=_.headers.get(w);return T===200?ze(H).pipe(ne(w=>{let ue=null,Xe=w===""?null:JSON.parse(w,this.jsonParseReviver);return ue=pt.fromJS(Xe),be(ue)})):T!==200&&T!==204?ze(H).pipe(ne(w=>yt("An unexpected server error occurred.",T,w,X))):be(null)}updateProduct(_){let T=this.baseUrl+"/v1/Product/UpdateProduct";T=T.replace(/[?&]$/,"");let X={body:JSON.stringify(_),observe:"response",responseType:"blob",headers:new ct({"Content-Type":"application/json"})};return this.http.request("post",T,X).pipe(ne(w=>this.processUpdateProduct(w))).pipe(ge(w=>{if(w instanceof ut)try{return this.processUpdateProduct(w)}catch(ue){return xe(ue)}else return xe(w)}))}processUpdateProduct(_){let T=_.status,H=_ instanceof dt?_.body:_.error instanceof Blob?_.error:void 0,X={};if(_.headers)for(let w of _.headers.keys())X[w]=_.headers.get(w);return T===204?ze(H).pipe(ne(w=>be(null))):T!==200&&T!==204?ze(H).pipe(ne(w=>yt("An unexpected server error occurred.",T,w,X))):be(null)}updateProductPackage(_){let T=this.baseUrl+"/v1/Product/UpdateProductPackage";T=T.replace(/[?&]$/,"");let X={body:JSON.stringify(_),observe:"response",responseType:"blob",headers:new ct({"Content-Type":"application/json"})};return this.http.request("post",T,X).pipe(ne(w=>this.processUpdateProductPackage(w))).pipe(ge(w=>{if(w instanceof ut)try{return this.processUpdateProductPackage(w)}catch(ue){return xe(ue)}else return xe(w)}))}processUpdateProductPackage(_){let T=_.status,H=_ instanceof dt?_.body:_.error instanceof Blob?_.error:void 0,X={};if(_.headers)for(let w of _.headers.keys())X[w]=_.headers.get(w);return T===204?ze(H).pipe(ne(w=>be(null))):T!==200&&T!==204?ze(H).pipe(ne(w=>yt("An unexpected server error occurred.",T,w,X))):be(null)}addProduct(_){let T=this.baseUrl+"/v1/Product/AddProduct";T=T.replace(/[?&]$/,"");let X={body:JSON.stringify(_),observe:"response",responseType:"blob",headers:new ct({"Content-Type":"application/json",Accept:"application/json"})};return this.http.request("post",T,X).pipe(ne(w=>this.processAddProduct(w))).pipe(ge(w=>{if(w instanceof ut)try{return this.processAddProduct(w)}catch(ue){return xe(ue)}else return xe(w)}))}processAddProduct(_){let T=_.status,H=_ instanceof dt?_.body:_.error instanceof Blob?_.error:void 0,X={};if(_.headers)for(let w of _.headers.keys())X[w]=_.headers.get(w);return T===200?ze(H).pipe(ne(w=>{let ue=null,Xe=w===""?null:JSON.parse(w,this.jsonParseReviver);return ue=ot.fromJS(Xe),be(ue)})):T!==200&&T!==204?ze(H).pipe(ne(w=>yt("An unexpected server error occurred.",T,w,X))):be(null)}addProductPackage(_){let T=this.baseUrl+"/v1/Product/AddProductPackage";T=T.replace(/[?&]$/,"");let X={body:JSON.stringify(_),observe:"response",responseType:"blob",headers:new ct({"Content-Type":"application/json",Accept:"application/json"})};return this.http.request("post",T,X).pipe(ne(w=>this.processAddProductPackage(w))).pipe(ge(w=>{if(w instanceof ut)try{return this.processAddProductPackage(w)}catch(ue){return xe(ue)}else return xe(w)}))}processAddProductPackage(_){let T=_.status,H=_ instanceof dt?_.body:_.error instanceof Blob?_.error:void 0,X={};if(_.headers)for(let w of _.headers.keys())X[w]=_.headers.get(w);return T===200?ze(H).pipe(ne(w=>{let ue=null,Xe=w===""?null:JSON.parse(w,this.jsonParseReviver);return ue=or.fromJS(Xe),be(ue)})):T!==200&&T!==204?ze(H).pipe(ne(w=>yt("An unexpected server error occurred.",T,w,X))):be(null)}removeProduct(_){let T=this.baseUrl+"/v1/Product/RemoveProduct";T=T.replace(/[?&]$/,"");let X={body:JSON.stringify(_),observe:"response",responseType:"blob",headers:new ct({"Content-Type":"application/json"})};return this.http.request("delete",T,X).pipe(ne(w=>this.processRemoveProduct(w))).pipe(ge(w=>{if(w instanceof ut)try{return this.processRemoveProduct(w)}catch(ue){return xe(ue)}else return xe(w)}))}processRemoveProduct(_){let T=_.status,H=_ instanceof dt?_.body:_.error instanceof Blob?_.error:void 0,X={};if(_.headers)for(let w of _.headers.keys())X[w]=_.headers.get(w);return T===204?ze(H).pipe(ne(w=>be(null))):T!==200&&T!==204?ze(H).pipe(ne(w=>yt("An unexpected server error occurred.",T,w,X))):be(null)}removeProductPackage(_){let T=this.baseUrl+"/v1/Product/RemoveProductPackage";T=T.replace(/[?&]$/,"");let X={body:JSON.stringify(_),observe:"response",responseType:"blob",headers:new ct({"Content-Type":"application/json"})};return this.http.request("delete",T,X).pipe(ne(w=>this.processRemoveProductPackage(w))).pipe(ge(w=>{if(w instanceof ut)try{return this.processRemoveProductPackage(w)}catch(ue){return xe(ue)}else return xe(w)}))}processRemoveProductPackage(_){let T=_.status,H=_ instanceof dt?_.body:_.error instanceof Blob?_.error:void 0,X={};if(_.headers)for(let w of _.headers.keys())X[w]=_.headers.get(w);return T===204?ze(H).pipe(ne(w=>be(null))):T!==200&&T!==204?ze(H).pipe(ne(w=>yt("An unexpected server error occurred.",T,w,X))):be(null)}};s.\u0275fac=function(T){return new(T||s)(Pt(Tr),Pt(t.REDICY_API_BASE_URL,8))},s.\u0275prov=Ye({token:s,factory:s.\u0275fac});let D=s;return D})();t.ProductClient=l;let c=(()=>{let s=class s{constructor(_,T){this.jsonParseReviver=void 0,this.http=_,this.baseUrl=T??"/"}updatePurchaseBatch(_){let T=this.baseUrl+"/v1/PurchaseBatch/UpdatePurchaseBatch";T=T.replace(/[?&]$/,"");let X={body:JSON.stringify(_),observe:"response",responseType:"blob",headers:new ct({"Content-Type":"application/json",Accept:"application/json"})};return this.http.request("post",T,X).pipe(ne(w=>this.processUpdatePurchaseBatch(w))).pipe(ge(w=>{if(w instanceof ut)try{return this.processUpdatePurchaseBatch(w)}catch(ue){return xe(ue)}else return xe(w)}))}processUpdatePurchaseBatch(_){let T=_.status,H=_ instanceof dt?_.body:_.error instanceof Blob?_.error:void 0,X={};if(_.headers)for(let w of _.headers.keys())X[w]=_.headers.get(w);return T===200?ze(H).pipe(ne(w=>{let ue=null,Xe=w===""?null:JSON.parse(w,this.jsonParseReviver);return ue=Re.fromJS(Xe),be(ue)})):T!==200&&T!==204?ze(H).pipe(ne(w=>yt("An unexpected server error occurred.",T,w,X))):be(null)}getPurchaseBatch(_){let T=this.baseUrl+"/v1/PurchaseBatch/GetPurchaseBatch?";if(_==null)throw new Error("The parameter 'model' must be defined and cannot be null.");T+="model="+encodeURIComponent(""+_)+"&",T=T.replace(/[?&]$/,"");let H={observe:"response",responseType:"blob",headers:new ct({Accept:"application/json"})};return this.http.request("post",T,H).pipe(ne(X=>this.processGetPurchaseBatch(X))).pipe(ge(X=>{if(X instanceof ut)try{return this.processGetPurchaseBatch(X)}catch(w){return xe(w)}else return xe(X)}))}processGetPurchaseBatch(_){let T=_.status,H=_ instanceof dt?_.body:_.error instanceof Blob?_.error:void 0,X={};if(_.headers)for(let w of _.headers.keys())X[w]=_.headers.get(w);return T===200?ze(H).pipe(ne(w=>{let ue=null,Xe=w===""?null:JSON.parse(w,this.jsonParseReviver);return ue=Re.fromJS(Xe),be(ue)})):T!==200&&T!==204?ze(H).pipe(ne(w=>yt("An unexpected server error occurred.",T,w,X))):be(null)}findPurchaseBatches(_){let T=this.baseUrl+"/v1/PurchaseBatch/FindPurchaseBatches";T=T.replace(/[?&]$/,"");let X={body:JSON.stringify(_),observe:"response",responseType:"blob",headers:new ct({"Content-Type":"application/json",Accept:"application/json"})};return this.http.request("post",T,X).pipe(ne(w=>this.processFindPurchaseBatches(w))).pipe(ge(w=>{if(w instanceof ut)try{return this.processFindPurchaseBatches(w)}catch(ue){return xe(ue)}else return xe(w)}))}processFindPurchaseBatches(_){let T=_.status,H=_ instanceof dt?_.body:_.error instanceof Blob?_.error:void 0,X={};if(_.headers)for(let w of _.headers.keys())X[w]=_.headers.get(w);return T===200?ze(H).pipe(ne(w=>{let ue=null,Xe=w===""?null:JSON.parse(w,this.jsonParseReviver);return ue=Ve.fromJS(Xe),be(ue)})):T!==200&&T!==204?ze(H).pipe(ne(w=>yt("An unexpected server error occurred.",T,w,X))):be(null)}getSalesPlansSummaries(_){let T=this.baseUrl+"/v1/PurchaseBatch/GetSalesPlansSummaries";T=T.replace(/[?&]$/,"");let X={body:JSON.stringify(_),observe:"response",responseType:"blob",headers:new ct({"Content-Type":"application/json",Accept:"application/json"})};return this.http.request("post",T,X).pipe(ne(w=>this.processGetSalesPlansSummaries(w))).pipe(ge(w=>{if(w instanceof ut)try{return this.processGetSalesPlansSummaries(w)}catch(ue){return xe(ue)}else return xe(w)}))}processGetSalesPlansSummaries(_){let T=_.status,H=_ instanceof dt?_.body:_.error instanceof Blob?_.error:void 0,X={};if(_.headers)for(let w of _.headers.keys())X[w]=_.headers.get(w);return T===200?ze(H).pipe(ne(w=>{let ue=null,Xe=w===""?null:JSON.parse(w,this.jsonParseReviver);if(Array.isArray(Xe)){ue=[];for(let Li of Xe)ue.push(_n.fromJS(Li))}else ue=null;return be(ue)})):T!==200&&T!==204?ze(H).pipe(ne(w=>yt("An unexpected server error occurred.",T,w,X))):be(null)}calcSalesPlans(){let _=this.baseUrl+"/v1/PurchaseBatch/CalcSalesPlansAsync";_=_.replace(/[?&]$/,"");let T={observe:"response",responseType:"blob",headers:new ct({})};return this.http.request("get",_,T).pipe(ne(H=>this.processCalcSalesPlans(H))).pipe(ge(H=>{if(H instanceof ut)try{return this.processCalcSalesPlans(H)}catch(X){return xe(X)}else return xe(H)}))}processCalcSalesPlans(_){let T=_.status,H=_ instanceof dt?_.body:_.error instanceof Blob?_.error:void 0,X={};if(_.headers)for(let w of _.headers.keys())X[w]=_.headers.get(w);return T===204?ze(H).pipe(ne(w=>be(null))):T!==200&&T!==204?ze(H).pipe(ne(w=>yt("An unexpected server error occurred.",T,w,X))):be(null)}};s.\u0275fac=function(T){return new(T||s)(Pt(Tr),Pt(t.REDICY_API_BASE_URL,8))},s.\u0275prov=Ye({token:s,factory:s.\u0275fac});let D=s;return D})();t.PurchaseBatchClient=c;let f=(()=>{let s=class s{constructor(_,T){this.jsonParseReviver=void 0,this.http=_,this.baseUrl=T??"/"}getSalesChannels(){let _=this.baseUrl+"/v1/SalesChannel/GetSalesChannels";_=_.replace(/[?&]$/,"");let T={observe:"response",responseType:"blob",headers:new ct({Accept:"application/json"})};return this.http.request("get",_,T).pipe(ne(H=>this.processGetSalesChannels(H))).pipe(ge(H=>{if(H instanceof ut)try{return this.processGetSalesChannels(H)}catch(X){return xe(X)}else return xe(H)}))}processGetSalesChannels(_){let T=_.status,H=_ instanceof dt?_.body:_.error instanceof Blob?_.error:void 0,X={};if(_.headers)for(let w of _.headers.keys())X[w]=_.headers.get(w);return T===200?ze(H).pipe(ne(w=>{let ue=null,Xe=w===""?null:JSON.parse(w,this.jsonParseReviver);if(Array.isArray(Xe)){ue=[];for(let Li of Xe)ue.push(ui.fromJS(Li))}else ue=null;return be(ue)})):T!==200&&T!==204?ze(H).pipe(ne(w=>yt("An unexpected server error occurred.",T,w,X))):be(null)}};s.\u0275fac=function(T){return new(T||s)(Pt(Tr),Pt(t.REDICY_API_BASE_URL,8))},s.\u0275prov=Ye({token:s,factory:s.\u0275fac});let D=s;return D})();t.SalesChannelClient=f;let m=(()=>{let s=class s{constructor(_,T){this.jsonParseReviver=void 0,this.http=_,this.baseUrl=T??"/"}getOzonWarehouses(){let _=this.baseUrl+"/v1/Warehouse/GetOzonWarehouses";_=_.replace(/[?&]$/,"");let T={observe:"response",responseType:"blob",headers:new ct({Accept:"application/json"})};return this.http.request("post",_,T).pipe(ne(H=>this.processGetOzonWarehouses(H))).pipe(ge(H=>{if(H instanceof ut)try{return this.processGetOzonWarehouses(H)}catch(X){return xe(X)}else return xe(H)}))}processGetOzonWarehouses(_){let T=_.status,H=_ instanceof dt?_.body:_.error instanceof Blob?_.error:void 0,X={};if(_.headers)for(let w of _.headers.keys())X[w]=_.headers.get(w);return T===200?ze(H).pipe(ne(w=>{let ue=null,Xe=w===""?null:JSON.parse(w,this.jsonParseReviver);if(Array.isArray(Xe)){ue=[];for(let Li of Xe)ue.push(ie.fromJS(Li))}else ue=null;return be(ue)})):T!==200&&T!==204?ze(H).pipe(ne(w=>yt("An unexpected server error occurred.",T,w,X))):be(null)}updateOzonWarehouse(_){let T=this.baseUrl+"/v1/Warehouse/UpdateOzonWarehouse";T=T.replace(/[?&]$/,"");let X={body:JSON.stringify(_),observe:"response",responseType:"blob",headers:new ct({"Content-Type":"application/json"})};return this.http.request("post",T,X).pipe(ne(w=>this.processUpdateOzonWarehouse(w))).pipe(ge(w=>{if(w instanceof ut)try{return this.processUpdateOzonWarehouse(w)}catch(ue){return xe(ue)}else return xe(w)}))}processUpdateOzonWarehouse(_){let T=_.status,H=_ instanceof dt?_.body:_.error instanceof Blob?_.error:void 0,X={};if(_.headers)for(let w of _.headers.keys())X[w]=_.headers.get(w);return T===204?ze(H).pipe(ne(w=>be(null))):T!==200&&T!==204?ze(H).pipe(ne(w=>yt("An unexpected server error occurred.",T,w,X))):be(null)}};s.\u0275fac=function(T){return new(T||s)(Pt(Tr),Pt(t.REDICY_API_BASE_URL,8))},s.\u0275prov=Ye({token:s,factory:s.\u0275fac});let D=s;return D})();t.WarehouseClient=m;class C{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){s&&(this.iD=s.ID,this.name=s.Name,this.disabled=s.Disabled,this.analyzable=s.Analyzable)}static fromJS(s){s=typeof s=="object"?s:{};let b=new C;return b.init(s),b}toJSON(s){return s=typeof s=="object"?s:{},s.ID=this.iD,s.Name=this.name,s.Disabled=this.disabled,s.Analyzable=this.analyzable,s}}t.ProductType=C;class y{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){s&&(this.warehouseID=s.WarehouseID,this.warehouseName=s.WarehouseName,this.warehouseClusterName=s.WarehouseClusterName,this.productPackageID=s.ProductPackageID,this.productPackageName=s.ProductPackageName,this.salesCount=s.SalesCount,this.standaloneWarehouse=s.StandaloneWarehouse,this.present=s.Present,this.reserved=s.Reserved,this.salesRate=s.SalesRate,this.stockDays=s.StockDays,this.moving=s.Moving)}static fromJS(s){s=typeof s=="object"?s:{};let b=new y;return b.init(s),b}toJSON(s){return s=typeof s=="object"?s:{},s.WarehouseID=this.warehouseID,s.WarehouseName=this.warehouseName,s.WarehouseClusterName=this.warehouseClusterName,s.ProductPackageID=this.productPackageID,s.ProductPackageName=this.productPackageName,s.SalesCount=this.salesCount,s.StandaloneWarehouse=this.standaloneWarehouse,s.Present=this.present,s.Reserved=this.reserved,s.SalesRate=this.salesRate,s.StockDays=this.stockDays,s.Moving=this.moving,s}}t.OzonStockStarvationReportItem=y;class k{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){if(s&&(this.lastDayOrderCount=s.LastDayOrderCount,this.lastDayOrderSum=s.LastDayOrderSum,this.weekSales=s.WeekSales?S.fromJS(s.WeekSales):void 0,Array.isArray(s.LastSales))){this.lastSales=[];for(let b of s.LastSales)this.lastSales.push(M.fromJS(b))}}static fromJS(s){s=typeof s=="object"?s:{};let b=new k;return b.init(s),b}toJSON(s){if(s=typeof s=="object"?s:{},s.LastDayOrderCount=this.lastDayOrderCount,s.LastDayOrderSum=this.lastDayOrderSum,s.WeekSales=this.weekSales?this.weekSales.toJSON():void 0,Array.isArray(this.lastSales)){s.LastSales=[];for(let b of this.lastSales)s.LastSales.push(b.toJSON())}return s}}t.LatestSales=k;class S{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){s&&(this.lastWeekIncome=s.LastWeekIncome,this.previousWeekIncome=s.PreviousWeekIncome)}static fromJS(s){s=typeof s=="object"?s:{};let b=new S;return b.init(s),b}toJSON(s){return s=typeof s=="object"?s:{},s.LastWeekIncome=this.lastWeekIncome,s.PreviousWeekIncome=this.previousWeekIncome,s}}t.WeekSales=S;class M{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){if(s){if(this.iD=s.ID,this.ozonOrderID=s.OzonOrderID,this.ozonOrderNumber=s.OzonOrderNumber,this.date=s.Date?new Date(s.Date.toString()):void 0,Array.isArray(s.Operations)){this.operations=[];for(let b of s.Operations)this.operations.push(A.fromJS(b))}if(Array.isArray(s.OrderItems)){this.orderItems=[];for(let b of s.OrderItems)this.orderItems.push(te.fromJS(b))}this.type=s.Type}}static fromJS(s){s=typeof s=="object"?s:{};let b=new M;return b.init(s),b}toJSON(s){if(s=typeof s=="object"?s:{},s.ID=this.iD,s.OzonOrderID=this.ozonOrderID,s.OzonOrderNumber=this.ozonOrderNumber,s.Date=this.date?this.date.toISOString():void 0,Array.isArray(this.operations)){s.Operations=[];for(let b of this.operations)s.Operations.push(b.toJSON())}if(Array.isArray(this.orderItems)){s.OrderItems=[];for(let b of this.orderItems)s.OrderItems.push(b.toJSON())}return s.Type=this.type,s}}t.OzonSalesOrder=M;let E;(function(D){D[D.Unknown=0]="Unknown",D[D.Fbo=1]="Fbo",D[D.Fbs=2]="Fbs"})(E=t.OzonSalesOrderType||(t.OzonSalesOrderType={}));class A{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){if(s&&(this.iD=s.ID,this.date=s.Date?new Date(s.Date.toString()):void 0,this.accrualsForSale=s.AccrualsForSale,this.amount=s.Amount,this.saleCommission=s.SaleCommission,this.operationType=s.OperationType,this.accrualType=s.AccrualType,this.deliveryCharge=s.DeliveryCharge,this.returnDeliveryCharge=s.ReturnDeliveryCharge,this.postingNumber=s.PostingNumber,Array.isArray(s.Services))){this.services=[];for(let b of s.Services)this.services.push(L.fromJS(b))}}static fromJS(s){s=typeof s=="object"?s:{};let b=new A;return b.init(s),b}toJSON(s){if(s=typeof s=="object"?s:{},s.ID=this.iD,s.Date=this.date?this.date.toISOString():void 0,s.AccrualsForSale=this.accrualsForSale,s.Amount=this.amount,s.SaleCommission=this.saleCommission,s.OperationType=this.operationType,s.AccrualType=this.accrualType,s.DeliveryCharge=this.deliveryCharge,s.ReturnDeliveryCharge=this.returnDeliveryCharge,s.PostingNumber=this.postingNumber,Array.isArray(this.services)){s.Services=[];for(let b of this.services)s.Services.push(b.toJSON())}return s}}t.OzonOperation=A;let x;(function(D){D[D.ClientReturnAgentOperation=0]="ClientReturnAgentOperation",D[D.MarketplaceMarketingActionCostOperation=1]="MarketplaceMarketingActionCostOperation",D[D.MarketplaceSaleReviewsOperation=2]="MarketplaceSaleReviewsOperation",D[D.MarketplaceSellerCompensationOperation=3]="MarketplaceSellerCompensationOperation",D[D.OperationAgentDeliveredToCustomer=4]="OperationAgentDeliveredToCustomer",D[D.OperationAgentDeliveredToCustomerCanceled=5]="OperationAgentDeliveredToCustomerCanceled",D[D.OperationAgentStornoDeliveredToCustomer=6]="OperationAgentStornoDeliveredToCustomer",D[D.OperationClaim=7]="OperationClaim",D[D.OperationCorrectionSeller=8]="OperationCorrectionSeller",D[D.OperationDefectiveWriteOff=9]="OperationDefectiveWriteOff",D[D.OperationItemReturn=10]="OperationItemReturn",D[D.OperationLackWriteOff=11]="OperationLackWriteOff",D[D.OperationMarketplaceCrossDockServiceWriteOff=12]="OperationMarketplaceCrossDockServiceWriteOff",D[D.OperationMarketplaceServiceStorage=13]="OperationMarketplaceServiceStorage",D[D.OperationSetOff=14]="OperationSetOff",D[D.MarketplaceSellerReexposureDeliveryReturnOperation=15]="MarketplaceSellerReexposureDeliveryReturnOperation",D[D.OperationReturnGoodsFBSofRMS=16]="OperationReturnGoodsFBSofRMS",D[D.ReturnAgentOperationRFBS=17]="ReturnAgentOperationRFBS",D[D.MarketplaceSellerShippingCompensationReturnOperation=18]="MarketplaceSellerShippingCompensationReturnOperation",D[D.OperationMarketplaceServicePremiumCashback=19]="OperationMarketplaceServicePremiumCashback",D[D.MarketplaceServicePremiumPromotion=20]="MarketplaceServicePremiumPromotion",D[D.MarketplaceRedistributionOfAcquiringOperation=21]="MarketplaceRedistributionOfAcquiringOperation",D[D.MarketplaceReturnStorageServiceAtThePickupPointFbsItem=22]="MarketplaceReturnStorageServiceAtThePickupPointFbsItem",D[D.MarketplaceReturnStorageServiceInTheWarehouseFbsItem=23]="MarketplaceReturnStorageServiceInTheWarehouseFbsItem",D[D.MarketplaceServiceItemDeliveryKGT=24]="MarketplaceServiceItemDeliveryKGT",D[D.MarketplaceServiceItemDirectFlowLogistic=25]="MarketplaceServiceItemDirectFlowLogistic",D[D.MarketplaceServiceItemReturnFlowLogistic=26]="MarketplaceServiceItemReturnFlowLogistic",D[D.MarketplaceServicePremiumCashbackIndividualPoints=27]="MarketplaceServicePremiumCashbackIndividualPoints",D[D.OperationMarketplaceWithHoldingForUndeliverableGoods=28]="OperationMarketplaceWithHoldingForUndeliverableGoods",D[D.OperationMarketplaceSupplyAdditional=29]="OperationMarketplaceSupplyAdditional",D[D.OperationMarketplaceSupplyExpirationDateProcessing=30]="OperationMarketplaceSupplyExpirationDateProcessing",D[D.OperationMarketplaceServiceSupplyInboundCargoSurplus=31]="OperationMarketplaceServiceSupplyInboundCargoSurplus",D[D.MarketplaceSellerCompensationItemOperation=32]="MarketplaceSellerCompensationItemOperation",D[D.MarketplaceSellerCorrectionOperation=33]="MarketplaceSellerCorrectionOperation",D[D.OperationMarketplaceServiceStockDisposal=34]="OperationMarketplaceServiceStockDisposal",D[D.AccrualConsigWriteOff=35]="AccrualConsigWriteOff",D[D.OperationElectronicServiceStencil=36]="OperationElectronicServiceStencil",D[D.OperationMarketplaceServiceSupplyInboundCargoShortage=37]="OperationMarketplaceServiceSupplyInboundCargoShortage"})(x=t.OperationType||(t.OperationType={}));let F;(function(D){D[D.All=0]="All",D[D.Orders=1]="Orders",D[D.Returns=2]="Returns",D[D.Services=3]="Services",D[D.Compensation=4]="Compensation",D[D.TransferDelivery=5]="TransferDelivery",D[D.Other=6]="Other"})(F=t.TransactionType||(t.TransactionType={}));class L{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){s&&(this.type=s.Type,this.price=s.Price)}static fromJS(s){s=typeof s=="object"?s:{};let b=new L;return b.init(s),b}toJSON(s){return s=typeof s=="object"?s:{},s.Type=this.type,s.Price=this.price,s}}t.OzonOperationService=L;let K;(function(D){D[D.MarketplaceNotDeliveredCostItem=0]="MarketplaceNotDeliveredCostItem",D[D.MarketplaceReturnAfterDeliveryCostItem=1]="MarketplaceReturnAfterDeliveryCostItem",D[D.MarketplaceDeliveryCostItem=2]="MarketplaceDeliveryCostItem",D[D.MarketplaceSaleReviewsItem=3]="MarketplaceSaleReviewsItem",D[D.ItemAdvertisementForSupplierLogistic=4]="ItemAdvertisementForSupplierLogistic",D[D.MarketplaceServiceStorageItem=5]="MarketplaceServiceStorageItem",D[D.MarketplaceMarketingActionCostItem=6]="MarketplaceMarketingActionCostItem",D[D.MarketplaceServiceItemInstallment=7]="MarketplaceServiceItemInstallment",D[D.MarketplaceServiceItemMarkingItems=8]="MarketplaceServiceItemMarkingItems",D[D.MarketplaceServiceItemFlexiblePaymentSchedule=9]="MarketplaceServiceItemFlexiblePaymentSchedule",D[D.MarketplaceServiceItemReturnFromStock=10]="MarketplaceServiceItemReturnFromStock",D[D.ItemAdvertisementForSupplierLogisticSeller=11]="ItemAdvertisementForSupplierLogisticSeller",D[D.MarketplaceServiceItemDelivToCustomer=12]="MarketplaceServiceItemDelivToCustomer",D[D.MarketplaceServiceItemDirectFlowTrans=13]="MarketplaceServiceItemDirectFlowTrans",D[D.MarketplaceServiceItemDropoffFF=14]="MarketplaceServiceItemDropoffFF",D[D.MarketplaceServiceItemDropoffPVZ=15]="MarketplaceServiceItemDropoffPVZ",D[D.MarketplaceServiceItemDropoffSC=16]="MarketplaceServiceItemDropoffSC",D[D.MarketplaceServiceItemFulfillment=17]="MarketplaceServiceItemFulfillment",D[D.MarketplaceServiceItemPickup=18]="MarketplaceServiceItemPickup",D[D.MarketplaceServiceItemReturnAfterDelivToCustomer=19]="MarketplaceServiceItemReturnAfterDelivToCustomer",D[D.MarketplaceServiceItemReturnFlowTrans=20]="MarketplaceServiceItemReturnFlowTrans",D[D.MarketplaceServiceItemReturnNotDelivToCustomer=21]="MarketplaceServiceItemReturnNotDelivToCustomer",D[D.MarketplaceServiceItemReturnPartGoodsCustomer=22]="MarketplaceServiceItemReturnPartGoodsCustomer",D[D.MarketplaceRedistributionOfAcquiringOperation=23]="MarketplaceRedistributionOfAcquiringOperation",D[D.MarketplaceReturnStorageServiceAtThePickupPointFbsItem=24]="MarketplaceReturnStorageServiceAtThePickupPointFbsItem",D[D.MarketplaceReturnStorageServiceInTheWarehouseFbsItem=25]="MarketplaceReturnStorageServiceInTheWarehouseFbsItem",D[D.MarketplaceServiceItemDeliveryKGT=26]="MarketplaceServiceItemDeliveryKGT",D[D.MarketplaceServiceItemDirectFlowLogistic=27]="MarketplaceServiceItemDirectFlowLogistic",D[D.MarketplaceServiceItemReturnFlowLogistic=28]="MarketplaceServiceItemReturnFlowLogistic",D[D.MarketplaceServicePremiumCashbackIndividualPoints=29]="MarketplaceServicePremiumCashbackIndividualPoints",D[D.MarketplaceServicePremiumPromotion=30]="MarketplaceServicePremiumPromotion",D[D.OperationMarketplaceWithHoldingForUndeliverableGoods=31]="OperationMarketplaceWithHoldingForUndeliverableGoods"})(K=t.OperationServiceType||(t.OperationServiceType={}));class te{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){s&&(this.iD=s.ID,this.postingNumber=s.PostingNumber,this.currencyCode=s.CurrencyCode,this.price=s.Price,this.quantity=s.Quantity,this.product=s.Product?R.fromJS(s.Product):void 0,this.status=s.Status,this.city=s.City,this.region=s.Region,this.clusterFrom=s.ClusterFrom,this.clusterTo=s.ClusterTo,this.deliveryType=s.DeliveryType,this.ozonWarehouse=s.OzonWarehouse?ie.fromJS(s.OzonWarehouse):void 0)}static fromJS(s){s=typeof s=="object"?s:{};let b=new te;return b.init(s),b}toJSON(s){return s=typeof s=="object"?s:{},s.ID=this.iD,s.PostingNumber=this.postingNumber,s.CurrencyCode=this.currencyCode,s.Price=this.price,s.Quantity=this.quantity,s.Product=this.product?this.product.toJSON():void 0,s.Status=this.status,s.City=this.city,s.Region=this.region,s.ClusterFrom=this.clusterFrom,s.ClusterTo=this.clusterTo,s.DeliveryType=this.deliveryType,s.OzonWarehouse=this.ozonWarehouse?this.ozonWarehouse.toJSON():void 0,s}}t.OzonSalesOrderItem=te;let V;(function(D){D[D.RUB=0]="RUB",D[D.BYN=1]="BYN",D[D.KZT=2]="KZT",D[D.EUR=3]="EUR",D[D.USD=4]="USD",D[D.CNY=5]="CNY"})(V=t.Currency||(t.Currency={}));class R{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){if(s){if(this.productPackageID=s.ProductPackageID,this.name=s.Name,this.primaryImage=s.PrimaryImage,this.categoryID=s.CategoryID,this.fboSku=s.FboSku,this.fbsSku=s.FbsSku,this.sku=s.Sku,Array.isArray(s.Barcodes)){this.barcodes=[];for(let b of s.Barcodes)this.barcodes.push(b)}if(this.marketingPrice=s.MarketingPrice,this.minPrice=s.MinPrice,this.oldPrice=s.OldPrice,this.premiumPrice=s.PremiumPrice,this.price=s.Price,this.recommendedPrice=s.RecommendedPrice,this.externalCompetitorMinimalPrice=s.ExternalCompetitorMinimalPrice,this.externalCompetitorMinimalPriceCurrency=s.ExternalCompetitorMinimalPriceCurrency,this.externalCompetitorPriceIndexValue=s.ExternalCompetitorPriceIndexValue,this.ozonCompetitorMinimalPrice=s.OzonCompetitorMinimalPrice,this.ozonCompetitorMinimalPriceCurrency=s.OzonCompetitorMinimalPriceCurrency,this.ozonCompetitorPriceIndexValue=s.OzonCompetitorPriceIndexValue,this.externalMinimalPrice=s.ExternalMinimalPrice,this.externalMinimalPriceCurrency=s.ExternalMinimalPriceCurrency,this.externalPriceIndexValue=s.ExternalPriceIndexValue,Array.isArray(s.Stocks)){this.stocks=[];for(let b of s.Stocks)this.stocks.push(q.fromJS(b))}}}static fromJS(s){s=typeof s=="object"?s:{};let b=new R;return b.init(s),b}toJSON(s){if(s=typeof s=="object"?s:{},s.ProductPackageID=this.productPackageID,s.Name=this.name,s.PrimaryImage=this.primaryImage,s.CategoryID=this.categoryID,s.FboSku=this.fboSku,s.FbsSku=this.fbsSku,s.Sku=this.sku,Array.isArray(this.barcodes)){s.Barcodes=[];for(let b of this.barcodes)s.Barcodes.push(b)}if(s.MarketingPrice=this.marketingPrice,s.MinPrice=this.minPrice,s.OldPrice=this.oldPrice,s.PremiumPrice=this.premiumPrice,s.Price=this.price,s.RecommendedPrice=this.recommendedPrice,s.ExternalCompetitorMinimalPrice=this.externalCompetitorMinimalPrice,s.ExternalCompetitorMinimalPriceCurrency=this.externalCompetitorMinimalPriceCurrency,s.ExternalCompetitorPriceIndexValue=this.externalCompetitorPriceIndexValue,s.OzonCompetitorMinimalPrice=this.ozonCompetitorMinimalPrice,s.OzonCompetitorMinimalPriceCurrency=this.ozonCompetitorMinimalPriceCurrency,s.OzonCompetitorPriceIndexValue=this.ozonCompetitorPriceIndexValue,s.ExternalMinimalPrice=this.externalMinimalPrice,s.ExternalMinimalPriceCurrency=this.externalMinimalPriceCurrency,s.ExternalPriceIndexValue=this.externalPriceIndexValue,Array.isArray(this.stocks)){s.Stocks=[];for(let b of this.stocks)s.Stocks.push(b.toJSON())}return s}}t.OzonProduct=R;class q{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){s&&(this.present=s.Present,this.reserved=s.Reserved,this.productID=s.ProductID,this.warehouseID=s.WarehouseID,this.warehouse=s.Warehouse?ie.fromJS(s.Warehouse):void 0)}static fromJS(s){s=typeof s=="object"?s:{};let b=new q;return b.init(s),b}toJSON(s){return s=typeof s=="object"?s:{},s.Present=this.present,s.Reserved=this.reserved,s.ProductID=this.productID,s.WarehouseID=this.warehouseID,s.Warehouse=this.warehouse?this.warehouse.toJSON():void 0,s}}t.OzonProductStock=q;class ie{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){if(s){if(this.iD=s.ID,this.ozonID=s.OzonID,this.name=s.Name,this.address=s.Address,this.warehouseCluster=s.WarehouseCluster,this.standalone=s.Standalone,Array.isArray(s.Aliases)){this.aliases=[];for(let b of s.Aliases)this.aliases.push(b)}this.status=s.Status}}static fromJS(s){s=typeof s=="object"?s:{};let b=new ie;return b.init(s),b}toJSON(s){if(s=typeof s=="object"?s:{},s.ID=this.iD,s.OzonID=this.ozonID,s.Name=this.name,s.Address=this.address,s.WarehouseCluster=this.warehouseCluster,s.Standalone=this.standalone,Array.isArray(this.aliases)){s.Aliases=[];for(let b of this.aliases)s.Aliases.push(b)}return s.Status=this.status,s}}t.OzonWarehouse=ie;let de;(function(D){D[D.AwaitingPackaging=0]="AwaitingPackaging",D[D.AwaitingDeliver=1]="AwaitingDeliver",D[D.Delivering=2]="Delivering",D[D.Delivered=3]="Delivered",D[D.Cancelled=4]="Cancelled",D[D.AwaitingRegistration=5]="AwaitingRegistration",D[D.AcceptanceInProgress=6]="AcceptanceInProgress",D[D.AwaitingApprove=7]="AwaitingApprove",D[D.Arbitration=8]="Arbitration",D[D.ClientArbitration=9]="ClientArbitration",D[D.DriverPickup=10]="DriverPickup",D[D.NotAccepted=11]="NotAccepted",D[D.SentBySeller=12]="SentBySeller",D[D._13=13]="_13"})(de=t.PostingStatus||(t.PostingStatus={}));class ye{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){if(s&&(this.dateFrom=s.DateFrom?new Date(s.DateFrom.toString()):void 0,this.dateTo=s.DateTo?new Date(s.DateTo.toString()):void 0,Array.isArray(s.PostingNumbers))){this.postingNumbers=[];for(let b of s.PostingNumbers)this.postingNumbers.push(b)}}static fromJS(s){s=typeof s=="object"?s:{};let b=new ye;return b.init(s),b}toJSON(s){if(s=typeof s=="object"?s:{},s.DateFrom=this.dateFrom?this.dateFrom.toISOString():void 0,s.DateTo=this.dateTo?this.dateTo.toISOString():void 0,Array.isArray(this.postingNumbers)){s.PostingNumbers=[];for(let b of this.postingNumbers)s.PostingNumbers.push(b)}return s}}t.FindPostingsModel=ye;class _t{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){if(s&&(this.totalCount=s.TotalCount,Array.isArray(s.Items))){this.items=[];for(let b of s.Items)this.items.push(St.fromJS(b))}}static fromJS(s){s=typeof s=="object"?s:{};let b=new _t;return b.init(s),b}toJSON(s){if(s=typeof s=="object"?s:{},s.TotalCount=this.totalCount,Array.isArray(this.items)){s.Items=[];for(let b of this.items)s.Items.push(b.toJSON())}return s}}t.PagedResponseOfOzonSupplyOrders=_t;class St{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){if(s){if(this.iD=s.ID,Array.isArray(s.OrderItems)){this.orderItems=[];for(let b of s.OrderItems)this.orderItems.push(st.fromJS(b))}this.ozonOrderNumber=s.OzonOrderNumber,this.totalQuantity=s.TotalQuantity,this.totalItemCount=s.TotalItemCount,this.ozonWarehouseOzonID=s.OzonWarehouseOzonID,this.ozonCrossDockWarehouseID=s.OzonCrossDockWarehouseID,this.date=s.Date?new Date(s.Date.toString()):void 0,this.ozonWarehouse=s.OzonWarehouse?ie.fromJS(s.OzonWarehouse):void 0,this.ozonCrossDockWarehouse=s.OzonCrossDockWarehouse?ie.fromJS(s.OzonCrossDockWarehouse):void 0,this.state=s.State}}static fromJS(s){s=typeof s=="object"?s:{};let b=new St;return b.init(s),b}toJSON(s){if(s=typeof s=="object"?s:{},s.ID=this.iD,Array.isArray(this.orderItems)){s.OrderItems=[];for(let b of this.orderItems)s.OrderItems.push(b.toJSON())}return s.OzonOrderNumber=this.ozonOrderNumber,s.TotalQuantity=this.totalQuantity,s.TotalItemCount=this.totalItemCount,s.OzonWarehouseOzonID=this.ozonWarehouseOzonID,s.OzonCrossDockWarehouseID=this.ozonCrossDockWarehouseID,s.Date=this.date?this.date.toISOString():void 0,s.OzonWarehouse=this.ozonWarehouse?this.ozonWarehouse.toJSON():void 0,s.OzonCrossDockWarehouse=this.ozonCrossDockWarehouse?this.ozonCrossDockWarehouse.toJSON():void 0,s.State=this.state,s}}t.OzonSupplyOrder=St;class st{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){s&&(this.productPackageID=s.ProductPackageID,this.ozonSupplyOrderID=s.OzonSupplyOrderID,this.quantity=s.Quantity,this.productPackage=s.ProductPackage?or.fromJS(s.ProductPackage):void 0,this.supplyOrder=s.SupplyOrder?St.fromJS(s.SupplyOrder):void 0)}static fromJS(s){s=typeof s=="object"?s:{};let b=new st;return b.init(s),b}toJSON(s){return s=typeof s=="object"?s:{},s.ProductPackageID=this.productPackageID,s.OzonSupplyOrderID=this.ozonSupplyOrderID,s.Quantity=this.quantity,s.ProductPackage=this.productPackage?this.productPackage.toJSON():void 0,s.SupplyOrder=this.supplyOrder?this.supplyOrder.toJSON():void 0,s}}t.OzonSupplyOrderItem=st;class or{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){s&&(this.iD=s.ID,this.name=s.Name,this.minimumWarehouseStock=s.MinimumWarehouseStock,this.productCount=s.ProductCount,this.productID=s.ProductID,this.supplyPreparationTimeInDays=s.SupplyPreparationTimeInDays,this.product=s.Product?ot.fromJS(s.Product):void 0)}static fromJS(s){s=typeof s=="object"?s:{};let b=new or;return b.init(s),b}toJSON(s){return s=typeof s=="object"?s:{},s.ID=this.iD,s.Name=this.name,s.MinimumWarehouseStock=this.minimumWarehouseStock,s.ProductCount=this.productCount,s.ProductID=this.productID,s.SupplyPreparationTimeInDays=this.supplyPreparationTimeInDays,s.Product=this.product?this.product.toJSON():void 0,s}}t.ProductPackage=or;class ot{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){if(s&&(this.iD=s.ID,this.categoryID=s.CategoryID,this.stockAmount=s.StockAmount,this.name=s.Name,this.category=s.Category?yr.fromJS(s.Category):void 0,Array.isArray(s.Packages))){this.packages=[];for(let b of s.Packages)this.packages.push(or.fromJS(b))}}static fromJS(s){s=typeof s=="object"?s:{};let b=new ot;return b.init(s),b}toJSON(s){if(s=typeof s=="object"?s:{},s.ID=this.iD,s.CategoryID=this.categoryID,s.StockAmount=this.stockAmount,s.Name=this.name,s.Category=this.category?this.category.toJSON():void 0,Array.isArray(this.packages)){s.Packages=[];for(let b of this.packages)s.Packages.push(b.toJSON())}return s}}t.Product=ot;class yr{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){if(s&&(this.iD=s.ID,this.name=s.Name,Array.isArray(s.Product))){this.product=[];for(let b of s.Product)this.product.push(ot.fromJS(b))}}static fromJS(s){s=typeof s=="object"?s:{};let b=new yr;return b.init(s),b}toJSON(s){if(s=typeof s=="object"?s:{},s.ID=this.iD,s.Name=this.name,Array.isArray(this.product)){s.Product=[];for(let b of this.product)s.Product.push(b.toJSON())}return s}}t.ProductCategory=yr;class Vr{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){s&&(this.offset=s.Offset,this.count=s.Count)}static fromJS(s){s=typeof s=="object"?s:{};let b=new Vr;return b.init(s),b}toJSON(s){return s=typeof s=="object"?s:{},s.Offset=this.offset,s.Count=this.count,s}}t.FindOzonSupplyOrdersModel=Vr;class Cr{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){if(s&&(this.totalCount=s.TotalCount,Array.isArray(s.Items))){this.items=[];for(let b of s.Items)this.items.push(R.fromJS(b))}}static fromJS(s){s=typeof s=="object"?s:{};let b=new Cr;return b.init(s),b}toJSON(s){if(s=typeof s=="object"?s:{},s.TotalCount=this.totalCount,Array.isArray(this.items)){s.Items=[];for(let b of this.items)s.Items.push(b.toJSON())}return s}}t.PagedResponseOfOzonProducts=Cr;class gi{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){s&&(this.offset=s.Offset,this.count=s.Count,this.productName=s.ProductName,this.productPackageID=s.ProductPackageID,this.includeStocks=s.IncludeStocks,this.orderField=s.OrderField,this.orderAscending=s.OrderAscending)}static fromJS(s){s=typeof s=="object"?s:{};let b=new gi;return b.init(s),b}toJSON(s){return s=typeof s=="object"?s:{},s.Offset=this.offset,s.Count=this.count,s.ProductName=this.productName,s.ProductPackageID=this.productPackageID,s.IncludeStocks=this.includeStocks,s.OrderField=this.orderField,s.OrderAscending=this.orderAscending,s}}t.FindOzonProductsModel=gi;let Ft;(function(D){D[D.Unknown=0]="Unknown",D[D.ProductPackageID=1]="ProductPackageID",D[D.ProductName=2]="ProductName"})(Ft=t.FindOzonProductsModelSortField||(t.FindOzonProductsModelSortField={}));class At{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){if(s){for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b]);if(this.totalCount=s.TotalCount,Array.isArray(s.Items)){this.items=[];for(let _ of s.Items)this.items.push(A.fromJS(_))}}}static fromJS(s){s=typeof s=="object"?s:{};let b=new At;return b.init(s),b}toJSON(s){s=typeof s=="object"?s:{};for(var b in this)this.hasOwnProperty(b)&&(s[b]=this[b]);if(s.TotalCount=this.totalCount,Array.isArray(this.items)){s.Items=[];for(let _ of this.items)s.Items.push(_.toJSON())}return s}}t.PagedResponseOfOzonOperations=At;let zt;(function(D){D[D.New=0]="New",D[D.Ready=1]="Ready",D[D.Missing=2]="Missing"})(zt=t.OzonWarehouseStatus||(t.OzonWarehouseStatus={}));class Ut{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){if(s){for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b]);this.clearingWarehouseId=s.clearingWarehouseId,this.name=s.name,this.address=s.address}}static fromJS(s){s=typeof s=="object"?s:{};let b=new Ut;return b.init(s),b}toJSON(s){s=typeof s=="object"?s:{};for(var b in this)this.hasOwnProperty(b)&&(s[b]=this[b]);return s.clearingWarehouseId=this.clearingWarehouseId,s.name=this.name,s.address=this.address,s}}t.SupplierApiOzonWarehouseInfo=Ut;class Wt{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){s&&(this.offset=s.Offset,this.count=s.Count,this.dateFrom=s.DateFrom?new Date(s.DateFrom.toString()):void 0,this.dateTo=s.DateTo?new Date(s.DateTo.toString()):void 0)}static fromJS(s){s=typeof s=="object"?s:{};let b=new Wt;return b.init(s),b}toJSON(s){return s=typeof s=="object"?s:{},s.Offset=this.offset,s.Count=this.count,s.DateFrom=this.dateFrom?_i(this.dateFrom):void 0,s.DateTo=this.dateTo?_i(this.dateTo):void 0,s}}t.FindOzonOperationsModel=Wt;class Rt{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){s&&(this.iD=s.ID,this.name=s.Name,this.unitOfMeasure=s.UnitOfMeasure,this.decimalPlaces=s.DecimalPlaces,this.price=s.Price)}static fromJS(s){s=typeof s=="object"?s:{};let b=new Rt;return b.init(s),b}toJSON(s){return s=typeof s=="object"?s:{},s.ID=this.iD,s.Name=this.name,s.UnitOfMeasure=this.unitOfMeasure,s.DecimalPlaces=this.decimalPlaces,s.Price=this.price,s}}t.PackageTypeWithPrice=Rt;let G;(function(D){D[D.Unknown=0]="Unknown",D[D.SquareMeter=1]="SquareMeter",D[D.Piece=2]="Piece",D[D.Meter=3]="Meter"})(G=t.UnitOfMeasure||(t.UnitOfMeasure={}));class re{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){if(s&&(this.iD=s.ID,this.name=s.Name,this.unitOfMeasure=s.UnitOfMeasure,this.decimalPlaces=s.DecimalPlaces,Array.isArray(s.Prices))){this.prices=[];for(let b of s.Prices)this.prices.push(Q.fromJS(b))}}static fromJS(s){s=typeof s=="object"?s:{};let b=new re;return b.init(s),b}toJSON(s){if(s=typeof s=="object"?s:{},s.ID=this.iD,s.Name=this.name,s.UnitOfMeasure=this.unitOfMeasure,s.DecimalPlaces=this.decimalPlaces,Array.isArray(this.prices)){s.Prices=[];for(let b of this.prices)s.Prices.push(b.toJSON())}return s}}t.PackageType=re;class Q{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){s&&(this.packageTypeID=s.PackageTypeID,this.price=s.Price,this.date=s.Date?new Date(s.Date.toString()):void 0)}static fromJS(s){s=typeof s=="object"?s:{};let b=new Q;return b.init(s),b}toJSON(s){return s=typeof s=="object"?s:{},s.PackageTypeID=this.packageTypeID,s.Price=this.price,s.Date=this.date?this.date.toISOString():void 0,s}}t.PackageTypePrice=Q;class J{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){if(s&&(this.totalCount=s.TotalCount,Array.isArray(s.Items))){this.items=[];for(let b of s.Items)this.items.push(ot.fromJS(b))}}static fromJS(s){s=typeof s=="object"?s:{};let b=new J;return b.init(s),b}toJSON(s){if(s=typeof s=="object"?s:{},s.TotalCount=this.totalCount,Array.isArray(this.items)){s.Items=[];for(let b of this.items)s.Items.push(b.toJSON())}return s}}t.PagedResponseOfProduct=J;class Ce{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){s&&(this.offset=s.Offset,this.count=s.Count,this.iD=s.ID,this.name=s.Name,this.orderField=s.OrderField,this.orderAscending=s.OrderAscending)}static fromJS(s){s=typeof s=="object"?s:{};let b=new Ce;return b.init(s),b}toJSON(s){return s=typeof s=="object"?s:{},s.Offset=this.offset,s.Count=this.count,s.ID=this.iD,s.Name=this.name,s.OrderField=this.orderField,s.OrderAscending=this.orderAscending,s}}t.FindProductsModel=Ce;let qe;(function(D){D[D.Unknown=0]="Unknown",D[D.ID=1]="ID",D[D.Name=2]="Name"})(qe=t.FindProductsModelSortField||(t.FindProductsModelSortField={}));class pt{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){if(s&&(this.totalCount=s.TotalCount,Array.isArray(s.Items))){this.items=[];for(let b of s.Items)this.items.push(or.fromJS(b))}}static fromJS(s){s=typeof s=="object"?s:{};let b=new pt;return b.init(s),b}toJSON(s){if(s=typeof s=="object"?s:{},s.TotalCount=this.totalCount,Array.isArray(this.items)){s.Items=[];for(let b of this.items)s.Items.push(b.toJSON())}return s}}t.PagedResponseOfProductPackage=pt;class tt{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){s&&(this.offset=s.Offset,this.count=s.Count,this.productPackageName=s.ProductPackageName,this.productID=s.ProductID)}static fromJS(s){s=typeof s=="object"?s:{};let b=new tt;return b.init(s),b}toJSON(s){return s=typeof s=="object"?s:{},s.Offset=this.offset,s.Count=this.count,s.ProductPackageName=this.productPackageName,s.ProductID=this.productID,s}}t.FindProductPackagesModel=tt;class Re{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){if(s&&(this.iD=s.ID,this.name=s.Name,this.date=s.Date?new Date(s.Date.toString()):void 0,this.status=s.Status,Array.isArray(s.Items))){this.items=[];for(let b of s.Items)this.items.push(Lt.fromJS(b))}}static fromJS(s){s=typeof s=="object"?s:{};let b=new Re;return b.init(s),b}toJSON(s){if(s=typeof s=="object"?s:{},s.ID=this.iD,s.Name=this.name,s.Date=this.date?_i(this.date):void 0,s.Status=this.status,Array.isArray(this.items)){s.Items=[];for(let b of this.items)s.Items.push(b.toJSON())}return s}}t.PurchaseBatch=Re;let jt;(function(D){D[D.Unknown=0]="Unknown",D[D.Purchased=1]="Purchased",D[D.InSale=2]="InSale",D[D.Sold=3]="Sold"})(jt=t.PurchaseBatchStatus||(t.PurchaseBatchStatus={}));class Lt{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){if(s&&(this.iD=s.ID,this.count=s.Count,this.price=s.Price,this.productID=s.ProductID,this.purchaseBatchID=s.PurchaseBatchID,this.product=s.Product?ot.fromJS(s.Product):void 0,this.purchaseBatch=s.PurchaseBatch?Re.fromJS(s.PurchaseBatch):void 0,Array.isArray(s.SalesItems))){this.salesItems=[];for(let b of s.SalesItems)this.salesItems.push(Qe.fromJS(b))}}static fromJS(s){s=typeof s=="object"?s:{};let b=new Lt;return b.init(s),b}toJSON(s){if(s=typeof s=="object"?s:{},s.ID=this.iD,s.Count=this.count,s.Price=this.price,s.ProductID=this.productID,s.PurchaseBatchID=this.purchaseBatchID,s.Product=this.product?this.product.toJSON():void 0,s.PurchaseBatch=this.purchaseBatch?this.purchaseBatch.toJSON():void 0,Array.isArray(this.salesItems)){s.SalesItems=[];for(let b of this.salesItems)s.SalesItems.push(b.toJSON())}return s}}t.PurchaseBatchItem=Lt;class Qe{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){if(s){if(this.iD=s.ID,this.name=s.Name,this.volume=s.Volume,this.packagingPrice=s.PackagingPrice,this.purchaseBatchItemID=s.PurchaseBatchItemID,this.productPackageID=s.ProductPackageID,this.productPackage=s.ProductPackage?or.fromJS(s.ProductPackage):void 0,this.purchaseBatchItem=s.PurchaseBatchItem?Lt.fromJS(s.PurchaseBatchItem):void 0,Array.isArray(s.SalesItemPackages)){this.salesItemPackages=[];for(let b of s.SalesItemPackages)this.salesItemPackages.push(ar.fromJS(b))}if(Array.isArray(s.SalesPlans)){this.salesPlans=[];for(let b of s.SalesPlans)this.salesPlans.push(cr.fromJS(b))}}}static fromJS(s){s=typeof s=="object"?s:{};let b=new Qe;return b.init(s),b}toJSON(s){if(s=typeof s=="object"?s:{},s.ID=this.iD,s.Name=this.name,s.Volume=this.volume,s.PackagingPrice=this.packagingPrice,s.PurchaseBatchItemID=this.purchaseBatchItemID,s.ProductPackageID=this.productPackageID,s.ProductPackage=this.productPackage?this.productPackage.toJSON():void 0,s.PurchaseBatchItem=this.purchaseBatchItem?this.purchaseBatchItem.toJSON():void 0,Array.isArray(this.salesItemPackages)){s.SalesItemPackages=[];for(let b of this.salesItemPackages)s.SalesItemPackages.push(b.toJSON())}if(Array.isArray(this.salesPlans)){s.SalesPlans=[];for(let b of this.salesPlans)s.SalesPlans.push(b.toJSON())}return s}}t.SalesItem=Qe;class ar{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){s&&(this.amount=s.Amount,this.pricePerUom=s.PricePerUom,this.packageTypeID=s.PackageTypeID,this.salesItemID=s.SalesItemID,this.salesItem=s.SalesItem?Qe.fromJS(s.SalesItem):void 0,this.packageType=s.PackageType?re.fromJS(s.PackageType):void 0)}static fromJS(s){s=typeof s=="object"?s:{};let b=new ar;return b.init(s),b}toJSON(s){return s=typeof s=="object"?s:{},s.Amount=this.amount,s.PricePerUom=this.pricePerUom,s.PackageTypeID=this.packageTypeID,s.SalesItemID=this.salesItemID,s.SalesItem=this.salesItem?this.salesItem.toJSON():void 0,s.PackageType=this.packageType?this.packageType.toJSON():void 0,s}}t.SalesItemPackage=ar;class cr{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){s&&(this.iD=s.ID,this.status=s.Status,this.price=s.Price,this.amount=s.Amount,this.salesPerMonth=s.SalesPerMonth,this.commissionMultiplier=s.CommissionMultiplier,this.commissionAddition=s.CommissionAddition,this.returnPercentage=s.ReturnPercentage,this.returnCost=s.ReturnCost,this.deliveryCost=s.DeliveryCost,this.deliveryDate=s.DeliveryDate?new Date(s.DeliveryDate.toString()):void 0,this.marketingBudget=s.MarketingBudget,this.salesItemID=s.SalesItemID,this.salesChannelID=s.SalesChannelID,this.salesItem=s.SalesItem?Qe.fromJS(s.SalesItem):void 0,this.salesChannel=s.SalesChannel?ui.fromJS(s.SalesChannel):void 0)}static fromJS(s){s=typeof s=="object"?s:{};let b=new cr;return b.init(s),b}toJSON(s){return s=typeof s=="object"?s:{},s.ID=this.iD,s.Status=this.status,s.Price=this.price,s.Amount=this.amount,s.SalesPerMonth=this.salesPerMonth,s.CommissionMultiplier=this.commissionMultiplier,s.CommissionAddition=this.commissionAddition,s.ReturnPercentage=this.returnPercentage,s.ReturnCost=this.returnCost,s.DeliveryCost=this.deliveryCost,s.DeliveryDate=this.deliveryDate?_i(this.deliveryDate):void 0,s.MarketingBudget=this.marketingBudget,s.SalesItemID=this.salesItemID,s.SalesChannelID=this.salesChannelID,s.SalesItem=this.salesItem?this.salesItem.toJSON():void 0,s.SalesChannel=this.salesChannel?this.salesChannel.toJSON():void 0,s}}t.SalesPlan=cr;let si;(function(D){D[D.Draft=0]="Draft",D[D.InProcess=1]="InProcess",D[D.Finalized=2]="Finalized"})(si=t.SalesPlanStatus||(t.SalesPlanStatus={}));class ui{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){s&&(this.iD=s.ID,this.name=s.Name)}static fromJS(s){s=typeof s=="object"?s:{};let b=new ui;return b.init(s),b}toJSON(s){return s=typeof s=="object"?s:{},s.ID=this.iD,s.Name=this.name,s}}t.SalesChannel=ui;class Ve{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){if(s&&(this.totalCount=s.TotalCount,Array.isArray(s.Items))){this.items=[];for(let b of s.Items)this.items.push(Re.fromJS(b))}}static fromJS(s){s=typeof s=="object"?s:{};let b=new Ve;return b.init(s),b}toJSON(s){if(s=typeof s=="object"?s:{},s.TotalCount=this.totalCount,Array.isArray(this.items)){s.Items=[];for(let b of this.items)s.Items.push(b.toJSON())}return s}}t.PagedResponseOfPurchaseBatches=Ve;class We{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){s&&(this.offset=s.Offset,this.count=s.Count,this.dateFrom=s.DateFrom?new Date(s.DateFrom.toString()):void 0,this.dateTo=s.DateTo?new Date(s.DateTo.toString()):void 0,this.article=s.Article,this.name=s.Name)}static fromJS(s){s=typeof s=="object"?s:{};let b=new We;return b.init(s),b}toJSON(s){return s=typeof s=="object"?s:{},s.Offset=this.offset,s.Count=this.count,s.DateFrom=this.dateFrom?_i(this.dateFrom):void 0,s.DateTo=this.dateTo?_i(this.dateTo):void 0,s.Article=this.article,s.Name=this.name,s}}t.FindPurchaseBatchesModel=We;class _n{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){s&&(this.iD=s.ID,this.salesCount=s.SalesCount,this.returnCount=s.ReturnCount,this.commissionPercent=s.CommissionPercent,this.commissionAddition=s.CommissionAddition,this.returnSum=s.ReturnSum,this.salesSum=s.SalesSum)}static fromJS(s){s=typeof s=="object"?s:{};let b=new _n;return b.init(s),b}toJSON(s){return s=typeof s=="object"?s:{},s.ID=this.iD,s.SalesCount=this.salesCount,s.ReturnCount=this.returnCount,s.CommissionPercent=this.commissionPercent,s.CommissionAddition=this.commissionAddition,s.ReturnSum=this.returnSum,s.SalesSum=this.salesSum,s}}t.SalesPlanSummary=_n;class wi{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){if(s){if(this.iD=s.ID,this.name=s.Name,this.disabled=s.Disabled,this.analyzable=s.Analyzable,Array.isArray(s.Types)){this.types=[];for(let b of s.Types)this.types.push(C.fromJS(b))}if(Array.isArray(s.Children)){this.children=[];for(let b of s.Children)this.children.push(wi.fromJS(b))}}}static fromJS(s){s=typeof s=="object"?s:{};let b=new wi;return b.init(s),b}toJSON(s){if(s=typeof s=="object"?s:{},s.ID=this.iD,s.Name=this.name,s.Disabled=this.disabled,s.Analyzable=this.analyzable,Array.isArray(this.types)){s.Types=[];for(let b of this.types)s.Types.push(b.toJSON())}if(Array.isArray(this.children)){s.Children=[];for(let b of this.children)s.Children.push(b.toJSON())}return s}}t.Category=wi;class $r{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){s&&(this.quantity=s.Quantity,this.month=s.Month?new Date(s.Month.toString()):void 0)}static fromJS(s){s=typeof s=="object"?s:{};let b=new $r;return b.init(s),b}toJSON(s){return s=typeof s=="object"?s:{},s.Quantity=this.quantity,s.Month=this.month?_i(this.month):void 0,s}}t.ProductTypeHistoryItem=$r;class xn{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){if(s){for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b]);if(this.iD=s.ID,this.date=s.Date?new Date(s.Date.toString()):void 0,this.salesChannelID=s.SalesChannelID,Array.isArray(s.ShipmentPackages)){this.shipmentPackages=[];for(let _ of s.ShipmentPackages)this.shipmentPackages.push(Vt.fromJS(_))}if(Array.isArray(s.Supplies)){this.supplies=[];for(let _ of s.Supplies)this.supplies.push(uo.fromJS(_))}}}static fromJS(s){s=typeof s=="object"?s:{};let b=new xn;return b.init(s),b}toJSON(s){s=typeof s=="object"?s:{};for(var b in this)this.hasOwnProperty(b)&&(s[b]=this[b]);if(s.ID=this.iD,s.Date=this.date?this.date.toISOString():void 0,s.SalesChannelID=this.salesChannelID,Array.isArray(this.shipmentPackages)){s.ShipmentPackages=[];for(let _ of this.shipmentPackages)s.ShipmentPackages.push(_.toJSON())}if(Array.isArray(this.supplies)){s.Supplies=[];for(let _ of this.supplies)s.Supplies.push(_.toJSON())}return s}}t.Shipment=xn;class uo{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){if(s){for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b]);if(this.price=s.Price,Array.isArray(s.SupplyItems)){this.supplyItems=[];for(let _ of s.SupplyItems)this.supplyItems.push(Ln.fromJS(_))}if(Array.isArray(s.SupplyPackages)){this.supplyPackages=[];for(let _ of s.SupplyPackages)this.supplyPackages.push(Vt.fromJS(_))}this.ozonWarehouse=s.OzonWarehouse?ie.fromJS(s.OzonWarehouse):void 0}}static fromJS(s){s=typeof s=="object"?s:{};let b=new uo;return b.init(s),b}toJSON(s){s=typeof s=="object"?s:{};for(var b in this)this.hasOwnProperty(b)&&(s[b]=this[b]);if(s.Price=this.price,Array.isArray(this.supplyItems)){s.SupplyItems=[];for(let _ of this.supplyItems)s.SupplyItems.push(_.toJSON())}if(Array.isArray(this.supplyPackages)){s.SupplyPackages=[];for(let _ of this.supplyPackages)s.SupplyPackages.push(_.toJSON())}return s.OzonWarehouse=this.ozonWarehouse?this.ozonWarehouse.toJSON():void 0,s}}t.Supply=uo;class Ln{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){if(s){for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b]);if(this.quantity=s.Quantity,this.productPackage=s.ProductPackage?or.fromJS(s.ProductPackage):void 0,Array.isArray(s.SupplyItemPackages)){this.supplyItemPackages=[];for(let _ of s.SupplyItemPackages)this.supplyItemPackages.push(Vt.fromJS(_))}}}static fromJS(s){s=typeof s=="object"?s:{};let b=new Ln;return b.init(s),b}toJSON(s){s=typeof s=="object"?s:{};for(var b in this)this.hasOwnProperty(b)&&(s[b]=this[b]);if(s.Quantity=this.quantity,s.ProductPackage=this.productPackage?this.productPackage.toJSON():void 0,Array.isArray(this.supplyItemPackages)){s.SupplyItemPackages=[];for(let _ of this.supplyItemPackages)s.SupplyItemPackages.push(_.toJSON())}return s}}t.SupplyItem=Ln;class Vt{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){if(s){for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b]);this.iD=s.ID,this.amount=s.Amount,this.pricePerUom=s.PricePerUom,this.packageTypeID=s.PackageTypeID}}static fromJS(s){s=typeof s=="object"?s:{};let b=new Vt;return b.init(s),b}toJSON(s){s=typeof s=="object"?s:{};for(var b in this)this.hasOwnProperty(b)&&(s[b]=this[b]);return s.ID=this.iD,s.Amount=this.amount,s.PricePerUom=this.pricePerUom,s.PackageTypeID=this.packageTypeID,s}}t.ShipmentPackage=Vt;class li{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){if(s){for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b]);this.dateFrom=s.DateFrom?new Date(s.DateFrom.toString()):void 0,this.offset=s.Offset,this.count=s.Count}}static fromJS(s){s=typeof s=="object"?s:{};let b=new li;return b.init(s),b}toJSON(s){s=typeof s=="object"?s:{};for(var b in this)this.hasOwnProperty(b)&&(s[b]=this[b]);return s.DateFrom=this.dateFrom?_i(this.dateFrom):void 0,s.Offset=this.offset,s.Count=this.count,s}}t.FindShipmentsModel=li;class an{constructor(s){if(s)for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b])}init(s){if(s){for(var b in s)s.hasOwnProperty(b)&&(this[b]=s[b]);if(this.totalCount=s.TotalCount,Array.isArray(s.Items)){this.items=[];for(let _ of s.Items)this.items.push(xn.fromJS(_))}}}static fromJS(s){s=typeof s=="object"?s:{};let b=new an;return b.init(s),b}toJSON(s){s=typeof s=="object"?s:{};for(var b in this)this.hasOwnProperty(b)&&(s[b]=this[b]);if(s.TotalCount=this.totalCount,Array.isArray(this.items)){s.Items=[];for(let _ of this.items)s.Items.push(_.toJSON())}return s}}t.PagedResponseOfShipments=an;let va;(function(D){D.DRAFT="DRAFT",D.SUPPLY_VARIANTS_ARRANGING="SUPPLY_VARIANTS_ARRANGING",D.HAS_NO_SUPPLY_VARIANTS_ARCHIVE="HAS_NO_SUPPLY_VARIANTS_ARCHIVE",D.HAS_NO_SUPPLY_VARIANTS_NEW="HAS_NO_SUPPLY_VARIANTS_NEW",D.SUPPLY_VARIANT_CONFIRMATION="SUPPLY_VARIANT_CONFIRMATION",D.TIMESLOT_BOOKING="TIMESLOT_BOOKING",D.DATA_FILLING="DATA_FILLING",D.READY_TO_SUPPLY="READY_TO_SUPPLY",D.ACCEPTED_AT_SUPPLY_WAREHOUSE="ACCEPTED_AT_SUPPLY_WAREHOUSE",D.IN_TRANSIT="IN_TRANSIT",D.ACCEPTANCE_AT_STORAGE_WAREHOUSE="ACCEPTANCE_AT_STORAGE_WAREHOUSE",D.REPORTS_CONFIRMATION_AWAITING="REPORTS_CONFIRMATION_AWAITING",D.REPORT_REJECTED="REPORT_REJECTED",D.COMPLETED="COMPLETED",D.REJECTED_AT_SUPPLY_WAREHOUSE="REJECTED_AT_SUPPLY_WAREHOUSE",D.CANCELLED="CANCELLED",D.OVERDUE="OVERDUE"})(va=t.SupplyOrderState||(t.SupplyOrderState={}));function _i(D){return D.getFullYear()+"-"+(D.getMonth()<9?"0"+(D.getMonth()+1):D.getMonth()+1)+"-"+(D.getDate()<10?"0"+D.getDate():D.getDate())}class Nn extends Error{constructor(s,b,_,T,H){super(),this.isApiException=!0,this.message=s,this.status=b,this.response=_,this.headers=T,this.result=H}static isApiException(s){return s.isApiException===!0}}t.ApiException=Nn;function yt(D,s,b,_,T){return T!=null?xe(T):xe(new Nn(D,s,b,_,null))}function ze(D){return new ba(s=>{if(!D)s.next(""),s.complete();else{let b=new FileReader;b.onload=_=>{s.next(_.target.result),s.complete()},b.readAsText(D)}})}})(Dl||(Dl={}));var iF=Dl.PackageTypePrice,nF=()=>({"min-width":"75rem"}),oF=()=>[10,25,50],aF=()=>({width:"50vw"});function sF(t,r){t&1&&(d(0,"tr")(1,"th"),v(2,"\u041D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435"),u(),d(3,"th",6),v(4,"\u0415\u0434\u0438\u043D\u0438\u0446\u0430 \u0438\u0437\u043C\u0435\u0440\u0435\u043D\u0438\u044F "),Y(5,"p-sortIcon",7),u(),d(6,"th"),v(7,"\u041A\u0432\u0430\u043D\u0442"),u(),d(8,"th"),v(9,"\u0426\u0435\u043D\u044B"),u(),Y(10,"th"),u())}function lF(t,r){if(t&1&&(d(0,"div"),v(1),Ze(2,"date"),u()),t&2){let e=r.$implicit,n=h().$implicit,i=h(2);p(),Jo(" ",Et(2,3,e.date,"yyyy.MM.dd"),": ",e.price,"\u20BD/",i.getMeasureUnitText(n.unitOfMeasure)," ")}}function cF(t,r){if(t&1){let e=pe();d(0,"tr")(1,"td"),v(2),u(),d(3,"td"),v(4),u(),d(5,"td"),v(6),u(),d(7,"td"),P(8,lF,3,6,"div",8),u(),d(9,"td")(10,"p-button",9),ee("click",function(){let i=O(e).$implicit,o=h(2);return B(o.showEditPackageTypeDialog(i))}),u(),d(11,"p-button",10),ee("click",function(i){let o=O(e).$implicit,a=h(2);return B(a.confirmPackageTypeRemoval(i,o))}),u()()()}if(t&2){let e=r.$implicit,n=h(2);p(2),he(e.name),p(2),he(n.getMeasureUnitText(e.unitOfMeasure)),p(2),he(n.getQuantum(e)),p(2),g("ngForOf",e.prices)}}function uF(t,r){if(t&1&&(d(0,"p-table",5),P(1,sF,11,0,"ng-template",null,0,Z)(3,cF,12,4,"ng-template",null,1,Z),u()),t&2){let e=h();g("value",e.data)("tableStyle",Je(6,nF))("paginator",!0)("rows",50)("rowsPerPageOptions",Je(7,oF))("totalRecords",e.totalRecords)}}function dF(t,r){t&1&&(d(0,"tr")(1,"th"),v(2,"\u0414\u0430\u0442\u0430"),u(),d(3,"th"),v(4,"\u0426\u0435\u043D\u0430"),u(),Y(5,"th"),u())}function pF(t,r){if(t&1){let e=pe();d(0,"tr")(1,"td")(2,"p-datepicker",24),Fe("ngModelChange",function(i){let o=O(e).$implicit;return ke(o.date,i)||(o.date=i),B(i)}),u()(),d(3,"td")(4,"p-inputnumber",25),Fe("ngModelChange",function(i){let o=O(e).$implicit;return ke(o.price,i)||(o.price=i),B(i)}),u()(),d(5,"td")(6,"p-button",10),ee("click",function(){let i=O(e).$implicit,o=h(2);return B(o.removePrice(i))}),u()()()}if(t&2){let e=r.$implicit;p(2),Se("ngModel",e.date),g("readonlyInput",!0)("selectOtherMonths",!0)("showClear",!0),p(2),Se("ngModel",e.price),g("min",0)("minFractionDigits",2)("maxFractionDigits",2)("showButtons",!0)}}function fF(t,r){if(t&1){let e=pe();d(0,"button",26),ee("click",function(){O(e);let i=h(2);return B(i.addPackageType())}),v(1,"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C"),u()}}function mF(t,r){if(t&1){let e=pe();d(0,"button",26),ee("click",function(){O(e);let i=h(2);return B(i.updatePackageType())}),v(1,"\u041E\u0431\u043D\u043E\u0432\u0438\u0442\u044C"),u()}}function hF(t,r){if(t&1){let e=pe();d(0,"p-dialog",11),Fe("visibleChange",function(i){O(e);let o=h();return ke(o.showDialog,i)||(o.showDialog=i),B(i)}),d(1,"div")(2,"div",12)(3,"div",13)(4,"p-floatlabel",14)(5,"input",15),Fe("ngModelChange",function(i){O(e);let o=h();return ke(o.newItem.name,i)||(o.newItem.name=i),B(i)}),u(),d(6,"label",16),v(7,"\u041D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435"),u()()(),d(8,"div",13)(9,"p-floatlabel",14)(10,"p-inputnumber",17),Fe("ngModelChange",function(i){O(e);let o=h();return ke(o.newItem.decimalPlaces,i)||(o.newItem.decimalPlaces=i),B(i)}),u(),d(11,"label",16),v(12,"\u0422\u043E\u0447\u043D\u043E\u0441\u0442\u044C, \u0437\u043D\u0430\u043A\u043E\u0432 \u043F\u043E\u0441\u043B\u0435 \u0437\u0430\u043F\u044F\u0442\u043E\u0439"),u()()(),d(13,"div",13)(14,"p-floatlabel",14)(15,"p-select",18),Fe("ngModelChange",function(i){O(e);let o=h();return ke(o.newItem.unitOfMeasure,i)||(o.newItem.unitOfMeasure=i),B(i)}),u(),d(16,"label",16),v(17,"\u0415\u0434\u0438\u043D\u0438\u0446\u0430 \u0438\u0437\u043C\u0435\u0440\u0435\u043D\u0438\u044F"),u()()()(),d(18,"div",19)(19,"label",20),v(20,"\u0426\u0435\u043D\u044B"),u(),d(21,"p-table",21),P(22,dF,6,0,"ng-template",null,0,Z)(24,pF,7,9,"ng-template",null,1,Z),u(),d(26,"p-button",22),ee("click",function(){O(e);let i=h();return B(i.addPrice())}),u()()(),P(27,fF,2,0,"button",23)(28,mF,2,0,"button",23),u()}if(t&2){let e=h();Qt(Je(19,aF)),g("header",e.dialogTitle)("modal",!0),Se("visible",e.showDialog),g("draggable",!1)("resizable",!1),p(5),Se("ngModel",e.newItem.name),p(5),Se("ngModel",e.newItem.decimalPlaces),g("min",0)("max",5)("showButtons",!0),p(5),Se("ngModel",e.newItem.unitOfMeasure),g("options",e.measureUnits)("autoDisplayFirst",!1),p(6),g("value",e.newItem.prices)("editable",!0),p(6),g("ngIf",e.isAdding),p(),g("ngIf",!e.isAdding)}}var Um=(()=>{let r=class r{constructor(n,i,o,a){this.purchaseService=n,this.messageService=i,this.timeService=o,this.confirmationService=a,this.measureUnits=[{value:fe.UnitOfMeasure.Piece,name:"\u0448\u0442"},{value:fe.UnitOfMeasure.SquareMeter,name:"\u043C2"},{value:fe.UnitOfMeasure.Meter,name:"\u043C"}]}getMeasureUnitText(n){return this.measureUnits.find(i=>i.value==n)?.name??n.toString()}get data(){return this.purchaseService.getPackageTypes()}getQuantum(n){return Math.pow(10,-n.decimalPlaces)}showAddPackageTypeDialog(){this.isAdding=!0,this.dialogTitle="\u0414\u043E\u0431\u0430\u0432\u043B\u0435\u043D\u0438\u0435 \u0442\u0438\u043F\u0430 \u0443\u043F\u0430\u043A\u043E\u0432\u043A\u0438",this.newItem={decimalPlaces:0},this.showDialog=!0}showEditPackageTypeDialog(n){this.isAdding=!1,this.dialogTitle="\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u0435 \u0442\u0438\u043F\u0430 \u0443\u043F\u0430\u043A\u043E\u0432\u043A\u0438",this.newItem=n,this.showDialog=!0}removePackageType(n){this.purchaseService.removePackageType(n.iD).pipe(ge(i=>(this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430 \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u044F \u0442\u0438\u043F\u0430 \u0443\u043F\u0430\u043A\u043E\u0432\u043A\u0438",severity:"error",detail:i}),it))).subscribe()}addPackageType(){this.purchaseService.addPackageType(this.newItem).pipe(ge(n=>(this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430 \u0434\u043E\u0431\u0430\u0432\u043B\u0435\u043D\u0438\u044F \u0442\u0438\u043F\u0430 \u0443\u043F\u0430\u043A\u043E\u0432\u043A\u0438",severity:"error",detail:n}),it))).subscribe(()=>{this.showDialog=!1})}addPrice(){this.newItem.prices||(this.newItem.prices=[]);let n=new iF({packageTypeID:0,price:0,date:this.timeService.asUtc(new Date)});this.newItem.prices.push(n)}removePrice(n){this.newItem.prices=this.newItem.prices.filter(i=>i!==n)}updatePackageType(){for(let n of this.newItem.prices)n.date=new Date(Date.UTC(n.date.getFullYear(),n.date.getMonth(),n.date.getDate(),0,0,0));this.purchaseService.updatePackageType(this.newItem).pipe(ge(n=>(this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430 \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u044F \u0442\u0438\u043F\u0430 \u0443\u043F\u0430\u043A\u043E\u0432\u043A\u0438",severity:"error",detail:n}),it))).subscribe(()=>{this.showDialog=!1})}confirmPackageTypeRemoval(n,i){this.confirmationService.confirm({target:n.target,message:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0443\u043F\u0430\u043A\u043E\u0432\u043A\u0443?",header:"\u041F\u043E\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043D\u0438\u0435 \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u044F",icon:"pi pi-exclamation-triangle",acceptIcon:"none",rejectIcon:"none",rejectButtonStyleClass:"p-button-text",accept:()=>{this.removePackageType(i)}})}};r.\u0275fac=function(i){return new(i||r)(Pe(Fl),Pe(Yt),Pe(Aa),Pe(Ji))},r.\u0275cmp=He({type:r,selectors:[["app-package-type-list"]],features:[Dt([Ji])],decls:8,vars:2,consts:[["header",""],["body",""],[3,"click"],["dataKey","iD",3,"value","tableStyle","paginator","rows","rowsPerPageOptions","totalRecords",4,"ngIf"],[3,"header","modal","style","visible","draggable","resizable","visibleChange",4,"ngIf"],["dataKey","iD",3,"value","tableStyle","paginator","rows","rowsPerPageOptions","totalRecords"],["pSortableColumn","unitOfMeasure"],["field","unitOfMeasure"],[4,"ngFor","ngForOf"],["type","button","pRipple","","icon","pi pi-pencil",3,"click"],["icon","pi pi-trash","styleClass","p-button-danger",3,"click"],[3,"visibleChange","header","modal","visible","draggable","resizable"],[1,"grid","grid-cols-3","grid-rows-1","gap-4"],[1,"xs:grid-cols-12"],["variant","in"],["pInputText","","inputId","name",3,"ngModelChange","ngModel"],["for","name"],["inputId","decimalPlaces",3,"ngModelChange","ngModel","min","max","showButtons"],["appendTo","body","placeholder","\u0412\u044B\u0431\u0440\u0430\u0442\u044C \u0435\u0434\u0438\u043D\u0438\u0446\u0443 \u0438\u0437\u043C\u0435\u0440\u0435\u043D\u0438\u0439","inputId","unitOfMeasure","optionLabel","name","optionValue","value",3,"ngModelChange","ngModel","options","autoDisplayFirst"],[1,"flex-auto","m-4"],[1,"mb-2","block","font-bold"],[3,"value","editable"],["label","\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0446\u0435\u043D\u0443","icon","pi pi-plus",3,"click"],["pButton","",3,"click",4,"ngIf"],["appendTo","body","placeholder","\u0414\u0430\u0442\u0430 \u043D\u0430\u0447\u0430\u043B\u0430 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044F",3,"ngModelChange","ngModel","readonlyInput","selectOtherMonths","showClear"],[3,"ngModelChange","ngModel","min","minFractionDigits","maxFractionDigits","showButtons"],["pButton","",3,"click"]],template:function(i,o){i&1&&(Y(0,"p-toast")(1,"p-confirmDialog"),d(2,"h1"),v(3,"\u0423\u043F\u0430\u043A\u043E\u0432\u043A\u0430 \u0442\u043E\u0432\u0430\u0440\u043E\u0432"),u(),d(4,"p-button",2),ee("click",function(){return o.showAddPackageTypeDialog()}),v(5,"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C"),u(),P(6,uF,5,8,"p-table",3)(7,hF,29,20,"p-dialog",4)),i&2&&(p(6),g("ngIf",o.data),p(),g("ngIf",o.newItem))},dependencies:[nr,Ti,Ht,et,Mr,bt,Ma,ia,qn,Jn,Xn,Kn,Ro,bo,jr,Gn,Ur,Wr,Ii,Ei,wn,Yi,Ia,Ea,Kr,Gr,Zi,en,vr,xr,yn],encapsulation:2});let t=r;return t})();var gF=er.UpdateOzonProductModelItem,_F=()=>["name"],xF=()=>[25,50,100],vF=()=>({"min-width":"75rem"}),bF=()=>({"p-inputtext":!1});function yF(t,r){if(t&1){let e=pe();d(0,"button",17),ee("click",function(){O(e);let i=h(2);return B(i.clearIDFilter())}),u()}}function CF(t,r){if(t&1){let e=pe();d(0,"button",17),ee("click",function(){O(e);let i=h(2);return B(i.clearNameFilter())}),u()}}function wF(t,r){if(t&1){let e=pe();d(0,"tr"),Y(1,"th"),d(2,"th",7),v(3," ID "),Y(4,"p-sortIcon",8),u(),d(5,"th",9),v(6," \u041D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435 "),Y(7,"p-sortIcon",10),u(),d(8,"th"),v(9,"\u0418\u043D\u0434\u0435\u043A\u0441\u044B \u0446\u0435\u043D"),u(),d(10,"th"),v(11,"\u0413\u0435\u043E"),u(),d(12,"th"),v(13,"\u041A\u043E\u043C\u0438\u0441\u0441\u0438\u0438"),u(),Y(14,"th"),u(),d(15,"tr"),Y(16,"th"),d(17,"th")(18,"div",11)(19,"p-inputNumber",12),Ze(20,"async"),ee("ngModelChange",function(i){O(e);let o=h();return B(o.idFilterSubject.next(i))}),u(),P(21,yF,1,0,"button",13),Ze(22,"async"),u()(),d(23,"th")(24,"div",11)(25,"input",14),Ze(26,"async"),ee("ngModelChange",function(i){O(e);let o=h();return B(o.nameFilterSubject.next(i))}),u(),P(27,CF,1,0,"button",13),Ze(28,"async"),u()(),Y(29,"th")(30,"th"),d(31,"th")(32,"div",15)(33,"p-triStateCheckbox",16),Fe("ngModelChange",function(i){O(e);let o=h();return ke(o.priceIndexFilter,i)||(o.priceIndexFilter=i),B(i)}),u()()(),Y(34,"th"),u()}if(t&2){let e=h();p(19),g("ngClass",Je(16,bF))("ngModel",_r(20,8,e.idFilterSubject))("useGrouping",!1),p(2),g("ngIf",_r(22,10,e.idFilterSubject)),p(4),g("ngModel",_r(26,12,e.nameFilterSubject)),p(2),g("ngIf",_r(28,14,e.nameFilterSubject)),p(6),Se("ngModel",e.priceIndexFilter),g("label",e.priceIndexFilter==null?"\u0411\u0435\u0437 \u0444\u0438\u043B\u044C\u0442\u0440\u0430":e.priceIndexFilter?"\u0421 \u0438\u043D\u0434\u0435\u043A\u0441\u0430\u043C\u0438 \u0446\u0435\u043D":"\u0421 \u043F\u043B\u043E\u0445\u0438\u043C\u0438 \u0438\u043D\u0434\u0435\u043A\u0441\u0430\u043C\u0438 \u0446\u0435\u043D")}}function SF(t,r){if(t&1&&(d(0,"div",29)(1,"p-tag",30),v(2),u()()),t&2){let e=h().$implicit,n=h();p(),g("severity",n.getPriceIndexSeverity(e.externalCompetitorPriceIndexValue)),p(),Ie(" \u0412\u043D\u0435\u0448\u043D\u0438\u0439: ",e.externalCompetitorPriceIndexValue," ")}}function kF(t,r){if(t&1&&(d(0,"div",15)(1,"p-tag",31),v(2),u()()),t&2){let e=h().$implicit,n=h();p(),g("severity",n.getPriceIndexSeverity(e.externalPriceIndexValue)),p(),Ie("\u0412\u043D\u0435\u0448\u043D\u0438\u0439 \u0441\u0432\u043E\u0439: ",e.externalPriceIndexValue," ")}}function TF(t,r){if(t&1&&(d(0,"div",15)(1,"p-tag",31),v(2),u()()),t&2){let e=h().$implicit,n=h();p(),g("severity",n.getPriceIndexSeverity(e.ozonCompetitorPriceIndexValue)),p(),Ie(" \u041E\u0437\u043E\u043D: ",e.ozonCompetitorPriceIndexValue," ")}}function EF(t,r){t&1&&(d(0,"tr")(1,"th"),v(2,"\u0421\u0445\u0435\u043C\u0430"),u(),d(3,"th"),v(4,"\u041A\u043E\u043C\u0438\u0441\u0441\u0438\u044F, \u0432\u0430\u043B\u044E\u0442\u0430"),u(),d(5,"th"),v(6,"\u041A\u043E\u043C\u0438\u0441\u0441\u0438\u044F, %"),u(),d(7,"th"),v(8,"\u0414\u043E\u0441\u0442\u0430\u0432\u043A\u0430, \u0432\u0430\u043B\u044E\u0442\u0430"),u(),d(9,"th"),v(10,"\u0412\u043E\u0437\u0432\u0440\u0430\u0442, \u0432\u0430\u043B\u044E\u0442\u0430"),u()())}function IF(t,r){if(t&1&&(d(0,"tr")(1,"td"),v(2),u(),d(3,"td"),v(4),u(),d(5,"td"),v(6),u(),d(7,"td"),v(8),u(),d(9,"td"),v(10),u()()),t&2){let e=r.$implicit;p(2),he(e.schema),p(2),he(e.commissionCost),p(2),he(e.commissionPercent),p(2),he(e.deliveryCost),p(2),he(e.returnCost)}}function FF(t,r){if(t&1&&Y(0,"button",32),t&2){let e=h(),n=e.expanded,i=e.$implicit;g("icon",n?"pi pi-chevron-down":"pi pi-chevron-right")("pRowToggler",i)}}function AF(t,r){if(t&1){let e=pe();d(0,"tr")(1,"td")(2,"a",18),Y(3,"i",19),u(),d(4,"a",18),Y(5,"i",20),u()(),d(6,"td"),v(7),u(),d(8,"td"),v(9),u(),d(10,"td"),P(11,SF,3,2,"div",21)(12,kF,3,2,"div",22)(13,TF,3,2,"div",22),u(),d(14,"td")(15,"p-checkbox",23),Fe("ngModelChange",function(i){let o=O(e).$implicit;return ke(o.enableGeoTargeting,i)||(o.enableGeoTargeting=i),B(i)}),ee("ngModelChange",function(){let i=O(e).$implicit,o=h();return B(o.updateGeoTargetingFlag(i))}),u()(),d(16,"td",24)(17,"p-accordion")(18,"p-accordionTab",25)(19,"p-table",26),P(20,EF,11,0,"ng-template",null,0,Z)(22,IF,11,5,"ng-template",null,1,Z),u()()()(),d(24,"td")(25,"p-button",27),ee("click",function(i){let o=O(e).$implicit,a=h();return B(a.confirmProductRemoval(i,o))}),u(),P(26,FF,1,2,"button",28),u()()}if(t&2){let e=r.$implicit;p(2),g("href",Si("https://www.ozon.ru/product/",e.sku),Gt),p(2),g("href",Si("https://seller.ozon.ru/app/prices/control?search=",e.sku),Gt),p(3),he(e.productPackageID),p(2),he(e.name),p(2),g("ngIf",e.externalCompetitorPriceIndexValue),p(),g("ngIf",e.externalPriceIndexValue),p(),g("ngIf",e.ozonCompetitorPriceIndexValue),p(2),Se("ngModel",e.enableGeoTargeting),g("binary",!0),p(4),g("value",e.commissions),p(7),g("ngIf",e.stocks==null?null:e.stocks.length)}}function PF(t,r){t&1&&(d(0,"tr")(1,"th",35),v(2,"\u0421\u043A\u043B\u0430\u0434 "),Y(3,"p-sortIcon",36),u(),d(4,"th",37),v(5,"\u041A\u043B\u0430\u0441\u0442\u0435\u0440 "),Y(6,"p-sortIcon",38),u(),d(7,"th",39),v(8,"\u041D\u0430\u043B\u0438\u0447\u0438\u0435 "),Y(9,"p-sortIcon",40),u(),d(10,"th",41),v(11,"\u0420\u0435\u0437\u0435\u0440\u0432 "),Y(12,"p-sortIcon",42),u(),d(13,"th",43),v(14,"\u041D\u0430\u043B\u0438\u0447\u0438\u0435 (\u0443\u0446\u0435\u043D\u043A\u0430) "),Y(15,"p-sortIcon",44),u(),d(16,"th",45),v(17,"\u0420\u0435\u0437\u0435\u0440\u0432 (\u0443\u0446\u0435\u043D\u043A\u0430) "),Y(18,"p-sortIcon",46),u()())}function DF(t,r){if(t&1&&(Le(0),d(1,"p-tag",48),v(2),u(),Ne()),t&2){let e=h().$implicit;p(2),he(e.cutPricePresent)}}function OF(t,r){if(t&1&&(Le(0),v(1),Ne()),t&2){let e=h().$implicit;p(),he(e.cutPricePresent)}}function BF(t,r){if(t&1&&(Le(0),d(1,"p-tag",48),v(2),u(),Ne()),t&2){let e=h().$implicit;p(2),he(e.cutPriceReserved)}}function MF(t,r){if(t&1&&(Le(0),v(1),Ne()),t&2){let e=h().$implicit;p(),he(e.cutPriceReserved)}}function RF(t,r){if(t&1&&(d(0,"tr")(1,"td"),v(2),u(),d(3,"td"),v(4),u(),d(5,"td",47),v(6),u(),d(7,"td",47),v(8),u(),d(9,"td",47),P(10,DF,3,1,"ng-container",33)(11,OF,2,1,"ng-container",33),u(),d(12,"td",47),P(13,BF,3,1,"ng-container",33)(14,MF,2,1,"ng-container",33),u()()),t&2){let e=r.$implicit;p(2),he(e.warehouse.name),p(2),he(e.warehouse.warehouseCluster==null?null:e.warehouse.warehouseCluster.name),p(2),he(e.present),p(2),he(e.reserved),p(2),g("ngIf",e.cutPricePresent),p(),g("ngIf",!e.cutPricePresent),p(2),g("ngIf",e.cutPriceReserved),p(),g("ngIf",!e.cutPriceReserved)}}function LF(t,r){if(t&1&&(d(0,"tr")(1,"td",49),v(2,"\u0412\u0441\u0435\u0433\u043E:"),u(),d(3,"td",47),v(4),u(),d(5,"td",47),v(6),u(),d(7,"td",47),v(8),u(),d(9,"td",47),v(10),u()()),t&2){let e=h(2).$implicit;p(4),he(e.totalPresent),p(2),he(e.totalReserved),p(2),he(e.totalCutDownPresent),p(2),he(e.totalCutDownReserved)}}function NF(t,r){if(t&1&&(d(0,"tr")(1,"td",34)(2,"p-table",26),P(3,PF,19,0,"ng-template",null,0,Z)(5,RF,15,8,"ng-template",null,1,Z)(7,LF,11,4,"ng-template",null,3,Z),u()()()),t&2){let e=h().$implicit;p(2),g("value",e.stocks)}}function VF(t,r){if(t&1&&P(0,NF,9,1,"tr",33),t&2){let e=r.$implicit;g("ngIf",e.stocks==null?null:e.stocks.length)}}var Wm=(()=>{let r=class r extends ei{constructor(n,i,o,a,l,c){super(c),this.ozonProductClient=n,this.messageService=i,this.ozonProductCommandHandler=o,this.route=a,this.confirmationService=l,this.priceIndexFilter=null,this.filterModel={count:50,includeStocks:!0,offset:0},this.findModelSubject=new ur(null),this.idFilterSubject=new ur(null),this.nameFilterSubject=new ur(null)}ngOnInit(){this.titleService.setTitle("Ozon Products");let n=this.route.snapshot.paramMap.get("ids");n&&(this.ids=n.split(",").map(i=>+i)),this.idFilterSubject.pipe(wr(i=>!i||i>=100)).pipe(Ic(()=>Ec(500))).subscribe(()=>this.updateFilter()),this.nameFilterSubject.pipe(wr(i=>!i||i.length>2)).pipe(Ic(()=>Ec(500))).subscribe(()=>this.updateFilter()),this.findModelSubject.pipe(Yr(this.destroyed)).pipe(wr(i=>!!i&&i.count>0)).subscribe(i=>{this.findProducts(new fe.FindOzonProductsModel(i))})}findProducts(n){this.loading=!0,this.ozonProductClient.findOzonProducts(n).pipe(Yr(this.destroyed)).pipe(ge(i=>(this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430",severity:"error",detail:i}),this.loading=!1,it))).subscribe(i=>{this.loading=!1,i.items?.forEach(o=>{let a=0,l=0,c=0,f=0;o.stocks.forEach(k=>{a+=k.present,l+=k.reserved,f+=k.discountedPresent,c+=k.discountedReserved});let m=[o.externalCompetitorPriceIndexValue,o.externalPriceIndexValue,o.ozonCompetitorPriceIndexValue].filter(k=>k>0),C=Math.max(...m),y={totalPresent:a,totalReserved:l,totalCutDownPresent:f,totalCutDownReserved:c,hasPriceIndex:C>0,hasBadPriceIndex:C>1.01};Object.assign(o,y)}),this.data=i.items,this.totalRecords=i.totalCount})}confirmProductRemoval(n,i){this.confirmationService.confirm({target:n.target,message:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0442\u043E\u0432\u0430\u0440?",header:"\u041F\u043E\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043D\u0438\u0435 \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u044F",icon:"pi pi-exclamation-triangle",acceptIcon:"none",rejectIcon:"none",rejectButtonStyleClass:"p-button-text",accept:()=>{this.ozonProductCommandHandler.removeOzonProduct(i.productPackageID).pipe(ge(o=>(this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430 \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u044F \u0442\u043E\u0432\u0430\u0440\u0430",severity:"error",detail:o}),it))).subscribe(()=>{let o=this.data.indexOf(i);this.data.splice(o,1),this.messageService.add({summary:"\u0422\u043E\u0432\u0430\u0440 \u0443\u0434\u0430\u043B\u0451\u043D",severity:"success"})})}})}onDataLazyLoad(n){if(this.filterModel.offset=n.first,n.sortField){switch(n.sortField){case"name":this.filterModel.orderField=fe.FindOzonProductsModelSortField.ProductName;break;case"productPackageID":this.filterModel.orderField=fe.FindOzonProductsModelSortField.ProductPackageID;break}this.filterModel.orderAscending=n.sortOrder>0}this.updateFilter()}importProducts(){return ln(this,null,function*(){yield this.ozonProductCommandHandler.importOzonProducts().pipe(ge(n=>(this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430 \u0438\u043C\u043F\u043E\u0440\u0442\u0430 \u0442\u043E\u0432\u0430\u0440\u043E\u0432",severity:"error",detail:n}),it))).subscribe(()=>{this.messageService.add({summary:"\u0423\u0441\u043F\u0435\u0445",severity:"success",detail:"\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430 \u0442\u043E\u0432\u0430\u0440\u043E\u0432 \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043D\u0430"}),this.filterModel.offset=0,this.updateFilter()})})}updateStocks(){return ln(this,null,function*(){this.ozonProductCommandHandler.importOzonProductStocks().pipe(ge(n=>(this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430",severity:"error",detail:n}),it))).subscribe(()=>{this.messageService.add({summary:"\u0423\u0441\u043F\u0435\u0445",severity:"success",detail:"\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430 \u0441\u043A\u043B\u0430\u0434\u043E\u0432 \u041E\u0437\u043E\u043D \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043D\u0430"}),this.filterModel.offset=0,this.updateFilter()})})}getPriceIndexSeverity(n){let i;return n<=1.01?i="success":n<=1.05?i="warning":i="danger",i}updateFilter(){this.filterModel.iDs=this.ids,this.filterModel.hasBadPriceIndex=this.priceIndexFilter===!1,this.filterModel.hasAnyPriceIndex=this.priceIndexFilter,this.filterModel.productName=this.nameFilterSubject.value,this.filterModel.productPackageID=this.idFilterSubject.value,this.findModelSubject.next(this.filterModel)}clearIDFilter(){this.idFilterSubject.next(null)}clearNameFilter(){this.nameFilterSubject.next(null)}updateGeoTargetingFlag(n){this.ozonProductCommandHandler.updateOzonProducts([new gF({productPackageID:n.productPackageID,enableGeoTargeting:n.enableGeoTargeting})]).pipe(ge(i=>(this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430 \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u044F \u0442\u043E\u0432\u0430\u0440\u0430",severity:"error",detail:i}),it))).subscribe(()=>{this.messageService.add({summary:"\u041E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u0435 \u0442\u043E\u0432\u0430\u0440\u0430",severity:"success",detail:`\u041E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u0435 \u0442\u043E\u0432\u0430\u0440\u0430 ${n.productPackageID} \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043D\u043E`})})}};r.\u0275fac=function(i){return new(i||r)(Pe(fe.OzonProductClient),Pe(Yt),Pe(er.OzonProductClient),Pe(Sa),Pe(Ji),Pe(Zr))},r.\u0275cmp=He({type:r,selectors:[["app-ozon-product-list"]],features:[Dt([Ji]),lt],decls:12,vars:13,consts:[["header",""],["body",""],["expandedrow",""],["footer",""],["label","\u0418\u043C\u043F\u043E\u0440\u0442 \u0442\u043E\u0432\u0430\u0440\u043E\u0432","pButton","","pRipple","","type","button",1,"mb-2",3,"click"],["label","\u0418\u043C\u043F\u043E\u0440\u0442 \u043E\u0441\u0442\u0430\u0442\u043A\u043E\u0432","pButton","","pRipple","","type","button",1,"ml-1","mb-2",3,"click"],["dataKey","productPackageID",3,"onLazyLoad","globalFilterFields","lazy","loading","showGridlines","paginator","rowsPerPageOptions","rows","tableStyle","totalRecords","value"],["pSortableColumn","productPackageID","width","20%"],["field","productPackageID"],["pSortableColumn","name"],["field","name"],[1,"flex","flex-nowrap"],["pInputText","",3,"ngModelChange","ngClass","ngModel","useGrouping"],["icon","pi pi-trash","pButton","",3,"click",4,"ngIf"],["pInputText","","type","text",3,"ngModelChange","ngModel"],[1,"flex","whitespace-nowrap"],["inputId","priceIndexFilter",3,"ngModelChange","ngModel","label"],["icon","pi pi-trash","pButton","",3,"click"],["target","_blank",3,"href"],[1,"pi","ozon-fbo"],[1,"pi","ozon-seller"],["class","flex-nowrap",4,"ngIf"],["class","flex whitespace-nowrap",4,"ngIf"],[3,"ngModelChange","ngModel","binary"],["width","1%"],["header","\u041A\u043E\u043C\u0438\u0441\u0441\u0438\u0438"],[3,"value"],["icon","pi pi-trash","pRipple","","styleClass","p-button-danger","type","button",3,"click"],["class","p-button-text p-button-rounded p-button-plain","pButton","","pRipple","","type","button",3,"icon","pRowToggler",4,"ngIf"],[1,"flex-nowrap"],[1,"flex","whitespace-nowrap",3,"severity"],[3,"severity"],["pButton","","pRipple","","type","button",1,"p-button-text","p-button-rounded","p-button-plain",3,"icon","pRowToggler"],[4,"ngIf"],["colspan","7"],["pSortableColumn","warehouse.name"],["field","warehouse.name"],["pSortableColumn","warehouse.warehouseCluster.name"],["field","warehouse.warehouseCluster.name"],["pSortableColumn","present","width","10%"],["field","present"],["pSortableColumn","reserved","width","10%"],["field","reserved"],["pSortableColumn","cutPricePresent","width","10%"],["field","cutPricePresent"],["pSortableColumn","cutPriceReserved","width","10%"],["field","cutPriceReserved"],[1,"text-right"],["severity","danger"],["colspan","2",1,"text-right"]],template:function(i,o){if(i&1){let a=pe();Y(0,"p-toast")(1,"p-confirmDialog"),d(2,"p-card")(3,"button",4),ee("click",function(){return O(a),B(o.importProducts())}),u(),d(4,"button",5),ee("click",function(){return O(a),B(o.updateStocks())}),u(),d(5,"p-table",6),ee("onLazyLoad",function(c){return O(a),B(o.onDataLazyLoad(c))}),P(6,wF,35,17,"ng-template",null,0,Z)(8,AF,27,13,"ng-template",null,1,Z)(10,VF,1,1,"ng-template",null,2,Z),u()()}i&2&&(p(5),g("globalFilterFields",Je(10,_F))("lazy",!0)("loading",o.loading)("showGridlines",!0)("paginator",!0)("rowsPerPageOptions",Je(11,xF))("rows",o.filterModel.count)("tableStyle",Je(12,vF))("totalRecords",o.totalRecords)("value",o.data))},dependencies:[Il,No,nr,Ti,Ht,Yn,Qn,Po,On,et,Br,bt,Ma,ia,Xn,Ii,Ei,Kr,Gr,Zi,Fi,en,Oo,Do,vr,xr,Un],encapsulation:2});let t=r;return t})();var UF=()=>[10,50,100,250],WF=()=>({"min-width":"50rem"}),jF=t=>({"bg-orange-100":t});function HF(t,r){if(t&1){let e=pe();d(0,"h1"),v(1,"\u0410\u043A\u0446\u0438\u0438 Ozon"),u(),d(2,"div",9)(3,"button",10),ee("click",function(){O(e);let i=h(2);return B(i.togglePromotionExpansion())}),u(),d(4,"button",11),ee("click",function(){O(e);let i=h(2);return B(i.importOzonPromotions())}),u()(),d(5,"div",9)(6,"p-checkbox",12),ee("onChange",function(i){O(e);let o=h(2);return B(o.toggleDeletedFilter(i))}),Fe("ngModelChange",function(i){O(e);let o=h(2);return ke(o.filterModel.excludeDeleted,i)||(o.filterModel.excludeDeleted=i),B(i)}),u(),d(7,"label",13),v(8,"\u0418\u0441\u043A\u043B\u044E\u0447\u0438\u0442\u044C \u0430\u0440\u0445\u0438\u0432\u043D\u044B\u0435"),u()()}if(t&2){let e=h(2);p(3),g("label",e.expandedAll?"\u0421\u0432\u0435\u0440\u043D\u0443\u0442\u044C \u0430\u043A\u0446\u0438\u0438":"\u0420\u0430\u0437\u0432\u0435\u0440\u043D\u0443\u0442\u044C \u0430\u043A\u0446\u0438\u0438"),p(3),Se("ngModel",e.filterModel.excludeDeleted),g("binary",!0)}}function $F(t,r){if(t&1&&Y(0,"button",24),t&2){let e=h(),n=e.expanded,i=e.$implicit;g("icon",n?"pi pi-chevron-down":"pi pi-chevron-right")("pRowToggler",i)}}function GF(t,r){if(t&1&&(Le(0,22),v(1),Ne()),t&2){let e=h(2).$implicit;p(),Ie(" (\u0417\u0430\u043A\u0430\u0437 \u043E\u0442 ",e.orderAmount,"\u20BD) ")}}function KF(t,r){if(t&1&&(d(0,"div",22),v(1),P(2,GF,2,1,"ng-container",23),u()),t&2){let e=h().$implicit;p(),Ie(" \u0421\u043A\u0438\u0434\u043A\u0430: ",e.discountType==="CURRENCY"?e.discountValue+"\u20BD":e.discountType==="PERCENT"?e.discountValue+"%":e.discountType+" - "+e.discountValue," "),p(),g("ngIf",e.orderAmount)}}function XF(t,r){t&1&&(d(0,"div",22),Y(1,"i",25),v(2," \u041F\u0440\u043E\u043C\u043E\u043A\u043E\u0434 "),u())}function JF(t,r){if(t&1&&(d(0,"div",22),v(1," \u041D\u043E\u0432\u044B\u0445 \u0442\u043E\u0432\u0430\u0440\u043E\u0432: "),d(2,"p-tag",26),v(3),u()()),t&2){let e=h().$implicit;p(2),g("severity",e._activeProductCount?"danger":"success"),p(),Ie(" ",e._unconfirmedProductCount," ")}}function qF(t,r){if(t&1&&(d(0,"tr")(1,"td",14)(2,"div",15),P(3,$F,1,2,"button",16),u()(),d(4,"td")(5,"div",17)(6,"div",18)(7,"div",19)(8,"div")(9,"div",20)(10,"a",21),v(11),u()(),d(12,"div",22),v(13),u(),P(14,KF,3,2,"div",23)(15,XF,3,0,"div",23)(16,JF,4,2,"div",23),u()()()()()()),t&2){let e=r.$implicit;p(3),g("ngIf",e.products.length),p(7),g("href",Si("https://seller.ozon.ru/app/highlights/",e.iD),Gt),p(),Ie(" ",e.name," "),p(2),Ie(" \u0422\u0438\u043F: ",e.actionType," "),p(),g("ngIf",e.discountValue),p(),g("ngIf",e.isVoucherAction),p(),g("ngIf",e.products.length)}}function QF(t,r){if(t&1){let e=pe();d(0,"tr")(1,"th",29)(2,"div"),Y(3,"p-sortIcon",30),u(),d(4,"div",31)(5,"p-checkbox",32),ee("click",function(){O(e);let i=h().$implicit,o=h(2);return B(o.toggleCheckedProducts(i))}),Fe("ngModelChange",function(i){O(e);let o=h().$implicit;return ke(o.allChecked,i)||(o.allChecked=i),B(i)}),u()()(),d(6,"th",33),v(7,"\u0410\u0440\u0442\u0438\u043A\u0443\u043B "),Y(8,"p-sortIcon",34),u(),d(9,"th"),v(10,"\u041D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435"),u(),d(11,"th")(12,"div"),v(13,"\u0426\u0435\u043D\u0430 \u043F\u0440\u043E\u0434\u0430\u0436\u0438"),u(),d(14,"div",35),v(15,"\u041F\u043E\u043B\u043D\u0430\u044F \u0446\u0435\u043D\u0430"),u(),d(16,"div",35),v(17,"\u041C\u0438\u043D\u0438\u043C\u0430\u043B\u044C\u043D\u0430\u044F \u0446\u0435\u043D\u0430"),u()(),d(18,"th"),v(19," \u0426\u0435\u043D\u0430 \u043F\u043E \u0430\u043A\u0446\u0438\u0438 "),Y(20,"br"),d(21,"span",35),v(22,"\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430 \u043F\u043E \u0430\u043A\u0446\u0438\u0438"),u()(),d(23,"th"),v(24,"\u041C\u0438\u043D. \u0441\u0442\u043E\u043A"),u(),d(25,"th"),v(26,"\u0421\u0442\u043E\u043A"),u()()}if(t&2){let e=h().$implicit;p(5),Se("ngModel",e.allChecked),g("binary",!0)}}function YF(t,r){t&1&&(Le(0),d(1,"tr"),Y(2,"td",14),d(3,"td",37),Y(4,"p-skeleton",38),u(),Y(5,"td",27),u(),Ne())}function ZF(t,r){if(t&1){let e=pe();d(0,"input",42),Fe("ngModelChange",function(i){O(e);let o=h(2).$implicit;return ke(o.actionPrice,i)||(o.actionPrice=i),B(i)}),u(),d(1,"div",35),v(2),u()}if(t&2){let e=h(2).$implicit;Se("ngModel",e.actionPrice),p(2),he(e.maxActionPrice)}}function eA(t,r){if(t&1&&(Le(0),d(1,"p-tag",26)(2,"span",43),v(3),u()(),Ne()),t&2){let e=h(3).$implicit,n=h(3);p(),g("severity",n.getPriceSeverity(e)),p(2),he(e.actionPrice)}}function tA(t,r){t&1&&(Le(0),v(1,"-"),Ne())}function rA(t,r){if(t&1&&(P(0,eA,4,2,"ng-container",36)(1,tA,2,0,"ng-container",36),d(2,"div",35),v(3),u()),t&2){let e=h(2).$implicit;g("ngIf",!!e.actionPrice),p(),g("ngIf",!e.actionPrice),p(2),he(e.maxActionPrice)}}function iA(t,r){if(t&1){let e=pe();Le(0),d(1,"tr",39)(2,"td",14)(3,"div",40)(4,"p-checkbox",32),ee("click",function(){O(e);let i=h().$implicit,o=h().$implicit,a=h(2);return B(a.changeCandidateState(o,i))}),Fe("ngModelChange",function(i){O(e);let o=h().$implicit;return ke(o._active,i)||(o._active=i),B(i)}),u()()(),d(5,"td")(6,"a",21),v(7),u()(),d(8,"td"),v(9),u(),d(10,"td")(11,"div"),v(12),u(),d(13,"div",35),v(14),u(),d(15,"div",35),v(16),u()(),d(17,"td",41)(18,"p-cellEditor"),P(19,ZF,3,2,"ng-template",null,5,Z)(21,rA,4,3,"ng-template",null,6,Z),u()(),d(23,"td"),v(24),u(),d(25,"td"),v(26),u()(),Ne()}if(t&2){let e=h().$implicit;p(),g("ngClass",vt(13,jF,!e.isCandidate&&!e.confirmed)),p(3),Se("ngModel",e._active),g("binary",!0),p(2),g("href",Si("https://seller.ozon.ru/app/prices/manager/",e.ozonProduct.ozonProductID,"/prices"),Gt),p(),Ie(" ",e.ozonProduct.productPackageID," "),p(2),he(e.ozonProduct.name),p(3),he(e.ozonProduct.marketingPrice||"-"),p(2),he(e.ozonProduct.price||"-"),p(2),he(e.ozonProduct.minPrice||"-"),p(),g("pEditableColumn",e.actionPrice),p(7),he(e.stock),p(2),he(e.minStock)}}function nA(t,r){if(t&1&&P(0,YF,6,0,"ng-container",36)(1,iA,27,15,"ng-container",36),t&2){let e=r.$implicit;g("ngIf",!e.ozonProduct),p(),g("ngIf",e.ozonProduct)}}function oA(t,r){if(t&1){let e=pe();d(0,"button",44),ee("click",function(){O(e);let i=h().$implicit,o=h(2);return B(o.updatePromotionProducts(i))}),u()}}function aA(t,r){if(t&1&&(d(0,"tr")(1,"td",27)(2,"p-table",28),P(3,QF,27,2,"ng-template",null,3,Z)(5,nA,2,2,"ng-template",null,1,Z)(7,oA,1,0,"ng-template",null,4,Z),u()()()),t&2){let e=r.$implicit;p(2),g("sortOrder",-1)("value",e.products)}}function sA(t,r){if(t&1){let e=pe();d(0,"p-table",8),ee("onPage",function(i){O(e);let o=h();return B(o.pageChange(i))}),P(1,HF,9,3,"ng-template",null,0,Z)(3,qF,17,8,"ng-template",null,1,Z)(5,aA,9,2,"ng-template",null,2,Z),u()}if(t&2){let e=h();g("expandedRowKeys",e.expandedRowKeys)("loading",e.loading)("paginator",!0)("rowsPerPageOptions",Je(8,UF))("rows",e.filterModel.count)("tableStyle",Je(9,WF))("totalRecords",e.totalRecords)("value",e.data)}}var jm=(()=>{let r=class r extends ei{constructor(n,i,o,a,l,c){super(c),this.promotionReader=n,this.promotionWriter=i,this.messageService=o,this.ozonProductClient=a,this.dbService=l,this.loading=!1,this.expandedAll=!1,this.expandedRowKeys={},this.findModelSubject=new ur(null),this.cachedProducts=new Map}ngOnInit(){this.titleService.setTitle("\u0410\u043A\u0446\u0438\u0438 Ozon"),this.findModelSubject.pipe(wr(n=>!!n)).pipe(Yr(this.destroyed)).pipe(xi(n=>{let i=Object.assign({},n),o={id:r.FilterID,data:i};return this.dbService.update("filters",o).pipe(ge(a=>(this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430 \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u044F \u043D\u0430\u0441\u0442\u0440\u043E\u0435\u043A",severity:"error",detail:a}),it))).subscribe(),this.findOzonPromotions(n)})).subscribe(n=>{let i=n.items.reduce((o,a)=>(this.preparePromotion(a),a.products.forEach(l=>{this.cachedProducts.has(l.iD)||o.add(l.iD)}),o),new Set);this.data=n.items,i.size?this.loadOzonProducts(i):this.data.forEach(o=>this.setOzonProducts(o)),this.totalRecords=n.totalCount}),this.dbService.getByID("filters",r.FilterID).subscribe(n=>{let i={count:50,offset:0,excludeCandidates:!1,includeProduct:!0,excludeDeleted:!0};n?.data&&Object.assign(i,n.data),this.filterModel=new fe.FindOzonPromotionsModel(i),this.findModelSubject.next(this.filterModel)})}pageChange(n){(this.filterModel.count!=n.rows||this.filterModel.offset!=n.first)&&(this.filterModel.offset=n.first,this.findModelSubject.next(this.filterModel))}preparePromotion(n){Object.defineProperty(n,"_activeProductCount",{get:()=>n.products.filter(o=>!o.isCandidate).length});let i=0;return n.products.forEach(o=>{Object.defineProperty(o,"_active",{get:()=>!o.isCandidate,set:a=>o.isCandidate=!a}),i+=+(!o.confirmed&&!o.isCandidate)}),Object.assign(n,{_totalProductCount:n.products.length,_unconfirmedProductCount:i}),n}toggleDeletedFilter(){this.findModelSubject.next(this.filterModel)}changeCandidateState(n,i){if(!i.isCandidate&&!i.actionPrice){let o=i.ozonProduct;i.actionPrice=o.marketingPrice||o.price||o.minPrice}this.sortProducts(n),this.resetGroupCheckedState(n)}sortProducts(n){n.products.sort((i,o)=>{let a=i.ozonProduct,l=o.ozonProduct,c=this.getMinimalPrice(a),f=this.getMinimalPrice(l);return+i.isCandidate-+o.isCandidate||+i.confirmed-+o.confirmed||+(i.maxActionPrice!=null&&c!=null&&c<i.maxActionPrice)-+(o.maxActionPrice!=null&&f!=null&&f<o.maxActionPrice)||+(c==null)-+(f==null)||+(+c<i.maxActionPrice)-+(+f<o.maxActionPrice)})}getMinimalPrice(n){return n?.minPrice||n?.marketingPrice}getPriceSeverity(n){let i=this.getMinimalPrice(n.ozonProduct);return n.maxActionPrice<i?"danger":"success"}setOzonProducts(n){n.products.forEach(i=>{i.ozonProduct=this.cachedProducts.get(i.iD)}),this.sortProducts(n)}resetGroupCheckedState(n){let i=n;i.allChecked=!1,i.normalChecked=!1}toggleCheckedProducts(n){let i=n.allChecked;n.products.forEach(o=>{o.isCandidate=!i})}loadOzonProducts(n){this.ozonProductClient.findOzonProducts(new fe.FindOzonProductsModel({productIDs:[...n],includeStocks:!1,offset:0,count:1e5})).subscribe(i=>{i.items.forEach(o=>{o.ozonProductID&&this.cachedProducts.set(o.ozonProductID,o)}),this.data.forEach(o=>this.setOzonProducts(o))})}updatePromotionProducts(n){let i=n.products.filter(o=>!o.isCandidate);this.promotionWriter.updateOzonPromotionProducts(n.iD,i).pipe(ge(o=>(this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430",severity:"error",detail:o}),it))).subscribe(o=>{let a=!1;if(o.additionErrors)for(let c of Object.keys(o.additionErrors)){a=!0;let f=this.cachedProducts.get(+c);this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430",severity:"error",detail:`\u041E\u0448\u0438\u0431\u043A\u0430 \u0434\u043E\u0431\u0430\u0432\u043B\u0435\u043D\u0438\u044F \u0442\u043E\u0432\u0430\u0440\u0430 #${f.name} \u0432 \u0430\u043A\u0446\u0438\u044E: ${o.additionErrors[c]}`})}if(o.deletionErrors)for(let c of Object.keys(o.deletionErrors)){a=!0;let f=this.cachedProducts.get(+c);this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430",severity:"error",detail:`\u041E\u0448\u0438\u0431\u043A\u0430 \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u044F \u0442\u043E\u0432\u0430\u0440\u0430 #${f.name} \u0438\u0437 \u0430\u043A\u0446\u0438\u0438: ${o.additionErrors[c]}`})}a||this.messageService.add({summary:"\u0423\u0441\u043F\u0435\u0445",severity:"success",detail:"\u0421\u043F\u0438\u0441\u043E\u043A \u043F\u0440\u043E\u0434\u0443\u043A\u0442\u043E\u0432 \u0430\u043A\u0446\u0438\u0438 \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0438\u0437\u043C\u0435\u043D\u0451\u043D"});let l=this.data.findIndex(c=>c.iD==n.iD);this.data[l]=this.preparePromotion(n)})}togglePromotionExpansion(){this.expandedAll=!this.expandedAll,this.data.forEach(n=>{n.products.length&&(this.expandedRowKeys[n.iD]=this.expandedAll)})}findOzonPromotions(n){return this.promotionReader.findOzonPromotions(n).pipe(ge(i=>(this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430",severity:"error",detail:i}),it)))}importOzonPromotions(){return ln(this,null,function*(){this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430",severity:"error",detail:"\u041D\u0435 \u0440\u0435\u0430\u043B\u0438\u0437\u043E\u0432\u0430\u043D\u043E"})})}};r.FilterID="OzonPromotionListComponent",r.\u0275fac=function(i){return new(i||r)(Pe(fe.OzonPromotionClient),Pe(er.OzonPromotionClient),Pe(Yt),Pe(fe.OzonProductClient),Pe(Sn),Pe(Zr))},r.\u0275cmp=He({type:r,selectors:[["app-ozon-promotion-list"]],features:[lt],decls:2,vars:1,consts:[["caption",""],["body",""],["expandedrow",""],["header",""],["footer",""],["input",""],["output",""],["dataKey","iD",3,"expandedRowKeys","loading","paginator","rowsPerPageOptions","rows","tableStyle","totalRecords","value"],["dataKey","iD",3,"onPage","expandedRowKeys","loading","paginator","rowsPerPageOptions","rows","tableStyle","totalRecords","value"],[1,"flex","gap-4","p-2"],["pButton","","pRipple","","type","button",3,"click","label"],["label","\u0418\u043C\u043F\u043E\u0440\u0442 \u0430\u043A\u0446\u0438\u0439","pButton","","pRipple","","type","button",3,"click"],["inputId","deletedPromotionFilter",3,"onChange","ngModelChange","ngModel","binary"],["for","deletedPromotionFilter"],[2,"width","1%"],[1,"flex","items-center","justify-center","gap-2"],["class","p-button-text p-button-rounded p-button-plain","pButton","","pRipple","","type","button",3,"icon","pRowToggler",4,"ngIf"],[1,"flex","flex-col","sm:flex-row","sm:items-center"],[1,"flex","flex-col","md:flex-row","justify-between","md:items-center","flex-1"],[1,"flex","flex-row","md:flex-col","justify-between","items-start","gap-2"],[1,"text-lg","font-medium","font-bold","text-surface-900","dark:text-surface-0","mt-2"],["target","_blank",3,"href"],[1,"text-lg","font-medium","text-surface-900","dark:text-surface-0","mt-2"],["class","text-lg font-medium text-surface-900 dark:text-surface-0 mt-2",4,"ngIf"],["pButton","","pRipple","","type","button",1,"p-button-text","p-button-rounded","p-button-plain",3,"icon","pRowToggler"],[1,"pi","pi-barcode","text-blue-500"],[3,"severity"],["colspan","2"],["sortField","_active",3,"sortOrder","value"],["pSortableColumn","_active"],["field","_active"],[1,"p-2"],[3,"click","ngModelChange","ngModel","binary"],["pSortableColumn","ozonProduct.productPackageID"],["field","ozonProduct.productPackageID"],[1,"text-surface-500","dark:text-surface-300"],[4,"ngIf"],["colspan","4"],["height","4rem","width","100%"],[3,"ngClass"],[1,"gap-2","p-2"],["pEditableColumnField","product.actionPrice",1,"text-center",3,"pEditableColumn"],["pInputText","","type","number",3,"ngModelChange","ngModel"],[1,"text-white-500"],["label","\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C","pButton","","pRipple","","type","button",3,"click"]],template:function(i,o){i&1&&(ft(0,sA,7,10,"p-table",7),Y(1,"p-toast")),i&2&&mt(o.data&&o.filterModel?0:-1)},dependencies:[nr,Ti,Po,On,et,Br,bt,hl,ml,Kr,Gr,Zi,Fi,fl,Fa,en,Oo,Do,vr,xr],encapsulation:2});let t=r;return t})();var Fs={};Fs.version="0.20.3";var hn=1200,qa=1252,qt,lA=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],cA={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Nh=function(t){lA.indexOf(t)!=-1&&(qa=cA[0]=t)};function uA(){Nh(1252)}var As=function(t){hn=t,Nh(t)};function dA(){As(1200),uA()}function pA(t){for(var r=[],e=0;e<t.length>>1;++e)r[e]=String.fromCharCode(t.charCodeAt(2*e+1)+(t.charCodeAt(2*e)<<8));return r.join("")}var Ol=function(r){return String.fromCharCode(r)},Hm=function(r){return String.fromCharCode(r)};var ao=null,$m=!0,Oi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Wl(t){for(var r="",e=0,n=0,i=0,o=0,a=0,l=0,c=0,f=0;f<t.length;)e=t.charCodeAt(f++),o=e>>2,n=t.charCodeAt(f++),a=(e&3)<<4|n>>4,i=t.charCodeAt(f++),l=(n&15)<<2|i>>6,c=i&63,isNaN(n)?l=c=64:isNaN(i)&&(c=64),r+=Oi.charAt(o)+Oi.charAt(a)+Oi.charAt(l)+Oi.charAt(c);return r}function fA(t){for(var r="",e=0,n=0,i=0,o=0,a=0,l=0,c=0,f=0;f<t.length;)e=t.charCodeAt(f++),e>255&&(e=95),o=e>>2,n=t.charCodeAt(f++),n>255&&(n=95),a=(e&3)<<4|n>>4,i=t.charCodeAt(f++),i>255&&(i=95),l=(n&15)<<2|i>>6,c=i&63,isNaN(n)?l=c=64:isNaN(i)&&(c=64),r+=Oi.charAt(o)+Oi.charAt(a)+Oi.charAt(l)+Oi.charAt(c);return r}function mA(t){for(var r="",e=0,n=0,i=0,o=0,a=0,l=0,c=0,f=0;f<t.length;)e=t[f++],o=e>>2,n=t[f++],a=(e&3)<<4|n>>4,i=t[f++],l=(n&15)<<2|i>>6,c=i&63,isNaN(n)?l=c=64:isNaN(i)&&(c=64),r+=Oi.charAt(o)+Oi.charAt(a)+Oi.charAt(l)+Oi.charAt(c);return r}function zo(t){var r="",e=0,n=0,i=0,o=0,a=0,l=0,c=0;if(t.slice(0,5)=="data:"){var f=t.slice(0,1024).indexOf(";base64,");f>-1&&(t=t.slice(f+8))}t=t.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<t.length;)o=Oi.indexOf(t.charAt(f++)),a=Oi.indexOf(t.charAt(f++)),e=o<<2|a>>4,r+=String.fromCharCode(e),l=Oi.indexOf(t.charAt(f++)),n=(a&15)<<4|l>>2,l!==64&&(r+=String.fromCharCode(n)),c=Oi.indexOf(t.charAt(f++)),i=(l&3)<<6|c,c!==64&&(r+=String.fromCharCode(i));return r}var rr=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),co=(function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(r,e){return e?new Buffer(r,e):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}})(),Ps=(function(){if(typeof Buffer>"u")return!1;var t=co([65,0]);if(!t)return!1;var r=t.toString("utf16le");return r.length==1})();function ua(t){return rr?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function Gm(t){return rr?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var fn=function(r){return rr?co(r,"binary"):r.split("").map(function(e){return e.charCodeAt(0)&255})};function oc(t){if(typeof ArrayBuffer>"u")return fn(t);for(var r=new ArrayBuffer(t.length),e=new Uint8Array(r),n=0;n!=t.length;++n)e[n]=t.charCodeAt(n)&255;return r}function da(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var r=[],e=0;e<t.length;++e)r[e]=String.fromCharCode(t[e]);return r.join("")}function hA(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}var ii=rr?function(t){return Buffer.concat(t.map(function(r){return Buffer.isBuffer(r)?r:co(r)}))}:function(t){if(typeof Uint8Array<"u"){var r=0,e=0;for(r=0;r<t.length;++r)e+=t[r].length;var n=new Uint8Array(e),i=0;for(r=0,e=0;r<t.length;e+=i,++r)i=t[r].length,t[r]instanceof Uint8Array?n.set(t[r],e):typeof t[r]=="string"?n.set(new Uint8Array(fn(t[r])),e):n.set(new Uint8Array(t[r]),e);return n}return[].concat.apply([],t.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function gA(t){for(var r=[],e=0,n=t.length+250,i=ua(t.length+255),o=0;o<t.length;++o){var a=t.charCodeAt(o);if(a<128)i[e++]=a;else if(a<2048)i[e++]=192|a>>6&31,i[e++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var l=t.charCodeAt(++o)&1023;i[e++]=240|a>>8&7,i[e++]=128|a>>2&63,i[e++]=128|l>>6&15|(a&3)<<4,i[e++]=128|l&63}else i[e++]=224|a>>12&15,i[e++]=128|a>>6&63,i[e++]=128|a&63;e>n&&(r.push(i.slice(0,e)),e=0,i=ua(65535),n=65530)}return r.push(i.slice(0,e)),ii(r)}var Wa=/\u0000/g,Bl=/[\u0001-\u0006]/g;function ja(t){for(var r="",e=t.length-1;e>=0;)r+=t.charAt(e--);return r}function Mn(t,r){var e=""+t;return e.length>=r?e:Lr("0",r-e.length)+e}function O0(t,r){var e=""+t;return e.length>=r?e:Lr(" ",r-e.length)+e}function jl(t,r){var e=""+t;return e.length>=r?e:e+Lr(" ",r-e.length)}function _A(t,r){var e=""+Math.round(t);return e.length>=r?e:Lr("0",r-e.length)+e}function xA(t,r){var e=""+t;return e.length>=r?e:Lr("0",r-e.length)+e}var Km=Math.pow(2,32);function Va(t,r){if(t>Km||t<-Km)return _A(t,r);var e=Math.round(t);return xA(e,r)}function Hl(t,r){return r=r||0,t.length>=7+r&&(t.charCodeAt(r)|32)===103&&(t.charCodeAt(r+1)|32)===101&&(t.charCodeAt(r+2)|32)===110&&(t.charCodeAt(r+3)|32)===101&&(t.charCodeAt(r+4)|32)===114&&(t.charCodeAt(r+5)|32)===97&&(t.charCodeAt(r+6)|32)===108}var Xm=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],p0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function vA(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "',t}var Ir={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'},Jm={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},bA={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function $l(t,r,e){for(var n=t<0?-1:1,i=t*n,o=0,a=1,l=0,c=1,f=0,m=0,C=Math.floor(i);f<r&&(C=Math.floor(i),l=C*a+o,m=C*f+c,!(i-C<5e-8));)i=1/(i-C),o=a,a=l,c=f,f=m;if(m>r&&(f>r?(m=c,l=o):(m=f,l=a)),!e)return[0,n*l,m];var y=Math.floor(n*l/m);return[y,n*l-y*m,m]}function yA(t){var r=t.toPrecision(16);if(r.indexOf("e")>-1){var e=r.slice(0,r.indexOf("e"));return e=e.indexOf(".")>-1?e.slice(0,e.slice(0,2)=="0."?17:16):e.slice(0,15)+Lr("0",e.length-15),e+r.slice(r.indexOf("e"))}var n=r.indexOf(".")>-1?r.slice(0,r.slice(0,2)=="0."?17:16):r.slice(0,15)+Lr("0",r.length-15);return Number(n)}function za(t,r,e){if(t>2958465||t<0)return null;t=yA(t);var n=t|0,i=Math.floor(86400*(t-n)),o=0,a=[],l={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),r&&r.date1904&&(n+=1462),l.u>.9999&&(l.u=0,++i==86400&&(l.T=i=0,++n,++l.D)),n===60)a=e?[1317,10,29]:[1900,2,29],o=3;else if(n===0)a=e?[1317,8,29]:[1900,1,0],o=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),a=[c.getFullYear(),c.getMonth()+1,c.getDate()],o=c.getDay(),n<60&&(o=(o+6)%7),e&&(o=TA(c,a))}return l.y=a[0],l.m=a[1],l.d=a[2],l.S=i%60,i=Math.floor(i/60),l.M=i%60,i=Math.floor(i/60),l.H=i,l.q=o,l}function B0(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function CA(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function wA(t){var r=t<0?12:11,e=B0(t.toFixed(12));return e.length<=r||(e=t.toPrecision(10),e.length<=r)?e:t.toExponential(5)}function SA(t){var r=B0(t.toFixed(11));return r.length>(t<0?12:11)||r==="0"||r==="-0"?t.toPrecision(6):r}function kA(t){if(!isFinite(t))return isNaN(t)?"#NUM!":"#DIV/0!";var r=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),e;return r>=-4&&r<=-1?e=t.toPrecision(10+r):Math.abs(r)<=9?e=wA(t):r===10?e=t.toFixed(10).substr(0,12):e=SA(t),B0(CA(e.toUpperCase()))}function T0(t,r){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):kA(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return To(14,Ci(t,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+t)}function TA(t,r){r[0]-=581;var e=t.getDay();return t<60&&(e=(e+6)%7),e}function EA(t,r,e,n){var i="",o=0,a=0,l=e.y,c,f=0;switch(t){case 98:l=e.y+543;case 121:switch(r.length){case 1:case 2:c=l%100,f=2;break;default:c=l%1e4,f=4;break}break;case 109:switch(r.length){case 1:case 2:c=e.m,f=r.length;break;case 3:return p0[e.m-1][1];case 5:return p0[e.m-1][0];default:return p0[e.m-1][2]}break;case 100:switch(r.length){case 1:case 2:c=e.d,f=r.length;break;case 3:return Xm[e.q][0];default:return Xm[e.q][1]}break;case 104:switch(r.length){case 1:case 2:c=1+(e.H+11)%12,f=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:c=e.H,f=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:c=e.M,f=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return e.u===0&&(r=="s"||r=="ss")?Mn(e.S,r.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,o=Math.round(a*(e.S+e.u)),o>=60*a&&(o=0),r==="s"?o===0?"0":""+o/a:(i=Mn(o,2+n),r==="ss"?i.substr(0,2):"."+i.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":c=e.D*24+e.H;break;case"[m]":case"[mm]":c=(e.D*24+e.H)*60+e.M;break;case"[s]":case"[ss]":c=((e.D*24+e.H)*60+e.M)*60+(n==0?Math.round(e.S+e.u):e.S);break;default:throw"bad abstime format: "+r}f=r.length===3?1:2;break;case 101:c=l,f=1;break}var m=f>0?Mn(c,f):"";return m}function Vo(t){var r=3;if(t.length<=r)return t;for(var e=t.length%r,n=t.substr(0,e);e!=t.length;e+=r)n+=(n.length>0?",":"")+t.substr(e,r);return n}var Vh=/%/g;function IA(t,r,e){var n=r.replace(Vh,""),i=r.length-n.length;return wo(t,n,e*Math.pow(10,2*i))+Lr("%",i)}function FA(t,r,e){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return wo(t,r.substr(0,n),e/Math.pow(10,3*(r.length-n)))}function zh(t,r){var e,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+zh(t,-r);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var o=Math.floor(Math.log(r)*Math.LOG10E)%i;if(o<0&&(o+=i),e=(r/Math.pow(10,o)).toPrecision(n+1+(i+o)%i),e.indexOf("e")===-1){var a=Math.floor(Math.log(r)*Math.LOG10E);for(e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(a-e.length+o):e+="E+"+(a-o);e.substr(0,2)==="0.";)e=e.charAt(0)+e.substr(2,i)+"."+e.substr(2+i),e=e.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,f,m){return c+f+m.substr(0,(i+o)%i)+"."+m.substr(o)+"E"})}else e=r.toExponential(n);return t.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),t.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}var Uh=/# (\?+)( ?)\/( ?)(\d+)/;function AA(t,r,e){var n=parseInt(t[4],10),i=Math.round(r*n),o=Math.floor(i/n),a=i-o*n,l=n;return e+(o===0?"":""+o)+" "+(a===0?Lr(" ",t[1].length+1+t[4].length):O0(a,t[1].length)+t[2]+"/"+t[3]+Mn(l,t[4].length))}function PA(t,r,e){return e+(r===0?"":""+r)+Lr(" ",t[1].length+2+t[4].length)}var Wh=/^#*0*\.([0#]+)/,jh=/\)[^)]*[0#]/,Hh=/\(###\) ###\\?-####/;function Wi(t){for(var r="",e,n=0;n!=t.length;++n)switch(e=t.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(e)}return r}function qm(t,r){var e=Math.pow(10,r);return""+Math.round(t*e)/e}function Qm(t,r){var e=t-Math.floor(t),n=Math.pow(10,r);return r<(""+Math.round(e*n)).length?0:Math.round(e*n)}function DA(t,r){return r<(""+Math.round((t-Math.floor(t))*Math.pow(10,r))).length?1:0}function OA(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function En(t,r,e){if(t.charCodeAt(0)===40&&!r.match(jh)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?En("n",n,e):"("+En("n",n,-e)+")"}if(r.charCodeAt(r.length-1)===44)return FA(t,r,e);if(r.indexOf("%")!==-1)return IA(t,r,e);if(r.indexOf("E")!==-1)return zh(r,e);if(r.charCodeAt(0)===36)return"$"+En(t,r.substr(r.charAt(1)==" "?2:1),e);var i,o,a,l,c=Math.abs(e),f=e<0?"-":"";if(r.match(/^00+$/))return f+Va(c,r.length);if(r.match(/^[#?]+$/))return i=Va(e,0),i==="0"&&(i=""),i.length>r.length?i:Wi(r.substr(0,r.length-i.length))+i;if(o=r.match(Uh))return AA(o,c,f);if(r.match(/^#+0+$/))return f+Va(c,r.length-r.indexOf("0"));if(o=r.match(Wh))return i=qm(e,o[1].length).replace(/^([^\.]+)$/,"$1."+Wi(o[1])).replace(/\.$/,"."+Wi(o[1])).replace(/\.(\d*)$/,function(S,M){return"."+M+Lr("0",Wi(o[1]).length-M.length)}),r.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),o=r.match(/^(0*)\.(#*)$/))return f+qm(c,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=r.match(/^#{1,3},##0(\.?)$/))return f+Vo(Va(c,0));if(o=r.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+En(t,r,-e):Vo(""+(Math.floor(e)+DA(e,o[1].length)))+"."+Mn(Qm(e,o[1].length),o[1].length);if(o=r.match(/^#,#*,#0/))return En(t,r.replace(/^#,#*,/,""),e);if(o=r.match(/^([0#]+)(\\?-([0#]+))+$/))return i=ja(En(t,r.replace(/[\\-]/g,""),e)),a=0,ja(ja(r.replace(/\\/g,"")).replace(/[0#]/g,function(S){return a<i.length?i.charAt(a++):S==="0"?"0":""}));if(r.match(Hh))return i=En(t,"##########",e),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var m="";if(o=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(o[4].length,7),l=$l(c,Math.pow(10,a)-1,!1),i=""+f,m=wo("n",o[1],l[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),i+=m+o[2]+"/"+o[3],m=jl(l[2],a),m.length<o[4].length&&(m=Wi(o[4].substr(o[4].length-m.length))+m),i+=m,i;if(o=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(o[1].length,o[4].length),7),l=$l(c,Math.pow(10,a)-1,!0),f+(l[0]||(l[1]?"":"0"))+" "+(l[1]?O0(l[1],a)+o[2]+"/"+o[3]+jl(l[2],a):Lr(" ",2*a+1+o[2].length+o[3].length));if(o=r.match(/^[#0?]+$/))return i=Va(e,0),r.length<=i.length?i:Wi(r.substr(0,r.length-i.length))+i;if(o=r.match(/^([#0?]+)\.([#0]+)$/)){i=""+e.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var C=r.indexOf(".")-a,y=r.length-i.length-C;return Wi(r.substr(0,C)+i+r.substr(r.length-y))}if(o=r.match(/^00,000\.([#0]*0)$/))return a=Qm(e,o[1].length),e<0?"-"+En(t,r,-e):Vo(OA(e)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(S){return"00,"+(S.length<3?Mn(0,3-S.length):"")+S})+"."+Mn(a,o[1].length);switch(r){case"###,##0.00":return En(t,"#,##0.00",e);case"###,###":case"##,###":case"#,###":var k=Vo(Va(c,0));return k!=="0"?f+k:"";case"###,###.00":return En(t,"###,##0.00",e).replace(/^0\./,".");case"#,###.00":return En(t,"#,##0.00",e).replace(/^0\./,".");default:}throw new Error("unsupported format |"+r+"|")}function BA(t,r,e){for(var n=r.length-1;r.charCodeAt(n-1)===44;)--n;return wo(t,r.substr(0,n),e/Math.pow(10,3*(r.length-n)))}function MA(t,r,e){var n=r.replace(Vh,""),i=r.length-n.length;return wo(t,n,e*Math.pow(10,2*i))+Lr("%",i)}function $h(t,r){var e,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+$h(t,-r);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var o=Math.floor(Math.log(r)*Math.LOG10E)%i;if(o<0&&(o+=i),e=(r/Math.pow(10,o)).toPrecision(n+1+(i+o)%i),!e.match(/[Ee]/)){var a=Math.floor(Math.log(r)*Math.LOG10E);e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(a-e.length+o):e+="E+"+(a-o),e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,f,m){return c+f+m.substr(0,(i+o)%i)+"."+m.substr(o)+"E"})}else e=r.toExponential(n);return t.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),t.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}function ro(t,r,e){if(t.charCodeAt(0)===40&&!r.match(jh)){var n=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?ro("n",n,e):"("+ro("n",n,-e)+")"}if(r.charCodeAt(r.length-1)===44)return BA(t,r,e);if(r.indexOf("%")!==-1)return MA(t,r,e);if(r.indexOf("E")!==-1)return $h(r,e);if(r.charCodeAt(0)===36)return"$"+ro(t,r.substr(r.charAt(1)==" "?2:1),e);var i,o,a,l,c=Math.abs(e),f=e<0?"-":"";if(r.match(/^00+$/))return f+Mn(c,r.length);if(r.match(/^[#?]+$/))return i=""+e,e===0&&(i=""),i.length>r.length?i:Wi(r.substr(0,r.length-i.length))+i;if(o=r.match(Uh))return PA(o,c,f);if(r.match(/^#+0+$/))return f+Mn(c,r.length-r.indexOf("0"));if(o=r.match(Wh))return i=(""+e).replace(/^([^\.]+)$/,"$1."+Wi(o[1])).replace(/\.$/,"."+Wi(o[1])),i=i.replace(/\.(\d*)$/,function(S,M){return"."+M+Lr("0",Wi(o[1]).length-M.length)}),r.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),o=r.match(/^(0*)\.(#*)$/))return f+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=r.match(/^#{1,3},##0(\.?)$/))return f+Vo(""+c);if(o=r.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+ro(t,r,-e):Vo(""+e)+"."+Lr("0",o[1].length);if(o=r.match(/^#,#*,#0/))return ro(t,r.replace(/^#,#*,/,""),e);if(o=r.match(/^([0#]+)(\\?-([0#]+))+$/))return i=ja(ro(t,r.replace(/[\\-]/g,""),e)),a=0,ja(ja(r.replace(/\\/g,"")).replace(/[0#]/g,function(S){return a<i.length?i.charAt(a++):S==="0"?"0":""}));if(r.match(Hh))return i=ro(t,"##########",e),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var m="";if(o=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(o[4].length,7),l=$l(c,Math.pow(10,a)-1,!1),i=""+f,m=wo("n",o[1],l[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),i+=m+o[2]+"/"+o[3],m=jl(l[2],a),m.length<o[4].length&&(m=Wi(o[4].substr(o[4].length-m.length))+m),i+=m,i;if(o=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(o[1].length,o[4].length),7),l=$l(c,Math.pow(10,a)-1,!0),f+(l[0]||(l[1]?"":"0"))+" "+(l[1]?O0(l[1],a)+o[2]+"/"+o[3]+jl(l[2],a):Lr(" ",2*a+1+o[2].length+o[3].length));if(o=r.match(/^[#0?]+$/))return i=""+e,r.length<=i.length?i:Wi(r.substr(0,r.length-i.length))+i;if(o=r.match(/^([#0]+)\.([#0]+)$/)){i=""+e.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var C=r.indexOf(".")-a,y=r.length-i.length-C;return Wi(r.substr(0,C)+i+r.substr(r.length-y))}if(o=r.match(/^00,000\.([#0]*0)$/))return e<0?"-"+ro(t,r,-e):Vo(""+e).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(S){return"00,"+(S.length<3?Mn(0,3-S.length):"")+S})+"."+Mn(0,o[1].length);switch(r){case"###,###":case"##,###":case"#,###":var k=Vo(""+c);return k!=="0"?f+k:"";default:if(r.match(/\.[0#?]*$/))return ro(t,r.slice(0,r.lastIndexOf(".")),e)+Wi(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function wo(t,r,e){return(e|0)===e?ro(t,r,e):En(t,r,e)}function RA(t){for(var r=[],e=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:e=!e;break;case 95:case 42:case 92:++n;break;case 59:r[r.length]=t.substr(i,n-i),i=n+1}if(r[r.length]=t.substr(i),e===!0)throw new Error("Format |"+t+"| unterminated string ");return r}var Gh=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function pa(t){for(var r=0,e="",n="";r<t.length;)switch(e=t.charAt(r)){case"G":Hl(t,r)&&(r+=6),r++;break;case'"':for(;t.charCodeAt(++r)!==34&&r<t.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(t.charAt(r+1)==="1"||t.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(t.substr(r,3).toUpperCase()==="A/P"||t.substr(r,5).toUpperCase()==="AM/PM"||t.substr(r,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++r;break;case"[":for(n=e;t.charAt(r++)!=="]"&&r<t.length;)n+=t.charAt(r);if(n.match(Gh))return!0;break;case".":case"0":case"#":for(;r<t.length&&("0#?.,E+-%".indexOf(e=t.charAt(++r))>-1||e=="\\"&&t.charAt(r+1)=="-"&&"0#".indexOf(t.charAt(r+2))>-1););break;case"?":for(;t.charAt(++r)===e;);break;case"*":++r,(t.charAt(r)==" "||t.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<t.length&&"0123456789".indexOf(t.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function LA(t,r,e,n){for(var i=[],o="",a=0,l="",c="t",f,m,C,y="H";a<t.length;)switch(l=t.charAt(a)){case"G":if(!Hl(t,a))throw new Error("unrecognized character "+l+" in "+t);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(o="";(C=t.charCodeAt(++a))!==34&&a<t.length;)o+=String.fromCharCode(C);i[i.length]={t:"t",v:o},++a;break;case"\\":var k=t.charAt(++a),S=k==="("||k===")"?k:"t";i[i.length]={t:S,v:k},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:r},++a;break;case"B":case"b":if(t.charAt(a+1)==="1"||t.charAt(a+1)==="2"){if(f==null&&(f=za(r,e,t.charAt(a+1)==="2"),f==null))return"";i[i.length]={t:"X",v:t.substr(a,2)},c=l,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||f==null&&(f=za(r,e),f==null))return"";for(o=l;++a<t.length&&t.charAt(a).toLowerCase()===l;)o+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=y),i[i.length]={t:l,v:o},c=l;break;case"A":case"a":case"\u4E0A":var M={t:l,v:l};if(f==null&&(f=za(r,e)),t.substr(a,3).toUpperCase()==="A/P"?(f!=null&&(M.v=f.H>=12?t.charAt(a+2):l),M.t="T",y="h",a+=3):t.substr(a,5).toUpperCase()==="AM/PM"?(f!=null&&(M.v=f.H>=12?"PM":"AM"),M.t="T",a+=5,y="h"):t.substr(a,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(f!=null&&(M.v=f.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),M.t="T",a+=5,y="h"):(M.t="t",++a),f==null&&M.t==="T")return"";i[i.length]=M,c=l;break;case"[":for(o=l;t.charAt(a++)!=="]"&&a<t.length;)o+=t.charAt(a);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(Gh)){if(f==null&&(f=za(r,e),f==null))return"";i[i.length]={t:"Z",v:o.toLowerCase()},c=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",pa(t)||(i[i.length]={t:"t",v:o}));break;case".":if(f!=null){for(o=l;++a<t.length&&(l=t.charAt(a))==="0";)o+=l;i[i.length]={t:"s",v:o};break}case"0":case"#":for(o=l;++a<t.length&&"0#?.,E+-%".indexOf(l=t.charAt(a))>-1;)o+=l;i[i.length]={t:"n",v:o};break;case"?":for(o=l;t.charAt(++a)===l;)o+=l;i[i.length]={t:l,v:o},c=l;break;case"*":++a,(t.charAt(a)==" "||t.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":l,v:l},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=l;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;)o+=t.charAt(a);i[i.length]={t:"D",v:o};break;case" ":i[i.length]={t:l,v:l},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+t);i[i.length]={t:"t",v:l},++a;break}var E=0,A=0,x;for(a=i.length-1,c="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=y,c="h",E<1&&(E=1);break;case"s":(x=i[a].v.match(/\.0+$/))&&(A=Math.max(A,x[0].length-1),E=4),E<3&&(E=3);case"d":case"y":case"e":c=i[a].t;break;case"M":c=i[a].t,E<2&&(E=2);break;case"m":c==="s"&&(i[a].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&i[a].v.match(/[Hh]/)&&(E=1),E<2&&i[a].v.match(/[Mm]/)&&(E=2),E<3&&i[a].v.match(/[Ss]/)&&(E=3)}var F;switch(E){case 0:break;case 1:case 2:case 3:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H),f.H>=24&&(f.H=0,++f.D,F=za(f.D),F.u=f.u,F.S=f.S,F.M=f.M,F.H=f.H,f=F);break;case 4:switch(A){case 1:f.u=Math.round(f.u*10)/10;break;case 2:f.u=Math.round(f.u*100)/100;break;case 3:f.u=Math.round(f.u*1e3)/1e3;break}f.u>=1&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H),f.H>=24&&(f.H=0,++f.D,F=za(f.D),F.u=f.u,F.S=f.S,F.M=f.M,F.H=f.H,f=F);break}var L="",K;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=EA(i[a].t.charCodeAt(0),i[a].v,f,A),i[a].t="t";break;case"n":case"?":for(K=a+1;i[K]!=null&&((l=i[K].t)==="?"||l==="D"||(l===" "||l==="t")&&i[K+1]!=null&&(i[K+1].t==="?"||i[K+1].t==="t"&&i[K+1].v==="/")||i[a].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(i[K].v==="/"||i[K].v===" "&&i[K+1]!=null&&i[K+1].t=="?"));)i[a].v+=i[K].v,i[K]={v:"",t:";"},++K;L+=i[a].v,a=K-1;break;case"G":i[a].t="t",i[a].v=T0(r,e);break}var te="",V,R;if(L.length>0){L.charCodeAt(0)==40?(V=r<0&&L.charCodeAt(0)===45?-r:r,R=wo("n",L,V)):(V=r<0&&n>1?-r:r,R=wo("n",L,V),V<0&&i[0]&&i[0].t=="t"&&(R=R.substr(1),i[0].v="-"+i[0].v)),K=R.length-1;var q=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){q=a;break}var ie=i.length;if(q===i.length&&R.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(K>=i[a].v.length-1?(K-=i[a].v.length,i[a].v=R.substr(K+1,i[a].v.length)):K<0?i[a].v="":(i[a].v=R.substr(0,K+1),K=-1),i[a].t="t",ie=a);K>=0&&ie<i.length&&(i[ie].v=R.substr(0,K+1)+i[ie].v)}else if(q!==i.length&&R.indexOf("E")===-1){for(K=R.indexOf(".")-1,a=q;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(m=i[a].v.indexOf(".")>-1&&a===q?i[a].v.indexOf(".")-1:i[a].v.length-1,te=i[a].v.substr(m+1);m>=0;--m)K>=0&&(i[a].v.charAt(m)==="0"||i[a].v.charAt(m)==="#")&&(te=R.charAt(K--)+te);i[a].v=te,i[a].t="t",ie=a}for(K>=0&&ie<i.length&&(i[ie].v=R.substr(0,K+1)+i[ie].v),K=R.indexOf(".")+1,a=q;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==q)){for(m=i[a].v.indexOf(".")>-1&&a===q?i[a].v.indexOf(".")+1:0,te=i[a].v.substr(0,m);m<i[a].v.length;++m)K<R.length&&(te+=R.charAt(K++));i[a].v=te,i[a].t="t",ie=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(V=n>1&&r<0&&a>0&&i[a-1].v==="-"?-r:r,i[a].v=wo(i[a].t,i[a].v,V),i[a].t="t");var de="";for(a=0;a!==i.length;++a)i[a]!=null&&(de+=i[a].v);return de}var Ym=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Zm(t,r){if(r==null)return!1;var e=parseFloat(r[2]);switch(r[1]){case"=":if(t==e)return!0;break;case">":if(t>e)return!0;break;case"<":if(t<e)return!0;break;case"<>":if(t!=e)return!0;break;case">=":if(t>=e)return!0;break;case"<=":if(t<=e)return!0;break}return!1}function NA(t,r){var e=RA(t),n=e.length,i=e[n-1].indexOf("@");if(n<4&&i>-1&&--n,e.length>4)throw new Error("cannot find right format for |"+e.join("|")+"|");if(typeof r!="number")return[4,e.length===4||i>-1?e[e.length-1]:"@"];switch(typeof r=="number"&&!isFinite(r)&&(r=0),e.length){case 1:e=i>-1?["General","General","General",e[0]]:[e[0],e[0],e[0],"@"];break;case 2:e=i>-1?[e[0],e[0],e[0],e[1]]:[e[0],e[1],e[0],"@"];break;case 3:e=i>-1?[e[0],e[1],e[0],e[2]]:[e[0],e[1],e[2],"@"];break;case 4:break}var o=r>0?e[0]:r<0?e[1]:e[2];if(e[0].indexOf("[")===-1&&e[1].indexOf("[")===-1)return[n,o];if(e[0].match(/\[[=<>]/)!=null||e[1].match(/\[[=<>]/)!=null){var a=e[0].match(Ym),l=e[1].match(Ym);return Zm(r,a)?[n,e[0]]:Zm(r,l)?[n,e[1]]:[n,e[a!=null&&l!=null?2:1]]}return[n,o]}function To(t,r,e){e==null&&(e={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&e.dateNF?n=e.dateNF:n=t;break;case"number":t==14&&e.dateNF?n=e.dateNF:n=(e.table!=null?e.table:Ir)[t],n==null&&(n=e.table&&e.table[Jm[t]]||Ir[Jm[t]]),n==null&&(n=bA[t]||"General");break}if(Hl(n,0))return T0(r,e);r instanceof Date&&(r=Ci(r,e.date1904));var i=NA(n,r);if(Hl(i[1]))return T0(r,e);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else{if(r===""||r==null)return"";if(isNaN(r)&&i[1].indexOf("0")>-1)return"#NUM!";if(!isFinite(r)&&i[1].indexOf("0")>-1)return"#DIV/0!"}return LA(i[1],r,e,i[0])}function Kh(t,r){if(typeof r!="number"){r=+r||-1;for(var e=0;e<392;++e){if(Ir[e]==null){r<0&&(r=e);continue}if(Ir[e]==t){r=e;break}}r<0&&(r=391)}return Ir[r]=t,r}function ac(t){for(var r=0;r!=392;++r)t[r]!==void 0&&Kh(t[r],r)}function sc(){Ir=vA()}var Gl=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function VA(t){var r=typeof t=="number"?Ir[t]:t;return r=r.replace(Gl,"(\\d+)"),Gl.lastIndex=0,new RegExp("^"+r+"$")}function zA(t,r,e){var n=-1,i=-1,o=-1,a=-1,l=-1,c=-1;(r.match(Gl)||[]).forEach(function(C,y){var k=parseInt(e[y+1],10);switch(C.toLowerCase().charAt(0)){case"y":n=k;break;case"d":o=k;break;case"h":a=k;break;case"s":c=k;break;case"m":a>=0?l=k:i=k;break}}),Gl.lastIndex=0,c>=0&&l==-1&&i>=0&&(l=i,i=-1);var f=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var m=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return a==-1&&l==-1&&c==-1?f:n==-1&&i==-1&&o==-1?m:f+"T"+m}var UA={"d.m":"d\\.m"};function WA(t,r){return Kh(UA[t]||t,r)}var eh=(function(){var t={};t.version="1.2.0";function r(){for(var V=0,R=new Array(256),q=0;q!=256;++q)V=q,V=V&1?-306674912^V>>>1:V>>>1,V=V&1?-306674912^V>>>1:V>>>1,V=V&1?-306674912^V>>>1:V>>>1,V=V&1?-306674912^V>>>1:V>>>1,V=V&1?-306674912^V>>>1:V>>>1,V=V&1?-306674912^V>>>1:V>>>1,V=V&1?-306674912^V>>>1:V>>>1,V=V&1?-306674912^V>>>1:V>>>1,R[q]=V;return typeof Int32Array<"u"?new Int32Array(R):R}var e=r();function n(V){var R=0,q=0,ie=0,de=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(ie=0;ie!=256;++ie)de[ie]=V[ie];for(ie=0;ie!=256;++ie)for(q=V[ie],R=256+ie;R<4096;R+=256)q=de[R]=q>>>8^V[q&255];var ye=[];for(ie=1;ie!=16;++ie)ye[ie-1]=typeof Int32Array<"u"&&typeof de.subarray=="function"?de.subarray(ie*256,ie*256+256):de.slice(ie*256,ie*256+256);return ye}var i=n(e),o=i[0],a=i[1],l=i[2],c=i[3],f=i[4],m=i[5],C=i[6],y=i[7],k=i[8],S=i[9],M=i[10],E=i[11],A=i[12],x=i[13],F=i[14];function L(V,R){for(var q=R^-1,ie=0,de=V.length;ie<de;)q=q>>>8^e[(q^V.charCodeAt(ie++))&255];return~q}function K(V,R){for(var q=R^-1,ie=V.length-15,de=0;de<ie;)q=F[V[de++]^q&255]^x[V[de++]^q>>8&255]^A[V[de++]^q>>16&255]^E[V[de++]^q>>>24]^M[V[de++]]^S[V[de++]]^k[V[de++]]^y[V[de++]]^C[V[de++]]^m[V[de++]]^f[V[de++]]^c[V[de++]]^l[V[de++]]^a[V[de++]]^o[V[de++]]^e[V[de++]];for(ie+=15;de<ie;)q=q>>>8^e[(q^V[de++])&255];return~q}function te(V,R){for(var q=R^-1,ie=0,de=V.length,ye=0,_t=0;ie<de;)ye=V.charCodeAt(ie++),ye<128?q=q>>>8^e[(q^ye)&255]:ye<2048?(q=q>>>8^e[(q^(192|ye>>6&31))&255],q=q>>>8^e[(q^(128|ye&63))&255]):ye>=55296&&ye<57344?(ye=(ye&1023)+64,_t=V.charCodeAt(ie++)&1023,q=q>>>8^e[(q^(240|ye>>8&7))&255],q=q>>>8^e[(q^(128|ye>>2&63))&255],q=q>>>8^e[(q^(128|_t>>6&15|(ye&3)<<4))&255],q=q>>>8^e[(q^(128|_t&63))&255]):(q=q>>>8^e[(q^(224|ye>>12&15))&255],q=q>>>8^e[(q^(128|ye>>6&63))&255],q=q>>>8^e[(q^(128|ye&63))&255]);return~q}return t.table=e,t.bstr=L,t.buf=K,t.str=te,t})(),pr=(function(){var r={};r.version="1.2.2";function e(I,W){for(var N=I.split("/"),z=W.split("/"),U=0,j=0,le=Math.min(N.length,z.length);U<le;++U){if(j=N[U].length-z[U].length)return j;if(N[U]!=z[U])return N[U]<z[U]?-1:1}return N.length-z.length}function n(I){if(I.charAt(I.length-1)=="/")return I.slice(0,-1).indexOf("/")===-1?I:n(I.slice(0,-1));var W=I.lastIndexOf("/");return W===-1?I:I.slice(0,W+1)}function i(I){if(I.charAt(I.length-1)=="/")return i(I.slice(0,-1));var W=I.lastIndexOf("/");return W===-1?I:I.slice(W+1)}function o(I,W){typeof W=="string"&&(W=new Date(W));var N=W.getHours();N=N<<6|W.getMinutes(),N=N<<5|W.getSeconds()>>>1,I.write_shift(2,N);var z=W.getFullYear()-1980;z=z<<4|W.getMonth()+1,z=z<<5|W.getDate(),I.write_shift(2,z)}function a(I){var W=I.read_shift(2)&65535,N=I.read_shift(2)&65535,z=new Date,U=N&31;N>>>=5;var j=N&15;N>>>=4,z.setMilliseconds(0),z.setFullYear(N+1980),z.setMonth(j-1),z.setDate(U);var le=W&31;W>>>=5;var me=W&63;return W>>>=6,z.setHours(W),z.setMinutes(me),z.setSeconds(le<<1),z}function l(I){ji(I,0);for(var W={},N=0;I.l<=I.length-4;){var z=I.read_shift(2),U=I.read_shift(2),j=I.l+U,le={};switch(z){case 21589:N=I.read_shift(1),N&1&&(le.mtime=I.read_shift(4)),U>5&&(N&2&&(le.atime=I.read_shift(4)),N&4&&(le.ctime=I.read_shift(4))),le.mtime&&(le.mt=new Date(le.mtime*1e3));break;case 1:{var me=I.read_shift(4),ae=I.read_shift(4);le.usz=ae*Math.pow(2,32)+me,me=I.read_shift(4),ae=I.read_shift(4),le.csz=ae*Math.pow(2,32)+me}break}I.l=j,W[z]=le}return W}var c;function f(){return c||(c=ws)}function m(I,W){if(I[0]==80&&I[1]==75)return D(I,W);if((I[0]|32)==109&&(I[1]|32)==105)return Xe(I,W);if(I.length<512)throw new Error("CFB file size "+I.length+" < 512");var N=3,z=512,U=0,j=0,le=0,me=0,ae=0,se=[],ce=I.slice(0,512);ji(ce,0);var Oe=C(ce);switch(N=Oe[0],N){case 3:z=512;break;case 4:z=4096;break;case 0:if(Oe[1]==0)return D(I,W);default:throw new Error("Major Version: Expected 3 or 4 saw "+N)}z!==512&&(ce=I.slice(0,z),ji(ce,28));var Me=I.slice(0,z);y(ce,N);var rt=ce.read_shift(4,"i");if(N===3&&rt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+rt);ce.l+=4,le=ce.read_shift(4,"i"),ce.l+=4,ce.chk("00100000","Mini Stream Cutoff Size: "),me=ce.read_shift(4,"i"),U=ce.read_shift(4,"i"),ae=ce.read_shift(4,"i"),j=ce.read_shift(4,"i");for(var je=-1,De=0;De<109&&(je=ce.read_shift(4,"i"),!(je<0));++De)se[De]=je;var kt=k(I,z);E(ae,j,kt,z,se);var fr=x(kt,le,se,z);le<fr.length&&(fr[le].name="!Directory"),U>0&&me!==_t&&(fr[me].name="!MiniFAT"),fr[se[0]].name="!FAT",fr.fat_addrs=se,fr.ssz=z;var Gi={},Qr=[],sn=[],ss=[];F(le,fr,kt,Qr,U,Gi,sn,me),S(sn,ss,Qr),Qr.shift();var ls={FileIndex:sn,FullPaths:ss};return W&&W.raw&&(ls.raw={header:Me,sectors:kt}),ls}function C(I){if(I[I.l]==80&&I[I.l+1]==75)return[0,0];I.chk(St,"Header Signature: "),I.l+=16;var W=I.read_shift(2,"u");return[I.read_shift(2,"u"),W]}function y(I,W){var N=9;switch(I.l+=2,N=I.read_shift(2)){case 9:if(W!=3)throw new Error("Sector Shift: Expected 9 saw "+N);break;case 12:if(W!=4)throw new Error("Sector Shift: Expected 12 saw "+N);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+N)}I.chk("0600","Mini Sector Shift: "),I.chk("000000000000","Reserved: ")}function k(I,W){for(var N=Math.ceil(I.length/W)-1,z=[],U=1;U<N;++U)z[U-1]=I.slice(U*W,(U+1)*W);return z[N-1]=I.slice(N*W),z}function S(I,W,N){for(var z=0,U=0,j=0,le=0,me=0,ae=N.length,se=[],ce=[];z<ae;++z)se[z]=ce[z]=z,W[z]=N[z];for(;me<ce.length;++me)z=ce[me],U=I[z].L,j=I[z].R,le=I[z].C,se[z]===z&&(U!==-1&&se[U]!==U&&(se[z]=se[U]),j!==-1&&se[j]!==j&&(se[z]=se[j])),le!==-1&&(se[le]=z),U!==-1&&z!=se[z]&&(se[U]=se[z],ce.lastIndexOf(U)<me&&ce.push(U)),j!==-1&&z!=se[z]&&(se[j]=se[z],ce.lastIndexOf(j)<me&&ce.push(j));for(z=1;z<ae;++z)se[z]===z&&(j!==-1&&se[j]!==j?se[z]=se[j]:U!==-1&&se[U]!==U&&(se[z]=se[U]));for(z=1;z<ae;++z)if(I[z].type!==0){if(me=z,me!=se[me])do me=se[me],W[z]=W[me]+"/"+W[z];while(me!==0&&se[me]!==-1&&me!=se[me]);se[z]=-1}for(W[0]+="/",z=1;z<ae;++z)I[z].type!==2&&(W[z]+="/")}function M(I,W,N){for(var z=I.start,U=I.size,j=[],le=z;N&&U>0&&le>=0;)j.push(W.slice(le*ye,le*ye+ye)),U-=ye,le=la(N,le*4);return j.length===0?oe(0):ii(j).slice(0,I.size)}function E(I,W,N,z,U){var j=_t;if(I===_t){if(W!==0)throw new Error("DIFAT chain shorter than expected")}else if(I!==-1){var le=N[I],me=(z>>>2)-1;if(!le)return;for(var ae=0;ae<me&&(j=la(le,ae*4))!==_t;++ae)U.push(j);W>=1&&E(la(le,z-4),W-1,N,z,U)}}function A(I,W,N,z,U){var j=[],le=[];U||(U=[]);var me=z-1,ae=0,se=0;for(ae=W;ae>=0;){U[ae]=!0,j[j.length]=ae,le.push(I[ae]);var ce=N[Math.floor(ae*4/z)];if(se=ae*4&me,z<4+se)throw new Error("FAT boundary crossed: "+ae+" 4 "+z);if(!I[ce])break;ae=la(I[ce],se)}return{nodes:j,data:sh([le])}}function x(I,W,N,z){var U=I.length,j=[],le=[],me=[],ae=[],se=z-1,ce=0,Oe=0,Me=0,rt=0;for(ce=0;ce<U;++ce)if(me=[],Me=ce+W,Me>=U&&(Me-=U),!le[Me]){ae=[];var je=[];for(Oe=Me;Oe>=0;){je[Oe]=!0,le[Oe]=!0,me[me.length]=Oe,ae.push(I[Oe]);var De=N[Math.floor(Oe*4/z)];if(rt=Oe*4&se,z<4+rt)throw new Error("FAT boundary crossed: "+Oe+" 4 "+z);if(!I[De]||(Oe=la(I[De],rt),je[Oe]))break}j[Me]={nodes:me,data:sh([ae])}}return j}function F(I,W,N,z,U,j,le,me){for(var ae=0,se=z.length?2:0,ce=W[I].data,Oe=0,Me=0,rt;Oe<ce.length;Oe+=128){var je=ce.slice(Oe,Oe+128);ji(je,64),Me=je.read_shift(2),rt=uc(je,0,Me-se),z.push(rt);var De={name:rt,type:je.read_shift(1),color:je.read_shift(1),L:je.read_shift(4,"i"),R:je.read_shift(4,"i"),C:je.read_shift(4,"i"),clsid:je.read_shift(16),state:je.read_shift(4,"i"),start:0,size:0},kt=je.read_shift(2)+je.read_shift(2)+je.read_shift(2)+je.read_shift(2);kt!==0&&(De.ct=L(je,je.l-8));var fr=je.read_shift(2)+je.read_shift(2)+je.read_shift(2)+je.read_shift(2);fr!==0&&(De.mt=L(je,je.l-8)),De.start=je.read_shift(4,"i"),De.size=je.read_shift(4,"i"),De.size<0&&De.start<0&&(De.size=De.type=0,De.start=_t,De.name=""),De.type===5?(ae=De.start,U>0&&ae!==_t&&(W[ae].name="!StreamData")):De.size>=4096?(De.storage="fat",W[De.start]===void 0&&(W[De.start]=A(N,De.start,W.fat_addrs,W.ssz)),W[De.start].name=De.name,De.content=W[De.start].data.slice(0,De.size)):(De.storage="minifat",De.size<0?De.size=0:ae!==_t&&De.start!==_t&&W[ae]&&(De.content=M(De,W[ae].data,(W[me]||{}).data))),De.content&&ji(De.content,0),j[rt]=De,le.push(De)}}function L(I,W){return new Date((mi(I,W+4)/1e7*Math.pow(2,32)+mi(I,W)/1e7-11644473600)*1e3)}function K(I,W){return f(),m(c.readFileSync(I),W)}function te(I,W){var N=W&&W.type;switch(N||rr&&Buffer.isBuffer(I)&&(N="buffer"),N||"base64"){case"file":return K(I,W);case"base64":return m(fn(zo(I)),W);case"binary":return m(fn(I),W)}return m(I,W)}function V(I,W){var N=W||{},z=N.root||"Root Entry";if(I.FullPaths||(I.FullPaths=[]),I.FileIndex||(I.FileIndex=[]),I.FullPaths.length!==I.FileIndex.length)throw new Error("inconsistent CFB structure");I.FullPaths.length===0&&(I.FullPaths[0]=z+"/",I.FileIndex[0]={name:z,type:5}),N.CLSID&&(I.FileIndex[0].clsid=N.CLSID),R(I)}function R(I){var W="Sh33tJ5";if(!pr.find(I,"/"+W)){var N=oe(4);N[0]=55,N[1]=N[3]=50,N[2]=54,I.FileIndex.push({name:W,type:2,content:N,size:4,L:69,R:69,C:69}),I.FullPaths.push(I.FullPaths[0]+W),q(I)}}function q(I,W){V(I);for(var N=!1,z=!1,U=I.FullPaths.length-1;U>=0;--U){var j=I.FileIndex[U];switch(j.type){case 0:z?N=!0:(I.FileIndex.pop(),I.FullPaths.pop());break;case 1:case 2:case 5:z=!0,isNaN(j.R*j.L*j.C)&&(N=!0),j.R>-1&&j.L>-1&&j.R==j.L&&(N=!0);break;default:N=!0;break}}if(!(!N&&!W)){var le=new Date(1987,1,19),me=0,ae=Object.create?Object.create(null):{},se=[];for(U=0;U<I.FullPaths.length;++U)ae[I.FullPaths[U]]=!0,I.FileIndex[U].type!==0&&se.push([I.FullPaths[U],I.FileIndex[U]]);for(U=0;U<se.length;++U){var ce=n(se[U][0]);for(z=ae[ce];!z;){for(;n(ce)&&!ae[n(ce)];)ce=n(ce);se.push([ce,{name:i(ce).replace("/",""),type:1,clsid:or,ct:le,mt:le,content:null}]),ae[ce]=!0,ce=n(se[U][0]),z=ae[ce]}}for(se.sort(function(rt,je){return e(rt[0],je[0])}),I.FullPaths=[],I.FileIndex=[],U=0;U<se.length;++U)I.FullPaths[U]=se[U][0],I.FileIndex[U]=se[U][1];for(U=0;U<se.length;++U){var Oe=I.FileIndex[U],Me=I.FullPaths[U];if(Oe.name=i(Me).replace("/",""),Oe.L=Oe.R=Oe.C=-(Oe.color=1),Oe.size=Oe.content?Oe.content.length:0,Oe.start=0,Oe.clsid=Oe.clsid||or,U===0)Oe.C=se.length>1?1:-1,Oe.size=0,Oe.type=5;else if(Me.slice(-1)=="/"){for(me=U+1;me<se.length&&n(I.FullPaths[me])!=Me;++me);for(Oe.C=me>=se.length?-1:me,me=U+1;me<se.length&&n(I.FullPaths[me])!=n(Me);++me);Oe.R=me>=se.length?-1:me,Oe.type=1}else n(I.FullPaths[U+1]||"")==n(Me)&&(Oe.R=U+1),Oe.type=2}}}function ie(I,W){var N=W||{};if(N.fileType=="mad")return Li(I,N);switch(q(I),N.fileType){case"zip":return b(I,N)}var z=(function(rt){for(var je=0,De=0,kt=0;kt<rt.FileIndex.length;++kt){var fr=rt.FileIndex[kt];if(fr.content){var Gi=fr.content.length;Gi>0&&(Gi<4096?je+=Gi+63>>6:De+=Gi+511>>9)}}for(var Qr=rt.FullPaths.length+3>>2,sn=je+7>>3,ss=je+127>>7,ls=sn+De+Qr+ss,Ko=ls+127>>7,wc=Ko<=109?0:Math.ceil((Ko-109)/127);ls+Ko+wc+127>>7>Ko;)wc=++Ko<=109?0:Math.ceil((Ko-109)/127);var po=[1,wc,Ko,ss,Qr,De,je,0];return rt.FileIndex[0].size=je<<6,po[7]=(rt.FileIndex[0].start=po[0]+po[1]+po[2]+po[3]+po[4]+po[5])+(po[6]+7>>3),po})(I),U=oe(z[7]<<9),j=0,le=0;{for(j=0;j<8;++j)U.write_shift(1,st[j]);for(j=0;j<8;++j)U.write_shift(2,0);for(U.write_shift(2,62),U.write_shift(2,3),U.write_shift(2,65534),U.write_shift(2,9),U.write_shift(2,6),j=0;j<3;++j)U.write_shift(2,0);for(U.write_shift(4,0),U.write_shift(4,z[2]),U.write_shift(4,z[0]+z[1]+z[2]+z[3]-1),U.write_shift(4,0),U.write_shift(4,4096),U.write_shift(4,z[3]?z[0]+z[1]+z[2]-1:_t),U.write_shift(4,z[3]),U.write_shift(-4,z[1]?z[0]-1:_t),U.write_shift(4,z[1]),j=0;j<109;++j)U.write_shift(-4,j<z[2]?z[1]+j:-1)}if(z[1])for(le=0;le<z[1];++le){for(;j<236+le*127;++j)U.write_shift(-4,j<z[2]?z[1]+j:-1);U.write_shift(-4,le===z[1]-1?_t:le+1)}var me=function(rt){for(le+=rt;j<le-1;++j)U.write_shift(-4,j+1);rt&&(++j,U.write_shift(-4,_t))};for(le=j=0,le+=z[1];j<le;++j)U.write_shift(-4,ot.DIFSECT);for(le+=z[2];j<le;++j)U.write_shift(-4,ot.FATSECT);me(z[3]),me(z[4]);for(var ae=0,se=0,ce=I.FileIndex[0];ae<I.FileIndex.length;++ae)ce=I.FileIndex[ae],ce.content&&(se=ce.content.length,!(se<4096)&&(ce.start=le,me(se+511>>9)));for(me(z[6]+7>>3);U.l&511;)U.write_shift(-4,ot.ENDOFCHAIN);for(le=j=0,ae=0;ae<I.FileIndex.length;++ae)ce=I.FileIndex[ae],ce.content&&(se=ce.content.length,!(!se||se>=4096)&&(ce.start=le,me(se+63>>6)));for(;U.l&511;)U.write_shift(-4,ot.ENDOFCHAIN);for(j=0;j<z[4]<<2;++j){var Oe=I.FullPaths[j];if(!Oe||Oe.length===0){for(ae=0;ae<17;++ae)U.write_shift(4,0);for(ae=0;ae<3;++ae)U.write_shift(4,-1);for(ae=0;ae<12;++ae)U.write_shift(4,0);continue}ce=I.FileIndex[j],j===0&&(ce.start=ce.size?ce.start-1:_t);var Me=j===0&&N.root||ce.name;if(Me.length>31&&(console.error("Name "+Me+" will be truncated to "+Me.slice(0,31)),Me=Me.slice(0,31)),se=2*(Me.length+1),U.write_shift(64,Me,"utf16le"),U.write_shift(2,se),U.write_shift(1,ce.type),U.write_shift(1,ce.color),U.write_shift(-4,ce.L),U.write_shift(-4,ce.R),U.write_shift(-4,ce.C),ce.clsid)U.write_shift(16,ce.clsid,"hex");else for(ae=0;ae<4;++ae)U.write_shift(4,0);U.write_shift(4,ce.state||0),U.write_shift(4,0),U.write_shift(4,0),U.write_shift(4,0),U.write_shift(4,0),U.write_shift(4,ce.start),U.write_shift(4,ce.size),U.write_shift(4,0)}for(j=1;j<I.FileIndex.length;++j)if(ce=I.FileIndex[j],ce.size>=4096)if(U.l=ce.start+1<<9,rr&&Buffer.isBuffer(ce.content))ce.content.copy(U,U.l,0,ce.size),U.l+=ce.size+511&-512;else{for(ae=0;ae<ce.size;++ae)U.write_shift(1,ce.content[ae]);for(;ae&511;++ae)U.write_shift(1,0)}for(j=1;j<I.FileIndex.length;++j)if(ce=I.FileIndex[j],ce.size>0&&ce.size<4096)if(rr&&Buffer.isBuffer(ce.content))ce.content.copy(U,U.l,0,ce.size),U.l+=ce.size+63&-64;else{for(ae=0;ae<ce.size;++ae)U.write_shift(1,ce.content[ae]);for(;ae&63;++ae)U.write_shift(1,0)}if(rr)U.l=U.length;else for(;U.l<U.length;)U.write_shift(1,0);return U}function de(I,W){var N=I.FullPaths.map(function(ae){return ae.toUpperCase()}),z=N.map(function(ae){var se=ae.split("/");return se[se.length-(ae.slice(-1)=="/"?2:1)]}),U=!1;W.charCodeAt(0)===47?(U=!0,W=N[0].slice(0,-1)+W):U=W.indexOf("/")!==-1;var j=W.toUpperCase(),le=U===!0?N.indexOf(j):z.indexOf(j);if(le!==-1)return I.FileIndex[le];var me=!j.match(Bl);for(j=j.replace(Wa,""),me&&(j=j.replace(Bl,"!")),le=0;le<N.length;++le)if((me?N[le].replace(Bl,"!"):N[le]).replace(Wa,"")==j||(me?z[le].replace(Bl,"!"):z[le]).replace(Wa,"")==j)return I.FileIndex[le];return null}var ye=64,_t=-2,St="d0cf11e0a1b11ae1",st=[208,207,17,224,161,177,26,225],or="00000000000000000000000000000000",ot={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:_t,FREESECT:-1,HEADER_SIGNATURE:St,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:or,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function yr(I,W,N){f();var z=ie(I,N);c.writeFileSync(W,z)}function Vr(I){for(var W=new Array(I.length),N=0;N<I.length;++N)W[N]=String.fromCharCode(I[N]);return W.join("")}function Cr(I,W){var N=ie(I,W);switch(W&&W.type||"buffer"){case"file":return f(),c.writeFileSync(W.filename,N),N;case"binary":return typeof N=="string"?N:Vr(N);case"base64":return Wl(typeof N=="string"?N:Vr(N));case"buffer":if(rr)return Buffer.isBuffer(N)?N:co(N);case"array":return typeof N=="string"?fn(N):N}return N}var gi;function Ft(I){try{var W=I.InflateRaw,N=new W;if(N._processChunk(new Uint8Array([3,0]),N._finishFlushFlag),N.bytesRead)gi=I;else throw new Error("zlib does not expose bytesRead")}catch(z){console.error("cannot use native zlib: "+(z.message||z))}}function At(I,W){if(!gi)return yt(I,W);var N=gi.InflateRaw,z=new N,U=z._processChunk(I.slice(I.l),z._finishFlushFlag);return I.l+=z.bytesRead,U}function zt(I){return gi?gi.deflateRawSync(I):uo(I)}var Ut=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Wt=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Rt=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function G(I){var W=(I<<1|I<<11)&139536|(I<<5|I<<15)&558144;return(W>>16|W>>8|W)&255}for(var re=typeof Uint8Array<"u",Q=re?new Uint8Array(256):[],J=0;J<256;++J)Q[J]=G(J);function Ce(I,W){var N=Q[I&255];return W<=8?N>>>8-W:(N=N<<8|Q[I>>8&255],W<=16?N>>>16-W:(N=N<<8|Q[I>>16&255],N>>>24-W))}function qe(I,W){var N=W&7,z=W>>>3;return(I[z]|(N<=6?0:I[z+1]<<8))>>>N&3}function pt(I,W){var N=W&7,z=W>>>3;return(I[z]|(N<=5?0:I[z+1]<<8))>>>N&7}function tt(I,W){var N=W&7,z=W>>>3;return(I[z]|(N<=4?0:I[z+1]<<8))>>>N&15}function Re(I,W){var N=W&7,z=W>>>3;return(I[z]|(N<=3?0:I[z+1]<<8))>>>N&31}function jt(I,W){var N=W&7,z=W>>>3;return(I[z]|(N<=1?0:I[z+1]<<8))>>>N&127}function Lt(I,W,N){var z=W&7,U=W>>>3,j=(1<<N)-1,le=I[U]>>>z;return N<8-z||(le|=I[U+1]<<8-z,N<16-z)||(le|=I[U+2]<<16-z,N<24-z)||(le|=I[U+3]<<24-z),le&j}function Qe(I,W,N){var z=W&7,U=W>>>3;return z<=5?I[U]|=(N&7)<<z:(I[U]|=N<<z&255,I[U+1]=(N&7)>>8-z),W+3}function ar(I,W,N){var z=W&7,U=W>>>3;return N=(N&1)<<z,I[U]|=N,W+1}function cr(I,W,N){var z=W&7,U=W>>>3;return N<<=z,I[U]|=N&255,N>>>=8,I[U+1]=N,W+8}function si(I,W,N){var z=W&7,U=W>>>3;return N<<=z,I[U]|=N&255,N>>>=8,I[U+1]=N&255,I[U+2]=N>>>8,W+16}function ui(I,W){var N=I.length,z=2*N>W?2*N:W+5,U=0;if(N>=W)return I;if(rr){var j=Gm(z);if(I.copy)I.copy(j);else for(;U<I.length;++U)j[U]=I[U];return j}else if(re){var le=new Uint8Array(z);if(le.set)le.set(I);else for(;U<N;++U)le[U]=I[U];return le}return I.length=z,I}function Ve(I){for(var W=new Array(I),N=0;N<I;++N)W[N]=0;return W}function We(I,W,N){var z=1,U=0,j=0,le=0,me=0,ae=I.length,se=re?new Uint16Array(32):Ve(32);for(j=0;j<32;++j)se[j]=0;for(j=ae;j<N;++j)I[j]=0;ae=I.length;var ce=re?new Uint16Array(ae):Ve(ae);for(j=0;j<ae;++j)se[U=I[j]]++,z<U&&(z=U),ce[j]=0;for(se[0]=0,j=1;j<=z;++j)se[j+16]=me=me+se[j-1]<<1;for(j=0;j<ae;++j)me=I[j],me!=0&&(ce[j]=se[me+16]++);var Oe=0;for(j=0;j<ae;++j)if(Oe=I[j],Oe!=0)for(me=Ce(ce[j],z)>>z-Oe,le=(1<<z+4-Oe)-1;le>=0;--le)W[me|le<<Oe]=Oe&15|j<<4;return z}var _n=re?new Uint16Array(512):Ve(512),wi=re?new Uint16Array(32):Ve(32);if(!re){for(var $r=0;$r<512;++$r)_n[$r]=0;for($r=0;$r<32;++$r)wi[$r]=0}(function(){for(var I=[],W=0;W<32;W++)I.push(5);We(I,wi,32);var N=[];for(W=0;W<=143;W++)N.push(8);for(;W<=255;W++)N.push(9);for(;W<=279;W++)N.push(7);for(;W<=287;W++)N.push(8);We(N,_n,288)})();var xn=(function(){for(var W=re?new Uint8Array(32768):[],N=0,z=0;N<Rt.length-1;++N)for(;z<Rt[N+1];++z)W[z]=N;for(;z<32768;++z)W[z]=29;var U=re?new Uint8Array(259):[];for(N=0,z=0;N<Wt.length-1;++N)for(;z<Wt[N+1];++z)U[z]=N;function j(me,ae){for(var se=0;se<me.length;){var ce=Math.min(65535,me.length-se),Oe=se+ce==me.length;for(ae.write_shift(1,+Oe),ae.write_shift(2,ce),ae.write_shift(2,~ce&65535);ce-- >0;)ae[ae.l++]=me[se++]}return ae.l}function le(me,ae){for(var se=0,ce=0,Oe=re?new Uint16Array(32768):[];ce<me.length;){var Me=Math.min(65535,me.length-ce);if(Me<10){for(se=Qe(ae,se,+(ce+Me==me.length)),se&7&&(se+=8-(se&7)),ae.l=se/8|0,ae.write_shift(2,Me),ae.write_shift(2,~Me&65535);Me-- >0;)ae[ae.l++]=me[ce++];se=ae.l*8;continue}se=Qe(ae,se,+(ce+Me==me.length)+2);for(var rt=0;Me-- >0;){var je=me[ce];rt=(rt<<5^je)&32767;var De=-1,kt=0;if((De=Oe[rt])&&(De|=ce&-32768,De>ce&&(De-=32768),De<ce))for(;me[De+kt]==me[ce+kt]&&kt<250;)++kt;if(kt>2){je=U[kt],je<=22?se=cr(ae,se,Q[je+1]>>1)-1:(cr(ae,se,3),se+=5,cr(ae,se,Q[je-23]>>5),se+=3);var fr=je<8?0:je-4>>2;fr>0&&(si(ae,se,kt-Wt[je]),se+=fr),je=W[ce-De],se=cr(ae,se,Q[je]>>3),se-=3;var Gi=je<4?0:je-2>>1;Gi>0&&(si(ae,se,ce-De-Rt[je]),se+=Gi);for(var Qr=0;Qr<kt;++Qr)Oe[rt]=ce&32767,rt=(rt<<5^me[ce])&32767,++ce;Me-=kt-1}else je<=143?je=je+48:se=ar(ae,se,1),se=cr(ae,se,Q[je]),Oe[rt]=ce&32767,++ce}se=cr(ae,se,0)-1}return ae.l=(se+7)/8|0,ae.l}return function(ae,se){return ae.length<8?j(ae,se):le(ae,se)}})();function uo(I){var W=oe(50+Math.floor(I.length*1.1)),N=xn(I,W);return W.slice(0,N)}var Ln=re?new Uint16Array(32768):Ve(32768),Vt=re?new Uint16Array(32768):Ve(32768),li=re?new Uint16Array(128):Ve(128),an=1,va=1;function _i(I,W){var N=Re(I,W)+257;W+=5;var z=Re(I,W)+1;W+=5;var U=tt(I,W)+4;W+=4;for(var j=0,le=re?new Uint8Array(19):Ve(19),me=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ae=1,se=re?new Uint8Array(8):Ve(8),ce=re?new Uint8Array(8):Ve(8),Oe=le.length,Me=0;Me<U;++Me)le[Ut[Me]]=j=pt(I,W),ae<j&&(ae=j),se[j]++,W+=3;var rt=0;for(se[0]=0,Me=1;Me<=ae;++Me)ce[Me]=rt=rt+se[Me-1]<<1;for(Me=0;Me<Oe;++Me)(rt=le[Me])!=0&&(me[Me]=ce[rt]++);var je=0;for(Me=0;Me<Oe;++Me)if(je=le[Me],je!=0){rt=Q[me[Me]]>>8-je;for(var De=(1<<7-je)-1;De>=0;--De)li[rt|De<<je]=je&7|Me<<3}var kt=[];for(ae=1;kt.length<N+z;)switch(rt=li[jt(I,W)],W+=rt&7,rt>>>=3){case 16:for(j=3+qe(I,W),W+=2,rt=kt[kt.length-1];j-- >0;)kt.push(rt);break;case 17:for(j=3+pt(I,W),W+=3;j-- >0;)kt.push(0);break;case 18:for(j=11+jt(I,W),W+=7;j-- >0;)kt.push(0);break;default:kt.push(rt),ae<rt&&(ae=rt);break}var fr=kt.slice(0,N),Gi=kt.slice(N);for(Me=N;Me<286;++Me)fr[Me]=0;for(Me=z;Me<30;++Me)Gi[Me]=0;return an=We(fr,Ln,286),va=We(Gi,Vt,30),W}function Nn(I,W){if(I[0]==3&&!(I[1]&3))return[ua(W),2];for(var N=0,z=0,U=Gm(W||1<<18),j=0,le=U.length>>>0,me=0,ae=0;(z&1)==0;){if(z=pt(I,N),N+=3,z>>>1)z>>1==1?(me=9,ae=5):(N=_i(I,N),me=an,ae=va);else{N&7&&(N+=8-(N&7));var se=I[N>>>3]|I[(N>>>3)+1]<<8;if(N+=32,se>0)for(!W&&le<j+se&&(U=ui(U,j+se),le=U.length);se-- >0;)U[j++]=I[N>>>3],N+=8;continue}for(;;){!W&&le<j+32767&&(U=ui(U,j+32767),le=U.length);var ce=Lt(I,N,me),Oe=z>>>1==1?_n[ce]:Ln[ce];if(N+=Oe&15,Oe>>>=4,(Oe>>>8&255)===0)U[j++]=Oe;else{if(Oe==256)break;Oe-=257;var Me=Oe<8?0:Oe-4>>2;Me>5&&(Me=0);var rt=j+Wt[Oe];Me>0&&(rt+=Lt(I,N,Me),N+=Me),ce=Lt(I,N,ae),Oe=z>>>1==1?wi[ce]:Vt[ce],N+=Oe&15,Oe>>>=4;var je=Oe<4?0:Oe-2>>1,De=Rt[Oe];for(je>0&&(De+=Lt(I,N,je),N+=je),!W&&le<rt&&(U=ui(U,rt+100),le=U.length);j<rt;)U[j]=U[j-De],++j}}}return W?[U,N+7>>>3]:[U.slice(0,j),N+7>>>3]}function yt(I,W){var N=I.slice(I.l||0),z=Nn(N,W);return I.l+=z[1],z[0]}function ze(I,W){if(I)typeof console<"u"&&console.error(W);else throw new Error(W)}function D(I,W){var N=I;ji(N,0);var z=[],U=[],j={FileIndex:z,FullPaths:U};V(j,{root:W.root});for(var le=N.length-4;(N[le]!=80||N[le+1]!=75||N[le+2]!=5||N[le+3]!=6)&&le>=0;)--le;N.l=le+4,N.l+=4;var me=N.read_shift(2);N.l+=6;var ae=N.read_shift(4);for(N.l=ae,le=0;le<me;++le){N.l+=20;var se=N.read_shift(4),ce=N.read_shift(4),Oe=N.read_shift(2),Me=N.read_shift(2),rt=N.read_shift(2);N.l+=8;var je=N.read_shift(4),De=l(N.slice(N.l+Oe,N.l+Oe+Me));N.l+=Oe+Me+rt;var kt=N.l;N.l=je+4,De&&De[1]&&((De[1]||{}).usz&&(ce=De[1].usz),(De[1]||{}).csz&&(se=De[1].csz)),s(N,se,ce,j,De),N.l=kt}return j}function s(I,W,N,z,U){I.l+=2;var j=I.read_shift(2),le=I.read_shift(2),me=a(I);if(j&8257)throw new Error("Unsupported ZIP encryption");for(var ae=I.read_shift(4),se=I.read_shift(4),ce=I.read_shift(4),Oe=I.read_shift(2),Me=I.read_shift(2),rt="",je=0;je<Oe;++je)rt+=String.fromCharCode(I[I.l++]);if(Me){var De=l(I.slice(I.l,I.l+Me));(De[21589]||{}).mt&&(me=De[21589].mt),(De[1]||{}).usz&&(ce=De[1].usz),(De[1]||{}).csz&&(se=De[1].csz),U&&((U[21589]||{}).mt&&(me=U[21589].mt),(U[1]||{}).usz&&(ce=U[1].usz),(U[1]||{}).csz&&(se=U[1].csz))}I.l+=Me;var kt=I.slice(I.l,I.l+se);switch(le){case 8:kt=At(I,ce);break;case 0:I.l+=se;break;default:throw new Error("Unsupported ZIP Compression method "+le)}var fr=!1;j&8&&(ae=I.read_shift(4),ae==134695760&&(ae=I.read_shift(4),fr=!0),se=I.read_shift(4),ce=I.read_shift(4)),se!=W&&ze(fr,"Bad compressed size: "+W+" != "+se),ce!=N&&ze(fr,"Bad uncompressed size: "+N+" != "+ce),as(z,rt,kt,{unsafe:!0,mt:me})}function b(I,W){var N=W||{},z=[],U=[],j=oe(1),le=N.compression?8:0,me=0,ae=!1;ae&&(me|=8);var se=0,ce=0,Oe=0,Me=0,rt=I.FullPaths[0],je=rt,De=I.FileIndex[0],kt=[],fr=0;for(se=1;se<I.FullPaths.length;++se)if(je=I.FullPaths[se].slice(rt.length),De=I.FileIndex[se],!(!De.size||!De.content||Array.isArray(De.content)&&De.content.length==0||je=="Sh33tJ5")){var Gi=Oe,Qr=oe(je.length);for(ce=0;ce<je.length;++ce)Qr.write_shift(1,je.charCodeAt(ce)&127);Qr=Qr.slice(0,Qr.l),kt[Me]=typeof De.content=="string"?eh.bstr(De.content,0):eh.buf(De.content,0);var sn=typeof De.content=="string"?fn(De.content):De.content;le==8&&(sn=zt(sn)),j=oe(30),j.write_shift(4,67324752),j.write_shift(2,20),j.write_shift(2,me),j.write_shift(2,le),De.mt?o(j,De.mt):j.write_shift(4,0),j.write_shift(-4,me&8?0:kt[Me]),j.write_shift(4,me&8?0:sn.length),j.write_shift(4,me&8?0:De.content.length),j.write_shift(2,Qr.length),j.write_shift(2,0),Oe+=j.length,z.push(j),Oe+=Qr.length,z.push(Qr),Oe+=sn.length,z.push(sn),me&8&&(j=oe(12),j.write_shift(-4,kt[Me]),j.write_shift(4,sn.length),j.write_shift(4,De.content.length),Oe+=j.l,z.push(j)),j=oe(46),j.write_shift(4,33639248),j.write_shift(2,0),j.write_shift(2,20),j.write_shift(2,me),j.write_shift(2,le),j.write_shift(4,0),j.write_shift(-4,kt[Me]),j.write_shift(4,sn.length),j.write_shift(4,De.content.length),j.write_shift(2,Qr.length),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(4,0),j.write_shift(4,Gi),fr+=j.l,U.push(j),fr+=Qr.length,U.push(Qr),++Me}return j=oe(22),j.write_shift(4,101010256),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(2,Me),j.write_shift(2,Me),j.write_shift(4,fr),j.write_shift(4,Oe),j.write_shift(2,0),ii([ii(z),ii(U),j])}var _={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function T(I,W){if(I.ctype)return I.ctype;var N=I.name||"",z=N.match(/\.([^\.]+)$/);return z&&_[z[1]]||W&&(z=(N=W).match(/[\.\\]([^\.\\])+$/),z&&_[z[1]])?_[z[1]]:"application/octet-stream"}function H(I){for(var W=Wl(I),N=[],z=0;z<W.length;z+=76)N.push(W.slice(z,z+76));return N.join(`\r
`)+`\r
`}function X(I){var W=I.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(se){var ce=se.charCodeAt(0).toString(16).toUpperCase();return"="+(ce.length==1?"0"+ce:ce)});W=W.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),W.charAt(0)==`
`&&(W="=0D"+W.slice(1)),W=W.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var N=[],z=W.split(`\r
`),U=0;U<z.length;++U){var j=z[U];if(j.length==0){N.push("");continue}for(var le=0;le<j.length;){var me=76,ae=j.slice(le,le+me);ae.charAt(me-1)=="="?me--:ae.charAt(me-2)=="="?me-=2:ae.charAt(me-3)=="="&&(me-=3),ae=j.slice(le,le+me),le+=me,le<j.length&&(ae+="="),N.push(ae)}}return N.join(`\r
`)}function w(I){for(var W=[],N=0;N<I.length;++N){for(var z=I[N];N<=I.length&&z.charAt(z.length-1)=="=";)z=z.slice(0,z.length-1)+I[++N];W.push(z)}for(var U=0;U<W.length;++U)W[U]=W[U].replace(/[=][0-9A-Fa-f]{2}/g,function(j){return String.fromCharCode(parseInt(j.slice(1),16))});return fn(W.join(`\r
`))}function ue(I,W,N){for(var z="",U="",j="",le,me=0;me<10;++me){var ae=W[me];if(!ae||ae.match(/^\s*$/))break;var se=ae.match(/^([^:]*?):\s*([^\s].*)$/);if(se)switch(se[1].toLowerCase()){case"content-location":z=se[2].trim();break;case"content-type":j=se[2].trim();break;case"content-transfer-encoding":U=se[2].trim();break}}switch(++me,U.toLowerCase()){case"base64":le=fn(zo(W.slice(me).join("")));break;case"quoted-printable":le=w(W.slice(me));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+U)}var ce=as(I,z.slice(N.length),le,{unsafe:!0});j&&(ce.ctype=j)}function Xe(I,W){if(Vr(I.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var N=W&&W.root||"",z=(rr&&Buffer.isBuffer(I)?I.toString("binary"):Vr(I)).split(`\r
`),U=0,j="";for(U=0;U<z.length;++U)if(j=z[U],!!/^Content-Location:/i.test(j)&&(j=j.slice(j.indexOf("file")),N||(N=j.slice(0,j.lastIndexOf("/")+1)),j.slice(0,N.length)!=N))for(;N.length>0&&(N=N.slice(0,N.length-1),N=N.slice(0,N.lastIndexOf("/")+1),j.slice(0,N.length)!=N););var le=(z[1]||"").match(/boundary="(.*?)"/);if(!le)throw new Error("MAD cannot find boundary");var me="--"+(le[1]||""),ae=[],se=[],ce={FileIndex:ae,FullPaths:se};V(ce);var Oe,Me=0;for(U=0;U<z.length;++U){var rt=z[U];rt!==me&&rt!==me+"--"||(Me++&&ue(ce,z.slice(Oe,U),N),Oe=U)}return ce}function Li(I,W){var N=W||{},z=N.boundary||"SheetJS";z="------="+z;for(var U=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+z.slice(2)+'"',"","",""],j=I.FullPaths[0],le=j,me=I.FileIndex[0],ae=1;ae<I.FullPaths.length;++ae)if(le=I.FullPaths[ae].slice(j.length),me=I.FileIndex[ae],!(!me.size||!me.content||le=="Sh33tJ5")){le=le.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(kt){return"_x"+kt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(kt){return"_u"+kt.charCodeAt(0).toString(16)+"_"});for(var se=me.content,ce=rr&&Buffer.isBuffer(se)?se.toString("binary"):Vr(se),Oe=0,Me=Math.min(1024,ce.length),rt=0,je=0;je<=Me;++je)(rt=ce.charCodeAt(je))>=32&&rt<128&&++Oe;var De=Oe>=Me*4/5;U.push(z),U.push("Content-Location: "+(N.root||"file:///C:/SheetJS/")+le),U.push("Content-Transfer-Encoding: "+(De?"quoted-printable":"base64")),U.push("Content-Type: "+T(me,le)),U.push(""),U.push(De?X(ce):H(ce))}return U.push(z+`--\r
`),U.join(`\r
`)}function Go(I){var W={};return V(W,I),W}function as(I,W,N,z){var U=z&&z.unsafe;U||V(I);var j=!U&&pr.find(I,W);if(!j){var le=I.FullPaths[0];W.slice(0,le.length)==le?le=W:(le.slice(-1)!="/"&&(le+="/"),le=(le+W).replace("//","/")),j={name:i(W),type:2},I.FileIndex.push(j),I.FullPaths.push(le),U||pr.utils.cfb_gc(I)}return j.content=N,j.size=N?N.length:0,z&&(z.CLSID&&(j.clsid=z.CLSID),z.mt&&(j.mt=z.mt),z.ct&&(j.ct=z.ct)),j}function E1(I,W){V(I);var N=pr.find(I,W);if(N){for(var z=0;z<I.FileIndex.length;++z)if(I.FileIndex[z]==N)return I.FileIndex.splice(z,1),I.FullPaths.splice(z,1),!0}return!1}function I1(I,W,N){V(I);var z=pr.find(I,W);if(z){for(var U=0;U<I.FileIndex.length;++U)if(I.FileIndex[U]==z)return I.FileIndex[U].name=i(N),I.FullPaths[U]=N,!0}return!1}function F1(I){q(I,!0)}return r.find=de,r.read=te,r.parse=m,r.write=Cr,r.writeFile=yr,r.utils={cfb_new:Go,cfb_add:as,cfb_del:E1,cfb_mov:I1,cfb_gc:F1,ReadShift:ks,CheckField:og,prep_blob:ji,bconcat:ii,use_zlib:Ft,_deflateRaw:uo,_inflateRaw:yt,consts:ot},r})(),ws;function th(t){return typeof t=="string"?oc(t):Array.isArray(t)?hA(t):t}function Ns(t,r,e){if(typeof ws<"u"&&ws.writeFileSync)return e?ws.writeFileSync(t,r,e):ws.writeFileSync(t,r);if(typeof Deno<"u"){if(e&&typeof r=="string")switch(e){case"utf8":r=new TextEncoder(e).encode(r);break;case"binary":r=oc(r);break;default:throw new Error("Unsupported encoding "+e)}return Deno.writeFileSync(t,r)}var n=e=="utf8"?Co(r):r;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var i=new Blob([th(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var o=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),chrome.downloads.download({url:o,filename:t,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=t,a.href=o,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),o}else if(typeof URL<"u"&&!URL.createObjectURL&&typeof chrome=="object"){var l="data:application/octet-stream;base64,"+mA(new Uint8Array(th(n)));return chrome.downloads.download({url:l,filename:t,saveAs:!0})}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var c=File(t);return c.open("w"),c.encoding="binary",Array.isArray(r)&&(r=da(r)),c.write(r),c.close(),r}catch(f){if(!f.message||f.message.indexOf("onstruct")==-1)throw f}throw new Error("cannot save file "+t)}function ni(t){for(var r=Object.keys(t),e=[],n=0;n<r.length;++n)Object.prototype.hasOwnProperty.call(t,r[n])&&e.push(r[n]);return e}function rh(t,r){for(var e=[],n=ni(t),i=0;i!==n.length;++i)e[t[n[i]][r]]==null&&(e[t[n[i]][r]]=n[i]);return e}function M0(t){for(var r=[],e=ni(t),n=0;n!==e.length;++n)r[t[e[n]]]=e[n];return r}function lc(t){for(var r=[],e=ni(t),n=0;n!==e.length;++n)r[t[e[n]]]=parseInt(e[n],10);return r}function jA(t){for(var r=[],e=ni(t),n=0;n!==e.length;++n)r[t[e[n]]]==null&&(r[t[e[n]]]=[]),r[t[e[n]]].push(e[n]);return r}var Xh=Date.UTC(1899,11,30,0,0,0),HA=Date.UTC(1899,11,31,0,0,0),$A=Date.UTC(1904,0,1,0,0,0);function Ci(t,r){var e=t.getTime(),n=(e-Xh)/(1440*60*1e3);return r?(n-=1462,n<-1402?n-1:n):n<60?n-1:n}function Ha(t){if(t>=60&&t<61)return t;var r=new Date;return r.setTime((t>60?t:t+1)*24*60*60*1e3+Xh),r}var GA=/^(\d+):(\d+)(:\d+)?(\.\d+)?$/,KA=/^(\d+)-(\d+)-(\d+)$/,Jh=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)?(\.\d+)?$/;function on(t,r){if(t instanceof Date)return t;var e=t.match(GA);if(e)return new Date((r?$A:HA)+((parseInt(e[1],10)*60+parseInt(e[2],10))*60+(e[3]?parseInt(e[3].slice(1),10):0))*1e3+(e[4]?parseInt((e[4]+"000").slice(1,4),10):0));if(e=t.match(KA),e)return new Date(Date.UTC(+e[1],+e[2]-1,+e[3],0,0,0,0));if(e=t.match(Jh),e)return new Date(Date.UTC(+e[1],+e[2]-1,+e[3],+e[4],+e[5],e[6]&&parseInt(e[6].slice(1),10)||0,e[7]&&parseInt((e[7]+"0000").slice(1,4),10)||0));var n=new Date(t);return n}function R0(t,r){if(rr&&Buffer.isBuffer(t)){if(r&&Ps){if(t[0]==255&&t[1]==254)return Co(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Co(pA(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(r){if(t[0]==255&&t[1]==254)return Co(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Co(new TextDecoder("utf-16be").decode(t.slice(2)))}var e={"\u20AC":"\x80","\u201A":"\x82",\u0192:"\x83","\u201E":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02C6":"\x88","\u2030":"\x89",\u0160:"\x8A","\u2039":"\x8B",\u0152:"\x8C",\u017D:"\x8E","\u2018":"\x91","\u2019":"\x92","\u201C":"\x93","\u201D":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02DC":"\x98","\u2122":"\x99",\u0161:"\x9A","\u203A":"\x9B",\u0153:"\x9C",\u017E:"\x9E",\u0178:"\x9F"};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(o){return e[o]||o})}catch{}var n=[],i=0;try{for(i=0;i<t.length-65536;i+=65536)n.push(String.fromCharCode.apply(0,t.slice(i,i+65536)));n.push(String.fromCharCode.apply(0,t.slice(i)))}catch{try{for(;i<t.length-16384;i+=16384)n.push(String.fromCharCode.apply(0,t.slice(i,i+16384)));n.push(String.fromCharCode.apply(0,t.slice(i)))}catch{for(;i!=t.length;++i)n.push(String.fromCharCode(t[i]))}}return n.join("")}function Ri(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var r={};for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=Ri(t[e]));return r}function Lr(t,r){for(var e="";e.length<r;)e+=t;return e}function So(t){var r=Number(t);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(t))return r;var e=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return e*=100,""});return!isNaN(r=Number(n))||(n=n.replace(/[(]([^()]*)[)]/,function(i,o){return e=-e,o}),!isNaN(r=Number(n)))?r/e:r}var XA=/^(0?\d|1[0-2])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))\s+([ap])m?$/,JA=/^([01]?\d|2[0-3])(?:|:([0-5]?\d)(?:|(\.\d+)(?:|:([0-5]?\d))|:([0-5]?\d)(|\.\d+)))$/,qA=/^(\d+)-(\d+)-(\d+)[T ](\d+):(\d+)(:\d+)(\.\d+)?[Z]?$/,QA=new Date("6/9/69 00:00 UTC").valueOf()==-177984e5;function YA(t){return t[2]?t[3]?t[4]?new Date(Date.UTC(1899,11,31,+t[1]%12+(t[7]=="p"?12:0),+t[2],+t[4],parseFloat(t[3])*1e3)):new Date(Date.UTC(1899,11,31,t[7]=="p"?12:0,+t[1],+t[2],parseFloat(t[3])*1e3)):t[5]?new Date(Date.UTC(1899,11,31,+t[1]%12+(t[7]=="p"?12:0),+t[2],+t[5],t[6]?parseFloat(t[6])*1e3:0)):new Date(Date.UTC(1899,11,31,+t[1]%12+(t[7]=="p"?12:0),+t[2],0,0)):new Date(Date.UTC(1899,11,31,+t[1]%12+(t[7]=="p"?12:0),0,0,0))}function ZA(t){return t[2]?t[3]?t[4]?new Date(Date.UTC(1899,11,31,+t[1],+t[2],+t[4],parseFloat(t[3])*1e3)):new Date(Date.UTC(1899,11,31,0,+t[1],+t[2],parseFloat(t[3])*1e3)):t[5]?new Date(Date.UTC(1899,11,31,+t[1],+t[2],+t[5],t[6]?parseFloat(t[6])*1e3:0)):new Date(Date.UTC(1899,11,31,+t[1],+t[2],0,0)):new Date(Date.UTC(1899,11,31,+t[1],0,0,0))}var eP=["january","february","march","april","may","june","july","august","september","october","november","december"];function Kl(t){if(qA.test(t))return t.indexOf("Z")==-1?cc(new Date(t)):new Date(t);var r=t.toLowerCase(),e=r.replace(/\s+/g," ").trim(),n=e.match(XA);if(n)return YA(n);if(n=e.match(JA),n)return ZA(n);if(n=e.match(Jh),n)return new Date(Date.UTC(+n[1],+n[2]-1,+n[3],+n[4],+n[5],n[6]&&parseInt(n[6].slice(1),10)||0,n[7]&&parseInt((n[7]+"0000").slice(1,4),10)||0));var i=new Date(QA&&t.indexOf("UTC")==-1?t+" UTC":t),o=new Date(NaN),a=i.getYear(),l=i.getMonth(),c=i.getDate();if(isNaN(c))return o;if(r.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(r=r.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),r.length>3&&eP.indexOf(r)==-1)return o}else if(r.replace(/[ap]m?/,"").match(/[a-z]/))return o;return a<0||a>8099||t.match(/[^-0-9:,\/\\\ ]/)?o:i}function Qa(t){return new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds())}function cc(t){return new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()))}function Ot(t,r,e){if(t.FullPaths){if(Array.isArray(e)&&typeof e[0]=="string"&&(e=e.join("")),typeof e=="string"){var n;return rr?n=co(e):n=gA(e),pr.utils.cfb_add(t,r,n)}pr.utils.cfb_add(t,r,e)}else t.file(r,e)}function L0(){return pr.utils.cfb_new()}var ai=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`;var tP={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},N0=M0(tP);var V0=/[&<>'"]/g,rP=/[\u0000-\u0008\u000b-\u001f\uFFFE-\uFFFF]/g;function Bt(t){var r=t+"";return r.replace(V0,function(e){return N0[e]}).replace(rP,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}function ih(t){return Bt(t).replace(/ /g,"_x0020_")}var qh=/[\u0000-\u001f]/g;function f0(t){var r=t+"";return r.replace(V0,function(e){return N0[e]}).replace(/\n/g,"<br/>").replace(qh,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}function iP(t){var r=t+"";return r.replace(V0,function(e){return N0[e]}).replace(qh,function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"})}function nP(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function oP(t){switch(t){case 1:case!0:case"1":case"true":return!0;case 0:case!1:case"0":case"false":return!1}return!1}function m0(t){for(var r="",e=0,n=0,i=0,o=0,a=0,l=0;e<t.length;){if(n=t.charCodeAt(e++),n<128){r+=String.fromCharCode(n);continue}if(i=t.charCodeAt(e++),n>191&&n<224){a=(n&31)<<6,a|=i&63,r+=String.fromCharCode(a);continue}if(o=t.charCodeAt(e++),n<240){r+=String.fromCharCode((n&15)<<12|(i&63)<<6|o&63);continue}a=t.charCodeAt(e++),l=((n&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536,r+=String.fromCharCode(55296+(l>>>10&1023)),r+=String.fromCharCode(56320+(l&1023))}return r}function nh(t){var r=ua(2*t.length),e,n,i=1,o=0,a=0,l;for(n=0;n<t.length;n+=i)i=1,(l=t.charCodeAt(n))<128?e=l:l<224?(e=(l&31)*64+(t.charCodeAt(n+1)&63),i=2):l<240?(e=(l&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,e=(l&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),e-=65536,a=55296+(e>>>10&1023),e=56320+(e&1023)),a!==0&&(r[o++]=a&255,r[o++]=a>>>8,a=0),r[o++]=e%256,r[o++]=e>>>8;return r.slice(0,o).toString("ucs2")}function oh(t){return co(t,"binary").toString("utf8")}var Ml="foo bar baz\xE2\x98\x83\xF0\x9F\x8D\xA3",$a=rr&&(oh(Ml)==m0(Ml)&&oh||nh(Ml)==m0(Ml)&&nh)||m0,Co=rr?function(t){return co(t,"utf8").toString("binary")}:function(t){for(var r=[],e=0,n=0,i=0;e<t.length;)switch(n=t.charCodeAt(e++),!0){case n<128:r.push(String.fromCharCode(n));break;case n<2048:r.push(String.fromCharCode(192+(n>>6))),r.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(e++)-56320+(n<<10),r.push(String.fromCharCode(240+(i>>18&7))),r.push(String.fromCharCode(144+(i>>12&63))),r.push(String.fromCharCode(128+(i>>6&63))),r.push(String.fromCharCode(128+(i&63)));break;default:r.push(String.fromCharCode(224+(n>>12))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(n&63)))}return r.join("")},aP=(function(){var t=[["nbsp"," "],["middot","\xB7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(e){for(var n=e.replace(/^[\t\n\r ]+/,"").replace(/(^|[^\t\n\r ])[\t\n\r ]+$/,"$1").replace(/>\s+/g,">").replace(/\b\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^<>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}})();var Qh=/(^\s|\s$|\n)/;function bi(t,r){return"<"+t+(r.match(Qh)?' xml:space="preserve"':"")+">"+r+"</"+t+">"}function Ds(t){return ni(t).map(function(r){return" "+r+'="'+t[r]+'"'}).join("")}function Be(t,r,e){return"<"+t+(e!=null?Ds(e):"")+(r!=null?(r.match(Qh)?' xml:space="preserve"':"")+">"+r+"</"+t:"/")+">"}function E0(t,r){try{return t.toISOString().replace(/\.\d*/,"")}catch(e){if(r)throw e}return""}function sP(t,r){switch(typeof t){case"string":var e=Be("vt:lpwstr",Bt(t));return r&&(e=e.replace(/&quot;/g,"_x0022_")),e;case"number":return Be((t|0)==t?"vt:i4":"vt:r8",Bt(String(t)));case"boolean":return Be("vt:bool",t?"true":"false")}if(t instanceof Date)return Be("vt:filetime",E0(t));throw new Error("Unable to serialize "+t)}var hi={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Za=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],mn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function lP(t,r){for(var e=1-2*(t[r+7]>>>7),n=((t[r+7]&127)<<4)+(t[r+6]>>>4&15),i=t[r+6]&15,o=5;o>=0;--o)i=i*256+t[r+o];return n==2047?i==0?e*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),e*Math.pow(2,n-52)*i)}function cP(t,r,e){var n=(r<0||1/r==-1/0?1:0)<<7,i=0,o=0,a=n?-r:r;isFinite(a)?a==0?i=o=0:(i=Math.floor(Math.log(a)/Math.LN2),o=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?i=-1022:(o-=Math.pow(2,52),i+=1023)):(i=2047,o=isNaN(r)?26985:0);for(var l=0;l<=5;++l,o/=256)t[e+l]=o&255;t[e+6]=(i&15)<<4|o&15,t[e+7]=i>>4|n}var ah=function(t){for(var r=[],e=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,o=t[0][n].length;i<o;i+=e)r.push.apply(r,t[0][n].slice(i,i+e));return r},sh=rr?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(r){return Buffer.isBuffer(r)?r:co(r)})):ah(t)}:ah,lh=function(t,r,e){for(var n=[],i=r;i<e;i+=2)n.push(String.fromCharCode(Ss(t,i)));return n.join("").replace(Wa,"")},uc=rr?function(t,r,e){return!Buffer.isBuffer(t)||!Ps?lh(t,r,e):t.toString("utf16le",r,e).replace(Wa,"")}:lh,ch=function(t,r,e){for(var n=[],i=r;i<r+e;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},Yh=rr?function(t,r,e){return Buffer.isBuffer(t)?t.toString("hex",r,r+e):ch(t,r,e)}:ch,uh=function(t,r,e){for(var n=[],i=r;i<e;i++)n.push(String.fromCharCode(Ua(t,i)));return n.join("")},es=rr?function(r,e,n){return Buffer.isBuffer(r)?r.toString("utf8",e,n):uh(r,e,n)}:uh,Zh=function(t,r){var e=mi(t,r);return e>0?es(t,r+4,r+4+e-1):""},z0=Zh,eg=function(t,r){var e=mi(t,r);return e>0?es(t,r+4,r+4+e-1):""},U0=eg,tg=function(t,r){var e=2*mi(t,r);return e>0?es(t,r+4,r+4+e-1):""},W0=tg,rg=function(r,e){var n=mi(r,e);return n>0?uc(r,e+4,e+4+n):""},j0=rg,ig=function(t,r){var e=mi(t,r);return e>0?es(t,r+4,r+4+e):""},H0=ig,ng=function(t,r){return lP(t,r)},Xl=ng,$0=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};rr&&(z0=function(r,e){if(!Buffer.isBuffer(r))return Zh(r,e);var n=r.readUInt32LE(e);return n>0?r.toString("utf8",e+4,e+4+n-1):""},U0=function(r,e){if(!Buffer.isBuffer(r))return eg(r,e);var n=r.readUInt32LE(e);return n>0?r.toString("utf8",e+4,e+4+n-1):""},W0=function(r,e){if(!Buffer.isBuffer(r)||!Ps)return tg(r,e);var n=2*r.readUInt32LE(e);return r.toString("utf16le",e+4,e+4+n-1)},j0=function(r,e){if(!Buffer.isBuffer(r)||!Ps)return rg(r,e);var n=r.readUInt32LE(e);return r.toString("utf16le",e+4,e+4+n)},H0=function(r,e){if(!Buffer.isBuffer(r))return ig(r,e);var n=r.readUInt32LE(e);return r.toString("utf8",e+4,e+4+n)},Xl=function(r,e){return Buffer.isBuffer(r)?r.readDoubleLE(e):ng(r,e)},$0=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});function uP(){uc=function(t,r,e){return qt.utils.decode(1200,t.slice(r,e)).replace(Wa,"")},es=function(t,r,e){return qt.utils.decode(65001,t.slice(r,e))},z0=function(t,r){var e=mi(t,r);return e>0?qt.utils.decode(qa,t.slice(r+4,r+4+e-1)):""},U0=function(t,r){var e=mi(t,r);return e>0?qt.utils.decode(hn,t.slice(r+4,r+4+e-1)):""},W0=function(t,r){var e=2*mi(t,r);return e>0?qt.utils.decode(1200,t.slice(r+4,r+4+e-1)):""},j0=function(t,r){var e=mi(t,r);return e>0?qt.utils.decode(1200,t.slice(r+4,r+4+e)):""},H0=function(t,r){var e=mi(t,r);return e>0?qt.utils.decode(65001,t.slice(r+4,r+4+e)):""}}typeof qt<"u"&&uP();var Ua=function(t,r){return t[r]},Ss=function(t,r){return t[r+1]*256+t[r]},dP=function(t,r){var e=t[r+1]*256+t[r];return e<32768?e:(65535-e+1)*-1},mi=function(t,r){return t[r+3]*(1<<24)+(t[r+2]<<16)+(t[r+1]<<8)+t[r]},la=function(t,r){return t[r+3]<<24|t[r+2]<<16|t[r+1]<<8|t[r]},pP=function(t,r){return t[r]<<24|t[r+1]<<16|t[r+2]<<8|t[r+3]};function ks(t,r){var e="",n,i,o=[],a,l,c,f;switch(r){case"dbcs":if(f=this.l,rr&&Buffer.isBuffer(this)&&Ps)e=this.slice(this.l,this.l+2*t).toString("utf16le");else for(c=0;c<t;++c)e+=String.fromCharCode(Ss(this,f)),f+=2;t*=2;break;case"utf8":e=es(this,this.l,this.l+t);break;case"utf16le":t*=2,e=uc(this,this.l,this.l+t);break;case"wstr":if(typeof qt<"u")e=qt.utils.decode(hn,this.slice(this.l,this.l+2*t));else return ks.call(this,t,"dbcs");t=2*t;break;case"lpstr-ansi":e=z0(this,this.l),t=4+mi(this,this.l);break;case"lpstr-cp":e=U0(this,this.l),t=4+mi(this,this.l);break;case"lpwstr":e=W0(this,this.l),t=4+2*mi(this,this.l);break;case"lpp4":t=4+mi(this,this.l),e=j0(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+mi(this,this.l),e=H0(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,e="";(a=Ua(this,this.l+t++))!==0;)o.push(Ol(a));e=o.join("");break;case"_wstr":for(t=0,e="";(a=Ss(this,this.l+t))!==0;)o.push(Ol(a)),t+=2;t+=2,e=o.join("");break;case"dbcs-cont":for(e="",f=this.l,c=0;c<t;++c){if(this.lens&&this.lens.indexOf(f)!==-1)return a=Ua(this,f),this.l=f+1,l=ks.call(this,t-c,a?"dbcs-cont":"sbcs-cont"),o.join("")+l;o.push(Ol(Ss(this,f))),f+=2}e=o.join(""),t*=2;break;case"cpstr":if(typeof qt<"u"){e=qt.utils.decode(hn,this.slice(this.l,this.l+t));break}case"sbcs-cont":for(e="",f=this.l,c=0;c!=t;++c){if(this.lens&&this.lens.indexOf(f)!==-1)return a=Ua(this,f),this.l=f+1,l=ks.call(this,t-c,a?"dbcs-cont":"sbcs-cont"),o.join("")+l;o.push(Ol(Ua(this,f))),f+=1}e=o.join("");break;default:switch(t){case 1:return n=Ua(this,this.l),this.l++,n;case 2:return n=(r==="i"?dP:Ss)(this,this.l),this.l+=2,n;case 4:case-4:return r==="i"||(this[this.l+3]&128)===0?(n=(t>0?la:pP)(this,this.l),this.l+=4,n):(i=mi(this,this.l),this.l+=4,i);case 8:case-8:if(r==="f")return t==8?i=Xl(this,this.l):i=Xl([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:e=Yh(this,this.l,t);break}}return this.l+=t,e}var fP=function(t,r,e){t[e]=r&255,t[e+1]=r>>>8&255,t[e+2]=r>>>16&255,t[e+3]=r>>>24&255},mP=function(t,r,e){t[e]=r&255,t[e+1]=r>>8&255,t[e+2]=r>>16&255,t[e+3]=r>>24&255},hP=function(t,r,e){t[e]=r&255,t[e+1]=r>>>8&255};function gP(t,r,e){var n=0,i=0;if(e==="dbcs"){for(i=0;i!=r.length;++i)hP(this,r.charCodeAt(i),this.l+2*i);n=2*r.length}else if(e==="sbcs"||e=="cpstr")if(typeof qt<"u"&&qa==874){for(i=0;i!=r.length;++i){var o=qt.utils.encode(qa,r.charAt(i));this[this.l+i]=o[0]}n=r.length}else if(typeof qt<"u"&&e=="cpstr"){if(o=qt.utils.encode(hn,r),o.length==r.length)for(i=0;i<r.length;++i)o[i]==0&&r.charCodeAt(i)!=0&&(o[i]=95);if(o.length==2*r.length)for(i=0;i<r.length;++i)o[2*i]==0&&o[2*i+1]==0&&r.charCodeAt(i)!=0&&(o[2*i]=95);for(i=0;i<o.length;++i)this[this.l+i]=o[i];n=o.length}else{for(r=r.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=r.length;++i)this[this.l+i]=r.charCodeAt(i)&255;n=r.length}else if(e==="hex"){for(;i<t;++i)this[this.l++]=parseInt(r.slice(2*i,2*i+2),16)||0;return this}else if(e==="utf16le"){var a=Math.min(this.l+t,this.length);for(i=0;i<Math.min(r.length,t);++i){var l=r.charCodeAt(i);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=r&255;break;case 2:n=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:n=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:n=4,fP(this,r,this.l);break;case 8:if(n=8,e==="f"){cP(this,r,this.l);break}case 16:break;case-4:n=4,mP(this,r,this.l);break}return this.l+=n,this}function og(t,r){var e=Yh(this,this.l,t.length>>1);if(e!==t)throw new Error(r+"Expected "+t+" saw "+e);this.l+=t.length>>1}function ji(t,r){t.l=r,t.read_shift=ks,t.chk=og,t.write_shift=gP}function lo(t,r){t.l+=r}function oe(t){var r=ua(t);return ji(r,0),r}function Bi(){var t=[],r=rr?16384:2048,e=rr&&typeof oe(r).copy=="function",n=function(C){var y=oe(C);return ji(y,0),y},i=n(r),o=function(){i&&(i.l&&(i.length>i.l&&(i=i.slice(0,i.l),i.l=i.length),i.length>0&&t.push(i)),i=null)},a=function(C){return i&&C<i.length-i.l?i:(o(),i=n(Math.max(C+1,r)))},l=function(){return o(),ii(t)},c=function(){return o(),t},f=function(C){o(),i=C,i.l==null&&(i.l=i.length),a(r)};return{next:a,push:f,end:l,_bufs:t,end2:c}}function ve(t,r,e,n){var i=+r,o;if(!isNaN(i)){n||(n=w6[i].p||(e||[]).length||0),o=1+(i>=128?1:0)+1,n>=128&&++o,n>=16384&&++o,n>=2097152&&++o;var a=t.next(o);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var l=0;l!=4;++l)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&$0(e)&&t.push(e)}}function Ts(t,r,e){var n=Ri(t);if(r.s?(n.cRel&&(n.c+=r.s.c),n.rRel&&(n.r+=r.s.r)):(n.cRel&&(n.c+=r.c),n.rRel&&(n.r+=r.r)),!e||e.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function dh(t,r,e){var n=Ri(t);return n.s=Ts(n.s,r.s,e),n.e=Ts(n.e,r.s,e),n}function Es(t,r){if(t.cRel&&t.c<0)for(t=Ri(t);t.c<0;)t.c+=r>8?16384:256;if(t.rRel&&t.r<0)for(t=Ri(t);t.r<0;)t.r+=r>8?1048576:r>5?65536:16384;var e=Hr(t);return!t.cRel&&t.cRel!=null&&(e=vP(e)),!t.rRel&&t.rRel!=null&&(e=_P(e)),e}function h0(t,r){return t.s.r==0&&!t.s.rRel&&t.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+lr(t.s.c)+":"+(t.e.cRel?"":"$")+lr(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(r.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+dr(t.s.r)+":"+(t.e.rRel?"":"$")+dr(t.e.r):Es(t.s,r.biff)+":"+Es(t.e,r.biff)}function G0(t){return parseInt(xP(t),10)-1}function dr(t){return""+(t+1)}function _P(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function xP(t){return t.replace(/\$(\d+)$/,"$1")}function K0(t){for(var r=bP(t),e=0,n=0;n!==r.length;++n)e=26*e+r.charCodeAt(n)-64;return e-1}function lr(t){if(t<0)throw new Error("invalid column "+t);var r="";for(++t;t;t=Math.floor((t-1)/26))r=String.fromCharCode((t-1)%26+65)+r;return r}function vP(t){return t.replace(/^([A-Z])/,"$$$1")}function bP(t){return t.replace(/^\$([A-Z])/,"$1")}function yP(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Nr(t){for(var r=0,e=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?r=10*r+(i-48):i>=65&&i<=90&&(e=26*e+(i-64))}return{c:e-1,r:r-1}}function Hr(t){for(var r=t.c+1,e="";r;r=(r-1)/26|0)e=String.fromCharCode((r-1)%26+65)+e;return e+(t.r+1)}function yi(t){var r=t.indexOf(":");return r==-1?{s:Nr(t),e:Nr(t)}:{s:Nr(t.slice(0,r)),e:Nr(t.slice(r+1))}}function oi(t,r){return typeof r>"u"||typeof r=="number"?oi(t.s,t.e):(typeof t!="string"&&(t=Hr(t)),typeof r!="string"&&(r=Hr(r)),t==r?t:t+":"+r)}function Os(t){var r=yi(t);return"$"+lr(r.s.c)+"$"+dr(r.s.r)+":$"+lr(r.e.c)+"$"+dr(r.e.r)}function Bs(t,r){if(!t&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t.replace(/'/g,"''")+"'":t}function Fr(t){var r={s:{c:0,r:0},e:{c:0,r:0}},e=0,n=0,i=0,o=t.length;for(e=0;n<o&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)e=26*e+i;for(r.s.c=--e,e=0;n<o&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)e=10*e+i;if(r.s.r=--e,n===o||i!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++n,e=0;n!=o&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)e=26*e+i;for(r.e.c=--e,e=0;n!=o&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)e=10*e+i;return r.e.r=--e,r}function ph(t,r){var e=t.t=="d"&&r instanceof Date;if(t.z!=null)try{return t.w=To(t.z,e?Ci(r):r)}catch{}try{return t.w=To((t.XF||{}).numFmtId||(e?14:0),e?Ci(r):r)}catch{return""+r}}function Eo(t,r,e){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&e&&e.dateNF&&(t.z=e.dateNF),t.t=="e"?$i[t.v]||t.v:r==null?ph(t,t.v):ph(t,r))}function ts(t,r){var e=r&&r.sheet?r.sheet:"Sheet1",n={};return n[e]=t,{SheetNames:[e],Sheets:n}}function CP(t){var r={},e=t||{};return e.dense&&(r["!data"]=[]),r}function ag(t,r,e){var n=e||{},i=t?t["!data"]!=null:n.dense;ao!=null&&i==null&&(i=ao);var o=t||(i?{"!data":[]}:{});i&&!o["!data"]&&(o["!data"]=[]);var a=0,l=0;if(o&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var c=typeof n.origin=="string"?Nr(n.origin):n.origin;a=c.r,l=c.c}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var m=Fr(o["!ref"]);f.s.c=m.s.c,f.s.r=m.s.r,f.e.c=Math.max(f.e.c,m.e.c),f.e.r=Math.max(f.e.r,m.e.r),a==-1&&(f.e.r=a=o["!ref"]?m.e.r+1:0)}else f.s.c=f.e.c=f.s.r=f.e.r=0;for(var C=[],y=!1,k=0;k!=r.length;++k)if(r[k]){if(!Array.isArray(r[k]))throw new Error("aoa_to_sheet expects an array of arrays");var S=a+k;i&&(o["!data"][S]||(o["!data"][S]=[]),C=o["!data"][S]);for(var M=r[k],E=0;E!=M.length;++E)if(!(typeof M[E]>"u")){var A={v:M[E],t:""},x=l+E;if(f.s.r>S&&(f.s.r=S),f.s.c>x&&(f.s.c=x),f.e.r<S&&(f.e.r=S),f.e.c<x&&(f.e.c=x),y=!0,M[E]&&typeof M[E]=="object"&&!Array.isArray(M[E])&&!(M[E]instanceof Date))A=M[E];else if(Array.isArray(A.v)&&(A.f=M[E][1],A.v=A.v[0]),A.v===null)if(A.f)A.t="n";else if(n.nullError)A.t="e",A.v=0;else if(n.sheetStubs)A.t="z";else continue;else typeof A.v=="number"?isFinite(A.v)?A.t="n":isNaN(A.v)?(A.t="e",A.v=15):(A.t="e",A.v=7):typeof A.v=="boolean"?A.t="b":A.v instanceof Date?(A.z=n.dateNF||Ir[14],n.UTC||(A.v=cc(A.v)),n.cellDates?(A.t="d",A.w=To(A.z,Ci(A.v,n.date1904))):(A.t="n",A.v=Ci(A.v,n.date1904),A.w=To(A.z,A.v))):A.t="s";if(i)C[x]&&C[x].z&&(A.z=C[x].z),C[x]=A;else{var F=lr(x)+(S+1);o[F]&&o[F].z&&(A.z=o[F].z),o[F]=A}}}return y&&f.s.c<104e5&&(o["!ref"]=oi(f)),o}function rs(t,r){return ag(null,t,r)}function wP(t){return t.read_shift(4,"i")}function Rn(t,r){return r||(r=oe(4)),r.write_shift(4,t),r}function Mi(t){var r=t.read_shift(4);return r===0?"":t.read_shift(r,"dbcs")}function ci(t,r){var e=!1;return r==null&&(e=!0,r=oe(4+2*t.length)),r.write_shift(4,t.length),t.length>0&&r.write_shift(0,t,"dbcs"),e?r.slice(0,r.l):r}function SP(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function kP(t,r){return r||(r=oe(4)),r.write_shift(2,t.ich||0),r.write_shift(2,t.ifnt||0),r}function X0(t,r){var e=t.l,n=t.read_shift(1),i=Mi(t),o=[],a={t:i,h:i};if((n&1)!==0){for(var l=t.read_shift(4),c=0;c!=l;++c)o.push(SP(t));a.r=o}else a.r=[{ich:0,ifnt:0}];return t.l=e+r,a}function TP(t,r){var e=!1;return r==null&&(e=!0,r=oe(15+4*t.t.length)),r.write_shift(1,0),ci(t.t,r),e?r.slice(0,r.l):r}var EP=X0;function IP(t,r){var e=!1;return r==null&&(e=!0,r=oe(23+4*t.t.length)),r.write_shift(1,1),ci(t.t,r),r.write_shift(4,1),kP({ich:0,ifnt:0},r),e?r.slice(0,r.l):r}function An(t){var r=t.read_shift(4),e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:r,iStyleRef:e}}function ha(t,r){return r==null&&(r=oe(8)),r.write_shift(-4,t.c),r.write_shift(3,t.iStyleRef||t.s),r.write_shift(1,0),r}function ga(t){var r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:r}}function _a(t,r){return r==null&&(r=oe(4)),r.write_shift(3,t.iStyleRef||t.s),r.write_shift(1,0),r}var FP=Mi,sg=ci;function dc(t){var r=t.read_shift(4);return r===0||r===4294967295?"":t.read_shift(r,"dbcs")}function Ms(t,r){var e=!1;return r==null&&(e=!0,r=oe(127)),r.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&r.write_shift(0,t,"dbcs"),e?r.slice(0,r.l):r}var AP=Mi,I0=dc,J0=Ms;function q0(t){var r=t.slice(t.l,t.l+4),e=r[0]&1,n=r[0]&2;t.l+=4;var i=n===0?Xl([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):la(r,0)>>2;return e?i/100:i}function lg(t,r){r==null&&(r=oe(4));var e=0,n=0,i=t*100;if(t==(t|0)&&t>=-(1<<29)&&t<1<<29?n=1:i==(i|0)&&i>=-(1<<29)&&i<1<<29&&(n=1,e=1),n)r.write_shift(-4,((e?i:t)<<2)+(e+2));else throw new Error("unsupported RkNumber "+t)}function cg(t){var r={s:{},e:{}};return r.s.r=t.read_shift(4),r.e.r=t.read_shift(4),r.s.c=t.read_shift(4),r.e.c=t.read_shift(4),r}function PP(t,r){return r||(r=oe(16)),r.write_shift(4,t.s.r),r.write_shift(4,t.e.r),r.write_shift(4,t.s.c),r.write_shift(4,t.e.c),r}var xa=cg,is=PP;function ns(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function fa(t,r){return(r||oe(8)).write_shift(8,t,"f")}function DP(t){var r={},e=t.read_shift(1),n=e>>>1,i=t.read_shift(1),o=t.read_shift(2,"i"),a=t.read_shift(1),l=t.read_shift(1),c=t.read_shift(1);switch(t.l++,n){case 0:r.auto=1;break;case 1:r.index=i;var f=UP[i];f&&(r.rgb=Sh(f));break;case 2:r.rgb=Sh([a,l,c]);break;case 3:r.theme=i;break}return o!=0&&(r.tint=o>0?o/32767:o/32768),r}function Jl(t,r){if(r||(r=oe(8)),!t||t.auto)return r.write_shift(4,0),r.write_shift(4,0),r;t.index!=null?(r.write_shift(1,2),r.write_shift(1,t.index)):t.theme!=null?(r.write_shift(1,6),r.write_shift(1,t.theme)):(r.write_shift(1,5),r.write_shift(1,0));var e=t.tint||0;if(e>0?e*=32767:e<0&&(e*=32768),r.write_shift(2,e),!t.rgb||t.theme!=null)r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),r.write_shift(1,parseInt(n.slice(0,2),16)),r.write_shift(1,parseInt(n.slice(2,4),16)),r.write_shift(1,parseInt(n.slice(4,6),16)),r.write_shift(1,255)}return r}function OP(t){var r=t.read_shift(1);t.l++;var e={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return e}function BP(t,r){r||(r=oe(2));var e=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return r.write_shift(1,e),r.write_shift(1,0),r}var ug=2,pn=3,Rl=11;var ql=19,Ll=64,MP=65,RP=71,LP=4108,NP=4126,vi=80;var fh={1:{n:"CodePage",t:ug},2:{n:"Category",t:vi},3:{n:"PresentationFormat",t:vi},4:{n:"ByteCount",t:pn},5:{n:"LineCount",t:pn},6:{n:"ParagraphCount",t:pn},7:{n:"SlideCount",t:pn},8:{n:"NoteCount",t:pn},9:{n:"HiddenCount",t:pn},10:{n:"MultimediaClipCount",t:pn},11:{n:"ScaleCrop",t:Rl},12:{n:"HeadingPairs",t:LP},13:{n:"TitlesOfParts",t:NP},14:{n:"Manager",t:vi},15:{n:"Company",t:vi},16:{n:"LinksUpToDate",t:Rl},17:{n:"CharacterCount",t:pn},19:{n:"SharedDoc",t:Rl},22:{n:"HyperlinksChanged",t:Rl},23:{n:"AppVersion",t:pn,p:"version"},24:{n:"DigSig",t:MP},26:{n:"ContentType",t:vi},27:{n:"ContentStatus",t:vi},28:{n:"Language",t:vi},29:{n:"Version",t:vi},255:{},2147483648:{n:"Locale",t:ql},2147483651:{n:"Behavior",t:ql},1919054434:{}},mh={1:{n:"CodePage",t:ug},2:{n:"Title",t:vi},3:{n:"Subject",t:vi},4:{n:"Author",t:vi},5:{n:"Keywords",t:vi},6:{n:"Comments",t:vi},7:{n:"Template",t:vi},8:{n:"LastAuthor",t:vi},9:{n:"RevNumber",t:vi},10:{n:"EditTime",t:Ll},11:{n:"LastPrinted",t:Ll},12:{n:"CreatedDate",t:Ll},13:{n:"ModifiedDate",t:Ll},14:{n:"PageCount",t:pn},15:{n:"WordCount",t:pn},16:{n:"CharCount",t:pn},17:{n:"Thumbnail",t:RP},18:{n:"Application",t:vi},19:{n:"DocSecurity",t:pn},255:{},2147483648:{n:"Locale",t:ql},2147483651:{n:"Behavior",t:ql},1919054434:{}};function VP(t){return t.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var zP=VP([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,0,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),UP=Ri(zP),$i={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},so={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},WP=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"],jP={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Nl={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function dg(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function pg(t,r,e){var n=jA(jP),i=[],o;e||(i[i.length]=ai,i[i.length]=Be("Types",null,{xmlns:hi.CT,"xmlns:xsd":hi.xsd,"xmlns:xsi":hi.xsi}),i=i.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(f){return Be("Default",null,{Extension:f[0],ContentType:f[1]})})));var a=function(f){t[f]&&t[f].length>0&&(o=t[f][0],i[i.length]=Be("Override",null,{PartName:(o[0]=="/"?"":"/")+o,ContentType:Nl[f][r.bookType]||Nl[f].xlsx}))},l=function(f){(t[f]||[]).forEach(function(m){i[i.length]=Be("Override",null,{PartName:(m[0]=="/"?"":"/")+m,ContentType:Nl[f][r.bookType]||Nl[f].xlsx})})},c=function(f){(t[f]||[]).forEach(function(m){i[i.length]=Be("Override",null,{PartName:(m[0]=="/"?"":"/")+m,ContentType:n[f][0]})})};return a("workbooks"),l("sheets"),l("charts"),c("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(c),c("vba"),c("comments"),c("threadedcomments"),c("drawings"),l("metadata"),c("people"),!e&&i.length>2&&(i[i.length]="</Types>",i[1]=i[1].replace("/>",">")),i.join("")}var Kt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",CONN:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/connections",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function fg(t){var r=t.lastIndexOf("/");return t.slice(0,r+1)+"_rels/"+t.slice(r+1)+".rels"}function Ga(t){var r=[ai,Be("Relationships",null,{xmlns:hi.RELS})];return ni(t["!id"]).forEach(function(e){r[r.length]=Be("Relationship",null,t["!id"][e])}),r.length>2&&(r[r.length]="</Relationships>",r[1]=r[1].replace("/>",">")),r.join("")}function tr(t,r,e,n,i,o){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),r<0)for(r=t["!idx"];t["!id"]["rId"+r];++r);if(t["!idx"]=r+1,i.Id="rId"+r,i.Type=n,i.Target=e,o?i.TargetMode=o:[Kt.HLINK,Kt.XPATH,Kt.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+r);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,r}function HP(t){var r=[ai];r.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),r.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var e=0;e<t.length;++e)r.push('  <manifest:file-entry manifest:full-path="'+t[e][0]+'" manifest:media-type="'+t[e][1]+`"/>
`);return r.push("</manifest:manifest>"),r.join("")}function hh(t,r,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(e||"odf")+"#"+r+`"/>
`,`  </rdf:Description>
`].join("")}function $P(t,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+r+`"/>
`,`  </rdf:Description>
`].join("")}function GP(t){var r=[ai];r.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var e=0;e!=t.length;++e)r.push(hh(t[e][0],t[e][1])),r.push($P("",t[e][0]));return r.push(hh("","Document","pkg")),r.push("</rdf:RDF>"),r.join("")}function mg(t,r){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Fs.version+"</meta:generator></office:meta></office:document-meta>"}var ca=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function g0(t,r,e,n,i){i[t]!=null||r==null||r===""||(i[t]=r,r=Bt(r),n[n.length]=e?Be(t,r,e):bi(t,r))}function hg(t,r){var e=r||{},n=[ai,Be("cp:coreProperties",null,{"xmlns:cp":hi.CORE_PROPS,"xmlns:dc":hi.dc,"xmlns:dcterms":hi.dcterms,"xmlns:dcmitype":hi.dcmitype,"xmlns:xsi":hi.xsi})],i={};if(!t&&!e.Props)return n.join("");t&&(t.CreatedDate!=null&&g0("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:E0(t.CreatedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),t.ModifiedDate!=null&&g0("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:E0(t.ModifiedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var o=0;o!=ca.length;++o){var a=ca[o],l=e.Props&&e.Props[a[1]]!=null?e.Props[a[1]]:t?t[a[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&g0(a[0],l,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Ka=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],gg=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function _g(t){var r=[],e=Be;return t||(t={}),t.Application="SheetJS",r[r.length]=ai,r[r.length]=Be("Properties",null,{xmlns:hi.EXT_PROPS,"xmlns:vt":hi.vt}),Ka.forEach(function(n){if(t[n[1]]!==void 0){var i;switch(n[2]){case"string":i=Bt(String(t[n[1]]));break;case"bool":i=t[n[1]]?"true":"false";break}i!==void 0&&(r[r.length]=e(n[0],i))}}),r[r.length]=e("HeadingPairs",e("vt:vector",e("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+e("vt:variant",e("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),r[r.length]=e("TitlesOfParts",e("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+Bt(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}function xg(t){var r=[ai,Be("Properties",null,{xmlns:hi.CUST_PROPS,"xmlns:vt":hi.vt})];if(!t)return r.join("");var e=1;return ni(t).forEach(function(i){++e,r[r.length]=Be("property",sP(t[i],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:e,name:Bt(i)})}),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var gh={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function KP(t,r){var e=[];return ni(gh).map(function(n){for(var i=0;i<ca.length;++i)if(ca[i][1]==n)return ca[i];for(i=0;i<Ka.length;++i)if(Ka[i][1]==n)return Ka[i];throw n}).forEach(function(n){if(t[n[1]]!=null){var i=r&&r.Props&&r.Props[n[1]]!=null?r.Props[n[1]]:t[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),e.push(bi(gh[n[1]]||n[1],i))}}),Be("DocumentProperties",e.join(""),{xmlns:mn.o})}function XP(t,r){var e=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return t&&ni(t).forEach(function(o){if(Object.prototype.hasOwnProperty.call(t,o)){for(var a=0;a<ca.length;++a)if(o==ca[a][1])return;for(a=0;a<Ka.length;++a)if(o==Ka[a][1])return;for(a=0;a<e.length;++a)if(o==e[a])return;var l=t[o],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),i.push(Be(ih(o),l,{"dt:dt":c}))}}),r&&ni(r).forEach(function(o){if(Object.prototype.hasOwnProperty.call(r,o)&&!(t&&Object.prototype.hasOwnProperty.call(t,o))){var a=r[o],l="string";typeof a=="number"?(l="float",a=String(a)):a===!0||a===!1?(l="boolean",a=a?"1":"0"):a instanceof Date?(l="dateTime.tz",a=a.toISOString()):a=String(a),i.push(Be(ih(o),a,{"dt:dt":l}))}}),"<"+n+' xmlns="'+mn.o+'">'+i.join("")+"</"+n+">"}function JP(t){var r=typeof t=="string"?new Date(Date.parse(t)):t,e=r.getTime()/1e3+11644473600,n=e%Math.pow(2,32),i=(e-n)/Math.pow(2,32);n*=1e7,i*=1e7;var o=n/Math.pow(2,32)|0;o>0&&(n=n%Math.pow(2,32),i+=o);var a=oe(8);return a.write_shift(4,n),a.write_shift(4,i),a}function _h(t,r){var e=oe(4),n=oe(4);switch(e.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,r);break;case 5:n=oe(8),n.write_shift(8,r,"f");break;case 11:n.write_shift(4,r?1:0);break;case 64:n=JP(r);break;case 31:case 80:for(n=oe(4+2*(r.length+1)+(r.length%2?0:2)),n.write_shift(4,r.length+1),n.write_shift(0,r,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+r)}return ii([e,n])}var vg=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function qP(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function xh(t,r,e){var n=oe(8),i=[],o=[],a=8,l=0,c=oe(8),f=oe(8);if(c.write_shift(4,2),c.write_shift(4,1200),f.write_shift(4,1),o.push(c),i.push(f),a+=8+c.length,!r){f=oe(8),f.write_shift(4,0),i.unshift(f);var m=[oe(4)];for(m[0].write_shift(4,t.length),l=0;l<t.length;++l){var C=t[l][0];for(c=oe(8+2*(C.length+1)+(C.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,C.length+1),c.write_shift(0,C,"dbcs");c.l!=c.length;)c.write_shift(1,0);m.push(c)}c=ii(m),o.unshift(c),a+=8+c.length}for(l=0;l<t.length;++l)if(!(r&&!r[t[l][0]])&&!(vg.indexOf(t[l][0])>-1||gg.indexOf(t[l][0])>-1)&&t[l][1]!=null){var y=t[l][1],k=0;if(r){k=+r[t[l][0]];var S=e[k];if(S.p=="version"&&typeof y=="string"){var M=y.split(".");y=(+M[0]<<16)+(+M[1]||0)}c=_h(S.t,y)}else{var E=qP(y);E==-1&&(E=31,y=String(y)),c=_h(E,y)}o.push(c),f=oe(8),f.write_shift(4,r?k:2+l),i.push(f),a+=8+c.length}var A=8*(o.length+1);for(l=0;l<o.length;++l)i[l].write_shift(4,A),A+=o[l].length;return n.write_shift(4,a),n.write_shift(4,o.length),ii([n].concat(i).concat(o))}function vh(t,r,e,n,i,o){var a=oe(i?68:48),l=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,pr.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,r,"hex"),a.write_shift(4,i?68:48);var c=xh(t,e,n);if(l.push(c),i){var f=xh(i,null,null);a.write_shift(16,o,"hex"),a.write_shift(4,68+c.length),l.push(f)}return ii(l)}function QP(t,r){r||(r=oe(t));for(var e=0;e<t;++e)r.write_shift(1,0);return r}function YP(t,r){return t.read_shift(r)===1}function Di(t,r){return r||(r=oe(2)),r.write_shift(2,+!!t),r}function Ul(t){return t.read_shift(2,"u")}function Fn(t,r){return r||(r=oe(2)),r.write_shift(2,t),r}function bg(t,r,e){return e||(e=oe(2)),e.write_shift(1,r=="e"?+t:+!!t),e.write_shift(1,r=="e"?1:0),e}function yg(t,r,e){var n=t.read_shift(e&&e.biff>=12?2:1),i="sbcs-cont",o=hn;if(e&&e.biff>=8&&(hn=1200),!e||e.biff==8){var a=t.read_shift(1);a&&(i="dbcs-cont")}else e.biff==12&&(i="wstr");e.biff>=2&&e.biff<=5&&(i="cpstr");var l=n?t.read_shift(n,i):"";return hn=o,l}function ZP(t){var r=t.t||"",e=1,n=oe(3+(e>1?2:0));n.write_shift(2,r.length),n.write_shift(1,(e>1?8:0)|1),e>1&&n.write_shift(2,e);var i=oe(2*r.length);i.write_shift(2*r.length,r,"utf16le");var o=[n,i];return ii(o)}function eD(t,r,e){var n;if(e){if(e.biff>=2&&e.biff<=5)return t.read_shift(r,"cpstr");if(e.biff>=12)return t.read_shift(r,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(r,"sbcs-cont"):n=t.read_shift(r,"dbcs-cont"),n}function tD(t,r,e){var n=t.read_shift(e&&e.biff==2?1:2);return n===0?(t.l++,""):eD(t,n,e)}function rD(t,r,e){if(e.biff>5)return tD(t,r,e);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,e.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function Cg(t,r,e){return e||(e=oe(3+2*t.length)),e.write_shift(2,t.length),e.write_shift(1,1),e.write_shift(31,t,"utf16le"),e}function bh(t,r){r||(r=oe(6+t.length*2)),r.write_shift(4,1+t.length);for(var e=0;e<t.length;++e)r.write_shift(2,t.charCodeAt(e));return r.write_shift(2,0),r}function iD(t){var r=oe(512),e=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),o=i>-1?31:23;switch(n.charAt(0)){case"#":o=28;break;case".":o&=-3;break}r.write_shift(4,2),r.write_shift(4,o);var a=[8,6815827,6619237,4849780,83];for(e=0;e<a.length;++e)r.write_shift(4,a[e]);if(o==28)n=n.slice(1),bh(n,r);else if(o&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),e=0;e<a.length;++e)r.write_shift(1,parseInt(a[e],16));var l=i>-1?n.slice(0,i):n;for(r.write_shift(4,2*(l.length+1)),e=0;e<l.length;++e)r.write_shift(2,l.charCodeAt(e));r.write_shift(2,0),o&8&&bh(i>-1?n.slice(i+1):"",r)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),e=0;e<a.length;++e)r.write_shift(1,parseInt(a[e],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(r.write_shift(2,c),r.write_shift(4,n.length-3*c+1),e=0;e<n.length-3*c;++e)r.write_shift(1,n.charCodeAt(e+3*c)&255);for(r.write_shift(1,0),r.write_shift(2,65535),r.write_shift(2,57005),e=0;e<6;++e)r.write_shift(4,0)}return r.slice(0,r.l)}function ma(t,r,e,n){return n||(n=oe(6)),n.write_shift(2,t),n.write_shift(2,r),n.write_shift(2,e||0),n}function nD(t,r,e){var n=e.biff>8?4:2,i=t.read_shift(n),o=t.read_shift(n,"i"),a=t.read_shift(n,"i");return[i,o,a]}function oD(t){var r=t.read_shift(2),e=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r},e:{c:i,r:e}}}function wg(t,r){return r||(r=oe(8)),r.write_shift(2,t.s.r),r.write_shift(2,t.e.r),r.write_shift(2,t.s.c),r.write_shift(2,t.e.c),r}function Q0(t,r,e){var n=1536,i=16;switch(e.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var o=oe(i);return o.write_shift(2,n),o.write_shift(2,r),i>4&&o.write_shift(2,29282),i>6&&o.write_shift(2,1997),i>8&&(o.write_shift(2,49161),o.write_shift(2,1),o.write_shift(2,1798),o.write_shift(2,0)),o}function aD(t,r){var e=!r||r.biff==8,n=oe(e?112:54);for(n.write_shift(r.biff==8?2:1,7),e&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(e?0:536870912));n.l<n.length;)n.write_shift(1,e?0:32);return n}function sD(t,r){var e=!r||r.biff>=8?2:1,n=oe(8+e*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),r.biff>=8&&n.write_shift(1,1),n.write_shift(e*t.name.length,t.name,r.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function lD(t,r){var e=oe(8);e.write_shift(4,t.Count),e.write_shift(4,t.Unique);for(var n=[],i=0;i<t.length;++i)n[i]=ZP(t[i],r);var o=ii([e].concat(n));return o.parts=[e.length].concat(n.map(function(a){return a.length})),o}function cD(){var t=oe(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function uD(t){var r=oe(18),e=1718;return t&&t.RTL&&(e|=64),r.write_shift(2,e),r.write_shift(4,0),r.write_shift(4,64),r.write_shift(4,0),r.write_shift(4,0),r}function dD(t,r){var e=t.name||"Arial",n=r&&r.biff==5,i=n?15+e.length:16+2*e.length,o=oe(i);return o.write_shift(2,(t.sz||12)*20),o.write_shift(4,0),o.write_shift(2,400),o.write_shift(4,0),o.write_shift(2,0),o.write_shift(1,e.length),n||o.write_shift(1,1),o.write_shift((n?1:2)*e.length,e,n?"sbcs":"utf16le"),o}function pD(t,r,e,n){var i=oe(10);return ma(t,r,n,i),i.write_shift(4,e),i}function fD(t,r,e,n,i){var o=!i||i.biff==8,a=oe(8+ +o+(1+o)*e.length);return ma(t,r,n,a),a.write_shift(2,e.length),o&&a.write_shift(1,1),a.write_shift((1+o)*e.length,e,o?"utf16le":"sbcs"),a}function mD(t,r,e,n){var i=e&&e.biff==5;n||(n=oe(i?3+r.length:5+2*r.length)),n.write_shift(2,t),n.write_shift(i?1:2,r.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*r.length,r,i?"sbcs":"utf16le");var o=n.length>n.l?n.slice(0,n.l):n;return o.l==null&&(o.l=o.length),o}function hD(t){var r=oe(1+t.length);return r.write_shift(1,t.length),r.write_shift(t.length,t,"sbcs"),r}function gD(t){var r=oe(3+t.length);return r.l+=2,r.write_shift(1,t.length),r.write_shift(t.length,t,"sbcs"),r}function _D(t,r){var e=r.biff==8||!r.biff?4:2,n=oe(2*e+6);return n.write_shift(e,t.s.r),n.write_shift(e,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function yh(t,r,e,n){var i=e&&e.biff==5;n||(n=oe(i?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,r<<4));var o=0;return t.numFmtId>0&&i&&(o|=1024),n.write_shift(4,o),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function xD(t){var r=oe(4);return r.l+=2,r.write_shift(1,t.numFmtId),r.l++,r}function Sg(t){var r=oe(12);return r.l++,r.write_shift(1,t.numFmtId),r.l+=10,r}var vD=Sg;function bD(t){var r=oe(8);return r.write_shift(4,0),r.write_shift(2,t[0]?t[0]+1:0),r.write_shift(2,t[1]?t[1]+1:0),r}function _0(t,r,e,n,i,o){var a=oe(8);return ma(t,r,n,a),bg(e,o,a),a}function yD(t,r,e,n){var i=oe(14);return ma(t,r,n,i),fa(e,i),i}function CD(t,r,e){if(e.biff<8||!(e.biff>8)&&r==t[t.l]+(t[t.l+1]==3?1:0)+1)return Ch(t,r,e);for(var n=[],i=t.l+r,o=t.read_shift(e.biff>8?4:2);o--!==0;)n.push(nD(t,e.biff>8?12:6,e));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function Ch(t,r,e){t[t.l+1]==3&&t[t.l]++;var n=yg(t,r,e);return n.charCodeAt(0)==3?n.slice(1):n}function x0(t,r,e,n){var i=oe(6+(n||t.length));return i.write_shift(2,r),i.write_shift(2,e),i.write_shift(2,n||t.length),i.write_shift(t.length,t,"sbcs"),i}function wD(t){var r=oe(2+t.length*8);r.write_shift(2,t.length);for(var e=0;e<t.length;++e)wg(t[e],r);return r}function SD(t){var r=oe(24),e=Nr(t[0]);r.write_shift(2,e.r),r.write_shift(2,e.r),r.write_shift(2,e.c),r.write_shift(2,e.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)r.write_shift(1,parseInt(n[i],16));return ii([r,iD(t[1])])}function kD(t){var r=t[1].Tooltip,e=oe(10+2*(r.length+1));e.write_shift(2,2048);var n=Nr(t[0]);e.write_shift(2,n.r),e.write_shift(2,n.r),e.write_shift(2,n.c),e.write_shift(2,n.c);for(var i=0;i<r.length;++i)e.write_shift(2,r.charCodeAt(i));return e.write_shift(2,0),e}function TD(t){return t||(t=oe(4)),t.write_shift(2,1),t.write_shift(2,1),t}function ED(t,r,e){if(!e.cellStyles)return lo(t,r);var n=e&&e.biff>=12?4:2,i=t.read_shift(n),o=t.read_shift(n),a=t.read_shift(n),l=t.read_shift(n),c=t.read_shift(2);n==2&&(t.l+=2);var f={s:i,e:o,w:a,ixfe:l,flags:c};return(e.biff>=5||!e.biff)&&(f.level=c>>8&7),f}function ID(t,r){var e=oe(12);e.write_shift(2,r),e.write_shift(2,r),e.write_shift(2,t.width*256),e.write_shift(2,0);var n=0;return t.hidden&&(n|=1),e.write_shift(1,n),n=t.level||0,e.write_shift(1,n),e.write_shift(2,0),e}function FD(t){for(var r=oe(2*t),e=0;e<t;++e)r.write_shift(2,e+1);return r}function Vs(t,r,e,n,i){return t||(t=oe(7)),t.write_shift(2,r),t.write_shift(2,e),t.write_shift(1,n||0),t.write_shift(1,i||0),t.write_shift(1,0),t}function AD(t,r,e,n,i){var o=oe(15);return Vs(o,t,r,n||0,i||0),o.write_shift(8,e,"f"),o}function PD(t,r,e,n,i){var o=oe(9);return Vs(o,t,r,n||0,i||0),o.write_shift(2,e),o}var DD=(function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=M0({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function e(l,c){var f=[],m=ua(1);switch(c.type){case"base64":m=fn(zo(l));break;case"binary":m=fn(l);break;case"buffer":case"array":m=l;break}ji(m,0);var C=m.read_shift(1),y=!!(C&136),k=!1,S=!1;switch(C){case 2:break;case 3:break;case 48:k=!0,y=!0;break;case 49:k=!0,y=!0;break;case 131:break;case 139:break;case 140:S=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+C.toString(16))}var M=0,E=521;C==2&&(M=m.read_shift(2)),m.l+=3,C!=2&&(M=m.read_shift(4)),M>1048576&&(M=1e6),C!=2&&(E=m.read_shift(2));var A=m.read_shift(2),x=c.codepage||1252;C!=2&&(m.l+=16,m.read_shift(1),m[m.l]!==0&&(x=t[m[m.l]]),m.l+=1,m.l+=2),S&&(m.l+=36);for(var F=[],L={},K=Math.min(m.length,C==2?521:E-10-(k?264:0)),te=S?32:11;m.l<K&&m[m.l]!=13;)switch(L={},L.name=(typeof qt<"u"?qt.utils.decode(x,m.slice(m.l,m.l+te)):da(m.slice(m.l,m.l+te))).replace(/[\u0000\r\n][\S\s]*$/g,""),m.l+=te,L.type=String.fromCharCode(m.read_shift(1)),C!=2&&!S&&(L.offset=m.read_shift(4)),L.len=m.read_shift(1),C==2&&(L.offset=m.read_shift(2)),L.dec=m.read_shift(1),L.name.length&&F.push(L),C!=2&&(m.l+=S?13:14),L.type){case"B":(!k||L.len!=8)&&c.WTF&&console.log("Skipping "+L.name+":"+L.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+L.name+":"+L.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+L.type)}if(m[m.l]!==13&&(m.l=E-1),m.read_shift(1)!==13)throw new Error("DBF Terminator not found "+m.l+" "+m[m.l]);m.l=E;var V=0,R=0;for(f[0]=[],R=0;R!=F.length;++R)f[0][R]=F[R].name;for(;M-- >0;){if(m[m.l]===42){m.l+=A;continue}for(++m.l,f[++V]=[],R=0,R=0;R!=F.length;++R){var q=m.slice(m.l,m.l+F[R].len);m.l+=F[R].len,ji(q,0);var ie=typeof qt<"u"?qt.utils.decode(x,q):da(q);switch(F[R].type){case"C":ie.trim().length&&(f[V][R]=ie.replace(/([^\s])\s+$/,"$1"));break;case"D":ie.length===8?(f[V][R]=new Date(Date.UTC(+ie.slice(0,4),+ie.slice(4,6)-1,+ie.slice(6,8),0,0,0,0)),c&&c.UTC||(f[V][R]=Qa(f[V][R]))):f[V][R]=ie;break;case"F":f[V][R]=parseFloat(ie.trim());break;case"+":case"I":f[V][R]=S?q.read_shift(-4,"i")^2147483648:q.read_shift(4,"i");break;case"L":switch(ie.trim().toUpperCase()){case"Y":case"T":f[V][R]=!0;break;case"N":case"F":f[V][R]=!1;break;case"":case"\0":case"?":break;default:throw new Error("DBF Unrecognized L:|"+ie+"|")}break;case"M":if(!y)throw new Error("DBF Unexpected MEMO for type "+C.toString(16));f[V][R]="##MEMO##"+(S?parseInt(ie.trim(),10):q.read_shift(4));break;case"N":ie=ie.replace(/\u0000/g,"").trim(),ie&&ie!="."&&(f[V][R]=+ie||0);break;case"@":f[V][R]=new Date(q.read_shift(-8,"f")-621356832e5);break;case"T":{var de=q.read_shift(4),ye=q.read_shift(4);if(de==0&&ye==0)break;f[V][R]=new Date((de-2440588)*864e5+ye),c&&c.UTC||(f[V][R]=Qa(f[V][R]))}break;case"Y":f[V][R]=q.read_shift(4,"i")/1e4+q.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[V][R]=-q.read_shift(-8,"f");break;case"B":if(k&&F[R].len==8){f[V][R]=q.read_shift(8,"f");break}case"G":case"P":q.l+=F[R].len;break;case"0":if(F[R].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+F[R].type)}}}if(C!=2&&m.l<m.length&&m[m.l++]!=26)throw new Error("DBF EOF Marker missing "+(m.l-1)+" of "+m.length+" "+m[m.l-1].toString(16));return c&&c.sheetRows&&(f=f.slice(0,c.sheetRows)),c.DBF=F,f}function n(l,c){var f=c||{};f.dateNF||(f.dateNF="yyyymmdd");var m=rs(e(l,f),f);return m["!cols"]=f.DBF.map(function(C){return{wch:C.len,DBF:C}}),delete f.DBF,m}function i(l,c){try{var f=ts(n(l,c),c);return f.bookType="dbf",f}catch(m){if(c&&c.WTF)throw m}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function a(l,c){if(!l["!ref"])throw new Error("Cannot export empty sheet to DBF");var f=c||{},m=hn;if(+f.codepage>=0&&As(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var C=Bi(),y=D0(l,{header:1,raw:!0,cellDates:!0}),k=y[0],S=y.slice(1),M=l["!cols"]||[],E=0,A=0,x=0,F=1;for(E=0;E<k.length;++E){if(((M[E]||{}).DBF||{}).name){k[E]=M[E].DBF.name,++x;continue}if(k[E]!=null){if(++x,typeof k[E]=="number"&&(k[E]=k[E].toString(10)),typeof k[E]!="string")throw new Error("DBF Invalid column name "+k[E]+" |"+typeof k[E]+"|");if(k.indexOf(k[E])!==E){for(A=0;A<1024;++A)if(k.indexOf(k[E]+"_"+A)==-1){k[E]+="_"+A;break}}}}var L=Fr(l["!ref"]),K=[],te=[],V=[];for(E=0;E<=L.e.c-L.s.c;++E){var R="",q="",ie=0,de=[];for(A=0;A<S.length;++A)S[A][E]!=null&&de.push(S[A][E]);if(de.length==0||k[E]==null){K[E]="?";continue}for(A=0;A<de.length;++A){switch(typeof de[A]){case"number":q="B";break;case"string":q="C";break;case"boolean":q="L";break;case"object":q=de[A]instanceof Date?"D":"C";break;default:q="C"}ie=Math.max(ie,(typeof qt<"u"&&typeof de[A]=="string"?qt.utils.encode(qa,de[A]):String(de[A])).length),R=R&&R!=q?"C":q}ie>250&&(ie=250),q=((M[E]||{}).DBF||{}).type,q=="C"&&M[E].DBF.len>ie&&(ie=M[E].DBF.len),R=="B"&&q=="N"&&(R="N",V[E]=M[E].DBF.dec,ie=M[E].DBF.len),te[E]=R=="C"||q=="N"?ie:o[R]||0,F+=te[E],K[E]=R}var ye=C.next(32);for(ye.write_shift(4,318902576),ye.write_shift(4,S.length),ye.write_shift(2,296+32*x),ye.write_shift(2,F),E=0;E<4;++E)ye.write_shift(4,0);var _t=+r[hn]||3;for(ye.write_shift(4,0|_t<<8),t[_t]!=+f.codepage&&(f.codepage&&console.error("DBF Unsupported codepage "+hn+", using 1252"),hn=1252),E=0,A=0;E<k.length;++E)if(k[E]!=null){var St=C.next(32),st=(k[E].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);St.write_shift(1,st,"sbcs"),St.write_shift(1,K[E]=="?"?"C":K[E],"sbcs"),St.write_shift(4,A),St.write_shift(1,te[E]||o[K[E]]||0),St.write_shift(1,V[E]||0),St.write_shift(1,2),St.write_shift(4,0),St.write_shift(1,0),St.write_shift(4,0),St.write_shift(4,0),A+=te[E]||o[K[E]]||0}var or=C.next(264);for(or.write_shift(4,13),E=0;E<65;++E)or.write_shift(4,0);for(E=0;E<S.length;++E){var ot=C.next(F);for(ot.write_shift(1,0),A=0;A<k.length;++A)if(k[A]!=null)switch(K[A]){case"L":ot.write_shift(1,S[E][A]==null?63:S[E][A]?84:70);break;case"B":ot.write_shift(8,S[E][A]||0,"f");break;case"N":var yr="0";for(typeof S[E][A]=="number"&&(yr=S[E][A].toFixed(V[A]||0)),yr.length>te[A]&&(yr=yr.slice(0,te[A])),x=0;x<te[A]-yr.length;++x)ot.write_shift(1,32);ot.write_shift(1,yr,"sbcs");break;case"D":S[E][A]?(ot.write_shift(4,("0000"+S[E][A].getFullYear()).slice(-4),"sbcs"),ot.write_shift(2,("00"+(S[E][A].getMonth()+1)).slice(-2),"sbcs"),ot.write_shift(2,("00"+S[E][A].getDate()).slice(-2),"sbcs")):ot.write_shift(8,"00000000","sbcs");break;case"C":var Vr=ot.l,Cr=String(S[E][A]!=null?S[E][A]:"").slice(0,te[A]);for(ot.write_shift(1,Cr,"cpstr"),Vr+=te[A]-ot.l,x=0;x<Vr;++x)ot.write_shift(1,32);break}}return hn=m,C.next(1).write_shift(1,26),C.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}})(),OD=(function(){var t={AA:"\xC0",BA:"\xC1",CA:"\xC2",DA:195,HA:"\xC4",JA:197,AE:"\xC8",BE:"\xC9",CE:"\xCA",HE:"\xCB",AI:"\xCC",BI:"\xCD",CI:"\xCE",HI:"\xCF",AO:"\xD2",BO:"\xD3",CO:"\xD4",DO:213,HO:"\xD6",AU:"\xD9",BU:"\xDA",CU:"\xDB",HU:"\xDC",Aa:"\xE0",Ba:"\xE1",Ca:"\xE2",Da:227,Ha:"\xE4",Ja:229,Ae:"\xE8",Be:"\xE9",Ce:"\xEA",He:"\xEB",Ai:"\xEC",Bi:"\xED",Ci:"\xEE",Hi:"\xEF",Ao:"\xF2",Bo:"\xF3",Co:"\xF4",Do:245,Ho:"\xF6",Au:"\xF9",Bu:"\xFA",Cu:"\xFB",Hu:"\xFC",KC:"\xC7",Kc:"\xE7",q:"\xE6",z:"\u0153",a:"\xC6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+ni(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1").replace("{","\\{")+"|\\|)","gm");try{r=new RegExp("\x1BN("+ni(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm")}catch{}var e=function(k,S){var M=t[S];return typeof M=="number"?Hm(M):M},n=function(k,S,M){var E=S.charCodeAt(0)-32<<4|M.charCodeAt(0)-48;return E==59?k:Hm(E)};t["|"]=254;var i=function(k){return k.replace(/\n/g,"\x1B :").replace(/\r/g,"\x1B =")};function o(k,S){switch(S.type){case"base64":return a(zo(k),S);case"binary":return a(k,S);case"buffer":return a(rr&&Buffer.isBuffer(k)?k.toString("binary"):da(k),S);case"array":return a(R0(k),S)}throw new Error("Unrecognized type "+S.type)}function a(k,S){var M=k.split(/[\n\r]+/),E=-1,A=-1,x=0,F=0,L=[],K=[],te=null,V={},R=[],q=[],ie=[],de=0,ye,_t={Workbook:{WBProps:{},Names:[]}};for(+S.codepage>=0&&As(+S.codepage);x!==M.length;++x){de=0;var St=M[x].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(r,e),st=St.replace(/;;/g,"\0").split(";").map(function(J){return J.replace(/\u0000/g,";")}),or=st[0],ot;if(St.length>0)switch(or){case"ID":break;case"E":break;case"B":break;case"O":for(F=1;F<st.length;++F)switch(st[F].charAt(0)){case"V":{var yr=parseInt(st[F].slice(1),10);yr>=1&&yr<=4&&(_t.Workbook.WBProps.date1904=!0)}break}break;case"W":break;case"P":switch(st[1].charAt(0)){case"P":K.push(St.slice(3).replace(/;;/g,";"));break}break;case"NN":{var Vr={Sheet:0};for(F=1;F<st.length;++F)switch(st[F].charAt(0)){case"N":Vr.Name=st[F].slice(1);break;case"E":Vr.Ref=(S&&S.sheet||"Sheet1")+"!"+Eh(st[F].slice(1));break}_t.Workbook.Names.push(Vr)}break;case"C":var Cr=!1,gi=!1,Ft=!1,At=!1,zt=-1,Ut=-1,Wt="",Rt="z",G="";for(F=1;F<st.length;++F)switch(st[F].charAt(0)){case"A":G=st[F].slice(1);break;case"X":A=parseInt(st[F].slice(1),10)-1,gi=!0;break;case"Y":for(E=parseInt(st[F].slice(1),10)-1,gi||(A=0),ye=L.length;ye<=E;++ye)L[ye]=[];break;case"K":ot=st[F].slice(1),ot.charAt(0)==='"'?(ot=ot.slice(1,ot.length-1),Rt="s"):ot==="TRUE"||ot==="FALSE"?(ot=ot==="TRUE",Rt="b"):ot.charAt(0)=="#"&&so[ot]!=null?(Rt="e",ot=so[ot]):isNaN(So(ot))||(ot=So(ot),Rt="n",te!==null&&pa(te)&&S.cellDates&&(ot=Ha(_t.Workbook.WBProps.date1904?ot+1462:ot),Rt=typeof ot=="number"?"n":"d")),typeof qt<"u"&&typeof ot=="string"&&(S||{}).type!="string"&&(S||{}).codepage&&(ot=qt.utils.decode(S.codepage,ot)),Cr=!0;break;case"E":At=!0,Wt=Eh(st[F].slice(1),{r:E,c:A});break;case"S":Ft=!0;break;case"G":break;case"R":zt=parseInt(st[F].slice(1),10)-1;break;case"C":Ut=parseInt(st[F].slice(1),10)-1;break;default:if(S&&S.WTF)throw new Error("SYLK bad record "+St)}if(Cr&&(L[E][A]?(L[E][A].t=Rt,L[E][A].v=ot):L[E][A]={t:Rt,v:ot},te&&(L[E][A].z=te),S.cellText!==!1&&te&&(L[E][A].w=To(L[E][A].z,L[E][A].v,{date1904:_t.Workbook.WBProps.date1904})),te=null),Ft){if(At)throw new Error("SYLK shared formula cannot have own formula");var re=zt>-1&&L[zt][Ut];if(!re||!re[1])throw new Error("SYLK shared formula cannot find base");Wt=BO(re[1],{r:E-zt,c:A-Ut})}Wt&&(L[E][A]?L[E][A].f=Wt:L[E][A]={t:"n",f:Wt}),G&&(L[E][A]||(L[E][A]={t:"z"}),L[E][A].c=[{a:"SheetJSYLK",t:G}]);break;case"F":var Q=0;for(F=1;F<st.length;++F)switch(st[F].charAt(0)){case"X":A=parseInt(st[F].slice(1),10)-1,++Q;break;case"Y":for(E=parseInt(st[F].slice(1),10)-1,ye=L.length;ye<=E;++ye)L[ye]=[];break;case"M":de=parseInt(st[F].slice(1),10)/20;break;case"F":break;case"G":break;case"P":te=K[parseInt(st[F].slice(1),10)];break;case"S":break;case"D":break;case"N":break;case"W":for(ie=st[F].slice(1).split(" "),ye=parseInt(ie[0],10);ye<=parseInt(ie[1],10);++ye)de=parseInt(ie[2],10),q[ye-1]=de===0?{hidden:!0}:{wch:de};break;case"C":A=parseInt(st[F].slice(1),10)-1,q[A]||(q[A]={});break;case"R":E=parseInt(st[F].slice(1),10)-1,R[E]||(R[E]={}),de>0?(R[E].hpt=de,R[E].hpx=Ig(de)):de===0&&(R[E].hidden=!0);break;default:if(S&&S.WTF)throw new Error("SYLK bad record "+St)}Q<1&&(te=null);break;default:if(S&&S.WTF)throw new Error("SYLK bad record "+St)}}return R.length>0&&(V["!rows"]=R),q.length>0&&(V["!cols"]=q),q.forEach(function(J){Y0(J)}),S&&S.sheetRows&&(L=L.slice(0,S.sheetRows)),[L,V,_t]}function l(k,S){var M=o(k,S),E=M[0],A=M[1],x=M[2],F=Ri(S);F.date1904=(((x||{}).Workbook||{}).WBProps||{}).date1904;var L=rs(E,F);ni(A).forEach(function(te){L[te]=A[te]});var K=ts(L,S);return ni(x).forEach(function(te){K[te]=x[te]}),K.bookType="sylk",K}function c(k,S,M,E,A,x){var F="C;Y"+(M+1)+";X"+(E+1)+";K";switch(k.t){case"n":F+=isFinite(k.v)?k.v||0:$i[isNaN(k.v)?36:7],k.f&&!k.F&&(F+=";E"+fc(k.f,{r:M,c:E}));break;case"b":F+=k.v?"TRUE":"FALSE";break;case"e":F+=k.w||$i[k.v]||k.v;break;case"d":F+=Ci(on(k.v,x),x);break;case"s":F+='"'+(k.v==null?"":String(k.v)).replace(/"/g,"").replace(/;/g,";;")+'"';break}return F}function f(k,S,M){var E="C;Y"+(S+1)+";X"+(M+1)+";A";return E+=i(k.map(function(A){return A.t}).join("")),E}function m(k,S){S.forEach(function(M,E){var A="F;W"+(E+1)+" "+(E+1)+" ";M.hidden?A+="0":(typeof M.width=="number"&&!M.wpx&&(M.wpx=Ql(M.width)),typeof M.wpx=="number"&&!M.wch&&(M.wch=Yl(M.wpx)),typeof M.wch=="number"&&(A+=Math.round(M.wch))),A.charAt(A.length-1)!=" "&&k.push(A)})}function C(k,S){S.forEach(function(M,E){var A="F;";M.hidden?A+="M0;":M.hpt?A+="M"+20*M.hpt+";":M.hpx&&(A+="M"+20*Zl(M.hpx)+";"),A.length>2&&k.push(A+"R"+(E+1))})}function y(k,S,M){S||(S={}),S._formats=["General"];var E=["ID;PSheetJS;N;E"],A=[],x=Fr(k["!ref"]||"A1"),F,L=k["!data"]!=null,K=`\r
`,te=(((M||{}).Workbook||{}).WBProps||{}).date1904,V="General";E.push("P;PGeneral");var R=x.s.r,q=x.s.c,ie=[];if(k["!ref"]){for(R=x.s.r;R<=x.e.r;++R)if(!(L&&!k["!data"][R])){for(ie=[],q=x.s.c;q<=x.e.c;++q)F=L?k["!data"][R][q]:k[lr(q)+dr(R)],!(!F||!F.c)&&ie.push(f(F.c,R,q));ie.length&&A.push(ie.join(K))}}if(k["!ref"]){for(R=x.s.r;R<=x.e.r;++R)if(!(L&&!k["!data"][R])){for(ie=[],q=x.s.c;q<=x.e.c;++q)if(F=L?k["!data"][R][q]:k[lr(q)+dr(R)],!(!F||F.v==null&&(!F.f||F.F))){if((F.z||(F.t=="d"?Ir[14]:"General"))!=V){var de=S._formats.indexOf(F.z);de==-1&&(S._formats.push(F.z),de=S._formats.length-1,E.push("P;P"+F.z.replace(/;/g,";;"))),ie.push("F;P"+de+";Y"+(R+1)+";X"+(q+1))}ie.push(c(F,k,R,q,S,te))}A.push(ie.join(K))}}return E.push("F;P0;DG0G8;M255"),k["!cols"]&&m(E,k["!cols"]),k["!rows"]&&C(E,k["!rows"]),k["!ref"]&&E.push("B;Y"+(x.e.r-x.s.r+1)+";X"+(x.e.c-x.s.c+1)+";D"+[x.s.c,x.s.r,x.e.c,x.e.r].join(" ")),E.push("O;L;D;B"+(te?";V4":"")+";K47;G100 0.001"),delete S._formats,E.join(K)+K+A.join(K)+K+"E"+K}return{to_workbook:l,from_sheet:y}})(),BD=(function(){function t(l,c){switch(c.type){case"base64":return r(zo(l),c);case"binary":return r(l,c);case"buffer":return r(rr&&Buffer.isBuffer(l)?l.toString("binary"):da(l),c);case"array":return r(R0(l),c)}throw new Error("Unrecognized type "+c.type)}function r(l,c){for(var f=l.split(`
`),m=-1,C=-1,y=0,k=[];y!==f.length;++y){if(f[y].trim()==="BOT"){k[++m]=[],C=0;continue}if(!(m<0)){var S=f[y].trim().split(","),M=S[0],E=S[1];++y;for(var A=f[y]||"";(A.match(/["]/g)||[]).length&1&&y<f.length-1;)A+=`
`+f[++y];switch(A=A.trim(),+M){case-1:if(A==="BOT"){k[++m]=[],C=0;continue}else if(A!=="EOD")throw new Error("Unrecognized DIF special command "+A);break;case 0:A==="TRUE"?k[m][C]=!0:A==="FALSE"?k[m][C]=!1:isNaN(So(E))?isNaN(Kl(E).getDate())?k[m][C]=E:(k[m][C]=on(E),c&&c.UTC||(k[m][C]=Qa(k[m][C]))):k[m][C]=So(E),++C;break;case 1:A=A.slice(1,A.length-1),A=A.replace(/""/g,'"'),$m&&A&&A.match(/^=".*"$/)&&(A=A.slice(2,-1)),k[m][C++]=A!==""?A:null;break}if(A==="EOD")break}}return c&&c.sheetRows&&(k=k.slice(0,c.sheetRows)),k}function e(l,c){return rs(t(l,c),c)}function n(l,c){var f=ts(e(l,c),c);return f.bookType="dif",f}function i(l,c){return"0,"+String(l)+`\r
`+c}function o(l){return`1,0\r
"`+l.replace(/"/g,'""')+'"'}function a(l){var c=$m;if(!l["!ref"])throw new Error("Cannot export empty sheet to DIF");for(var f=Fr(l["!ref"]),m=l["!data"]!=null,C=[`TABLE\r
0,1\r
"sheetjs"\r
`,`VECTORS\r
0,`+(f.e.r-f.s.r+1)+`\r
""\r
`,`TUPLES\r
0,`+(f.e.c-f.s.c+1)+`\r
""\r
`,`DATA\r
0,0\r
""\r
`],y=f.s.r;y<=f.e.r;++y){for(var k=m?l["!data"][y]:[],S=`-1,0\r
BOT\r
`,M=f.s.c;M<=f.e.c;++M){var E=m?k&&k[M]:l[Hr({r:y,c:M})];if(E==null){S+=`1,0\r
""\r
`;continue}switch(E.t){case"n":c?E.w!=null?S+="0,"+E.w+`\r
V`:E.v!=null?S+=i(E.v,"V"):E.f!=null&&!E.F?S+=o("="+E.f):S+=`1,0\r
""`:E.v==null?S+=`1,0\r
""`:S+=i(E.v,"V");break;case"b":S+=E.v?i(1,"TRUE"):i(0,"FALSE");break;case"s":S+=o(!c||isNaN(+E.v)?E.v:'="'+E.v+'"');break;case"d":E.w||(E.w=To(E.z||Ir[14],Ci(on(E.v)))),c?S+=i(E.w,"V"):S+=o(E.w);break;default:S+=`1,0\r
""`}S+=`\r
`}C.push(S)}return C.join("")+`-1,0\r
EOD`}return{to_workbook:n,to_sheet:e,from_sheet:a}})(),kg=(function(){function t(C){return C.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(C){return C.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function e(C,y){for(var k=C.split(`
`),S=-1,M=-1,E=0,A=[];E!==k.length;++E){var x=k[E].trim().split(":");if(x[0]==="cell"){var F=Nr(x[1]);if(A.length<=F.r)for(S=A.length;S<=F.r;++S)A[S]||(A[S]=[]);switch(S=F.r,M=F.c,x[2]){case"t":A[S][M]=t(x[3]);break;case"v":A[S][M]=+x[3];break;case"vtf":var L=x[x.length-1];case"vtc":switch(x[3]){case"nl":A[S][M]=!!+x[4];break;default:A[S][M]=x[x.length-1].charAt(0)=="#"?{t:"e",v:so[x[x.length-1]]}:+x[4];break}x[2]=="vtf"&&(A[S][M]=[A[S][M],L])}}}return y&&y.sheetRows&&(A=A.slice(0,y.sheetRows)),A}function n(C,y){return rs(e(C,y),y)}function i(C,y){return ts(n(C,y),y)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function f(C){if(!C||!C["!ref"])return"";for(var y=[],k=[],S,M="",E=yi(C["!ref"]),A=C["!data"]!=null,x=E.s.r;x<=E.e.r;++x)for(var F=E.s.c;F<=E.e.c;++F)if(M=Hr({r:x,c:F}),S=A?(C["!data"][x]||[])[F]:C[M],!(!S||S.v==null||S.t==="z")){switch(k=["cell",M,"t"],S.t){case"s":k.push(r(S.v));break;case"b":k[2]="vt"+(S.f?"f":"c"),k[3]="nl",k[4]=S.v?"1":"0",k[5]=r(S.f||(S.v?"TRUE":"FALSE"));break;case"d":var L=Ci(on(S.v));k[2]="vtc",k[3]="nd",k[4]=""+L,k[5]=S.w||To(S.z||Ir[14],L);break;case"n":isFinite(S.v)?S.f?(k[2]="vtf",k[3]="n",k[4]=S.v,k[5]=r(S.f)):(k[2]="v",k[3]=S.v):(k[2]="vt"+(S.f?"f":"c"),k[3]="e"+$i[isNaN(S.v)?36:7],k[4]="0",k[5]=S.f||k[3].slice(1),k[6]="e",k[7]=k[3].slice(1));break;case"e":continue}y.push(k.join(":"))}return y.push("sheet:c:"+(E.e.c-E.s.c+1)+":r:"+(E.e.r-E.s.r+1)+":tvf:1"),y.push("valueformat:1:text-wiki"),y.join(`
`)}function m(C){return[o,a,l,a,f(C),c].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:m}})(),MD=(function(){function t(m,C,y,k,S){S.raw?C[y][k]=m:m===""||(m==="TRUE"?C[y][k]=!0:m==="FALSE"?C[y][k]=!1:isNaN(So(m))?isNaN(Kl(m).getDate())?m.charCodeAt(0)==35&&so[m]!=null?C[y][k]={t:"e",v:so[m],w:m}:C[y][k]=m:C[y][k]=on(m):C[y][k]=So(m))}function r(m,C){var y=C||{},k=[];if(!m||m.length===0)return k;for(var S=m.split(/[\r\n]/),M=S.length-1;M>=0&&S[M].length===0;)--M;for(var E=10,A=0,x=0;x<=M;++x)A=S[x].indexOf(" "),A==-1?A=S[x].length:A++,E=Math.max(E,A);for(x=0;x<=M;++x){k[x]=[];var F=0;for(t(S[x].slice(0,E).trim(),k,x,F,y),F=1;F<=(S[x].length-E)/10+1;++F)t(S[x].slice(E+(F-1)*10,E+F*10).trim(),k,x,F,y)}return y.sheetRows&&(k=k.slice(0,y.sheetRows)),k}var e={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(m){for(var C={},y=!1,k=0,S=0;k<m.length;++k)(S=m.charCodeAt(k))==34?y=!y:!y&&S in e&&(C[S]=(C[S]||0)+1);S=[];for(k in C)Object.prototype.hasOwnProperty.call(C,k)&&S.push([C[k],k]);if(!S.length){C=n;for(k in C)Object.prototype.hasOwnProperty.call(C,k)&&S.push([C[k],k])}return S.sort(function(M,E){return M[0]-E[0]||n[M[1]]-n[E[1]]}),e[S.pop()[1]]||44}function o(m,C){var y=C||{},k="";ao!=null&&y.dense==null&&(y.dense=ao);var S={};y.dense&&(S["!data"]=[]);var M={s:{c:0,r:0},e:{c:0,r:0}};m.slice(0,4)=="sep="?m.charCodeAt(5)==13&&m.charCodeAt(6)==10?(k=m.charAt(4),m=m.slice(7)):m.charCodeAt(5)==13||m.charCodeAt(5)==10?(k=m.charAt(4),m=m.slice(6)):k=i(m.slice(0,1024)):y&&y.FS?k=y.FS:k=i(m.slice(0,1024));var E=0,A=0,x=0,F=0,L=0,K=k.charCodeAt(0),te=!1,V=0,R=m.charCodeAt(0),q=y.dateNF!=null?VA(y.dateNF):null;function ie(){var de=m.slice(F,L);de.slice(-1)=="\r"&&(de=de.slice(0,-1));var ye={};if(de.charAt(0)=='"'&&de.charAt(de.length-1)=='"'&&(de=de.slice(1,-1).replace(/""/g,'"')),y.cellText!==!1&&(ye.w=de),de.length===0)ye.t="z";else if(y.raw)ye.t="s",ye.v=de;else if(de.trim().length===0)ye.t="s",ye.v=de;else if(de.charCodeAt(0)==61)de.charCodeAt(1)==34&&de.charCodeAt(de.length-1)==34?(ye.t="s",ye.v=de.slice(2,-1).replace(/""/g,'"')):MO(de)?(ye.t="s",ye.f=de.slice(1),ye.v=de):(ye.t="s",ye.v=de);else if(de=="TRUE")ye.t="b",ye.v=!0;else if(de=="FALSE")ye.t="b",ye.v=!1;else if(!isNaN(x=So(de)))ye.t="n",ye.v=x;else if(!isNaN((x=Kl(de)).getDate())||q&&de.match(q)){if(ye.z=y.dateNF||Ir[14],q&&de.match(q)){var _t=zA(de,y.dateNF,de.match(q)||[]);x=on(_t),y&&y.UTC===!1&&(x=Qa(x))}else y&&y.UTC===!1?x=Qa(x):y.cellText!==!1&&y.dateNF&&(ye.w=To(ye.z,x));y.cellDates?(ye.t="d",ye.v=x):(ye.t="n",ye.v=Ci(x)),y.cellNF||delete ye.z}else de.charCodeAt(0)==35&&so[de]!=null?(ye.t="e",ye.w=de,ye.v=so[de]):(ye.t="s",ye.v=de);if(ye.t=="z"||(y.dense?(S["!data"][E]||(S["!data"][E]=[]),S["!data"][E][A]=ye):S[Hr({c:A,r:E})]=ye),F=L+1,R=m.charCodeAt(F),M.e.c<A&&(M.e.c=A),M.e.r<E&&(M.e.r=E),V==K)++A;else if(A=0,++E,y.sheetRows&&y.sheetRows<=E)return!0}e:for(;L<m.length;++L)switch(V=m.charCodeAt(L)){case 34:R===34&&(te=!te);break;case 13:if(te)break;m.charCodeAt(L+1)==10&&++L;case K:case 10:if(!te&&ie())break e;break;default:break}return L-F>0&&ie(),S["!ref"]=oi(M),S}function a(m,C){return!(C&&C.PRN)||C.FS||m.slice(0,4)=="sep="||m.indexOf("	")>=0||m.indexOf(",")>=0||m.indexOf(";")>=0?o(m,C):rs(r(m,C),C)}function l(m,C){var y="",k=C.type=="string"?[0,0,0,0]:lR(m,C);switch(C.type){case"base64":y=zo(m);break;case"binary":y=m;break;case"buffer":C.codepage==65001?y=m.toString("utf8"):C.codepage&&typeof qt<"u"?y=qt.utils.decode(C.codepage,m):y=rr&&Buffer.isBuffer(m)?m.toString("binary"):da(m);break;case"array":y=R0(m);break;case"string":y=m;break;default:throw new Error("Unrecognized type "+C.type)}return k[0]==239&&k[1]==187&&k[2]==191?y=$a(y.slice(3)):C.type!="string"&&C.type!="buffer"&&C.codepage==65001?y=$a(y):C.type=="binary"&&typeof qt<"u"&&C.codepage&&(y=qt.utils.decode(C.codepage,qt.utils.encode(28591,y))),y.slice(0,19)=="socialcalc:version:"?kg.to_sheet(C.type=="string"?y:$a(y),C):a(y,C)}function c(m,C){return ts(l(m,C),C)}function f(m){var C=[];if(!m["!ref"])return"";for(var y=Fr(m["!ref"]),k,S=m["!data"]!=null,M=y.s.r;M<=y.e.r;++M){for(var E=[],A=y.s.c;A<=y.e.c;++A){var x=Hr({r:M,c:A});if(k=S?(m["!data"][M]||[])[A]:m[x],!k||k.v==null){E.push("          ");continue}for(var F=(k.w||(Eo(k),k.w)||"").slice(0,10);F.length<10;)F+=" ";E.push(F+(A===0?" ":""))}C.push(E.join(""))}return C.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:f}})();var wh=(function(){function t(G,re,Q){if(G){ji(G,G.l||0);for(var J=Q.Enum||At;G.l<G.length;){var Ce=G.read_shift(2),qe=J[Ce]||J[65535],pt=G.read_shift(2),tt=G.l+pt,Re=qe.f&&qe.f(G,pt,Q);if(G.l=tt,re(Re,qe,Ce))return}}}function r(G,re){switch(re.type){case"base64":return n(fn(zo(G)),re);case"binary":return n(fn(G),re);case"buffer":case"array":return n(G,re)}throw"Unsupported type "+re.type}var e=["mmmm","dd-mmm-yyyy","dd-mmm","mmm-yyyy","@","mm/dd","hh:mm:ss AM/PM","hh:mm AM/PM","mm/dd/yyyy","mm/dd","hh:mm:ss","hh:mm"];function n(G,re){if(!G)return G;var Q=re||{};ao!=null&&Q.dense==null&&(Q.dense=ao);var J={},Ce="Sheet1",qe="",pt=0,tt={},Re=[],jt=[],Lt=[];Q.dense&&(Lt=J["!data"]=[]);var Qe={s:{r:0,c:0},e:{r:0,c:0}},ar=Q.sheetRows||0,cr={};if(G[4]==81&&G[5]==80&&G[6]==87)return Rt(G,re);if(G[2]==0&&(G[3]==8||G[3]==9)&&G.length>=16&&G[14]==5&&G[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(G[2]==2)Q.Enum=At,t(G,function(We,_n,wi){switch(wi){case 0:Q.vers=We,We>=4096&&(Q.qpro=!0);break;case 255:Q.vers=We,Q.works=!0;break;case 6:Qe=We;break;case 204:We&&(qe=We);break;case 222:qe=We;break;case 15:case 51:(!Q.qpro&&!Q.works||wi==51)&&We[1].v.charCodeAt(0)<48&&(We[1].v=We[1].v.slice(1)),(Q.works||Q.works2)&&(We[1].v=We[1].v.replace(/\r\n/g,`
`));case 13:case 14:case 16:(We[2]&112)==112&&(We[2]&15)>1&&(We[2]&15)<15&&(We[1].z=Q.dateNF||e[(We[2]&15)-1]||Ir[14],Q.cellDates&&(We[1].v=Ha(We[1].v),We[1].t=typeof We[1].v=="number"?"n":"d")),Q.qpro&&We[3]>pt&&(J["!ref"]=oi(Qe),tt[Ce]=J,Re.push(Ce),J={},Q.dense&&(Lt=J["!data"]=[]),Qe={s:{r:0,c:0},e:{r:0,c:0}},pt=We[3],Ce=qe||"Sheet"+(pt+1),qe="");var $r=Q.dense?(Lt[We[0].r]||[])[We[0].c]:J[Hr(We[0])];if($r){$r.t=We[1].t,$r.v=We[1].v,We[1].z!=null&&($r.z=We[1].z),We[1].f!=null&&($r.f=We[1].f),cr=$r;break}Q.dense?(Lt[We[0].r]||(Lt[We[0].r]=[]),Lt[We[0].r][We[0].c]=We[1]):J[Hr(We[0])]=We[1],cr=We[1];break;case 21509:Q.works2=!0;break;case 21506:We==5281&&(cr.z="hh:mm:ss",Q.cellDates&&cr.t=="n"&&(cr.v=Ha(cr.v),cr.t=typeof cr.v=="number"?"n":"d"));break}},Q);else if(G[2]==26||G[2]==14)Q.Enum=zt,G[2]==14&&(Q.qpro=!0,G.l=0),t(G,function(We,_n,wi){switch(wi){case 204:Ce=We;break;case 22:We[1].v.charCodeAt(0)<48&&(We[1].v=We[1].v.slice(1)),We[1].v=We[1].v.replace(/\x0F./g,function($r){return String.fromCharCode($r.charCodeAt(1)-32)}).replace(/\r\n/g,`
`);case 23:case 24:case 25:case 37:case 39:case 40:if(We[3]>pt&&(J["!ref"]=oi(Qe),tt[Ce]=J,Re.push(Ce),J={},Q.dense&&(Lt=J["!data"]=[]),Qe={s:{r:0,c:0},e:{r:0,c:0}},pt=We[3],Ce="Sheet"+(pt+1)),ar>0&&We[0].r>=ar)break;Q.dense?(Lt[We[0].r]||(Lt[We[0].r]=[]),Lt[We[0].r][We[0].c]=We[1]):J[Hr(We[0])]=We[1],Qe.e.c<We[0].c&&(Qe.e.c=We[0].c),Qe.e.r<We[0].r&&(Qe.e.r=We[0].r);break;case 27:We[14e3]&&(jt[We[14e3][0]]=We[14e3][1]);break;case 1537:jt[We[0]]=We[1],We[0]==pt&&(Ce=We[1]);break;default:break}},Q);else throw new Error("Unrecognized LOTUS BOF "+G[2]);if(J["!ref"]=oi(Qe),tt[qe||Ce]=J,Re.push(qe||Ce),!jt.length)return{SheetNames:Re,Sheets:tt};for(var si={},ui=[],Ve=0;Ve<jt.length;++Ve)tt[Re[Ve]]?(ui.push(jt[Ve]||Re[Ve]),si[jt[Ve]]=tt[jt[Ve]]||tt[Re[Ve]]):(ui.push(jt[Ve]),si[jt[Ve]]={"!ref":"A1"});return{SheetNames:ui,Sheets:si}}function i(G,re){var Q=re||{};if(+Q.codepage>=0&&As(+Q.codepage),Q.type=="string")throw new Error("Cannot write WK1 to JS string");var J=Bi();if(!G["!ref"])throw new Error("Cannot export empty sheet to WK1");var Ce=Fr(G["!ref"]),qe=G["!data"]!=null,pt=[];Ae(J,0,a(1030)),Ae(J,6,f(Ce));for(var tt=Math.min(Ce.e.r,8191),Re=Ce.s.c;Re<=Ce.e.c;++Re)pt[Re]=lr(Re);for(var jt=Ce.s.r;jt<=tt;++jt){var Lt=dr(jt);for(Re=Ce.s.c;Re<=Ce.e.c;++Re){var Qe=qe?(G["!data"][jt]||[])[Re]:G[pt[Re]+Lt];if(!(!Qe||Qe.t=="z"))switch(Qe.t){case"n":(Qe.v|0)==Qe.v&&Qe.v>=-32768&&Qe.v<=32767?Ae(J,13,E(jt,Re,Qe)):Ae(J,14,x(jt,Re,Qe));break;case"d":var ar=Ci(Qe.v);(ar|0)==ar&&ar>=-32768&&ar<=32767?Ae(J,13,E(jt,Re,{t:"n",v:ar,z:Qe.z||Ir[14]})):Ae(J,14,x(jt,Re,{t:"n",v:ar,z:Qe.z||Ir[14]}));break;default:var cr=Eo(Qe);Ae(J,15,k(jt,Re,cr.slice(0,239)))}}}return Ae(J,1),J.end()}function o(G,re){var Q=re||{};if(+Q.codepage>=0&&As(+Q.codepage),Q.type=="string")throw new Error("Cannot write WK3 to JS string");var J=Bi();Ae(J,0,l(G));for(var Ce=0,qe=0;Ce<G.SheetNames.length;++Ce)(G.Sheets[G.SheetNames[Ce]]||{})["!ref"]&&Ae(J,27,Ft(G.SheetNames[Ce],qe++));var pt=0;for(Ce=0;Ce<G.SheetNames.length;++Ce){var tt=G.Sheets[G.SheetNames[Ce]];if(!(!tt||!tt["!ref"])){for(var Re=Fr(tt["!ref"]),jt=tt["!data"]!=null,Lt=[],Qe=Math.min(Re.e.r,8191),ar=Re.s.r;ar<=Qe;++ar)for(var cr=dr(ar),si=Re.s.c;si<=Re.e.c;++si){ar===Re.s.r&&(Lt[si]=lr(si));var ui=Lt[si]+cr,Ve=jt?(tt["!data"][ar]||[])[si]:tt[ui];if(!(!Ve||Ve.t=="z"))if(Ve.t=="n")Ae(J,23,_t(ar,si,pt,Ve.v));else{var We=Eo(Ve);Ae(J,22,ie(ar,si,pt,We.slice(0,239)))}}++pt}}return Ae(J,1),J.end()}function a(G){var re=oe(2);return re.write_shift(2,G),re}function l(G){var re=oe(26);re.write_shift(2,4096),re.write_shift(2,4),re.write_shift(4,0);for(var Q=0,J=0,Ce=0,qe=0;qe<G.SheetNames.length;++qe){var pt=G.SheetNames[qe],tt=G.Sheets[pt];if(!(!tt||!tt["!ref"])){++Ce;var Re=yi(tt["!ref"]);Q<Re.e.r&&(Q=Re.e.r),J<Re.e.c&&(J=Re.e.c)}}return Q>8191&&(Q=8191),re.write_shift(2,Q),re.write_shift(1,Ce),re.write_shift(1,J),re.write_shift(2,0),re.write_shift(2,0),re.write_shift(1,1),re.write_shift(1,2),re.write_shift(4,0),re.write_shift(4,0),re}function c(G,re,Q){var J={s:{c:0,r:0},e:{c:0,r:0}};return re==8&&Q.qpro?(J.s.c=G.read_shift(1),G.l++,J.s.r=G.read_shift(2),J.e.c=G.read_shift(1),G.l++,J.e.r=G.read_shift(2),J):(J.s.c=G.read_shift(2),J.s.r=G.read_shift(2),re==12&&Q.qpro&&(G.l+=2),J.e.c=G.read_shift(2),J.e.r=G.read_shift(2),re==12&&Q.qpro&&(G.l+=2),J.s.c==65535&&(J.s.c=J.e.c=J.s.r=J.e.r=0),J)}function f(G){var re=oe(8);return re.write_shift(2,G.s.c),re.write_shift(2,G.s.r),re.write_shift(2,G.e.c),re.write_shift(2,G.e.r),re}function m(G,re,Q){var J=[{c:0,r:0},{t:"n",v:0},0,0];return Q.qpro&&Q.vers!=20768?(J[0].c=G.read_shift(1),J[3]=G.read_shift(1),J[0].r=G.read_shift(2),G.l+=2):Q.works?(J[0].c=G.read_shift(2),J[0].r=G.read_shift(2),J[2]=G.read_shift(2)):(J[2]=G.read_shift(1),J[0].c=G.read_shift(2),J[0].r=G.read_shift(2)),J}function C(G){return G.z&&pa(G.z)?240|(e.indexOf(G.z)+1||2):255}function y(G,re,Q){var J=G.l+re,Ce=m(G,re,Q);if(Ce[1].t="s",(Q.vers&65534)==20768){G.l++;var qe=G.read_shift(1);return Ce[1].v=G.read_shift(qe,"utf8"),Ce}return Q.qpro&&G.l++,Ce[1].v=G.read_shift(J-G.l,"cstr"),Ce}function k(G,re,Q){var J=oe(7+Q.length);J.write_shift(1,255),J.write_shift(2,re),J.write_shift(2,G),J.write_shift(1,39);for(var Ce=0;Ce<J.length;++Ce){var qe=Q.charCodeAt(Ce);J.write_shift(1,qe>=128?95:qe)}return J.write_shift(1,0),J}function S(G,re,Q){var J=G.l+re,Ce=m(G,re,Q);if(Ce[1].t="s",Q.vers==20768){var qe=G.read_shift(1);return Ce[1].v=G.read_shift(qe,"utf8"),Ce}return Ce[1].v=G.read_shift(J-G.l,"cstr"),Ce}function M(G,re,Q){var J=m(G,re,Q);return J[1].v=G.read_shift(2,"i"),J}function E(G,re,Q){var J=oe(7);return J.write_shift(1,C(Q)),J.write_shift(2,re),J.write_shift(2,G),J.write_shift(2,Q.v,"i"),J}function A(G,re,Q){var J=m(G,re,Q);return J[1].v=G.read_shift(8,"f"),J}function x(G,re,Q){var J=oe(13);return J.write_shift(1,C(Q)),J.write_shift(2,re),J.write_shift(2,G),J.write_shift(8,Q.v,"f"),J}function F(G,re,Q){var J=G.l+re,Ce=m(G,re,Q);if(Ce[1].v=G.read_shift(8,"f"),Q.qpro)G.l=J;else{var qe=G.read_shift(2);V(G.slice(G.l,G.l+qe),Ce),G.l+=qe}return Ce}function L(G,re,Q){var J=re&32768;return re&=-32769,re=(J?G:0)+(re>=8192?re-16384:re),(J?"":"$")+(Q?lr(re):dr(re))}var K={31:["NA",0],33:["ABS",1],34:["TRUNC",1],35:["SQRT",1],36:["LOG",1],37:["LN",1],38:["PI",0],39:["SIN",1],40:["COS",1],41:["TAN",1],42:["ATAN2",2],43:["ATAN",1],44:["ASIN",1],45:["ACOS",1],46:["EXP",1],47:["MOD",2],49:["ISNA",1],50:["ISERR",1],51:["FALSE",0],52:["TRUE",0],53:["RAND",0],54:["DATE",3],63:["ROUND",2],64:["TIME",3],68:["ISNUMBER",1],69:["ISTEXT",1],70:["LEN",1],71:["VALUE",1],73:["MID",3],74:["CHAR",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],102:["UPPER",1],103:["LOWER",1],107:["PROPER",1],109:["TRIM",1],111:["T",1]},te=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function V(G,re){ji(G,0);for(var Q=[],J=0,Ce="",qe="",pt="",tt="";G.l<G.length;){var Re=G[G.l++];switch(Re){case 0:Q.push(G.read_shift(8,"f"));break;case 1:qe=L(re[0].c,G.read_shift(2),!0),Ce=L(re[0].r,G.read_shift(2),!1),Q.push(qe+Ce);break;case 2:{var jt=L(re[0].c,G.read_shift(2),!0),Lt=L(re[0].r,G.read_shift(2),!1);qe=L(re[0].c,G.read_shift(2),!0),Ce=L(re[0].r,G.read_shift(2),!1),Q.push(jt+Lt+":"+qe+Ce)}break;case 3:if(G.l<G.length){console.error("WK1 premature formula end");return}break;case 4:Q.push("("+Q.pop()+")");break;case 5:Q.push(G.read_shift(2));break;case 6:{for(var Qe="";Re=G[G.l++];)Qe+=String.fromCharCode(Re);Q.push('"'+Qe.replace(/"/g,'""')+'"')}break;case 8:Q.push("-"+Q.pop());break;case 23:Q.push("+"+Q.pop());break;case 22:Q.push("NOT("+Q.pop()+")");break;case 20:case 21:tt=Q.pop(),pt=Q.pop(),Q.push(["AND","OR"][Re-20]+"("+pt+","+tt+")");break;default:if(Re<32&&te[Re])tt=Q.pop(),pt=Q.pop(),Q.push(pt+te[Re]+tt);else if(K[Re]){if(J=K[Re][1],J==69&&(J=G[G.l++]),J>Q.length){console.error("WK1 bad formula parse 0x"+Re.toString(16)+":|"+Q.join("|")+"|");return}var ar=Q.slice(-J);Q.length-=J,Q.push(K[Re][0]+"("+ar.join(",")+")")}else return Re<=7?console.error("WK1 invalid opcode "+Re.toString(16)):Re<=24?console.error("WK1 unsupported op "+Re.toString(16)):Re<=30?console.error("WK1 invalid opcode "+Re.toString(16)):Re<=115?console.error("WK1 unsupported function opcode "+Re.toString(16)):console.error("WK1 unrecognized opcode "+Re.toString(16))}}Q.length==1?re[1].f=""+Q[0]:console.error("WK1 bad formula parse |"+Q.join("|")+"|")}function R(G){var re=[{c:0,r:0},{t:"n",v:0},0];return re[0].r=G.read_shift(2),re[3]=G[G.l++],re[0].c=G[G.l++],re}function q(G,re){var Q=R(G,re);return Q[1].t="s",Q[1].v=G.read_shift(re-4,"cstr"),Q}function ie(G,re,Q,J){var Ce=oe(6+J.length);Ce.write_shift(2,G),Ce.write_shift(1,Q),Ce.write_shift(1,re),Ce.write_shift(1,39);for(var qe=0;qe<J.length;++qe){var pt=J.charCodeAt(qe);Ce.write_shift(1,pt>=128?95:pt)}return Ce.write_shift(1,0),Ce}function de(G,re){var Q=R(G,re);Q[1].v=G.read_shift(2);var J=Q[1].v>>1;if(Q[1].v&1)switch(J&7){case 0:J=(J>>3)*5e3;break;case 1:J=(J>>3)*500;break;case 2:J=(J>>3)/20;break;case 3:J=(J>>3)/200;break;case 4:J=(J>>3)/2e3;break;case 5:J=(J>>3)/2e4;break;case 6:J=(J>>3)/16;break;case 7:J=(J>>3)/64;break}return Q[1].v=J,Q}function ye(G,re){var Q=R(G,re),J=G.read_shift(4),Ce=G.read_shift(4),qe=G.read_shift(2);if(qe==65535)return J===0&&Ce===3221225472?(Q[1].t="e",Q[1].v=15):J===0&&Ce===3489660928?(Q[1].t="e",Q[1].v=42):Q[1].v=0,Q;var pt=qe&32768;return qe=(qe&32767)-16446,Q[1].v=(1-pt*2)*(Ce*Math.pow(2,qe+32)+J*Math.pow(2,qe)),Q}function _t(G,re,Q,J){var Ce=oe(14);if(Ce.write_shift(2,G),Ce.write_shift(1,Q),Ce.write_shift(1,re),J==0)return Ce.write_shift(4,0),Ce.write_shift(4,0),Ce.write_shift(2,65535),Ce;var qe=0,pt=0,tt=0,Re=0;return J<0&&(qe=1,J=-J),pt=Math.log2(J)|0,J/=Math.pow(2,pt-31),Re=J>>>0,(Re&2147483648)==0&&(J/=2,++pt,Re=J>>>0),J-=Re,Re|=2147483648,Re>>>=0,J*=Math.pow(2,32),tt=J>>>0,Ce.write_shift(4,tt),Ce.write_shift(4,Re),pt+=16383+(qe?32768:0),Ce.write_shift(2,pt),Ce}function St(G,re){var Q=ye(G,14);return G.l+=re-14,Q}function st(G,re){var Q=R(G,re),J=G.read_shift(4);return Q[1].v=J>>6,Q}function or(G,re){var Q=R(G,re),J=G.read_shift(8,"f");return Q[1].v=J,Q}function ot(G,re){var Q=or(G,12);return G.l+=re-12,Q}function yr(G,re){return G[G.l+re-1]==0?G.read_shift(re,"cstr"):""}function Vr(G,re){var Q=G[G.l++];Q>re-1&&(Q=re-1);for(var J="";J.length<Q;)J+=String.fromCharCode(G[G.l++]);return J}function Cr(G,re,Q){if(!(!Q.qpro||re<21)){var J=G.read_shift(1);G.l+=17,G.l+=1,G.l+=2;var Ce=G.read_shift(re-21,"cstr");return[J,Ce]}}function gi(G,re){for(var Q={},J=G.l+re;G.l<J;){var Ce=G.read_shift(2);if(Ce==14e3){for(Q[Ce]=[0,""],Q[Ce][0]=G.read_shift(2);G[G.l];)Q[Ce][1]+=String.fromCharCode(G[G.l]),G.l++;G.l++}}return Q}function Ft(G,re){var Q=oe(5+G.length);Q.write_shift(2,14e3),Q.write_shift(2,re);for(var J=0;J<G.length;++J){var Ce=G.charCodeAt(J);Q[Q.l++]=Ce>127?95:Ce}return Q[Q.l++]=0,Q}var At={0:{n:"BOF",f:Ul},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:M},14:{n:"NUMBER",f:A},15:{n:"LABEL",f:y},16:{n:"FORMULA",f:F},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:S},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:yr},222:{n:"SHEETNAMELP",f:Vr},255:{n:"BOF",f:Ul},21506:{n:"WKSNF",f:Ul},65535:{n:""}},zt={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:q},23:{n:"NUMBER17",f:ye},24:{n:"NUMBER18",f:de},25:{n:"FORMULA19",f:St},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:gi},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:st},38:{n:"??"},39:{n:"NUMBER27",f:or},40:{n:"FORMULA28",f:ot},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:yr},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Cr},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}},Ut={5:"dd-mmm-yy",6:"dd-mmm",7:"mmm-yy",8:"mm/dd/yy",10:"hh:mm:ss AM/PM",11:"hh:mm AM/PM",14:"dd-mmm-yyyy",15:"mmm-yyyy",34:"0.00",50:"0.00;[Red]0.00",66:"0.00;(0.00)",82:"0.00;[Red](0.00)",162:'"$"#,##0.00;\\("$"#,##0.00\\)',288:"0%",304:"0E+00",320:"# ?/?"};function Wt(G){var re=G.read_shift(2),Q=G.read_shift(1);if(Q!=0)throw"unsupported QPW string type "+Q.toString(16);return G.read_shift(re,"sbcs-cont")}function Rt(G,re){ji(G,0);var Q=re||{};ao!=null&&Q.dense==null&&(Q.dense=ao);var J={};Q.dense&&(J["!data"]=[]);var Ce=[],qe="",pt=[],tt={s:{r:-1,c:-1},e:{r:-1,c:-1}},Re=0,jt=0,Lt=0,Qe=0,ar={SheetNames:[],Sheets:{}},cr=[];e:for(;G.l<G.length;){var si=G.read_shift(2),ui=G.read_shift(2),Ve=G.slice(G.l,G.l+ui);switch(ji(Ve,0),si){case 1:if(Ve.read_shift(4)!=962023505)throw"Bad QPW9 BOF!";break;case 2:break e;case 8:break;case 10:for(var We=Ve.read_shift(4),_n=(Ve.length-Ve.l)/We|0,wi=0;wi<We;++wi){var $r=Ve.l+_n,xn={};Ve.l+=2,xn.numFmtId=Ve.read_shift(2),Ut[xn.numFmtId]&&(xn.z=Ut[xn.numFmtId]),Ve.l=$r,cr.push(xn)}break;case 1025:break;case 1026:break;case 1031:for(Ve.l+=12;Ve.l<Ve.length;)Re=Ve.read_shift(2),jt=Ve.read_shift(1),Ce.push(Ve.read_shift(Re,"cstr"));break;case 1032:break;case 1537:{var uo=Ve.read_shift(2);J={},Q.dense&&(J["!data"]=[]),tt.s.c=Ve.read_shift(2),tt.e.c=Ve.read_shift(2),tt.s.r=Ve.read_shift(4),tt.e.r=Ve.read_shift(4),Ve.l+=4,Ve.l+2<Ve.length&&(Re=Ve.read_shift(2),jt=Ve.read_shift(1),qe=Re==0?"":Ve.read_shift(Re,"cstr")),qe||(qe=lr(uo))}break;case 1538:{if(tt.s.c>255||tt.s.r>999999)break;tt.e.c<tt.s.c&&(tt.e.c=tt.s.c),tt.e.r<tt.s.r&&(tt.e.r=tt.s.r),J["!ref"]=oi(tt),nu(ar,J,qe)}break;case 2561:Lt=Ve.read_shift(2),tt.e.c<Lt&&(tt.e.c=Lt),tt.s.c>Lt&&(tt.s.c=Lt),Qe=Ve.read_shift(4),tt.s.r>Qe&&(tt.s.r=Qe),Qe=Ve.read_shift(4),tt.e.r<Qe&&(tt.e.r=Qe);break;case 3073:{Qe=Ve.read_shift(4),Re=Ve.read_shift(4),tt.s.r>Qe&&(tt.s.r=Qe),tt.e.r<Qe+Re-1&&(tt.e.r=Qe+Re-1);for(var Ln=lr(Lt);Ve.l<Ve.length;){var Vt={t:"z"},li=Ve.read_shift(1),an=-1;li&128&&(an=Ve.read_shift(2));var va=li&64?Ve.read_shift(2)-1:0;switch(li&31){case 0:break;case 1:break;case 2:Vt={t:"n",v:Ve.read_shift(2)};break;case 3:Vt={t:"n",v:Ve.read_shift(2,"i")};break;case 4:Vt={t:"n",v:q0(Ve)};break;case 5:Vt={t:"n",v:Ve.read_shift(8,"f")};break;case 7:Vt={t:"s",v:Ce[jt=Ve.read_shift(4)-1]};break;case 8:Vt={t:"n",v:Ve.read_shift(8,"f")},Ve.l+=2,Ve.l+=4,isNaN(Vt.v)&&(Vt={t:"e",v:15});break;default:throw"Unrecognized QPW cell type "+(li&31)}an!=-1&&(cr[an-1]||{}).z&&(Vt.z=cr[an-1].z);var _i=0;if(li&32)switch(li&31){case 2:_i=Ve.read_shift(2);break;case 3:_i=Ve.read_shift(2,"i");break;case 7:_i=Ve.read_shift(2);break;default:throw"Unsupported delta for QPW cell type "+(li&31)}if(!(!Q.sheetStubs&&Vt.t=="z")){var Nn=Ri(Vt);Vt.t=="n"&&Vt.z&&pa(Vt.z)&&Q.cellDates&&(Nn.v=Ha(Vt.v),Nn.t=typeof Nn.v=="number"?"n":"d"),J["!data"]!=null?(J["!data"][Qe]||(J["!data"][Qe]=[]),J["!data"][Qe][Lt]=Nn):J[Ln+dr(Qe)]=Nn}for(++Qe,--Re;va-- >0&&Re>=0;){if(li&32)switch(li&31){case 2:Vt={t:"n",v:Vt.v+_i&65535};break;case 3:Vt={t:"n",v:Vt.v+_i&65535},Vt.v>32767&&(Vt.v-=65536);break;case 7:Vt={t:"s",v:Ce[jt=jt+_i>>>0]};break;default:throw"Cannot apply delta for QPW cell type "+(li&31)}else switch(li&31){case 1:Vt={t:"z"};break;case 2:Vt={t:"n",v:Ve.read_shift(2)};break;case 7:Vt={t:"s",v:Ce[jt=Ve.read_shift(4)-1]};break;default:throw"Cannot apply repeat for QPW cell type "+(li&31)}an!=-1,!Q.sheetStubs&&Vt.t=="z"||(J["!data"]!=null?(J["!data"][Qe]||(J["!data"][Qe]=[]),J["!data"][Qe][Lt]=Vt):J[Ln+dr(Qe)]=Vt),++Qe,--Re}}}break;case 3074:{Lt=Ve.read_shift(2),Qe=Ve.read_shift(4);var yt=Wt(Ve);J["!data"]!=null?(J["!data"][Qe]||(J["!data"][Qe]=[]),J["!data"][Qe][Lt]={t:"s",v:yt}):J[lr(Lt)+dr(Qe)]={t:"s",v:yt}}break;default:break}G.l+=ui}return ar}return{sheet_to_wk1:i,book_to_wk3:o,to_workbook:r}})();var RD=/^\s|\s$|[\t\n\r]/;function LD(t,r){if(!r.bookSST)return"";var e=[ai];e[e.length]=Be("sst",null,{xmlns:Za[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var i=t[n],o="<si>";i.r?o+=i.r:(o+="<t",i.t||(i.t=""),typeof i.t!="string"&&(i.t=String(i.t)),i.t.match(RD)&&(o+=' xml:space="preserve"'),o+=">"+Bt(i.t)+"</t>"),o+="</si>",e[e.length]=o}return e.length>2&&(e[e.length]="</sst>",e[1]=e[1].replace("/>",">")),e.join("")}function ND(t){return[t.read_shift(4),t.read_shift(4)]}function VD(t,r){return r||(r=oe(8)),r.write_shift(4,t.Count),r.write_shift(4,t.Unique),r}var zD=TP;function UD(t){var r=Bi();ve(r,159,VD(t));for(var e=0;e<t.length;++e)ve(r,19,zD(t[e]));return ve(r,160),r.end()}function WD(t){if(typeof qt<"u")return qt.utils.encode(qa,t);for(var r=[],e=t.split(""),n=0;n<e.length;++n)r[n]=e[n].charCodeAt(0);return r}function Tg(t){var r=0,e,n=WD(t),i=n.length+1,o,a,l,c,f;for(e=ua(i),e[0]=n.length,o=1;o!=i;++o)e[o]=n[o-1];for(o=i-1;o>=0;--o)a=e[o],l=(r&16384)===0?0:1,c=r<<1&32767,f=l|c,r=f^a;return r^52811}function jD(t,r){var e=["{\\rtf1\\ansi"];if(!t["!ref"])return e[0]+"}";for(var n=Fr(t["!ref"]),i,o=t["!data"]!=null,a=[],l=n.s.r;l<=n.e.r;++l){e.push("\\trowd\\trautofit1");for(var c=n.s.c;c<=n.e.c;++c)e.push("\\cellx"+(c+1));for(e.push("\\pard\\intbl"),o&&(a=t["!data"][l]||[]),c=n.s.c;c<=n.e.c;++c){var f=Hr({r:l,c});if(i=o?a[c]:t[f],!i||i.v==null&&(!i.f||i.F)){e.push(" \\cell");continue}e.push(" "+(i.w||(Eo(i),i.w)||"").replace(/[\r\n]/g,"\\par ")),e.push("\\cell")}e.push("\\pard\\intbl\\row")}return e.join("")+"}"}function Sh(t){for(var r=0,e=1;r!=3;++r)e=e*256+(t[r]>255?255:t[r]<0?0:t[r]);return e.toString(16).toUpperCase().slice(1)}var HD=6;var ko=HD;function Ql(t){return Math.floor((t+Math.round(128/ko)/256)*ko)}function Yl(t){return Math.floor((t-5)/ko*100+.5)/100}function F0(t){return Math.round((t*ko+5)/ko*256)/256}function Y0(t){t.width?(t.wpx=Ql(t.width),t.wch=Yl(t.wpx),t.MDW=ko):t.wpx?(t.wch=Yl(t.wpx),t.width=F0(t.wch),t.MDW=ko):typeof t.wch=="number"&&(t.width=F0(t.wch),t.wpx=Ql(t.width),t.MDW=ko),t.customWidth&&delete t.customWidth}var $D=96,Eg=$D;function Zl(t){return t*96/Eg}function Ig(t){return t*Eg/96}function GD(t){var r=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var n=e[0];n<=e[1];++n)t[n]!=null&&(r[r.length]=Be("numFmt",null,{numFmtId:n,formatCode:Bt(t[n])}))}),r.length===1?"":(r[r.length]="</numFmts>",r[0]=Be("numFmts",null,{count:r.length-2}).replace("/>",">"),r.join(""))}function KD(t){var r=[];return r[r.length]=Be("cellXfs",null),t.forEach(function(e){r[r.length]=Be("xf",null,e)}),r[r.length]="</cellXfs>",r.length===2?"":(r[0]=Be("cellXfs",null,{count:r.length-2}).replace("/>",">"),r.join(""))}function XD(t,r){var e=[ai,Be("styleSheet",null,{xmlns:Za[0],"xmlns:vt":hi.vt})],n;return t.SSF&&(n=GD(t.SSF))!=null&&(e[e.length]=n),e[e.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',e[e.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',e[e.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',e[e.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=KD(r.cellXfs))&&(e[e.length]=n),e[e.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',e[e.length]='<dxfs count="0"/>',e[e.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',e.length>2&&(e[e.length]="</styleSheet>",e[1]=e[1].replace("/>",">")),e.join("")}function JD(t,r){var e=t.read_shift(2),n=Mi(t,r-2);return[e,n]}function qD(t,r,e){e||(e=oe(6+4*r.length)),e.write_shift(2,t),ci(r,e);var n=e.length>e.l?e.slice(0,e.l):e;return e.l==null&&(e.l=e.length),n}function QD(t,r,e){var n={};n.sz=t.read_shift(2)/20;var i=OP(t,2,e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var o=t.read_shift(2);switch(o===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=t.read_shift(1);a!=0&&(n.underline=a);var l=t.read_shift(1);l>0&&(n.family=l);var c=t.read_shift(1);switch(c>0&&(n.charset=c),t.l++,n.color=DP(t,8),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Mi(t,r-21),n}function YD(t,r){r||(r=oe(153)),r.write_shift(2,t.sz*20),BP(t,r),r.write_shift(2,t.bold?700:400);var e=0;t.vertAlign=="superscript"?e=1:t.vertAlign=="subscript"&&(e=2),r.write_shift(2,e),r.write_shift(1,t.underline||0),r.write_shift(1,t.family||0),r.write_shift(1,t.charset||0),r.write_shift(1,0),Jl(t.color,r);var n=0;return t.scheme=="major"&&(n=1),t.scheme=="minor"&&(n=2),r.write_shift(1,n),ci(t.name,r),r.length>r.l?r.slice(0,r.l):r}var ZD=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],v0,eO=lo;function kh(t,r){r||(r=oe(84)),v0||(v0=M0(ZD));var e=v0[t.patternType];e==null&&(e=40),r.write_shift(4,e);var n=0;if(e!=40)for(Jl({auto:1},r),Jl({auto:1},r);n<12;++n)r.write_shift(4,0);else{for(;n<4;++n)r.write_shift(4,0);for(;n<12;++n)r.write_shift(4,0)}return r.length>r.l?r.slice(0,r.l):r}function tO(t,r){var e=t.l+r,n=t.read_shift(2),i=t.read_shift(2);return t.l=e,{ixfe:n,numFmtId:i}}function Fg(t,r,e){e||(e=oe(16)),e.write_shift(2,r||0),e.write_shift(2,t.numFmtId||0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);var n=0;return e.write_shift(1,n),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(1,0),e}function Cs(t,r){return r||(r=oe(10)),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(4,0),r}var rO=lo;function iO(t,r){return r||(r=oe(51)),r.write_shift(1,0),Cs(null,r),Cs(null,r),Cs(null,r),Cs(null,r),Cs(null,r),r.length>r.l?r.slice(0,r.l):r}function nO(t,r){return r||(r=oe(52)),r.write_shift(4,t.xfId),r.write_shift(2,1),r.write_shift(1,+t.builtinId),r.write_shift(1,0),Ms(t.name||"",r),r.length>r.l?r.slice(0,r.l):r}function oO(t,r,e){var n=oe(2052);return n.write_shift(4,t),Ms(r,n),Ms(e,n),n.length>n.l?n.slice(0,n.l):n}function aO(t,r){if(r){var e=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)r[i]!=null&&++e}),e!=0&&(ve(t,615,Rn(e)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)r[i]!=null&&ve(t,44,qD(i,r[i]))}),ve(t,616))}}function sO(t){var r=1;r!=0&&(ve(t,611,Rn(r)),ve(t,43,YD({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),ve(t,612))}function lO(t){var r=2;r!=0&&(ve(t,603,Rn(r)),ve(t,45,kh({patternType:"none"})),ve(t,45,kh({patternType:"gray125"})),ve(t,604))}function cO(t){var r=1;r!=0&&(ve(t,613,Rn(r)),ve(t,46,iO({})),ve(t,614))}function uO(t){var r=1;ve(t,626,Rn(r)),ve(t,47,Fg({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),ve(t,627)}function dO(t,r){ve(t,617,Rn(r.length)),r.forEach(function(e){ve(t,47,Fg(e,0))}),ve(t,618)}function pO(t){var r=1;ve(t,619,Rn(r)),ve(t,48,nO({xfId:0,builtinId:0,name:"Normal"})),ve(t,620)}function fO(t){var r=0;ve(t,505,Rn(r)),ve(t,506)}function mO(t){var r=0;ve(t,508,oO(r,"TableStyleMedium9","PivotStyleMedium4")),ve(t,509)}function hO(t,r){var e=Bi();return ve(e,278),aO(e,t.SSF),sO(e,t),lO(e,t),cO(e,t),uO(e,t),dO(e,r.cellXfs),pO(e,t),fO(e,t),mO(e,t),ve(e,279),e.end()}function Ag(t,r){if(r&&r.themeXLSX)return r.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var e=[ai];return e[e.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',e[e.length]="<a:themeElements>",e[e.length]='<a:clrScheme name="Office">',e[e.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',e[e.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',e[e.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',e[e.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',e[e.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',e[e.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',e[e.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',e[e.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',e[e.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',e[e.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',e[e.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',e[e.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',e[e.length]="</a:clrScheme>",e[e.length]='<a:fontScheme name="Office">',e[e.length]="<a:majorFont>",e[e.length]='<a:latin typeface="Cambria"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',e[e.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',e[e.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',e[e.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',e[e.length]='<a:font script="Arab" typeface="Times New Roman"/>',e[e.length]='<a:font script="Hebr" typeface="Times New Roman"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="MoolBoran"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Times New Roman"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:majorFont>",e[e.length]="<a:minorFont>",e[e.length]='<a:latin typeface="Calibri"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',e[e.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',e[e.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',e[e.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',e[e.length]='<a:font script="Arab" typeface="Arial"/>',e[e.length]='<a:font script="Hebr" typeface="Arial"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="DaunPenh"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Arial"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:minorFont>",e[e.length]="</a:fontScheme>",e[e.length]='<a:fmtScheme name="Office">',e[e.length]="<a:fillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="1"/>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="0"/>',e[e.length]="</a:gradFill>",e[e.length]="</a:fillStyleLst>",e[e.length]="<a:lnStyleLst>",e[e.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]="</a:lnStyleLst>",e[e.length]="<a:effectStyleLst>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',e[e.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',e[e.length]="</a:effectStyle>",e[e.length]="</a:effectStyleLst>",e[e.length]="<a:bgFillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]="</a:bgFillStyleLst>",e[e.length]="</a:fmtScheme>",e[e.length]="</a:themeElements>",e[e.length]="<a:objectDefaults>",e[e.length]="<a:spDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',e[e.length]="</a:spDef>",e[e.length]="<a:lnDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',e[e.length]="</a:lnDef>",e[e.length]="</a:objectDefaults>",e[e.length]="<a:extraClrSchemeLst/>",e[e.length]="</a:theme>",e.join("")}function gO(t,r){return{flags:t.read_shift(4),version:t.read_shift(4),name:Mi(t,r-8)}}function _O(t){var r=oe(12+2*t.name.length);return r.write_shift(4,t.flags),r.write_shift(4,t.version),ci(t.name,r),r.slice(0,r.l)}function xO(t){for(var r=[],e=t.read_shift(4);e-- >0;)r.push([t.read_shift(4),t.read_shift(4)]);return r}function vO(t){var r=oe(4+8*t.length);r.write_shift(4,t.length);for(var e=0;e<t.length;++e)r.write_shift(4,t[e][0]),r.write_shift(4,t[e][1]);return r}function bO(t,r){var e=oe(8+2*r.length);return e.write_shift(4,t),ci(r,e),e.slice(0,e.l)}function yO(t){return t.l+=4,t.read_shift(4)!=0}function CO(t,r){var e=oe(8);return e.write_shift(4,t),e.write_shift(4,r?1:0),e}function wO(){var t=Bi();return ve(t,332),ve(t,334,Rn(1)),ve(t,335,_O({name:"XLDAPR",version:12e4,flags:3496657072})),ve(t,336),ve(t,339,bO(1,"XLDAPR")),ve(t,52),ve(t,35,Rn(514)),ve(t,4096,Rn(0)),ve(t,4097,Fn(1)),ve(t,36),ve(t,53),ve(t,340),ve(t,337,CO(1,!0)),ve(t,51,vO([[1,0]])),ve(t,338),ve(t,333),t.end()}function SO(){var t=[ai];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function kO(t){var r={};r.i=t.read_shift(4);var e={};e.r=t.read_shift(4),e.c=t.read_shift(4),r.r=Hr(e);var n=t.read_shift(1);return n&2&&(r.l="1"),n&8&&(r.a="1"),r}function Pg(t,r,e){var n=[21600,21600],i=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),o=[Be("xml",null,{"xmlns:v":mn.v,"xmlns:o":mn.o,"xmlns:x":mn.x,"xmlns:mv":mn.mv}).replace(/\/>/,">"),Be("o:shapelayout",Be("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"})],a=65536*t,l=r||[];return l.length>0&&o.push(Be("v:shapetype",[Be("v:stroke",null,{joinstyle:"miter"}),Be("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202",coordsize:n.join(","),"o:spt":202,path:i})),l.forEach(function(c){++a,o.push(TO(c,a))}),o.push("</xml>"),o.join("")}function TO(t,r,e){var n=Nr(t[0]),i={color2:"#BEFF82",type:"gradient"};i.type=="gradient"&&(i.angle="-180");var o=i.type=="gradient"?Be("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,a=Be("v:fill",o,i),l={on:"t",obscured:"t"};return["<v:shape"+Ds({id:"_x0000_s"+r,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(t[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",a,Be("v:shadow",null,l),Be("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",bi("x:Anchor",[n.c+1,0,n.r+1,0,n.c+3,20,n.r+5,20].join(",")),bi("x:AutoFill","False"),bi("x:Row",String(n.r)),bi("x:Column",String(n.c)),t[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"].join("")}function EO(t){var r=[ai,Be("comments",null,{xmlns:Za[0]})],e=[];return r.push("<authors>"),t.forEach(function(n){n[1].forEach(function(i){var o=Bt(i.a);e.indexOf(o)==-1&&(e.push(o),r.push("<author>"+o+"</author>")),i.T&&i.ID&&e.indexOf("tc="+i.ID)==-1&&(e.push("tc="+i.ID),r.push("<author>tc="+i.ID+"</author>"))})}),e.length==0&&(e.push("SheetJ5"),r.push("<author>SheetJ5</author>")),r.push("</authors>"),r.push("<commentList>"),t.forEach(function(n){var i=0,o=[],a=0;if(n[1][0]&&n[1][0].T&&n[1][0].ID&&(i=e.indexOf("tc="+n[1][0].ID)),n[1].forEach(function(f){f.a&&(i=e.indexOf(Bt(f.a))),f.T&&++a,o.push(f.t==null?"":Bt(f.t))}),a===0)n[1].forEach(function(f){r.push('<comment ref="'+n[0]+'" authorId="'+e.indexOf(Bt(f.a))+'"><text>'),r.push(bi("t",f.t==null?"":Bt(f.t))),r.push("</text></comment>")});else{n[1][0]&&n[1][0].T&&n[1][0].ID&&(i=e.indexOf("tc="+n[1][0].ID)),r.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>');for(var l=`Comment:
    `+o[0]+`
`,c=1;c<o.length;++c)l+=`Reply:
    `+o[c]+`
`;r.push(bi("t",Bt(l))),r.push("</text></comment>")}}),r.push("</commentList>"),r.length>2&&(r[r.length]="</comments>",r[1]=r[1].replace("/>",">")),r.join("")}function Dg(t,r,e){var n=[ai,Be("ThreadedComments",null,{xmlns:hi.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var o="";(i[1]||[]).forEach(function(a,l){if(!a.T){delete a.ID;return}a.a&&r.indexOf(a.a)==-1&&r.push(a.a);var c={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+e.tcid++).slice(-12)+"}"};l==0?o=c.id:c.parentId=o,a.ID=c.id,a.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+r.indexOf(a.a)).slice(-12)+"}"),n.push(Be("threadedComment",bi("text",a.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function Og(t){var r=[ai,Be("personList",null,{xmlns:hi.TCMNT,"xmlns:x":Za[0]}).replace(/[\/]>/,">")];return t.forEach(function(e,n){r.push(Be("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:e,providerId:"None"}))}),r.push("</personList>"),r.join("")}function IO(t){var r={};r.iauthor=t.read_shift(4);var e=xa(t,16);return r.rfx=e.s,r.ref=Hr(e.s),t.l+=16,r}function FO(t,r){return r==null&&(r=oe(36)),r.write_shift(4,t[1].iauthor),is(t[0],r),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r}var AO=Mi;function Th(t){return ci(t.slice(0,54))}function PO(t){var r=Bi(),e=[];return ve(r,628),ve(r,630),t.forEach(function(n){n[1].forEach(function(i){e.indexOf(i.a)>-1||(e.push(i.a.slice(0,54)),ve(r,632,Th(i.a)),i.T&&i.ID&&e.indexOf("tc="+i.ID)==-1&&(e.push("tc="+i.ID),ve(r,632,Th("tc="+i.ID))))})}),ve(r,631),ve(r,633),t.forEach(function(n){n[1].forEach(function(i){var o=-1;i.ID&&(o=e.indexOf("tc="+i.ID)),o==-1&&n[1][0].T&&n[1][0].ID&&(o=e.indexOf("tc="+n[1][0].ID)),o==-1&&(o=e.indexOf(i.a)),i.iauthor=o;var a={s:Nr(n[0]),e:Nr(n[0])};ve(r,635,FO([a,i])),i.t&&i.t.length>0&&ve(r,637,IP(i)),ve(r,636),delete i.iauthor})}),ve(r,634),ve(r,629),r.end()}function DO(t,r){r.FullPaths.forEach(function(e,n){if(n!=0){var i=e.replace(/^[\/]*[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&pr.utils.cfb_add(t,i,r.FileIndex[n].content)}})}var OO=["xlsb","xlsm","xlam","biff8","xla"];var Eh=(function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function e(n,i,o,a){var l=!1,c=!1;o.length==0?c=!0:o.charAt(0)=="["&&(c=!0,o=o.slice(1,-1)),a.length==0?l=!0:a.charAt(0)=="["&&(l=!0,a=a.slice(1,-1));var f=o.length>0?parseInt(o,10)|0:0,m=a.length>0?parseInt(a,10)|0:0;return l?m+=r.c:--m,c?f+=r.r:--f,i+(l?"":"$")+lr(m)+(c?"":"$")+dr(f)}return function(i,o){return r=o,i.replace(t,e)}})(),pc=/(^|[^._A-Z0-9])(\$?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])(\$?)(\d{1,7})(?![_.\(A-Za-z0-9])/g;try{pc=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g}catch{}var fc=(function(){return function(r,e){return r.replace(pc,function(n,i,o,a,l,c){var f=K0(a)-(o?0:e.c),m=G0(c)-(l?0:e.r),C=l=="$"?m+1:m==0?"":"["+m+"]",y=o=="$"?f+1:f==0?"":"["+f+"]";return i+"R"+C+"C"+y})}})();function BO(t,r){return t.replace(pc,function(e,n,i,o,a,l){return n+(i=="$"?i+o:lr(K0(o)+r.c))+(a=="$"?a+l:dr(G0(l)+r.r))})}function MO(t){return t.length!=1}function ti(t){t.l+=1}function Uo(t,r){var e=t.read_shift(r==1?1:2);return[e&16383,e>>14&1,e>>15&1]}function Bg(t,r,e){var n=2;if(e){if(e.biff>=2&&e.biff<=5)return Mg(t,r,e);e.biff==12&&(n=4)}var i=t.read_shift(n),o=t.read_shift(n),a=Uo(t,2),l=Uo(t,2);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:o,c:l[0],cRel:l[1],rRel:l[2]}}}function Mg(t){var r=Uo(t,2),e=Uo(t,2),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:r[0],c:n,cRel:r[1],rRel:r[2]},e:{r:e[0],c:i,cRel:e[1],rRel:e[2]}}}function RO(t,r,e){if(e.biff<8)return Mg(t,r,e);var n=t.read_shift(e.biff==12?4:2),i=t.read_shift(e.biff==12?4:2),o=Uo(t,2),a=Uo(t,2);return{s:{r:n,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function Rg(t,r,e){if(e&&e.biff>=2&&e.biff<=5)return LO(t,r,e);var n=t.read_shift(e&&e.biff==12?4:2),i=Uo(t,2);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function LO(t){var r=Uo(t,2),e=t.read_shift(1);return{r:r[0],c:e,cRel:r[1],rRel:r[2]}}function NO(t){var r=t.read_shift(2),e=t.read_shift(2);return{r,c:e&255,fQuoted:!!(e&16384),cRel:e>>15,rRel:e>>15}}function VO(t,r,e){var n=e&&e.biff?e.biff:8;if(n>=2&&n<=5)return zO(t,r,e);var i=t.read_shift(n>=12?4:2),o=t.read_shift(2),a=(o&16384)>>14,l=(o&32768)>>15;if(o&=16383,l==1)for(;i>524287;)i-=1048576;if(a==1)for(;o>8191;)o=o-16384;return{r:i,c:o,cRel:a,rRel:l}}function zO(t){var r=t.read_shift(2),e=t.read_shift(1),n=(r&32768)>>15,i=(r&16384)>>14;return r&=16383,n==1&&r>=8192&&(r=r-16384),i==1&&e>=128&&(e=e-256),{r,c:e,cRel:i,rRel:n}}function UO(t,r,e){var n=(t[t.l++]&96)>>5,i=Bg(t,e.biff>=2&&e.biff<=5?6:8,e);return[n,i]}function WO(t,r,e){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),o=8;if(e)switch(e.biff){case 5:t.l+=12,o=6;break;case 12:o=12;break}var a=Bg(t,o,e);return[n,i,a]}function jO(t,r,e){var n=(t[t.l++]&96)>>5;return t.l+=e&&e.biff>8?12:e.biff<8?6:8,[n]}function HO(t,r,e){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),o=8;if(e)switch(e.biff){case 5:t.l+=12,o=6;break;case 12:o=12;break}return t.l+=o,[n,i]}function $O(t,r,e){var n=(t[t.l++]&96)>>5,i=RO(t,r-1,e);return[n,i]}function GO(t,r,e){var n=(t[t.l++]&96)>>5;return t.l+=e.biff==2?6:e.biff==12?14:7,[n]}function Ih(t){var r=t[t.l+1]&1,e=1;return t.l+=4,[r,e]}function KO(t,r,e){t.l+=2;for(var n=t.read_shift(e&&e.biff==2?1:2),i=[],o=0;o<=n;++o)i.push(t.read_shift(e&&e.biff==2?1:2));return i}function XO(t,r,e){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(e&&e.biff==2?1:2)]}function JO(t,r,e){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(e&&e.biff==2?1:2)]}function qO(t){var r=t[t.l+1]&255?1:0;return t.l+=2,[r,t.read_shift(2)]}function QO(t,r,e){var n=t[t.l+1]&255?1:0;return t.l+=e&&e.biff==2?3:4,[n]}function Lg(t){var r=t.read_shift(1),e=t.read_shift(1);return[r,e]}function YO(t){return t.read_shift(2),Lg(t,2)}function ZO(t){return t.read_shift(2),Lg(t,2)}function e8(t,r,e){var n=(t[t.l]&96)>>5;t.l+=1;var i=Rg(t,0,e);return[n,i]}function t8(t,r,e){var n=(t[t.l]&96)>>5;t.l+=1;var i=VO(t,0,e);return[n,i]}function r8(t,r,e){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);e&&e.biff==5&&(t.l+=12);var o=Rg(t,0,e);return[n,i,o]}function i8(t,r,e){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(e&&e.biff<=3?1:2);return[mB[i],zg[i],n]}function n8(t,r,e){var n=t[t.l++],i=t.read_shift(1),o=e&&e.biff<=3?[n==88?-1:0,t.read_shift(1)]:o8(t);return[i,(o[0]===0?zg:fB)[o[1]]]}function o8(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function a8(t,r,e){t.l+=e&&e.biff==2?3:4}function s8(t,r,e){if(t.l++,e&&e.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(e&&e.biff==2?1:2);return[n,i]}function l8(t){return t.l++,$i[t.read_shift(1)]}function c8(t){return t.l++,t.read_shift(2)}function u8(t){return t.l++,t.read_shift(1)!==0}function d8(t){return t.l++,ns(t,8)}function p8(t,r,e){return t.l++,yg(t,r-1,e)}function f8(t,r){var e=[t.read_shift(1)];if(r==12)switch(e[0]){case 2:e[0]=4;break;case 4:e[0]=16;break;case 0:e[0]=1;break;case 1:e[0]=2;break}switch(e[0]){case 4:e[1]=YP(t,1)?"TRUE":"FALSE",r!=12&&(t.l+=7);break;case 37:case 16:e[1]=$i[t[t.l]],t.l+=r==12?4:8;break;case 0:t.l+=8;break;case 1:e[1]=ns(t,8);break;case 2:e[1]=rD(t,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+e[0])}return e}function m8(t,r,e){for(var n=t.read_shift(e.biff==12?4:2),i=[],o=0;o!=n;++o)i.push((e.biff==12?xa:oD)(t,8));return i}function h8(t,r,e){var n=0,i=0;e.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),e.biff>=2&&e.biff<8&&(--n,--i==0&&(i=256));for(var o=0,a=[];o!=n&&(a[o]=[]);++o)for(var l=0;l!=i;++l)a[o][l]=f8(t,e.biff);return a}function g8(t,r,e){var n=t.read_shift(1)>>>5&3,i=!e||e.biff>=8?4:2,o=t.read_shift(i);switch(e.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,o]}function _8(t,r,e){if(e.biff==5)return x8(t,r,e);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),o=t.read_shift(4);return[n,i,o]}function x8(t){var r=t.read_shift(1)>>>5&3,e=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[r,e,n]}function v8(t,r,e){var n=t.read_shift(1)>>>5&3;t.l+=e&&e.biff==2?3:4;var i=t.read_shift(e&&e.biff==2?1:2);return[n,i]}function b8(t,r,e){var n=t.read_shift(1)>>>5&3,i=t.read_shift(e&&e.biff==2?1:2);return[n,i]}function y8(t,r,e){var n=t.read_shift(1)>>>5&3;return t.l+=4,e.biff<8&&t.l--,e.biff==12&&(t.l+=2),[n]}function C8(t,r,e){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),o=4;if(e)switch(e.biff){case 5:o=15;break;case 12:o=6;break}return t.l+=o,[n,i]}var w8=lo,S8=lo,k8=lo;function zs(t,r,e){return t.l+=2,[NO(t,4,e)]}function Z0(t){return t.l+=6,[]}var T8=zs,E8=Z0,I8=Z0,F8=zs;function Ng(t){return t.l+=2,[Ul(t),t.read_shift(2)&1]}var A8=zs,P8=Ng,D8=Z0,O8=zs,B8=zs,M8=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function R8(t){t.l+=2;var r=t.read_shift(2),e=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),o=t.read_shift(2),a=M8[e>>2&31];return{ixti:r,coltype:e&3,rt:a,idx:n,c:i,C:o}}function L8(t){return t.l+=2,[t.read_shift(4)]}function N8(t,r,e){return t.l+=5,t.l+=2,t.l+=e.biff==2?1:4,["PTGSHEET"]}function V8(t,r,e){return t.l+=e.biff==2?4:5,["PTGENDSHEET"]}function z8(t){var r=t.read_shift(1)>>>5&3,e=t.read_shift(2);return[r,e]}function U8(t){var r=t.read_shift(1)>>>5&3,e=t.read_shift(2);return[r,e]}function W8(t){return t.l+=4,[0,0]}var Fh={1:{n:"PtgExp",f:s8},2:{n:"PtgTbl",f:k8},3:{n:"PtgAdd",f:ti},4:{n:"PtgSub",f:ti},5:{n:"PtgMul",f:ti},6:{n:"PtgDiv",f:ti},7:{n:"PtgPower",f:ti},8:{n:"PtgConcat",f:ti},9:{n:"PtgLt",f:ti},10:{n:"PtgLe",f:ti},11:{n:"PtgEq",f:ti},12:{n:"PtgGe",f:ti},13:{n:"PtgGt",f:ti},14:{n:"PtgNe",f:ti},15:{n:"PtgIsect",f:ti},16:{n:"PtgUnion",f:ti},17:{n:"PtgRange",f:ti},18:{n:"PtgUplus",f:ti},19:{n:"PtgUminus",f:ti},20:{n:"PtgPercent",f:ti},21:{n:"PtgParen",f:ti},22:{n:"PtgMissArg",f:ti},23:{n:"PtgStr",f:p8},26:{n:"PtgSheet",f:N8},27:{n:"PtgEndSheet",f:V8},28:{n:"PtgErr",f:l8},29:{n:"PtgBool",f:u8},30:{n:"PtgInt",f:c8},31:{n:"PtgNum",f:d8},32:{n:"PtgArray",f:GO},33:{n:"PtgFunc",f:i8},34:{n:"PtgFuncVar",f:n8},35:{n:"PtgName",f:g8},36:{n:"PtgRef",f:e8},37:{n:"PtgArea",f:UO},38:{n:"PtgMemArea",f:v8},39:{n:"PtgMemErr",f:w8},40:{n:"PtgMemNoMem",f:S8},41:{n:"PtgMemFunc",f:b8},42:{n:"PtgRefErr",f:y8},43:{n:"PtgAreaErr",f:jO},44:{n:"PtgRefN",f:t8},45:{n:"PtgAreaN",f:$O},46:{n:"PtgMemAreaN",f:z8},47:{n:"PtgMemNoMemN",f:U8},57:{n:"PtgNameX",f:_8},58:{n:"PtgRef3d",f:r8},59:{n:"PtgArea3d",f:WO},60:{n:"PtgRefErr3d",f:C8},61:{n:"PtgAreaErr3d",f:HO},255:{}},j8={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},H8={1:{n:"PtgElfLel",f:Ng},2:{n:"PtgElfRw",f:O8},3:{n:"PtgElfCol",f:T8},6:{n:"PtgElfRwV",f:B8},7:{n:"PtgElfColV",f:F8},10:{n:"PtgElfRadical",f:A8},11:{n:"PtgElfRadicalS",f:D8},13:{n:"PtgElfColS",f:E8},15:{n:"PtgElfColSV",f:I8},16:{n:"PtgElfRadicalLel",f:P8},25:{n:"PtgList",f:R8},29:{n:"PtgSxName",f:L8},255:{}},$8={0:{n:"PtgAttrNoop",f:W8},1:{n:"PtgAttrSemi",f:QO},2:{n:"PtgAttrIf",f:JO},4:{n:"PtgAttrChoose",f:KO},8:{n:"PtgAttrGoto",f:XO},16:{n:"PtgAttrSum",f:a8},32:{n:"PtgAttrBaxcel",f:Ih},33:{n:"PtgAttrBaxcel",f:Ih},64:{n:"PtgAttrSpace",f:YO},65:{n:"PtgAttrSpaceSemi",f:ZO},128:{n:"PtgAttrIfError",f:qO},255:{}};function G8(t,r,e,n){if(n.biff<8)return lo(t,r);for(var i=t.l+r,o=[],a=0;a!==e.length;++a)switch(e[a][0]){case"PtgArray":e[a][1]=h8(t,0,n),o.push(e[a][1]);break;case"PtgMemArea":e[a][2]=m8(t,e[a][1],n),o.push(e[a][2]);break;case"PtgExp":n&&n.biff==12&&(e[a][1][1]=t.read_shift(4),o.push(e[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+e[a][0];default:break}return r=i-t.l,r!==0&&o.push(lo(t,r)),o}function K8(t,r,e){for(var n=t.l+r,i,o,a=[];n!=t.l;)r=n-t.l,o=t[t.l],i=Fh[o]||Fh[j8[o]],(o===24||o===25)&&(i=(o===24?H8:$8)[t[t.l+1]]),!i||!i.f?lo(t,r):a.push([i.n,i.f(t,r,e)]);return a}function X8(t){for(var r=[],e=0;e<t.length;++e){for(var n=t[e],i=[],o=0;o<n.length;++o){var a=n[o];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}r.push(i.join(","))}return r.join(";")}var J8={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function q8(t,r){var e=t.lastIndexOf("!"),n=r.lastIndexOf("!");return e==-1&&n==-1?t+":"+r:e>0&&n>0&&t.slice(0,e).toLowerCase()==r.slice(0,n).toLowerCase()?t+":"+r.slice(n+1):(console.error("Cannot hydrate range",t,r),t+":"+r)}function Vg(t,r,e){if(!t)return"SH33TJSERR0";if(e.biff>8&&(!t.XTI||!t.XTI[r]))return t.SheetNames[r];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[r];if(e.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":t.XTI[r-1];if(!n)return"SH33TJSERR1";var i="";if(e.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return e.SID!=null?t.SheetNames[e.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Ah(t,r,e){var n=Vg(t,r,e);return n=="#REF"?n:Bs(n,e)}function Ya(t,r,e,n,i){var o=i&&i.biff||8,a={s:{c:0,r:0},e:{c:0,r:0}},l=[],c,f,m,C=0,y=0,k,S="";if(!t[0]||!t[0][0])return"";for(var M=-1,E="",A=0,x=t[0].length;A<x;++A){var F=t[0][A];switch(F[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),f=l.pop(),M>=0){switch(t[0][M][1][0]){case 0:E=Lr(" ",t[0][M][1][1]);break;case 1:E=Lr("\r",t[0][M][1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][M][1][0])}f=f+E,M=-1}l.push(f+J8[F[0]]+c);break;case"PtgIsect":c=l.pop(),f=l.pop(),l.push(f+" "+c);break;case"PtgUnion":c=l.pop(),f=l.pop(),l.push(f+","+c);break;case"PtgRange":c=l.pop(),f=l.pop(),l.push(q8(f,c));break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":m=Ts(F[1][1],a,i),l.push(Es(m,o));break;case"PtgRefN":m=e?Ts(F[1][1],e,i):F[1][1],l.push(Es(m,o));break;case"PtgRef3d":C=F[1][1],m=Ts(F[1][2],a,i),S=Ah(n,C,i);var L=S;l.push(S+"!"+Es(m,o));break;case"PtgFunc":case"PtgFuncVar":var K=F[1][0],te=F[1][1];K||(K=0),K&=127;var V=K==0?[]:l.slice(-K);l.length-=K,te==="User"&&(te=V.shift()),l.push(te+"("+V.join(",")+")");break;case"PtgBool":l.push(F[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(F[1]);break;case"PtgNum":l.push(String(F[1]));break;case"PtgStr":l.push('"'+F[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(F[1]);break;case"PtgAreaN":k=dh(F[1][1],e?{s:e}:a,i),l.push(h0(k,i));break;case"PtgArea":k=dh(F[1][1],a,i),l.push(h0(k,i));break;case"PtgArea3d":C=F[1][1],k=F[1][2],S=Ah(n,C,i),l.push(S+"!"+h0(k,i));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":y=F[1][2];var R=(n.names||[])[y-1]||(n[0]||[])[y],q=R?R.Name:"SH33TJSNAME"+String(y);q&&q.slice(0,6)=="_xlfn."&&!i.xlfn&&(q=q.slice(6)),l.push(q);break;case"PtgNameX":var ie=F[1][1];y=F[1][2];var de;if(i.biff<=5)ie<0&&(ie=-ie),n[ie]&&(de=n[ie][y]);else{var ye="";if(((n[ie]||[])[0]||[])[0]==14849||(((n[ie]||[])[0]||[])[0]==1025?n[ie][y]&&n[ie][y].itab>0&&(ye=n.SheetNames[n[ie][y].itab-1]+"!"):ye=n.SheetNames[y-1]+"!"),n[ie]&&n[ie][y])ye+=n[ie][y].Name;else if(n[0]&&n[0][y])ye+=n[0][y].Name;else{var _t=(Vg(n,ie,i)||"").split(";;");_t[y-1]?ye=_t[y-1]:ye+="SH33TJSERRX"}l.push(ye);break}de||(de={Name:"SH33TJSERRY"}),l.push(de.Name);break;case"PtgParen":var St="(",st=")";if(M>=0){switch(E="",t[0][M][1][0]){case 2:St=Lr(" ",t[0][M][1][1])+St;break;case 3:St=Lr("\r",t[0][M][1][1])+St;break;case 4:st=Lr(" ",t[0][M][1][1])+st;break;case 5:st=Lr("\r",t[0][M][1][1])+st;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][M][1][0])}M=-1}l.push(St+l.pop()+st);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":m={c:F[1][1],r:F[1][0]};var or={c:e.c,r:e.r};if(n.sharedf[Hr(m)]){var ot=n.sharedf[Hr(m)];l.push(Ya(ot,a,or,n,i))}else{var yr=!1;for(c=0;c!=n.arrayf.length;++c)if(f=n.arrayf[c],!(m.c<f[0].s.c||m.c>f[0].e.c)&&!(m.r<f[0].s.r||m.r>f[0].e.r)){l.push(Ya(f[1],a,or,n,i)),yr=!0;break}yr||l.push(F[1])}break;case"PtgArray":l.push("{"+X8(F[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":M=A;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+F[1].idx+"[#"+F[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(F));default:throw new Error("Unrecognized Formula Token: "+String(F))}var Vr=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&M>=0&&Vr.indexOf(t[0][A][0])==-1){F=t[0][M];var Cr=!0;switch(F[1][0]){case 4:Cr=!1;case 0:E=Lr(" ",F[1][1]);break;case 5:Cr=!1;case 1:E=Lr("\r",F[1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+F[1][0])}l.push((Cr?E:"")+l.pop()+(Cr?"":E)),M=-1}}if(l.length>1&&i.WTF)throw new Error("bad formula stack");return l[0]=="TRUE"?!0:l[0]=="FALSE"?!1:l[0]}function Q8(t){if(t==null){var r=oe(8);return r.write_shift(1,3),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,65535),r}else if(typeof t=="number")return fa(t);return fa(0)}function Y8(t,r,e,n,i){var o=ma(r,e,i),a=Q8(t.v),l=oe(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var f=oe(t.bf.length),m=0;m<t.bf.length;++m)f[m]=t.bf[m];var C=ii([o,a,l,f]);return C}function mc(t,r,e){var n=t.read_shift(4),i=K8(t,n,e),o=t.read_shift(4),a=o>0?G8(t,o,i,e):null;return[i,a]}var Z8=mc,hc=mc,eB=mc,tB=mc;function Ph(t){if((t|0)==t&&t<Math.pow(2,16)&&t>=0){var r=oe(11);return r.write_shift(4,3),r.write_shift(1,30),r.write_shift(2,t),r.write_shift(4,0),r}var e=oe(17);return e.write_shift(4,11),e.write_shift(1,31),e.write_shift(8,t),e.write_shift(4,0),e}function rB(t){var r=oe(10);return r.write_shift(4,2),r.write_shift(1,28),r.write_shift(1,t),r.write_shift(4,0),r}function iB(t){var r=oe(10);return r.write_shift(4,2),r.write_shift(1,29),r.write_shift(1,t?1:0),r.write_shift(4,0),r}function nB(t){var r=oe(7);r.write_shift(4,3+2*t.length),r.write_shift(1,23),r.write_shift(2,t.length);var e=oe(2*t.length);e.write_shift(2*t.length,t,"utf16le");var n=oe(4);return n.write_shift(4,0),ii([r,e,n])}function oB(t){var r=Nr(t),e=oe(15);return e.write_shift(4,7),e.write_shift(1,36),e.write_shift(4,r.r),e.write_shift(2,r.c|(t.charAt(0)=="$"?0:1)<<14|(t.match(/\$\d/)?0:1)<<15),e.write_shift(4,0),e}function aB(t,r){var e=t.lastIndexOf("!"),n=t.slice(0,e);t=t.slice(e+1);var i=Nr(t);n.charAt(0)=="'"&&(n=n.slice(1,-1).replace(/''/g,"'"));var o=oe(17);return o.write_shift(4,9),o.write_shift(1,58),o.write_shift(2,2+r.SheetNames.map(function(a){return a.toLowerCase()}).indexOf(n.toLowerCase())),o.write_shift(4,i.r),o.write_shift(2,i.c|(t.charAt(0)=="$"?0:1)<<14|(t.match(/\$\d/)?0:1)<<15),o.write_shift(4,0),o}function sB(t,r){var e=t.lastIndexOf("!"),n=t.slice(0,e);t=t.slice(e+1),n.charAt(0)=="'"&&(n=n.slice(1,-1).replace(/''/g,"'"));var i=oe(17);return i.write_shift(4,9),i.write_shift(1,60),i.write_shift(2,2+r.SheetNames.map(function(o){return o.toLowerCase()}).indexOf(n.toLowerCase())),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(4,0),i}function lB(t){var r=t.split(":"),e=r[0],n=oe(23);n.write_shift(4,15),e=r[0];var i=Nr(e);return n.write_shift(1,36),n.write_shift(4,i.r),n.write_shift(2,i.c|(e.charAt(0)=="$"?0:1)<<14|(e.match(/\$\d/)?0:1)<<15),n.write_shift(4,0),e=r[1],i=Nr(e),n.write_shift(1,36),n.write_shift(4,i.r),n.write_shift(2,i.c|(e.charAt(0)=="$"?0:1)<<14|(e.match(/\$\d/)?0:1)<<15),n.write_shift(4,0),n.write_shift(1,17),n.write_shift(4,0),n}function cB(t,r){var e=t.lastIndexOf("!"),n=t.slice(0,e);t=t.slice(e+1),n.charAt(0)=="'"&&(n=n.slice(1,-1).replace(/''/g,"'"));var i=t.split(":"),o=oe(27);o.write_shift(4,19);var a=i[0],l=Nr(a);return o.write_shift(1,58),o.write_shift(2,2+r.SheetNames.map(function(c){return c.toLowerCase()}).indexOf(n.toLowerCase())),o.write_shift(4,l.r),o.write_shift(2,l.c|(a.charAt(0)=="$"?0:1)<<14|(a.match(/\$\d/)?0:1)<<15),a=i[1],l=Nr(a),o.write_shift(1,58),o.write_shift(2,2+r.SheetNames.map(function(c){return c.toLowerCase()}).indexOf(n.toLowerCase())),o.write_shift(4,l.r),o.write_shift(2,l.c|(a.charAt(0)=="$"?0:1)<<14|(a.match(/\$\d/)?0:1)<<15),o.write_shift(1,17),o.write_shift(4,0),o}function uB(t,r){var e=t.lastIndexOf("!"),n=t.slice(0,e);t=t.slice(e+1),n.charAt(0)=="'"&&(n=n.slice(1,-1).replace(/''/g,"'"));var i=yi(t),o=oe(23);return o.write_shift(4,15),o.write_shift(1,59),o.write_shift(2,2+r.SheetNames.map(function(a){return a.toLowerCase()}).indexOf(n.toLowerCase())),o.write_shift(4,i.s.r),o.write_shift(4,i.e.r),o.write_shift(2,i.s.c),o.write_shift(2,i.e.c),o.write_shift(4,0),o}function dB(t,r){if(typeof t=="number")return Ph(t);if(typeof t=="boolean")return iB(t);if(/^#(DIV\/0!|GETTING_DATA|N\/A|NAME\?|NULL!|NUM!|REF!|VALUE!)$/.test(t))return rB(+so[t]);if(t.match(/^\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return oB(t);if(t.match(/^\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return lB(t);if(t.match(/^#REF!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return uB(t,r);if(t.match(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return aB(t,r);if(t.match(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5}):\$?(?:[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D]|[A-Z]{1,2})\$?(?:10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})$/))return cB(t,r);if(/^(?:'[^\\\/?*\[\]:]*'|[^'][^\\\/?*\[\]:'`~!@#$%^()\-=+{}|;,<.>]*)!#REF!$/.test(t))return sB(t,r);if(/^".*"$/.test(t))return nB(t);if(/^[+-]\d+$/.test(t))return Ph(parseInt(t,10));throw"Formula |"+t+"| not supported for XLSB"}var pB=dB,fB={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},zg={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},mB={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function hB(t){var r="of:="+t.replace(pc,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return r.replace(/;/g,"|").replace(/,/g,";")}function Ug(t){return t.replace(/!/,".").replace(/:/,":.")}var Is=typeof Map<"u";function eu(t,r,e){var n=0,i=t.length;if(e){if(Is?e.has(r):Object.prototype.hasOwnProperty.call(e,r)){for(var o=Is?e.get(r):e[r];n<o.length;++n)if(t[o[n]].t===r)return t.Count++,o[n]}}else for(;n<i;++n)if(t[n].t===r)return t.Count++,n;return t[i]={t:r},t.Count++,t.Unique++,e&&(Is?(e.has(r)||e.set(r,[]),e.get(r).push(i)):(Object.prototype.hasOwnProperty.call(e,r)||(e[r]=[]),e[r].push(i))),i}function gc(t,r){var e={min:t+1,max:t+1},n=-1;return r.MDW&&(ko=r.MDW),r.width!=null?e.customWidth=1:r.wpx!=null?n=Yl(r.wpx):r.wch!=null&&(n=r.wch),n>-1?(e.width=F0(n),e.customWidth=1):r.width!=null&&(e.width=r.width),r.hidden&&(e.hidden=!0),r.level!=null&&(e.outlineLevel=e.level=r.level),e}function Wg(t,r){if(t){var e=[.7,.7,.75,.75,.3,.3];r=="xlml"&&(e=[1,1,1,1,.5,.5]),t.left==null&&(t.left=e[0]),t.right==null&&(t.right=e[1]),t.top==null&&(t.top=e[2]),t.bottom==null&&(t.bottom=e[3]),t.header==null&&(t.header=e[4]),t.footer==null&&(t.footer=e[5])}}function jo(t,r,e){var n=e.revssf[r.z!=null?r.z:"General"],i=60,o=t.length;if(n==null&&e.ssf){for(;i<392;++i)if(e.ssf[i]==null){WA(r.z,i),e.ssf[i]=r.z,e.revssf[r.z]=n=i;break}}for(i=0;i!=o;++i)if(t[i].numFmtId===n)return i;return t[o]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},o}function gB(t,r,e){if(t&&t["!ref"]){var n=Fr(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+e+"): "+t["!ref"])}}function _B(t){if(t.length===0)return"";for(var r='<mergeCells count="'+t.length+'">',e=0;e!=t.length;++e)r+='<mergeCell ref="'+oi(t[e])+'"/>';return r+"</mergeCells>"}function xB(t,r,e,n,i){var o=!1,a={},l=null;if(n.bookType!=="xlsx"&&r.vbaraw){var c=r.SheetNames[e];try{r.Workbook&&(c=r.Workbook.Sheets[e].CodeName||c)}catch{}o=!0,a.codeName=Co(Bt(c))}if(t&&t["!outline"]){var f={summaryBelow:1,summaryRight:1};t["!outline"].above&&(f.summaryBelow=0),t["!outline"].left&&(f.summaryRight=0),l=(l||"")+Be("outlinePr",null,f)}!o&&!l||(i[i.length]=Be("sheetPr",l,a))}var vB=["objects","scenarios","selectLockedCells","selectUnlockedCells"],bB=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function yB(t){var r={sheet:1};return vB.forEach(function(e){t[e]!=null&&t[e]&&(r[e]="1")}),bB.forEach(function(e){t[e]!=null&&!t[e]&&(r[e]="0")}),t.password&&(r.password=Tg(t.password).toString(16).toUpperCase()),Be("sheetProtection",null,r)}function CB(t){return Wg(t),Be("pageMargins",null,t)}function wB(t,r){for(var e=["<cols>"],n,i=0;i!=r.length;++i)(n=r[i])&&(e[e.length]=Be("col",null,gc(i,n)));return e[e.length]="</cols>",e.join("")}function SB(t,r,e,n){var i=typeof t.ref=="string"?t.ref:oi(t.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var o=e.Workbook.Names,a=yi(i);a.s.r==a.e.r&&(a.e.r=yi(r["!ref"]).e.r,i=oi(a));for(var l=0;l<o.length;++l){var c=o[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref=Bs(e.SheetNames[n])+"!"+Os(i);break}}return l==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+e.SheetNames[n]+"'!"+i}),Be("autoFilter",null,{ref:i})}function kB(t,r,e,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Be("sheetViews",Be("sheetView",null,i),{})}function TB(t,r,e,n,i,o,a){if(t.c&&e["!comments"].push([r,t.c]),(t.v===void 0||t.t==="z"&&!(n||{}).sheetStubs)&&typeof t.f!="string"&&typeof t.z>"u")return"";var l="",c=t.t,f=t.v;if(t.t!=="z")switch(t.t){case"b":l=t.v?"1":"0";break;case"n":isNaN(t.v)?(t.t="e",l=$i[t.v=36]):isFinite(t.v)?l=""+t.v:(t.t="e",l=$i[t.v=7]);break;case"e":l=$i[t.v];break;case"d":if(n&&n.cellDates){var m=on(t.v,a);l=m.toISOString(),m.getUTCFullYear()<1900&&(l=l.slice(l.indexOf("T")+1).replace("Z",""))}else t=Ri(t),t.t="n",l=""+(t.v=Ci(on(t.v,a),a));typeof t.z>"u"&&(t.z=Ir[14]);break;default:l=t.v;break}var C=t.t=="z"||t.v==null?"":bi("v",Bt(l)),y={r},k=jo(n.cellXfs,t,n);switch(k!==0&&(y.s=k),t.t){case"n":break;case"d":y.t="d";break;case"b":y.t="b";break;case"e":y.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){C=bi("v",""+eu(n.Strings,t.v,n.revStrings)),y.t="s";break}else y.t="str";break}if(t.t!=c&&(t.t=c,t.v=f),typeof t.f=="string"&&t.f){var S=t.F&&t.F.slice(0,r.length)==r?{t:"array",ref:t.F}:null;C=Be("f",Bt(t.f),S)+(t.v!=null?C:"")}return t.l&&(t.l.display=Bt(l),e["!links"].push([r,t.l])),t.D&&(y.cm=1),Be("c",C,y)}function EB(t,r,e,n){var i=[],o=[],a=Fr(t["!ref"]),l="",c,f="",m=[],C=0,y=0,k=t["!rows"],S=t["!data"]!=null,M=S?t["!data"]:[],E={r:f},A,x=-1,F=(((n||{}).Workbook||{}).WBProps||{}).date1904;for(y=a.s.c;y<=a.e.c;++y)m[y]=lr(y);for(C=a.s.r;C<=a.e.r;++C){o=[],f=dr(C);var L=S?M[C]:[];for(y=a.s.c;y<=a.e.c;++y){c=m[y]+f;var K=S?L[y]:t[c];K!==void 0&&(l=TB(K,c,t,r,e,n,F))!=null&&o.push(l)}(o.length>0||k&&k[C])&&(E={r:f},k&&k[C]&&(A=k[C],A.hidden&&(E.hidden=1),x=-1,A.hpx?x=Zl(A.hpx):A.hpt&&(x=A.hpt),x>-1&&(E.ht=x,E.customHeight=1),A.level&&(E.outlineLevel=A.level)),i[i.length]=Be("row",o.join(""),E))}if(k)for(;C<k.length;++C)k&&k[C]&&(E={r:C+1},A=k[C],A.hidden&&(E.hidden=1),x=-1,A.hpx?x=Zl(A.hpx):A.hpt&&(x=A.hpt),x>-1&&(E.ht=x,E.customHeight=1),A.level&&(E.outlineLevel=A.level),i[i.length]=Be("row","",E));return i.join("")}function IB(t,r,e,n){var i=[ai,Be("worksheet",null,{xmlns:Za[0],"xmlns:r":hi.r})],o=e.SheetNames[t],a=0,l="",c=e.Sheets[o];c==null&&(c={});var f=c["!ref"]||"A1",m=Fr(f);if(m.e.c>16383||m.e.r>1048575){if(r.WTF)throw new Error("Range "+f+" exceeds format limit A1:XFD1048576");m.e.c=Math.min(m.e.c,16383),m.e.r=Math.min(m.e.c,1048575),f=oi(m)}n||(n={}),c["!comments"]=[];var C=[];xB(c,e,t,r,i),i[i.length]=Be("dimension",null,{ref:f}),i[i.length]=kB(c,r,t,e),r.sheetFormat&&(i[i.length]=Be("sheetFormatPr",null,{defaultRowHeight:r.sheetFormat.defaultRowHeight||"16",baseColWidth:r.sheetFormat.baseColWidth||"10",outlineLevelRow:r.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(i[i.length]=wB(c,c["!cols"])),i[a=i.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=EB(c,r,t,e,n),l.length>0&&(i[i.length]=l)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),c["!protect"]&&(i[i.length]=yB(c["!protect"])),c["!autofilter"]!=null&&(i[i.length]=SB(c["!autofilter"],c,e,t)),c["!merges"]!=null&&c["!merges"].length>0&&(i[i.length]=_B(c["!merges"]));var y=-1,k,S=-1;return c["!links"].length>0&&(i[i.length]="<hyperlinks>",c["!links"].forEach(function(M){M[1].Target&&(k={ref:M[0]},M[1].Target.charAt(0)!="#"&&(S=tr(n,-1,Bt(M[1].Target).replace(/#[\s\S]*$/,""),Kt.HLINK),k["r:id"]="rId"+S),(y=M[1].Target.indexOf("#"))>-1&&(k.location=Bt(M[1].Target.slice(y+1))),M[1].Tooltip&&(k.tooltip=Bt(M[1].Tooltip)),k.display=M[1].display,i[i.length]=Be("hyperlink",null,k))}),i[i.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(i[i.length]=CB(c["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&(i[i.length]=bi("ignoredErrors",Be("ignoredError",null,{numberStoredAsText:1,sqref:f}))),C.length>0&&(S=tr(n,-1,"../drawings/drawing"+(t+1)+".xml",Kt.DRAW),i[i.length]=Be("drawing",null,{"r:id":"rId"+S}),c["!drawing"]=C),c["!comments"].length>0&&(S=tr(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Kt.VML),i[i.length]=Be("legacyDrawing",null,{"r:id":"rId"+S}),c["!legacy"]=S),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function FB(t,r){var e={},n=t.l+r;e.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var o=t.read_shift(1);return t.l=n,o&7&&(e.level=o&7),o&16&&(e.hidden=!0),o&32&&(e.hpt=i/20),e}function AB(t,r,e){var n=oe(145),i=(e["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var o=320;i.hpx?o=Zl(i.hpx)*20:i.hpt&&(o=i.hpt*20),n.write_shift(2,o),n.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var l=0,c=n.l;n.l+=4;for(var f={r:t,c:0},m=e["!data"]!=null,C=0;C<16;++C)if(!(r.s.c>C+1<<10||r.e.c<C<<10)){for(var y=-1,k=-1,S=C<<10;S<C+1<<10;++S){f.c=S;var M=m?(e["!data"][f.r]||[])[f.c]:e[Hr(f)];M&&(y<0&&(y=S),k=S)}y<0||(++l,n.write_shift(4,y),n.write_shift(4,k))}var E=n.l;return n.l=c,n.write_shift(4,l),n.l=E,n.length>n.l?n.slice(0,n.l):n}function PB(t,r,e,n){var i=AB(n,e,r);(i.length>17||(r["!rows"]||[])[n])&&ve(t,0,i)}var DB=xa,OB=is;function BB(){}function MB(t,r){var e={},n=t[t.l];return++t.l,e.above=!(n&64),e.left=!(n&128),t.l+=18,e.name=FP(t,r-19),e}function RB(t,r,e){e==null&&(e=oe(84+4*t.length));var n=192;r&&(r.above&&(n&=-65),r.left&&(n&=-129)),e.write_shift(1,n);for(var i=1;i<3;++i)e.write_shift(1,0);return Jl({auto:1},e),e.write_shift(-4,-1),e.write_shift(-4,-1),sg(t,e),e.slice(0,e.l)}function LB(t){var r=An(t);return[r]}function NB(t,r,e){return e==null&&(e=oe(8)),ha(r,e)}function VB(t){var r=ga(t);return[r]}function zB(t,r,e){return e==null&&(e=oe(4)),_a(r,e)}function UB(t){var r=An(t),e=t.read_shift(1);return[r,e,"b"]}function WB(t,r,e){return e==null&&(e=oe(9)),ha(r,e),e.write_shift(1,t.v?1:0),e}function jB(t){var r=ga(t),e=t.read_shift(1);return[r,e,"b"]}function HB(t,r,e){return e==null&&(e=oe(5)),_a(r,e),e.write_shift(1,t.v?1:0),e}function $B(t){var r=An(t),e=t.read_shift(1);return[r,e,"e"]}function b0(t,r,e){return e==null&&(e=oe(9)),ha(r,e),e.write_shift(1,t.v),e}function GB(t){var r=ga(t),e=t.read_shift(1);return[r,e,"e"]}function y0(t,r,e){return e==null&&(e=oe(8)),_a(r,e),e.write_shift(1,t.v),e.write_shift(2,0),e.write_shift(1,0),e}function KB(t){var r=An(t),e=t.read_shift(4);return[r,e,"s"]}function XB(t,r,e){return e==null&&(e=oe(12)),ha(r,e),e.write_shift(4,r.v),e}function JB(t){var r=ga(t),e=t.read_shift(4);return[r,e,"s"]}function qB(t,r,e){return e==null&&(e=oe(8)),_a(r,e),e.write_shift(4,r.v),e}function QB(t){var r=An(t),e=ns(t);return[r,e,"n"]}function YB(t,r,e){return e==null&&(e=oe(16)),ha(r,e),fa(t.v,e),e}function ZB(t){var r=ga(t),e=ns(t);return[r,e,"n"]}function eM(t,r,e){return e==null&&(e=oe(12)),_a(r,e),fa(t.v,e),e}function tM(t){var r=An(t),e=q0(t);return[r,e,"n"]}function rM(t,r,e){return e==null&&(e=oe(12)),ha(r,e),lg(t.v,e),e}function iM(t){var r=ga(t),e=q0(t);return[r,e,"n"]}function nM(t,r,e){return e==null&&(e=oe(8)),_a(r,e),lg(t.v,e),e}function oM(t){var r=An(t),e=X0(t);return[r,e,"is"]}function aM(t){var r=An(t),e=Mi(t);return[r,e,"str"]}function sM(t,r,e){var n=t.v==null?"":String(t.v);return e==null&&(e=oe(12+4*t.v.length)),ha(r,e),ci(n,e),e.length>e.l?e.slice(0,e.l):e}function lM(t){var r=ga(t),e=Mi(t);return[r,e,"str"]}function cM(t,r,e){var n=t.v==null?"":String(t.v);return e==null&&(e=oe(8+4*n.length)),_a(r,e),ci(n,e),e.length>e.l?e.slice(0,e.l):e}function uM(t,r,e){var n=t.l+r,i=An(t);i.r=e["!row"];var o=t.read_shift(1),a=[i,o,"b"];if(e.cellFormula){t.l+=2;var l=hc(t,n-t.l,e);a[3]=Ya(l,null,i,e.supbooks,e)}else t.l=n;return a}function dM(t,r,e){var n=t.l+r,i=An(t);i.r=e["!row"];var o=t.read_shift(1),a=[i,o,"e"];if(e.cellFormula){t.l+=2;var l=hc(t,n-t.l,e);a[3]=Ya(l,null,i,e.supbooks,e)}else t.l=n;return a}function pM(t,r,e){var n=t.l+r,i=An(t);i.r=e["!row"];var o=ns(t),a=[i,o,"n"];if(e.cellFormula){t.l+=2;var l=hc(t,n-t.l,e);a[3]=Ya(l,null,i,e.supbooks,e)}else t.l=n;return a}function fM(t,r,e){var n=t.l+r,i=An(t);i.r=e["!row"];var o=Mi(t),a=[i,o,"str"];if(e.cellFormula){t.l+=2;var l=hc(t,n-t.l,e);a[3]=Ya(l,null,i,e.supbooks,e)}else t.l=n;return a}var mM=xa,hM=is;function gM(t,r){return r==null&&(r=oe(4)),r.write_shift(4,t),r}function _M(t,r){var e=t.l+r,n=xa(t,16),i=dc(t),o=Mi(t),a=Mi(t),l=Mi(t);t.l=e;var c={rfx:n,relId:i,loc:o,display:l};return a&&(c.Tooltip=a),c}function xM(t,r){var e=oe(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));is({s:Nr(t[0]),e:Nr(t[0])},e),J0("rId"+r,e);var n=t[1].Target.indexOf("#"),i=n==-1?"":t[1].Target.slice(n+1);return ci(i||"",e),ci(t[1].Tooltip||"",e),ci("",e),e.slice(0,e.l)}function vM(){}function bM(t,r,e){var n=t.l+r,i=cg(t,16),o=t.read_shift(1),a=[i];if(a[2]=o,e.cellFormula){var l=Z8(t,n-t.l,e);a[1]=l}else t.l=n;return a}function yM(t,r,e){var n=t.l+r,i=xa(t,16),o=[i];if(e.cellFormula){var a=tB(t,n-t.l,e);o[1]=a,t.l=n}else t.l=n;return o}function CM(t,r,e){e==null&&(e=oe(18));var n=gc(t,r);e.write_shift(-4,t),e.write_shift(-4,t),e.write_shift(4,(n.width||10)*256),e.write_shift(4,0);var i=0;return r.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),r.level&&(i|=r.level<<8),e.write_shift(2,i),e}var jg=["left","right","top","bottom","header","footer"];function wM(t){var r={};return jg.forEach(function(e){r[e]=ns(t,8)}),r}function SM(t,r){return r==null&&(r=oe(48)),Wg(t),jg.forEach(function(e){fa(t[e],r)}),r}function kM(t){var r=t.read_shift(2);return t.l+=28,{RTL:r&32}}function TM(t,r,e){e==null&&(e=oe(30));var n=924;return(((r||{}).Views||[])[0]||{}).RTL&&(n|=32),e.write_shift(2,n),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,100),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(4,0),e}function EM(t){var r=oe(24);return r.write_shift(4,4),r.write_shift(4,1),is(t,r),r}function IM(t,r){return r==null&&(r=oe(66)),r.write_shift(2,t.password?Tg(t.password):0),r.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(e){e[1]?r.write_shift(4,t[e[0]]!=null&&!t[e[0]]?1:0):r.write_shift(4,t[e[0]]!=null&&t[e[0]]?0:1)}),r}function FM(){}function AM(){}function PM(t,r,e,n,i,o,a,l){var c={r:e,c:n};if(r.c&&o["!comments"].push([Hr(c),r.c]),r.v===void 0)return!1;var f="";switch(r.t){case"b":f=r.v?"1":"0";break;case"d":r=Ri(r),r.z=r.z||Ir[14],r.v=Ci(on(r.v,l),l),r.t="n";break;case"n":case"e":f=""+r.v;break;default:f=r.v;break}switch(c.s=jo(i.cellXfs,r,i),r.l&&o["!links"].push([Hr(c),r.l]),r.t){case"s":case"str":return i.bookSST?(f=eu(i.Strings,r.v==null?"":String(r.v),i.revStrings),c.t="s",c.v=f,a?ve(t,18,qB(r,c)):ve(t,7,XB(r,c))):(c.t="str",a?ve(t,17,cM(r,c)):ve(t,6,sM(r,c))),!0;case"n":return r.v==(r.v|0)&&r.v>-1e3&&r.v<1e3?a?ve(t,13,nM(r,c)):ve(t,2,rM(r,c)):isFinite(r.v)?a?ve(t,16,eM(r,c)):ve(t,5,YB(r,c)):(c.t="e",isNaN(r.v)?a?ve(t,14,y0({t:"e",v:36},c)):ve(t,3,b0({t:"e",v:36},c)):a?ve(t,14,y0({t:"e",v:7},c)):ve(t,3,b0({t:"e",v:7},c))),!0;case"b":return c.t="b",a?ve(t,15,HB(r,c)):ve(t,4,WB(r,c)),!0;case"e":return c.t="e",a?ve(t,14,y0(r,c)):ve(t,3,b0(r,c)),!0}return a?ve(t,12,zB(r,c)):ve(t,1,NB(r,c)),!0}function DM(t,r,e,n,i){var o=Fr(r["!ref"]||"A1"),a="",l=[],c=(((i||{}).Workbook||{}).WBProps||{}).date1904;ve(t,145);var f=r["!data"]!=null,m=f?r["!data"][o.s.r]:[],C=o.e.r;r["!rows"]&&(C=Math.max(o.e.r,r["!rows"].length-1));for(var y=o.s.r;y<=C;++y)if(a=dr(y),f&&(m=r["!data"][y]),PB(t,r,o,y),!(f&&!m)){var k=!1;if(y<=o.e.r)for(var S=o.s.c;S<=o.e.c;++S){y===o.s.r&&(l[S]=lr(S));var M=f?m[S]:r[l[S]+a];if(!M){k=!1;continue}k=PM(t,M,y,S,n,r,k,c)}}ve(t,146)}function OM(t,r){!r||!r["!merges"]||(ve(t,177,gM(r["!merges"].length)),r["!merges"].forEach(function(e){ve(t,176,hM(e))}),ve(t,178))}function BM(t,r){!r||!r["!cols"]||(ve(t,390),r["!cols"].forEach(function(e,n){e&&ve(t,60,CM(n,e))}),ve(t,391))}function MM(t,r){!r||!r["!ref"]||(ve(t,648),ve(t,649,EM(Fr(r["!ref"]))),ve(t,650))}function RM(t,r,e){r["!links"].forEach(function(n){if(n[1].Target){var i=tr(e,-1,n[1].Target.replace(/#[\s\S]*$/,""),Kt.HLINK);ve(t,494,xM(n,i))}}),delete r["!links"]}function LM(t,r,e,n){if(r["!comments"].length>0){var i=tr(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Kt.VML);ve(t,551,J0("rId"+i)),r["!legacy"]=i}}function NM(t,r,e,n){if(r["!autofilter"]){var i=r["!autofilter"],o=typeof i.ref=="string"?i.ref:oi(i.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var a=e.Workbook.Names,l=yi(o);l.s.r==l.e.r&&(l.e.r=yi(r["!ref"]).e.r,o=oi(l));for(var c=0;c<a.length;++c){var f=a[c];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==n){f.Ref=Bs(e.SheetNames[n])+"!"+Os(o);break}}c==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:Bs(e.SheetNames[n])+"!"+Os(o)}),ve(t,161,is(Fr(o))),ve(t,162)}}function VM(t,r,e){ve(t,133),ve(t,137,TM(r,e)),ve(t,138),ve(t,134)}function zM(t,r){r["!protect"]&&ve(t,535,IM(r["!protect"]))}function UM(t,r,e,n){var i=Bi(),o=e.SheetNames[t],a=e.Sheets[o]||{},l=o;try{e&&e.Workbook&&(l=e.Workbook.Sheets[t].CodeName||l)}catch{}var c=Fr(a["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(r.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],ve(i,129),(e.vbaraw||a["!outline"])&&ve(i,147,RB(l,a["!outline"])),ve(i,148,OB(c)),VM(i,a,e.Workbook),BM(i,a,t,r,e),DM(i,a,t,r,e),zM(i,a),NM(i,a,e,t),OM(i,a),RM(i,a,n),a["!margins"]&&ve(i,476,SM(a["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&MM(i,a),LM(i,a,t,n),ve(i,130),i.end()}function WM(t,r){t.l+=10;var e=Mi(t,r-10);return{name:e}}var jM=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function HM(t){return!t.Workbook||!t.Workbook.WBProps?"false":oP(t.Workbook.WBProps.date1904)?"true":"false"}var $M=":][*?/\\".split("");function Hg(t,r){try{if(t=="")throw new Error("Sheet name cannot be blank");if(t.length>31)throw new Error("Sheet name cannot exceed 31 chars");if(t.charCodeAt(0)==39||t.charCodeAt(t.length-1)==39)throw new Error("Sheet name cannot start or end with apostrophe (')");if(t.toLowerCase()=="history")throw new Error("Sheet name cannot be 'History'");$M.forEach(function(e){if(t.indexOf(e)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")})}catch(e){if(r)return!1;throw e}return!0}function GM(t,r,e){t.forEach(function(n,i){Hg(n);for(var o=0;o<i;++o)if(n==t[o])throw new Error("Duplicate Sheet Name: "+n);if(e){var a=r&&r[i]&&r[i].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function KM(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var r=t.Workbook&&t.Workbook.Sheets||[];GM(t.SheetNames,r,!!t.vbaraw);for(var e=0;e<t.SheetNames.length;++e)gB(t.Sheets[t.SheetNames[e]],t.SheetNames[e],e);t.SheetNames.forEach(function(n,i){var o=t.Sheets[n];if(!(!o||!o["!autofilter"])){var a;t.Workbook||(t.Workbook={}),t.Workbook.Names||(t.Workbook.Names=[]),t.Workbook.Names.forEach(function(c){c.Name=="_xlnm._FilterDatabase"&&c.Sheet==i&&(a=c)});var l=Bs(n)+"!"+Os(o["!autofilter"].ref);a?a.Ref=l:t.Workbook.Names.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:l})}})}function XM(t){var r=[ai];r[r.length]=Be("workbook",null,{xmlns:Za[0],"xmlns:r":hi.r});var e=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(jM.forEach(function(l){t.Workbook.WBProps[l[0]]!=null&&t.Workbook.WBProps[l[0]]!=l[1]&&(n[l[0]]=t.Workbook.WBProps[l[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),r[r.length]=Be("workbookPr",null,n);var i=t.Workbook&&t.Workbook.Sheets||[],o=0;if(i&&i[0]&&i[0].Hidden){for(r[r.length]="<bookViews>",o=0;o!=t.SheetNames.length&&!(!i[o]||!i[o].Hidden);++o);o==t.SheetNames.length&&(o=0),r[r.length]='<workbookView firstSheet="'+o+'" activeTab="'+o+'"/>',r[r.length]="</bookViews>"}for(r[r.length]="<sheets>",o=0;o!=t.SheetNames.length;++o){var a={name:Bt(t.SheetNames[o].slice(0,31))};if(a.sheetId=""+(o+1),a["r:id"]="rId"+(o+1),i[o])switch(i[o].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}r[r.length]=Be("sheet",null,a)}return r[r.length]="</sheets>",e&&(r[r.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(r[r.length]=Be("definedName",Bt(l.Ref),c))}),r[r.length]="</definedNames>"),r.length>2&&(r[r.length]="</workbook>",r[1]=r[1].replace("/>",">")),r.join("")}function JM(t,r){var e={};return e.Hidden=t.read_shift(4),e.iTabID=t.read_shift(4),e.strRelID=I0(t,r-8),e.name=Mi(t),e}function qM(t,r){return r||(r=oe(127)),r.write_shift(4,t.Hidden),r.write_shift(4,t.iTabID),J0(t.strRelID,r),ci(t.name.slice(0,31),r),r.length>r.l?r.slice(0,r.l):r}function QM(t,r){var e={},n=t.read_shift(4);e.defaultThemeVersion=t.read_shift(4);var i=r>8?Mi(t):"";return i.length>0&&(e.CodeName=i),e.autoCompressPictures=!!(n&65536),e.backupFile=!!(n&64),e.checkCompatibility=!!(n&4096),e.date1904=!!(n&1),e.filterPrivacy=!!(n&8),e.hidePivotFieldList=!!(n&1024),e.promptedSolutions=!!(n&16),e.publishItems=!!(n&2048),e.refreshAllConnections=!!(n&262144),e.saveExternalLinkValues=!!(n&128),e.showBorderUnselectedTables=!!(n&4),e.showInkAnnotation=!!(n&32),e.showObjects=["all","placeholders","none"][n>>13&3],e.showPivotChartFilter=!!(n&32768),e.updateLinks=["userSet","never","always"][n>>8&3],e}function YM(t,r){r||(r=oe(72));var e=0;return t&&(t.date1904&&(e|=1),t.filterPrivacy&&(e|=8)),r.write_shift(4,e),r.write_shift(4,0),sg(t&&t.CodeName||"ThisWorkbook",r),r.slice(0,r.l)}function ZM(t,r,e){var n=t.l+r,i=t.read_shift(4);t.l+=1;var o=t.read_shift(4),a=AP(t),l,c="";try{l=eB(t,0,e);try{c=dc(t)}catch{}}catch{console.error("Could not parse defined name "+a)}i&32&&(a="_xlnm."+a),t.l=n;var f={Name:a,Ptg:l,Flags:i};return o<268435455&&(f.Sheet=o),c&&(f.Comment=c),f}function e6(t,r){var e=oe(9),n=0,i=t.Name;WP.indexOf(i)>-1&&(n|=32,i=i.slice(6)),e.write_shift(4,n),e.write_shift(1,0),e.write_shift(4,t.Sheet==null?4294967295:t.Sheet);var o=[e,ci(i),pB(t.Ref,r)];if(t.Comment)o.push(Ms(t.Comment));else{var a=oe(4);a.write_shift(4,4294967295),o.push(a)}return ii(o)}function t6(t,r){ve(t,143);for(var e=0;e!=r.SheetNames.length;++e){var n=r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[e]&&r.Workbook.Sheets[e].Hidden||0,i={Hidden:n,iTabID:e+1,strRelID:"rId"+(e+1),name:r.SheetNames[e]};ve(t,156,qM(i))}ve(t,144)}function r6(t,r){r||(r=oe(127));for(var e=0;e!=4;++e)r.write_shift(4,0);return ci("SheetJS",r),ci(Fs.version,r),ci(Fs.version,r),ci("7262",r),r.length>r.l?r.slice(0,r.l):r}function i6(t,r){r||(r=oe(29)),r.write_shift(-4,0),r.write_shift(-4,460),r.write_shift(4,28800),r.write_shift(4,17600),r.write_shift(4,500),r.write_shift(4,t),r.write_shift(4,t);var e=120;return r.write_shift(1,e),r.length>r.l?r.slice(0,r.l):r}function n6(t,r){if(!(!r.Workbook||!r.Workbook.Sheets)){for(var e=r.Workbook.Sheets,n=0,i=-1,o=-1;n<e.length;++n)!e[n]||!e[n].Hidden&&i==-1?i=n:e[n].Hidden==1&&o==-1&&(o=n);o>i||(ve(t,135),ve(t,158,i6(i)),ve(t,136))}}function o6(t,r){!r.Workbook||!r.Workbook.Names||r.Workbook.Names.forEach(function(e){try{if(e.Flags&14)return;ve(t,39,e6(e,r))}catch{console.error("Could not serialize defined name "+JSON.stringify(e))}})}function a6(t){var r=t.SheetNames.length,e=oe(12*r+28);e.write_shift(4,r+2),e.write_shift(4,0),e.write_shift(4,-2),e.write_shift(4,-2),e.write_shift(4,0),e.write_shift(4,-1),e.write_shift(4,-1);for(var n=0;n<r;++n)e.write_shift(4,0),e.write_shift(4,n),e.write_shift(4,n);return e}function s6(t,r){ve(t,353),ve(t,357),ve(t,362,a6(r,0)),ve(t,354)}function l6(t,r){var e=Bi();return ve(e,131),ve(e,128,r6()),ve(e,153,YM(t.Workbook&&t.Workbook.WBProps||null)),n6(e,t,r),t6(e,t,r),s6(e,t),(t.Workbook||{}).Names&&o6(e,t),ve(e,132),e.end()}function c6(t,r){var e=[];return t.Props&&e.push(KP(t.Props,r)),t.Custprops&&e.push(XP(t.Props,t.Custprops,r)),e.join("")}function u6(t){return(((t||{}).Workbook||{}).WBProps||{}).date1904?'<ExcelWorkbook xmlns="urn:schemas-microsoft-com:office:excel"><Date1904/></ExcelWorkbook>':""}function d6(t,r){var e=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return r.cellXfs.forEach(function(n,i){var o=[];o.push(Be("NumberFormat",null,{"ss:Format":Bt(Ir[n.numFmtId])}));var a={"ss:ID":"s"+(21+i)};e.push(Be("Style",o.join(""),a))}),Be("Styles",e.join(""))}function $g(t){return Be("NamedRange",null,{"ss:Name":t.Name.slice(0,6)=="_xlnm."?t.Name.slice(6):t.Name,"ss:RefersTo":"="+fc(t.Ref,{r:0,c:0})})}function p6(t){if(!((t||{}).Workbook||{}).Names)return"";for(var r=t.Workbook.Names,e=[],n=0;n<r.length;++n){var i=r[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||e.push($g(i)))}return Be("Names",e.join(""))}function f6(t,r,e,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,o=[],a=0;a<i.length;++a){var l=i[a];l.Sheet==e&&(l.Name.match(/^_xlfn\./)||o.push($g(l)))}return o.join("")}function m6(t,r,e,n){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(Be("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(Be("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(Be("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[e])if(n.Workbook.Sheets[e].Hidden)i.push(Be("Visible",n.Workbook.Sheets[e].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var o=0;o<e&&!(n.Workbook.Sheets[o]&&!n.Workbook.Sheets[o].Hidden);++o);o==e&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(bi("ProtectContents","True")),t["!protect"].objects&&i.push(bi("ProtectObjects","True")),t["!protect"].scenarios&&i.push(bi("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(bi("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(bi("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){t["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":Be("WorksheetOptions",i.join(""),{xmlns:mn.x})}function h6(t){return t.map(function(r){var e=nP(r.t||""),n=Be("ss:Data",e,{xmlns:"http://www.w3.org/TR/REC-html40"}),i={};return r.a&&(i["ss:Author"]=r.a),t.hidden||(i["ss:ShowAlways"]="1"),Be("Comment",n,i)}).join("")}function g6(t,r,e,n,i,o,a){if(!t||t.v==null&&t.f==null)return"";var l={};if(t.f&&(l["ss:Formula"]="="+Bt(fc(t.f,a))),t.F&&t.F.slice(0,r.length)==r){var c=Nr(t.F.slice(r.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==a.r?"":"["+(c.r-a.r)+"]")+"C"+(c.c==a.c?"":"["+(c.c-a.c)+"]")}if(t.l&&t.l.Target&&(l["ss:HRef"]=Bt(t.l.Target),t.l.Tooltip&&(l["x:HRefScreenTip"]=Bt(t.l.Tooltip))),e["!merges"])for(var f=e["!merges"],m=0;m!=f.length;++m)f[m].s.c!=a.c||f[m].s.r!=a.r||(f[m].e.c>f[m].s.c&&(l["ss:MergeAcross"]=f[m].e.c-f[m].s.c),f[m].e.r>f[m].s.r&&(l["ss:MergeDown"]=f[m].e.r-f[m].s.r));var C="",y="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":isFinite(t.v)?(C="Number",y=String(t.v)):(C="Error",y=$i[isNaN(t.v)?36:7]);break;case"b":C="Boolean",y=t.v?"1":"0";break;case"e":C="Error",y=$i[t.v];break;case"d":C="DateTime",y=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||Ir[14]);break;case"s":C="String",y=iP(t.v||"");break}var k=jo(n.cellXfs,t,n);l["ss:StyleID"]="s"+(21+k),l["ss:Index"]=a.c+1;var S=t.v!=null?y:"",M=t.t=="z"?"":'<Data ss:Type="'+C+'">'+S+"</Data>";return(t.c||[]).length>0&&(M+=h6(t.c)),Be("Cell",M,l)}function _6(t,r){var e='<Row ss:Index="'+(t+1)+'"';return r&&(r.hpt&&!r.hpx&&(r.hpx=Ig(r.hpt)),r.hpx&&(e+=' ss:AutoFitHeight="0" ss:Height="'+r.hpx+'"'),r.hidden&&(e+=' ss:Hidden="1"')),e+">"}function x6(t,r,e,n){if(!t["!ref"])return"";var i=Fr(t["!ref"]),o=t["!merges"]||[],a=0,l=[];t["!cols"]&&t["!cols"].forEach(function(E,A){Y0(E);var x=!!E.width,F=gc(A,E),L={"ss:Index":A+1};x&&(L["ss:Width"]=Ql(F.width)),E.hidden&&(L["ss:Hidden"]="1"),l.push(Be("Column",null,L))});for(var c=t["!data"]!=null,f={r:0,c:0},m=i.s.r;m<=i.e.r;++m){var C=[_6(m,(t["!rows"]||[])[m])];f.r=m;for(var y=i.s.c;y<=i.e.c;++y){f.c=y;var k=!1;for(a=0;a!=o.length;++a)if(!(o[a].s.c>y)&&!(o[a].s.r>m)&&!(o[a].e.c<y)&&!(o[a].e.r<m)){(o[a].s.c!=y||o[a].s.r!=m)&&(k=!0);break}if(!k){var S=lr(y)+dr(m),M=c?(t["!data"][m]||[])[y]:t[S];C.push(g6(M,S,t,r,e,n,f))}}C.push("</Row>"),C.length>2&&l.push(C.join(""))}return l.join("")}function v6(t,r,e){var n=[],i=e.SheetNames[t],o=e.Sheets[i],a=o?f6(o,r,t,e):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=o?x6(o,r,t,e):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(m6(o,r,t,e)),o&&o["!autofilter"]&&n.push('<AutoFilter x:Range="'+fc(Os(o["!autofilter"].ref),{r:0,c:0})+'" xmlns="urn:schemas-microsoft-com:office:excel"></AutoFilter>'),n.join("")}function b6(t,r){r||(r={}),t.SSF||(t.SSF=Ri(Ir)),t.SSF&&(sc(),ac(t.SSF),r.revssf=lc(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF,r.cellXfs=[],jo(r.cellXfs,{},{revssf:{General:0}}));var e=[];e.push(c6(t,r)),e.push(u6(t,r)),e.push(""),e.push(p6(t,r));for(var n=0;n<t.SheetNames.length;++n)e.push(Be("Worksheet",v6(n,r,t),{"ss:Name":Bt(t.SheetNames[n])}));return e[2]=d6(t,r),ai+Be("Workbook",e.join(""),{xmlns:mn.ss,"xmlns:o":mn.o,"xmlns:x":mn.x,"xmlns:ss":mn.ss,"xmlns:dt":mn.dt,"xmlns:html":mn.html})}var C0={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function y6(t,r){var e=[],n=[],i=[],o=0,a,l=rh(fh,"n"),c=rh(mh,"n");if(t.Props)for(a=ni(t.Props),o=0;o<a.length;++o)(Object.prototype.hasOwnProperty.call(l,a[o])?e:Object.prototype.hasOwnProperty.call(c,a[o])?n:i).push([a[o],t.Props[a[o]]]);if(t.Custprops)for(a=ni(t.Custprops),o=0;o<a.length;++o)Object.prototype.hasOwnProperty.call(t.Props||{},a[o])||(Object.prototype.hasOwnProperty.call(l,a[o])?e:Object.prototype.hasOwnProperty.call(c,a[o])?n:i).push([a[o],t.Custprops[a[o]]]);var f=[];for(o=0;o<i.length;++o)vg.indexOf(i[o][0])>-1||gg.indexOf(i[o][0])>-1||i[o][1]!=null&&f.push(i[o]);n.length&&pr.utils.cfb_add(r,"/SummaryInformation",vh(n,C0.SI,c,mh)),(e.length||f.length)&&pr.utils.cfb_add(r,"/DocumentSummaryInformation",vh(e,C0.DSI,l,fh,f.length?f:null,C0.UDI))}function C6(t,r){var e=r||{},n=pr.utils.cfb_new({root:"R"}),i="/Workbook";switch(e.bookType||"xls"){case"xls":e.bookType="biff8";case"xla":e.bookType||(e.bookType="xla");case"biff8":i="/Workbook",e.biff=8;break;case"biff5":i="/Book",e.biff=5;break;default:throw new Error("invalid type "+e.bookType+" for XLS CFB")}return pr.utils.cfb_add(n,i,Kg(t,e)),e.biff==8&&(t.Props||t.Custprops)&&y6(t,n),e.biff==8&&t.vbaraw&&DO(n,pr.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var w6={0:{f:FB},1:{f:LB},2:{f:tM},3:{f:$B},4:{f:UB},5:{f:QB},6:{f:aM},7:{f:KB},8:{f:fM},9:{f:pM},10:{f:uM},11:{f:dM},12:{f:VB},13:{f:iM},14:{f:GB},15:{f:jB},16:{f:ZB},17:{f:lM},18:{f:JB},19:{f:X0},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:ZM},40:{},42:{},43:{f:QD},44:{f:JD},45:{f:eO},46:{f:rO},47:{f:tO},48:{},49:{f:wP},50:{},51:{f:xO},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:ED},62:{f:oM},63:{f:kO},64:{f:FM},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:lo,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:kM},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:MB},148:{f:DB,p:16},151:{f:vM},152:{},153:{f:QM},154:{},155:{},156:{f:JM},157:{},158:{},159:{T:1,f:ND},160:{T:-1},161:{T:1,f:xa},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:mM},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:gO},336:{T:-1},337:{f:yO,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:I0},357:{},358:{},359:{},360:{T:1},361:{},362:{f:CD},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:bM},427:{f:yM},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:wM},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:BB},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:_M},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:I0},551:{f:dc},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:AO},633:{T:1},634:{T:-1},635:{T:1,f:IO},636:{T:-1},637:{f:EP},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:WM},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:AM},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Ae(t,r,e,n){var i=r;if(!isNaN(i)){var o=n||(e||[]).length||0,a=t.next(4);a.write_shift(2,i),a.write_shift(2,o),o>0&&$0(e)&&t.push(e)}}function S6(t,r,e,n){var i=n||(e||[]).length||0;if(i<=8224)return Ae(t,r,e,i);var o=r;if(!isNaN(o)){for(var a=e.parts||[],l=0,c=0,f=0;f+(a[l]||8224)<=8224;)f+=a[l]||8224,l++;var m=t.next(4);for(m.write_shift(2,o),m.write_shift(2,f),t.push(e.slice(c,c+f)),c+=f;c<i;){for(m=t.next(4),m.write_shift(2,60),f=0;f+(a[l]||8224)<=8224;)f+=a[l]||8224,l++;m.write_shift(2,f),t.push(e.slice(c,c+f)),c+=f}}}function w0(t,r,e,n){var i=oe(9);return Vs(i,t,r),bg(e,n||"b",i),i}function k6(t,r,e){var n=oe(8+2*e.length);return Vs(n,t,r),n.write_shift(1,e.length),n.write_shift(e.length,e,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function Gg(t,r){r.forEach(function(e){var n=e[0].map(function(o){return o.t}).join("");if(n.length<=2048)return Ae(t,28,x0(n,e[1],e[2]));Ae(t,28,x0(n.slice(0,2048),e[1],e[2],n.length));for(var i=2048;i<n.length;i+=2048)Ae(t,28,x0(n.slice(i,Math.min(i+2048,n.length)),-1,-1,Math.min(2048,n.length-i)))})}function T6(t,r,e,n,i,o){var a=0;r.z!=null&&(a=i._BIFF2FmtTable.indexOf(r.z),a==-1&&(i._BIFF2FmtTable.push(r.z),a=i._BIFF2FmtTable.length-1));var l=0;if(r.z!=null){for(;l<i.cellXfs.length&&i.cellXfs[l].numFmtId!=a;++l);l==i.cellXfs.length&&i.cellXfs.push({numFmtId:a})}if(r.v!=null)switch(r.t){case"d":case"n":var c=r.t=="d"?Ci(on(r.v,o),o):r.v;i.biff==2&&c==(c|0)&&c>=0&&c<65536?Ae(t,2,PD(e,n,c,l,a)):isNaN(c)?Ae(t,5,w0(e,n,36,"e")):isFinite(c)?Ae(t,3,AD(e,n,c,l,a)):Ae(t,5,w0(e,n,7,"e"));return;case"b":case"e":Ae(t,5,w0(e,n,r.v,r.t));return;case"s":case"str":Ae(t,4,k6(e,n,r.v==null?"":String(r.v).slice(0,255)));return}Ae(t,1,Vs(null,e,n))}function E6(t,r,e,n,i){var o=r["!data"]!=null,a=Fr(r["!ref"]||"A1"),l="",c=[];if(a.e.c>255||a.e.r>16383){if(n.WTF)throw new Error("Range "+(r["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.r,16383)}for(var f=(((i||{}).Workbook||{}).WBProps||{}).date1904,m=[],C=[],y=a.s.c;y<=a.e.c;++y)c[y]=lr(y);for(var k=a.s.r;k<=a.e.r;++k)for(o&&(m=r["!data"][k]||[]),l=dr(k),y=a.s.c;y<=a.e.c;++y){var S=o?m[y]:r[c[y]+l];S&&(T6(t,S,k,y,n,f),S.c&&C.push([S.c,k,y]))}Gg(t,C)}function I6(t,r){for(var e=r||{},n=Bi(),i=0,o=0;o<t.SheetNames.length;++o)t.SheetNames[o]==e.sheet&&(i=o);if(i==0&&e.sheet&&t.SheetNames[0]!=e.sheet)throw new Error("Sheet not found: "+e.sheet);Ae(n,e.biff==4?1033:e.biff==3?521:9,Q0(t,16,e)),((t.Workbook||{}).WBProps||{}).date1904&&Ae(n,34,Di(!0)),e.cellXfs=[{numFmtId:0}],e._BIFF2FmtTable=["General"],e._Fonts=[];var a=Bi();return E6(a,t.Sheets[t.SheetNames[i]],i,e,t),e._BIFF2FmtTable.forEach(function(l){e.biff<=3?Ae(n,30,hD(l)):Ae(n,1054,gD(l))}),e.cellXfs.forEach(function(l){switch(e.biff){case 2:Ae(n,67,xD(l));break;case 3:Ae(n,579,Sg(l));break;case 4:Ae(n,1091,vD(l));break}}),delete e._BIFF2FmtTable,delete e.cellXfs,delete e._Fonts,n.push(a.end()),Ae(n,10),n.end()}var Bn=1,In=[];function F6(){var t=oe(82+8*In.length);t.write_shift(2,15),t.write_shift(2,61440),t.write_shift(4,74+8*In.length);{t.write_shift(2,0),t.write_shift(2,61446),t.write_shift(4,16+8*In.length);{t.write_shift(4,Bn),t.write_shift(4,In.length+1);for(var r=0,e=0;e<In.length;++e)r+=In[e]&&In[e][1]||0;t.write_shift(4,r),t.write_shift(4,In.length)}In.forEach(function(n){t.write_shift(4,n[0]),t.write_shift(4,n[2])})}return t.write_shift(2,51),t.write_shift(2,61451),t.write_shift(4,18),t.write_shift(2,191),t.write_shift(4,524296),t.write_shift(2,385),t.write_shift(4,134217793),t.write_shift(2,448),t.write_shift(4,134217792),t.write_shift(2,64),t.write_shift(2,61726),t.write_shift(4,16),t.write_shift(4,134217741),t.write_shift(4,134217740),t.write_shift(4,134217751),t.write_shift(4,268435703),t}function A6(t,r){var e=[],n=0,i=Bi(),o=Bn,a;r.forEach(function(c,f){var m="",C=c[0].map(function(F){return F.a&&!m&&(m=F.a),F.t}).join("");++Bn;{var y=oe(150);y.write_shift(2,15),y.write_shift(2,61444),y.write_shift(4,150),y.write_shift(2,3234),y.write_shift(2,61450),y.write_shift(4,8),y.write_shift(4,Bn),y.write_shift(4,2560),y.write_shift(2,227),y.write_shift(2,61451),y.write_shift(4,84),y.write_shift(2,128),y.write_shift(4,0),y.write_shift(2,139),y.write_shift(4,2),y.write_shift(2,191),y.write_shift(4,524296),y.write_shift(2,344),y.l+=4,y.write_shift(2,385),y.write_shift(4,134217808),y.write_shift(2,387),y.write_shift(4,134217808),y.write_shift(2,389),y.write_shift(4,268435700),y.write_shift(2,447),y.write_shift(4,1048592),y.write_shift(2,448),y.write_shift(4,134217809),y.write_shift(2,451),y.write_shift(4,268435700),y.write_shift(2,513),y.write_shift(4,134217809),y.write_shift(2,515),y.write_shift(4,268435700),y.write_shift(2,575),y.write_shift(4,196609),y.write_shift(2,959),y.write_shift(4,131072|(c[0].hidden?2:0)),y.l+=2,y.write_shift(2,61456),y.write_shift(4,18),y.write_shift(2,3),y.write_shift(2,c[2]+2),y.l+=2,y.write_shift(2,c[1]+1),y.l+=2,y.write_shift(2,c[2]+4),y.l+=2,y.write_shift(2,c[1]+5),y.l+=2,y.l+=2,y.write_shift(2,61457),y.l+=4,y.l=150,f==0?a=y:Ae(i,236,y)}n+=150;{var k=oe(52);k.write_shift(2,21),k.write_shift(2,18),k.write_shift(2,25),k.write_shift(2,Bn),k.write_shift(2,0),k.l=22,k.write_shift(2,13),k.write_shift(2,22),k.write_shift(4,1651663474),k.write_shift(4,2503426821),k.write_shift(4,2150634280),k.write_shift(4,1768515844+Bn*256),k.write_shift(2,0),k.write_shift(4,0),k.l+=4,Ae(i,93,k)}{var S=oe(8);S.l+=2,S.write_shift(2,61453),S.l+=4,Ae(i,236,S)}n+=8;{var M=oe(18);M.write_shift(2,18),M.l+=8,M.write_shift(2,C.length),M.write_shift(2,16),M.l+=4,Ae(i,438,M);{var E=oe(1+C.length);E.write_shift(1,0),E.write_shift(C.length,C,"sbcs"),Ae(i,60,E)}{var A=oe(16);A.l+=8,A.write_shift(2,C.length),A.l+=6,Ae(i,60,A)}}{var x=oe(12+m.length);x.write_shift(2,c[1]),x.write_shift(2,c[2]),x.write_shift(2,0|(c[0].hidden?0:2)),x.write_shift(2,Bn),x.write_shift(2,m.length),x.write_shift(1,0),x.write_shift(m.length,m,"sbcs"),x.l++,e.push(x)}});{var l=oe(80);l.write_shift(2,15),l.write_shift(2,61442),l.write_shift(4,n+l.length-8),l.write_shift(2,16),l.write_shift(2,61448),l.write_shift(4,8),l.write_shift(4,r.length+1),l.write_shift(4,Bn),l.write_shift(2,15),l.write_shift(2,61443),l.write_shift(4,n+48),l.write_shift(2,15),l.write_shift(2,61444),l.write_shift(4,40),l.write_shift(2,1),l.write_shift(2,61449),l.write_shift(4,16),l.l+=16,l.write_shift(2,2),l.write_shift(2,61450),l.write_shift(4,8),l.write_shift(4,o),l.write_shift(4,5),Ae(t,236,a?ii([l,a]):l)}t.push(i.end()),e.forEach(function(c){Ae(t,28,c)}),In.push([o,r.length+1,Bn]),++Bn}function P6(t,r,e){Ae(t,49,dD({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},e))}function D6(t,r,e){r&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)r[i]!=null&&Ae(t,1054,mD(i,r[i],e))})}function O6(t,r){var e=oe(19);e.write_shift(4,2151),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,1),e.write_shift(4,0),Ae(t,2151,e),e=oe(39),e.write_shift(4,2152),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(2,1),e.write_shift(4,4),e.write_shift(2,0),wg(Fr(r["!ref"]||"A1"),e),e.write_shift(4,4),Ae(t,2152,e)}function B6(t,r){for(var e=0;e<16;++e)Ae(t,224,yh({numFmtId:0,style:!0},0,r));r.cellXfs.forEach(function(n){Ae(t,224,yh(n,0,r))})}function M6(t,r){for(var e=0;e<r["!links"].length;++e){var n=r["!links"][e];Ae(t,440,SD(n)),n[1].Tooltip&&Ae(t,2048,kD(n))}delete r["!links"]}function R6(t,r){if(r){var e=0;r.forEach(function(n,i){++e<=256&&n&&Ae(t,125,ID(gc(i,n),i))})}}function L6(t,r,e,n,i,o){var a=16+jo(i.cellXfs,r,i);if(r.v==null&&!r.bf){Ae(t,513,ma(e,n,a));return}if(r.bf)Ae(t,6,Y8(r,e,n,i,a));else switch(r.t){case"d":case"n":var l=r.t=="d"?Ci(on(r.v,o),o):r.v;isNaN(l)?Ae(t,517,_0(e,n,36,a,i,"e")):isFinite(l)?Ae(t,515,yD(e,n,l,a,i)):Ae(t,517,_0(e,n,7,a,i,"e"));break;case"b":case"e":Ae(t,517,_0(e,n,r.v,a,i,r.t));break;case"s":case"str":if(i.bookSST){var c=eu(i.Strings,r.v==null?"":String(r.v),i.revStrings);Ae(t,253,pD(e,n,c,a,i))}else Ae(t,516,fD(e,n,(r.v==null?"":String(r.v)).slice(0,255),a,i));break;default:Ae(t,513,ma(e,n,a))}}function N6(t,r,e){var n=Bi(),i=e.SheetNames[t],o=e.Sheets[i]||{},a=(e||{}).Workbook||{},l=(a.Sheets||[])[t]||{},c=o["!data"]!=null,f=r.biff==8,m,C="",y=[],k=Fr(o["!ref"]||"A1"),S=f?65536:16384;if(k.e.c>255||k.e.r>=S){if(r.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:IV"+S);k.e.c=Math.min(k.e.c,255),k.e.r=Math.min(k.e.r,S-1)}Ae(n,2057,Q0(e,16,r)),Ae(n,13,Fn(1)),Ae(n,12,Fn(100)),Ae(n,15,Di(!0)),Ae(n,17,Di(!1)),Ae(n,16,fa(.001)),Ae(n,95,Di(!0)),Ae(n,42,Di(!1)),Ae(n,43,Di(!1)),Ae(n,130,Fn(1)),Ae(n,128,bD([0,0])),Ae(n,131,Di(!1)),Ae(n,132,Di(!1)),f&&R6(n,o["!cols"]),Ae(n,512,_D(k,r));var M=(((e||{}).Workbook||{}).WBProps||{}).date1904;f&&(o["!links"]=[]);for(var E=k.s.c;E<=k.e.c;++E)y[E]=lr(E);for(var A=[],x=[],F=k.s.r;F<=k.e.r;++F)for(c&&(x=o["!data"][F]||[]),C=dr(F),E=k.s.c;E<=k.e.c;++E){var L=c?x[E]:o[y[E]+C];L&&(L6(n,L,F,E,r,M),f&&L.l&&o["!links"].push([y[E]+C,L.l]),L.c&&A.push([L.c,F,E]))}var K=l.CodeName||l.name||i;return f?A6(n,A):Gg(n,A),f&&Ae(n,574,uD((a.Views||[])[0])),f&&(o["!merges"]||[]).length&&Ae(n,229,wD(o["!merges"])),f&&M6(n,o),Ae(n,442,Cg(K,r)),f&&O6(n,o),Ae(n,10),n.end()}function V6(t,r,e){var n=Bi(),i=(t||{}).Workbook||{},o=i.Sheets||[],a=i.WBProps||{},l=e.biff==8,c=e.biff==5;if(Ae(n,2057,Q0(t,5,e)),e.bookType=="xla"&&Ae(n,135),Ae(n,225,l?Fn(1200):null),Ae(n,193,QP(2)),c&&Ae(n,191),c&&Ae(n,192),Ae(n,226),Ae(n,92,aD("SheetJS",e)),Ae(n,66,Fn(l?1200:1252)),l&&Ae(n,353,Fn(0)),l&&Ae(n,448),Ae(n,317,FD(t.SheetNames.length)),l&&t.vbaraw&&Ae(n,211),l&&t.vbaraw){var f=a.CodeName||"ThisWorkbook";Ae(n,442,Cg(f,e))}Ae(n,156,Fn(17)),Ae(n,25,Di(!1)),Ae(n,18,Di(!1)),Ae(n,19,Fn(0)),l&&Ae(n,431,Di(!1)),l&&Ae(n,444,Fn(0)),Ae(n,61,cD(e)),Ae(n,64,Di(!1)),Ae(n,141,Fn(0)),Ae(n,34,Di(HM(t)=="true")),Ae(n,14,Di(!0)),l&&Ae(n,439,Di(!1)),Ae(n,218,Fn(0)),P6(n,t,e),D6(n,t.SSF,e),B6(n,e),l&&Ae(n,352,Di(!1));var m=n.end(),C=Bi();l&&Ae(C,140,TD()),l&&In.length&&Ae(C,235,F6()),l&&e.Strings&&S6(C,252,lD(e.Strings,e)),Ae(C,10);var y=C.end(),k=Bi(),S=0,M=0;for(M=0;M<t.SheetNames.length;++M)S+=(l?12:11)+(l?2:1)*t.SheetNames[M].length;var E=m.length+S+y.length;for(M=0;M<t.SheetNames.length;++M){var A=o[M]||{};Ae(k,133,sD({pos:E,hs:A.Hidden||0,dt:0,name:t.SheetNames[M]},e)),E+=r[M].length}var x=k.end();if(S!=x.length)throw new Error("BS8 "+S+" != "+x.length);var F=[];return m.length&&F.push(m),x.length&&F.push(x),y.length&&F.push(y),ii(F)}function z6(t,r){var e=r||{},n=[];t&&!t.SSF&&(t.SSF=Ri(Ir)),t&&t.SSF&&(sc(),ac(t.SSF),e.revssf=lc(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),Bn=1,In=[],e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,tu(e),e.cellXfs=[],jo(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)n[n.length]=N6(i,e,t);return n.unshift(V6(t,n,e)),ii(n)}function Kg(t,r){for(var e=0;e<=t.SheetNames.length;++e){var n=t.Sheets[t.SheetNames[e]];if(!(!n||!n["!ref"])){var i=yi(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[e]+"' extends beyond column IV (255).  Data may be lost."),i.e.r>65535&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[e]+"' extends beyond row 65536.  Data may be lost.")}}var o=r||{};switch(o.biff||2){case 8:case 5:return z6(t,r);case 4:case 3:case 2:return I6(t,r)}throw new Error("invalid type "+o.bookType+" for BIFF")}function U6(t,r,e,n){for(var i=t["!merges"]||[],o=[],a={},l=t["!data"]!=null,c=r.s.c;c<=r.e.c;++c){for(var f=0,m=0,C=0;C<i.length;++C)if(!(i[C].s.r>e||i[C].s.c>c)&&!(i[C].e.r<e||i[C].e.c<c)){if(i[C].s.r<e||i[C].s.c<c){f=-1;break}f=i[C].e.r-i[C].s.r+1,m=i[C].e.c-i[C].s.c+1;break}if(!(f<0)){var y=lr(c)+dr(e),k=l?(t["!data"][e]||[])[c]:t[y];k&&k.t=="n"&&k.v!=null&&!isFinite(k.v)&&(isNaN(k.v)?k={t:"e",v:36,w:$i[36]}:k={t:"e",v:7,w:$i[7]});var S=k&&k.v!=null&&(k.h||f0(k.w||(Eo(k),k.w)||""))||"";a={},f>1&&(a.rowspan=f),m>1&&(a.colspan=m),n.editable?S='<span contenteditable="true">'+S+"</span>":k&&(a["data-t"]=k&&k.t||"z",k.v!=null&&(a["data-v"]=f0(k.v instanceof Date?k.v.toISOString():k.v)),k.z!=null&&(a["data-z"]=k.z),k.l&&(k.l.Target||"#").charAt(0)!="#"&&(S='<a href="'+f0(k.l.Target)+'">'+S+"</a>")),a.id=(n.id||"sjs")+"-"+y,o.push(Be("td",S,a))}}var M="<tr>";return M+o.join("")+"</tr>"}var W6='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',j6="</body></html>";function H6(t,r,e){var n=[];return n.join("")+"<table"+(e&&e.id?' id="'+e.id+'"':"")+">"}function Xg(t,r){var e=r||{},n=e.header!=null?e.header:W6,i=e.footer!=null?e.footer:j6,o=[n],a=yi(t["!ref"]||"A1");if(o.push(H6(t,a,e)),t["!ref"])for(var l=a.s.r;l<=a.e.r;++l)o.push(U6(t,a,l,e));return o.push("</table>"+i),o.join("")}function Jg(t,r,e){var n=r.rows;if(!n)throw"Unsupported origin when "+r.tagName+" is not a TABLE";var i=e||{},o=t["!data"]!=null,a=0,l=0;if(i.origin!=null)if(typeof i.origin=="number")a=i.origin;else{var c=typeof i.origin=="string"?Nr(i.origin):i.origin;a=c.r,l=c.c}var f=Math.min(i.sheetRows||1e7,n.length),m={s:{r:0,c:0},e:{r:a,c:l}};if(t["!ref"]){var C=yi(t["!ref"]);m.s.r=Math.min(m.s.r,C.s.r),m.s.c=Math.min(m.s.c,C.s.c),m.e.r=Math.max(m.e.r,C.e.r),m.e.c=Math.max(m.e.c,C.e.c),a==-1&&(m.e.r=a=C.e.r+1)}var y=[],k=0,S=t["!rows"]||(t["!rows"]=[]),M=0,E=0,A=0,x=0,F=0,L=0;for(t["!cols"]||(t["!cols"]=[]);M<n.length&&E<f;++M){var K=n[M];if(Dh(K)){if(i.display)continue;S[E]={hidden:!0}}var te=K.cells;for(A=x=0;A<te.length;++A){var V=te[A];if(!(i.display&&Dh(V))){var R=V.hasAttribute("data-v")?V.getAttribute("data-v"):V.hasAttribute("v")?V.getAttribute("v"):aP(V.innerHTML),q=V.getAttribute("data-z")||V.getAttribute("z");for(k=0;k<y.length;++k){var ie=y[k];ie.s.c==x+l&&ie.s.r<E+a&&E+a<=ie.e.r&&(x=ie.e.c+1-l,k=-1)}L=+V.getAttribute("colspan")||1,((F=+V.getAttribute("rowspan")||1)>1||L>1)&&y.push({s:{r:E+a,c:x+l},e:{r:E+a+(F||1)-1,c:x+l+(L||1)-1}});var de={t:"s",v:R},ye=V.getAttribute("data-t")||V.getAttribute("t")||"";R!=null&&(R.length==0?de.t=ye||"z":i.raw||R.trim().length==0||ye=="s"||(ye=="e"&&$i[+R]?de={t:"e",v:+R,w:$i[+R]}:R==="TRUE"?de={t:"b",v:!0}:R==="FALSE"?de={t:"b",v:!1}:isNaN(So(R))?isNaN(Kl(R).getDate())?R.charCodeAt(0)==35&&so[R]!=null&&(de={t:"e",v:so[R],w:R}):(de={t:"d",v:on(R)},i.UTC&&(de.v=cc(de.v)),i.cellDates||(de={t:"n",v:Ci(de.v)}),de.z=i.dateNF||Ir[14]):de={t:"n",v:So(R)})),de.z===void 0&&q!=null&&(de.z=q);var _t="",St=V.getElementsByTagName("A");if(St&&St.length)for(var st=0;st<St.length&&!(St[st].hasAttribute("href")&&(_t=St[st].getAttribute("href"),_t.charAt(0)!="#"));++st);_t&&_t.charAt(0)!="#"&&_t.slice(0,11).toLowerCase()!="javascript:"&&(de.l={Target:_t}),o?(t["!data"][E+a]||(t["!data"][E+a]=[]),t["!data"][E+a][x+l]=de):t[Hr({c:x+l,r:E+a})]=de,m.e.c<x+l&&(m.e.c=x+l),x+=L}}++E}return y.length&&(t["!merges"]=(t["!merges"]||[]).concat(y)),m.e.r=Math.max(m.e.r,E-1+a),t["!ref"]=oi(m),E>=f&&(t["!fullref"]=oi((m.e.r=n.length-M+E-1+a,m))),t}function qg(t,r){var e=r||{},n={};return e.dense&&(n["!data"]=[]),Jg(n,t,r)}function $6(t,r){var e=ts(qg(t,r),r);return e}function Dh(t){var r="",e=G6(t);return e&&(r=e(t).getPropertyValue("display")),r||(r=t.style&&t.style.display),r==="none"}function G6(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var K6=(function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),r="<office:document-styles "+Ds({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return ai+r}})();function X6(t,r){var e="number",n="",i={"style:name":r},o="",a=0;t=t.replace(/"[$]"/g,"$");e:{if(t.indexOf(";")>-1&&(console.error("Unsupported ODS Style Map exported.  Using first branch of "+t),t=t.slice(0,t.indexOf(";"))),t=="@"){e="text",n="<number:text-content/>";break e}if(t.indexOf(/\$/)>-1&&(e="currency"),t[a]=='"'){for(o="";t[++a]!='"'||t[++a]=='"';)o+=t[a];--a,t[a+1]=="*"?(a++,n+="<number:fill-character>"+Bt(o.replace(/""/g,'"'))+"</number:fill-character>"):n+="<number:text>"+Bt(o.replace(/""/g,'"'))+"</number:text>",t=t.slice(a+1),a=0}var l=t.match(/# (\?+)\/(\?+)/);if(l){n+=Be("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":l[1].length,"number:max-denominator-value":Math.max(+l[1].replace(/./g,"9"),+l[2].replace(/./g,"9"))});break e}if(l=t.match(/# (\?+)\/(\d+)/)){n+=Be("number:fraction",null,{"number:min-integer-digits":0,"number:min-numerator-digits":l[1].length,"number:denominator-value":+l[2]});break e}if(l=t.match(/\b(\d+)(|\.\d+)%/)){e="percentage",n+=Be("number:number",null,{"number:decimal-places":l[2]&&l.length-1||0,"number:min-decimal-places":l[2]&&l.length-1||0,"number:min-integer-digits":l[1].length})+"<number:text>%</number:text>";break e}var c=!1;if(["y","m","d"].indexOf(t[0])>-1){e="date";t:for(;a<t.length;++a)switch(o=t[a].toLowerCase()){case"h":case"s":c=!0,--a;break t;case"m":r:for(var f=a+1;f<t.length;++f)switch(t[f]){case"y":case"d":break r;case"h":case"s":c=!0,--a;break t}case"y":case"d":for(;(t[++a]||"").toLowerCase()==o[0];)o+=o[0];switch(--a,o){case"y":case"yy":n+="<number:year/>";break;case"yyy":case"yyyy":n+='<number:year number:style="long"/>';break;case"mmmmm":console.error("ODS has no equivalent of format |mmmmm|");case"m":case"mm":case"mmm":case"mmmm":n+='<number:month number:style="'+(o.length%2?"short":"long")+'" number:textual="'+(o.length>=3?"true":"false")+'"/>';break;case"d":case"dd":n+='<number:day number:style="'+(o.length%2?"short":"long")+'"/>';break;case"ddd":case"dddd":n+='<number:day-of-week number:style="'+(o.length%2?"short":"long")+'"/>';break}break;case'"':for(;t[++a]!='"'||t[++a]=='"';)o+=t[a];--a,n+="<number:text>"+Bt(o.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"\\":o=t[++a],n+="<number:text>"+Bt(o)+"</number:text>";break;case"/":case":":n+="<number:text>"+Bt(o)+"</number:text>";break;default:console.error("unrecognized character "+o+" in ODF format "+t)}if(!c)break e;t=t.slice(a+1),a=0}if(t.match(/^\[?[hms]/)){for(e=="number"&&(e="time"),t.match(/\[/)&&(t=t.replace(/[\[\]]/g,""),i["number:truncate-on-overflow"]="false");a<t.length;++a)switch(o=t[a].toLowerCase()){case"h":case"m":case"s":for(;(t[++a]||"").toLowerCase()==o[0];)o+=o[0];switch(--a,o){case"h":case"hh":n+='<number:hours number:style="'+(o.length%2?"short":"long")+'"/>';break;case"m":case"mm":n+='<number:minutes number:style="'+(o.length%2?"short":"long")+'"/>';break;case"s":case"ss":if(t[a+1]==".")do o+=t[a+1],++a;while(t[a+1]=="0");n+='<number:seconds number:style="'+(o.match("ss")?"long":"short")+'"'+(o.match(/\./)?' number:decimal-places="'+(o.match(/0+/)||[""])[0].length+'"':"")+"/>";break}break;case'"':for(;t[++a]!='"'||t[++a]=='"';)o+=t[a];--a,n+="<number:text>"+Bt(o.slice(1).replace(/""/g,'"'))+"</number:text>";break;case"/":case":":n+="<number:text>"+Bt(o)+"</number:text>";break;case"a":if(t.slice(a,a+3).toLowerCase()=="a/p"){n+="<number:am-pm/>",a+=2;break}if(t.slice(a,a+5).toLowerCase()=="am/pm"){n+="<number:am-pm/>",a+=4;break}default:console.error("unrecognized character "+o+" in ODF format "+t)}break e}if(t.indexOf(/\$/)>-1&&(e="currency"),t[0]=="$"&&(n+='<number:currency-symbol number:language="en" number:country="US">$</number:currency-symbol>',t=t.slice(1),a=0),a=0,t[a]=='"'){for(;t[++a]!='"'||t[++a]=='"';)o+=t[a];--a,t[a+1]=="*"?(a++,n+="<number:fill-character>"+Bt(o.replace(/""/g,'"'))+"</number:fill-character>"):n+="<number:text>"+Bt(o.replace(/""/g,'"'))+"</number:text>",t=t.slice(a+1),a=0}var m=t.match(/([#0][0#,]*)(\.[0#]*|)(E[+]?0*|)/i);if(!m||!m[0])console.error("Could not find numeric part of "+t);else{var C=m[1].replace(/,/g,"");n+="<number:"+(m[3]?"scientific-":"")+'number number:min-integer-digits="'+(C.indexOf("0")==-1?"0":C.length-C.indexOf("0"))+'"'+(m[0].indexOf(",")>-1?' number:grouping="true"':"")+(m[2]&&' number:decimal-places="'+(m[2].length-1)+'"'||' number:decimal-places="0"')+(m[3]&&m[3].indexOf("+")>-1?' number:forced-exponent-sign="true"':"")+(m[3]?' number:min-exponent-digits="'+m[3].match(/0+/)[0].length+'"':"")+"></number:"+(m[3]?"scientific-":"")+"number>",a=m.index+m[0].length}if(t[a]=='"'){for(o="";t[++a]!='"'||t[++a]=='"';)o+=t[a];--a,n+="<number:text>"+Bt(o.replace(/""/g,'"'))+"</number:text>"}}return n?Be("number:"+e+"-style",n,i):(console.error("Could not generate ODS number format for |"+t+"|"),"")}function Oh(t,r,e){for(var n=[],i=0;i<t.length;++i){var o=t[i];o&&o.Sheet==(e==-1?null:e)&&n.push(o)}return n.length?`      <table:named-expressions>
`+n.map(function(a){var l=(e==-1?"$":"")+Ug(a.Ref);return"        "+Be("table:named-range",null,{"table:name":a.Name,"table:cell-range-address":l,"table:base-cell-address":l.replace(/[\.][^\.]*$/,".$A$1")})}).join(`
`)+`
      </table:named-expressions>
`:""}var Bh=(function(){var t=function(i,o){return Bt(i).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,o?"<text:line-break/>":"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},r=`          <table:table-cell />
`,e=function(i,o,a,l,c,f){var m=[];m.push('      <table:table table:name="'+Bt(o.SheetNames[a])+`" table:style-name="ta1">
`);var C=0,y=0,k=yi(i["!ref"]||"A1"),S=i["!merges"]||[],M=0,E=i["!data"]!=null;if(i["!cols"])for(y=0;y<=k.e.c;++y)m.push("        <table:table-column"+(i["!cols"][y]?' table:style-name="co'+i["!cols"][y].ods+'"':"")+`></table:table-column>
`);var A="",x=i["!rows"]||[];for(C=0;C<k.s.r;++C)A=x[C]?' table:style-name="ro'+x[C].ods+'"':"",m.push("        <table:table-row"+A+`></table:table-row>
`);for(;C<=k.e.r;++C){for(A=x[C]?' table:style-name="ro'+x[C].ods+'"':"",m.push("        <table:table-row"+A+`>
`),y=0;y<k.s.c;++y)m.push(r);for(;y<=k.e.c;++y){var F=!1,L={},K="";for(M=0;M!=S.length;++M)if(!(S[M].s.c>y)&&!(S[M].s.r>C)&&!(S[M].e.c<y)&&!(S[M].e.r<C)){(S[M].s.c!=y||S[M].s.r!=C)&&(F=!0),L["table:number-columns-spanned"]=S[M].e.c-S[M].s.c+1,L["table:number-rows-spanned"]=S[M].e.r-S[M].s.r+1;break}if(F){m.push(`          <table:covered-table-cell/>
`);continue}var te=Hr({r:C,c:y}),V=E?(i["!data"][C]||[])[y]:i[te];if(V&&V.f&&(L["table:formula"]=Bt(hB(V.f)),V.F&&V.F.slice(0,te.length)==te)){var R=yi(V.F);L["table:number-matrix-columns-spanned"]=R.e.c-R.s.c+1,L["table:number-matrix-rows-spanned"]=R.e.r-R.s.r+1}if(!V){m.push(r);continue}switch(V.t){case"b":K=V.v?"TRUE":"FALSE",L["office:value-type"]="boolean",L["office:boolean-value"]=V.v?"true":"false";break;case"n":isFinite(V.v)?(K=V.w||String(V.v||0),L["office:value-type"]="float",L["office:value"]=V.v||0):(isNaN(V.v)?(K="#NUM!",L["table:formula"]="of:=#NUM!"):(K="#DIV/0!",L["table:formula"]="of:="+(V.v<0?"-":"")+"1/0"),L["office:string-value"]="",L["office:value-type"]="string",L["calcext:value-type"]="error");break;case"s":case"str":K=V.v==null?"":V.v,L["office:value-type"]="string";break;case"d":K=V.w||on(V.v,f).toISOString(),L["office:value-type"]="date",L["office:date-value"]=on(V.v,f).toISOString(),L["table:style-name"]="ce1";break;default:m.push(r);continue}var q=t(K);if(V.l&&V.l.Target){var ie=V.l.Target;ie=ie.charAt(0)=="#"?"#"+Ug(ie.slice(1)):ie,ie.charAt(0)!="#"&&!ie.match(/^\w+:/)&&(ie="../"+ie),q=Be("text:a",q,{"xlink:href":ie.replace(/&/g,"&amp;")})}c[V.z]&&(L["table:style-name"]="ce"+c[V.z].slice(1));var de=Be("text:p",q,{});if(V.c){for(var ye="",_t="",St={},st=0;st<V.c.length;++st)!ye&&V.c[st].a&&(ye=V.c[st].a),_t+="<text:p>"+t(V.c[st].t)+"</text:p>";V.c.hidden||(St["office:display"]=!0),de=Be("office:annotation",_t,St)+de}m.push("          "+Be("table:table-cell",de,L)+`
`)}m.push(`        </table:table-row>
`)}return(o.Workbook||{}).Names&&m.push(Oh(o.Workbook.Names,o.SheetNames,a)),m.push(`      </table:table>
`),m.join("")},n=function(i,o){i.push(` <office:automatic-styles>
`);var a=0;o.SheetNames.map(function(m){return o.Sheets[m]}).forEach(function(m){if(m&&m["!cols"]){for(var C=0;C<m["!cols"].length;++C)if(m["!cols"][C]){var y=m["!cols"][C];if(y.width==null&&y.wpx==null&&y.wch==null)continue;Y0(y),y.ods=a;var k=m["!cols"][C].wpx+"px";i.push('  <style:style style:name="co'+a+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+k+`"/>
`),i.push(`  </style:style>
`),++a}}});var l=0;o.SheetNames.map(function(m){return o.Sheets[m]}).forEach(function(m){if(m&&m["!rows"]){for(var C=0;C<m["!rows"].length;++C)if(m["!rows"][C]){m["!rows"][C].ods=l;var y=m["!rows"][C].hpx+"px";i.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+y+`"/>
`),i.push(`  </style:style>
`),++l}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var c={},f=69;return o.SheetNames.map(function(m){return o.Sheets[m]}).forEach(function(m){if(m){var C=m["!data"]!=null;if(m["!ref"])for(var y=yi(m["!ref"]),k=0;k<=y.e.r;++k)for(var S=0;S<=y.e.c;++S){var M=C?(m["!data"][k]||[])[S]:m[Hr({r:k,c:S})];if(!(!M||!M.z||M.z.toLowerCase()=="general")&&!c[M.z]){var E=X6(M.z,"N"+f);E&&(c[M.z]="N"+f,++f,i.push(E+`
`))}}}}),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),ni(c).forEach(function(m){i.push('<style:style style:name="ce'+c[m].slice(1)+'" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="'+c[m]+`"/>
`)}),i.push(` </office:automatic-styles>
`),c};return function(o,a){var l=[ai],c=Ds({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=Ds({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});a.bookType=="fods"?(l.push("<office:document"+c+f+`>
`),l.push(mg().replace(/<office:document-meta[^<>]*?>/,"").replace(/<\/office:document-meta>/,"")+`
`)):l.push("<office:document-content"+c+`>
`);var m=n(l,o);l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`),((o.Workbook||{}).WBProps||{}).date1904&&l.push(`      <table:calculation-settings table:case-sensitive="false" table:search-criteria-must-apply-to-whole-cell="true" table:use-wildcards="true" table:use-regular-expressions="false" table:automatic-find-labels="false">
        <table:null-date table:date-value="1904-01-01"/>
      </table:calculation-settings>
`);for(var C=0;C!=o.SheetNames.length;++C)l.push(e(o.Sheets[o.SheetNames[C]],o,C,a,m,((o.Workbook||{}).WBProps||{}).date1904));return(o.Workbook||{}).Names&&l.push(Oh(o.Workbook.Names,o.SheetNames,-1)),l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),a.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}})();function Qg(t,r){if(r.bookType=="fods")return Bh(t,r);var e=L0(),n="",i=[],o=[];return n="mimetype",Ot(e,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Ot(e,n,Bh(t,r)),i.push([n,"text/xml"]),o.push([n,"ContentFile"]),n="styles.xml",Ot(e,n,K6(t,r)),i.push([n,"text/xml"]),o.push([n,"StylesFile"]),n="meta.xml",Ot(e,n,ai+mg()),i.push([n,"text/xml"]),o.push([n,"MetadataFile"]),n="manifest.rdf",Ot(e,n,GP(o)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Ot(e,n,HP(i)),e}var Hi=(function(){try{return typeof Uint8Array>"u"||typeof Uint8Array.prototype.subarray>"u"?"slice":typeof Buffer<"u"?typeof Buffer.prototype.subarray>"u"?"slice":(typeof Buffer.from=="function"?Buffer.from([72,62]):new Buffer([72,62]))instanceof Uint8Array?"subarray":"slice":"subarray"}catch{return"slice"}})();function ec(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Rs(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):$a(da(t))}function Ui(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):fn(Co(t))}function Wo(t){for(var r=0,e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0;e<t.length;++e){var o=t[e],a=o.length;if(a<250)for(var l=0;l<a;++l)n[i++]=o[l];else n.set(o,i),i+=a}return n}function J6(t,r,e){var n=Math.floor(e==0?0:Math.LOG10E*Math.log(Math.abs(e)))+6176-16,i=e/Math.pow(10,n-6176);t[r+15]|=n>>7,t[r+14]|=(n&127)<<1;for(var o=0;i>=1;++o,i/=256)t[r+o]=i&255;t[r+15]|=e>=0?0:128}function Ls(t,r){var e=r.l,n=t[e]&127;e:if(t[e++]>=128&&(n|=(t[e]&127)<<7,t[e++]<128||(n|=(t[e]&127)<<14,t[e++]<128)||(n|=(t[e]&127)<<21,t[e++]<128)||(n+=(t[e]&127)*Math.pow(2,28),++e,t[e++]<128)||(n+=(t[e]&127)*Math.pow(2,35),++e,t[e++]<128)||(n+=(t[e]&127)*Math.pow(2,42),++e,t[e++]<128)))break e;return r.l=e,n}function nt(t){var r=new Uint8Array(7);r[0]=t&127;var e=1;e:if(t>127){if(r[e-1]|=128,r[e]=t>>7&127,++e,t<=16383||(r[e-1]|=128,r[e]=t>>14&127,++e,t<=2097151)||(r[e-1]|=128,r[e]=t>>21&127,++e,t<=268435455)||(r[e-1]|=128,r[e]=t/256>>>21&127,++e,t<=34359738367)||(r[e-1]|=128,r[e]=t/65536>>>21&127,++e,t<=4398046511103))break e;r[e-1]|=128,r[e]=t/16777216>>>21&127,++e}return r[Hi](0,e)}function Yg(t){for(var r={l:0},e=[];r.l<t.length;)e.push(Ls(t,r));return e}function Zg(t){return Wo(t.map(function(r){return nt(r)}))}function gn(t){var r=0,e=t[r]&127;return t[r++]<128||(e|=(t[r]&127)<<7,t[r++]<128)||(e|=(t[r]&127)<<14,t[r++]<128)||(e|=(t[r]&127)<<21,t[r++]<128)||(e|=(t[r]&15)<<28),e}function gt(t){for(var r=[],e={l:0};e.l<t.length;){var n=e.l,i=Ls(t,e),o=i&7;i=i/8|0;var a,l=e.l;switch(o){case 0:{for(;t[l++]>=128;);a=t[Hi](e.l,l),e.l=l}break;case 1:a=t[Hi](l,l+8),e.l=l+8;break;case 2:{var c=Ls(t,e);a=t[Hi](e.l,e.l+c),e.l+=c}break;case 5:a=t[Hi](l,l+4),e.l=l+4;break;default:throw new Error("PB Type ".concat(o," for Field ").concat(i," at offset ").concat(n))}var f={data:a,type:o};r[i]==null&&(r[i]=[]),r[i].push(f)}return r}function at(t){var r=[];return t.forEach(function(e,n){n!=0&&e.forEach(function(i){i.data&&(r.push(nt(n*8+i.type)),i.type==2&&r.push(nt(i.data.length)),r.push(i.data))})}),Wo(r)}function tc(t,r){return t?.map(function(e){return r(e.data)})||[]}function rc(t){for(var r,e=[],n={l:0};n.l<t.length;){var i=Ls(t,n),o=gt(t[Hi](n.l,n.l+i));n.l+=i;var a={id:gn(o[1][0].data),messages:[]};o[2].forEach(function(l){var c=gt(l.data),f=gn(c[3][0].data);a.messages.push({meta:c,data:t[Hi](n.l,n.l+f)}),n.l+=f}),(r=o[3])!=null&&r[0]&&(a.merge=gn(o[3][0].data)>>>0>0),e.push(a)}return e}function Xa(t){var r=[];return t.forEach(function(e){var n=[[],[{data:nt(e.id),type:0}],[]];e.merge!=null&&(n[3]=[{data:nt(+!!e.merge),type:0}]);var i=[];e.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:nt(a.data.length)}],n[2].push({data:at(a.meta),type:2})});var o=at(n);r.push(nt(o.length)),r.push(o),i.forEach(function(a){return r.push(a)})}),Wo(r)}function q6(t,r){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var e={l:0},n=Ls(r,e),i=[],o=e.l;o<r.length;){var a=r[o]&3;if(a==0){var l=r[o++]>>2;if(l<60)++l;else{var c=l-59;l=r[o],c>1&&(l|=r[o+1]<<8),c>2&&(l|=r[o+2]<<16),c>3&&(l|=r[o+3]<<24),l>>>=0,l++,o+=c}i.push(r[Hi](o,o+l)),o+=l;continue}else{var f=0,m=0;if(a==1?(m=(r[o]>>2&7)+4,f=(r[o++]&224)<<3,f|=r[o++]):(m=(r[o++]>>2)+1,a==2?(f=r[o]|r[o+1]<<8,o+=2):(f=(r[o]|r[o+1]<<8|r[o+2]<<16|r[o+3]<<24)>>>0,o+=4)),f==0)throw new Error("Invalid offset 0");for(var C=i.length-1,y=f;C>=0&&y>=i[C].length;)y-=i[C].length,--C;if(C<0)if(y==0)y=i[C=0].length;else throw new Error("Invalid offset beyond length");if(m<y)i.push(i[C][Hi](i[C].length-y,i[C].length-y+m));else{for(y>0&&(i.push(i[C][Hi](i[C].length-y)),m-=y),++C;m>=i[C].length;)i.push(i[C]),m-=i[C].length,++C;m&&i.push(i[C][Hi](0,m))}i.length>25&&(i=[Wo(i)])}}for(var k=0,S=0;S<i.length;++S)k+=i[S].length;if(k!=n)throw new Error("Unexpected length: ".concat(k," != ").concat(n));return i}function ic(t){Array.isArray(t)&&(t=new Uint8Array(t));for(var r=[],e=0;e<t.length;){var n=t[e++],i=t[e]|t[e+1]<<8|t[e+2]<<16;e+=3,r.push.apply(r,q6(n,t[Hi](e,e+i))),e+=i}if(e!==t.length)throw new Error("data is not a valid framed stream!");return r.length==1?r[0]:Wo(r)}function Ja(t){for(var r=[],e=0;e<t.length;){var n=Math.min(t.length-e,268435455),i=new Uint8Array(4);r.push(i);var o=nt(n),a=o.length;r.push(o),n<=60?(a++,r.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,r.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,r.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,r.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,r.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),r.push(t[Hi](e,e+n)),a+=n,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,e+=n}return Wo(r)}function S0(t,r){var e=new Uint8Array(32),n=ec(e),i=12,o=0;switch(e[0]=5,t.t){case"n":if(t.z&&pa(t.z)){e[1]=5,n.setFloat64(i,(Ha(t.v+1462).getTime()-Date.UTC(2001,0,1))/1e3,!0),o|=4,i+=8;break}else e[1]=2,J6(e,i,t.v),o|=1,i+=16;break;case"b":e[1]=6,n.setFloat64(i,t.v?1:0,!0),o|=2,i+=8;break;case"s":{var a=t.v==null?"":String(t.v);if(t.l){var l=r.rsst.findIndex(function(f){var m;return f.v==a&&f.l==((m=t.l)==null?void 0:m.Target)});l==-1&&(r.rsst[l=r.rsst.length]={v:a,l:t.l.Target}),e[1]=9,n.setUint32(i,l,!0),o|=16,i+=4}else{var c=r.sst.indexOf(a);c==-1&&(r.sst[c=r.sst.length]=a),e[1]=3,n.setUint32(i,c,!0),o|=8,i+=4}}break;case"d":e[1]=5,n.setFloat64(i,(t.v.getTime()-Date.UTC(2001,0,1))/1e3,!0),o|=4,i+=8;break;case"z":e[1]=0;break;default:throw"unsupported cell type "+t.t}return t.c&&(r.cmnt.push(Q6(t.c)),n.setUint32(i,r.cmnt.length-1,!0),o|=524288,i+=4),n.setUint32(8,o,!0),e[Hi](0,i)}function k0(t,r){var e=new Uint8Array(32),n=ec(e),i=12,o=0,a="";switch(e[0]=4,t.t){case"n":break;case"b":break;case"s":if(a=t.v==null?"":String(t.v),t.l){var l=r.rsst.findIndex(function(f){var m;return f.v==a&&f.l==((m=t.l)==null?void 0:m.Target)});l==-1&&(r.rsst[l=r.rsst.length]={v:a,l:t.l.Target}),e[1]=9,n.setUint32(i,l,!0),o|=512,i+=4}break;case"d":break;case"e":break;case"z":break;default:throw"unsupported cell type "+t.t}switch(t.c&&(n.setUint32(i,r.cmnt.length-1,!0),o|=4096,i+=4),t.t){case"n":e[1]=2,n.setFloat64(i,t.v,!0),o|=32,i+=8;break;case"b":e[1]=6,n.setFloat64(i,t.v?1:0,!0),o|=32,i+=8;break;case"s":if(a=t.v==null?"":String(t.v),!t.l){var c=r.sst.indexOf(a);c==-1&&(r.sst[c=r.sst.length]=a),e[1]=3,n.setUint32(i,c,!0),o|=16,i+=4}break;case"d":e[1]=5,n.setFloat64(i,(t.v.getTime()-Date.UTC(2001,0,1))/1e3,!0),o|=64,i+=8;break;case"z":e[1]=0;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,o,!0),e[Hi](0,i)}function ri(t){var r=gt(t);return gn(r[1][0].data)}function Pi(t){return at([[],[{type:0,data:nt(t)}]])}function Ai(t,r){var e,n=(e=t.messages[0].meta[5])!=null&&e[0]?Yg(t.messages[0].meta[5][0].data):[],i=n.indexOf(r);i==-1&&(n.push(r),t.messages[0].meta[5]=[{type:2,data:Zg(n)}])}function yo(t,r){var e,n=(e=t.messages[0].meta[5])!=null&&e[0]?Yg(t.messages[0].meta[5][0].data):[];t.messages[0].meta[5]=[{type:2,data:Zg(n.filter(function(i){return i!=r}))}]}function Q6(t){for(var r={a:"",t:"",replies:[]},e=0;e<t.length;++e)e==0?(r.a=t[e].a,r.t=t[e].t):r.replies.push({a:t[e].a,t:t[e].t});return r}function Y6(t,r,e){var n,i,o,a=[[],[{type:0,data:nt(0)}],[{type:0,data:nt(0)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},function(){return 255}))}],[{type:0,data:nt(5)}],[{type:2,data:new Uint8Array([])}],[{type:2,data:new Uint8Array(Array.from({length:510},function(){return 255}))}],[{type:0,data:nt(1)}]];if(!((n=a[6])!=null&&n[0])||!((i=a[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var l=0;if(a[7][0].data.length<2*t.length){var c=new Uint8Array(2*t.length);c.set(a[7][0].data),a[7][0].data=c}if(a[4][0].data.length<2*t.length){var f=new Uint8Array(2*t.length);f.set(a[4][0].data),a[4][0].data=f}for(var m=ec(a[7][0].data),C=0,y=[],k=ec(a[4][0].data),S=0,M=[],E=e?4:1,A=0;A<t.length;++A){if(t[A]==null||t[A].t=="z"&&!((o=t[A].c)!=null&&o.length)||t[A].t=="e"){m.setUint16(A*2,65535,!0),k.setUint16(A*2,65535);continue}m.setUint16(A*2,C/E,!0),k.setUint16(A*2,S/E,!0);var x,F;switch(t[A].t){case"d":if(t[A].v instanceof Date){x=S0(t[A],r),F=k0(t[A],r);break}x=S0(t[A],r),F=k0(t[A],r);break;case"s":case"n":case"b":case"z":x=S0(t[A],r),F=k0(t[A],r);break;default:throw new Error("Unsupported value "+t[A])}y.push(x),C+=x.length,M.push(F),S+=F.length,++l}for(a[2][0].data=nt(l),a[5][0].data=nt(5);A<a[7][0].data.length/2;++A)m.setUint16(A*2,65535,!0),k.setUint16(A*2,65535,!0);return a[6][0].data=Wo(y),a[3][0].data=Wo(M),a[8]=[{type:0,data:nt(e?1:0)}],a}function A0(t,r){return{meta:[[],[{type:0,data:nt(t)}]],data:r}}function no(t,r){r.last||(r.last=927262);for(var e=r.last;e<2e6;++e)if(!r[e])return r[r.last=e]=t,e;throw new Error("Too many messages")}function Z6(t){var r={},e=[];return t.FileIndex.map(function(n,i){return[n,t.FullPaths[i]]}).forEach(function(n){var i=n[0],o=n[1];i.type==2&&i.name.match(/\.iwa/)&&i.content[0]==0&&rc(ic(i.content)).forEach(function(a){e.push(a.id),r[a.id]={deps:[],location:o,type:gn(a.messages[0].meta[1][0].data)}})}),t.FileIndex.forEach(function(n){n.name.match(/\.iwa/)&&n.content[0]==0&&rc(ic(n.content)).forEach(function(i){i.messages.forEach(function(o){[5,6].forEach(function(a){o.meta[a]&&o.meta[a].forEach(function(l){r[i.id].deps.push(gn(l.data))})})})})}),r}function Vl(t,r,e){return at([[],[{type:0,data:nt(1)}],[],[{type:5,data:new Uint8Array(Float32Array.from([t/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([r/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([e/255]).buffer)}],[{type:5,data:new Uint8Array(Float32Array.from([1]).buffer)}],[],[],[],[],[],[{type:0,data:nt(1)}]])}function Mh(t){switch(t){case 0:return Vl(99,222,171);case 1:return Vl(162,197,240);case 2:return Vl(255,189,189)}return Vl(Math.random()*255,Math.random()*255,Math.random()*255)}function eR(t,r){if(!r||!r.numbers)throw new Error("Must pass a `numbers` option -- check the README");var e=pr.read(r.numbers,{type:"base64"}),n=Z6(e),i=oo(e,n,1);if(i==null)throw"Could not find message ".concat(1," in Numbers template");var o=tc(gt(i.messages[0].data)[1],ri);if(o.length>1)throw new Error("Template NUMBERS file must have exactly one sheet");return t.SheetNames.forEach(function(a,l){l>=1&&(rR(e,n,l+1),i=oo(e,n,1),o=tc(gt(i.messages[0].data)[1],ri)),iR(e,n,t.Sheets[a],a,l,o[l])}),e}function sr(t,r,e,n){var i=pr.find(t,r[e].location);if(!i)throw"Could not find ".concat(r[e].location," in Numbers template");var o=rc(ic(i.content)),a=o.find(function(l){return l.id==e});n(a,o),i.content=Ja(Xa(o)),i.size=i.content.length}function oo(t,r,e){var n=pr.find(t,r[e].location);if(!n)throw"Could not find ".concat(r[e].location," in Numbers template");var i=rc(ic(n.content)),o=i.find(function(a){return a.id==e});return o}function P0(t,r,e){t[3].push({type:2,data:at([[],[{type:0,data:nt(r)}],[{type:2,data:Ui(e.replace(/-[\s\S]*$/,""))}],[{type:2,data:Ui(e)}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:nt(0)}],[],[{type:0,data:nt(0)}]])}),t[1]=[{type:0,data:nt(Math.max(r+1,gn(t[1][0].data)))}]}function sa(t,r,e,n,i,o){o||(o=no({deps:[],location:"",type:r},i));var a="".concat(n,"-").concat(o,".iwa");i[o].location="Root Entry"+a,pr.utils.cfb_add(t,a,Ja(Xa([{id:o,messages:[A0(r,at(e))]}])));var l=a.replace(/^[\/]/,"").replace(/^Index\//,"").replace(/\.iwa$/,"");return sr(t,i,2,function(c){var f=gt(c.messages[0].data);P0(f,o||0,l),c.messages[0].data=at(f)}),o}function nn(t,r,e,n){var i=r[e].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,""),o=t[3].findIndex(function(l){var c,f,m=gt(l.data);return(c=m[3])!=null&&c[0]?Rs(m[3][0].data)==i:!!((f=m[2])!=null&&f[0]&&Rs(m[2][0].data)==i)}),a=gt(t[3][o].data);a[6]||(a[6]=[]),(Array.isArray(n)?n:[n]).forEach(function(l){a[6].push({type:2,data:at([[],[{type:0,data:nt(l)}]])})}),t[3][o].data=at(a)}function tR(t,r,e,n){var i=r[e].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,""),o=t[3].findIndex(function(l){var c,f,m=gt(l.data);return(c=m[3])!=null&&c[0]?Rs(m[3][0].data)==i:!!((f=m[2])!=null&&f[0]&&Rs(m[2][0].data)==i)}),a=gt(t[3][o].data);a[6]||(a[6]=[]),a[6]=a[6].filter(function(l){return gn(gt(l.data)[1][0].data)!=n}),t[3][o].data=at(a)}function rR(t,r,e){var n=-1,i=-1,o={};sr(t,r,1,function(c,f){var m=gt(c.messages[0].data);n=ri(gt(c.messages[0].data)[1][0].data),i=no({deps:[1],location:r[n].location,type:2},r),o[n]=i,Ai(c,i),m[1].push({type:2,data:Pi(i)});var C=oo(t,r,n);C.id=i,r[1].location==r[i].location?f.push(C):sr(t,r,i,function(y,k){return k.push(C)}),c.messages[0].data=at(m)});var a=-1;sr(t,r,i,function(c,f){for(var m=gt(c.messages[0].data),C=3;C<=69;++C)delete m[C];var y=tc(m[2],ri);y.forEach(function(S){return yo(c,S)}),a=no({deps:[i],location:r[y[0]].location,type:r[y[0]].type},r),Ai(c,a),o[y[0]]=a,m[2]=[{type:2,data:Pi(a)}];var k=oo(t,r,y[0]);k.id=a,r[y[0]].location==r[i].location?f.push(k):(sr(t,r,2,function(S){var M=gt(S.messages[0].data);nn(M,r,i,a),S.messages[0].data=at(M)}),sr(t,r,a,function(S,M){return M.push(k)})),c.messages[0].data=at(m)});var l=-1;sr(t,r,a,function(c,f){for(var m=gt(c.messages[0].data),C=gt(m[1][0].data),y=3;y<=69;++y)delete C[y];var k=ri(C[2][0].data);C[2][0].data=Pi(o[k]),m[1][0].data=at(C);var S=ri(m[2][0].data);yo(c,S),l=no({deps:[a],location:r[S].location,type:r[S].type},r),Ai(c,l),o[S]=l,m[2][0].data=Pi(l);var M=oo(t,r,S);M.id=l,r[a].location==r[l].location?f.push(M):sr(t,r,l,function(E,A){return A.push(M)}),c.messages[0].data=at(m)}),sr(t,r,l,function(c,f){var m,C,y=gt(c.messages[0].data),k=Rs(y[1][0].data),S=k.replace(/-[A-Z0-9]*/,"-".concat(("0000"+e.toString(16)).slice(-4)));if(y[1][0].data=Ui(S),[12,13,29,31,32,33,39,44,47,81,82,84].forEach(function(K){return delete y[K]}),y[45]){var M=gt(y[45][0].data),E=ri(M[1][0].data);yo(c,E),delete y[45]}if(y[70]){var A=gt(y[70][0].data);(m=A[2])==null||m.forEach(function(K){var te=gt(K.data);[2,3].map(function(V){return te[V][0]}).forEach(function(V){var R=gt(V.data);if(R[8]){var q=ri(R[8][0].data);yo(c,q)}})}),delete y[70]}[46,30,34,35,36,38,48,49,60,61,62,63,64,71,72,73,74,75,85,86,87,88,89].forEach(function(K){if(y[K]){var te=ri(y[K][0].data);delete y[K],yo(c,te)}});var x=gt(y[4][0].data);{[2,4,5,6,11,12,13,15,16,17,18,19,20,21,22].forEach(function(K){var te;if((te=x[K])!=null&&te[0]){var V=ri(x[K][0].data),R=no({deps:[l],location:r[V].location,type:r[V].type},r);yo(c,V),Ai(c,R),o[V]=R;var q=oo(t,r,V);if(q.id=R,r[V].location==r[l].location)f.push(q);else{r[R].location=r[V].location.replace(V.toString(),R.toString()),r[R].location==r[V].location&&(r[R].location=r[R].location.replace(/\.iwa/,"-".concat(R,".iwa"))),pr.utils.cfb_add(t,r[R].location,Ja(Xa([q])));var ie=r[R].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,"");sr(t,r,2,function(de){var ye=gt(de.messages[0].data);P0(ye,R,ie),nn(ye,r,l,R),de.messages[0].data=at(ye)})}x[K][0].data=Pi(R)}});var F=gt(x[1][0].data);(C=F[2])==null||C.forEach(function(K){var te=ri(K.data),V=no({deps:[l],location:r[te].location,type:r[te].type},r);yo(c,te),Ai(c,V),o[te]=V;var R=oo(t,r,te);if(R.id=V,r[te].location==r[l].location)f.push(R);else{r[V].location=r[te].location.replace(te.toString(),V.toString()),r[V].location==r[te].location&&(r[V].location=r[V].location.replace(/\.iwa/,"-".concat(V,".iwa"))),pr.utils.cfb_add(t,r[V].location,Ja(Xa([R])));var q=r[V].location.replace(/^Root Entry\//,"").replace(/^Index\//,"").replace(/\.iwa$/,"");sr(t,r,2,function(ie){var de=gt(ie.messages[0].data);P0(de,V,q),nn(de,r,l,V),ie.messages[0].data=at(de)})}K.data=Pi(V)}),x[1][0].data=at(F);var L=gt(x[3][0].data);L[1].forEach(function(K){var te=gt(K.data),V=ri(te[2][0].data),R=o[V];if(!o[V]){R=no({deps:[l],location:"",type:r[V].type},r),r[R].location="Root Entry/Index/Tables/Tile-".concat(R,".iwa"),o[V]=R;var q=oo(t,r,V);q.id=R,yo(c,V),Ai(c,R),pr.utils.cfb_add(t,"/Index/Tables/Tile-".concat(R,".iwa"),Ja(Xa([q]))),sr(t,r,2,function(ie){var de=gt(ie.messages[0].data);de[3].push({type:2,data:at([[],[{type:0,data:nt(R)}],[{type:2,data:Ui("Tables/Tile")}],[{type:2,data:Ui("Tables/Tile-".concat(R))}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:nt(0)}],[],[{type:0,data:nt(0)}]])}),de[1]=[{type:0,data:nt(Math.max(R+1,gn(de[1][0].data)))}],nn(de,r,l,R),ie.messages[0].data=at(de)})}te[2][0].data=Pi(R),K.data=at(te)}),x[3][0].data=at(L)}y[4][0].data=at(x),c.messages[0].data=at(y)})}function iR(t,r,e,n,i,o){var a=[];sr(t,r,o,function(f){var m=gt(f.messages[0].data);m[1]=[{type:2,data:Ui(n)}],a=tc(m[2],ri),f.messages[0].data=at(m)});var l=oo(t,r,a[0]),c=ri(gt(l.messages[0].data)[2][0].data);sr(t,r,c,function(f,m){return nR(t,r,e,f,m,c)})}var Rh=!0;function nR(t,r,e,n,i,o){if(!e["!ref"])throw new Error("Cannot export empty sheet to NUMBERS");var a=yi(e["!ref"]);a.s.r=a.s.c=0;var l=!1;a.e.c>999&&(l=!0,a.e.c=999),a.e.r>999999&&(l=!0,a.e.r=999999),l&&console.error("Truncating to ".concat(oi(a)));var c=[];if(e["!data"])c=e["!data"];else{for(var f=[],m=0;m<=a.e.c;++m)f[m]=lr(m);for(var C=0;C<=a.e.r;++C){c[C]=[];var y=""+(C+1);for(m=0;m<=a.e.c;++m){var k=e[f[m]+y];k&&(c[C][m]=k)}}}var S={cmnt:[{a:"~54ee77S~",t:"... the people who are crazy enough to think they can change the world, are the ones who do."}],ferr:[],fmla:[],nfmt:[],ofmt:[],rsst:[{v:"~54ee77S~",l:"https://sheetjs.com/"}],sst:["~Sh33tJ5~"]},M=gt(n.messages[0].data);{M[6][0].data=nt(a.e.r+1),M[7][0].data=nt(a.e.c+1),delete M[46];var E=gt(M[4][0].data);{var A=ri(gt(E[1][0].data)[2][0].data);sr(t,r,A,function(Ft,At){var zt,Ut=gt(Ft.messages[0].data);if((zt=Ut?.[2])!=null&&zt[0])for(var Wt=0;Wt<c.length;++Wt){var Rt=gt(Ut[2][0].data);Rt[1][0].data=nt(Wt),Rt[4][0].data=nt(c[Wt].length),Ut[2][Wt]={type:Ut[2][0].type,data:at(Rt)}}Ft.messages[0].data=at(Ut)});var x=ri(E[2][0].data);sr(t,r,x,function(Ft,At){for(var zt=gt(Ft.messages[0].data),Ut=0;Ut<=a.e.c;++Ut){var Wt=gt(zt[2][0].data);Wt[1][0].data=nt(Ut),Wt[4][0].data=nt(a.e.r+1),zt[2][Ut]={type:zt[2][0].type,data:at(Wt)}}Ft.messages[0].data=at(zt)});var F=gt(E[9][0].data);F[1]=[];var L=gt(E[3][0].data);{var K=256;L[2]=[{type:0,data:nt(K)}];var te=ri(gt(L[1][0].data)[2][0].data),V=(function(){var Ft=oo(t,r,2),At=gt(Ft.messages[0].data),zt=At[3].filter(function(Ut){return gn(gt(Ut.data)[1][0].data)==te});return zt?.length?gn(gt(zt[0].data)[12][0].data):0})();pr.utils.cfb_del(t,r[te].location),sr(t,r,2,function(Ft){var At=gt(Ft.messages[0].data);At[3]=At[3].filter(function(zt){return gn(gt(zt.data)[1][0].data)!=te}),tR(At,r,o,te),Ft.messages[0].data=at(At)}),yo(n,te),L[1]=[];for(var R=Math.ceil((a.e.r+1)/K),q=0;q<R;++q){var ie=no({deps:[],location:"",type:6002},r);r[ie].location="Root Entry/Index/Tables/Tile-".concat(ie,".iwa");for(var de=[[],[{type:0,data:nt(0)}],[{type:0,data:nt(Math.min(a.e.r+1,(q+1)*K))}],[{type:0,data:nt(0)}],[{type:0,data:nt(Math.min((q+1)*K,a.e.r+1)-q*K)}],[],[{type:0,data:nt(5)}],[{type:0,data:nt(1)}],[{type:0,data:nt(Rh?1:0)}]],ye=q*K;ye<=Math.min(a.e.r,(q+1)*K-1);++ye){var _t=Y6(c[ye],S,Rh);_t[1][0].data=nt(ye-q*K),de[5].push({data:at(_t),type:2})}L[1].push({type:2,data:at([[],[{type:0,data:nt(q)}],[{type:2,data:Pi(ie)}]])});var St={id:ie,messages:[A0(6002,at(de))]},st=Ja(Xa([St]));pr.utils.cfb_add(t,"/Index/Tables/Tile-".concat(ie,".iwa"),st),sr(t,r,2,function(Ft){var At=gt(Ft.messages[0].data);At[3].push({type:2,data:at([[],[{type:0,data:nt(ie)}],[{type:2,data:Ui("Tables/Tile")}],[{type:2,data:Ui("Tables/Tile-".concat(ie))}],[{type:2,data:new Uint8Array([2,0,0])}],[{type:2,data:new Uint8Array([2,0,0])}],[],[],[],[],[{type:0,data:nt(0)}],[],[{type:0,data:nt(V)}]])}),At[1]=[{type:0,data:nt(Math.max(ie+1,gn(At[1][0].data)))}],nn(At,r,o,ie),Ft.messages[0].data=at(At)}),Ai(n,ie),F[1].push({type:2,data:at([[],[{type:0,data:nt(q*K)}],[{type:0,data:nt(q)}]])})}}if(E[3][0].data=at(L),E[9][0].data=at(F),E[10]=[{type:2,data:new Uint8Array([])}],e["!merges"]){var or=no({type:6144,deps:[o],location:r[o].location},r);i.push({id:or,messages:[A0(6144,at([[],e["!merges"].map(function(Ft){return{type:2,data:at([[],[{type:2,data:at([[],[{type:5,data:new Uint8Array(new Uint16Array([Ft.s.r,Ft.s.c]).buffer)}]])}],[{type:2,data:at([[],[{type:5,data:new Uint8Array(new Uint16Array([Ft.e.r-Ft.s.r+1,Ft.e.c-Ft.s.c+1]).buffer)}]])}]])}})]))]}),E[13]=[{type:2,data:Pi(or)}],sr(t,r,2,function(Ft){var At=gt(Ft.messages[0].data);nn(At,r,o,or),Ft.messages[0].data=at(At)}),Ai(n,or)}else delete E[13];var ot=ri(E[4][0].data);sr(t,r,ot,function(Ft){var At=gt(Ft.messages[0].data);At[3]=[],S.sst.forEach(function(zt,Ut){Ut!=0&&At[3].push({type:2,data:at([[],[{type:0,data:nt(Ut)}],[{type:0,data:nt(1)}],[{type:2,data:Ui(zt)}]])})}),Ft.messages[0].data=at(At)});var yr=ri(E[17][0].data);if(sr(t,r,yr,function(Ft){var At=gt(Ft.messages[0].data);At[3]=[];var zt=[904980,903835,903815,903845];S.rsst.forEach(function(Ut,Wt){if(Wt!=0){var Rt=[[],[{type:0,data:new Uint8Array([5])}],[],[{type:2,data:Ui(Ut.v)}]];Rt[10]=[{type:0,data:new Uint8Array([1])}],Rt[19]=[{type:2,data:new Uint8Array([10,6,8,0,18,2,101,110])}],Rt[5]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,155,149,55])}],Rt[2]=[{type:2,data:new Uint8Array([8,148,158,55])}],Rt[6]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}],Rt[7]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,135,149,55])}],Rt[8]=[{type:2,data:new Uint8Array([10,8,8,0,18,4,8,165,149,55])}],Rt[14]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}],Rt[24]=[{type:2,data:new Uint8Array([10,6,8,0,16,0,24,0])}];var G=no({deps:[],location:"",type:2001},r),re=[];if(Ut.l){var Q=sa(t,2032,[[],[],[{type:2,data:Ui(Ut.l)}]],"/Index/Tables/DataList",r);Rt[11]=[];var J=[[],[]];J[1]||(J[1]=[]),J[1].push({type:2,data:at([[],[{type:0,data:nt(0)}],[{type:2,data:Pi(Q)}]])}),Rt[11][0]={type:2,data:at(J)},re.push(Q)}sa(t,2001,Rt,"/Index/Tables/DataList",r,G),sr(t,r,G,function(qe){zt.forEach(function(pt){return Ai(qe,pt)}),re.forEach(function(pt){return Ai(qe,pt)})});var Ce=sa(t,6218,[[],[{type:2,data:Pi(G)}],[],[{type:2,data:new Uint8Array([13,255,255,255,0,18,10,16,255,255,1,24,255,255,255,255,7])}]],"/Index/Tables/DataList",r);sr(t,r,Ce,function(qe){return Ai(qe,G)}),At[3].push({type:2,data:at([[],[{type:0,data:nt(Wt)}],[{type:0,data:nt(1)}],[],[],[],[],[],[],[{type:2,data:Pi(Ce)}]])}),Ai(Ft,Ce),sr(t,r,2,function(qe){var pt=gt(qe.messages[0].data);nn(pt,r,yr,Ce),nn(pt,r,Ce,G),nn(pt,r,G,re),nn(pt,r,G,zt),qe.messages[0].data=at(pt)})}}),Ft.messages[0].data=at(At)}),S.cmnt.length>1){var Vr=ri(E[19][0].data),Cr={},gi=0;sr(t,r,Vr,function(Ft){var At=gt(Ft.messages[0].data);At[3]=[],S.cmnt.forEach(function(zt,Ut){if(Ut!=0){var Wt=[];zt.replies&&zt.replies.forEach(function(re){Cr[re.a||""]||(Cr[re.a||""]=sa(t,212,[[],[{type:2,data:Ui(re.a||"")}],[{type:2,data:Mh(++gi)}],[],[{type:0,data:nt(0)}]],"/Index/Tables/DataList",r));var Q=Cr[re.a||""],J=sa(t,3056,[[],[{type:2,data:Ui(re.t||"")}],[{type:2,data:at([[],[{type:1,data:new Uint8Array([0,0,0,128,116,109,182,65])}]])}],[{type:2,data:Pi(Q)}]],"/Index/Tables/DataList",r);sr(t,r,J,function(Ce){return Ai(Ce,Q)}),Wt.push(J),sr(t,r,2,function(Ce){var qe=gt(Ce.messages[0].data);nn(qe,r,J,Q),Ce.messages[0].data=at(qe)})}),Cr[zt.a||""]||(Cr[zt.a||""]=sa(t,212,[[],[{type:2,data:Ui(zt.a||"")}],[{type:2,data:Mh(++gi)}],[],[{type:0,data:nt(0)}]],"/Index/Tables/DataList",r));var Rt=Cr[zt.a||""],G=sa(t,3056,[[],[{type:2,data:Ui(zt.t||"")}],[{type:2,data:at([[],[{type:1,data:new Uint8Array([0,0,0,128,116,109,182,65])}]])}],[{type:2,data:Pi(Rt)}],Wt.map(function(re){return{type:2,data:Pi(re)}}),[{type:2,data:at([[],[{type:0,data:nt(Ut)}],[{type:0,data:nt(0)}]])}]],"/Index/Tables/DataList",r);sr(t,r,G,function(re){Ai(re,Rt),Wt.forEach(function(Q){return Ai(re,Q)})}),At[3].push({type:2,data:at([[],[{type:0,data:nt(Ut)}],[{type:0,data:nt(1)}],[],[],[],[],[],[],[],[{type:2,data:Pi(G)}]])}),Ai(Ft,G),sr(t,r,2,function(re){var Q=gt(re.messages[0].data);nn(Q,r,Vr,G),nn(Q,r,G,Rt),Wt.length&&nn(Q,r,G,Wt),re.messages[0].data=at(Q)})}}),At[2][0].data=nt(S.cmnt.length+1),Ft.messages[0].data=at(At)})}}M[4][0].data=at(E)}n.messages[0].data=at(M)}function oR(t){return function(e){for(var n=0;n!=t.length;++n){var i=t[n];e[i[0]]===void 0&&(e[i[0]]=i[1]),i[2]==="n"&&(e[i[0]]=Number(e[i[0]]))}}}function tu(t){oR([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function aR(t,r){t&&!t.SSF&&(t.SSF=Ri(Ir)),t&&t.SSF&&(sc(),ac(t.SSF),r.revssf=lc(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Is?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var e="bin",n=!0,i=dg();tu(r=r||{});var o=L0(),a="",l=0;if(r.cellXfs=[],jo(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",Ot(o,a,hg(t.Props,r)),i.coreprops.push(a),tr(r.rels,2,a,Kt.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],f=0;f<t.SheetNames.length;++f)(t.Workbook.Sheets[f]||{}).Hidden!=2&&c.push(t.SheetNames[f]);t.Props.SheetNames=c}t.Props.Worksheets=t.Props.SheetNames.length,Ot(o,a,_g(t.Props,r)),i.extprops.push(a),tr(r.rels,3,a,Kt.EXT_PROPS),t.Custprops!==t.Props&&ni(t.Custprops||{}).length>0&&(a="docProps/custom.xml",Ot(o,a,xg(t.Custprops,r)),i.custprops.push(a),tr(r.rels,4,a,Kt.CUST_PROPS));var m=["SheetJ5"];for(r.tcid=0,l=1;l<=t.SheetNames.length;++l){var C={"!id":{}},y=t.Sheets[t.SheetNames[l-1]],k=(y||{})["!type"]||"sheet";switch(k){case"chart":default:a="xl/worksheets/sheet"+l+"."+e,Ot(o,a,UM(l-1,r,t,C)),i.sheets.push(a),tr(r.wbrels,-1,"worksheets/sheet"+l+"."+e,Kt.WS[0])}if(y){var S=y["!comments"],M=!1,E="";if(S&&S.length>0){var A=!1;S.forEach(function(F){F[1].forEach(function(L){L.T==!0&&(A=!0)})}),A&&(E="xl/threadedComments/threadedComment"+l+".xml",Ot(o,E,Dg(S,m,r)),i.threadedcomments.push(E),tr(C,-1,"../threadedComments/threadedComment"+l+".xml",Kt.TCMNT)),E="xl/comments"+l+"."+e,Ot(o,E,PO(S,r)),i.comments.push(E),tr(C,-1,"../comments"+l+"."+e,Kt.CMNT),M=!0}y["!legacy"]&&M&&Ot(o,"xl/drawings/vmlDrawing"+l+".vml",Pg(l,y["!comments"])),delete y["!comments"],delete y["!legacy"]}C["!id"].rId1&&Ot(o,fg(a),Ga(C))}r.Strings!=null&&r.Strings.length>0&&(a="xl/sharedStrings."+e,Ot(o,a,UD(r.Strings,r)),i.strs.push(a),tr(r.wbrels,-1,"sharedStrings."+e,Kt.SST)),a="xl/workbook."+e,Ot(o,a,l6(t,r)),i.workbooks.push(a),tr(r.rels,1,a,Kt.WB),a="xl/theme/theme1.xml";var x=Ag(t.Themes,r);return Ot(o,a,x),i.themes.push(a),tr(r.wbrels,-1,"theme/theme1.xml",Kt.THEME),a="xl/styles."+e,Ot(o,a,hO(t,r)),i.styles.push(a),tr(r.wbrels,-1,"styles."+e,Kt.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",Ot(o,a,t.vbaraw),i.vba.push(a),tr(r.wbrels,-1,"vbaProject.bin",Kt.VBA)),a="xl/metadata."+e,Ot(o,a,wO()),i.metadata.push(a),tr(r.wbrels,-1,"metadata."+e,Kt.XLMETA),m.length>1&&(a="xl/persons/person.xml",Ot(o,a,Og(m,r)),i.people.push(a),tr(r.wbrels,-1,"persons/person.xml",Kt.PEOPLE)),Ot(o,"[Content_Types].xml",pg(i,r)),Ot(o,"_rels/.rels",Ga(r.rels)),Ot(o,"xl/_rels/workbook."+e+".rels",Ga(r.wbrels)),delete r.revssf,delete r.ssf,o}function sR(t,r){t&&!t.SSF&&(t.SSF=Ri(Ir)),t&&t.SSF&&(sc(),ac(t.SSF),r.revssf=lc(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Is?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var e="xml",n=OO.indexOf(r.bookType)>-1,i=dg();tu(r=r||{});var o=L0(),a="",l=0;if(r.cellXfs=[],jo(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",Ot(o,a,hg(t.Props,r)),i.coreprops.push(a),tr(r.rels,2,a,Kt.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],f=0;f<t.SheetNames.length;++f)(t.Workbook.Sheets[f]||{}).Hidden!=2&&c.push(t.SheetNames[f]);t.Props.SheetNames=c}t.Props.Worksheets=t.Props.SheetNames.length,Ot(o,a,_g(t.Props,r)),i.extprops.push(a),tr(r.rels,3,a,Kt.EXT_PROPS),t.Custprops!==t.Props&&ni(t.Custprops||{}).length>0&&(a="docProps/custom.xml",Ot(o,a,xg(t.Custprops,r)),i.custprops.push(a),tr(r.rels,4,a,Kt.CUST_PROPS));var m=["SheetJ5"];for(r.tcid=0,l=1;l<=t.SheetNames.length;++l){var C={"!id":{}},y=t.Sheets[t.SheetNames[l-1]],k=(y||{})["!type"]||"sheet";switch(k){case"chart":default:a="xl/worksheets/sheet"+l+"."+e,Ot(o,a,IB(l-1,r,t,C)),i.sheets.push(a),tr(r.wbrels,-1,"worksheets/sheet"+l+"."+e,Kt.WS[0])}if(y){var S=y["!comments"],M=!1,E="";if(S&&S.length>0){var A=!1;S.forEach(function(x){x[1].forEach(function(F){F.T==!0&&(A=!0)})}),A&&(E="xl/threadedComments/threadedComment"+l+".xml",Ot(o,E,Dg(S,m,r)),i.threadedcomments.push(E),tr(C,-1,"../threadedComments/threadedComment"+l+".xml",Kt.TCMNT)),E="xl/comments"+l+"."+e,Ot(o,E,EO(S,r)),i.comments.push(E),tr(C,-1,"../comments"+l+"."+e,Kt.CMNT),M=!0}y["!legacy"]&&M&&Ot(o,"xl/drawings/vmlDrawing"+l+".vml",Pg(l,y["!comments"])),delete y["!comments"],delete y["!legacy"]}C["!id"].rId1&&Ot(o,fg(a),Ga(C))}return r.Strings!=null&&r.Strings.length>0&&(a="xl/sharedStrings."+e,Ot(o,a,LD(r.Strings,r)),i.strs.push(a),tr(r.wbrels,-1,"sharedStrings."+e,Kt.SST)),a="xl/workbook."+e,Ot(o,a,XM(t,r)),i.workbooks.push(a),tr(r.rels,1,a,Kt.WB),a="xl/theme/theme1.xml",Ot(o,a,Ag(t.Themes,r)),i.themes.push(a),tr(r.wbrels,-1,"theme/theme1.xml",Kt.THEME),a="xl/styles."+e,Ot(o,a,XD(t,r)),i.styles.push(a),tr(r.wbrels,-1,"styles."+e,Kt.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",Ot(o,a,t.vbaraw),i.vba.push(a),tr(r.wbrels,-1,"vbaProject.bin",Kt.VBA)),a="xl/metadata."+e,Ot(o,a,SO()),i.metadata.push(a),tr(r.wbrels,-1,"metadata."+e,Kt.XLMETA),m.length>1&&(a="xl/persons/person.xml",Ot(o,a,Og(m,r)),i.people.push(a),tr(r.wbrels,-1,"persons/person.xml",Kt.PEOPLE)),Ot(o,"[Content_Types].xml",pg(i,r)),Ot(o,"_rels/.rels",Ga(r.rels)),Ot(o,"xl/_rels/workbook."+e+".rels",Ga(r.wbrels)),delete r.revssf,delete r.ssf,o}function lR(t,r){var e="";switch((r||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":e=zo(t.slice(0,12));break;case"binary":e=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3),e.charCodeAt(4),e.charCodeAt(5),e.charCodeAt(6),e.charCodeAt(7)]}function e1(t,r){switch(r.type){case"base64":case"binary":break;case"buffer":case"array":r.type="";break;case"file":return Ns(r.file,pr.write(t,{type:rr?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");default:throw new Error("Unrecognized type "+r.type)}return pr.write(t,r)}function cR(t,r){switch(r.bookType){case"ods":return Qg(t,r);case"numbers":return eR(t,r);case"xlsb":return aR(t,r);default:return sR(t,r)}}function uR(t,r){var e=Ri(r||{}),n=cR(t,e);return dR(n,e)}function dR(t,r){var e={},n=rr?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(r.compression&&(e.compression="DEFLATE"),r.password)e.type=n;else switch(r.type){case"base64":e.type="base64";break;case"binary":e.type="string";break;case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");case"buffer":case"file":e.type=n;break;default:throw new Error("Unrecognized type "+r.type)}var i=t.FullPaths?pr.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[e.type]||e.type,compression:!!r.compression}):t.generate(e);if(typeof Deno<"u"&&typeof i=="string"){if(r.type=="binary"||r.type=="base64")return i;i=new Uint8Array(oc(i))}return r.password&&typeof encrypt_agile<"u"?e1(encrypt_agile(i,r.password),r):r.type==="file"?Ns(r.file,i):r.type=="string"?$a(i):i}function pR(t,r){var e=r||{},n=C6(t,e);return e1(n,e)}function io(t,r,e){e||(e="");var n=e+t;switch(r.type){case"base64":return Wl(Co(n));case"binary":return Co(n);case"string":return t;case"file":return Ns(r.file,n,"utf8");case"buffer":return rr?co(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):io(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function fR(t,r){switch(r.type){case"base64":return fA(t);case"binary":return t;case"string":return t;case"file":return Ns(r.file,t,"binary");case"buffer":return rr?co(t,"binary"):t.split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function zl(t,r){switch(r.type){case"string":case"base64":case"binary":for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return r.type=="base64"?Wl(e):r.type=="string"?$a(e):e;case"file":return Ns(r.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+r.type)}}function ru(t,r){dA(),KM(t);var e=Ri(r||{});if(e.cellStyles&&(e.cellNF=!0,e.sheetStubs=!0),e.type=="array"){e.type="binary";var n=ru(t,e);return e.type="array",oc(n)}var i=0;if(e.sheet&&(typeof e.sheet=="number"?i=e.sheet:i=t.SheetNames.indexOf(e.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+e.sheet+" : "+typeof e.sheet);switch(e.bookType||"xlsb"){case"xml":case"xlml":return io(b6(t,e),e);case"slk":case"sylk":return io(OD.from_sheet(t.Sheets[t.SheetNames[i]],e,t),e);case"htm":case"html":return io(Xg(t.Sheets[t.SheetNames[i]],e),e);case"txt":return fR(t1(t.Sheets[t.SheetNames[i]],e),e);case"csv":return io(iu(t.Sheets[t.SheetNames[i]],e),e,"\uFEFF");case"dif":return io(BD.from_sheet(t.Sheets[t.SheetNames[i]],e),e);case"dbf":return zl(DD.from_sheet(t.Sheets[t.SheetNames[i]],e),e);case"prn":return io(MD.from_sheet(t.Sheets[t.SheetNames[i]],e),e);case"rtf":return io(jD(t.Sheets[t.SheetNames[i]],e),e);case"eth":return io(kg.from_sheet(t.Sheets[t.SheetNames[i]],e),e);case"fods":return io(Qg(t,e),e);case"wk1":return zl(wh.sheet_to_wk1(t.Sheets[t.SheetNames[i]],e),e);case"wk3":return zl(wh.book_to_wk3(t,e),e);case"biff2":e.biff||(e.biff=2);case"biff3":e.biff||(e.biff=3);case"biff4":return e.biff||(e.biff=4),zl(Kg(t,e),e);case"biff5":e.biff||(e.biff=5);case"biff8":case"xla":case"xls":return e.biff||(e.biff=8),pR(t,e);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return uR(t,e);default:throw new Error("Unrecognized bookType |"+e.bookType+"|")}}function mR(t,r,e,n,i,o,a){var l=dr(e),c=a.defval,f=a.raw||!Object.prototype.hasOwnProperty.call(a,"raw"),m=!0,C=t["!data"]!=null,y=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(y,"__rowNum__",{value:e,enumerable:!1})}catch{y.__rowNum__=e}else y.__rowNum__=e;if(!C||t["!data"][e])for(var k=r.s.c;k<=r.e.c;++k){var S=C?(t["!data"][e]||[])[k]:t[n[k]+l];if(S==null||S.t===void 0){if(c===void 0)continue;o[k]!=null&&(y[o[k]]=c);continue}var M=S.v;switch(S.t){case"z":if(M==null)break;continue;case"e":M=M==0?null:void 0;break;case"s":case"b":case"n":if(!S.z||!pa(S.z)||(M=Ha(M),typeof M=="number"))break;case"d":a&&(a.UTC||a.raw===!1)||(M=Qa(new Date(M)));break;default:throw new Error("unrecognized type "+S.t)}if(o[k]!=null){if(M==null)if(S.t=="e"&&M===null)y[o[k]]=null;else if(c!==void 0)y[o[k]]=c;else if(f&&M===null)y[o[k]]=null;else continue;else y[o[k]]=(S.t==="n"&&typeof a.rawNumbers=="boolean"?a.rawNumbers:f)?M:Eo(S,M,a);M!=null&&(m=!1)}}return{row:y,isempty:m}}function D0(t,r){if(t==null||t["!ref"]==null)return[];var e={t:"n",v:0},n=0,i=1,o=[],a=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},f=r||{},m=f.range!=null?f.range:t["!ref"];switch(f.header===1?n=1:f.header==="A"?n=2:Array.isArray(f.header)?n=3:f.header==null&&(n=0),typeof m){case"string":c=Fr(m);break;case"number":c=Fr(t["!ref"]),c.s.r=m;break;default:c=m}n>0&&(i=0);var C=dr(c.s.r),y=[],k=[],S=0,M=0,E=t["!data"]!=null,A=c.s.r,x=0,F={};E&&!t["!data"][A]&&(t["!data"][A]=[]);var L=f.skipHidden&&t["!cols"]||[],K=f.skipHidden&&t["!rows"]||[];for(x=c.s.c;x<=c.e.c;++x)if(!(L[x]||{}).hidden)switch(y[x]=lr(x),e=E?t["!data"][A][x]:t[y[x]+C],n){case 1:o[x]=x-c.s.c;break;case 2:o[x]=y[x];break;case 3:o[x]=f.header[x-c.s.c];break;default:if(e==null&&(e={w:"__EMPTY",t:"s"}),l=a=Eo(e,null,f),M=F[a]||0,!M)F[a]=1;else{do l=a+"_"+M++;while(F[l]);F[a]=M,F[l]=1}o[x]=l}for(A=c.s.r+i;A<=c.e.r;++A)if(!(K[A]||{}).hidden){var te=mR(t,c,A,y,n,o,f);(te.isempty===!1||(n===1?f.blankrows!==!1:f.blankrows))&&(k[S++]=te.row)}return k.length=S,k}var Lh=/"/g;function hR(t,r,e,n,i,o,a,l,c){for(var f=!0,m=[],C="",y=dr(e),k=t["!data"]!=null,S=k&&t["!data"][e]||[],M=r.s.c;M<=r.e.c;++M)if(n[M]){var E=k?S[M]:t[n[M]+y];if(E==null)C="";else if(E.v!=null){f=!1,C=""+(c.rawNumbers&&E.t=="n"?E.v:Eo(E,null,c));for(var A=0,x=0;A!==C.length;++A)if((x=C.charCodeAt(A))===i||x===o||x===34||c.forceQuotes){C='"'+C.replace(Lh,'""')+'"';break}C=="ID"&&l==0&&m.length==0&&(C='"ID"')}else E.f!=null&&!E.F?(f=!1,C="="+E.f,C.indexOf(",")>=0&&(C='"'+C.replace(Lh,'""')+'"')):C="";m.push(C)}if(c.strip)for(;m[m.length-1]==="";)--m.length;return c.blankrows===!1&&f?null:m.join(a)}function iu(t,r){var e=[],n=r??{};if(t==null||t["!ref"]==null)return"";for(var i=Fr(t["!ref"]),o=n.FS!==void 0?n.FS:",",a=o.charCodeAt(0),l=n.RS!==void 0?n.RS:`
`,c=l.charCodeAt(0),f="",m=[],C=n.skipHidden&&t["!cols"]||[],y=n.skipHidden&&t["!rows"]||[],k=i.s.c;k<=i.e.c;++k)(C[k]||{}).hidden||(m[k]=lr(k));for(var S=0,M=i.s.r;M<=i.e.r;++M)(y[M]||{}).hidden||(f=hR(t,i,M,m,a,c,o,S,n),f!=null&&(f||n.blankrows!==!1)&&e.push((S++?l:"")+f));return e.join("")}function t1(t,r){r||(r={}),r.FS="	",r.RS=`
`;var e=iu(t,r);if(typeof qt>"u"||r.type=="string")return e;var n=qt.utils.encode(1200,e,"str");return"\xFF\xFE"+n}function gR(t,r){var e="",n,i="";if(t==null||t["!ref"]==null)return[];var o=Fr(t["!ref"]),a="",l=[],c,f=[],m=t["!data"]!=null;for(c=o.s.c;c<=o.e.c;++c)l[c]=lr(c);for(var C=o.s.r;C<=o.e.r;++C)for(a=dr(C),c=o.s.c;c<=o.e.c;++c)if(e=l[c]+a,n=m?(t["!data"][C]||[])[c]:t[e],i="",n!==void 0){if(n.F!=null){if(e=n.F,!n.f)continue;i=n.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(n.f!=null)i=n.f;else{if(r&&r.values===!1)continue;if(n.t=="z")continue;if(n.t=="n"&&n.v!=null)i=""+n.v;else if(n.t=="b")i=n.v?"TRUE":"FALSE";else if(n.w!==void 0)i="'"+n.w;else{if(n.v===void 0)continue;n.t=="s"?i="'"+n.v:i=""+n.v}}f[f.length]=e+"="+i}return f}function r1(t,r,e){var n=e||{},i=t?t["!data"]!=null:n.dense;ao!=null&&i==null&&(i=ao);var o=+!n.skipHeader,a=t||{};!t&&i&&(a["!data"]=[]);var l=0,c=0;if(a&&n.origin!=null)if(typeof n.origin=="number")l=n.origin;else{var f=typeof n.origin=="string"?Nr(n.origin):n.origin;l=f.r,c=f.c}var m={s:{c:0,r:0},e:{c,r:l+r.length-1+o}};if(a["!ref"]){var C=Fr(a["!ref"]);m.e.c=Math.max(m.e.c,C.e.c),m.e.r=Math.max(m.e.r,C.e.r),l==-1&&(l=C.e.r+1,m.e.r=l+r.length-1+o)}else l==-1&&(l=0,m.e.r=r.length-1+o);var y=n.header||[],k=0,S=[];r.forEach(function(E,A){i&&!a["!data"][l+A+o]&&(a["!data"][l+A+o]=[]),i&&(S=a["!data"][l+A+o]),ni(E).forEach(function(x){(k=y.indexOf(x))==-1&&(y[k=y.length]=x);var F=E[x],L="z",K="",te=i?"":lr(c+k)+dr(l+A+o),V=i?S[c+k]:a[te];F&&typeof F=="object"&&!(F instanceof Date)?i?S[c+k]=F:a[te]=F:(typeof F=="number"?L="n":typeof F=="boolean"?L="b":typeof F=="string"?L="s":F instanceof Date?(L="d",n.UTC||(F=cc(F)),n.cellDates||(L="n",F=Ci(F)),K=V!=null&&V.z&&pa(V.z)?V.z:n.dateNF||Ir[14]):F===null&&n.nullError&&(L="e",F=0),V?(V.t=L,V.v=F,delete V.w,delete V.R,K&&(V.z=K)):i?S[c+k]=V={t:L,v:F}:a[te]=V={t:L,v:F},K&&(V.z=K))})}),m.e.c=Math.max(m.e.c,c+y.length-1);var M=dr(l);if(i&&!a["!data"][l]&&(a["!data"][l]=[]),o)for(k=0;k<y.length;++k)i?a["!data"][l][k+c]={t:"s",v:y[k]}:a[lr(k+c)+M]={t:"s",v:y[k]};return a["!ref"]=oi(m),a}function _R(t,r){return r1(null,t,r)}function nc(t,r,e){if(typeof r=="string"){if(t["!data"]!=null){var n=Nr(r);return t["!data"][n.r]||(t["!data"][n.r]=[]),t["!data"][n.r][n.c]||(t["!data"][n.r][n.c]={t:"z"})}return t[r]||(t[r]={t:"z"})}return typeof r!="number"?nc(t,Hr(r)):nc(t,lr(e||0)+dr(r))}function xR(t,r){if(typeof r=="number"){if(r>=0&&t.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var e=t.SheetNames.indexOf(r);if(e>-1)return e;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function vR(t,r){var e={SheetNames:[],Sheets:{}};return t&&nu(e,t,r||"Sheet1"),e}function nu(t,r,e,n){var i=1;if(!e)for(;i<=65535&&t.SheetNames.indexOf(e="Sheet"+i)!=-1;++i,e=void 0);if(!e||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(e)>=0&&e.length<32){var o=e.match(/\d+$/);i=o&&+o[0]||0;var a=o&&e.slice(0,o.index)||e;for(++i;i<=65535&&t.SheetNames.indexOf(e=a+i)!=-1;++i);}if(Hg(e),t.SheetNames.indexOf(e)>=0)throw new Error("Worksheet with name |"+e+"| already exists!");return t.SheetNames.push(e),t.Sheets[e]=r,e}function bR(t,r,e){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=xR(t,r);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),e){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+e)}t.Workbook.Sheets[n].Hidden=e}function yR(t,r){return t.z=r,t}function i1(t,r,e){return r?(t.l={Target:r},e&&(t.l.Tooltip=e)):delete t.l,t}function CR(t,r,e){return i1(t,"#"+r,e)}function wR(t,r,e){t.c||(t.c=[]),t.c.push({t:r,a:e||"SheetJS"})}function SR(t,r,e,n){for(var i=typeof r!="string"?r:Fr(r),o=typeof r=="string"?r:oi(r),a=i.s.r;a<=i.e.r;++a)for(var l=i.s.c;l<=i.e.c;++l){var c=nc(t,a,l);c.t="n",c.F=o,delete c.v,a==i.s.r&&l==i.s.c&&(c.f=e,n&&(c.D=!0))}var f=yi(t["!ref"]);return f.s.r>i.s.r&&(f.s.r=i.s.r),f.s.c>i.s.c&&(f.s.c=i.s.c),f.e.r<i.e.r&&(f.e.r=i.e.r),f.e.c<i.e.c&&(f.e.c=i.e.c),t["!ref"]=oi(f),t}var _c={encode_col:lr,encode_row:dr,encode_cell:Hr,encode_range:oi,decode_col:K0,decode_row:G0,split_cell:yP,decode_cell:Nr,decode_range:yi,format_cell:Eo,sheet_new:CP,sheet_add_aoa:ag,sheet_add_json:r1,sheet_add_dom:Jg,aoa_to_sheet:rs,json_to_sheet:_R,table_to_sheet:qg,table_to_book:$6,sheet_to_csv:iu,sheet_to_txt:t1,sheet_to_json:D0,sheet_to_html:Xg,sheet_to_formulae:gR,sheet_to_row_object_array:D0,sheet_get_cell:nc,book_new:vR,book_append_sheet:nu,book_set_sheet_visibility:bR,cell_set_number_format:yR,cell_set_hyperlink:i1,cell_set_internal_link:CR,cell_add_comment:wR,sheet_set_array_formula:SR,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};var DJ=Fs.version;var n1=`
    .p-multiselect {
        display: inline-flex;
        cursor: pointer;
        position: relative;
        user-select: none;
        background: dt('multiselect.background');
        border: 1px solid dt('multiselect.border.color');
        transition:
            background dt('multiselect.transition.duration'),
            color dt('multiselect.transition.duration'),
            border-color dt('multiselect.transition.duration'),
            outline-color dt('multiselect.transition.duration'),
            box-shadow dt('multiselect.transition.duration');
        border-radius: dt('multiselect.border.radius');
        outline-color: transparent;
        box-shadow: dt('multiselect.shadow');
    }

    .p-multiselect:not(.p-disabled):hover {
        border-color: dt('multiselect.hover.border.color');
    }

    .p-multiselect:not(.p-disabled).p-focus {
        border-color: dt('multiselect.focus.border.color');
        box-shadow: dt('multiselect.focus.ring.shadow');
        outline: dt('multiselect.focus.ring.width') dt('multiselect.focus.ring.style') dt('multiselect.focus.ring.color');
        outline-offset: dt('multiselect.focus.ring.offset');
    }

    .p-multiselect.p-variant-filled {
        background: dt('multiselect.filled.background');
    }

    .p-multiselect.p-variant-filled:not(.p-disabled):hover {
        background: dt('multiselect.filled.hover.background');
    }

    .p-multiselect.p-variant-filled.p-focus {
        background: dt('multiselect.filled.focus.background');
    }

    .p-multiselect.p-invalid {
        border-color: dt('multiselect.invalid.border.color');
    }

    .p-multiselect.p-disabled {
        opacity: 1;
        background: dt('multiselect.disabled.background');
    }

    .p-multiselect-dropdown {
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
        background: transparent;
        color: dt('multiselect.dropdown.color');
        width: dt('multiselect.dropdown.width');
        border-start-end-radius: dt('multiselect.border.radius');
        border-end-end-radius: dt('multiselect.border.radius');
    }

    .p-multiselect-clear-icon {
        align-self: center;
        color: dt('multiselect.clear.icon.color');
        inset-inline-end: dt('multiselect.dropdown.width');
    }

    .p-multiselect-label-container {
        overflow: hidden;
        flex: 1 1 auto;
        cursor: pointer;
    }

    .p-multiselect-label {
        white-space: nowrap;
        cursor: pointer;
        overflow: hidden;
        text-overflow: ellipsis;
        padding: dt('multiselect.padding.y') dt('multiselect.padding.x');
        color: dt('multiselect.color');
    }

    .p-multiselect-display-chip .p-multiselect-label {
        display: flex;
        align-items: center;
        gap: calc(dt('multiselect.padding.y') / 2);
    }

    .p-multiselect-label.p-placeholder {
        color: dt('multiselect.placeholder.color');
    }

    .p-multiselect.p-invalid .p-multiselect-label.p-placeholder {
        color: dt('multiselect.invalid.placeholder.color');
    }

    .p-multiselect.p-disabled .p-multiselect-label {
        color: dt('multiselect.disabled.color');
    }

    .p-multiselect-label-empty {
        overflow: hidden;
        visibility: hidden;
    }

    .p-multiselect-overlay {
        position: absolute;
        top: 0;
        left: 0;
        background: dt('multiselect.overlay.background');
        color: dt('multiselect.overlay.color');
        border: 1px solid dt('multiselect.overlay.border.color');
        border-radius: dt('multiselect.overlay.border.radius');
        box-shadow: dt('multiselect.overlay.shadow');
        min-width: 100%;
    }

    .p-multiselect-header {
        display: flex;
        align-items: center;
        padding: dt('multiselect.list.header.padding');
    }

    .p-multiselect-header .p-checkbox {
        margin-inline-end: dt('multiselect.option.gap');
    }

    .p-multiselect-filter-container {
        flex: 1 1 auto;
    }

    .p-multiselect-filter {
        width: 100%;
    }

    .p-multiselect-list-container {
        overflow: auto;
    }

    .p-multiselect-list {
        margin: 0;
        padding: 0;
        list-style-type: none;
        padding: dt('multiselect.list.padding');
        display: flex;
        flex-direction: column;
        gap: dt('multiselect.list.gap');
    }

    .p-multiselect-option {
        cursor: pointer;
        font-weight: normal;
        white-space: nowrap;
        position: relative;
        overflow: hidden;
        display: flex;
        align-items: center;
        gap: dt('multiselect.option.gap');
        padding: dt('multiselect.option.padding');
        border: 0 none;
        color: dt('multiselect.option.color');
        background: transparent;
        transition:
            background dt('multiselect.transition.duration'),
            color dt('multiselect.transition.duration'),
            border-color dt('multiselect.transition.duration'),
            box-shadow dt('multiselect.transition.duration'),
            outline-color dt('multiselect.transition.duration');
        border-radius: dt('multiselect.option.border.radius');
    }

    .p-multiselect-option:not(.p-multiselect-option-selected):not(.p-disabled).p-focus {
        background: dt('multiselect.option.focus.background');
        color: dt('multiselect.option.focus.color');
    }

    .p-multiselect-option.p-multiselect-option-selected {
        background: dt('multiselect.option.selected.background');
        color: dt('multiselect.option.selected.color');
    }

    .p-multiselect-option.p-multiselect-option-selected.p-focus {
        background: dt('multiselect.option.selected.focus.background');
        color: dt('multiselect.option.selected.focus.color');
    }

    .p-multiselect-option-group {
        cursor: auto;
        margin: 0;
        padding: dt('multiselect.option.group.padding');
        background: dt('multiselect.option.group.background');
        color: dt('multiselect.option.group.color');
        font-weight: dt('multiselect.option.group.font.weight');
    }

    .p-multiselect-empty-message {
        padding: dt('multiselect.empty.message.padding');
    }

    .p-multiselect-label .p-chip {
        padding-block-start: calc(dt('multiselect.padding.y') / 2);
        padding-block-end: calc(dt('multiselect.padding.y') / 2);
        border-radius: dt('multiselect.chip.border.radius');
    }

    .p-multiselect-label:has(.p-chip) {
        padding: calc(dt('multiselect.padding.y') / 2) calc(dt('multiselect.padding.x') / 2);
    }

    .p-multiselect-fluid {
        display: flex;
        width: 100%;
    }

    .p-multiselect-sm .p-multiselect-label {
        font-size: dt('multiselect.sm.font.size');
        padding-block: dt('multiselect.sm.padding.y');
        padding-inline: dt('multiselect.sm.padding.x');
    }

    .p-multiselect-sm .p-multiselect-dropdown .p-icon {
        font-size: dt('multiselect.sm.font.size');
        width: dt('multiselect.sm.font.size');
        height: dt('multiselect.sm.font.size');
    }

    .p-multiselect-lg .p-multiselect-label {
        font-size: dt('multiselect.lg.font.size');
        padding-block: dt('multiselect.lg.padding.y');
        padding-inline: dt('multiselect.lg.padding.x');
    }

    .p-multiselect-lg .p-multiselect-dropdown .p-icon {
        font-size: dt('multiselect.lg.font.size');
        width: dt('multiselect.lg.font.size');
        height: dt('multiselect.lg.font.size');
    }

    .p-floatlabel-in .p-multiselect-filter {
        padding-block-start: dt('multiselect.padding.y');
        padding-block-end: dt('multiselect.padding.y');
    }
`;var TR=["pMultiSelectItem",""],a1=t=>({$implicit:t}),ER=(t,r)=>({checked:t,class:r});function IR(t,r){}function FR(t,r){t&1&&P(0,IR,0,0,"ng-template")}function AR(t,r){if(t&1&&P(0,FR,1,0,null,3),t&2){let e=r.class,n=h(2);g("ngTemplateOutlet",n.itemCheckboxIconTemplate)("ngTemplateOutletContext",di(2,ER,n.selected,e))}}function PR(t,r){t&1&&(Le(0),P(1,AR,1,5,"ng-template",null,0,Z),Ne())}function DR(t,r){if(t&1&&(d(0,"span"),v(1),u()),t&2){let e=h();p(),he(e.label??"empty")}}function OR(t,r){t&1&&Tt(0)}var BR=["item"],MR=["group"],RR=["loader"],LR=["header"],NR=["filter"],VR=["footer"],zR=["emptyfilter"],UR=["empty"],WR=["selecteditems"],jR=["loadingicon"],HR=["filtericon"],$R=["removetokenicon"],GR=["chipicon"],KR=["clearicon"],XR=["dropdownicon"],JR=["itemcheckboxicon"],qR=["headercheckboxicon"],QR=["overlay"],YR=["filterInput"],ZR=["focusInput"],eL=["items"],tL=["scroller"],rL=["lastHiddenFocusableEl"],iL=["firstHiddenFocusableEl"],nL=["headerCheckbox"],oL=[[["p-header"]],[["p-footer"]]],aL=["p-header","p-footer"],sL=()=>({class:"p-multiselect-chip-icon"}),lL=(t,r)=>({$implicit:t,removeChip:r}),s1=t=>({options:t}),cL=(t,r,e)=>({checked:t,partialSelected:r,class:e}),vc=t=>({height:t}),l1=(t,r)=>({$implicit:t,options:r}),uL=()=>({});function dL(t,r){if(t&1&&(Le(0),v(1),Ne()),t&2){let e=h(2);p(),he(e.label()||"empty")}}function pL(t,r){if(t&1&&v(0),t&2){let e=h(3);Ie(" ",e.getSelectedItemsLabel()," ")}}function fL(t,r){t&1&&Tt(0)}function mL(t,r){if(t&1){let e=pe();d(0,"span",27),ee("click",function(i){O(e);let o=h(4).$implicit,a=h(4);return B(a.removeOption(o,i))}),P(1,fL,1,0,"ng-container",28),u()}if(t&2){let e=h(8);_e(e.cx("chipIcon")),g("pBind",e.ptm("chipIcon")),Ue("aria-hidden",!0),p(),g("ngTemplateOutlet",e.chipIconTemplate||e._chipIconTemplate||e.removeTokenIconTemplate||e._removeTokenIconTemplate)("ngTemplateOutletContext",Je(6,sL))}}function hL(t,r){if(t&1&&(Le(0),P(1,mL,2,7,"span",26),Ne()),t&2){let e=h(7);p(),g("ngIf",e.chipIconTemplate||e._chipIconTemplate||e.removeTokenIconTemplate||e._removeTokenIconTemplate)}}function gL(t,r){if(t&1&&P(0,hL,2,1,"ng-container",20),t&2){let e=h(6);g("ngIf",!e.$disabled()&&!e.readonly)}}function _L(t,r){t&1&&(Le(0),P(1,gL,1,1,"ng-template",null,5,Z),Ne())}function xL(t,r){if(t&1){let e=pe();d(0,"div",19,4)(2,"p-chip",25),ee("onRemove",function(i){let o=O(e).$implicit,a=h(4);return B(a.removeOption(o,i))}),P(3,_L,3,0,"ng-container",20),u()()}if(t&2){let e=r.$implicit,n=h(4);_e(n.cx("chipItem")),g("pBind",n.ptm("chipItem")),p(2),_e(n.cx("pcChip")),g("pt",n.ptm("pcChip"))("label",n.getLabelByValue(e))("removable",!n.$disabled()&&!n.readonly)("removeIcon",n.chipIcon),p(),g("ngIf",n.chipIconTemplate||n._chipIconTemplate||n.removeTokenIconTemplate||n._removeTokenIconTemplate)}}function vL(t,r){if(t&1&&P(0,xL,4,10,"div",24),t&2){let e=h(3);g("ngForOf",e.chipSelectedItems())}}function bL(t,r){if(t&1&&(Le(0),v(1),Ne()),t&2){let e=h(3);p(),he(e.placeholder()||"empty")}}function yL(t,r){if(t&1&&(Le(0),ft(1,pL,1,1)(2,vL,1,1,"div",23),P(3,bL,2,1,"ng-container",20),Ne()),t&2){let e=h(2);p(),mt(e.chipSelectedItems()&&e.chipSelectedItems().length===e.maxSelectedLabels?1:2),p(2),g("ngIf",!e.modelValue()||e.modelValue().length===0)}}function CL(t,r){if(t&1&&(Le(0),P(1,dL,2,1,"ng-container",20)(2,yL,4,2,"ng-container",20),Ne()),t&2){let e=h();p(),g("ngIf",e.display==="comma"),p(),g("ngIf",e.display==="chip")}}function wL(t,r){t&1&&Tt(0)}function SL(t,r){if(t&1&&(Le(0),v(1),Ne()),t&2){let e=h(2);p(),he(e.placeholder()||"empty")}}function kL(t,r){if(t&1&&(Le(0),P(1,wL,1,0,"ng-container",28)(2,SL,2,1,"ng-container",20),Ne()),t&2){let e=h();p(),g("ngTemplateOutlet",e.selectedItemsTemplate||e._selectedItemsTemplate)("ngTemplateOutletContext",di(3,lL,e.selectedOptions,e.removeOption.bind(e))),p(),g("ngIf",!e.modelValue()||e.modelValue().length===0)}}function TL(t,r){if(t&1){let e=pe();$t(),d(0,"svg",31),ee("click",function(i){O(e);let o=h(2);return B(o.clear(i))}),u()}if(t&2){let e=h(2);_e(e.cx("clearIcon")),g("pBind",e.ptm("clearIcon")),Ue("aria-hidden",!0)}}function EL(t,r){}function IL(t,r){t&1&&P(0,EL,0,0,"ng-template")}function FL(t,r){if(t&1){let e=pe();d(0,"span",27),ee("click",function(i){O(e);let o=h(2);return B(o.clear(i))}),P(1,IL,1,0,null,32),u()}if(t&2){let e=h(2);_e(e.cx("clearIcon")),g("pBind",e.ptm("clearIcon")),Ue("aria-hidden",!0),p(),g("ngTemplateOutlet",e.clearIconTemplate||e._clearIconTemplate)}}function AL(t,r){if(t&1&&(Le(0),P(1,TL,1,4,"svg",29)(2,FL,2,5,"span",30),Ne()),t&2){let e=h();p(),g("ngIf",!e.clearIconTemplate&&!e._clearIconTemplate),p(),g("ngIf",e.clearIconTemplate||e._clearIconTemplate)}}function PL(t,r){t&1&&Tt(0)}function DL(t,r){if(t&1&&(Le(0),P(1,PL,1,0,"ng-container",32),Ne()),t&2){let e=h(2);p(),g("ngTemplateOutlet",e.loadingIconTemplate||e._loadingIconTemplate)}}function OL(t,r){if(t&1&&Y(0,"span",19),t&2){let e=h(3);_e(e.cn(e.cx("loadingIcon"),"pi-spin "+e.loadingIcon)),g("pBind",e.ptm("loadingIcon")),Ue("aria-hidden",!0)}}function BL(t,r){if(t&1&&Y(0,"span",19),t&2){let e=h(3);_e(e.cn(e.cx("loadingIcon"),"pi pi-spinner pi-spin")),g("pBind",e.ptm("loadingIcon")),Ue("aria-hidden",!0)}}function ML(t,r){if(t&1&&(Le(0),P(1,OL,1,4,"span",33)(2,BL,1,4,"span",33),Ne()),t&2){let e=h(2);p(),g("ngIf",e.loadingIcon),p(),g("ngIf",!e.loadingIcon)}}function RL(t,r){if(t&1&&(Le(0),P(1,DL,2,1,"ng-container",20)(2,ML,3,2,"ng-container",20),Ne()),t&2){let e=h();p(),g("ngIf",e.loadingIconTemplate||e._loadingIconTemplate),p(),g("ngIf",!e.loadingIconTemplate&&!e._loadingIconTemplate)}}function LL(t,r){if(t&1&&Y(0,"span",36),t&2){let e=h(3);_e(e.cx("dropdownIcon")),g("pBind",e.ptm("dropdownIcon"))("ngClass",e.dropdownIcon),Ue("aria-hidden",!0)}}function NL(t,r){if(t&1&&($t(),Y(0,"svg",37)),t&2){let e=h(3);_e(e.cx("dropdownIcon")),g("pBind",e.ptm("dropdownIcon")),Ue("aria-hidden",!0)}}function VL(t,r){if(t&1&&(Le(0),P(1,LL,1,5,"span",34)(2,NL,1,4,"svg",35),Ne()),t&2){let e=h(2);p(),g("ngIf",e.dropdownIcon),p(),g("ngIf",!e.dropdownIcon)}}function zL(t,r){}function UL(t,r){t&1&&P(0,zL,0,0,"ng-template")}function WL(t,r){if(t&1&&(d(0,"span",19),P(1,UL,1,0,null,32),u()),t&2){let e=h(2);_e(e.cx("dropdownIcon")),g("pBind",e.ptm("dropdownIcon")),Ue("aria-hidden",!0),p(),g("ngTemplateOutlet",e.dropdownIconTemplate||e._dropdownIconTemplate)}}function jL(t,r){if(t&1&&P(0,VL,3,2,"ng-container",20)(1,WL,2,5,"span",33),t&2){let e=h();g("ngIf",!e.dropdownIconTemplate&&!e._dropdownIconTemplate),p(),g("ngIf",e.dropdownIconTemplate||e._dropdownIconTemplate)}}function HL(t,r){t&1&&Tt(0)}function $L(t,r){t&1&&Tt(0)}function GL(t,r){if(t&1&&(Le(0),P(1,$L,1,0,"ng-container",28),Ne()),t&2){let e=h(3);p(),g("ngTemplateOutlet",e.filterTemplate||e._filterTemplate)("ngTemplateOutletContext",vt(2,s1,e.filterOptions))}}function KL(t,r){if(t&1&&($t(),Y(0,"svg",45)),t&2){let e=h().class,n=h(5);_e(e),g("pBind",n.getHeaderCheckboxPTOptions("pcHeaderCheckbox.icon"))}}function XL(t,r){}function JL(t,r){t&1&&P(0,XL,0,0,"ng-template")}function qL(t,r){if(t&1&&P(0,KL,1,3,"svg",44)(1,JL,1,0,null,28),t&2){let e=r.class,n=h(5);g("ngIf",!n.headerCheckboxIconTemplate&&!n._headerCheckboxIconTemplate&&n.allSelected()),p(),g("ngTemplateOutlet",n.headerCheckboxIconTemplate||n._headerCheckboxIconTemplate)("ngTemplateOutletContext",fo(3,cL,n.allSelected(),n.partialSelected(),e))}}function QL(t,r){if(t&1){let e=pe();d(0,"p-checkbox",43,10),ee("onChange",function(i){O(e);let o=h(4);return B(o.onToggleAll(i))}),P(2,qL,2,7,"ng-template",null,11,Z),u()}if(t&2){let e=h(4);g("pt",e.getHeaderCheckboxPTOptions("pcHeaderCheckbox"))("ngModel",e.allSelected())("ariaLabel",e.toggleAllAriaLabel)("binary",!0)("variant",e.$variant())("disabled",e.$disabled())}}function YL(t,r){if(t&1&&($t(),Y(0,"svg",50)),t&2){let e=h(5);g("pBind",e.ptm("filterIcon"))}}function ZL(t,r){}function e7(t,r){t&1&&P(0,ZL,0,0,"ng-template")}function t7(t,r){if(t&1&&(d(0,"span",51),P(1,e7,1,0,null,32),u()),t&2){let e=h(5);g("pBind",e.ptm("filterIcon")),p(),g("ngTemplateOutlet",e.filterIconTemplate||e._filterIconTemplate)}}function r7(t,r){if(t&1){let e=pe();d(0,"p-iconfield",46)(1,"input",47,12),ee("input",function(i){O(e);let o=h(4);return B(o.onFilterInputChange(i))})("keydown",function(i){O(e);let o=h(4);return B(o.onFilterKeyDown(i))})("click",function(i){O(e);let o=h(4);return B(o.onInputClick(i))})("blur",function(i){O(e);let o=h(4);return B(o.onFilterBlur(i))}),u(),d(3,"p-inputicon",46),P(4,YL,1,1,"svg",48)(5,t7,2,2,"span",49),u()()}if(t&2){let e=h(4);_e(e.cx("pcFilterContainer")),g("pt",e.ptm("pcFilterContainer")),p(),_e(e.cx("pcFilter")),g("pt",e.ptm("pcFilter"))("variant",e.$variant())("value",e._filterValue()||""),Ue("autocomplete",e.autocomplete)("aria-owns",e.id+"_list")("aria-activedescendant",e.focusedOptionId)("disabled",e.$disabled()?"":void 0)("placeholder",e.filterPlaceHolder)("aria-label",e.ariaFilterLabel),p(2),g("pt",e.ptm("pcFilterIconContainer")),p(),g("ngIf",!e.filterIconTemplate&&!e._filterIconTemplate),p(),g("ngIf",e.filterIconTemplate||e._filterIconTemplate)}}function i7(t,r){if(t&1&&P(0,QL,4,6,"p-checkbox",41)(1,r7,6,17,"p-iconfield",42),t&2){let e=h(3);g("ngIf",e.showToggleAll&&!e.selectionLimit),p(),g("ngIf",e.filter)}}function n7(t,r){if(t&1&&(d(0,"div",19),gr(1),P(2,GL,2,4,"ng-container",21)(3,i7,2,2,"ng-template",null,9,Z),u()),t&2){let e=Dr(4),n=h(2);_e(n.cx("header")),g("pBind",n.ptm("header")),p(2),g("ngIf",n.filterTemplate||n._filterTemplate)("ngIfElse",e)}}function o7(t,r){t&1&&Tt(0)}function a7(t,r){if(t&1&&P(0,o7,1,0,"ng-container",28),t&2){let e=r.$implicit,n=r.options;h(2);let i=Dr(9);g("ngTemplateOutlet",i)("ngTemplateOutletContext",di(2,l1,e,n))}}function s7(t,r){t&1&&Tt(0)}function l7(t,r){if(t&1&&P(0,s7,1,0,"ng-container",28),t&2){let e=r.options,n=h(4);g("ngTemplateOutlet",n.loaderTemplate||n._loaderTemplate)("ngTemplateOutletContext",vt(2,s1,e))}}function c7(t,r){t&1&&(Le(0),P(1,l7,1,4,"ng-template",null,14,Z),Ne())}function u7(t,r){if(t&1){let e=pe();d(0,"p-scroller",52,13),ee("onLazyLoad",function(i){O(e);let o=h(2);return B(o.onLazyLoad.emit(i))}),P(2,a7,1,5,"ng-template",null,3,Z)(4,c7,3,0,"ng-container",20),u()}if(t&2){let e=h(2);Qt(vt(9,vc,e.scrollHeight)),g("items",e.visibleOptions())("itemSize",e.virtualScrollItemSize)("autoSize",!0)("tabindex",-1)("lazy",e.lazy)("options",e.virtualScrollOptions),p(4),g("ngIf",e.loaderTemplate||e._loaderTemplate)}}function d7(t,r){t&1&&Tt(0)}function p7(t,r){if(t&1&&(Le(0),P(1,d7,1,0,"ng-container",28),Ne()),t&2){h();let e=Dr(9),n=h();p(),g("ngTemplateOutlet",e)("ngTemplateOutletContext",di(3,l1,n.visibleOptions(),Je(2,uL)))}}function f7(t,r){if(t&1&&(d(0,"span"),v(1),u()),t&2){let e=h(2).$implicit,n=h(3);p(),he(n.getOptionGroupLabel(e.optionGroup))}}function m7(t,r){if(t&1&&Tt(0,58),t&2){let e=h(2).$implicit,n=h(3);g("ngTemplateOutlet",n.groupTemplate)("ngTemplateOutletContext",vt(2,a1,e.optionGroup))}}function h7(t,r){if(t&1&&(Le(0),d(1,"li",56),P(2,f7,2,1,"span",20)(3,m7,1,4,"ng-container",57),u(),Ne()),t&2){let e=h(),n=e.$implicit,i=e.index,o=h().options,a=h(2);p(),_e(a.cx("optionGroup")),g("pBind",a.ptm("optionGroup"))("ngStyle",vt(7,vc,o.itemSize+"px")),Ue("id",a.id+"_"+a.getOptionIndex(i,o)),p(),g("ngIf",!a.groupTemplate&&n.optionGroup),p(),g("ngIf",n.optionGroup&&a.groupTemplate)}}function g7(t,r){if(t&1){let e=pe();Le(0),d(1,"li",59),ee("onClick",function(i){O(e);let o=h().index,a=h().options,l=h(2);return B(l.onOptionSelect(i,!1,l.getOptionIndex(o,a)))})("onMouseEnter",function(i){O(e);let o=h().index,a=h().options,l=h(2);return B(l.onOptionMouseEnter(i,l.getOptionIndex(o,a)))}),u(),Ne()}if(t&2){let e=h(),n=e.$implicit,i=e.index,o=h().options,a=h(2);p(),g("pBind",a.getPTOptions(n,a.getItemOptions,i,"option"))("id",a.id+"_"+a.getOptionIndex(i,o))("option",n)("selected",a.isSelected(n))("label",a.getOptionLabel(n))("disabled",a.isOptionDisabled(n))("template",a.itemTemplate||a._itemTemplate)("itemCheckboxIconTemplate",a.itemCheckboxIconTemplate||a._itemCheckboxIconTemplate)("itemSize",o.itemSize)("focused",a.focusedOptionIndex()===a.getOptionIndex(i,o))("ariaPosInset",a.getAriaPosInset(a.getOptionIndex(i,o)))("ariaSetSize",a.ariaSetSize)("variant",a.$variant())("highlightOnSelect",a.highlightOnSelect)("pt",a.pt)}}function _7(t,r){if(t&1&&P(0,h7,4,9,"ng-container",20)(1,g7,2,15,"ng-container",20),t&2){let e=r.$implicit,n=h(3);g("ngIf",n.isOptionGroup(e)),p(),g("ngIf",!n.isOptionGroup(e))}}function x7(t,r){if(t&1&&v(0),t&2){let e=h(4);Ie(" ",e.emptyFilterMessageLabel," ")}}function v7(t,r){t&1&&Tt(0)}function b7(t,r){if(t&1&&P(0,v7,1,0,"ng-container",32),t&2){let e=h(4);g("ngTemplateOutlet",e.emptyFilterTemplate||e._emptyFilterTemplate||e.emptyTemplate||e._emptyFilterTemplate)}}function y7(t,r){if(t&1&&(d(0,"li",56),ft(1,x7,1,1)(2,b7,1,1,"ng-container"),u()),t&2){let e=h().options,n=h(2);_e(n.cx("emptyMessage")),g("pBind",n.ptm("emptyMessage"))("ngStyle",vt(5,vc,e.itemSize+"px")),p(),mt(!n.emptyFilterTemplate&&!n._emptyFilterTemplate&&!n.emptyTemplate&&!n._emptyTemplate?1:2)}}function C7(t,r){if(t&1&&v(0),t&2){let e=h(4);Ie(" ",e.emptyMessageLabel," ")}}function w7(t,r){t&1&&Tt(0)}function S7(t,r){if(t&1&&P(0,w7,1,0,"ng-container",32),t&2){let e=h(4);g("ngTemplateOutlet",e.emptyTemplate||e._emptyTemplate)}}function k7(t,r){if(t&1&&(d(0,"li",56),ft(1,C7,1,1)(2,S7,1,1,"ng-container"),u()),t&2){let e=h().options,n=h(2);_e(n.cx("emptyMessage")),g("pBind",n.ptm("emptyMessage"))("ngStyle",vt(5,vc,e.itemSize+"px")),p(),mt(!n.emptyTemplate&&!n._emptyTemplate?1:2)}}function T7(t,r){if(t&1&&(d(0,"ul",53,15),P(2,_7,2,2,"ng-template",54)(3,y7,3,7,"li",55)(4,k7,3,7,"li",55),u()),t&2){let e=r.$implicit,n=r.options,i=h(2);Qt(n.contentStyle),_e(i.cn(i.cx("list"),n.contentStyleClass)),g("pBind",i.ptm("list")),Ue("aria-label",i.listLabel),p(2),g("ngForOf",e),p(),g("ngIf",i.hasFilter()&&i.isEmpty()),p(),g("ngIf",!i.hasFilter()&&i.isEmpty())}}function E7(t,r){t&1&&Tt(0)}function I7(t,r){if(t&1&&(d(0,"div"),gr(1,1),P(2,E7,1,0,"ng-container",32),u()),t&2){let e=h(2);p(2),g("ngTemplateOutlet",e.footerTemplate||e._footerTemplate)}}function F7(t,r){if(t&1){let e=pe();d(0,"div",38)(1,"span",39,6),ee("focus",function(i){O(e);let o=h();return B(o.onFirstHiddenFocus(i))}),u(),P(3,HL,1,0,"ng-container",32)(4,n7,5,5,"div",33),d(5,"div",19),P(6,u7,5,11,"p-scroller",40)(7,p7,2,6,"ng-container",20)(8,T7,5,9,"ng-template",null,7,Z),u(),P(10,I7,3,1,"div",20),d(11,"span",39,8),ee("focus",function(i){O(e);let o=h();return B(o.onLastHiddenFocus(i))}),u()()}if(t&2){let e=h();_e(e.cn(e.cx("overlay"),e.panelStyleClass)),g("pBind",e.ptm("overlay"))("ngStyle",e.panelStyle),Ue("id",e.id+"_list"),p(),g("pBind",e.ptm("firstHiddenFocusableEl")),Ue("tabindex",0)("data-p-hidden-accessible",!0)("data-p-hidden-focusable",!0),p(2),g("ngTemplateOutlet",e.headerTemplate||e._headerTemplate),p(),g("ngIf",e.showHeader),p(),_e(e.cx("listContainer")),Vi("max-height",e.virtualScroll?"auto":e.scrollHeight||"auto"),g("pBind",e.ptm("listContainer")),p(),g("ngIf",e.virtualScroll),p(),g("ngIf",!e.virtualScroll),p(3),g("ngIf",e.footerFacet||e.footerTemplate||e._footerTemplate),p(),g("pBind",e.ptm("lastHiddenFocusableEl")),Ue("tabindex",0)("data-p-hidden-accessible",!0)("data-p-hidden-focusable",!0)}}var A7=`
    ${n1}

    /* For PrimeNG */
   .p-multiselect.ng-invalid.ng-dirty {
        border-color: dt('multiselect.invalid.border.color');
    }
    p-multiSelect.ng-invalid.ng-dirty .p-multiselect-label.p-placeholder,
    p-multi-select.ng-invalid.ng-dirty .p-multiselect-label.p-placeholder,
    p-multiselect.ng-invalid.ng-dirty .p-multiselect-label.p-placeholder {
        color: dt('multiselect.invalid.placeholder.color');
    }
`,P7={root:({instance:t})=>({position:t.$appendTo()==="self"?"relative":void 0})},D7={root:({instance:t})=>["p-multiselect p-component p-inputwrapper",{"p-multiselect p-component p-inputwrapper":!0,"p-multiselect-display-chip":t.display==="chip","p-disabled":t.$disabled(),"p-invalid":t.invalid(),"p-variant-filled":t.$variant()==="filled","p-focus":t.focused,"p-inputwrapper-filled":t.$filled(),"p-inputwrapper-focus":t.focused||t.overlayVisible,"p-multiselect-open":t.overlayVisible,"p-multiselect-fluid":t.hasFluid,"p-multiselect-sm p-inputfield-sm":t.size()==="small","p-multiselect-lg p-inputfield-lg":t.size()==="large"}],labelContainer:"p-multiselect-label-container",label:({instance:t})=>({"p-multiselect-label":!0,"p-placeholder":t.label()===t.placeholder(),"p-multiselect-label-empty":!t.placeholder()&&!t.defaultLabel&&(!t.modelValue()||t.modelValue().length===0)}),chipItem:"p-multiselect-chip-item",pcChip:"p-multiselect-chip",chipIcon:"p-multiselect-chip-icon",dropdown:"p-multiselect-dropdown",loadingIcon:"p-multiselect-loading-icon",dropdownIcon:"p-multiselect-dropdown-icon",overlay:"p-multiselect-overlay p-component-overlay p-component",header:"p-multiselect-header",pcFilterContainer:"p-multiselect-filter-container",pcFilter:"p-multiselect-filter",listContainer:"p-multiselect-list-container",list:"p-multiselect-list",optionGroup:"p-multiselect-option-group",option:({instance:t})=>({"p-multiselect-option":!0,"p-multiselect-option-selected":t.selected&&t.highlightOnSelect,"p-disabled":t.disabled,"p-focus":t.focused}),emptyMessage:"p-multiselect-empty-message",clearIcon:"p-multiselect-clear-icon"},xc=(()=>{class t extends ir{name="multiselect";style=A7;classes=D7;inlineStyles=P7;static \u0275fac=(()=>{let e;return function(i){return(e||(e=ht(t)))(i||t)}})();static \u0275prov=Ye({token:t,factory:t.\u0275fac})}return t})();var o1=new wt("MULTISELECT_INSTANCE"),O7=new wt("MULTISELECT_ITEM_INSTANCE"),B7={provide:tl,useExisting:Ni(()=>Ho),multi:!0},M7=(()=>{class t extends Zt{$pcMultiSelectItem=we(O7,{optional:!0,skipSelf:!0})??void 0;hostName="MultiSelect";getPTOptions(e){return this.ptm(e,{context:{selected:this.selected,focused:this.focused,disabled:this.disabled}})}option;selected;label;disabled;itemSize;focused;ariaPosInset;ariaSetSize;variant;template;checkIconTemplate;itemCheckboxIconTemplate;highlightOnSelect;onClick=new xt;onMouseEnter=new xt;_componentStyle=we(xc);onOptionClick(e){this.onClick.emit({originalEvent:e,option:this.option,selected:this.selected}),e.stopPropagation(),e.preventDefault()}onOptionMouseEnter(e){this.onMouseEnter.emit({originalEvent:e,option:this.option,selected:this.selected})}static \u0275fac=(()=>{let e;return function(i){return(e||(e=ht(t)))(i||t)}})();static \u0275cmp=He({type:t,selectors:[["li","pMultiSelectItem",""]],hostAttrs:["role","option"],hostVars:12,hostBindings:function(n,i){n&1&&ee("click",function(a){return i.onOptionClick(a)})("mouseenter",function(a){return i.onOptionMouseEnter(a)}),n&2&&(Ue("aria-label",i.label)("aria-setsize",i.ariaSetSize)("aria-posinset",i.ariaPosInset)("aria-selected",i.selected)("data-p-focused",i.focused)("data-p-highlight",i.selected)("data-p-disabled",i.disabled)("aria-checked",i.selected),_e(i.cx("option")),Vi("height",i.itemSize,"px"))},inputs:{option:"option",selected:[2,"selected","selected",$e],label:"label",disabled:[2,"disabled","disabled",$e],itemSize:[2,"itemSize","itemSize",Or],focused:[2,"focused","focused",$e],ariaPosInset:"ariaPosInset",ariaSetSize:"ariaSetSize",variant:"variant",template:"template",checkIconTemplate:"checkIconTemplate",itemCheckboxIconTemplate:"itemCheckboxIconTemplate",highlightOnSelect:[2,"highlightOnSelect","highlightOnSelect",$e]},outputs:{onClick:"onClick",onMouseEnter:"onMouseEnter"},features:[Dt([xc]),lt],attrs:TR,decls:4,vars:12,consts:[["icon",""],[3,"ngModel","binary","tabindex","variant","ariaLabel","pt"],[4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(n,i){n&1&&(d(0,"p-checkbox",1),P(1,PR,3,0,"ng-container",2),u(),P(2,DR,2,1,"span",2)(3,OR,1,0,"ng-container",3)),n&2&&(g("ngModel",i.selected)("binary",!0)("tabindex",-1)("variant",i.variant)("ariaLabel",i.label)("pt",i.getPTOptions("pcOptionCheckbox")),p(),g("ngIf",i.itemCheckboxIconTemplate),p(),g("ngIf",!i.template),p(),g("ngTemplateOutlet",i.template)("ngTemplateOutletContext",vt(10,a1,i.option)))},dependencies:[et,bt,Rr,On,jr,Ur,Wr,It],encapsulation:2})}return t})(),Ho=(()=>{class t extends id{zone;filterService;overlayService;id;ariaLabel;styleClass;panelStyle;panelStyleClass;inputId;readonly;group;filter=!0;filterPlaceHolder;filterLocale;overlayVisible=!1;tabindex=0;dataKey;ariaLabelledBy;set displaySelectedLabel(e){this._displaySelectedLabel=e}get displaySelectedLabel(){return this._displaySelectedLabel}set maxSelectedLabels(e){this._maxSelectedLabels=e||0}get maxSelectedLabels(){return this._maxSelectedLabels}selectionLimit;selectedItemsLabel;showToggleAll=!0;emptyFilterMessage="";emptyMessage="";resetFilterOnHide=!1;dropdownIcon;chipIcon;optionLabel;optionValue;optionDisabled;optionGroupLabel="label";optionGroupChildren="items";showHeader=!0;filterBy;scrollHeight="200px";lazy=!1;virtualScroll;loading=!1;virtualScrollItemSize;loadingIcon;virtualScrollOptions;overlayOptions;ariaFilterLabel;filterMatchMode="contains";tooltip="";tooltipPosition="right";tooltipPositionStyle="absolute";tooltipStyleClass;autofocusFilter=!1;display="comma";autocomplete="off";showClear=!1;autofocus;set placeholder(e){this._placeholder.set(e)}get placeholder(){return this._placeholder.asReadonly()}get options(){return this._options()}set options(e){Qu(this._options(),e)||this._options.set(e||[])}get filterValue(){return this._filterValue()}set filterValue(e){this._filterValue.set(e)}get selectAll(){return this._selectAll}set selectAll(e){this._selectAll=e}focusOnHover=!0;filterFields;selectOnFocus=!1;autoOptionFocus=!1;highlightOnSelect=!0;size=kr();variant=kr();fluid=kr(void 0,{transform:$e});appendTo=kr(void 0);onChange=new xt;onFilter=new xt;onFocus=new xt;onBlur=new xt;onClick=new xt;onClear=new xt;onPanelShow=new xt;onPanelHide=new xt;onLazyLoad=new xt;onRemove=new xt;onSelectAllChange=new xt;overlayViewChild;filterInputChild;focusInputViewChild;itemsViewChild;scroller;lastHiddenFocusableElementOnOverlay;firstHiddenFocusableElementOnOverlay;headerCheckboxViewChild;footerFacet;headerFacet;_componentStyle=we(xc);bindDirectiveInstance=we(Ge,{self:!0});searchValue;searchTimeout;_selectAll=null;_placeholder=zr(void 0);_disableTooltip=!1;value;_filteredOptions;focus;filtered;itemTemplate;groupTemplate;loaderTemplate;headerTemplate;filterTemplate;footerTemplate;emptyFilterTemplate;emptyTemplate;selectedItemsTemplate;loadingIconTemplate;filterIconTemplate;removeTokenIconTemplate;chipIconTemplate;clearIconTemplate;dropdownIconTemplate;itemCheckboxIconTemplate;headerCheckboxIconTemplate;templates;_itemTemplate;_groupTemplate;_loaderTemplate;_headerTemplate;_filterTemplate;_footerTemplate;_emptyFilterTemplate;_emptyTemplate;_selectedItemsTemplate;_loadingIconTemplate;_filterIconTemplate;_removeTokenIconTemplate;_chipIconTemplate;_clearIconTemplate;_dropdownIconTemplate;_itemCheckboxIconTemplate;_headerCheckboxIconTemplate;$variant=Mt(()=>this.variant()||this.config.inputStyle()||this.config.inputVariant());$appendTo=Mt(()=>this.appendTo()||this.config.overlayAppendTo());$pcMultiSelect=we(o1,{optional:!0,skipSelf:!0})??void 0;pcFluid=we(vd,{optional:!0,host:!0,skipSelf:!0});get hasFluid(){return this.fluid()??!!this.pcFluid}onAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"item":this._itemTemplate=e.template;break;case"group":this._groupTemplate=e.template;break;case"selectedItems":case"selecteditems":this._selectedItemsTemplate=e.template;break;case"header":this._headerTemplate=e.template;break;case"filter":this._filterTemplate=e.template;break;case"emptyfilter":this._emptyFilterTemplate=e.template;break;case"empty":this._emptyTemplate=e.template;break;case"footer":this._footerTemplate=e.template;break;case"loader":this._loaderTemplate=e.template;break;case"headercheckboxicon":this._headerCheckboxIconTemplate=e.template;break;case"loadingicon":this._loadingIconTemplate=e.template;break;case"filtericon":this._filterIconTemplate=e.template;break;case"removetokenicon":this._removeTokenIconTemplate=e.template;break;case"clearicon":this._clearIconTemplate=e.template;break;case"dropdownicon":this._dropdownIconTemplate=e.template;break;case"itemcheckboxicon":this._itemCheckboxIconTemplate=e.template;break;case"chipicon":this._chipIconTemplate=e.template;break;default:this._itemTemplate=e.template;break}})}headerCheckboxFocus;filterOptions;preventModelTouched;focused=!1;itemsWrapper;_displaySelectedLabel=!0;_maxSelectedLabels=3;modelValue=zr(null);_filterValue=zr(null);_options=zr([]);startRangeIndex=zr(-1);focusedOptionIndex=zr(-1);selectedOptions;clickInProgress=!1;get emptyMessageLabel(){return this.emptyMessage||this.config.getTranslation(qr.EMPTY_MESSAGE)}get emptyFilterMessageLabel(){return this.emptyFilterMessage||this.config.getTranslation(qr.EMPTY_FILTER_MESSAGE)}get isVisibleClearIcon(){return this.modelValue()!=null&&this.modelValue()!==""&&Cn(this.modelValue())&&this.showClear&&!this.$disabled()&&!this.readonly&&this.$filled()}get toggleAllAriaLabel(){return this.config.translation.aria?this.config.translation.aria[this.allSelected()?"selectAll":"unselectAll"]:void 0}get listLabel(){return this.config.getTranslation(qr.ARIA).listLabel}getAllVisibleAndNonVisibleOptions(){return this.group?this.flatOptions(this.options):this.options||[]}visibleOptions=Mt(()=>{let e=this.getAllVisibleAndNonVisibleOptions(),n=Yu(e)&&hd.isObject(e[0]);if(this._filterValue()){let i;if(n?i=this.filterService.filter(e,this.searchFields(),this._filterValue(),this.filterMatchMode,this.filterLocale):i=e.filter(o=>o.toString().toLocaleLowerCase().includes(this._filterValue().toLocaleLowerCase())),this.group){let o=this.options||[],a=[];return o.forEach(l=>{let f=this.getOptionGroupChildren(l).filter(m=>i.includes(m));f.length>0&&a.push(vn(Pr({},l),{[typeof this.optionGroupChildren=="string"?this.optionGroupChildren:"items"]:[...f]}))}),this.flatOptions(a)}return i}return e});label=Mt(()=>{let e,n=this.modelValue();if(n&&n?.length&&this.displaySelectedLabel){if(Cn(this.maxSelectedLabels)&&n?.length>(this.maxSelectedLabels||0))return this.getSelectedItemsLabel();e="";for(let i=0;i<n.length;i++)i!==0&&(e+=", "),e+=this.getLabelByValue(n[i])}else e=this.placeholder()||"";return e});chipSelectedItems=Mt(()=>Cn(this.maxSelectedLabels)&&this.modelValue()&&this.modelValue()?.length>(this.maxSelectedLabels||0)?this.modelValue()?.slice(0,this.maxSelectedLabels):this.modelValue());constructor(e,n,i){super(),this.zone=e,this.filterService=n,this.overlayService=i,Yo(()=>{let o=this.modelValue(),a=this.getAllVisibleAndNonVisibleOptions();a&&Cn(a)&&(this.optionValue&&this.optionLabel&&o?this.selectedOptions=a.filter(l=>o.includes(l[this.optionLabel])||o.includes(l[this.optionValue])):this.selectedOptions=o,this.cd.markForCheck())})}onInit(){this.id=this.id||un("pn_id_"),this.autoUpdateModel(),this.filterBy&&(this.filterOptions={filter:e=>this.onFilterInputChange(e),reset:()=>this.resetFilter()})}maxSelectionLimitReached(){return this.selectionLimit&&this.modelValue()&&this.modelValue().length===this.selectionLimit}onAfterViewInit(){this.overlayVisible&&this.show()}onAfterViewChecked(){this.bindDirectiveInstance.setAttrs(this.ptms(["host","root"])),this.filtered&&(this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.overlayViewChild?.alignOverlay()},1)}),this.filtered=!1)}flatOptions(e){return(e||[]).reduce((n,i,o)=>{n.push({optionGroup:i,group:!0,index:o});let a=this.getOptionGroupChildren(i);return a&&a.forEach(l=>n.push(l)),n},[])}autoUpdateModel(){if(this.selectOnFocus&&this.autoOptionFocus&&!this.hasSelectedOption()){this.focusedOptionIndex.set(this.findFirstFocusedOptionIndex());let e=this.getOptionValue(this.visibleOptions()[this.focusedOptionIndex()]);this.onOptionSelect({originalEvent:null,option:[e]})}}updateModel(e,n){this.value=e,this.onModelChange(e),this.writeValue(e)}onInputClick(e){e.stopPropagation(),e.preventDefault(),this.focusedOptionIndex.set(-1)}onOptionSelect(e,n=!1,i=-1){let{originalEvent:o,option:a}=e;if(this.$disabled()||this.isOptionDisabled(a))return;let l=this.isSelected(a),c=[];l?c=this.modelValue().filter(f=>!Xi(f,this.getOptionValue(a),this.equalityKey()||"")):c=[...this.modelValue()||[],this.getOptionValue(a)],this.updateModel(c,o),i!==-1&&this.focusedOptionIndex.set(i),n&&Jr(this.focusInputViewChild?.nativeElement),this.onChange.emit({originalEvent:e,value:c,itemValue:a})}findSelectedOptionIndex(){return this.hasSelectedOption()?this.visibleOptions().findIndex(e=>this.isValidSelectedOption(e)):-1}onOptionSelectRange(e,n=-1,i=-1){if(n===-1&&(n=this.findNearestSelectedOptionIndex(i,!0)),i===-1&&(i=this.findNearestSelectedOptionIndex(n)),n!==-1&&i!==-1){let o=Math.min(n,i),a=Math.max(n,i),l=this.visibleOptions().slice(o,a+1).filter(c=>this.isValidOption(c)).map(c=>this.getOptionValue(c));this.updateModel(l,e)}}searchFields(){return(this.filterBy||this.optionLabel||"label").split(",")}findNearestSelectedOptionIndex(e,n=!1){let i=-1;return this.hasSelectedOption()&&(n?(i=this.findPrevSelectedOptionIndex(e),i=i===-1?this.findNextSelectedOptionIndex(e):i):(i=this.findNextSelectedOptionIndex(e),i=i===-1?this.findPrevSelectedOptionIndex(e):i)),i>-1?i:e}findPrevSelectedOptionIndex(e){let n=this.hasSelectedOption()&&e>0?Ao(this.visibleOptions().slice(0,e),i=>this.isValidSelectedOption(i)):-1;return n>-1?n:-1}findFirstFocusedOptionIndex(){let e=this.findFirstSelectedOptionIndex();return e<0?this.findFirstOptionIndex():e}findFirstOptionIndex(){return this.visibleOptions().findIndex(e=>this.isValidOption(e))}findFirstSelectedOptionIndex(){return this.hasSelectedOption()?this.visibleOptions().findIndex(e=>this.isValidSelectedOption(e)):-1}findNextSelectedOptionIndex(e){let n=this.hasSelectedOption()&&e<this.visibleOptions().length-1?this.visibleOptions().slice(e+1).findIndex(i=>this.isValidSelectedOption(i)):-1;return n>-1?n+e+1:-1}equalityKey(){return this.optionValue?null:this.dataKey}hasSelectedOption(){return Cn(this.modelValue())}isValidSelectedOption(e){return this.isValidOption(e)&&this.isSelected(e)}isOptionGroup(e){return e&&(this.group||this.optionGroupLabel)&&e.optionGroup&&e.group}isValidOption(e){return e&&!(this.isOptionDisabled(e)||this.isOptionGroup(e))}isOptionDisabled(e){return this.maxSelectionLimitReached()&&!this.isSelected(e)?!0:this.optionDisabled?cn(e,this.optionDisabled):e&&e.disabled!==void 0?e.disabled:!1}isSelected(e){let n=this.getOptionValue(e);return(this.modelValue()||[]).some(i=>Xi(i,n,this.equalityKey()||""))}isOptionMatched(e){return this.isValidOption(e)&&this.getOptionLabel(e).toString().toLocaleLowerCase(this.filterLocale).startsWith(this.searchValue?.toLocaleLowerCase(this.filterLocale))}isEmpty(){return!this._options()||this.visibleOptions()&&this.visibleOptions().length===0}getOptionIndex(e,n){return this.virtualScrollerDisabled?e:n&&n.getItemOptions(e).index}getAriaPosInset(e){return(this.optionGroupLabel?e-this.visibleOptions().slice(0,e).filter(n=>this.isOptionGroup(n)).length:e)+1}get ariaSetSize(){return this.visibleOptions().filter(e=>!this.isOptionGroup(e)).length}getLabelByValue(e){let i=(this.group?this.flatOptions(this._options()):this._options()||[]).find(o=>!this.isOptionGroup(o)&&Xi(this.getOptionValue(o),e,this.equalityKey()||""));return i?this.getOptionLabel(i):null}getSelectedItemsLabel(){let e=/{(.*?)}/,n=this.selectedItemsLabel?this.selectedItemsLabel:this.config.getTranslation(qr.SELECTION_MESSAGE);return e.test(n)?n.replace(n.match(e)[0],this.modelValue().length+""):n}getOptionLabel(e){return this.optionLabel?cn(e,this.optionLabel):e&&e.label!=null?e.label:e}getOptionValue(e){return this.optionValue?cn(e,this.optionValue):!this.optionLabel&&e&&e.value!==void 0?e.value:e}getOptionGroupLabel(e){return this.optionGroupLabel?cn(e,this.optionGroupLabel):e&&e.label!=null?e.label:e}getOptionGroupChildren(e){return e?this.optionGroupChildren?cn(e,this.optionGroupChildren):e.items:[]}onKeyDown(e){if(this.$disabled()){e.preventDefault();return}let n=e.metaKey||e.ctrlKey;switch(e.code){case"ArrowDown":this.onArrowDownKey(e);break;case"ArrowUp":this.onArrowUpKey(e);break;case"Home":this.onHomeKey(e);break;case"End":this.onEndKey(e);break;case"PageDown":this.onPageDownKey(e);break;case"PageUp":this.onPageUpKey(e);break;case"Enter":case"Space":this.onEnterKey(e);break;case"Escape":this.onEscapeKey(e);break;case"Tab":this.onTabKey(e);break;case"ShiftLeft":case"ShiftRight":this.onShiftKey();break;default:if(e.code==="KeyA"&&n){let i=this.visibleOptions().filter(o=>this.isValidOption(o)).map(o=>this.getOptionValue(o));this.updateModel(i,e),e.preventDefault();break}!n&&Zu(e.key)&&(!this.overlayVisible&&this.show(),this.searchOptions(e,e.key),e.preventDefault());break}}onFilterKeyDown(e){switch(e.code){case"ArrowDown":this.onArrowDownKey(e);break;case"ArrowUp":this.onArrowUpKey(e,!0);break;case"ArrowLeft":case"ArrowRight":this.onArrowLeftKey(e,!0);break;case"Home":this.onHomeKey(e,!0);break;case"End":this.onEndKey(e,!0);break;case"Enter":case"NumpadEnter":this.onEnterKey(e);break;case"Escape":this.onEscapeKey(e);break;case"Tab":this.onTabKey(e,!0);break;default:break}}onArrowLeftKey(e,n=!1){n&&this.focusedOptionIndex.set(-1)}onArrowDownKey(e){let n=this.focusedOptionIndex()!==-1?this.findNextOptionIndex(this.focusedOptionIndex()):this.findFirstFocusedOptionIndex();e.shiftKey&&this.onOptionSelectRange(e,this.startRangeIndex(),n),this.changeFocusedOptionIndex(e,n),!this.overlayVisible&&this.show(),e.preventDefault(),e.stopPropagation()}onArrowUpKey(e,n=!1){if(e.altKey&&!n)this.focusedOptionIndex()!==-1&&this.onOptionSelect(e,this.visibleOptions()[this.focusedOptionIndex()]),this.overlayVisible&&this.hide(),e.preventDefault();else{let i=this.focusedOptionIndex()!==-1?this.findPrevOptionIndex(this.focusedOptionIndex()):this.findLastFocusedOptionIndex();e.shiftKey&&this.onOptionSelectRange(e,i,this.startRangeIndex()),this.changeFocusedOptionIndex(e,i),!this.overlayVisible&&this.show(),e.preventDefault()}e.stopPropagation()}onHomeKey(e,n=!1){let{currentTarget:i}=e;if(n){let o=i.value.length;i.setSelectionRange(0,e.shiftKey?o:0),this.focusedOptionIndex.set(-1)}else{let o=e.metaKey||e.ctrlKey,a=this.findFirstOptionIndex();e.shiftKey&&o&&this.onOptionSelectRange(e,a,this.startRangeIndex()),this.changeFocusedOptionIndex(e,a),!this.overlayVisible&&this.show()}e.preventDefault()}onEndKey(e,n=!1){let{currentTarget:i}=e;if(n){let o=i.value.length;i.setSelectionRange(e.shiftKey?0:o,o),this.focusedOptionIndex.set(-1)}else{let o=e.metaKey||e.ctrlKey,a=this.findLastFocusedOptionIndex();e.shiftKey&&o&&this.onOptionSelectRange(e,this.startRangeIndex(),a),this.changeFocusedOptionIndex(e,a),!this.overlayVisible&&this.show()}e.preventDefault()}onPageDownKey(e){this.scrollInView(this.visibleOptions().length-1),e.preventDefault()}onPageUpKey(e){this.scrollInView(0),e.preventDefault()}onEnterKey(e){this.overlayVisible?this.focusedOptionIndex()!==-1&&(e.shiftKey?this.onOptionSelectRange(e,this.focusedOptionIndex()):this.onOptionSelect({originalEvent:e,option:this.visibleOptions()[this.focusedOptionIndex()]})):this.onArrowDownKey(e),e.preventDefault()}onEscapeKey(e){this.overlayVisible&&(this.hide(!0),e.stopPropagation(),e.preventDefault())}onTabKey(e,n=!1){if(!n)if(this.overlayVisible&&this.hasFocusableElements())Jr(e.shiftKey?this.lastHiddenFocusableElementOnOverlay?.nativeElement:this.firstHiddenFocusableElementOnOverlay?.nativeElement),e.preventDefault();else{if(this.focusedOptionIndex()!==-1){let i=this.visibleOptions()[this.focusedOptionIndex()];!this.isSelected(i)&&this.onOptionSelect({originalEvent:e,option:i})}this.overlayVisible&&this.hide(this.filter)}}onShiftKey(){this.startRangeIndex.set(this.focusedOptionIndex())}onContainerClick(e){if(!(this.$disabled()||this.loading||this.readonly||e.target?.isSameNode?.(this.focusInputViewChild?.nativeElement))){if(!this.overlayViewChild||!this.overlayViewChild.el.nativeElement.contains(e.target)){if(this.clickInProgress)return;this.clickInProgress=!0,setTimeout(()=>{this.clickInProgress=!1},150),this.overlayVisible?this.hide(!0):this.show(!0)}this.focusInputViewChild?.nativeElement.focus({preventScroll:!0}),this.onClick.emit(e),this.cd.detectChanges()}}onFirstHiddenFocus(e){let n=e.relatedTarget===this.focusInputViewChild?.nativeElement?Ju(this.overlayViewChild?.overlayViewChild?.nativeElement,':not([data-p-hidden-focusable="true"])'):this.focusInputViewChild?.nativeElement;Jr(n)}onInputFocus(e){this.focused=!0;let n=this.focusedOptionIndex()!==-1?this.focusedOptionIndex():this.overlayVisible&&this.autoOptionFocus?this.findFirstFocusedOptionIndex():-1;this.focusedOptionIndex.set(n),this.overlayVisible&&this.scrollInView(this.focusedOptionIndex()),this.onFocus.emit({originalEvent:e})}onInputBlur(e){this.focused=!1,this.onBlur.emit({originalEvent:e}),this.preventModelTouched||this.onModelTouched(),this.preventModelTouched=!1}onFilterInputChange(e){let n=e.target.value;this._filterValue.set(n),this.focusedOptionIndex.set(-1),this.onFilter.emit({originalEvent:e,filter:this._filterValue()}),!this.virtualScrollerDisabled&&this.scroller?.scrollToIndex(0),setTimeout(()=>{this.overlayViewChild?.alignOverlay()})}onLastHiddenFocus(e){let n=e.relatedTarget===this.focusInputViewChild?.nativeElement?qu(this.overlayViewChild?.overlayViewChild?.nativeElement,':not([data-p-hidden-focusable="true"])'):this.focusInputViewChild?.nativeElement;Jr(n)}onOptionMouseEnter(e,n){this.focusOnHover&&this.changeFocusedOptionIndex(e,n)}onFilterBlur(e){this.focusedOptionIndex.set(-1)}onToggleAll(e){if(!(this.$disabled()||this.readonly)){if(this.selectAll!=null)this.onSelectAllChange.emit({originalEvent:e,checked:!this.allSelected()});else{let n=this.getAllVisibleAndNonVisibleOptions().filter(c=>this.isSelected(c)&&(this.optionDisabled?cn(c,this.optionDisabled):c&&c.disabled!==void 0?c.disabled:!1)),i=this.allSelected()?this.visibleOptions().filter(c=>!this.isValidOption(c)&&this.isSelected(c)):this.visibleOptions().filter(c=>this.isSelected(c)||this.isValidOption(c)),a=[...this.filter&&!this.allSelected()?this.getAllVisibleAndNonVisibleOptions().filter(c=>this.isSelected(c)&&this.isValidOption(c)):[],...n,...i].map(c=>this.getOptionValue(c)),l=[...new Set(a)];this.updateModel(l,e),(!l.length||l.length===this.getAllVisibleAndNonVisibleOptions().length)&&this.onSelectAllChange.emit({originalEvent:e,checked:!!l.length})}this.partialSelected()&&(this.selectedOptions=[],this.cd.markForCheck()),this.onChange.emit({originalEvent:e,value:this.value}),gd.focus(this.headerCheckboxViewChild?.inputViewChild?.nativeElement),this.headerCheckboxFocus=!0,e.originalEvent.preventDefault(),e.originalEvent.stopPropagation()}}changeFocusedOptionIndex(e,n){this.focusedOptionIndex()!==n&&(this.focusedOptionIndex.set(n),this.scrollInView())}get virtualScrollerDisabled(){return!this.virtualScroll}scrollInView(e=-1){let n=e!==-1?`${this.id}_${e}`:this.focusedOptionId;if(this.itemsViewChild&&this.itemsViewChild.nativeElement){let i=Xr(this.itemsViewChild.nativeElement,`li[id="${n}"]`);i?i.scrollIntoView&&i.scrollIntoView({block:"nearest",inline:"nearest"}):this.virtualScrollerDisabled||setTimeout(()=>{this.virtualScroll&&this.scroller?.scrollToIndex(e!==-1?e:this.focusedOptionIndex())},0)}}get focusedOptionId(){return this.focusedOptionIndex()!==-1?`${this.id}_${this.focusedOptionIndex()}`:null}allSelected(){return this.selectAll!==null?this.selectAll:Cn(this.visibleOptions())&&this.visibleOptions().every(e=>this.isOptionGroup(e)||this.isOptionDisabled(e)||this.isSelected(e))}partialSelected(){return this.selectedOptions&&this.selectedOptions.length>0&&this.selectedOptions.length<(this.options?.length||0)}show(e){this.overlayVisible=!0;let n=this.focusedOptionIndex()!==-1?this.focusedOptionIndex():this.autoOptionFocus?this.findFirstFocusedOptionIndex():this.findSelectedOptionIndex();this.focusedOptionIndex.set(n),e&&Jr(this.focusInputViewChild?.nativeElement),this.cd.markForCheck()}hide(e){this.overlayVisible=!1,this.focusedOptionIndex.set(-1),this.filter&&this.resetFilterOnHide&&this.resetFilter(),this.overlayOptions?.mode==="modal"&&_d(),e&&Jr(this.focusInputViewChild?.nativeElement),this.cd.markForCheck()}onOverlayAnimationStart(e){if(e.toState==="visible"){if(this.itemsWrapper=Xr(this.overlayViewChild?.overlayViewChild?.nativeElement,this.virtualScroll?".p-scroller":".p-multiselect-list-container"),this.virtualScroll&&this.scroller?.setContentEl(this.itemsViewChild?.nativeElement),this.options&&this.options.length)if(this.virtualScroll){let n=this.modelValue()?this.focusedOptionIndex():-1;n!==-1&&this.scroller?.scrollToIndex(n)}else{let n=Xr(this.itemsWrapper,'[data-p-highlight="true"]');n&&n.scrollIntoView({block:"nearest",inline:"nearest"})}this.filterInputChild&&this.filterInputChild.nativeElement&&(this.preventModelTouched=!0,this.autofocusFilter&&this.filterInputChild.nativeElement.focus()),this.onPanelShow.emit(e)}e.toState==="void"&&(this.itemsWrapper=null,this.onModelTouched(),this.onPanelHide.emit(e))}resetFilter(){this.filterInputChild&&this.filterInputChild.nativeElement&&(this.filterInputChild.nativeElement.value=""),this._filterValue.set(null),this._filteredOptions=null}onOverlayHide(e){this.focusedOptionIndex.set(-1),this.filter&&this.resetFilterOnHide&&this.resetFilter()}close(e){this.hide(),e.preventDefault(),e.stopPropagation()}clear(e){this.value=[],this.updateModel(null,e),this.selectedOptions=[],this.onClear.emit(),this._disableTooltip=!0,e.stopPropagation()}labelContainerMouseLeave(){this._disableTooltip&&(this._disableTooltip=!1)}removeOption(e,n){let i=this.modelValue().filter(o=>!Xi(o,e,this.equalityKey()||""));this.updateModel(i,n),this.onChange.emit({originalEvent:n,value:i,itemValue:e}),this.onRemove.emit({newValue:i,removed:e}),n&&n.stopPropagation()}findNextOptionIndex(e){let n=e<this.visibleOptions().length-1?this.visibleOptions().slice(e+1).findIndex(i=>this.isValidOption(i)):-1;return n>-1?n+e+1:e}findPrevOptionIndex(e){let n=e>0?Ao(this.visibleOptions().slice(0,e),i=>this.isValidOption(i)):-1;return n>-1?n:e}findLastSelectedOptionIndex(){return this.hasSelectedOption()?Ao(this.visibleOptions(),e=>this.isValidSelectedOption(e)):-1}findLastFocusedOptionIndex(){let e=this.findLastSelectedOptionIndex();return e<0?this.findLastOptionIndex():e}findLastOptionIndex(){return Ao(this.visibleOptions(),e=>this.isValidOption(e))}searchOptions(e,n){this.searchValue=(this.searchValue||"")+n;let i=-1,o=!1;return this.focusedOptionIndex()!==-1?(i=this.visibleOptions().slice(this.focusedOptionIndex()).findIndex(a=>this.isOptionMatched(a)),i=i===-1?this.visibleOptions().slice(0,this.focusedOptionIndex()).findIndex(a=>this.isOptionMatched(a)):i+this.focusedOptionIndex()):i=this.visibleOptions().findIndex(a=>this.isOptionMatched(a)),i!==-1&&(o=!0),i===-1&&this.focusedOptionIndex()===-1&&(i=this.findFirstFocusedOptionIndex()),i!==-1&&this.changeFocusedOptionIndex(e,i),this.searchTimeout&&clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(()=>{this.searchValue="",this.searchTimeout=null},500),o}hasFocusableElements(){return Xu(this.overlayViewChild?.overlayViewChild?.nativeElement,':not([data-p-hidden-focusable="true"])').length>0}hasFilter(){return this._filterValue()&&this._filterValue().trim().length>0}writeControlValue(e,n){this.value=e,n(e),this.cd.markForCheck()}getHeaderCheckboxPTOptions(e){return this.ptm(e,{context:{selected:this.allSelected()}})}getPTOptions(e,n,i,o){return this.ptm(o,{context:{selected:this.isSelected(e),focused:this.focusedOptionIndex()===this.getOptionIndex(i,n),disabled:this.isOptionDisabled(e)}})}static \u0275fac=function(n){return new(n||t)(Pe(Pn),Pe(Qs),Pe(Ys))};static \u0275cmp=He({type:t,selectors:[["p-multiSelect"],["p-multiselect"],["p-multi-select"]],contentQueries:function(n,i,o){if(n&1&&(Ke(o,Zs,5),Ke(o,ed,5),Ke(o,BR,4),Ke(o,MR,4),Ke(o,RR,4),Ke(o,LR,4),Ke(o,NR,4),Ke(o,VR,4),Ke(o,zR,4),Ke(o,UR,4),Ke(o,WR,4),Ke(o,jR,4),Ke(o,HR,4),Ke(o,$R,4),Ke(o,GR,4),Ke(o,KR,4),Ke(o,XR,4),Ke(o,JR,4),Ke(o,qR,4),Ke(o,pi,4)),n&2){let a;Te(a=Ee())&&(i.footerFacet=a.first),Te(a=Ee())&&(i.headerFacet=a.first),Te(a=Ee())&&(i.itemTemplate=a.first),Te(a=Ee())&&(i.groupTemplate=a.first),Te(a=Ee())&&(i.loaderTemplate=a.first),Te(a=Ee())&&(i.headerTemplate=a.first),Te(a=Ee())&&(i.filterTemplate=a.first),Te(a=Ee())&&(i.footerTemplate=a.first),Te(a=Ee())&&(i.emptyFilterTemplate=a.first),Te(a=Ee())&&(i.emptyTemplate=a.first),Te(a=Ee())&&(i.selectedItemsTemplate=a.first),Te(a=Ee())&&(i.loadingIconTemplate=a.first),Te(a=Ee())&&(i.filterIconTemplate=a.first),Te(a=Ee())&&(i.removeTokenIconTemplate=a.first),Te(a=Ee())&&(i.chipIconTemplate=a.first),Te(a=Ee())&&(i.clearIconTemplate=a.first),Te(a=Ee())&&(i.dropdownIconTemplate=a.first),Te(a=Ee())&&(i.itemCheckboxIconTemplate=a.first),Te(a=Ee())&&(i.headerCheckboxIconTemplate=a.first),Te(a=Ee())&&(i.templates=a)}},viewQuery:function(n,i){if(n&1&&(Nt(QR,5),Nt(YR,5),Nt(ZR,5),Nt(eL,5),Nt(tL,5),Nt(rL,5),Nt(iL,5),Nt(nL,5)),n&2){let o;Te(o=Ee())&&(i.overlayViewChild=o.first),Te(o=Ee())&&(i.filterInputChild=o.first),Te(o=Ee())&&(i.focusInputViewChild=o.first),Te(o=Ee())&&(i.itemsViewChild=o.first),Te(o=Ee())&&(i.scroller=o.first),Te(o=Ee())&&(i.lastHiddenFocusableElementOnOverlay=o.first),Te(o=Ee())&&(i.firstHiddenFocusableElementOnOverlay=o.first),Te(o=Ee())&&(i.headerCheckboxViewChild=o.first)}},hostVars:5,hostBindings:function(n,i){n&1&&ee("click",function(a){return i.onContainerClick(a)}),n&2&&(Ue("id",i.id),Qt(i.sx("root")),_e(i.cn(i.cx("root"),i.styleClass)))},inputs:{id:"id",ariaLabel:"ariaLabel",styleClass:"styleClass",panelStyle:"panelStyle",panelStyleClass:"panelStyleClass",inputId:"inputId",readonly:[2,"readonly","readonly",$e],group:[2,"group","group",$e],filter:[2,"filter","filter",$e],filterPlaceHolder:"filterPlaceHolder",filterLocale:"filterLocale",overlayVisible:[2,"overlayVisible","overlayVisible",$e],tabindex:[2,"tabindex","tabindex",Or],dataKey:"dataKey",ariaLabelledBy:"ariaLabelledBy",displaySelectedLabel:"displaySelectedLabel",maxSelectedLabels:"maxSelectedLabels",selectionLimit:[2,"selectionLimit","selectionLimit",Or],selectedItemsLabel:"selectedItemsLabel",showToggleAll:[2,"showToggleAll","showToggleAll",$e],emptyFilterMessage:"emptyFilterMessage",emptyMessage:"emptyMessage",resetFilterOnHide:[2,"resetFilterOnHide","resetFilterOnHide",$e],dropdownIcon:"dropdownIcon",chipIcon:"chipIcon",optionLabel:"optionLabel",optionValue:"optionValue",optionDisabled:"optionDisabled",optionGroupLabel:"optionGroupLabel",optionGroupChildren:"optionGroupChildren",showHeader:[2,"showHeader","showHeader",$e],filterBy:"filterBy",scrollHeight:"scrollHeight",lazy:[2,"lazy","lazy",$e],virtualScroll:[2,"virtualScroll","virtualScroll",$e],loading:[2,"loading","loading",$e],virtualScrollItemSize:[2,"virtualScrollItemSize","virtualScrollItemSize",Or],loadingIcon:"loadingIcon",virtualScrollOptions:"virtualScrollOptions",overlayOptions:"overlayOptions",ariaFilterLabel:"ariaFilterLabel",filterMatchMode:"filterMatchMode",tooltip:"tooltip",tooltipPosition:"tooltipPosition",tooltipPositionStyle:"tooltipPositionStyle",tooltipStyleClass:"tooltipStyleClass",autofocusFilter:[2,"autofocusFilter","autofocusFilter",$e],display:"display",autocomplete:"autocomplete",showClear:[2,"showClear","showClear",$e],autofocus:[2,"autofocus","autofocus",$e],placeholder:"placeholder",options:"options",filterValue:"filterValue",selectAll:"selectAll",focusOnHover:[2,"focusOnHover","focusOnHover",$e],filterFields:"filterFields",selectOnFocus:[2,"selectOnFocus","selectOnFocus",$e],autoOptionFocus:[2,"autoOptionFocus","autoOptionFocus",$e],highlightOnSelect:[2,"highlightOnSelect","highlightOnSelect",$e],size:[1,"size"],variant:[1,"variant"],fluid:[1,"fluid"],appendTo:[1,"appendTo"]},outputs:{onChange:"onChange",onFilter:"onFilter",onFocus:"onFocus",onBlur:"onBlur",onClick:"onClick",onClear:"onClear",onPanelShow:"onPanelShow",onPanelHide:"onPanelHide",onLazyLoad:"onLazyLoad",onRemove:"onRemove",onSelectAllChange:"onSelectAllChange"},features:[Dt([B7,xc,{provide:o1,useExisting:t},{provide:Jt,useExisting:t}]),Xt([Ge]),lt],ngContentSelectors:aL,decls:16,vars:46,consts:[["focusInput",""],["elseBlock",""],["overlay",""],["content",""],["token",""],["removeicon",""],["firstHiddenFocusableEl",""],["buildInItems",""],["lastHiddenFocusableEl",""],["builtInFilterElement",""],["headerCheckbox",""],["icon",""],["filterInput",""],["scroller",""],["loader",""],["items",""],[1,"p-hidden-accessible",3,"pBind"],["role","combobox",3,"focus","blur","keydown","pTooltip","tooltipPosition","positionStyle","tooltipStyleClass","pAutoFocus","pBind"],[3,"mouseleave","pBind","pTooltip","tooltipDisabled","tooltipPosition","positionStyle","tooltipStyleClass"],[3,"pBind"],[4,"ngIf"],[4,"ngIf","ngIfElse"],[3,"visibleChange","onAnimationStart","onHide","hostAttrSelector","visible","options","target","appendTo","pt"],[3,"pBind","class"],[3,"pBind","class",4,"ngFor","ngForOf"],[3,"onRemove","pt","label","removable","removeIcon"],[3,"class","pBind","click",4,"ngIf"],[3,"click","pBind"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["data-p-icon","times",3,"pBind","class","click",4,"ngIf"],[3,"pBind","class","click",4,"ngIf"],["data-p-icon","times",3,"click","pBind"],[4,"ngTemplateOutlet"],[3,"pBind","class",4,"ngIf"],[3,"pBind","class","ngClass",4,"ngIf"],["data-p-icon","chevron-down",3,"pBind","class",4,"ngIf"],[3,"pBind","ngClass"],["data-p-icon","chevron-down",3,"pBind"],[3,"pBind","ngStyle"],["role","presentation",1,"p-hidden-accessible","p-hidden-focusable",3,"focus","pBind"],[3,"items","style","itemSize","autoSize","tabindex","lazy","options","onLazyLoad",4,"ngIf"],[3,"pt","ngModel","ariaLabel","binary","variant","disabled","onChange",4,"ngIf"],[3,"pt","class",4,"ngIf"],[3,"onChange","pt","ngModel","ariaLabel","binary","variant","disabled"],["data-p-icon","check",3,"class","pBind",4,"ngIf"],["data-p-icon","check",3,"pBind"],[3,"pt"],["pInputText","","type","text","role","searchbox",3,"input","keydown","click","blur","pt","variant","value"],["data-p-icon","search",3,"pBind",4,"ngIf"],["class","p-multiselect-filter-icon",3,"pBind",4,"ngIf"],["data-p-icon","search",3,"pBind"],[1,"p-multiselect-filter-icon",3,"pBind"],[3,"onLazyLoad","items","itemSize","autoSize","tabindex","lazy","options"],["role","listbox","aria-multiselectable","true",3,"pBind"],["ngFor","",3,"ngForOf"],["role","option",3,"pBind","class","ngStyle",4,"ngIf"],["role","option",3,"pBind","ngStyle"],[3,"ngTemplateOutlet","ngTemplateOutletContext",4,"ngIf"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["pMultiSelectItem","","pRipple","",3,"onClick","onMouseEnter","pBind","id","option","selected","label","disabled","template","itemCheckboxIconTemplate","itemSize","focused","ariaPosInset","ariaSetSize","variant","highlightOnSelect","pt"]],template:function(n,i){if(n&1){let o=pe();Sr(oL),d(0,"div",16)(1,"input",17,0),ee("focus",function(l){return O(o),B(i.onInputFocus(l))})("blur",function(l){return O(o),B(i.onInputBlur(l))})("keydown",function(l){return O(o),B(i.onKeyDown(l))}),u()(),d(3,"div",18),ee("mouseleave",function(){return O(o),B(i.labelContainerMouseLeave())}),d(4,"div",19),P(5,CL,3,2,"ng-container",20)(6,kL,3,6,"ng-container",20),u()(),P(7,AL,3,2,"ng-container",20),d(8,"div",19),P(9,RL,3,2,"ng-container",21)(10,jL,2,2,"ng-template",null,1,Z),u(),d(12,"p-overlay",22,2),Fe("visibleChange",function(l){return O(o),ke(i.overlayVisible,l)||(i.overlayVisible=l),B(l)}),ee("onAnimationStart",function(l){return O(o),B(i.onOverlayAnimationStart(l))})("onHide",function(l){return O(o),B(i.onOverlayHide(l))}),P(14,F7,13,23,"ng-template",null,3,Z),u()}if(n&2){let o=Dr(11);g("pBind",i.ptm("hiddenInputContainer")),Ue("data-p-hidden-accessible",!0),p(),g("pTooltip",i.tooltip)("tooltipPosition",i.tooltipPosition)("positionStyle",i.tooltipPositionStyle)("tooltipStyleClass",i.tooltipStyleClass)("pAutoFocus",i.autofocus)("pBind",i.ptm("hiddenInput")),Ue("aria-disabled",i.$disabled())("id",i.inputId)("aria-label",i.ariaLabel)("aria-labelledby",i.ariaLabelledBy)("aria-haspopup","listbox")("aria-expanded",i.overlayVisible??!1)("aria-controls",i.overlayVisible?i.id+"_list":null)("tabindex",i.$disabled()?-1:i.tabindex)("aria-activedescendant",i.focused?i.focusedOptionId:void 0)("value",i.modelValue())("name",i.name())("required",i.required()?"":void 0)("disabled",i.$disabled()?"":void 0),p(2),_e(i.cx("labelContainer")),g("pBind",i.ptm("labelContainer"))("pTooltip",i.tooltip)("tooltipDisabled",i._disableTooltip)("tooltipPosition",i.tooltipPosition)("positionStyle",i.tooltipPositionStyle)("tooltipStyleClass",i.tooltipStyleClass),p(),_e(i.cx("label")),g("pBind",i.ptm("label")),p(),g("ngIf",!i.selectedItemsTemplate&&!i._selectedItemsTemplate),p(),g("ngIf",i.selectedItemsTemplate||i._selectedItemsTemplate),p(),g("ngIf",i.isVisibleClearIcon),p(),_e(i.cx("dropdown")),g("pBind",i.ptm("dropdown")),p(),g("ngIf",i.loading)("ngIfElse",o),p(3),g("hostAttrSelector",i.$attrSelector),Se("visible",i.overlayVisible),g("options",i.overlayOptions)("target","@parent")("appendTo",i.$appendTo())("pt",i.ptm("pcOverlay"))}},dependencies:[et,Br,Mr,bt,Rr,zn,M7,ul,It,pl,dl,ll,cd,fd,ho,Ta,Cd,wd,Yi,Cl,On,jr,Ur,Wr,Er,Ge],encapsulation:2,changeDetection:0})}return t})(),os=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=hr({type:t});static \u0275inj=mr({imports:[Ho,It,It]})}return t})();var R7=()=>["name"],L7=()=>({"min-width":"75rem"}),N7=t=>({"bg-orange-100":t});function V7(t,r){if(t&1&&(d(0,"div",23)(1,"div"),v(2),u()()),t&2){let e=r.$implicit;p(2),he(e.name)}}function z7(t,r){if(t&1&&(d(0,"div",23)(1,"div"),v(2),u()()),t&2){let e=r.$implicit;p(2),he(e.name)}}function U7(t,r){t&1&&(d(0,"tr",26)(1,"th"),v(2,"ID"),u(),d(3,"th"),v(4,"\u041D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435"),u(),d(5,"th"),v(6," \u041D\u0430\u043B\u0438\u0447\u0438\u0435 / \u0420\u0435\u0437\u0435\u0440\u0432 / \u0412 \u043F\u0443\u0442\u0438 "),u(),d(7,"th"),v(8,"\u041A \u043F\u043E\u0441\u0442\u0430\u0432\u043A\u0435, \u0448\u0442"),u(),d(9,"th"),v(10,"\u041F\u0440\u043E\u0434\u0430\u0436 \u0437\u0430 \u043F\u0435\u0440\u0438\u043E\u0434 / \u0432 \u0434\u0435\u043D\u044C "),u(),d(11,"th"),v(12,"\u0417\u0430\u043F\u0430\u0441 \u0432 \u0434\u043D\u044F\u0445"),u()())}function W7(t,r){if(t&1&&(d(0,"tr")(1,"td",27)(2,"div",23)(3,"span",16),v(4),u(),Y(5,"button",28),u()()()),t&2){let e=r.$implicit,n=r.expanded;p(4),he(e.cluster),p(),g("pRowToggler",e)("icon",n?"pi pi-chevron-down":"pi pi-chevron-right")}}function j7(t,r){if(t&1&&(Le(0),v(1),Ne()),t&2){let e=h().$implicit;p(),zi(" ",e.shipmentAmountFrom," - ",e.shipmentAmountTo," ")}}function H7(t,r){t&1&&(Le(0),v(1,"-"),Ne())}function $7(t,r){if(t&1&&(Le(0),d(1,"div"),v(2),u(),d(3,"div"),v(4),Ze(5,"number"),u(),Ne()),t&2){let e=h().$implicit;p(2),he(e.salesCount),p(2),Ie(" ",Et(5,2,e.salesPerDay,"1.0-1")," ")}}function G7(t,r){t&1&&(Le(0),v(1,"-"),Ne())}function K7(t,r){t&1&&(Le(0),v(1,"\u221E"),Ne())}function X7(t,r){if(t&1&&(Le(0),v(1),Ze(2,"number"),Ne()),t&2){let e=h().$implicit;p(),Ie(" ",Et(2,1,e.stockInDays,"1.0-1")," ")}}function J7(t,r){if(t&1&&(d(0,"tr",29)(1,"td"),v(2),u(),d(3,"td")(4,"div",30)(5,"span",31),v(6),u()()(),d(7,"td")(8,"div",32)(9,"div",33)(10,"div",34),v(11),u()(),d(12,"div",33)(13,"div",34),v(14),u()(),d(15,"div",33)(16,"div",34),v(17),u()()()(),d(18,"td"),P(19,j7,2,2,"ng-container",35)(20,H7,2,0,"ng-container",35),u(),d(21,"td"),P(22,$7,6,5,"ng-container",35)(23,G7,2,0,"ng-container",35),u(),d(24,"td"),P(25,K7,2,0,"ng-container",35)(26,X7,3,4,"ng-container",35),u()()),t&2){let e=r.$implicit;g("ngClass",vt(14,N7,e.StockDays<=e.ShipmentDays)),p(2),he(e.iD),p(3),g("pTooltip",Qo(e.name)),p(),Ie(" ",e.name," "),p(5),he(e.availableQuantity),p(3),he(e.reservedQuantity),p(3),Ie(" ",e.inTransitQuantity," "),p(2),g("ngIf",e.shipmentAmountFrom&&e.shipmentAmountTo),p(),g("ngIf",!e.shipmentAmountFrom||!e.shipmentAmountTo),p(2),g("ngIf",e.salesCount),p(),g("ngIf",!e.salesCount),p(2),g("ngIf",e.stockInDays==null),p(),g("ngIf",e.stockInDays!=null)}}function q7(t,r){if(t&1){let e=pe();d(0,"p-table",24),P(1,U7,13,0,"ng-template",null,1,Z)(3,W7,6,3,"ng-template",null,2,Z)(5,J7,27,16,"ng-template",null,3,Z),u(),d(7,"p-button",25),ee("click",function(){O(e);let i=h();return B(i.downloadBlob())}),v(8,"\u0421\u043A\u0430\u0447\u0430\u0442\u044C xlsx"),u()}if(t&2){let e=h();g("globalFilterFields",Je(7,R7))("loading",e.loading)("scrollable",!0)("paginator",!1)("sortOrder",1)("tableStyle",Je(8,L7))("value",e.items)}}var c1=(()=>{let r=class r extends ei{constructor(n,i,o,a,l,c){super(l),this.route=n,this.reportClient=i,this.messageService=o,this.warehouseService=a,this.dbService=c,this.loading=!1,this.filter=new fe.OzonClusterSalesReportModel({daysToAnalyze:null,notificationPeriodInDays:null,respectMinimalStock:!1,respectSupplyPreparationPeriod:!1,respectActiveSupplyOrders:!1,minShipmentAmount:0,minStockDaysAmount:void 0}),this.filterSubject=new ur(null),this.clusters=[],this.dropOffWarehouses=[],this.selectedDropOffWarehouseIDs=[]}ngOnInit(){this.titleService.setTitle("\u0414\u0435\u0444\u0438\u0446\u0438\u0442 \u0442\u043E\u0432\u0430\u0440\u043E\u0432 Ozon"),this.warehouseService.getWarehouseClusters().pipe(ge(l=>(this.loading=!1,this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0438 \u043A\u043B\u0430\u0441\u0442\u0435\u0440\u043E\u0432",severity:"error",detail:l}),it))).subscribe(l=>{this.clusters=l.filter(c=>c.sellingCluster).sort((c,f)=>c.name.localeCompare(f.name))}),this.warehouseService.getWarehouses(!1,!1).pipe(ge(l=>(this.loading=!1,this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0438 \u0441\u043A\u043B\u0430\u0434\u043E\u0432",severity:"error",detail:l}),it))).subscribe(l=>{this.dropOffWarehouses=l.filter(c=>c.type==fe.OzonWarehouseType.CrossDock||c.type==fe.OzonWarehouseType.DistributionCenter||c.type==fe.OzonWarehouseType.SortingCenter).sort((c,f)=>c.name.localeCompare(f.name))}),this.filterSubject.pipe(Yr(this.destroyed),wr(l=>!!l),Ca(1e3)).pipe(wr(l=>l.daysToAnalyze>0)).subscribe(l=>{this.loading=!0;let c=Pr({},l);delete c.date,this.dbService.update("filters",{id:r.name,data:c}).pipe(ge(f=>(this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430 \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u044F \u0444\u0438\u043B\u044C\u0442\u0440\u0430",severity:"error",detail:f}),it))).subscribe(),this.reportClient.getOzonClusterSalesReport(new fe.OzonClusterSalesReportModel(l)).pipe(ge(f=>(this.loading=!1,this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430",severity:"error",detail:f}),it))).subscribe(f=>{this.data=f,this.items=this.data.sort((m,C)=>{let y=m.cluster.localeCompare(C.cluster);return y||(y=Math.sign(m.iD-C.iD)),y}).map(m=>{let C=m;return C.salesPerDay=l.daysToAnalyze?C.salesCount/l.daysToAnalyze:null,C}),this.loading=!1})});let n=+this.route.snapshot.paramMap.get("salesAnalysisInDays"),i=+this.route.snapshot.paramMap.get("notificationPeriodInDays"),a=this.route.snapshot.paramMap.get("date")?new Date:null;this.filter.daysToAnalyze=n>0?n:7,this.filter.notificationPeriodInDays=i>0?i:7,this.dbService.getByID("filters",r.name).subscribe(l=>{l&&(l.data&&(this.filter=Object.assign(l.data,{clusterIDs:[],dropOffWarehouseIDs:[1,189]})),this.filterSubject.next(this.filter))}),this.filter.daysToAnalyze>0&&this.filter.notificationPeriodInDays>0&&this.filterSubject.next(this.filter)}onFilterChanged(){this.filterSubject.next(this.filter)}updateSelectedClusters(){let n=this.selectedClusterIDs,i=this.filter.clusterIDs,o=this.compareArrays(n,i);o!=null&&(this.filter.clusterIDs=o,this.filterSubject.next(this.filter))}updateSelectedDropOffWarehouses(){let n=this.selectedDropOffWarehouseIDs,i=this.filter.dropOffWarehouseIDs,o=this.compareArrays(n,i);o!=null&&(this.filter.dropOffWarehouseIDs=o,this.filterSubject.next(this.filter))}compareArrays(n,i){let o=n?.length??0,a=i?.length??0,l=n?.sort((f,m)=>f-m)??[];return o!=a||!l?.every((f,m)=>f==i[m])?l:void 0}generatePivotTable(n){let i={},o=new Set,a=new Set;n.forEach(C=>{o.add(C.cluster),a.add(C.iD),i[C.iD]||(i[C.iD]={name:C.name,clusters:{}}),i[C.iD].clusters[C.cluster]=C.shipmentAmountFrom});let l=Array.from(o).sort(),c=Array.from(a).sort((C,y)=>C-y),f=[],m=["ID","Name",...l];return f.push(m),c.forEach(C=>{let y=[{v:C,t:"n"},i[C].name];l.forEach(k=>{let S=i[C]?.clusters[k];S?y.push({v:S,t:"n"}):y.push(0)}),f.push(y)}),{data:f,clusters:l,productIDs:c}}exportToExcelBlob(n){let{data:i}=this.generatePivotTable(n),o=_c.book_new(),a=_c.aoa_to_sheet(i);a["!cols"]=[{wch:10},{wch:30},...Array(i[0].length-1).fill({wch:30})],_c.book_append_sheet(o,a,"\u0414\u0435\u0444\u0438\u0446\u0438\u0442");let l=ru(o,{bookType:"xlsx",type:"array",bookSST:!1});return new Blob([l],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})}downloadBlob(){let n=this.exportToExcelBlob(this.items),i=window.URL.createObjectURL(n),o=document.createElement("a");o.href=i,o.download=`\u0434\u0435\u0444\u0438\u0446\u0438\u0442-${Date.now()/1e3}.xlsx`,document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(i)}};r.\u0275fac=function(i){return new(i||r)(Pe(Sa),Pe(fe.ReportClient),Pe(Yt),Pe(Pd),Pe(Zr),Pe(Sn))},r.\u0275cmp=He({type:r,selectors:[["app-stock-starvation-report"]],features:[lt],decls:43,vars:24,consts:[["item",""],["header",""],["groupheader",""],["expandedrow",""],[1,"flex","gap-4","mb-4"],["variant","in"],["inputId","salesAnalysisInDays",3,"onInput","ngModelChange","ngModel","min","required"],["htmlFor","salesAnalysisInDays"],["inputId","maxStockDaysAmount",3,"onInput","ngModelChange","ngModel","min","required"],["htmlFor","maxStockDaysAmount"],["inputId","minShipmentAmount",3,"onInput","ngModelChange","ngModel","min","required"],["htmlFor","minShipmentAmount"],["appendTo","body","filterBy","name","maxSelectedLabels","3","optionLabel","name","optionValue","iD","inputId","dropOffWareheouses",3,"onClear","onPanelHide","ngModelChange","ngModel","options","resetFilterOnHide","showClear"],["htmlFor","dropOffWareheouses"],["appendTo","body","filterBy","name","maxSelectedLabels","3","optionLabel","name","optionValue","iD","inputId","shipmentClusters",3,"onClear","onPanelHide","ngModelChange","ngModel","options","resetFilterOnHide","showClear"],["htmlFor","shipmentClusters"],[1,"flex","items-center"],["inputId","respectMinimalStock",3,"onChange","ngModelChange","ngModel","binary"],["for","respectMinimalStock",1,"ml-2"],["inputId","respectActiveSupplyOrders",3,"onChange","ngModelChange","ngModel","binary"],["for","respectActiveSupplyOrders",1,"ml-2"],["inputId","respectSupplyPreparationPeriod",3,"onChange","ngModelChange","ngModel","binary"],["for","respectSupplyPreparationPeriod",1,"ml-2"],[1,"flex","items-center","gap-2"],["scrollHeight","400px","groupRowsBy","cluster","rowGroupMode","subheader","dataKey","cluster","sortField","stockDays",3,"globalFilterFields","loading","scrollable","paginator","sortOrder","tableStyle","value"],[3,"click"],[1,"whitespace-nowrap","m-0","p-0"],["colspan","6"],["pButton","","text","","rounded","","plain","",1,"flex","items-center","justify-center",3,"pRowToggler","icon"],[3,"ngClass"],[1,"flex"],["tooltipPosition","top",1,"truncate-text","w-96",3,"pTooltip"],[1,"flex","justify-between","items-center","gap-2"],[1,"text-center","w-16"],[1,"text-lg"],[4,"ngIf"]],template:function(i,o){if(i&1){let a=pe();Y(0,"p-toast"),d(1,"h1"),v(2,` \u041E\u0442\u0447\u0451\u0442 \u043E \u0437\u0430\u043A\u0430\u043D\u0447\u0438\u0432\u0430\u044E\u0449\u0438\u0445\u0441\u044F \u043E\u0441\u0442\u0430\u0442\u043A\u0430\u0445
`),u(),d(3,"p-card")(4,"div",4)(5,"p-floatlabel",5)(6,"p-inputNumber",6),ee("onInput",function(){return O(a),B(o.onFilterChanged())}),Fe("ngModelChange",function(c){return O(a),ke(o.filter.daysToAnalyze,c)||(o.filter.daysToAnalyze=c),B(c)}),u(),d(7,"label",7),v(8,"\u041F\u0435\u0440\u0438\u043E\u0434 \u0430\u043D\u0430\u043B\u0438\u0437\u0430 \u043F\u0440\u043E\u0434\u0430\u0436, \u0434\u043D\u0435\u0439"),u()(),d(9,"p-floatlabel",5)(10,"p-inputNumber",8),ee("onInput",function(){return O(a),B(o.onFilterChanged())}),Fe("ngModelChange",function(c){return O(a),ke(o.filter.maxStockDaysAmount,c)||(o.filter.maxStockDaysAmount=c),B(c)}),u(),d(11,"label",9),v(12,"\u0417\u0430\u043F\u0430\u0441 \u043E\u0441\u0442\u0430\u0442\u043A\u043E\u0432, \u0434\u043D\u0435\u0439"),u()(),d(13,"p-floatlabel",5)(14,"p-inputNumber",10),ee("onInput",function(){return O(a),B(o.onFilterChanged())}),Fe("ngModelChange",function(c){return O(a),ke(o.filter.minShipmentAmount,c)||(o.filter.minShipmentAmount=c),B(c)}),u(),d(15,"label",11),v(16,"\u041C\u0438\u043D\u0438\u043C\u0443\u043C \u043A \u043F\u043E\u0441\u0442\u0430\u0432\u043A\u0435, \u0448\u0442"),u()(),d(17,"p-floatlabel",5)(18,"p-multiSelect",12),ee("onClear",function(){return O(a),B(o.updateSelectedDropOffWarehouses())})("onPanelHide",function(){return O(a),B(o.updateSelectedDropOffWarehouses())}),Fe("ngModelChange",function(c){return O(a),ke(o.selectedDropOffWarehouseIDs,c)||(o.selectedDropOffWarehouseIDs=c),B(c)}),P(19,V7,3,1,"ng-template",null,0,Z),u(),d(21,"label",13),v(22,"\u0421\u043A\u043B\u0430\u0434\u044B \u043E\u0442\u0433\u0440\u0443\u0437\u043A\u0438"),u()(),d(23,"p-floatlabel",5)(24,"p-multiSelect",14),ee("onClear",function(){return O(a),B(o.updateSelectedClusters())})("onPanelHide",function(){return O(a),B(o.updateSelectedClusters())}),Fe("ngModelChange",function(c){return O(a),ke(o.selectedClusterIDs,c)||(o.selectedClusterIDs=c),B(c)}),P(25,z7,3,1,"ng-template",null,0,Z),u(),d(27,"label",15),v(28,"\u041A\u043B\u0430\u0441\u0442\u0435\u0440\u044B \u043F\u043E\u0441\u0442\u0430\u0432\u043A\u0438"),u()()(),d(29,"div",4)(30,"div",16)(31,"p-checkbox",17),ee("onChange",function(){return O(a),B(o.onFilterChanged())}),Fe("ngModelChange",function(c){return O(a),ke(o.filter.respectMinimalStock,c)||(o.filter.respectMinimalStock=c),B(c)}),u(),d(32,"label",18),v(33,"\u0423\u0447\u0438\u0442\u044B\u0432\u0430\u0442\u044C \u043C\u0438\u043D\u0438\u043C\u0430\u043B\u044C\u043D\u044B\u0439 \u043E\u0441\u0442\u0430\u0442\u043E\u043A"),u()(),d(34,"div",16)(35,"p-checkbox",19),ee("onChange",function(){return O(a),B(o.onFilterChanged())}),Fe("ngModelChange",function(c){return O(a),ke(o.filter.respectActiveSupplyOrders,c)||(o.filter.respectActiveSupplyOrders=c),B(c)}),u(),d(36,"label",20),v(37,"\u0423\u0447\u0438\u0442\u044B\u0432\u0430\u0442\u044C \u043F\u043E\u0441\u0442\u0430\u0432\u043A\u0438 \u0432 \u043F\u0440\u043E\u0446\u0435\u0441\u0441\u0435"),u()(),d(38,"div",16)(39,"p-checkbox",21),ee("onChange",function(){return O(a),B(o.onFilterChanged())}),Fe("ngModelChange",function(c){return O(a),ke(o.filter.respectSupplyPreparationPeriod,c)||(o.filter.respectSupplyPreparationPeriod=c),B(c)}),u(),d(40,"label",22),v(41,"\u0423\u0447\u0438\u0442\u044B\u0432\u0430\u0442\u044C \u043F\u043E\u0434\u0433\u043E\u0442\u043E\u0432\u043A\u0443 \u043A \u043F\u043E\u0441\u0442\u0430\u0432\u043A\u0435"),u()()(),ft(42,q7,9,9),u()}i&2&&(p(6),Se("ngModel",o.filter.daysToAnalyze),g("min",1)("required",!0),p(4),Se("ngModel",o.filter.maxStockDaysAmount),g("min",1)("required",!0),p(4),Se("ngModel",o.filter.minShipmentAmount),g("min",0)("required",!0),p(4),Se("ngModel",o.selectedDropOffWarehouseIDs),g("options",o.dropOffWarehouses)("resetFilterOnHide",!0)("showClear",!0),p(6),Se("ngModel",o.selectedClusterIDs),g("options",o.clusters)("resetFilterOnHide",!0)("showClear",!0),p(7),Se("ngModel",o.filter.respectMinimalStock),g("binary",!0),p(4),Se("ngModel",o.filter.respectActiveSupplyOrders),g("binary",!0),p(4),Se("ngModel",o.filter.respectSupplyPreparationPeriod),g("binary",!0),p(3),mt(o.items?42:-1))},dependencies:[nr,Ti,Ht,Yn,Qn,Po,On,et,Br,bt,Ro,bo,jr,Ur,rl,Wr,Ii,Ei,os,Ho,Kr,Gr,Fi,vr,xr,Io],styles:[".truncate-text[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}"]});let t=r;return t})();var Q7=()=>[50,250,1e3],Y7=()=>({"max-width":"300px"}),Z7=()=>({"min-width":"50rem"});function eN(t,r){if(t&1&&(d(0,"div"),v(1),Ze(2,"number"),u(),d(3,"div"),v(4),Ze(5,"number"),u(),d(6,"div"),v(7),Ze(8,"number"),u(),d(9,"div"),v(10),Ze(11,"number"),u()),t&2){let e=h().ngIf;p(),Ie("\u0421\u0443\u043C\u043C\u0430: ",Et(2,4,e.sum,"1.2-2")),p(3),Ie("\u041D\u0430\u0447\u0438\u0441\u043B\u0435\u043D\u043E: ",Et(5,7,e.accrual,"1.2-2")),p(3),Ie("\u041A\u043E\u043C\u0438\u0441\u0441\u0438\u044F: ",Et(8,10,e.commission,"1.2-2")),p(3),Ie("\u041D\u0430\u0447\u0438\u0441\u043B\u0435\u043D\u043E \u0437\u0430 \u0432\u044B\u0447\u0435\u0442\u043E\u043C \u043A\u043E\u043C\u0438\u0441\u0441\u0438\u0438: ",Et(11,13,e.accrual+e.commission,"1.2-2"))}}function tN(t,r){if(t&1){let e=pe();d(0,"tr")(1,"th"),v(2,"ID"),u(),d(3,"th"),v(4,"\u0414\u0430\u0442\u0430"),u(),d(5,"th",11),v(6,"\u0421\u0443\u043C\u043C\u0430 "),Y(7,"p-sortIcon",12),u(),d(8,"th"),v(9,"\u0421\u0435\u0440\u0432\u0438\u0441\u044B"),u(),Y(10,"th"),u(),d(11,"tr"),Y(12,"th")(13,"th")(14,"th"),d(15,"th")(16,"p-multiSelect",13),Fe("ngModelChange",function(i){O(e);let o=h(2);return ke(o.selectedServiceTypes,i)||(o.selectedServiceTypes=i),B(i)}),ee("onChange",function(){O(e);let i=h(2);return B(i.filterData())}),u()(),Y(17,"th"),u()}if(t&2){let e=h(2);p(16),Qt(Je(4,Y7)),Se("ngModel",e.selectedServiceTypes),g("options",e.serviceTypes)}}function rN(t,r){if(t&1&&(d(0,"div")(1,"div",17)(2,"div"),v(3),u(),d(4,"div"),v(5),Ze(6,"number"),u()()()),t&2){let e=r.$implicit,n=h(3);p(3),he(n.getOperationServiceType(e.type)),p(2),he(Et(6,2,e.price,"1.2-2"))}}function iN(t,r){if(t&1&&(d(0,"tr",14)(1,"td"),v(2),u(),d(3,"td"),v(4),Ze(5,"date"),u(),d(6,"td")(7,"span",15),v(8,"\u0421\u0443\u043C\u043C\u0430"),u(),d(9,"div"),v(10),Ze(11,"number"),u()(),d(12,"td"),P(13,rN,7,5,"div",16),u(),d(14,"td"),v(15),u()()),t&2){let e=r.$implicit,n=h(2);g("pRowToggler",e),p(2),Ie(" ",e.iD," "),p(2),Ie(" ",Et(5,6,e.date,"y-MM-dd HH:mm")," "),p(6),Ie(" ",Et(11,9,e.amount,"1.2-2"),"\u20BD "),p(3),g("ngForOf",e.services),p(2),he(n.getOperationType(e.operationType))}}function nN(t,r){t&1&&(d(0,"tr")(1,"th"),v(2,"\u0422\u0438\u043F"),u(),d(3,"th"),v(4,"\u0421\u0443\u043C\u043C\u0430"),u()())}function oN(t,r){if(t&1&&(d(0,"tr")(1,"td"),v(2),u(),d(3,"td"),v(4),u()()),t&2){let e=r.$implicit,n=h(3);p(2),zi("",n.getOperationServiceType(e.type),"",e.type),p(2),he(e.price)}}function aN(t,r){if(t&1&&(d(0,"tr")(1,"td",18)(2,"h5"),v(3,"\u0421\u0435\u0440\u0432\u0438\u0441\u044B \u043E\u043F\u0435\u0440\u0430\u0446\u0438\u0438"),u()()(),d(4,"tr")(5,"td",18)(6,"p-table",19),P(7,nN,5,0,"ng-template",null,1,Z)(9,oN,5,3,"ng-template",null,2,Z),u()()()),t&2){let e=r.$implicit;p(6),g("value",e.services)("breakpoint","960px")("tableStyle",Je(3,Z7))}}function sN(t,r){if(t&1){let e=pe();d(0,"div",9)(1,"p-table",10),ee("onPage",function(i){O(e);let o=h();return B(o.pageChange(i))}),P(2,eN,12,16,"ng-template",null,0,Z)(4,tN,18,5,"ng-template",null,1,Z)(6,iN,16,12,"ng-template",null,2,Z)(8,aN,11,4,"ng-template",null,3,Z),u()()}if(t&2){let e=r.ngIf,n=h();p(),g("value",e.items)("loading",n.loading)("totalRecords",e.totalCount)("paginator",!0)("showCurrentPageReport",!1)("rows",n.rows)("rowsPerPageOptions",Je(7,Q7))}}var u1=(()=>{let r=class r extends ei{constructor(n,i,o,a,l){super(l),this.operationClient=n,this.messageService=i,this.operationCommandHandler=o,this.timeService=a,this.rows=50,this.isLoading=!1,this.serviceTypes=[],this.selectedServiceTypes=[],this.operationServiceTypes=Object.values(fe.OperationServiceType),this.operationTypes=Object.values(fe.OperationType),this.filteredData=new ur(null),this.dataSubject=new ur(null),this.filterSubject=new ur(null),this.serviceTypes=Object.keys(fe.OperationServiceType).map(c=>({type:c,text:fe.OperationServiceType[c]})).sort((c,f)=>c.text>f.text?1:f.text>c.text?-1:0)}ngOnInit(){this.titleService.setTitle("\u0422\u0440\u0430\u043D\u0437\u0430\u043A\u0446\u0438\u0438 Ozon"),this.filterSubject.pipe(Yr(this.destroyed)).pipe(wr(n=>!!n)).pipe(xi(n=>this.operationClient.findOzonOperations(n).pipe(ge(i=>(this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430",severity:"error",detail:i}),it))))).subscribe(n=>{this.dataSubject.next(n)}),this.dataSubject.pipe(Yr(this.destroyed)).pipe(wr(n=>!!n)).pipe(ge(n=>(this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430",severity:"error",detail:n}),it))).subscribe(()=>{this.filterData()})}filterData(){let n=this.dataSubject.value,i=[],o=0,a=0,l=0;if(n)for(let f of n.items){let m=!0,C=Object.assign({},f);if(this.selectedServiceTypes.length){let y=C.services.filter(k=>this.selectedServiceTypes.find(S=>S==k.type));y.length?C.services=y:m=!1}m&&(i.push(C),a+=C.accrualsForSale,l+=C.saleCommission,o+=C.services.reduce((y,k)=>y+k.price,0)??0)}let c={totalCount:i.length,items:i,sum:o,commission:l,accrual:a};this.filteredData.next(c)}importTransactions(){return ln(this,null,function*(){let[n,i]=[this.timeService.asUtc(this.dateRange?.[0]),this.timeService.asUtc(this.dateRange?.[1])];this.operationCommandHandler.importOzonOperations(n,i).pipe(ge(o=>(this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430",severity:"error",detail:o}),it))).subscribe(()=>{this.messageService.add({summary:"\u0423\u0441\u043F\u0435\u0445",severity:"success",detail:"\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430 \u0442\u0440\u0430\u043D\u0437\u0430\u043A\u0446\u0438\u0439 \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043D\u0430"}),this.findTransactionsClick()})})}findTransactionsClick(){let n=new fe.FindOzonOperationsModel({dateFrom:this.timeService.asUtc(this.dateRange?.[0]),dateTo:this.timeService.asUtc(this.dateRange?.[1]),offset:0,count:this.rows});this.filterSubject.next(n)}getOperationServiceType(n){return this.operationServiceTypes[n]}getOperationType(n){return this.operationTypes[n]}};r.\u0275fac=function(i){return new(i||r)(Pe(fe.OperationClient),Pe(Yt),Pe(er.OperationClient),Pe(Aa),Pe(Zr))},r.\u0275cmp=He({type:r,selectors:[["app-ozon-transaction-list"]],features:[lt],decls:7,vars:7,consts:[["caption",""],["header",""],["body",""],["expandedrow",""],["header","\u0422\u0440\u0430\u043D\u0437\u0430\u043A\u0446\u0438\u0438 Ozon"],["styleClass","m-1","selectionMode","range","placeholder","\u041F\u0435\u0440\u0438\u043E\u0434",3,"ngModelChange","ngModel","showClear","readonlyInput"],["styleClass","m-1","icon","pi pi-search","label","\u041D\u0430\u0439\u0442\u0438 \u0442\u0440\u0430\u043D\u0437\u0430\u043A\u0446\u0438\u0438",3,"click"],["styleClass","m-1","label","\u0418\u043C\u043F\u043E\u0440\u0442 \u0442\u0440\u0430\u043D\u0437\u0430\u043A\u0446\u0438\u0439",3,"click","icon"],["class","card",4,"ngIf"],[1,"card"],["responsiveLayout","stack","dataKey","iD",3,"onPage","value","loading","totalRecords","paginator","showCurrentPageReport","rows","rowsPerPageOptions"],["pSortableColumn","sum"],["field","amount"],["appendTo","body","optionValue","type","optionLabel","text","placeholder","\u0412\u044B\u0431\u0440\u0430\u043D\u043D\u044B\u0435",3,"ngModelChange","onChange","ngModel","options"],[3,"pRowToggler"],[1,"p-column-title"],[4,"ngFor","ngForOf"],[1,"flex","justify-between"],["colspan","5"],["responsiveLayout","stack",3,"value","breakpoint","tableStyle"]],template:function(i,o){i&1&&(Y(0,"p-toast"),d(1,"p-card",4)(2,"p-datepicker",5),Fe("ngModelChange",function(l){return ke(o.dateRange,l)||(o.dateRange=l),l}),u(),d(3,"p-button",6),ee("click",function(){return o.findTransactionsClick()}),u(),d(4,"p-button",7),ee("click",function(){return o.importTransactions()}),u()(),P(5,sN,10,8,"div",8),Ze(6,"async")),i&2&&(p(2),Se("ngModel",o.dateRange),g("showClear",!0)("readonlyInput",!0),p(2),g("icon",o.isLoading?"pi pi-download":""),p(),g("ngIf",_r(6,5,o.filteredData)))},dependencies:[nr,Ht,Yn,Qn,et,Mr,bt,jr,Ur,Wr,qn,Jn,os,Ho,Kr,Gr,Zi,Fi,en,vr,xr,Un,Io,yn],encapsulation:2});let t=r;return t})();var lN=["table"],cN=()=>({"min-width":"75rem"}),uN=()=>[10,25,50],dN=()=>({width:"50vw"}),pN=()=>["code_128","ean","upc","upc_e","ean_8"];function fN(t,r){t&1&&(d(0,"tr")(1,"th"),v(2,"\u0414\u0430\u0442\u0430"),u(),d(3,"th"),v(4,"\u0421\u0442\u0430\u0442\u0443\u0441"),u(),d(5,"th"),v(6,"\u0421\u043A\u043B\u0430\u0434 \u043E\u0442\u0433\u0440\u0443\u0437\u043A\u0438"),u(),d(7,"th"),v(8,"\u0421\u043A\u043B\u0430\u0434\u044B \u0445\u0440\u0430\u043D\u0435\u043D\u0438\u044F"),u(),d(9,"th"),v(10,"\u041A\u043E\u043B\u0438\u0447\u0435\u0441\u0442\u0432\u043E \u043F\u043E\u0437\u0438\u0446\u0438\u0439"),u(),d(11,"th"),v(12,"\u041A\u043E\u043B\u0438\u0447\u0435\u0441\u0442\u0432\u043E \u0442\u043E\u0432\u0430\u0440\u043E\u0432"),u(),Y(13,"th"),u())}function mN(t,r){if(t&1&&(d(0,"tr")(1,"td")(2,"a",10),v(3),Ze(4,"date"),u()(),d(5,"td"),v(6),u(),d(7,"td"),v(8),u(),d(9,"td"),v(10),u(),d(11,"td"),v(12),u(),d(13,"td"),v(14),u(),d(15,"td"),Y(16,"button",11),u()()),t&2){let e=r.$implicit,n=r.expanded;p(2),g("href",Qo(e.link),Gt),p(),he(Et(4,10,e.date,"y-MM-dd")),p(3),he(e.statusName),p(2),he(e.ozonWarehouse==null?null:e.ozonWarehouse.name),p(2),he(e.warehouses),p(2),he(e.totalItemCount),p(2),he(e.totalQuantity),p(2),g("pRowToggler",e)("icon",n?"pi pi-chevron-down":"pi pi-chevron-right")}}function hN(t,r){t&1&&(d(0,"tr")(1,"th",14),v(2,"\u0410\u0440\u0442\u0438\u043A\u0443\u043B "),Y(3,"p-sortIcon",15),u(),d(4,"th",16),v(5,"\u041D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435 "),Y(6,"p-sortIcon",17),u(),d(7,"th",18),v(8,"\u041A\u043E\u043B\u0438\u0447\u0435\u0441\u0442\u0432\u043E "),Y(9,"p-sortIcon",19),u()())}function gN(t,r){if(t&1&&(d(0,"tr",20)(1,"td",12)(2,"b"),v(3),u()()()),t&2){let e=r.$implicit;p(3),he(e.ozonWarehouse==null?null:e.ozonWarehouse.name)}}function _N(t,r){if(t&1&&(d(0,"tr")(1,"td"),v(2),u(),d(3,"td"),v(4),u(),d(5,"td"),v(6),u()()),t&2){let e=r.$implicit;p(2),he(e.productPackageID),p(2),he(e.productPackage.name),p(2),he(e.quantity)}}function xN(t,r){if(t&1&&(d(0,"tr")(1,"td",12)(2,"p-table",13),P(3,hN,10,0,"ng-template",null,1,Z)(5,gN,4,1,"ng-template",null,4,Z)(7,_N,7,3,"ng-template",null,2,Z),u()()()),t&2){let e=r.$implicit;p(2),g("value",e.orderItems)}}function vN(t,r){if(t&1){let e=pe();d(0,"ngx-barcode-scanner",22),ee("valueChange",function(i){O(e);let o=h(2);return B(o.onValueChanged(i))}),u(),v(1)}if(t&2){let e=h(2);g("codes",Je(3,pN))("errorThreshold",.1),p(),Ie(" ",e.barcode," ")}}function bN(t,r){if(t&1){let e=pe();d(0,"p-dialog",21),Fe("valueChange",function(i){O(e);let o=h();return ke(o.barcode,i)||(o.barcode=i),B(i)})("visibleChange",function(i){O(e);let o=h();return ke(o.showScanBarcodeDialog,i)||(o.showScanBarcodeDialog=i),B(i)}),P(1,vN,2,4,"ng-template",null,5,Z),u()}if(t&2){let e=h();Qt(Je(7,dN)),Se("value",e.barcode),g("modal",!0),Se("visible",e.showScanBarcodeDialog),g("draggable",!1)("resizable",!1)}}var d1=(()=>{let r=class r extends ei{constructor(n,i,o,a){super(a),this.supplyOrderClient=n,this.supplyOrderCommandHandler=i,this.messageService=o,this.findSupplyOrdersSubject=new ur(null),this.rows=50}closeCellEdit(){}editComplete(n){if(n.field=="ozonCrossDockWarehouseID"){let i=n.data;this.supplyOrderCommandHandler.updateOzonSupplyOrderCrossDockWarehouse(i.iD,i.ozonCrossDockWarehouse?.iD).pipe(ge(o=>(this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430",severity:"error",detail:o}),it))).subscribe()}}ngOnInit(){this.titleService.setTitle("\u041F\u043E\u0441\u0442\u0430\u0432\u043A\u0438 Ozon"),this.findSupplyOrdersSubject.pipe(wr(n=>!!n)).pipe(Yr(this.destroyed)).pipe(cs(n=>{this.findSupplyOrders(n)}))}onValueChanged(n){}scanBarcode(){this.showScanBarcodeDialog=!0}findSupplyOrders(n){this.supplyOrderClient.findOzonSupplyOrders(n).pipe(Yr(this.destroyed)).pipe(ge(i=>(this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430",severity:"error",detail:i}),it))).subscribe(i=>{this.data=i.items,this.data.forEach(o=>{let a=o.orderItems.reduce((f,m)=>(m.ozonWarehouse?.name&&f.add(m.ozonWarehouse.name),f),new Set),l=o;l.statusName=this.getOrderStatusName(o.status),l.warehouses=[...a].join(", ");let c=o.state==fe.SupplyOrderState.DataFilling?"https://seller.ozon.ru/app/supply/orders/draft":"https://seller.ozon.ru/app/supply/orders";l.link=`${c}/${l.iD}`}),this.totalRecords=i.totalCount})}getOrderStatusName(n){let i,o=Object.values(fe.SupplyOrderState);switch(n==null?fe.SupplyOrderState.Unknown:o[n]){case fe.SupplyOrderState.AcceptanceAtStorageWarehouse:i="\u041F\u0440\u0438\u0451\u043C\u043A\u0430 \u043D\u0430 \u0441\u043A\u043B\u0430\u0434\u0435 \u0445\u0440\u0430\u043D\u0435\u043D\u0438\u044F";break;case fe.SupplyOrderState.Cancelled:i="\u041E\u0442\u043C\u0435\u043D\u0435\u043D\u0430";break;case fe.SupplyOrderState.DataFilling:i="\u0417\u0430\u043F\u043E\u043B\u043D\u0435\u043D\u0438\u0435";break;case fe.SupplyOrderState.AcceptedAtSupplyWarehouse:i="\u041F\u0440\u0438\u043D\u044F\u0442\u0430 \u043D\u0430 \u0441\u043A\u043B\u0430\u0434\u0435 \u043E\u0442\u0433\u0440\u0443\u0437\u043A\u0438";break;case fe.SupplyOrderState.Completed:i="\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043D\u0430";break;case fe.SupplyOrderState.InTransit:i="\u0412 \u043F\u0443\u0442\u0438";break;case fe.SupplyOrderState.ReadyToSupply:i="\u0413\u043E\u0442\u043E\u0432\u0430 \u043A \u043E\u0442\u0433\u0440\u0443\u0437\u043A\u0435";break;case fe.SupplyOrderState.RejectedAtSupplyWarehouse:i="\u041E\u0442\u043A\u0430\u0437\u0430\u043D\u043E \u0432 \u043F\u0440\u0438\u0451\u043C\u043A\u0435";break;case fe.SupplyOrderState.ReportRejected:i="\u0421\u043F\u043E\u0440";break;case fe.SupplyOrderState.ReportsConfirmationAwaiting:i="\u0421\u043E\u0433\u043B\u0430\u0441\u043E\u0432\u0430\u043D\u0438\u0435 \u0430\u043A\u0442\u043E\u0432";break;case fe.SupplyOrderState.Unknown:i="\u0421\u0442\u0430\u0442\u0443\u0441 \u043D\u0435 \u0437\u0430\u0434\u0430\u043D";break;default:throw Error(`Unsupported status ${n}`)}return i}onDataLazyLoad(n){let i=new fe.FindOzonSupplyOrdersModel({offset:n.first,count:n.rows});this.findSupplyOrdersSubject.next(i),this.findSupplyOrders(i)}importSupplyOrders(){return ln(this,null,function*(){this.supplyOrderCommandHandler.updateOzonSupplyOrders().pipe(ge(n=>(this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430 \u0438\u043C\u043F\u043E\u0440\u0442\u0430 \u0437\u0430\u044F\u0432\u043E\u043A \u043D\u0430 \u043F\u043E\u0441\u0442\u0430\u0432\u043A\u0443",severity:"error",detail:n}),it))).subscribe(()=>{this.messageService.add({summary:"\u0423\u0441\u043F\u0435\u0445",severity:"success",detail:"\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430 \u0437\u0430\u044F\u0432\u043E\u043A \u043D\u0430 \u043F\u043E\u0441\u0442\u0430\u0432\u043A\u0443 \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043D\u0430"}),this.onDataLazyLoad({first:0,rows:this.rows})})})}};r.\u0275fac=function(i){return new(i||r)(Pe(fe.OzonSupplyOrderClient),Pe(er.OzonSupplyOrderClient),Pe(Yt),Pe(Zr))},r.\u0275cmp=He({type:r,selectors:[["app-ozon-supply-order-list"]],viewQuery:function(i,o){if(i&1&&Nt(lN,5),i&2){let a;Te(a=Ee())&&(o.table=a.first)}},features:[lt],decls:12,vars:11,consts:[["table",""],["header",""],["body",""],["expandedrow",""],["groupheader",""],["content",""],["label","\u0421\u043A\u0430\u043D\u0438\u0440\u043E\u0432\u0430\u0442\u044C",3,"click"],["pButton","","pRipple","","type","button","label","\u0418\u043C\u043F\u043E\u0440\u0442 \u0437\u0430\u044F\u0432\u043E\u043A \u043D\u0430 \u043F\u043E\u0441\u0442\u0430\u0432\u043A\u0443",1,"ml-1",3,"click"],["dataKey","iD","editMode","cell",3,"onLazyLoad","onEditComplete","value","lazy","tableStyle","paginator","rows","rowsPerPageOptions","totalRecords","loading"],["header","\u0421\u043A\u0430\u043D\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u0435 \u043A\u043E\u0434\u0430",3,"value","modal","style","visible","draggable","resizable","valueChange","visibleChange",4,"ngIf"],["target","_blank",3,"href"],["type","button","pButton","","pRipple","",1,"p-button-text","p-button-rounded","p-button-plain",3,"pRowToggler","icon"],["colspan","7"],["rowGroupMode","subheader","groupRowsBy","ozonWarehouse?.name",3,"value"],["pSortableColumn","productPackageID"],["field","productPackageID"],["pSortableColumn","productPackage.name"],["field","productPackage.name"],["pSortableColumn","quantity"],["field","quantity"],["pRowGroupHeader",""],["header","\u0421\u043A\u0430\u043D\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u0435 \u043A\u043E\u0434\u0430",3,"valueChange","visibleChange","value","modal","visible","draggable","resizable"],["width","300",3,"valueChange","codes","errorThreshold"]],template:function(i,o){if(i&1){let a=pe();Y(0,"p-toast"),d(1,"p-button",6),ee("click",function(){return O(a),B(o.scanBarcode())}),u(),d(2,"button",7),ee("click",function(){return O(a),B(o.importSupplyOrders())}),u(),d(3,"p-table",8,0),ee("onLazyLoad",function(c){return O(a),B(o.onDataLazyLoad(c))})("onEditComplete",function(c){return O(a),B(o.editComplete(c))}),P(5,fN,14,0,"ng-template",null,1,Z)(7,mN,17,13,"ng-template",null,2,Z)(9,xN,9,1,"ng-template",null,3,Z),u(),P(11,bN,3,8,"p-dialog",9)}i&2&&(p(3),g("value",o.data)("lazy",!0)("tableStyle",Je(9,cN))("paginator",!0)("rows",o.rows)("rowsPerPageOptions",Je(10,uN))("totalRecords",o.totalRecords)("loading",o.loading),p(8),g("ngIf",o.showScanBarcodeDialog))},dependencies:[nr,Ti,Ht,et,bt,Xn,Kn,Kr,Gr,Zi,kd,Fi,en,vr,xr,yn],encapsulation:2});let t=r;return t})();var p1=`
    .p-scrolltop.p-button {
        position: fixed !important;
        inset-block-end: 20px;
        inset-inline-end: 20px;
    }

    .p-scrolltop-sticky.p-button {
        position: sticky !important;
        display: flex;
        margin-inline-start: auto;
    }

    .p-scrolltop-enter-from {
        opacity: 0;
    }

    .p-scrolltop-enter-active {
        transition: opacity 0.15s;
    }

    .p-scrolltop.p-scrolltop-leave-to {
        opacity: 0;
    }

    .p-scrolltop-leave-active {
        transition: opacity 0.15s;
    }
`;var yN=["icon"],CN=(t,r)=>({showTransitionParams:t,hideTransitionParams:r}),wN=t=>({value:"open",params:t}),SN=t=>({styleClass:t});function kN(t,r){if(t&1&&Y(0,"span"),t&2){let e=h(4);_e(e.cn(e.cx("icon"),e._icon))}}function TN(t,r){if(t&1&&($t(),Y(0,"svg",7)),t&2){let e=h(4);_e(e.cx("icon"))}}function EN(t,r){if(t&1&&(Le(0),P(1,kN,1,2,"span",5)(2,TN,1,2,"svg",6),Ne()),t&2){let e=h(3);p(),g("ngIf",e._icon),p(),g("ngIf",!e._icon)}}function IN(t,r){}function FN(t,r){if(t&1&&P(0,IN,0,0,"ng-template",8),t&2){h(2);let e=Dr(2);g("ngIf",!e)}}function AN(t,r){if(t&1&&P(0,EN,3,2,"ng-container",3)(1,FN,1,1,null,4),t&2){let e=h(2);g("ngIf",!e.iconTemplate&&!e._iconTemplate),p(),g("ngTemplateOutlet",e.iconTemplate||e._iconTemplate)("ngTemplateOutletContext",vt(3,SN,e.cx("icon")))}}function PN(t,r){if(t&1){let e=pe();d(0,"p-button",2),ee("@animation.start",function(i){O(e);let o=h();return B(o.onEnter(i))})("@animation.done",function(i){O(e);let o=h();return B(o.onLeave(i))})("click",function(){O(e);let i=h();return B(i.onClick())}),P(1,AN,2,5,"ng-template",null,0,Z),u()}if(t&2){let e=h();g("@animation",vt(9,wN,di(6,CN,e.showTransitionOptions,e.hideTransitionOptions)))("pt",e.ptm("pcButton"))("styleClass",e.cn(e.cx("root"),e.styleClass))("ngStyle",e.style)("buttonProps",e.buttonProps),Ue("aria-label",e.buttonAriaLabel)}}var DN={root:({instance:t})=>["p-scrolltop",{"p-scrolltop-sticky":t.target!=="window"}],icon:"p-scrolltop-icon"},f1=(()=>{class t extends ir{name="scrolltop";style=p1;classes=DN;static \u0275fac=(()=>{let e;return function(i){return(e||(e=ht(t)))(i||t)}})();static \u0275prov=Ye({token:t,factory:t.\u0275fac})}return t})();var m1=new wt("SCROLLTOP_INSTANCE"),Us=(()=>{class t extends Zt{$pcScrollTop=we(m1,{optional:!0,skipSelf:!0})??void 0;bindDirectiveInstance=we(Ge,{self:!0});onAfterViewChecked(){this.bindDirectiveInstance.setAttrs(this.ptms(["host","root"]))}styleClass;style;target="window";threshold=400;get icon(){return this._icon}behavior="smooth";showTransitionOptions=".15s";hideTransitionOptions=".15s";buttonAriaLabel;buttonProps={rounded:!0,severity:"success"};iconTemplate;templates;_iconTemplate;_icon;set icon(e){this._icon=e}documentScrollListener;parentScrollListener;visible=!1;overlay;_componentStyle=we(f1);onInit(){this.target==="window"?this.bindDocumentScrollListener():this.target==="parent"&&this.bindParentScrollListener()}onAfterContentInit(){this.templates.forEach(e=>{switch(e.getType()){case"icon":this._iconTemplate=e.template;break}})}onClick(){(this.target==="window"?this.document.defaultView:this.el.nativeElement.parentElement).scroll({top:0,behavior:this.behavior})}onEnter(e){switch(e.toState){case"open":this.overlay=e.element,al.set("overlay",this.overlay,this.config.zIndex.overlay);break;case"void":this.overlay=null;break}}onLeave(e){switch(e.toState){case"void":al.clear(e.element);break}}checkVisibility(e){e>this.threshold?this.visible=!0:this.visible=!1,this.cd.markForCheck()}bindParentScrollListener(){Wn(this.platformId)&&(this.parentScrollListener=this.renderer.listen(this.el.nativeElement.parentElement,"scroll",()=>{this.checkVisibility(this.el.nativeElement.parentElement.scrollTop)}))}bindDocumentScrollListener(){Wn(this.platformId)&&(this.documentScrollListener=this.renderer.listen(this.document.defaultView,"scroll",()=>{this.checkVisibility(Gu())}))}unbindParentScrollListener(){this.parentScrollListener&&(this.parentScrollListener(),this.parentScrollListener=null)}unbindDocumentScrollListener(){this.documentScrollListener&&(this.documentScrollListener(),this.documentScrollListener=null)}onDestroy(){this.target==="window"?this.unbindDocumentScrollListener():this.target==="parent"&&this.unbindParentScrollListener(),this.overlay&&(al.clear(this.overlay),this.overlay=null)}static \u0275fac=(()=>{let e;return function(i){return(e||(e=ht(t)))(i||t)}})();static \u0275cmp=He({type:t,selectors:[["p-scrollTop"],["p-scrolltop"],["p-scroll-top"]],contentQueries:function(n,i,o){if(n&1&&(Ke(o,yN,4),Ke(o,pi,4)),n&2){let a;Te(a=Ee())&&(i.iconTemplate=a.first),Te(a=Ee())&&(i.templates=a)}},inputs:{styleClass:"styleClass",style:"style",target:"target",threshold:[2,"threshold","threshold",Or],icon:"icon",behavior:"behavior",showTransitionOptions:"showTransitionOptions",hideTransitionOptions:"hideTransitionOptions",buttonAriaLabel:"buttonAriaLabel",buttonProps:"buttonProps"},features:[Dt([f1,{provide:m1,useExisting:t},{provide:Jt,useExisting:t}]),Xt([Ge]),lt],decls:1,vars:1,consts:[["icon",""],["type","button",3,"pt","styleClass","ngStyle","buttonProps","click",4,"ngIf"],["type","button",3,"click","pt","styleClass","ngStyle","buttonProps"],[4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"class",4,"ngIf"],["data-p-icon","chevron-up",3,"class",4,"ngIf"],["data-p-icon","chevron-up"],[3,"ngIf"]],template:function(n,i){n&1&&P(0,PN,3,11,"p-button",1),n&2&&g("ngIf",i.visible)},dependencies:[et,bt,Rr,zn,nl,Ht,It],encapsulation:2,data:{animation:[$n("animation",[mo("void",ki({opacity:0})),mo("open",ki({opacity:1})),Qi("void => open",qi("{{showTransitionParams}}")),Qi("open => void",qi("{{hideTransitionParams}}"))])]},changeDetection:0})}return t})(),bc=(()=>{class t{static \u0275fac=function(n){return new(n||t)};static \u0275mod=hr({type:t});static \u0275inj=mr({imports:[Us,It,It]})}return t})();var ON=()=>[30,50,100],BN=()=>({}),MN=t=>[t],RN=t=>({ids:t}),LN=t=>["/","ozon","product",t],au=()=>({"min-width":"50rem"});function NN(t,r){if(t&1){let e=pe();d(0,"div",11)(1,"p-datepicker",12),Fe("ngModelChange",function(i){O(e);let o=h();return ke(o.dateRange,i)||(o.dateRange=i),B(i)}),u(),d(2,"p-button",13),ee("click",function(){O(e);let i=h();return B(i.findOrders(i.filterModel))}),u()()}if(t&2){let e=h();p(),Se("ngModel",e.dateRange),g("readonlyInput",!0)("selectOtherMonths",!0)("showClear",!0)}}function VN(t,r){if(t&1){let e=pe();d(0,"p-button",14),ee("click",function(){O(e);let i=h();return B(i.importOrders())}),u()}if(t&2){let e=h();g("icon",e.isLoading?"pi pi-download":"")}}function zN(t,r){if(t&1&&(d(0,"span"),v(1),Ze(2,"number"),u()),t&2){let e=h(2);p(),Ie("~",Et(2,1,e.summary.expectedPayout,"1.2-2"),"\u20BD")}}function UN(t,r){t&1&&(d(0,"span"),v(1,"-"),u())}function WN(t,r){if(t&1&&(Le(0),Y(1,"img",34),Ne()),t&2){let e=h().$implicit;p(),g("src",Qo(e.value.primaryImage),Gt)}}function jN(t,r){t&1&&(Le(0),Y(1,"p-skeleton",35),Ne())}function HN(t,r){if(t&1&&(d(0,"div",33),P(1,WN,2,2,"ng-container",22)(2,jN,2,0,"ng-container",22),d(3,"div"),v(4),u()()),t&2){let e=r.$implicit;p(),g("ngIf",e.value),p(),g("ngIf",!e.value),p(2),he(e.key)}}function $N(t,r){if(t&1&&(Le(0),v(1),Ne()),t&2){let e=h().$implicit;p(),Ie(" ",e.value," ")}}function GN(t,r){t&1&&(Le(0),Y(1,"p-skeleton",36),Ne())}function KN(t,r){if(t&1&&(d(0,"div",33),P(1,$N,2,1,"ng-container",22)(2,GN,2,0,"ng-container",22),u()),t&2){let e=r.$implicit;p(),g("ngIf",e.value),p(),g("ngIf",!e.value)}}function XN(t,r){if(t&1&&(Le(0),v(1),Ne()),t&2){let e=h().$implicit;p(),Ie(" ",e.value," ")}}function JN(t,r){t&1&&(Le(0),Y(1,"p-skeleton",36),Ne())}function qN(t,r){if(t&1&&(d(0,"div",33),P(1,XN,2,1,"ng-container",22)(2,JN,2,0,"ng-container",22),u()),t&2){let e=r.$implicit;p(),g("ngIf",e.value),p(),g("ngIf",!e.value)}}function QN(t,r){if(t&1){let e=pe();d(0,"tr"),Y(1,"th",25),d(2,"th",26),v(3," \u0421\u043E\u0441\u0442\u0430\u0432 \u0437\u0430\u043A\u0430\u0437\u0430 "),Y(4,"p-sortIcon",27),u(),d(5,"th",25),v(6,"\u0421\u0443\u043C\u043C\u0430"),u(),d(7,"th",25),v(8,"\u0421\u0442\u0430\u0442\u0443\u0441"),u(),d(9,"th",25),v(10,"\u0421\u043A\u043B\u0430\u0434"),u(),d(11,"th",25),v(12,"\u041A\u043B\u0430\u0441\u0442\u0435\u0440"),u(),d(13,"th",25),v(14,"\u041B\u043E\u043A\u0430\u043B\u0438\u0437\u0430\u0446\u0438\u044F"),u(),Y(15,"th"),u(),d(16,"tr"),Y(17,"th"),d(18,"th")(19,"p-multiSelect",28),Ze(20,"keyvalue"),ee("onClear",function(){O(e);let i=h(3);return B(i.updateSelectedProductPackageIDs())})("onPanelHide",function(){O(e);let i=h(3);return B(i.updateSelectedProductPackageIDs())}),Fe("ngModelChange",function(i){O(e);let o=h(3);return ke(o.selectedProductPackageIDs,i)||(o.selectedProductPackageIDs=i),B(i)}),P(21,HN,5,3,"ng-template",null,4,Z),u()(),Y(23,"th"),d(24,"th")(25,"p-multiSelect",29),Ze(26,"keyvalue"),ee("onClear",function(){O(e);let i=h(3);return B(i.updateSelectedStatuses())})("onPanelHide",function(){O(e);let i=h(3);return B(i.updateSelectedStatuses())}),Fe("ngModelChange",function(i){O(e);let o=h(3);return ke(o.selectedStatuses,i)||(o.selectedStatuses=i),B(i)}),u()(),d(27,"th")(28,"p-multiSelect",30),Ze(29,"keyvalue"),ee("onClear",function(){O(e);let i=h(3);return B(i.updateSelectedWarehouseIDs())})("onPanelHide",function(){O(e);let i=h(3);return B(i.updateSelectedWarehouseIDs())}),Fe("ngModelChange",function(i){O(e);let o=h(3);return ke(o.selectedWarehouseIDs,i)||(o.selectedWarehouseIDs=i),B(i)}),P(30,KN,3,2,"ng-template",null,4,Z),u()(),d(32,"th")(33,"p-multiSelect",31),Ze(34,"keyvalue"),ee("onClear",function(){O(e);let i=h(3);return B(i.updateSelectedWarehouseClusterIDs())})("onPanelHide",function(){O(e);let i=h(3);return B(i.updateSelectedWarehouseClusterIDs())}),Fe("ngModelChange",function(i){O(e);let o=h(3);return ke(o.selectedWarehouseClusterIDs,i)||(o.selectedWarehouseClusterIDs=i),B(i)}),P(35,qN,3,2,"ng-template",null,4,Z),u()(),d(37,"th")(38,"p-toggleButton",32),ee("onChange",function(){O(e);let i=h(3);return B(i.updateLocalizationFilter())}),Fe("ngModelChange",function(i){O(e);let o=h(3);return ke(o.nonLocalOnly,i)||(o.nonLocalOnly=i),B(i)}),u()(),Y(39,"th"),u()}if(t&2){let e=h(3);p(19),Se("ngModel",e.selectedProductPackageIDs),g("options",_r(20,17,e.products))("resetFilterOnHide",!0)("showClear",!0),p(6),Se("ngModel",e.selectedStatuses),g("options",_r(26,19,e.orderStatuses))("resetFilterOnHide",!0)("showClear",!0),p(3),Se("ngModel",e.selectedWarehouseIDs),g("options",_r(29,21,e.warehouses))("resetFilterOnHide",!0)("showClear",!0),p(5),Se("ngModel",e.selectedWarehouseClusterIDs),g("options",_r(34,23,e.warehouseClusters))("resetFilterOnHide",!0)("showClear",!0),p(5),Se("ngModel",e.nonLocalOnly)}}function YN(t,r){if(t&1&&(d(0,"div"),Y(1,"img",49),u()),t&2){let e=h().$implicit;p(),g("src",e.primaryImage,Gt)}}function ZN(t,r){if(t&1&&(Le(0),v(1),Ne()),t&2){let e=h().$implicit;p(),Ie(" - ",e.price*e.quantity,"\u20BD ")}}function e9(t,r){if(t&1&&(d(0,"div",45),P(1,YN,2,1,"div",22),d(2,"a",46),Y(3,"i",47),u(),d(4,"a",48),v(5),u(),v(6),d(7,"b"),v(8),P(9,ZN,2,1,"ng-container",22),u()()),t&2){let e=r.$implicit;g("title",e.name),p(),g("ngIf",e.primaryImage),p(),g("href",Qo(e.link),Gt),p(2),g("routerLink",vt(13,LN,vt(11,RN,vt(9,MN,e.productPackageID)))),p(),he(e.productPackageID),p(),Ie(" x ",e.price,"\u20BD x "),p(2),Ie("",e.quantity,"\u0448\u0442 "),p(),g("ngIf",e.quantity!=1)}}function t9(t,r){if(t&1&&(Le(0),d(1,"p-tag",52),v(2),u(),v(3," - "),d(4,"p-tag",53),v(5),u(),Ne()),t&2){let e=h().$implicit;p(),g("icon",e.clusterFrom?"":"pi pi-question-circle"),p(),Ie("",e.clusterFrom," "),p(2),g("icon",e.clusterTo?"":"pi pi-question-circle"),p(),Ie("",e.clusterTo," ")}}function r9(t,r){if(t&1&&(d(0,"p-tag",54),v(1),u()),t&2){let e=h().$implicit;p(),Ie(" ",e.clusterFrom," ")}}function i9(t,r){if(t&1&&(d(0,"div"),Y(1,"p-tag",50),v(2," x"),d(3,"b"),v(4),u(),v(5),P(6,t9,6,4,"ng-container",22)(7,r9,2,1,"p-tag",51),u()),t&2){let e=r.$implicit,n=h(4);p(),g("icon","pi "+n.orderStatusIcons.get(e.status))("pTooltip",n.orderStatuses.get(e.status))("severity",n.orderStatusSeverities.get(e.status)),p(3),he(e.count),p(),Ie(" ",e.warehouseName," "),p(),g("ngIf",e.clusterFrom!=e.clusterTo),p(),g("ngIf",e.clusterFrom==e.clusterTo)}}function n9(t,r){if(t&1&&(d(0,"tr")(1,"td",37),Y(2,"i"),u(),d(3,"td")(4,"div",38)(5,"span",39),v(6,"\u0422\u043E\u0432\u0430\u0440"),u(),d(7,"div",40),v(8),Ze(9,"date"),u(),P(10,e9,10,15,"div",41),u()(),d(11,"td")(12,"div")(13,"span",42),v(14,"\u0421\u0443\u043C\u043C\u0430"),u(),d(15,"div"),v(16),Ze(17,"number"),u()()(),d(18,"td",43)(19,"div")(20,"span",42),v(21,"\u041D\u0430\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u0435"),u(),P(22,i9,8,7,"div",44),u()()()),t&2){let e=r.$implicit,n=h(3);p(),g("pRowToggler",e),p(),_e(Si("pi ",n.getOrderTypeIcon(e.type))),p(6),he(Et(9,8,e.date,"y-MM-dd HH:mm")),p(2),g("ngForOf",e.products),p(6),Ie(" ",Et(17,11,e.sum,"1.2-2"),"\u20BD "),p(6),g("ngForOf",e.directions)}}function o9(t,r){t&1&&(d(0,"tr")(1,"th"),v(2,"\u0410\u0440\u0442\u0438\u043A\u0443\u043B"),u(),d(3,"th"),v(4,"\u0421\u0442\u0430\u0442\u0443\u0441"),u(),d(5,"th"),v(6,"\u0426\u0435\u043D\u0430"),u(),d(7,"th"),v(8,"\u041A\u043E\u043B\u0438\u0447\u0435\u0441\u0442\u0432\u043E"),u(),d(9,"th"),v(10,"\u041D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435"),u()())}function a9(t,r){if(t&1&&(d(0,"tr")(1,"td")(2,"div")(3,"span",39),v(4,"\u0410\u0440\u0442\u0438\u043A\u0443\u043B"),u(),d(5,"div"),v(6),u()()(),d(7,"td")(8,"div")(9,"span",39),v(10,"\u0426\u0435\u043D\u0430"),u(),d(11,"div"),Y(12,"p-tag",59),u()()(),d(13,"td")(14,"div")(15,"span",39),v(16,"\u0426\u0435\u043D\u0430"),u(),d(17,"div"),v(18),Ze(19,"number"),u()()(),d(20,"td")(21,"div")(22,"span",39),v(23,"\u041A\u043E\u043B\u0438\u0447\u0435\u0441\u0442\u0432\u043E"),u(),d(24,"div"),v(25),u()()(),d(26,"td")(27,"div")(28,"span",39),v(29,"\u041D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435"),u(),d(30,"div"),v(31),u()()()()),t&2){let e=r.$implicit,n=h(6);p(6),Ie(" ",e.product.productPackageID," "),p(6),g("severity",n.orderStatusSeverities.get(e.extendedStatus)??"danger")("value",n.orderStatuses.get(e.extendedStatus)??"?"),p(6),Ie(" ",Et(19,6,e.price,"1.2-2"),"\u20BD "),p(7),Ie(" ",e.quantity," "),p(6),Ie(" ",e.product.name," ")}}function s9(t,r){t&1&&(d(0,"tr")(1,"th"),v(2,"ID"),u(),d(3,"th"),v(4,"\u0414\u0430\u0442\u0430"),u(),d(5,"th"),v(6,"\u0421\u0443\u043C\u043C\u0430"),u(),d(7,"th"),v(8,"\u041A\u043E\u043C\u0438\u0441\u0441\u0438\u044F"),u(),d(9,"th"),v(10,"\u0422\u0438\u043F \u043E\u043F\u0435\u0440\u0430\u0446\u0438\u0438"),u(),d(11,"th"),v(12,"\u0422\u0438\u043F \u043D\u0430\u0447\u0438\u0441\u043B\u0435\u043D\u0438\u044F"),u()())}function l9(t,r){if(t&1&&(d(0,"tr")(1,"td")(2,"div")(3,"span",39),v(4,"ID"),u(),d(5,"div")(6,"a",57),Ze(7,"date"),v(8),u()()()(),d(9,"td")(10,"div")(11,"span",39),v(12,"\u0414\u0430\u0442\u0430"),u(),d(13,"div"),v(14),Ze(15,"date"),u()()(),d(16,"td")(17,"div")(18,"span",39),v(19,"\u0421\u0443\u043C\u043C\u0430"),u(),d(20,"div"),v(21),Ze(22,"number"),u()()(),d(23,"td")(24,"div")(25,"span",39),v(26,"\u041A\u043E\u043C\u0438\u0441\u0441\u0438\u044F"),u(),d(27,"div"),v(28),Ze(29,"number"),u()()(),d(30,"td")(31,"div")(32,"span",39),v(33,"\u0422\u0438\u043F \u043E\u043F\u0435\u0440\u0430\u0446\u0438\u0438"),u(),d(34,"div"),v(35),u()()(),d(36,"td")(37,"div")(38,"span",39),v(39,"\u0422\u0438\u043F \u043D\u0430\u0447\u0438\u0441\u043B\u0435\u043D\u0438\u044F"),u(),d(40,"div"),v(41),u()()()()),t&2){let e=r.$implicit,n=h(7);p(6),g("href",Mc("https://seller.ozon.ru/app/finances/financial-statement/",e.iD,"?date=",Et(7,9,e.date,"y-MM-dd HH:mm")),Gt),p(2),he(e.iD),p(6),Ie(" ",Et(15,12,e.date,"y-MM-dd HH:mm")," "),p(7),Ie(" ",Et(22,15,e.amount,"1.2-2"),"\u20BD "),p(7),Ie(" ",Et(29,18,e.saleCommission,"1.2-2"),"\u20BD "),p(7),Ie(" ",n.getOperationTypeText(e.operationType)," "),p(6),Ie(" ",n.getTransactionTypeText(e.accrualType)," ")}}function c9(t,r){if(t&1&&(Le(0),d(1,"tr")(2,"td",55)(3,"h5")(4,"a",57),v(5),u()()()(),d(6,"tr")(7,"td",55)(8,"p-table",58),P(9,s9,13,0,"ng-template",null,0,Z)(11,l9,42,21,"ng-template",null,1,Z),u()()(),Ne()),t&2){let e=h().$implicit;p(4),g("href",Si("https://seller.ozon.ru/app/finances/transactions-order?page=1&pageSize=50&search=",e.postingNumber),Gt),p(),Ie("\u041E\u043F\u0435\u0440\u0430\u0446\u0438\u0438 \u043F\u043E \u043E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u044E \u2116",e.postingNumber),p(3),g("breakpoint","960px")("tableStyle",Je(6,au))("value",e.operations)}}function u9(t,r){if(t&1&&(Le(0),d(1,"tr")(2,"td",56)(3,"a",57),v(4),u()()(),d(5,"tr")(6,"td",55)(7,"p-table",58),P(8,o9,11,0,"ng-template",null,0,Z)(10,a9,32,9,"ng-template",null,1,Z),u()()(),P(12,c9,13,7,"ng-container",22),Ne()),t&2){let e=r.$implicit;p(3),g("href",Si("https://seller.ozon.ru/app/postings/fbo/",e.postingNumber),Gt),p(),Ie("\u041E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u0435 \u2116",e.postingNumber),p(3),g("breakpoint","960px")("tableStyle",Je(7,au))("value",e.orderItems),p(5),g("ngIf",e.operations==null?null:e.operations.length)}}function d9(t,r){if(t&1&&(Le(0),d(1,"tr")(2,"td",55)(3,"h5"),v(4,"\u0421\u043E\u0441\u0442\u0430\u0432 \u0437\u0430\u043A\u0430\u0437\u0430"),u()()(),P(5,u9,13,8,"ng-container",44),Ne()),t&2){let e=h().$implicit;p(5),g("ngForOf",e.postings)}}function p9(t,r){t&1&&(d(0,"tr")(1,"th"),v(2,"ID"),u(),d(3,"th"),v(4,"\u0414\u0430\u0442\u0430"),u(),d(5,"th"),v(6,"\u0421\u0443\u043C\u043C\u0430"),u(),d(7,"th"),v(8,"\u041A\u043E\u043C\u0438\u0441\u0441\u0438\u044F"),u(),d(9,"th"),v(10,"\u0422\u0438\u043F \u043E\u043F\u0435\u0440\u0430\u0446\u0438\u0438"),u(),d(11,"th"),v(12,"\u0422\u0438\u043F \u043D\u0430\u0447\u0438\u0441\u043B\u0435\u043D\u0438\u044F"),u()())}function f9(t,r){if(t&1&&(d(0,"tr")(1,"td")(2,"div")(3,"span",39),v(4,"ID"),u(),d(5,"div")(6,"a",57),Ze(7,"date"),v(8),u()()()(),d(9,"td")(10,"div")(11,"span",39),v(12,"\u0414\u0430\u0442\u0430"),u(),d(13,"div"),v(14),Ze(15,"date"),u()()(),d(16,"td")(17,"div")(18,"span",39),v(19,"\u0421\u0443\u043C\u043C\u0430"),u(),d(20,"div"),v(21),Ze(22,"number"),u()()(),d(23,"td")(24,"div")(25,"span",39),v(26,"\u041A\u043E\u043C\u0438\u0441\u0441\u0438\u044F"),u(),d(27,"div"),v(28),Ze(29,"number"),u()()(),d(30,"td")(31,"div")(32,"span",39),v(33,"\u0422\u0438\u043F \u043E\u043F\u0435\u0440\u0430\u0446\u0438\u0438"),u(),d(34,"div"),v(35),u()()(),d(36,"td")(37,"div")(38,"span",39),v(39,"\u0422\u0438\u043F \u043D\u0430\u0447\u0438\u0441\u043B\u0435\u043D\u0438\u044F"),u(),d(40,"div"),v(41),u()()()()),t&2){let e=r.$implicit,n=h(5);p(6),g("href",Mc("https://seller.ozon.ru/app/finances/financial-statement/",e.iD,"?date=",Et(7,9,e.date,"y-MM-dd HH:mm")),Gt),p(2),he(e.iD),p(6),Ie(" ",Et(15,12,e.date,"y-MM-dd HH:mm")," "),p(7),Ie(" ",Et(22,15,e.amount,"1.2-2"),"\u20BD "),p(7),Ie(" ",Et(29,18,e.saleCommission,"1.2-2"),"\u20BD "),p(7),Ie(" ",n.getOperationTypeText(e.operationType)," "),p(6),Ie(" ",n.getTransactionTypeText(e.accrualType)," ")}}function m9(t,r){if(t&1&&(Le(0),d(1,"tr")(2,"td",55)(3,"h5")(4,"a",57),v(5),u()()()(),d(6,"tr")(7,"td",55)(8,"p-table",60),P(9,p9,13,0,"ng-template",null,0,Z)(11,f9,42,21,"ng-template",null,1,Z),u()()(),Ne()),t&2){let e=h().$implicit;p(4),g("href",Si("https://seller.ozon.ru/app/finances/transactions-order?page=1&pageSize=50&search=",e.ozonOrderNumber),Gt),p(),Ie("\u041E\u043F\u0435\u0440\u0430\u0446\u0438\u0438 \u043F\u043E \u0437\u0430\u043A\u0430\u0437\u0443 \u2116",e.ozonOrderNumber),p(3),g("breakpoint","960px")("tableStyle",Je(6,au))("value",e.orderOperations)}}function h9(t,r){if(t&1&&P(0,d9,6,1,"ng-container",22)(1,m9,13,7,"ng-container",22),t&2){let e=r.$implicit;g("ngIf",e.postings==null?null:e.postings.length),p(),g("ngIf",e.orderOperations==null?null:e.orderOperations.length)}}function g9(t,r){if(t&1&&(Le(0),d(1,"td"),v(2),u(),d(3,"td"),v(4),u(),d(5,"td"),v(6),u(),d(7,"td"),v(8),u(),d(9,"td"),v(10),u(),d(11,"td"),v(12),Ze(13,"number"),u(),Ne()),t&2){let e=h(5);p(2),he(e.summary.totalOrderCount),p(2),he(e.summary.totalProductCount),p(2),he(e.summary.cancelledProductCount),p(2),he(e.summary.returnedProductCount),p(2),he(e.summary.nonLocalProductCount),p(2),Ie("",Et(13,6,e.summary.totalSum,"1.2-2"),"\u20BD")}}function _9(t,r){t&1&&(d(0,"td",55),Y(1,"p-skeleton",63),u())}function x9(t,r){if(t&1&&(d(0,"tr")(1,"th",55)(2,"table",61)(3,"tr"),Y(4,"th"),d(5,"th"),v(6,"\u0417\u0430\u043A\u0430\u0437\u043E\u0432"),u(),d(7,"th"),v(8,"\u0422\u043E\u0432\u0430\u0440\u043E\u0432"),u(),d(9,"th"),v(10,"\u041E\u0442\u043C\u0435\u043D"),u(),d(11,"th"),v(12,"\u0412\u043E\u0437\u0432\u0440\u0430\u0442\u043E\u0432"),u(),d(13,"th"),v(14,"\u041D\u0435\u043B\u043E\u043A\u0430\u043B\u044C\u043D\u044B\u0445"),u(),d(15,"th"),v(16,"\u0421\u0443\u043C\u043C\u0430"),u()(),d(17,"tr")(18,"th"),v(19,"\u0421\u0442\u0440\u0430\u043D\u0438\u0446\u0430"),u(),d(20,"td"),v(21),u(),d(22,"td"),v(23),u(),d(24,"td"),v(25),u(),d(26,"td"),v(27),u(),d(28,"td"),v(29),u(),d(30,"td"),v(31),Ze(32,"number"),u()(),d(33,"tr")(34,"th"),v(35,"\u0412\u0441\u0435\u0433\u043E"),u(),P(36,g9,14,9,"ng-container",22)(37,_9,2,0,"td",62),u()()()()),t&2){let e=h(4);p(21),he(e.pageSummary.orderCount),p(2),he(e.pageSummary.productCount),p(2),he(e.pageSummary.canceledProductCount),p(2),he(e.pageSummary.returnedProductCount),p(2),he(e.pageSummary.nonLocalProductCount),p(2),Ie("",Et(32,8,e.pageSummary.orderSum,"1.2-2"),"\u20BD"),p(5),g("ngIf",e.summary),p(),g("ngIf",e.summary)}}function v9(t,r){if(t&1&&P(0,x9,38,11,"tr",22),t&2){let e=h(3);g("ngIf",e.pageSummary)}}function b9(t,r){if(t&1){let e=pe();d(0,"p-table",24),ee("onFilter",function(i){O(e);let o=h(2);return B(o.onFilter(i))})("onLazyLoad",function(i){O(e);let o=h(2);return B(o.onDataLazyLoad(i))})("onSort",function(i){O(e);let o=h(2);return B(o.onFilter(i))}),P(1,QN,40,25,"ng-template",null,0,Z)(3,n9,23,14,"ng-template",null,1,Z)(5,h9,2,2,"ng-template",null,2,Z)(7,v9,1,1,"ng-template",null,3,Z),u()}if(t&2){let e=h(2);g("lazy",!0)("loading",e.loading)("loading",e.loading)("paginator",!0)("rowsPerPageOptions",Je(11,ON))("rows",e.filterModel.count)("showCurrentPageReport",!1)("sortOrder",-1)("tableStyle",Je(12,BN))("totalRecords",e.summary.totalFilteredOrderCount)("value",e.data)}}function y9(t,r){if(t&1&&(d(0,"div",15)(1,"div",16)(2,"div",17)(3,"div",18)(4,"div",19)(5,"div",20),v(6,"\u0417\u0430\u043A\u0430\u0437\u044B"),u(),d(7,"div")(8,"div",21)(9,"span"),v(10,"\u0417\u0430\u043A\u0430\u0437\u043E\u0432"),u(),d(11,"span"),v(12),u()()(),d(13,"div",21)(14,"span"),v(15,"\u0422\u043E\u0432\u0430\u0440\u043E\u0432"),u(),d(16,"span"),v(17),u()(),d(18,"div")(19,"div",21)(20,"span"),v(21,"\u041A \u0432\u044B\u043F\u043B\u0430\u0442\u0435"),u(),P(22,zN,3,4,"span",22)(23,UN,2,0,"span",22),u()(),d(24,"div")(25,"div",21)(26,"span"),v(27,"\u0421\u0443\u043C\u043C\u0430 \u043F\u0440\u043E\u0434\u0430\u0436"),u(),d(28,"span"),v(29),Ze(30,"number"),u()()()()()(),d(31,"div",17)(32,"div",18)(33,"div",19)(34,"div",20),v(35,"\u0412\u043E\u0437\u0432\u0440\u0430\u0442\u044B"),u(),d(36,"div",21)(37,"span"),v(38,"\u0422\u043E\u0432\u0430\u0440\u043E\u0432 \u043E\u0442\u043C\u0435\u043D\u0435\u043D\u043E"),u(),d(39,"span"),v(40),u()(),d(41,"div",21)(42,"span"),v(43,"\u0422\u043E\u0432\u0430\u0440\u043E\u0432 \u0432\u043E\u0437\u0432\u0440\u0430\u0449\u0435\u043D\u043E"),u(),d(44,"span"),v(45),u()(),d(46,"div",21)(47,"span"),v(48,"\u0421\u0443\u043C\u043C\u0430"),u(),d(49,"span"),v(50),Ze(51,"number"),u()(),d(52,"div",21)(53,"span"),v(54,"% \u0432\u043E\u0437\u0432\u0440\u0430\u0442\u043E\u0432"),u(),d(55,"span"),v(56),Ze(57,"number"),u()()()()(),d(58,"div",17)(59,"div",18)(60,"div",19)(61,"div",20),v(62,"\u0412\u044B\u043F\u043E\u043B\u043D\u0435\u043D\u043D\u044B\u0435 \u0437\u0430\u043A\u0430\u0437\u044B"),u(),d(63,"div")(64,"div",21)(65,"span"),v(66,"\u0417\u0430\u043A\u0430\u0437\u043E\u0432"),u(),d(67,"span"),v(68),u()()(),d(69,"div",21)(70,"span"),v(71,"\u0422\u043E\u0432\u0430\u0440\u043E\u0432"),u(),d(72,"span"),v(73),u()(),d(74,"div")(75,"div",21)(76,"span"),v(77,"\u041A \u0432\u044B\u043F\u043B\u0430\u0442\u0435"),u(),d(78,"span"),v(79),Ze(80,"number"),u()()(),d(81,"div")(82,"div",21)(83,"span"),v(84,"\u0421\u0443\u043C\u043C\u0430 \u043F\u0440\u043E\u0434\u0430\u0436"),u(),d(85,"span"),v(86),Ze(87,"number"),u()()()()()()(),P(88,b9,9,13,"p-table",23),u()),t&2){let e=h();p(12),he(e.summary.totalOrderCount),p(5),he(e.summary.totalProductCount),p(5),g("ngIf",e.summary.expectedPayout),p(),g("ngIf",!e.summary.expectedPayout),p(6),Ie("",Et(30,14,e.summary.totalSalesSum,"1.2-2"),"\u20BD"),p(11),he(e.summary.cancelledProductCount),p(5),he(e.summary.returnedProductCount),p(5),Ie("",Et(51,17,e.summary.returnSum,"1.2-2"),"\u20BD"),p(6),Ie("",Et(57,20,e.summary.returnProductCountPercentage*100,"1.1-1"),"%"),p(12),he(e.summary.finalizedOrderCount),p(5),he(e.summary.finalizedProductCount),p(6),Ie("",Et(80,23,e.summary.finalizedSum,"1.2-2"),"\u20BD"),p(7),Ie("",Et(87,26,e.summary.finalizedSalesSum,"1.2-2"),"\u20BD"),p(2),g("ngIf",e.data)}}var $o=(function(t){return t[t.Returned=-1]="Returned",t})($o||{}),g1=(()=>{let r=class r extends ei{constructor(n,i,o,a,l,c,f,m){super(m),this.ozonSalesOrderClient=n,this.ozonPostingCommandClient=i,this.ozonOperationCommandClient=o,this.messageService=a,this.warehouseClient=l,this.ozonProductClient=c,this.dbService=f,this.dateRangeTypes=dn,this.loading=!1,this.products=new Map,this.warehouses=new Map,this.warehouseClusters=new Map,this.isLoading=!1,this.findOrdersSubject=new ur(null),this.knownProducts=new Map,this.knownWarehouses=new Map,this.knownWarehouseClusters=new Map,this.filterModel={dateRangeType:dn.ThisDay,offset:0,gatherSummary:!0,count:50},this.dateRangeOptions=[{name:"\u0421\u0435\u0433\u043E\u0434\u043D\u044F",value:dn.ThisDay},{name:"\u0412\u0447\u0435\u0440\u0430",value:dn.PreviousDay},{name:"\u0421\u0443\u0442\u043A\u0438",value:dn.Day},{name:"\u042D\u0442\u0430 \u043D\u0435\u0434\u0435\u043B\u044F",value:dn.ThisWeek},{name:"\u041F\u0440\u0435\u0434\u044B\u0434\u0443\u0449\u0430\u044F \u043D\u0435\u0434\u0435\u043B\u044F",value:dn.PreviousWeek},{name:"\u041F\u043E\u0441\u043B\u0435\u0434\u043D\u044F\u044F \u043D\u0435\u0434\u0435\u043B\u044F",value:dn.Week},{name:"\u042D\u0442\u043E\u0442 \u043C\u0435\u0441\u044F\u0446",value:dn.ThisMonth},{name:"\u041F\u0440\u0435\u0434\u044B\u0434\u0443\u0449\u0438\u0439 \u043C\u0435\u0441\u044F\u0446",value:dn.PreviousMonth},{name:"\u041F\u043E\u0441\u043B\u0435\u0434\u043D\u0438\u0439 \u043C\u0435\u0441\u044F\u0446",value:dn.Month},{name:"\u0417\u0430 \u043F\u0435\u0440\u0438\u043E\u0434",value:dn.Custom}],this.orderStatuses=new Map([[$o.Returned,"\u0412\u043E\u0437\u0432\u0440\u0430\u0442"],[fe.PostingStatus.AwaitingPackaging,"\u041E\u0436\u0438\u0434\u0430\u0435\u0442 \u0443\u043F\u0430\u043A\u043E\u0432\u043A\u0438"],[fe.PostingStatus.AwaitingDeliver,"\u041E\u0436\u0438\u0434\u0430\u0435\u0442 \u0434\u043E\u0441\u0442\u0430\u0432\u043A\u0438"],[fe.PostingStatus.Delivering,"\u0414\u043E\u0441\u0442\u0430\u0432\u043B\u044F\u0435\u0442\u0441\u044F"],[fe.PostingStatus.Delivered,"\u0414\u043E\u0441\u0442\u0430\u0432\u043B\u0435\u043D"],[fe.PostingStatus.Cancelled,"\u041E\u0442\u043C\u0435\u043D\u0451\u043D"],[fe.PostingStatus.AwaitingRegistration,"\u041E\u0436\u0438\u0434\u0430\u0435\u0442 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438"],[fe.PostingStatus.AcceptanceInProgress,"\u0418\u0434\u0451\u0442 \u043F\u0440\u0438\u0451\u043C\u043A\u0430"],[fe.PostingStatus.AwaitingApprove,"\u041E\u0436\u0438\u0434\u0430\u0435\u0442 \u043F\u043E\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043D\u0438\u044F"],[fe.PostingStatus.Arbitration,"\u0410\u0440\u0431\u0438\u0442\u0440\u0430\u0436"],[fe.PostingStatus.ClientArbitration,"\u041A\u043B\u0438\u0435\u043D\u0442\u0441\u043A\u0438\u0439 \u0430\u0440\u0431\u0438\u0442\u0440\u0430\u0436 \u0434\u043E\u0441\u0442\u0430\u0432\u043A\u0438"],[fe.PostingStatus.DriverPickup,"\u0423 \u0432\u043E\u0434\u0438\u0442\u0435\u043B\u044F"],[fe.PostingStatus.NotAccepted,"\u041D\u0435 \u043F\u0440\u0438\u043D\u044F\u0442\u043E"],[fe.PostingStatus.SentBySeller,"\u041E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u043E \u043F\u043E\u0441\u0442\u0430\u0432\u0449\u0438\u043A\u043E\u043C"]]),this.orderStatusSeverities=new Map([[$o.Returned,"danger"],[fe.PostingStatus.AwaitingDeliver,"warning"],[fe.PostingStatus.Cancelled,"contrast"],[fe.PostingStatus.AwaitingPackaging,"warning"],[fe.PostingStatus.Delivering,"info"],[fe.PostingStatus.Delivered,"success"]]),this.orderStatusIcons=new Map([[$o.Returned,"pi-ban"],[fe.PostingStatus.AwaitingDeliver,"pi-car"],[fe.PostingStatus.Cancelled,"pi-replay"],[fe.PostingStatus.AwaitingPackaging,"pi-box"],[fe.PostingStatus.Delivering,"pi-car"],[fe.PostingStatus.Delivered,"pi-dollar"],[fe.PostingStatus.Delivered,"pi-dollar"]]),this.localizationFilter=null,this.nonLocalOnly=!1}static getPageSummary(n){let i=0,o=0,a=0,l=0,c=0,f=n.length;for(let m of n)i+=m.sum,m.orderItems.forEach(C=>{C.extendedStatus==fe.PostingStatus.Cancelled?a+=C.quantity:C.extendedStatus==$o.Returned?(l+=C.quantity,c+=C.clusterTo!==C.clusterFrom?C.quantity:0):(o+=C.quantity,c+=C.clusterTo!==C.clusterFrom?C.quantity:0)});return{canceledProductCount:a,orderCount:f,orderSum:i,productCount:o,returnedProductCount:l,nonLocalProductCount:c}}mapOrder(n){let i=new Map,o=new Set,a=new Set,l=new Map,c=new Map,f=[],m={cancelledProductCount:0,directions:[],hasNonCancelledOrderItems:!1,hasNonFinalizedOrderItems:!1,hasNonLocalOrderItems:!1,nonLocalProductCount:0,orderItems:n.orderItems,orderOperations:f,orderWarehouses:[],postings:[],productCount:0,productIDs:[],products:[],returnSum:0,returnedProductCount:0,salesSum:0,statuses:[],sum:0},C=new Map;for(let S of n.operations)if(m.sum+=S.amount,S.postingNumber==n.ozonOrderNumber)f.push(S);else{if((S.operationType==fe.OperationType.ReturnAgentOperationRFBS||S.operationType==fe.OperationType.OperationReturnGoodsFBSofRMS||S.operationType==fe.OperationType.MarketplaceSellerReexposureDeliveryReturnOperation||S.operationType==fe.OperationType.ClientReturnAgentOperation||S.operationType==fe.OperationType.OperationItemReturn||S.operationType==fe.OperationType.MarketplaceServiceItemReturnFlowLogistic||S.operationType==fe.OperationType.MarketplaceReturnStorageServiceAtThePickupPointFbsItem)&&o.add(S.postingNumber),i.has(S.postingNumber))i.get(S.postingNumber).operations.push(S);else{let M={postingNumber:S.postingNumber,orderItems:[],operations:[S]};m.postings.push(M),i.set(S.postingNumber,M)}l.set(S.postingNumber,(l.get(S.postingNumber)??0)+S.amount)}let y=new Set;for(let S of n.orderItems){let M=l.get(S.postingNumber)??0,E=o.has(S.postingNumber)?$o.Returned:S.status;S.clusterFromID&&S.clusterFrom&&this.knownWarehouseClusters.set(S.clusterFromID,S.clusterFrom),S.ozonWarehouseID&&S.ozonWarehouse&&this.knownWarehouses.set(S.ozonWarehouseID,S.ozonWarehouse.name),S.clusterToID&&S.clusterTo&&this.knownWarehouseClusters.set(S.clusterToID,S.clusterTo),S.clusterFrom!==S.clusterTo&&S.status!=fe.PostingStatus.Cancelled&&(m.nonLocalProductCount+=S.quantity,m.hasNonLocalOrderItems=!0),y.add(E);let A=`${S.clusterFrom}#${S.clusterTo}#${S.ozonWarehouseID}#${E}`;if(C.has(A))C.get(A).count+=S.quantity;else{let F=S.ozonWarehouse?.name??"-";a.has(F)||(m.orderWarehouses.push(F),a.add(F));let L={clusterFrom:S.clusterFrom,clusterTo:S.clusterTo,count:S.quantity,status:E,warehouseName:F};m.directions.push(L),C.set(A,L)}if(i.has(S.postingNumber))i.get(S.postingNumber).orderItems.push(S);else{let F={postingNumber:S.postingNumber,orderItems:[S],operations:[]};i.set(S.postingNumber,F),m.postings.push(F)}if(c.has(S.product.productPackageID))c.get(S.product.productPackageID).quantity+=S.quantity;else{let F={link:"https://www.ozon.ru/product/"+S.product.sku,name:S.product.name,price:S.price,primaryImage:S.product.primaryImage,productPackageID:S.product.productPackageID,quantity:S.quantity};c.set(S.product.productPackageID,F),m.productIDs.push(S.product.productPackageID.toString()),m.products.push(F)}E==$o.Returned?(m.returnedProductCount+=S.quantity,m.returnSum+=M):E==fe.PostingStatus.Cancelled?m.cancelledProductCount+=S.quantity:(m.productCount+=S.quantity,m.hasNonCancelledOrderItems=!0,m.salesSum+=S.quantity*S.price,E!=fe.PostingStatus.Delivered&&(m.hasNonFinalizedOrderItems=!0)),Object.assign(S,{extendedStatus:E})}return y.forEach(S=>{m.statuses.push(S)}),Object.assign(n,m)}ngOnInit(){this.titleService.setTitle("\u0417\u0430\u043A\u0430\u0437\u044B Ozon"),this.findOrdersSubject.pipe(Yr(this.destroyed)).pipe(wr(n=>!!n)).subscribe(n=>{this.localizationFilter=null;let i=Object.assign({},n,{offset:0,productPackageIDs:[],warehouseIDs:[],warehouseClusterIDs:[],statuses:[],nonLocalOnly:!1,dateRangeType:this.dateRangeType});this.dbService.update("filters",{id:r.FilterID,data:i}).pipe(ge(o=>(this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430 \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u044F \u0444\u0438\u043B\u044C\u0442\u0440\u0430",severity:"error",detail:o}),it))).subscribe(()=>{this.findOrders(n)})}),this.dbService.getByID("filters",r.FilterID).subscribe(n=>{n&&n.data&&(this.filterModel=n.data,this.dateRangeType=n.data.dateRangeType),this.changeReportDate()})}changeReportDate(){this.findOrdersSubject.next(this.filterModel)}getSummary(n){let i=n.finalizedProductCount&&n.returnedProductCount?n.returnedProductCount/n.finalizedProductCount:0,o=n.finalizedSum*n.totalSalesSum/n.finalizedSalesSum;return{cancelledProductCount:n.cancelledProductCount,expectedPayout:o,finalizedOrderCount:n.finalizedOrderCount,finalizedProductCount:n.finalizedProductCount,finalizedSalesSum:n.finalizedSalesSum,finalizedSum:n.finalizedSum,nonLocalProductCount:n.nonLocalProductCount,returnProductCountPercentage:i,returnSum:n.returnSum,returnedProductCount:n.returnedProductCount,totalFilteredOrderCount:n.totalFilteredOrderCount,totalOrderCount:n.totalOrderCount,totalProductCount:n.totalProductCount,totalSalesSum:n.totalSalesSum,totalSum:n.amount}}getOrderTypeIcon(n){switch(n){case fe.OzonSalesOrderType.Fbo:return"ozon-fbo";case fe.OzonSalesOrderType.Fbs:return"ozon-fbs";default:return"pi-question"}}importOrders(){return ln(this,null,function*(){let[n,i]=Hc.getDateRange(this.dateRangeType,this.dateRange);i?.setDate(i.getDate()+1);let o=ge(a=>(this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430 \u0438\u043C\u043F\u043E\u0440\u0442\u0430 \u0442\u043E\u0432\u0430\u0440\u043E\u0432",severity:"error",detail:a}),this.loading=!1,it));this.ozonPostingCommandClient.importOzonFboPostings(n,i).pipe(o).subscribe(()=>{this.ozonOperationCommandClient.importOzonOperations(n,i).pipe(o).subscribe(()=>{this.findOrdersSubject.next(this.filterModel)})})})}findOrders(n){let[i,o]=Hc.getDateRange(this.dateRangeType,this.dateRange);o?.setDate(o.getDate()+1),n.gatherSummary=!n.offset,n.dateFrom=i,n.dateTo=o;let a=new fe.FindOzonSalesOrdersModel(n);this.loading=!0,this.pageSummary=void 0,this.ozonSalesOrderClient.findSalesOzonOrders(a).pipe(ge(l=>(this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u043E\u043B\u0443\u0447\u0435\u043D\u0438\u044F \u0437\u0430\u043A\u0430\u0437\u043E\u0432",severity:"error",detail:l}),this.loading=!1,it))).subscribe(l=>{this.loading=!1;let c=0;this.data=l?.items.map(f=>{let m=this.mapOrder(f);return m.orderItems.forEach(y=>{y.extendedStatus==fe.PostingStatus.Cancelled||y.extendedStatus==$o.Returned||(c+=y.quantity),this.knownProducts.set(y.product.productPackageID,y.product)}),m}),this.filterModel.gatherSummary&&(this.updateProducts(l.iDs),this.updateWarehouses(l.warehouseIDs),this.updateWarehouseClusters(l.warehouseClusterIDs),this.summary=this.getSummary(l)),this.pageSummary=r.getPageSummary(this.data)})}getTransactionTypeText(n){return fe.TransactionType[n]}getOperationTypeText(n){return fe.OperationType[n]}onFilter(n){console.log(n)}updateSelectedProductPackageIDs(){let n=this.selectedProductPackageIDs?.map(i=>+i).sort((i,o)=>i-o)??[];(n.length!=this.filterModel.productPackageIDs?.length||!n.every((i,o)=>i==this.filterModel.productPackageIDs[o]))&&(this.filterModel.productPackageIDs=n,this.findOrdersSubject.next(this.filterModel))}updateLocalizationFilter(){this.filterModel.nonLocalOnly!=this.nonLocalOnly&&(this.filterModel.nonLocalOnly=this.nonLocalOnly,this.findOrdersSubject.next(this.filterModel))}updateSelectedWarehouseIDs(){let n=this.selectedWarehouseIDs?.length??0,i=this.filterModel.warehouseIDs?.length??0,o=this.selectedWarehouseIDs?.map(a=>+a).sort((a,l)=>a-l)??[];(n!=i||!o.every((a,l)=>a==this.filterModel.warehouseIDs[l]))&&(this.filterModel.warehouseIDs=o,this.findOrdersSubject.next(this.filterModel))}updateSelectedWarehouseClusterIDs(){let n=this.selectedWarehouseClusterIDs?.length??0,i=this.filterModel.warehouseClusterIDs?.length??0,o=this.selectedWarehouseClusterIDs?.map(a=>+a).sort((a,l)=>a-l)??[];(n!=i||!o.every((a,l)=>a==this.filterModel.warehouseClusterIDs[l]))&&(this.filterModel.warehouseClusterIDs=o,this.findOrdersSubject.next(this.filterModel))}updateSelectedStatuses(){let n=this.selectedStatuses?.length??0,i=this.filterModel.statuses?.length??0,o=this.selectedStatuses?.map(a=>+a).sort((a,l)=>a-l)??[];(n!=i||!o?.every((a,l)=>a==this.filterModel.statuses[l]))&&(this.filterModel.statuses=o,this.findOrdersSubject.next(this.filterModel))}onDataLazyLoad(n){(this.filterModel.offset!=n.first||this.filterModel.count!=n.rows)&&(this.filterModel.offset=n.first,this.filterModel.count=n.rows,this.findOrdersSubject.next(this.filterModel))}updateWarehouses(n){if(this.warehouses.clear(),n&&n.length){let i=[];for(let o of n)this.knownWarehouses.has(o)?this.warehouses.set(o,this.knownWarehouses.get(o)):(this.warehouses.set(o,void 0),i.push(o));i.length&&this.warehouseClient.getOzonWarehouses(new fe.FindOzonWarehousesModel({includeAliases:!1,iDs:i})).pipe(ge(o=>(this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0438 \u0438\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u0438 \u043E \u0441\u043A\u043B\u0430\u0434\u0430\u0445",severity:"error",detail:o}),it))).subscribe(o=>{for(let a of o)this.knownWarehouses.set(a.iD,a.name),this.warehouses.has(a.iD)&&this.warehouses.set(a.iD,a.name)})}}updateWarehouseClusters(n){if(this.warehouseClusters.clear(),n&&n.length){let i=[];for(let o of n)this.knownWarehouseClusters.has(o)?this.warehouseClusters.set(o,this.knownWarehouseClusters.get(o)):(this.warehouseClusters.set(o,void 0),i.push(o));i.length&&this.warehouseClient.getOzonWarehouseClusters(new fe.FindOzonWarehouseClustersModel({includeAliases:!1,includeWarehouses:!1,iDs:i})).pipe(ge(o=>(this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0438 \u0438\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u0438 \u043E \u043A\u043B\u0430\u0441\u0442\u0435\u0440\u0430\u0445",severity:"error",detail:o}),it))).subscribe(o=>{for(let a of o)this.knownWarehouseClusters.set(a.iD,a.name),this.warehouseClusters.has(a.iD)&&this.warehouseClusters.set(a.iD,a.name)})}}updateProducts(n){if(this.products.clear(),n&&n.length){let i=[];for(let o of n)this.knownProducts.has(o)?this.products.set(o,this.knownProducts.get(o)):(this.products.set(o,void 0),i.push(o));i.length&&this.ozonProductClient.findOzonProducts(new fe.FindOzonProductsModel({iDs:i,count:-1,offset:0,includeStocks:!1})).pipe(ge(o=>(this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0438 \u0438\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u0438 \u043E \u0442\u043E\u0432\u0430\u0440\u0430\u0445",severity:"error",detail:o}),it))).subscribe(o=>{for(let a of o.items)this.knownProducts.set(a.productPackageID,a),this.products.has(a.productPackageID)&&this.products.set(a.productPackageID,a)})}}};r.FilterID="OzonSalesOrderListComponent",r.\u0275fac=function(i){return new(i||r)(Pe(fe.OzonSalesOrderClient),Pe(er.PostingClient),Pe(er.OperationClient),Pe(Yt),Pe(fe.WarehouseClient),Pe(fe.OzonProductClient),Pe(Sn),Pe(Zr))},r.\u0275cmp=He({type:r,selectors:[["app-ozon-sales-order-list"]],features:[lt],decls:8,vars:7,consts:[["header",""],["body",""],["expandedrow",""],["footer",""],["item",""],["header","\u0417\u0430\u043A\u0430\u0437\u044B Ozon"],[1,"justify-center"],["icon","pi pi-search","optionLabel","name","optionValue","value",3,"onOptionClick","ngModelChange","ngModel","allowEmpty","disabled","options"],["class","justify-center mb-1",4,"ngIf"],["label","\u0418\u043C\u043F\u043E\u0440\u0442 \u043E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u0439","styleClass","m-4",3,"icon","click",4,"ngIf"],["class","card",4,"ngIf"],[1,"justify-center","mb-1"],["placeholder","\u041F\u0435\u0440\u0438\u043E\u0434","selectionMode","range",3,"ngModelChange","ngModel","readonlyInput","selectOtherMonths","showClear"],["icon","pi pi-search","label","\u041D\u0430\u0439\u0442\u0438 \u043E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u044F",3,"click"],["label","\u0418\u043C\u043F\u043E\u0440\u0442 \u043E\u0442\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u0439","styleClass","m-4",3,"click","icon"],[1,"card"],[1,"grid","grid-cols-12","gap-4"],[1,"col-span-12","md:col-span-4"],[1,"card","text-right"],[1,"text-surface-900","dark:text-surface-0","font-medium","text-xl","mb-4"],[1,"text-surface-500","dark:text-surface-300","text-center"],[1,"flex","justify-between"],[4,"ngIf"],["dataKey","iD","responsiveLayout","stack","sortField","date",3,"lazy","loading","paginator","rowsPerPageOptions","rows","showCurrentPageReport","sortOrder","tableStyle","totalRecords","value","onFilter","onLazyLoad","onSort",4,"ngIf"],["dataKey","iD","responsiveLayout","stack","sortField","date",3,"onFilter","onLazyLoad","onSort","lazy","loading","paginator","rowsPerPageOptions","rows","showCurrentPageReport","sortOrder","tableStyle","totalRecords","value"],["width","1%"],["pSortableColumn","date","width","1%"],["field","date"],["appendTo","body","filterBy","key","maxSelectedLabels","3","optionLabel","key","optionValue","key","placeholder","\u041B\u044E\u0431\u043E\u0439 \u0430\u0440\u0442\u0438\u043A\u0443\u043B",3,"onClear","onPanelHide","ngModelChange","ngModel","options","resetFilterOnHide","showClear"],["appendTo","body","optionLabel","value","optionValue","key","placeholder","\u041B\u044E\u0431\u043E\u0439",3,"onClear","onPanelHide","ngModelChange","ngModel","options","resetFilterOnHide","showClear"],["appendTo","body","filterBy","value","maxSelectedLabels","3","optionLabel","value","optionValue","key","placeholder","\u041B\u044E\u0431\u043E\u0439 \u0441\u043A\u043B\u0430\u0434",3,"onClear","onPanelHide","ngModelChange","ngModel","options","resetFilterOnHide","showClear"],["appendTo","body","filterBy","value","maxSelectedLabels","3","optionLabel","value","optionValue","key","placeholder","\u041B\u044E\u0431\u043E\u0439 \u043A\u043B\u0430\u0441\u0442\u0435\u0440",3,"onClear","onPanelHide","ngModelChange","ngModel","options","resetFilterOnHide","showClear"],["inputId","localFilter","offLabel","\u041B\u044E\u0431\u044B\u0435","onLabel","\u041D\u0435\u043B\u043E\u043A\u0430\u043B\u044C\u043D\u044B\u0435",1,"p-button-sm",3,"onChange","ngModelChange","ngModel"],[1,"flex","items-center","gap-2"],[2,"width","3rem",3,"src"],["height","3rem","width","3rem"],["height","3rem","width","6rem"],[3,"pRowToggler"],[1,"whitespace-nowrap"],[1,"p-column-title","font-bold"],[1,"mb-2"],[3,"title",4,"ngFor","ngForOf"],[1,"p-column-title"],["colspan","5"],[4,"ngFor","ngForOf"],[3,"title"],["target","_blank",1,"mr-1",3,"href"],[1,"pi","ozon-fbo","align-middle"],["target","_blank",3,"routerLink"],["width","50",3,"src"],[3,"icon","pTooltip","severity"],["severity","success",4,"ngIf"],["severity","info",3,"icon"],["severity","danger",3,"icon"],["severity","success"],["colspan","8"],["colspan","8",1,"text-left","justify-start"],["rel","noreferrer","target","_blank",3,"href"],["responsiveLayout","stack",3,"breakpoint","tableStyle","value"],[3,"severity","value"],["dataKey","iD","responsiveLayout","stack",3,"breakpoint","tableStyle","value"],[1,"text-right","p-1"],["colspan","8",4,"ngIf"],["height","2rem"]],template:function(i,o){i&1&&(Y(0,"p-toast")(1,"p-scrollTop"),d(2,"p-card",5)(3,"div",6)(4,"p-selectButton",7),ee("onOptionClick",function(){return o.changeReportDate()}),Fe("ngModelChange",function(l){return ke(o.dateRangeType,l)||(o.dateRangeType=l),l}),u()(),P(5,NN,3,4,"div",8)(6,VN,1,1,"p-button",9),u(),P(7,y9,89,29,"div",10)),i&2&&(p(4),Se("ngModel",o.dateRangeType),g("allowEmpty",!1)("disabled",o.loading)("options",o.dateRangeOptions),p(),g("ngIf",o.dateRangeType==o.dateRangeTypes.Custom),p(),g("ngIf",o.dateRangeType!==void 0),p(),g("ngIf",o.summary))},dependencies:[nr,Ht,Yn,Qn,et,Mr,bt,qn,Jn,jr,Ur,Wr,bc,Us,sd,ad,hl,ml,os,Ho,Kr,Gr,Zi,Fi,en,Oo,Do,vr,xr,od,nd,Io,yn,Ks],styles:["@media (min-width: 961px){.p-column-title[_ngcontent-%COMP%]{display:none}}@media (max-width: 960px){.p-column-title[_ngcontent-%COMP%]{display:block}.p-datatable-tbody[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > td[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:block}}"]});let t=r;return t})();var Ar;(function(t){t.SEARCH_TERM_DATA_SERVICE_URL=new wt("SEARCH_TERM_DATA_SERVICE_URL");let r=(()=>{let x=class x{constructor(L,K){this.jsonParseReviver=void 0,this.http=L,this.baseUrl=K??""}importCategoryTree(){let L=this.baseUrl+"/v1/CategoryTree/ImportCategoryTree";L=L.replace(/[?&]$/,"");let K={observe:"response",responseType:"blob",headers:new ct({})};return this.http.request("post",L,K).pipe(ne(te=>this.processImportCategoryTree(te))).pipe(ge(te=>{if(te instanceof ut)try{return this.processImportCategoryTree(te)}catch(V){return xe(V)}else return xe(te)}))}processImportCategoryTree(L){let K=L.status,te=L instanceof dt?L.body:L.error instanceof Blob?L.error:void 0,V={};if(L.headers)for(let R of L.headers.keys())V[R]=L.headers.get(R);return K===200?E(te).pipe(ne(R=>be(null))):K!==200&&K!==204?E(te).pipe(ne(R=>M("An unexpected server error occurred.",K,R,V))):be(null)}setCategoryAnalyzability(L,K){let te=this.baseUrl+"/v1/CategoryTree/SetCategoryAnalyzability?";if(L===null)throw new globalThis.Error("The parameter 'id' cannot be null.");if(L!==void 0&&(te+="id="+encodeURIComponent(""+L)+"&"),K==null)throw new globalThis.Error("The parameter 'analyzable' must be defined and cannot be null.");te+="analyzable="+encodeURIComponent(""+K)+"&",te=te.replace(/[?&]$/,"");let V={observe:"response",responseType:"blob",headers:new ct({})};return this.http.request("post",te,V).pipe(ne(R=>this.processSetCategoryAnalyzability(R))).pipe(ge(R=>{if(R instanceof ut)try{return this.processSetCategoryAnalyzability(R)}catch(q){return xe(q)}else return xe(R)}))}processSetCategoryAnalyzability(L){let K=L.status,te=L instanceof dt?L.body:L.error instanceof Blob?L.error:void 0,V={};if(L.headers)for(let R of L.headers.keys())V[R]=L.headers.get(R);return K===200?E(te).pipe(ne(R=>be(null))):K!==200&&K!==204?E(te).pipe(ne(R=>M("An unexpected server error occurred.",K,R,V))):be(null)}setProductTypeAnalyzability(L,K){let te=this.baseUrl+"/v1/CategoryTree/SetProductTypeAnalyzability?";if(L===null)throw new globalThis.Error("The parameter 'id' cannot be null.");if(L!==void 0&&(te+="id="+encodeURIComponent(""+L)+"&"),K==null)throw new globalThis.Error("The parameter 'analyzable' must be defined and cannot be null.");te+="analyzable="+encodeURIComponent(""+K)+"&",te=te.replace(/[?&]$/,"");let V={observe:"response",responseType:"blob",headers:new ct({})};return this.http.request("post",te,V).pipe(ne(R=>this.processSetProductTypeAnalyzability(R))).pipe(ge(R=>{if(R instanceof ut)try{return this.processSetProductTypeAnalyzability(R)}catch(q){return xe(q)}else return xe(R)}))}processSetProductTypeAnalyzability(L){let K=L.status,te=L instanceof dt?L.body:L.error instanceof Blob?L.error:void 0,V={};if(L.headers)for(let R of L.headers.keys())V[R]=L.headers.get(R);return K===200?E(te).pipe(ne(R=>be(null))):K!==200&&K!==204?E(te).pipe(ne(R=>M("An unexpected server error occurred.",K,R,V))):be(null)}getCategories(L){let K=this.baseUrl+"/v1/CategoryTree/GetCategories?";L!=null&&(K+="id="+encodeURIComponent(""+L)+"&"),K=K.replace(/[?&]$/,"");let te={observe:"response",responseType:"blob",headers:new ct({Accept:"application/json"})};return this.http.request("get",K,te).pipe(ne(V=>this.processGetCategories(V))).pipe(ge(V=>{if(V instanceof ut)try{return this.processGetCategories(V)}catch(R){return xe(R)}else return xe(V)}))}processGetCategories(L){let K=L.status,te=L instanceof dt?L.body:L.error instanceof Blob?L.error:void 0,V={};if(L.headers)for(let R of L.headers.keys())V[R]=L.headers.get(R);return K===200?E(te).pipe(ne(R=>{let q=null,ie=R===""?null:JSON.parse(R,this.jsonParseReviver);if(Array.isArray(ie)){q=[];for(let de of ie)q.push(y.fromJS(de))}else q=null;return be(q)})):K!==200&&K!==204?E(te).pipe(ne(R=>M("An unexpected server error occurred.",K,R,V))):be(null)}filterCategories(L){let K=this.baseUrl+"/v1/CategoryTree/FilterCategories";K=K.replace(/[?&]$/,"");let V={body:JSON.stringify(L),observe:"response",responseType:"blob",headers:new ct({"Content-Type":"application/json",Accept:"application/json"})};return this.http.request("post",K,V).pipe(ne(R=>this.processFilterCategories(R))).pipe(ge(R=>{if(R instanceof ut)try{return this.processFilterCategories(R)}catch(q){return xe(q)}else return xe(R)}))}processFilterCategories(L){let K=L.status,te=L instanceof dt?L.body:L.error instanceof Blob?L.error:void 0,V={};if(L.headers)for(let R of L.headers.keys())V[R]=L.headers.get(R);return K===200?E(te).pipe(ne(R=>{let q=null,ie=R===""?null:JSON.parse(R,this.jsonParseReviver);if(Array.isArray(ie)){q=[];for(let de of ie)q.push(y.fromJS(de))}else q=null;return be(q)})):K!==200&&K!==204?E(te).pipe(ne(R=>M("An unexpected server error occurred.",K,R,V))):be(null)}enqueueForUpdate(L){let K=this.baseUrl+"/v1/SearchTerm/EnqueueForUpdate?";L!=null&&(K+="count="+encodeURIComponent(""+L)+"&"),K=K.replace(/[?&]$/,"");let te={observe:"response",responseType:"blob",headers:new ct({})};return this.http.request("post",K,te).pipe(ne(V=>this.processEnqueueForUpdate(V))).pipe(ge(V=>{if(V instanceof ut)try{return this.processEnqueueForUpdate(V)}catch(R){return xe(R)}else return xe(V)}))}processEnqueueForUpdate(L){let K=L.status,te=L instanceof dt?L.body:L.error instanceof Blob?L.error:void 0,V={};if(L.headers)for(let R of L.headers.keys())V[R]=L.headers.get(R);return K===200?E(te).pipe(ne(R=>be(null))):K!==200&&K!==204?E(te).pipe(ne(R=>M("An unexpected server error occurred.",K,R,V))):be(null)}getProductTypes(L){let K=this.baseUrl+"/v1/CategoryTree/GetProductTypes?";if(L===null)throw new globalThis.Error("The parameter 'minDaysFromUpdate' cannot be null.");L!==void 0&&(K+="minDaysFromUpdate="+encodeURIComponent(""+L)+"&"),K=K.replace(/[?&]$/,"");let te={observe:"response",responseType:"blob",headers:new ct({Accept:"application/json"})};return this.http.request("get",K,te).pipe(ne(V=>this.processGetProductTypes(V))).pipe(ge(V=>{if(V instanceof ut)try{return this.processGetProductTypes(V)}catch(R){return xe(R)}else return xe(V)}))}processGetProductTypes(L){let K=L.status,te=L instanceof dt?L.body:L.error instanceof Blob?L.error:void 0,V={};if(L.headers)for(let R of L.headers.keys())V[R]=L.headers.get(R);return K===200?E(te).pipe(ne(R=>{let q=null,ie=R===""?null:JSON.parse(R,this.jsonParseReviver);if(Array.isArray(ie)){q=[];for(let de of ie)q.push(k.fromJS(de))}else q=null;return be(q)})):K!==200&&K!==204?E(te).pipe(ne(R=>M("An unexpected server error occurred.",K,R,V))):be(null)}};x.\u0275fac=function(K){return new(K||x)(Pt(Tr),Pt(t.SEARCH_TERM_DATA_SERVICE_URL,8))},x.\u0275prov=Ye({token:x,factory:x.\u0275fac});let A=x;return A})();t.CategoryTreeClient=r;let e=(()=>{let x=class x{constructor(L,K){this.jsonParseReviver=void 0,this.http=L,this.baseUrl=K??""}findSearchTerms(L){let K=this.baseUrl+"/v1/SearchTerm/FindSearchTerms";K=K.replace(/[?&]$/,"");let V={body:JSON.stringify(L),observe:"response",responseType:"blob",headers:new ct({"Content-Type":"application/json",Accept:"application/json"})};return this.http.request("post",K,V).pipe(ne(R=>this.processFindSearchTerms(R))).pipe(ge(R=>{if(R instanceof ut)try{return this.processFindSearchTerms(R)}catch(q){return xe(q)}else return xe(R)}))}processFindSearchTerms(L){let K=L.status,te=L instanceof dt?L.body:L.error instanceof Blob?L.error:void 0,V={};if(L.headers)for(let R of L.headers.keys())V[R]=L.headers.get(R);return K===200?E(te).pipe(ne(R=>{let q=null,ie=R===""?null:JSON.parse(R,this.jsonParseReviver);return q=n.fromJS(ie),be(q)})):K!==200&&K!==204?E(te).pipe(ne(R=>M("An unexpected server error occurred.",K,R,V))):be(null)}exportSearchTerms(L){let K=this.baseUrl+"/v1/SearchTerm/ExportSearchTerms";K=K.replace(/[?&]$/,"");let V={body:JSON.stringify(L),observe:"response",responseType:"blob",headers:new ct({"Content-Type":"application/json",Accept:"application/json"})};return this.http.request("post",K,V).pipe(ne(R=>this.processExportSearchTerms(R))).pipe(ge(R=>{if(R instanceof ut)try{return this.processExportSearchTerms(R)}catch(q){return xe(q)}else return xe(R)}))}processExportSearchTerms(L){let K=L.status,te=L instanceof dt?L.body:L.error instanceof Blob?L.error:void 0,V={};if(L.headers)for(let R of L.headers.keys())V[R]=L.headers.get(R);if(K===200||K===206){let R=L.headers?L.headers.get("content-disposition"):void 0,q=R?/filename\*=(?:(\\?['"])(.*?)\1|(?:[^\s]+'.*?')?([^;\n]*))/g.exec(R):void 0,ie=q&&q.length>1?q[3]||q[2]:void 0;return ie?ie=decodeURIComponent(ie):(q=R?/filename="?([^"]*?)"?(;|$)/g.exec(R):void 0,ie=q&&q.length>1?q[1]:void 0),be({fileName:ie,data:te,status:K,headers:V})}else if(K!==200&&K!==204)return E(te).pipe(ne(R=>M("An unexpected server error occurred.",K,R,V)));return be(null)}updateSearchTermStatus(L){let K=this.baseUrl+"/v1/SearchTerm/UpdateSearchTermStatus";K=K.replace(/[?&]$/,"");let V={body:JSON.stringify(L),observe:"response",responseType:"blob",headers:new ct({"Content-Type":"application/json"})};return this.http.request("post",K,V).pipe(ne(R=>this.processUpdateSearchTermStatus(R))).pipe(ge(R=>{if(R instanceof ut)try{return this.processUpdateSearchTermStatus(R)}catch(q){return xe(q)}else return xe(R)}))}processUpdateSearchTermStatus(L){let K=L.status,te=L instanceof dt?L.body:L.error instanceof Blob?L.error:void 0,V={};if(L.headers)for(let R of L.headers.keys())V[R]=L.headers.get(R);return K===200?E(te).pipe(ne(R=>be(null))):K!==200&&K!==204?E(te).pipe(ne(R=>M("An unexpected server error occurred.",K,R,V))):be(null)}updateSearchTerms(L){let K=this.baseUrl+"/v1/SearchTerm/UpdateSearchTerms";K=K.replace(/[?&]$/,"");let V={body:JSON.stringify(L),observe:"response",responseType:"blob",headers:new ct({"Content-Type":"application/json"})};return this.http.request("post",K,V).pipe(ne(R=>this.processUpdateSearchTerms(R))).pipe(ge(R=>{if(R instanceof ut)try{return this.processUpdateSearchTerms(R)}catch(q){return xe(q)}else return xe(R)}))}processUpdateSearchTerms(L){let K=L.status,te=L instanceof dt?L.body:L.error instanceof Blob?L.error:void 0,V={};if(L.headers)for(let R of L.headers.keys())V[R]=L.headers.get(R);return K===200?E(te).pipe(ne(R=>be(null))):K!==200&&K!==204?E(te).pipe(ne(R=>M("An unexpected server error occurred.",K,R,V))):be(null)}};x.\u0275fac=function(K){return new(K||x)(Pt(Tr),Pt(t.SEARCH_TERM_DATA_SERVICE_URL,8))},x.\u0275prov=Ye({token:x,factory:x.\u0275fac});let A=x;return A})();t.SearchTermClient=e;class n{constructor(x){if(x)for(var F in x)x.hasOwnProperty(F)&&(this[F]=x[F]);x||(this.items=[])}init(x){if(x){if(Array.isArray(x.Items)){this.items=[];for(let F of x.Items)this.items.push(i.fromJS(F))}this.totalCount=x.TotalCount}}static fromJS(x){x=typeof x=="object"?x:{};let F=new n;return F.init(x),F}toJSON(x){if(x=typeof x=="object"?x:{},Array.isArray(this.items)){x.Items=[];for(let F of this.items)x.Items.push(F?F.toJSON():void 0)}return x.TotalCount=this.totalCount,x}}t.PagedResponseOfSearchTermWithHistory=n;class i{constructor(x){if(x)for(var F in x)x.hasOwnProperty(F)&&(this[F]=x[F])}init(x){if(x){if(this.iD=x.ID,this.term=x.Term,this.historyUpdateStatus=x.HistoryUpdateStatus,this.phraseUpdateStatus=x.PhraseUpdateStatus,this.updateTime=x.UpdateTime?new Date(x.UpdateTime.toString()):void 0,Array.isArray(x.Phrases)){this.phrases=[];for(let F of x.Phrases)this.phrases.push(a.fromJS(F))}if(Array.isArray(x.HistoryItems)){this.historyItems=[];for(let F of x.HistoryItems)this.historyItems.push(l.fromJS(F))}}}static fromJS(x){x=typeof x=="object"?x:{};let F=new i;return F.init(x),F}toJSON(x){if(x=typeof x=="object"?x:{},x.ID=this.iD,x.Term=this.term,x.HistoryUpdateStatus=this.historyUpdateStatus,x.PhraseUpdateStatus=this.phraseUpdateStatus,x.UpdateTime=this.updateTime?this.updateTime.toISOString():void 0,Array.isArray(this.phrases)){x.Phrases=[];for(let F of this.phrases)x.Phrases.push(F?F.toJSON():void 0)}if(Array.isArray(this.historyItems)){x.HistoryItems=[];for(let F of this.historyItems)x.HistoryItems.push(F?F.toJSON():void 0)}return x}}t.SearchTermWithHistory=i;class o{constructor(x){if(x)for(var F in x)x.hasOwnProperty(F)&&(this[F]=x[F])}init(x){if(x){if(this.iD=x.ID,this.historyUpdateStatus=x.HistoryUpdateStatus,this.phraseUpdateStatus=x.PhraseUpdateStatus,Array.isArray(x.Phrases)){this.phrases=[];for(let F of x.Phrases)this.phrases.push(a.fromJS(F))}if(Array.isArray(x.HistoryItems)){this.historyItems=[];for(let F of x.HistoryItems)this.historyItems.push(l.fromJS(F))}}}static fromJS(x){x=typeof x=="object"?x:{};let F=new o;return F.init(x),F}toJSON(x){if(x=typeof x=="object"?x:{},x.ID=this.iD,x.HistoryUpdateStatus=this.historyUpdateStatus,x.PhraseUpdateStatus=this.phraseUpdateStatus,Array.isArray(this.phrases)){x.Phrases=[];for(let F of this.phrases)x.Phrases.push(F?F.toJSON():void 0)}if(Array.isArray(this.historyItems)){x.HistoryItems=[];for(let F of this.historyItems)x.HistoryItems.push(F?F.toJSON():void 0)}return x}}t.SearchTermUpdateModel=o;class a{constructor(x){if(x)for(var F in x)x.hasOwnProperty(F)&&(this[F]=x[F])}init(x){x&&(this.term=x.Term,this.count=x.Count,this.isAssociation=x.IsAssociation)}static fromJS(x){x=typeof x=="object"?x:{};let F=new a;return F.init(x),F}toJSON(x){return x=typeof x=="object"?x:{},x.Term=this.term,x.Count=this.count,x.IsAssociation=this.isAssociation,x}}t.SearchTermPhrase=a;class l{constructor(x){if(x)for(var F in x)x.hasOwnProperty(F)&&(this[F]=x[F])}init(x){x&&(this.count=x.Count,this.relativeCount=x.RelativeCount,this.month=x.Month,this.year=x.Year)}static fromJS(x){x=typeof x=="object"?x:{};let F=new l;return F.init(x),F}toJSON(x){return x=typeof x=="object"?x:{},x.Count=this.count,x.RelativeCount=this.relativeCount,x.Month=this.month,x.Year=this.year,x}}t.SearchTermHistoryItem=l;class c{constructor(x){if(x)for(var F in x)x.hasOwnProperty(F)&&(this[F]=x[F])}init(x){x&&(this.term=x.Term,this.minQueryCount=x.MinQueryCount,this.monthFrom=x.MonthFrom,this.monthTo=x.MonthTo,this.offset=x.Offset,this.count=x.Count,this.minID=x.MinID,this.status=x.Status,this.enableSurgeFilter=x.EnableSurgeFilter,this.surgePercent=x.SurgePercent)}static fromJS(x){x=typeof x=="object"?x:{};let F=new c;return F.init(x),F}toJSON(x){return x=typeof x=="object"?x:{},x.Term=this.term,x.MinQueryCount=this.minQueryCount,x.MonthFrom=this.monthFrom,x.MonthTo=this.monthTo,x.Offset=this.offset,x.Count=this.count,x.MinID=this.minID,x.Status=this.status,x.EnableSurgeFilter=this.enableSurgeFilter,x.SurgePercent=this.surgePercent,x}}t.FindSearchTermsModel=c;class f{constructor(x){if(x)for(var F in x)x.hasOwnProperty(F)&&(this[F]=x[F])}init(x){x&&(this.term=x.Term,this.count=x.Count)}static fromJS(x){x=typeof x=="object"?x:{};let F=new f;return F.init(x),F}toJSON(x){return x=typeof x=="object"?x:{},x.Term=this.term,x.Count=this.count,x}}t.FilterCategoryModel=f;class m{constructor(x){if(x)for(var F in x)x.hasOwnProperty(F)&&(this[F]=x[F]);x||(this.iDs=[])}init(x){if(x){if(Array.isArray(x.IDs)){this.iDs=[];for(let F of x.IDs)this.iDs.push(F)}this.historyUpdateStatus=x.HistoryUpdateStatus,this.phraseUpdateStatus=x.PhraseUpdateStatus}}static fromJS(x){x=typeof x=="object"?x:{};let F=new m;return F.init(x),F}toJSON(x){if(x=typeof x=="object"?x:{},Array.isArray(this.iDs)){x.IDs=[];for(let F of this.iDs)x.IDs.push(F)}return x.HistoryUpdateStatus=this.historyUpdateStatus,x.PhraseUpdateStatus=this.phraseUpdateStatus,x}}t.UpdateSearchTermStatusModel=m;let C;(function(A){A[A.Unknown=0]="Unknown",A[A.Ready=1]="Ready",A[A.QueuedForUpdate=2]="QueuedForUpdate",A[A.Downloaded=3]="Downloaded"})(C=t.SearchTermStatus||(t.SearchTermStatus={}));class y{constructor(x){if(x)for(var F in x)x.hasOwnProperty(F)&&(this[F]=x[F])}init(x){if(x){if(this.iD=x.ID,this.name=x.Name,this.disabled=x.Disabled,this.analyzable=x.Analyzable,Array.isArray(x.Types)){this.types=[];for(let F of x.Types)this.types.push(k.fromJS(F))}if(Array.isArray(x.Children)){this.children=[];for(let F of x.Children)this.children.push(y.fromJS(F))}}}static fromJS(x){x=typeof x=="object"?x:{};let F=new y;return F.init(x),F}toJSON(x){if(x=typeof x=="object"?x:{},x.ID=this.iD,x.Name=this.name,x.Disabled=this.disabled,x.Analyzable=this.analyzable,Array.isArray(this.types)){x.Types=[];for(let F of this.types)x.Types.push(F?F.toJSON():void 0)}if(Array.isArray(this.children)){x.Children=[];for(let F of this.children)x.Children.push(F?F.toJSON():void 0)}return x}}t.Category=y;class k{constructor(x){if(x)for(var F in x)x.hasOwnProperty(F)&&(this[F]=x[F])}init(x){x&&(this.iD=x.ID,this.name=x.Name,this.disabled=x.Disabled,this.analyzable=x.Analyzable)}static fromJS(x){x=typeof x=="object"?x:{};let F=new k;return F.init(x),F}toJSON(x){return x=typeof x=="object"?x:{},x.ID=this.iD,x.Name=this.name,x.Disabled=this.disabled,x.Analyzable=this.analyzable,x}}t.ProductType=k;class S extends Error{constructor(x,F,L,K,te){super(),this.isApiException=!0,this.message=x,this.status=F,this.response=L,this.headers=K,this.result=te}static isApiException(x){return x.isApiException===!0}}t.ApiException=S;function M(A,x,F,L,K){return K!=null?xe(K):xe(new S(A,x,F,L,null))}function E(A){return new ba(x=>{if(!A)x.next(""),x.complete();else{let F=new FileReader;F.onload=L=>{x.next(L.target.result),x.complete()},F.readAsText(A)}})}})(Ar||(Ar={}));var v1=P1(x1());var C9=()=>({"min-width":"75rem"}),w9=()=>[10,25,50];function S9(t,r){if(t&1){let e=pe();d(0,"div",9)(1,"p-floatlabel",10)(2,"p-inputNumber",25),Fe("ngModelChange",function(i){O(e);let o=h(2);return ke(o.filterModel.surgePercent,i)||(o.filterModel.surgePercent=i),B(i)}),u(),d(3,"label",26),v(4,"\u0420\u043E\u0441\u0442 \u043D\u0435 \u043C\u0435\u043D\u0435\u0435, %"),u()()()}if(t&2){let e=h(2);p(2),Se("ngModel",e.filterModel.surgePercent),g("showButtons",!0)("step",10)}}function k9(t,r){if(t&1){let e=pe();d(0,"div",8)(1,"div",9)(2,"p-inputgroup")(3,"p-floatlabel",10)(4,"input",11),Fe("ngModelChange",function(i){O(e);let o=h();return ke(o.filterModel.term,i)||(o.filterModel.term=i),B(i)}),u(),d(5,"label",12),v(6,"\u0422\u0438\u043F \u0442\u043E\u0432\u0430\u0440\u0430"),u()(),d(7,"p-inputgroup-addon")(8,"p-button",13),ee("click",function(){O(e);let i=h();return B(i.clearTerm())}),u()()()(),d(9,"div",14)(10,"p-floatlabel",10)(11,"p-datepicker",15),Fe("ngModelChange",function(i){O(e);let o=h();return ke(o.date,i)||(o.date=i),B(i)}),u(),d(12,"label",16),v(13,"\u041C\u0435\u0441\u044F\u0446\u044B"),u()()(),d(14,"div",9)(15,"p-floatlabel",10)(16,"p-inputNumber",17),Fe("ngModelChange",function(i){O(e);let o=h();return ke(o.filterModel.minQueryCount,i)||(o.filterModel.minQueryCount=i),B(i)}),u(),d(17,"label",18),v(18,"\u041A\u043E\u043B\u0438\u0447\u0435\u0441\u0442\u0432\u043E \u0437\u0430\u043F\u0440\u043E\u0441\u043E\u0432"),u()()(),d(19,"div",9)(20,"div",19)(21,"p-checkbox",20),Fe("ngModelChange",function(i){O(e);let o=h();return ke(o.filterModel.enableSurgeFilter,i)||(o.filterModel.enableSurgeFilter=i),B(i)}),u(),d(22,"label",21),v(23,"\u041F\u043E\u0438\u0441\u043A \u0441\u0435\u0437\u043E\u043D\u043E\u0432"),u()()(),ft(24,S9,5,3,"div",9),u(),d(25,"div",22)(26,"button",23),ee("click",function(){O(e);let i=h();return B(i.updateFilter())}),v(27,"\u0418\u0441\u043A\u0430\u0442\u044C"),u(),d(28,"button",24),ee("click",function(){O(e);let i=h();return B(i.exportFile())}),v(29,"\u0421\u043A\u0430\u0447\u0430\u0442\u044C Excel"),u()()}if(t&2){let e=h();p(4),Se("ngModel",e.filterModel.term),p(7),Se("ngModel",e.date),g("minDate",e.minDate)("maxDate",e.maxDate)("showClear",!0)("readonlyInput",!0),p(5),Se("ngModel",e.filterModel.minQueryCount),g("showButtons",!0)("min",0)("step",100),p(5),Se("ngModel",e.filterModel.enableSurgeFilter),g("binary",!0),p(3),mt(e.filterModel.enableSurgeFilter?24:-1)}}function T9(t,r){t&1&&(d(0,"tr")(1,"th"),v(2,"\u0422\u0438\u043F \u0442\u043E\u0432\u0430\u0440\u0430"),u(),Y(3,"th"),u())}function E9(t,r){if(t&1&&(d(0,"div",38)(1,"div"),v(2),u(),d(3,"div"),v(4),u()()),t&2){let e=r.$implicit;p(2),he(e.count),p(2),he(e.term)}}function I9(t,r){if(t&1&&(d(0,"div",38)(1,"div"),v(2),u(),d(3,"div"),v(4),u()()),t&2){let e=r.$implicit;p(2),he(e.count),p(2),he(e.term)}}function F9(t,r){if(t&1&&(d(0,"div",19)(1,"span"),v(2),u()()),t&2){let e=r.$implicit;p(2),he(e.isAssociation?"\u0410\u0441\u0441\u043E\u0446\u0438\u0430\u0446\u0438\u0438":"\u0417\u0430\u043F\u0440\u043E\u0441\u044B")}}function A9(t,r){if(t&1&&(d(0,"p-select",37),Ze(1,"async"),Ze(2,"async"),P(3,E9,5,2,"ng-template",null,4,Z)(5,I9,5,2,"ng-template",null,5,Z)(7,F9,3,1,"ng-template",null,6,Z),u()),t&2){let e,n,i=Dr(4);g("ngModel",(e=_r(1,3,i.queries))==null?null:e.header)("options",(n=_r(2,5,i.queries))==null?null:n.groups)("group",!0)}}function P9(t,r){if(t&1&&(d(0,"tr")(1,"td")(2,"div")(3,"div",27)(4,"div"),v(5),u(),d(6,"div"),P(7,A9,9,7,"p-select",28),u()(),d(8,"div",29),Y(9,"a",30)(10,"a",31)(11,"a",32)(12,"a",33)(13,"a",34),u()()(),d(14,"td")(15,"div"),Y(16,"p-tag",35)(17,"p-tag",36),u()()()),t&2){let e=r.$implicit,n=h();p(5),Ie(" ",e.term," "),p(2),g("ngIf",e.phrases==null?null:e.phrases.length),p(2),Qt(e.historyItems!=null&&e.historyItems.length?"":"color: grey"),g("pRowToggler",e)("size",n.small),p(),g("href",Si("https://wordstat.yandex.ru/?words=",e.term),Gt),p(),g("href",Si("https://trends.google.com/trends/explore?q=",e.term),Gt),p(),g("href",Si("https://www.ozon.ru/search/?text=",e.cleanTerm),Gt),p(),g("href",Si("https://www.wildberries.ru/catalog/0/search.aspx?search=",e.cleanTerm),Gt),p(3),g("severity",e.historyUpdateStatusTag)("title",n.getStatusText(e.historyUpdateStatus)),p(),g("severity",e.phraseUpdateStatusTag)("title",n.getStatusText(e.phraseUpdateStatus))}}function D9(t,r){if(t&1&&(d(0,"tr")(1,"td",40),Y(2,"p-chart",41),Ze(3,"async"),u()()),t&2){let e=h().$implicit;p(2),g("data",_r(3,2,e.history))("height",150)}}function O9(t,r){if(t&1&&P(0,D9,4,4,"tr",39),t&2){let e=r.$implicit;g("ngIf",e.historyItems==null?null:e.historyItems.length)}}var cu=class extends Ar.SearchTermWithHistory{constructor(r){super(r),this.historyData=null,this.queryData=null,this.chartOptions={animation:!1,scales:{y:{ticks:{stepSize:100}}}},this.queries=Sc(new Promise(n=>{let i=this.queryData;if(!i){let o=this.phrases?.filter(l=>l.isAssociation).sort((l,c)=>c.count-l.count),a=this.phrases?.filter(l=>!l.isAssociation).sort((l,c)=>+c.count-+l.count);i={groups:[]},a&&(i.groups.push({isAssociation:!1,items:a}),i.header=a?.[0]),o&&(i.groups.push({isAssociation:!0,items:o}),i.header||=a?.[0])}n(i)})),this.history=Sc(new Promise(n=>{let i=this.historyData;if(!i){let o=new Set,a=12,l=-1,c=this.historyItems?.reduce((y,k)=>{a=Math.min(a,k.month),l=Math.max(l,k.month),o.add(k.month);let S=y.get(k.year)??new Array(12);return S[k.month]=k.count,y.set(k.year,S),y},new Map)??[];a<l&&c.forEach(y=>{a>0&&y.splice(0,a),l<11&&y.splice(l+1,11-l)});let f=new Date,m=[];for(let y=a;y<=l;y++)f.setMonth(y-1,1),m.push(f.toLocaleString("default",{month:"long"}));i={labels:m,datasets:[]},[...c.keys()].sort().forEach(y=>{i.datasets.push({label:y,data:c.get(y)})}),this.historyData=c}n(i)}));let e=" \u043A\u0443\u043F\u0438\u0442\u044C";this.cleanTerm=r.term.endsWith(e)?r.term.substring(0,r.term.length-e.length):r.term}getUpdateStatusTag(r){switch(r){case Ar.SearchTermStatus.Ready:return"success";case Ar.SearchTermStatus.QueuedForUpdate:return"info";case Ar.SearchTermStatus.Downloaded:return"warning";default:return"danger"}}get historyUpdateStatusTag(){return this.getUpdateStatusTag(this.historyUpdateStatus)}get phraseUpdateStatusTag(){return this.getUpdateStatusTag(this.phraseUpdateStatus)}},b1=(()=>{let r=class r extends ei{constructor(n,i,o,a){super(o),this.searchTermService=n,this.messageService=i,this.dbService=a,this.filterModel=new Ar.FindSearchTermsModel({term:"",offset:0,count:50,surgePercent:100,enableSurgeFilter:!1}),this.minDate=new Date(new Date().getFullYear()-1,0,1),this.maxDate=new Date(new Date().getFullYear()+1,11,1),this.loading=!1,this.totalRecords=0,this.searchTermFilterSubject=new ur(null)}ngOnInit(){this.titleService.setTitle("\u041A\u043B\u044E\u0447\u0435\u0432\u044B\u0435 \u0441\u043B\u043E\u0432\u0430"),this.filterSubscription=this.searchTermFilterSubject.pipe(Ca(1e3)).pipe(Yr(this.destroyed)).pipe(Ws()).pipe(us(n=>{let i=n.toJSON();delete i.Offset,this.dbService.update("filters",{id:r.name,data:i}).pipe(ge(o=>(this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430 \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u044F \u0444\u0438\u043B\u044C\u0442\u0440\u0430",severity:"error",detail:o}),it))).subscribe(),this.loading=!0})).pipe(xi(n=>this.searchTermService.findSearchTerms(n).pipe(ge(i=>(this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0438 \u0441\u043F\u0438\u0441\u043A\u0430 \u0437\u0430\u043A\u0443\u043F\u043E\u043A",severity:"error",detail:i}),this.loading=!1,it))))).subscribe(n=>{this.data=n.items.map(i=>new cu(i)),this.totalRecords=n.totalCount,this.loading=!1}),this.dbService.getByID("filters",r.name).subscribe(n=>{if(n&&n.data&&(this.filterModel=new Ar.FindSearchTermsModel(Ar.FindSearchTermsModel.fromJS(n.data)),this.filterModel.monthFrom!=null)){let i=this.filterModel.monthTo??this.filterModel.monthFrom,o=new Date;o.setMonth(i),o.setDate(1);let a=this.filterModel.monthFrom<=i?o.getFullYear():o.getFullYear()-1,l=new Date(a,this.filterModel.monthFrom,1);this.date=[l,o]}this.searchTermFilterSubject.next(this.filterModel)})}onDataLazyLoad(n){this.filterModel.offset=n.first,this.filterModel.count=n.rows,this.updateFilter()}getStatusText(n){switch(n){case Ar.SearchTermStatus.Ready:return"\u0414\u0430\u043D\u043D\u044B\u0435 \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043D\u044B";case Ar.SearchTermStatus.QueuedForUpdate:return"\u0412 \u043E\u0447\u0435\u0440\u0435\u0434\u0438 \u043D\u0430 \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0443";case Ar.SearchTermStatus.Downloaded:return"\u0412 \u043E\u0431\u0440\u0430\u0431\u043E\u0442\u043A\u0435";default:return"\u041D\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043D\u043E"}}clearTerm(){this.filterModel.term=null}updateFilter(){let n=this.date?.[0]?.getMonth(),i=this.date?.[1]?.getMonth();this.filterModel.monthFrom=n??i,this.filterModel.monthTo=i??n,this.searchTermFilterSubject.next(new Ar.FindSearchTermsModel(this.filterModel))}enqueueUpdate(n,i,o){let a=i?Ar.SearchTermStatus.QueuedForUpdate:n.historyUpdateStatus,l=o?Ar.SearchTermStatus.QueuedForUpdate:n.phraseUpdateStatus,c=new Ar.UpdateSearchTermStatusModel({iDs:[n.iD],historyUpdateStatus:a,phraseUpdateStatus:l});this.searchTermService.updateSearchTermStatus(c).pipe(ge(f=>(this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430 \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u044F \u0441\u0442\u0430\u0442\u0443\u0441\u0430 \u0437\u0430\u043F\u0440\u043E\u0441\u0430",severity:"error",detail:f}),this.loading=!1,it))).subscribe(()=>{n.historyUpdateStatus=a,n.phraseUpdateStatus=l,this.loading=!1})}exportFile(){this.updateFilter(),this.searchTermService.exportSearchTerms(this.searchTermFilterSubject.value).subscribe(n=>{(0,v1.saveAs)(n.data,n.fileName)})}};r.\u0275fac=function(i){return new(i||r)(Pe(Ar.SearchTermClient),Pe(Yt),Pe(Zr),Pe(Sn))},r.\u0275cmp=He({type:r,selectors:[["app-search-term-list"]],features:[lt],decls:13,vars:11,consts:[["caption",""],["header",""],["body",""],["expandedrow",""],["item",""],["selectedItem",""],["group",""],["dataKey","iD",3,"onLazyLoad","value","breakpoint","lazy","tableStyle","paginator","rows","rowsPerPageOptions","totalRecords","loading"],[1,"grid","grid-cols-12","gap-4"],[1,"col-span-12","lg:col-span-6","xl:col-span-4"],["variant","in"],["inputId","term","pInputText","","type","text",3,"ngModelChange","ngModel"],["htmlFor","term"],["type","button","icon","pi pi-times","styleClass","p-button-danger",3,"click"],[1,"col-span-12","lg:col-span-6","xl:col-span-4","items-center"],["inputId","date","dateFormat","MM","selectionMode","range","view","month",3,"ngModelChange","ngModel","minDate","maxDate","showClear","readonlyInput"],["htmlFor","date"],["inputId","minQueryCount","autocomplete","off",3,"ngModelChange","ngModel","showButtons","min","step"],["htmlFor","minQueryCount"],[1,"flex","items-center"],["inputId","surgeFilter",3,"ngModelChange","ngModel","binary"],["htmlFor","surgeFilter",1,"ml-2"],[1,"m-2"],["pButton","",3,"click"],["pButton","",1,"mx-1",3,"click"],["inputId","surgePercent",3,"ngModelChange","ngModel","showButtons","step"],["htmlFor","surgePercent"],[1,"mb-4"],["appendTo","body",3,"ngModel","optionsLabel","options","group",4,"ngIf"],[1,"flex","gap-4"],["href","",1,"pi","pi-chart-line","p-button-sm",3,"pRowToggler","size"],["rel","noreferrer","target","_blank",1,"pi","wordstat",3,"href"],["rel","noreferrer","target","_blank",1,"pi","google-trends",3,"href"],["rel","noreferrer","target","_blank",1,"pi","ozon",3,"href"],["rel","noreferrer","target","_blank",1,"pi","wb",3,"href"],["icon","pi pi-chart-line",3,"severity","title"],["icon","pi pi-search",3,"severity","title"],["appendTo","body",3,"ngModel","optionsLabel","options","group"],[1,"flex","items-center","gap-2"],[4,"ngIf"],["colspan","5"],["type","line",3,"data","height"]],template:function(i,o){if(i&1){let a=pe();Y(0,"p-toast")(1,"p-scrollTop"),d(2,"h1"),v(3,"\u0412\u043E\u0441\u0442\u0440\u0435\u0431\u043E\u0432\u0430\u043D\u043D\u043E\u0441\u0442\u044C \u0442\u043E\u0432\u0430\u0440\u043E\u0432"),u(),d(4,"p-table",7),ee("onLazyLoad",function(c){return O(a),B(o.onDataLazyLoad(c))}),P(5,k9,30,13,"ng-template",null,0,Z)(7,T9,4,0,"ng-template",null,1,Z)(9,P9,18,18,"ng-template",null,2,Z)(11,O9,1,1,"ng-template",null,3,Z),u()}i&2&&(p(4),g("value",o.data)("breakpoint","960px")("lazy",!0)("tableStyle",Je(9,C9))("paginator",!0)("rows",50)("rowsPerPageOptions",Je(10,w9))("totalRecords",o.totalRecords)("loading",o.loading))},dependencies:[nr,Ti,Ht,Po,On,et,bt,Ia,Ea,Ro,bo,jr,Gn,Ur,Wr,qn,Jn,La,oa,Ra,na,Ii,Ei,wn,Yi,bc,Us,Kr,Gr,Fi,vr,xr,Un],encapsulation:2});let t=r;return t})();var y1=(()=>{let r=class r{constructor(n,i){this.service=n,this.messageService=i,this.count=100}enqueueUpdate(){this.service.enqueueForUpdate(this.count).pipe(ge(n=>(this.messageService.add({summary:"\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u043E\u0441\u0442\u0430\u043D\u043E\u0432\u043A\u0443 \u0432 \u043E\u0447\u0435\u0440\u0435\u0434\u044C",severity:"error",detail:n}),it))).subscribe(()=>{this.messageService.add({summary:"\u0423\u0441\u043F\u0435\u0445",severity:"success",detail:"\u041F\u043E\u0441\u0442\u0430\u043D\u043E\u0432\u043A\u0430 \u0432 \u043E\u0447\u0435\u0440\u0435\u0434\u044C \u043D\u0430 \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u0435 \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043D\u0430"})})}};r.\u0275fac=function(i){return new(i||r)(Pe(Ar.CategoryTreeClient),Pe(Yt))},r.\u0275cmp=He({type:r,selectors:[["app-search-term-update"]],decls:6,vars:3,consts:[[1,"flex-auto"],["for","count",1,"mb-2","block","font-bold"],["inputId","count",3,"ngModelChange","ngModel","showButtons","step"],["label","\u041E\u0442\u043F\u0440\u0430\u0432\u0438\u0442\u044C",3,"click"]],template:function(i,o){i&1&&(v(0,"\u041F\u043E\u0441\u0442\u0430\u0432\u0438\u0442\u044C \u0432 \u043E\u0447\u0435\u0440\u0435\u0434\u044C \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u044F wordstat "),d(1,"div",0)(2,"label",1),v(3,"\u041A\u043E\u043B\u0438\u0447\u0435\u0441\u0442\u0432\u043E"),u(),d(4,"p-inputNumber",2),Fe("ngModelChange",function(l){return ke(o.count,l)||(o.count=l),l}),u()(),d(5,"p-button",3),ee("click",function(){return o.enqueueUpdate()}),u()),i&2&&(p(4),Se("ngModel",o.count),g("showButtons",!0)("step",100))},dependencies:[nr,Ht,et,jr,Ur,Wr,Ii,Ei],encapsulation:2});let t=r;return t})();var C1=[{path:"",component:Df,children:[{path:"",canActivate:[ra],loadChildren:()=>import("./chunk-4A4YIDWD.js").then(t=>t.DashboardModule)},{path:"ozon",canActivate:[ra],children:[{path:"product",component:Wm},{path:"salesOrders",component:g1},{path:"returns",component:Dd},{path:"action",component:jm},{path:"stock-starvation-report",component:c1},{path:"transaction",component:u1},{path:"supplyOrder",component:d1}]},{path:"product",canActivate:[ra],children:[{path:"image-editor/editor",component:$f},{path:"list",component:tm},{path:"animator",component:rm}]},{path:"purchase",canActivate:[ra],children:[{path:"",component:zm},{path:"edit",component:Nm},{path:"package-type",children:[{path:"list",component:Um}]}]},{path:"search-term",canActivate:[ra],children:[{path:"",component:b1},{path:"update",component:y1}]},{path:"shipment",canActivate:[ra],loadChildren:()=>import("./chunk-HHPTBCC7.js").then(t=>t.ShipmentModule)},{path:"notfound",component:kf}]},{path:"auth",children:[{path:"error",loadChildren:()=>import("./chunk-7JCVAVQF.js").then(t=>t.ErrorModule)},{path:"access",loadChildren:()=>import("./chunk-ALL7RNOD.js").then(t=>t.AccessModule)},{path:"login",loadChildren:()=>import("./chunk-PLILGHT2.js").then(t=>t.LoginModule)}]},{path:"**",redirectTo:"/notfound"}];var yc;(function(t){t.MACHINE_LEARNING_SERVICE_URL=new wt("MACHINE_LEARNING_SERVICE_URL");let r=(()=>{let c=class c{constructor(m,C){this.jsonParseReviver=void 0,this.http=m,this.baseUrl=C??""}home(){let m=this.baseUrl+"/";m=m.replace(/[?&]$/,"");let C={observe:"response",responseType:"blob",headers:new ct({})};return this.http.request("get",m,C).pipe(ne(y=>this.processHome(y))).pipe(ge(y=>{if(y instanceof ut)try{return this.processHome(y)}catch(k){return xe(k)}else return xe(y)}))}processHome(m){let C=m.status,y=m instanceof dt?m.body:m.error instanceof Blob?m.error:void 0,k={};if(m.headers)for(let S of m.headers.keys())k[S]=m.headers.get(S);return C===200?a(y).pipe(ne(S=>be(null))):C!==200&&C!==204?a(y).pipe(ne(S=>o("An unexpected server error occurred.",C,S,k))):be(null)}};c.\u0275fac=function(C){return new(C||c)(Pt(Tr),Pt(t.MACHINE_LEARNING_SERVICE_URL,8))},c.\u0275prov=Ye({token:c,factory:c.\u0275fac});let l=c;return l})();t.Client=r;let e=(()=>{let c=class c{constructor(m,C){this.jsonParseReviver=void 0,this.http=m,this.baseUrl=C??""}clusterizeHighlightProducts(m){let C=this.baseUrl+"/highlights/clusterize_products?";m!=null&&(C+="clusterCount="+encodeURIComponent(""+m)+"&"),C=C.replace(/[?&]$/,"");let y={observe:"response",responseType:"blob",headers:new ct({Accept:"application/json"})};return this.http.request("post",C,y).pipe(ne(k=>this.processClusterizeHighlightProducts(k))).pipe(ge(k=>{if(k instanceof ut)try{return this.processClusterizeHighlightProducts(k)}catch(S){return xe(S)}else return xe(k)}))}processClusterizeHighlightProducts(m){let C=m.status,y=m instanceof dt?m.body:m.error instanceof Blob?m.error:void 0,k={};if(m.headers)for(let S of m.headers.keys())k[S]=m.headers.get(S);return C===200?a(y).pipe(ne(S=>{let M=null,E=S===""?null:JSON.parse(S,this.jsonParseReviver);if(Array.isArray(E)){M=[];for(let A of E)M.push(n.fromJS(A))}else M=null;return be(M)})):C!==200&&C!==204?a(y).pipe(ne(S=>o("An unexpected server error occurred.",C,S,k))):be(null)}};c.\u0275fac=function(C){return new(C||c)(Pt(Tr),Pt(t.MACHINE_LEARNING_SERVICE_URL,8))},c.\u0275prov=Ye({token:c,factory:c.\u0275fac});let l=c;return l})();t.HighlightsClient=e;class n{constructor(c){if(c)for(var f in c)c.hasOwnProperty(f)&&(this[f]=c[f]);c||(this.products=[],this.clusters=[])}init(c){if(c){if(Array.isArray(c.products)){this.products=[];for(let f of c.products)this.products.push(f)}if(Array.isArray(c.clusters)){this.clusters=[];for(let f of c.clusters)this.clusters.push(f)}}}static fromJS(c){c=typeof c=="object"?c:{};let f=new n;return f.init(c),f}toJSON(c){if(c=typeof c=="object"?c:{},Array.isArray(this.products)){c.products=[];for(let f of this.products)c.products.push(f)}if(Array.isArray(this.clusters)){c.clusters=[];for(let f of this.clusters)c.clusters.push(f)}return c}}t.HighlightClusterizationResultItem=n;class i extends Error{constructor(c,f,m,C,y){super(),this.isApiException=!0,this.message=c,this.status=f,this.response=m,this.headers=C,this.result=y}static isApiException(c){return c.isApiException===!0}}t.ApiException=i;function o(l,c,f,m,C){return C!=null?xe(C):xe(new i(l,c,f,m,null))}function a(l){return new ba(c=>{if(!l)c.next(""),c.complete();else{let f=new FileReader;f.onload=m=>{c.next(m.target.result),c.complete()},f.readAsText(l)}})}})(yc||(yc={}));var B9="Authorization";function w1(t,r){return we(Cc).intercept(t,r)}var Cc=(()=>{let r=class r{constructor(n,i,o){this.tokenService=n,this.authService=i,this.router=o,this.isRefreshing=!1,this.accessTokenSubject=new ur(null)}intercept(n,i){let o=n,a=this.tokenService.getToken();return a!=null?o=this.addTokenHeader(n,a):this.router.navigate(["auth","login"]),i(o).pipe(ge(l=>{if(l instanceof Du&&l.status===401)if(o.url.endsWith("/Token/Login")||o.url.endsWith("/Token/Refresh"))this.router.navigate(["auth","login"]);else return this.handle401Error(o,i);return xe(()=>l)}))}handle401Error(n,i){if(!this.isRefreshing){this.isRefreshing=!0,this.accessTokenSubject.next(null);let o=this.tokenService.getRefreshToken();return o||this.router.navigate(["auth","login"]),this.authService.refreshToken(o).pipe(ge(a=>(this.isRefreshing=!1,this.tokenService.signOut(),xe(()=>a)))).pipe(xi(a=>(this.isRefreshing=!1,this.tokenService.saveToken(a.accessToken),this.tokenService.saveRefreshToken(a.refreshToken),this.accessTokenSubject.next(a.accessToken),i(this.addTokenHeader(n,a.accessToken)))))}return this.accessTokenSubject.pipe(wr(o=>o!==null),Xo(1),xi(o=>i(this.addTokenHeader(n,o))))}addTokenHeader(n,i){return n.clone({headers:n.headers.set(B9,"Bearer "+i)})}};r.\u0275fac=function(i){return new(i||r)(Pt(cl),Pt(gl),Pt(jn))},r.\u0275prov=Ye({token:r,factory:r.\u0275fac});let t=r;return t})(),S1=[{provide:Ou,useClass:Cc,multi:!0}];var uu=new wt("TRANSLATE_HTTP_LOADER_CONFIG"),M9=(()=>{class t{http;config;constructor(){this.config=Pr({prefix:"/assets/i18n/",suffix:".json",enforceLoading:!1,useHttpBackend:!1},we(uu)),this.http=this.config.useHttpBackend?new Tr(we(Rc)):we(Tr)}getTranslation(e){let n=this.config.enforceLoading?`?enforceLoading=${Date.now()}`:"";return this.http.get(`${this.config.prefix}${e}${this.config.suffix}${n}`)}static \u0275fac=function(n){return new(n||t)};static \u0275prov=Ye({token:t,factory:t.\u0275fac})}return t})();function k1(t={}){let r=t.useHttpBackend??!1;return[{provide:uu,useValue:t},{provide:Bo,useClass:M9,deps:[r?Rc:Tr,uu]}]}var R9="Settings",L9="filters",N9={name:"Redicy",version:2,objectStoresMeta:[{store:L9,storeConfig:{keyPath:"id",autoIncrement:!1},storeSchema:[{name:"data",keypath:"data",options:{unique:!1}}]},{store:R9,storeConfig:{keyPath:"id",autoIncrement:!1},storeSchema:[{name:"data",keypath:"data",options:{unique:!1}}]}]},T1={providers:[bd(N9),Wu(C1,ju({anchorScrolling:"enabled",scrollPositionRestoration:"enabled"}),Hu()),Mu(Ru([w1])),Rd({loader:k1({prefix:"./assets/i18n/",suffix:".json",enforceLoading:!0})}),Nd(),td({theme:{preset:Sf,options:{darkModeSelector:".app-dark"}}}),{provide:fe.PRODUCT_DATA_SERVICE_URL,useFactory:()=>go.productDataReaderUrl},{provide:yc.MACHINE_LEARNING_SERVICE_URL,useFactory:()=>go.machineLearningServiceUrl},{provide:er.PRODUCT_DATA_COMMAND_HANDLER_URL,useFactory:()=>go.productDataCommandHandlerUrl},{provide:Od.SHIPMENT_DATA_SERVICE_URL,useFactory:()=>go.shipmentDataServiceUrl},{provide:$c.SECURITY_TOKEN_SERVICE_URL,useFactory:()=>go.stsUrl},{provide:Ar.SEARCH_TERM_DATA_SERVICE_URL,useFactory:()=>go.searchTermDataServiceUrl},{provide:Lu,useClass:Nu},Yt,Cc,$c.TokenClient,Ar.SearchTermClient,Ar.CategoryTreeClient,gl,er.OperationClient,er.OzonProductClient,er.OzonPromotionClient,er.OzonSupplyOrderClient,er.PackageTypeClient,er.PostingClient,er.ProductClient,er.PurchaseBatchClient,er.WarehouseClient,fe.OperationClient,fe.OzonProductClient,fe.OzonPromotionClient,fe.OzonSalesOrderClient,fe.OzonSupplyOrderClient,fe.PackageTypeClient,fe.ProductClient,fe.PurchaseBatchClient,fe.ReportClient,fe.SalesChannelClient,fe.WarehouseClient,S1,Aa,Cu(()=>{let t=we(Ba),r=we(el);t.use("ru"),t.get("primeng").subscribe(e=>r.setTranslation(e))})]};var V9=new Tr(new Bu({build:()=>new XMLHttpRequest}));V9.get("assets/env.json").subscribe(t=>{Object.assign(go,t),zu(Ld,T1).catch(r=>console.error(r))});
/*! Bundled license information:

@angular/platform-browser/fesm2022/animations/async.mjs:
  (**
   * @license Angular v20.3.10
   * (c) 2010-2025 Google LLC. https://angular.dev/
   * License: MIT
   *)

xlsx/xlsx.mjs:
  (*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com *)

xlsx/xlsx.mjs:
  (*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com *)
*/
